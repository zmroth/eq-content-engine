# EQEmu Documentation: Server

> Extracted from docs.eqemu.dev - 243 pages

---

## 2003

*Source: changelog/server/2003/index.html*

# 2003¶

## 12/21/2003¶

- **LethalEncounter** Ive been busy the last few days updating all the opcodes and structs for the recent patch. Nearly everything works again please post any remaining unknown opcodes to the development forum.

## 12/16/2003¶

- **Image** Fixed #zsave and added #zunderworld so you can set the zcoord for underworld.

## 12/15/2003¶

- **Image** Took out an HP update in NPC::Damage() reduces HP updates big time and kills network traffic.

- **Image** All HP Updates are done only to targets now, TODO: Queue group clients with HP updates (once they work again)

## 12/14/2003¶

- **LethalEncounter** Fixed a bug in tradeskills that was clearing the container before it was telling the client to.

- **LethalEncounter** Fixed the opcode for mend.

- **LethalEncounter** Fixed the guild trainer messages.

- **LethalEncounter** Fixed char create so it creates the character with a new aa struct.

- **LethalEncounter** Important fix for mob movement via waypoints and such. Mobs now move nearly exactly like live and it uses 20 times less bandwidth than before.

## 12/13/2003¶

- **LethalEncounter** Fixed Environmental Damage

- **LethalEncounter** Added support for a new database variable called startzone.

To use this, add a record called startzone to the variables table and make the value the zone shortname you want players to start in. This will force all players to start in that zone.

- **LethalEncounter** Fixed a bug that Shawn found where /zone wouldnt work correctly in zones with similiar names.

## 12/12/2003¶

- **Shawn319** (Bud9weiser) Fixed start_zones bug. Players should now start in correct location as long as db is up to date.

- **LethalEncounter** Item tint fix.

- **LethalEncounter** Tradeskill items being deleted without correct recipe fix.

- **LethalEncounter** Problem with the ' character inserting into the bug table fixed.

## 12/11/2003¶

- **LethalEncounter** Added Archery in for pvp.

- **LethalEncounter** Fixed a throw bug.

- **LethalEncounter** Fixed char select colors not matching your colors in game.

## 12/10/2003¶

- **LethalEncounter** Fixed the weapon delay bug. Special thanks to haecz for bring this to our attention.

- **LethalEncounter** Fixed dup money bug. Special thanks to afrospy also for bring this to our attention.

- **LethalEncounter** Fixed Bazaar Traders, they should work correctly.

## 12/09/2003¶

- **LethalEncounter** Fixes for item tints and dyes.

- **LethalEncounter** Fixed NPC textures finally.

## 12/08/2003¶

- **LethalEncounter** Fixed Horses/Drogmors.

## 12/07/2003¶

- **LethalEncounter** Fixed a bug with pets causing lag.

- **LethalEncounter** Fixed a crash bug/1017 bug related to login in, people on slow/lagged connections should be able to login fairly

consistently now.

## 12/02/2003¶

- **LethalEncounter** Trumpcard and I completely rewrote the linked lists to improve lag, they are about 4 times more efficient now.

- **LethalEncounter** Fixed a small bug with zone points. BE SURE YOUR USING THE MOST UP-TO-DATE TABLE!!

## 11/30/2003¶

- **LethalEncounter** Fixed various loot bugs, including the duplicate lore item, blah blah blah bug..

- **LethalEncounter** Fixed #zonestatus and /servers to be on multiple lines

- **LethalEncounter** Fixed /who all guild tags to display the right guild

- **LethalEncounter** Added the ability to send multi-lined emotes with the newline.

- **LethalEncounter** Fixed the bug that gave the message: "Multiplier

## 11/29/2003¶

- **Image** Fixed last names for clients (When a new client zoned in, didn't send lastname).

## 11/28/2003¶

- **LethalEncounter** Added a default instance for pets that arent created via legit spells.

- **LethalEncounter** Fixed the spell scribe issues.

## 11/25/2003¶

- **LethalEncounter** Added a new table called ground_spawns. This will allow you to spawn items randomly throughout the zone. Use this for only random locations, use the object table for static ones.

- **LethalEncounter** Added Timers for ground spawns so they will respawn based on the time you set.

## 11/24/2003¶

- **Image** Fixed zoning and deaths so you no longer drop from the server.

- **Image** Properly enabled LDoN on EQEmu.

- **Image** Basic Adventure Merchant code implemented, throwing it to the STL guys to properly optimize.

- **LethalEncounter** Fixed Tradeskill objects. If the objects show up as bags, thats a db issue

## 11/23/2003¶

- **Trumpcard** Several zone performance enhancements, as well as changes to decrease combat lag.

- **LethalEncounter** Reworked pets, they should now work properly.

## 11/21/2003¶

- **LethalEncounter** Merchants wont trade with people while they are fighting now.

- **LethalEncounter** Players can no longer attack while invulnerable.

- **LethalEncounter** Fixed an AA bug that gave the player 199 aa points.

## 11/18/2003¶

- **LethalEncounter** Lotsa cool fixes like crash fixes and guild fixes and cool stuff like that

## 11/17/2003¶

- **LethalEncounter** Finally got /who all done and *hopefully* free of bugs.

- **LethalEncounter** Fixed a crash bug with guilds and added some of the Guildmanagement features.

## 11/16/2003¶

- **Trumpcard** Several deallocate and mem leak errors corrected.

- **solar** Fixed bug with mobs assisting entities they shouldn't. Often this

show itself with other mobs helping the player when the player

attacked one.

- **LethalEncounter** Added in the GuildManagement tool. You will need 2 new columns in your character_ table for this.

- **LethalEncounter** Fixed a couple crash bugs with guilds and spells.

## 11/15/2003¶

- **solar** Fixed a bug in commands where if you didn't define an accesslevel for a command

in the addon.ini it would default to accesslevel 0 instead of the hardcoded default.

- **solar** Modified #help command to search for a partial command specified as argument.

- **solar** HP wasn't being updated to client properly and would fall out of sync

## 11/14/2003¶

- **LethalEncounter** Fixed a bug in doors that would cause triggered doors to go into an endless loop and crash.

## 11/13/2003¶

- **kathgar** Fixed a crash when calling ZSList::FindByZoneID() when sending an invalid zone number.

```
` Stack was corrupt in the backtrace, so I am not sure what called it in this way.
`
```

- **LethalEncounter** Fixed animation bug with attack.

- **LethalEncounter** Fixed Tradeskills (again)

- **LethalEncounter** Character Select will now show your equipment (Existing characters will need to swap the items)

- **LethalEncounter** NPCs will now equip weapons and items from the db.

- **LethalEncounter** You can now give weapons and items to NPCs to equip.

## 11/12/2003¶

- **LethalEncounter** Fixed skills, we had the struct one int32 off.

- **LethalEncounter** Fixed GM Trainers, they should now work as intended.

## 11/11/2003¶

- **Doodman** Fixed zone crash in CheckCloseArrgo() during assist checking based on

flawed if logic.

## 11/11/2003¶

- **LethalEncounter** Fixed Stamina issues.

## 11/10/2003¶

- **LethalEncounter** Fixed Quests.

- **LethalEncounter** A quest fix that makes them use far less memory, up to 25 MB per computer

## 11/09/2003¶

- **LethalEncounter** Fixed zoning, zone_points should now work correctly, but make sure you have the latest ones in zone_points!

- **LethalEncounter** Fixed problem with spells not scribing.

- **LethalEncounter** Fixed zoning bug where you zoned back into the same zone, but it looked like you were in the new zone.

## 11/06/2003¶

- **Image** Guildwars code and fixed a bug in MobAI for NPCs assisting clients, clients do not use

IsEngaged(), so it always returned false, now it uses AutoAttackEnabled() in its place for clients.

- **Image** Reversed the AICheckCloseSpells if statements, now sanity checks before distance check, uses less CPU usage.

## 11/05/2003¶

- **LethalEncounter** Updated all of the opcodes that were changed in the patch today.

- **LethalEncounter** Refined AA's some, added table to hold the timers for AA's so users can exploit them. Look in db.sql for the table.

## 11/04/2003¶

- **LethalEncounter** Added in the basic structure for AA's and got some of them working.

## 11/03/2003¶

- **LethalEncounter** Fixed factions.

- **LethalEncounter** Fixed issues with mobs of different factions or no faction assisting.

## 10/29/2003¶

- **LethalEncounter** Fixed X, Y coords.

- **LethalEncounter** Added in groups.

- **LethalEncounter** Added in trades.

- **LethalEncounter** Fixed various animations.

- **LethalEncounter** Fixed client movement.

- **LethalEncounter** Fixed NPC movement.

- **LethalEncounter** Fixed forage.

- **LethalEncounter** Fixed Attack.

- **LethalEncounter** Fixed GM summon.

- **LethalEncounter** Fixed GM goto.

- **LethalEncounter** Fixed spells.

- **LethalEncounter** Fixed lifts.

- **LethalEncounter** Fixed automatic weather changes. Change the default in the zone table to suit your needs. 1: normal 2: Rainy most of the time 3: Snowing most of the time

- **LethalEncounter** Fixed lotsa other important stuff that I cant remember :)

## 10/29/2003¶

- **devn00b** Yet again removed Faulty pet code. LEAVE THEM ALONE

## 10/17/2003¶

- **Image** Zone points code put in, need some testing done on it please!

## 10/15/2003¶

- **Image** More optimization to the aggro code and an infinite for loop fixed.

## 10/14/2003¶

- **kathgar** Removed deprecated guildwars code Added #ifdefs for IPC code, no more IsInteractive checks wasting cycles Fixed a memleak in NPC with attacked_timer

- **merth** Updated zone objects:

- Uses new item architecture

- Fully supports imported data from packet collector

- Objects dropped to ground persist zone sessions

## 10/13/2003¶

- **Image** Optimizations to Aggro code, ~10% more efficient according to Trumpcard.

## 10/11/2003¶

- **Trumpcard** Lots of performance improvements to combat code/AI code. Streamlined several calls, and found and removed unneeded calls

```
` in MobAI that were causing serious bottlenecks. Went through and caught a few memory leaks, and converted
 many deletes to safe deletes.
`
```

## 10/10/2003¶

- **LethalEncounter** Somewhere around this date I added in bazaar traders and cool features like that.

## 10/8/2003¶

- **Trumpcard** Starting items are now in. LE also fixed the combat damage struct and mob hp bar updates.

## 10/8/2003¶

- **scruffy** Inverted the XY coordinates system to work like the EQLive system. Run invertxy.sql to update existing databases.

## 10/6/2003¶

- **kathgar** Added opcodes for things such as the LFG tool from SEQ, replaced some instances of static opcode use

## 10/5/2003¶

- **devn00b** Removed Faulty pet code, replaced with working code.

## 09/24/2003¶

- **Image** Added the functions for the GuildWars point system.

## 8/10/2003¶

- **devn00b** Moved pets from hardcoded to DB based. need to source pets.sql

---

## 2004

*Source: changelog/server/2004/index.html*

# 2004¶

## 01/04/2004¶

- **Doodman** opcode/struct changes to allw zoning in on live.

## 12/29/2004¶

- **Doodman** Fixed leak in Separator

## 12/21/2004¶

- **FatherNitwit** fixed item handing to non-quest NPCs

- **FatherNitwit** delete nodrop or norent items left in world containers

- **FatherNitwit** changed quest::spawn commands to return the NPC ID of the spawned mob (in XS)

- **FatherNitwit** Cleaned up perl variable setting a lot

- **FatherNitwit** Tribute masters should work completely now.

- **FatherNitwit** Fixed login problem wher chars get into zone and move, but nothing else works.

- **FatherNitwit** fixed #level and other leveling commands to give proper ammount of training points.

- **FatherNitwit** Added new extended player profile for emu custom data storage

- **FatherNitwit** Implemented elemental damage on weapons

- **FatherNitwit** Cleaned up memory allocation a bunch

- **FatherNitwit** Made merchant lists load async, to speed dynamic boots

- **FatherNitwit** Fixed repop to not kill player pets.

- **FatherNitwit** Made pets cross teleport doors with their master.

- **FatherNitwit** Tweaked teleport doors, they should always work now.

- **FatherNitwit** Added optional command logging

- **FatherNitwit** Moved a lot of hard coded access levels for commands to features.h

- **FatherNitwit** Added optional status requirement to zone to specific coords

- **FatherNitwit** Fixed several minor crashes.

- **FatherNitwit** Added the unfearable flag (D in special attacks) to mobs.

- **FatherNitwit** Fixed mana burn and life burn (from Branks)

- **FatherNitwit** Added optional packet manager for mob movement packets (PACKET_UPDATE_MANAGER)

- **FatherNitwit** Configure it in updatemgr.cpp (level_distances2,level_timers)

- **FatherNitwit** Added reference counting to applayer packet (for broadcasts)

- **FatherNitwit** Improved packet profiler a bunch, added #packetprofile command

- **FatherNitwit** Cleaned up eq_packet_structs.h a bit

- **FatherNitwit** Required DB update:

ALTER TABLE character_ ADD extprofile BLOB NOT NULL;

## 11/20/2004¶

- **Doodman** Fixed merchant selling bug on merchant slot

## 11/18/2004¶

- **Doodman** Fixed the initialization of augs on NPC loot that was causing a zone crash when looting NPC's

## 11/16/2004¶

- **Doodman** Implemented Augmentation inserting, removal and distilling.

- **Doodman** Augment saves in inventory, shared bank, player_corpse and object_contents.

- **Doodman** Fixed world to detect and cleanup a zone disconnect immediately instead of when it tries to write to it.

- **Doodman** Reimplmented cursor queue using an actually queue. Should be unlimited depth now.

- **Doodman** Updated items for new fields and new names.

## 11/10/2004¶

- **LethalEncounter** Fixed a couple of corpse related bugs.

- **LethalEncounter** Added in various functions for the new login system.

## 11/09/2004¶

- **FatherNitwit** Fixed minor crash with new grid delay thing.

## 11/08/2004¶

- **LethalEncounter** Fixed loot bug with stacked items.

- **LethalEncounter** Added a 10 second timer to grid assignments to speed up zone in time.

- **FatherNitwit** Fixed invalid bind zone crash.

- **FatherNitwit** Fixed taunt crash.

- **FatherNitwit** Initial tribute system. Dosent give benefits, or save state yet.

- **FatherNitwit** Proximity quests: added quest::set_proximity, quest::clear_proximity

- **FatherNitwit** Proximity quests: added events: EVENT_ENTER, EVENT_EXIT

- **FatherNitwit** Added event queue for perl commands which cause perl events, like spawn and attack

- **FatherNitwit** Added the ability to define in game commands in perl (EMBPERL_COMMANDS)

- **FatherNitwit** Hopefully fixed multiple-death XP loss bug.

- **FatherNitwit** Hopefully fixed mob chain-casting buffs when target is immune

- **FatherNitwit** Reworked quest timers to not crash if the NPC depops/dies.

- **FatherNitwit** Added simple code profiling capabilities (-DEQPROFILE + features.h)

- **FatherNitwit** Rewrote command list to be map based instead of flat array

- **FatherNitwit** Rewrote NPC assist to use AIYellForHelp at regular intervals instead of each scan tic

- **FatherNitwit** Rewrote NPC assist code to use npc faction values to determine assist

- **FatherNitwit** Rewrote NPC aggro code to be a ton more effecient (REVERSE_AGGRO)

- **FatherNitwit** Rewrote NPC spell casting code to be a ton more effecient

- **FatherNitwit** Run this query (value of 1

## 11/07/2004¶

- **LethalEncounter** Added in three variables per feature request.

## 11/06/2004¶

- **LethalEncounter** Fixed Merchant bug that wouldnt let you buy anything.

- **LethalEncounter** Fixed stack bug that wouldnt automatically stack any items you bought.

## 11/05/2004¶

- **LethalEncounter** Client Freeze/Black Screen of Death bugs have been eliminated.

- **LethalEncounter** Added a simple count to our linked list so we can process a few things faster and more efficiently.

- **LethalEncounter** Fixed a small compile bug in regards to corpses.

## 11/04/2004¶

- **FatherNitwit** Fixed exploit with split that kathgar found.

## 11/01/2004¶

- **LethalEncounter** Inventory items on zone in are now sent in one packet like live instead of individual packets. This will save on bandwidth and processing time.

- **Cofruben** Added support for /makeleader command.

- **FatherNitwit** Increased max buffs from 15 to 20

- **FatherNitwit** Fixed group zoning

- **FatherNitwit** Fixed loading map files on UNIX with capitol letters

- **FatherNitwit** Fixed a couple crashed related to old AA stuff

- **FatherNitwit** Cannot charm a corpse or charm something when you have a pet

- **FatherNitwit** A little work on zoneing with a chanrmed pet, not perfect yet

- **FatherNitwit** Fixed throwing weapons like shurikens

- **FatherNitwit** Broke all the old LDoN points stuff because it moved in the Player profile

- **FatherNitwit** Moved all quest command's logic into the QuestManager class

- **FatherNitwit** Rewrote perl to use XS instead of command queue (EMBPERL_XS)

- **FatherNitwit** Added routines to capture perl errors into proper log IO (EMBPERL_IO_CAPTURE)

- **FatherNitwit** Added a HUGE set of routines for quest objects, with new variables

$client, $npc, and $entity_list... almost the entire class is exported. (EMBPERL_XS_CLASSES)

- **FatherNitwit** Added capability to send log messages to in-game clients (CLIENT_LOGS)

- **FatherNitwit** Added new log facility for quest messages named Quest

- **FatherNitwit** Added new commands #logs and #nologs to request/stop the server sending you its log messages

- **FatherNitwit** Fixed NPC -> NPC aggro, need to run these queries onan older DB:

ALTER TABLE npc_faction_entries ADD npc_value TINYINT UNSIGNED DEFAULT '0' NOT NULL;

UPDATE npc_faction_entries SET npc_value=1 WHERE value<0;

## 10/31/2004¶

- **LethalEncounter** Aside from a few tweeks, merchants are finished. They will now keep your items after you sell them like live.

- **LethalEncounter** Fixed bug that caused falling damage to be calculated twice.

- **LethalEncounter** Changed Sense Heading to start at 200 for new characters.

- **LethalEncounter** Black screen bug should be fixed now.

- **LethalEncounter** Fixed bash/slam.

## 10/30/2004¶

- **LethalEncounter** Fixed a few issues with item charges.

- **LethalEncounter** Fixed illusions.

- **LethalEncounter** Rewrote the merchant code. Its now much more efficient and instead of 81 database queries per shop request, a typical request doesnt pull anything from the db. It loads the information at load time.

- **LethalEncounter** Added in the beginning parts of temporary merchant items. (you can sell items to merchants and purchase them back) Download the merchantlist_temp table from: http://www.eqemulator.net/sql/merchantlist_temp.sql

## 10/27/2004¶

- **Cofruben** Added LDoN adventure system.Please,source the new sql file(thanks to skorch for testing).

- **LethalEncounter** Mob deaths should be sent to all players now.

- **LethalEncounter** ServerType 1 will make you pvp on zone in now. Still trying figure out why the client doesnt send any pvp special combat abilities unless your dueling.

## 10/26/2004¶

- **Scorpious2k** Fixed guild doors

## 10/25/2004¶

- **FatherNitwit** Fixed zone crash related to character_ query.

- **FatherNitwit** Fixed book reading to give proper book window.

- **FatherNitwit** At least partialy fixed pet dual weild/double attack problem.

- **FatherNitwit** Tweaking on selling stackable items.

- **FatherNitwit** Fixed archery ammo issue.

- **LethalEncounter** Added ability to /consent (and /deny) other players so they can drag your corpse.

- **LethalEncounter** Fixed bug where other people were able to loot your corpse.

## 10/24/2004¶

- **LethalEncounter** Fixed bug where you lost air supply on zoning in underwater.

- **LethalEncounter** Fixed GM damage bug.

## 10/23/2004¶

- **FatherNitwit** Enable named quests by default (in features.h)

- **FatherNitwit** Fixed decaying world containers problem

- **FatherNitwit** Fixed undead nuke spells

- **FatherNitwit** Minor line of sight optimization

- **FatherNitwit** Minor tradeskill change to avoid a crash

- **FatherNitwit** Changed the way fear duration is calculated, hopefully it is better.

- **FatherNitwit** Implemented beta fear pathing code (disabled by default in features.h)

- **LethalEncounter** Reworked AA system and fixed some of the bugs with it.

- **LethalEncounter** Dyes should work correctly now.

- **LethalEncounter** Fixed Bazaar trader bug.

- **LethalEncounter** Zones now display the proper fog when you update your zone table with the latest.

- **LethalEncounter** Fixed zone crash and merchant item charge bug.

## 10/22/2004¶

- **LethalEncounter** Fixed item deletion bug not updating client.

## 10/21/2004¶

- **LethalEncounter** Fixed various AA related bugs.

## 10/20/2004¶

- **LethalEncounter** Reworked zoning in, solved a couple of issues and should speed the process up a tad.

## 10/19/2004¶

- **FatherNitwit** Fixed Disciplines and Abilities (lay hands & harm touch)

- **FatherNitwit** Added new server variable: DisableNoDrop (set to 1 takes nodrop off items when loaded)

- **FatherNitwit** Fixed NPC buffing through walls

- **FatherNitwit** Fixed symbol spell forumulas

- **LethalEncounter** Fixed equip bug when using two handed weapons.

- **LethalEncounter** Fixed resurrect bug that let you regain xp more than once.

- **LethalEncounter** Fixed bug that was making players corpses disappear on death when they shouldnt have.

## 10/18/2004¶

- **LethalEncounter** Fixed pet only spells.

- **LethalEncounter** Fixed bug that wouldnt let you loot a corpse if someone got an error looting it. (such as a dupe lore error)

- **LethalEncounter** Fixed mana regen bug.

## 10/17/2004¶

- **LethalEncounter** Added some debug code to make it easier for people that cant get minilogin working.

- **LethalEncounter** You will now eat/drink like eqlive if you arent a GM.

- **LethalEncounter** Fixed infinite recursion bug I made a few days ago :/

## 10/16/2004¶

- **LethalEncounter** Fixed mana bug that was causing people not to regen their full mana.

- **LethalEncounter** HP Adjustments, will now send your hp update every tic and only the mob you have targeted (not including group hp updates) to reduce bandwidth.

- **LethalEncounter** Fixed a crash bug on character creation. Thanks to blahblah for the help :P

- **LethalEncounter** Fixed item charge bug, need to update your database.

## 10/15/2004¶

- **LethalEncounter** Changes necessary for the new MiniLogin :)

- **LethalEncounter** Z loc fix, it was placing you ten times the z loc it was supposed to :P

## 10/14/2004¶

- **Rogean** omg we are so teh 0.6.0DR1 now~

- **FatherNitWit** A HUGE thanks goes out to wiz for letting me have his source to facilitate this merge.

WR Merges:

- An innumerable number of small bug fixes and tweaks all over

- A TON of AAs and related effects

- FISHING!!!!!!!!!

- Many timers enforced by server, not just client.

- Trap support.

- Sense trap and disarm trap

- Group linking

- Zone-crossing pets (lose their buffs though, for now)

- Voice graft

- poison and disease counters (in progress)

- hunger and thirst (in progress)

- stat food

- NPC door opening!

- Optimized idle zones to not eat the CPU

- Items tints display properly

- shielding other players (in progress)

- pick pocket

- Optional EXP scaling based on CON level

- Instill Doubt

- Made auto-putting items into bags respect size constraints.

- heal/buff aggro.

- reclaim pet gives you mana back.

- enforce undead and summoned targets spells

- reworked bard songs a bit

- implemented camping properly

- made alcohol tolerance gain skill (dunno if it does anything yet)

- better checking of lore items during trades and merchant buying

- prevent interaction with merchants on basis of bad faction

- pets should actually taunt now.

- rouge pets should backstab now.

- optional: group buffs hit group pets now.

- fixed memory blur chances

- several minor group tweaks, should make groups more stable

- improved duel messages

- optional random luclin attributes for NPCs with boring faces

- AGI adjustments based on encumbrance

- AC bonuses for iskars and monks

FatherNitwit Improvements:

- Made most member timers instances, not pointers.

- Rewrote focus effects system, spells that give focus effect should work too.

- Reagent reduction focus implemeneted

- Rewrote activateable AAs and swarm pets based on Brank's work

- AA spell effects are now in the DB, easily editable

- Added a bunch of simple GoD AAs

- Consolidated many #define options into features.h

- Fixed crash in world when starting zone dosent exist

- Fixed dual weild with hand-to-hand

- Extended fishing to allow mobs to spawn when items are fished up.

- Made item skill modifiers work.

- Identified meaning of old Skill field of common items.

- made bind wounds actually consume bandaids.

- Made archery and throwing consume ammo

- Archery weapons proc now

- Fixed bard item bonuses to apply to all a bard's spell effects.

- rewrote perl HasQuestFile function to behave properly.

- modified perl quest system to fit better into the virtual parser scheme.

- enforce spell/skill components being on the player, not in bank.

- fixed container loading from DB.

- implemented item skill bonuses

- prevent merchant purchases when inventory full.

- safe fall implemented, but the formula is wrong

- initial implementation of client rampaging

- eliminated a lot of sqrt calls

- added an optional packet profiler to EQ network to count opcodes

- fixed NPC-casted targeted AE spells affecting the caster

- fixed monk special attack damage to be skill based.

- most NPC classes do their special attacks now.

- fixed multi-dose potions (not 100% sure they were broken)

- implemented Percental Heal spells

- put caps on haste, HP, and mana regeneration items

- Changed HP regen to work without client's regen packet, which it dosent send anymore.

- Updated natural HP regen to be closer to live.

- corrected AC calculations

- Implemented new discipline interface.

- Added new perl function (traindisc(itemid)) to facilitate training disciplines

- changed discipline reuse timer to a ptimer, since it is long.

- implemented a ton of new spell effects to support disciplines.

- implemented PoP item attributes like shielding, accuracy, etc...

- rewrote much of group system to better support multi-zone groups.

- groups given world-wide IDs instead of zone local.

- group disbanding when split between zones works.

- Fixed warrior/monk triple attack

- Fixed NPC AE spells to respect faction

- Tweaked NPC non-caster mobs being able to cast 'proc' spells.

- Fixed base resistance calculations to match the client.

- Cleaned up NPC spell interruption messages when they were not needed.

- DOTs no longer make you stand every tic.

- Fixed mob immunities special flags

- Added new mob immunities: snare, magic, meele

- Immunity to stuns now includes spin effects as well

- Trading with NPCs should correctly handle no drop items.

- fixed AA EXP setting

- allow starting items to include books and empty bags

- Fixed starting zones problem on char creation.

- Allow bards to move and use clicky items.

- Make NPC casters send stop moving packet when they cast.

- Fixed archery ammo searching to fall over to inventory.

- mobs now dual-weild based on a chance instead of garunteed

- groups do not grant EXP if the mob is green to any group members

- some NPC combat tweaks to balance it over the levels better. Needs through testing.

- EXP is now awarded to the top damaging player/group instead of killer

- fixed donal's complete heal

- fixed AC calculations for high-agi players

- Changed mobs with primary faction = 0 to be indifferent.

- If a player logs/zones in to a Z below the world, they are placed at a valid Z if possible.

- labeled new item field as attuneable, updated DB code for it

## 10/10/2004¶

- **LethalEncounter** Fixed some issues with hp and mana.

- **LethalEncounter** Fixed bug with zoning z coord.

## 10/09/2004¶

- **LethalEncounter** Fixed spell scribing and meming.

- **LethalEncounter** Merged in Xabob's expansion fixes (except regen which FNW is working on).

- **LethalEncounter** Merged in RangerDown's fixed version of #spawnfix.

- **LethalEncounter** Fix for #zcolor that was brought up by rmanders on the bug forum.

- **LethalEncounter** Character conversions from 5.7 to 5.9 should be fixed now.

- **LethalEncounter** Implicit length fix and mana struct fixed.

## 10/05/2004¶

- **FatherNitwit** Fix name generator opcode

- **FatherNitwit** Added loot table drop chance fix

- **FatherNitwit** Cleaned up some map code and other thing

## 10/02/2004¶

- **LethalEncounter** Updated AAs so they are sent based on class now.

## 10/02/2004¶

- **LethalEncounter** Updated to version 5.9-DR2 (EQLive Compatible).

## 10/02/2004¶

- **LethalEncounter** Updated all the structs/opcodes necessary to login using the latest client.

## 10/02/2004¶

- **LethalEncounter** Misc AA fixes.

## 09/29/2004¶

- **LethalEncounter** Fixed AAs, you can now buy them correctly. Big thanks to Xabob for PacketCollecting the information for me!!

## 09/26/2004¶

- **LethalEncounter** Fixed the displaying of AAs, moving them into two tables. Be SURE to source aa.sql for these updates.

```
` (Will fix the buying aspect soon)
`
```

## 09/25/2004¶

- **Doodman** Fixed linux kernel 2.6.x shared memory bug. IPC_NOWAIT is not allowd on shared memory segment operations.

## 09/20/2004¶

- **Scorpious2k** Allow multiple Perl plug-ins

## 09/17/2004¶

- **Doodman** (un)fixed world to hand the LS->world hand off like it did in the past

## 08/21/2004¶

- **LethalEncounter** Finished updating few structs, can now login with latest client. Merchants, combat, loot, etc work fine.

## 08/20/2004¶

- **LethalEncounter** Fixed player profile.

## 08/12/2004¶

- **Cofruben**Added basics of begging.

- **Cofruben**Added group splitting.

## 08/10/2004¶

- **Wiz** Severely cleaned up position update code and made it more efficent. Should drastically reduce update packets generated by other clients.

- **Wiz** Improved the LOS calculation. It should use less CPU and work better now.

## 08/02/2004¶

- **Scorpious2k** Changed Quest command settimer to reuse timers with same name instead of creating new

## 07/26/2004¶

- **Cofruben** Added some perl functions,including: ding,addldonpoint,surname,permaclass/race/gender,scribespells.

## 07/20/2004¶

- **Draupner** Added #npcedit

## 07/19/2004¶

Doodman(WizeOne): Added beacon.o and embxs.o to makefile.perl

- **Doodman** Fixed #serverinfo for linux.

## 07/12/2004¶

Doodman(RangerDown): Added "You cannot attack while invulnerable" message.

## 07/10/2004¶

- **Scorpious2k** Fixed AA related exploit

- **Scorpious2k** Fixed AA problem where % remained if player lost levels to below 51

## 06/27/2004¶

- **Scorpious2k** Added quest command spawn2 * same as spawn except also requires heading

- **Scorpious2k** Modified Quest Globals. It now always creates a unique var if char specific (not ALL players)

- **Scorpious2k** Enabled traders

- **Sandy** Changed mobs so they must have SPECATK_SUMMON to summon players

## 06/23/2004¶

- **Rogean** Mobs no longer Dual Wield with Shields

## 06/22/2004¶

- **Sandy** Event Aggro added

- **Sandy** Permaroot added

- **Sandy** x,y,z variables for quests corrected

## 06/17/2004¶

- **Dspirit** More patch 6/16 opcodes corrected

## 06/16/2004¶

- **Dspirit** Patch 6/16 opcodes corrected

## 06/14/2004¶

- **Dspirit** More opcodes corrected

## 06/13/2004¶

- **Dspirit** Multiple opcodes corrected

## 06/12/2004¶

- **LethalEncounter** #zone fixed.

- **Rogean** Fixed inspecting items in adventure window.

- **Rogean/Scorpious2k** AA Fixes Implimented

## 06/11/2004¶

- **Doodman** Fixed OP_HPUpdate and SendHPUpate. Client now gets proper HP updates.

## 06/11/2004¶

Scorpious2k/ **Image* #reloadqst now works for perl (Reloads the entire zones quest files).

## 05/29/2004¶

- **Scorpious2k** Changed opcode to fix trade windows >> THANKS Dspirit

## 05/29/2004¶

- **Scorpious2k** Merged in Sandy's EVENT_HP code

- **Scorpious2k** Merged in Bleh's Perl/XS enhancement

- **Scorpious2k** Added quest commands for mob movement stop(),start(),pause(),resume() and moveto()

## 05/28/2004¶

- **Doodman/Bleh** Move NPCTypes out of shared mem in to zone specific STL maps.

- **Doodman/Bleh** Removed NPCTypes.o from makefile in EMuShareMem

- **Doodman/Bleh** Fixed null pointer dereference in selling

## 5/15/2004¶

- **Doodman** Upped MMF_MAX_NPCTYPE_ID to 400k to support tcsmyworlds db

- **Doodman** Fixed EQNetwork.cpp to be C++ standard compliant, -not* MS compliant

## 5/11/2004¶

- **Image** Better netcode, rawr.

- **Scorpious2k** Added AC to mobs * be sure to check MobACupdate.sql

- **Scorpious2k** Changed AC so it can now be controlled with serverOp variables ACreduction, ACrandom & ACfail

- **Scorpious2k** Added check so items with req level can't be auto equipped if player not >= req level

- **Scorpious2k** Added generic (theme = 0) LDoN point processing

## ⅚/2004¶

- **Image** Fixed tradeskill places like smiths

## 4/28/2004¶

- **Image** EQNetwork changes to get packets to send in order

- **Image** Fixed zones getting bugged (unable to attack, see others, etc.)

## 4/23/2004¶

- **LethalEncounter** Emu works with the latest patch now. Sony did some crazy crap and added 4608 bytes to player profile :/

## 4/20/2004¶

- **Image** Lifetap now works on PVP

- **Image** Fixed the stacks of snare/root/speed, snare breaks speed spells (SOW,JBoots,etc.), root breaks snare, root breaks speed spells also.

## 4/17/2004¶

- **LethalEncounter** Fixed merchants that were broken in the last patch.

- **Image** Inventory item combining added to decrease the traffic sent on zoning.

## 4/16/2004¶

- **LethalEncounter** Fixed item struct that was changed in the last patch, items now work again.

## 4/15/2004¶

- **LethalEncounter** Fixed Player Profile that was changed in the last patch, you can now login correctly.

## 4/08/2004¶

Scorpious2k & Tark: Fixed incompatability problem with Perl and combined packets

## 4/02/2004¶

- **Image** Improvements made on the combination code.

## 3/29/2004¶

- **Image** Combined packets now work to full extent. Set app priority to 6 if you don't want it combined, all packets should no longer be deflated,encrypted unless priority 6.

- **Scorpious2k** Fixed mob movement

## 3/28/2004¶

- **Scorpious2k** Added quest command signal() and EVENT_SIGNAL

- **Scorpious2k** Made mobs face player for EVENT_SAY and EVENT_ITEM

- **Scorpious2k** Added smogo's $hasitem for perl quests

- **Scorpious2k** Added selfcast() command to perl quests

## 3/23/2004¶

- **Scorpious2k** Added AC. Probably needs major adjusting of values to match live, but its a start.

## 3/22/2004¶

- **image** Group inviting is fixed.

## 3/21/2004¶

- **solar** corrected an issue with channeling skill/regaining concentration

- **solar** changed spell resist so that only detrimental spells are resist checked.

will have to flag beneficial flags that need resist checking later.

## 3/20/2004¶

- **solar** spell resists implemented

- **solar** added/fixed up some spell effects. notable ones are the stackable

hastes like melody of ervaj

- **solar** added new version of Wiz's CheckLos routine

- **solar** fixed a problem with detrimental buffs (root, mez) not working in pvp

## 3/15/2004¶

- **solar** door updates, find sql file in release dir * doorupdate-03-15-04.sql

## 3/13/2004¶

- **solar** fixed zone to zone movement occasionally not working

## 3/10/2004¶

- **solar** spells that are group only should only work on the group now.

## 3/07/2004¶

- **solar** moving coin around should work properly now

## 3/06/2004¶

- **solar** looted stackable items should distribute properly now.

## 3/05/2004¶

- **solar** player armor will appear the proper color now

- **solar** LoY Dye works. You need a vial of prismatic dye for each slot you

want to change the color of.

- **solar** looting differentiates between left and right clicks. left clicking

will put the item on your cursor as expected, and right clicking will

auto equip it.

- **solar** containers can now be auto equip looted

## 3/02/2004¶

- **solar** implemented AE location spells. ex: rain of lava, sentinel. small

issue with this still; the caster continues to execute the casting

animation for the duration of the spell.

## 3/01/2004¶

- **solar** started implementing AE rain type spells, still some work left to do.

There are 2 new files for a Beacon class that you have to add to

the build.

## 2/29/2004¶

- **solar** revised and corrected a ton of spell effect stuff

- **solar** corrected an hp regen issue, but need to get the proper calculations

for regen rates. until corrected, clients will see their hp regen

and then immediately change to what the server thinks it should be

- **solar** probably broke something

## 2/28/2004¶

- **solar** spells will now consume reagents properly

- **solar** lifts work again

- **solar** corrected a mistake that caused spells to not finish scribing properly

- **solar** fixed some memory leak issues regarding hp updates

## 2/25/2004¶

- **Scorpious2k** Added vesuvias changes for 5.5 * luclin appearence should work now

## 2/22/2004¶

- **solar** spells should be in working order again, more work to be done on this.

## 2/20/2004¶

- **solar** merged vesuvias' appearance (face, beard etc) and zone change

changes from the old code.

## 2/19/2004¶

- **kathgar** Fixed, SE_Fear, SE_SpinStun, SE_Charm for fixed duration spells and not double checking breaking

```
`Range check on Archery
Skill checks on Hide and Sneak
Fixed exp deaths in PvP by DoTs cast by clients, spells cast by clients no longer in zone, and client pets
 Added member bool client to Buff_Struct to aid in above fix
Fixed solar's changelog entry where he spelled my name wrong
No EQLive fixes in this change
`
```

- **solar** fixed a bug that was causing people to be set as gm when they shouldn't

## 2/15/2004¶

- **solar** characters being created are checked for validity now. thanks to

kathgar for the tables.

## 2/14/2004¶

- **Zaphod** Added Door ZonePoint information.

## 2/13/2004¶

- **solar** Doors should work now

- **solar** adventure merchant stuff fully working (check me)

- **solar** petition interface stuff believed to be working but not fully tested

- **LethalEncounter** (entered by solar) fixed item opcode, items fully working

## 2/12/2004¶

- **solar** Opcodes updated from Zaphod's list, also a few others. All the ops

that are tabbed in are unconfirmed, and I marked unused ones also.

## 2/10/2004¶

- **Image** NewSource directory created for 0.5.5 (EQLive Compatability Developement)

- **Image** Few opcodes updated, also implicitlen updated.

## 2/8/2004¶

- **solar** fixed a world crash regarding deleting an empty character slot

## 2/7/2004¶

- **solar** AE spells working properly now

- **solar** wrote all new buff duration formulas

- **solar** buffs being applied will properly displace multiple buffs if needed

- **solar** bard spells should keep casting while sitting now

- **solar** mobs should now have a proper casting animation when they cast

## 2/6/2004¶

- **solar** some buff stacking changes, misc spell stuff

## ⅖/2004¶

- **solar** more spell work, bards should be in a working state, but not done.

## ⅔/2004¶

- **Image** Divine Aura now works cross zone.

- **Image** Invisibility now works cross zone.

- **Image** Added a zone(""); command to quest (Zones them to the specified short zone name)

- **Image** Added selfcast("spellid"); command to quest (Makes client cast spells on themself, good for self only spells)

- **Image** Tons of my personal GW stuff changed, you can't see bwuhahahhah

- **Image** Fixed platinum duping

- **Image** Levitate now works cross zone (others see you levitate and not warping)

## 2/2/2004¶

- **Scorpious2k** added quest global variables (requires DB change see quest_globals.txt in EQEmu Release))

- **Scorpious2k** fixed faction command in parser

## 2/2/2004¶

- **solar** worked on buff stacking and some misc spell stuff.

## 2/1/2004¶

- **solar** group spell fixes

- **solar** implemented /targetgroupbuff

## 1/31/2004¶

- **solar** revised the StringID based messaging.

## 1/30/2004¶

- **solar** Merged in Wiz's CheckLos() mob method

- **solar** Spell casting fixes.

- **solar** Channeling skill should work very similar to live now. If you end

your casting where you started you have a chance to finish casting.

- **solar** Line of sight is checked for spells.

## 1/29/2004¶

- **LethalEncounter** Fixed an issue with HT and LoH not repopping, apparently fatigue in player profile was moved into the timer hours slot.

- **solar** Updated death. You shouldn't receive an extra message about being

punched when you die to a spell anymore.

## 1/28/2004¶

- **solar** fixed an item dupe bug.

## 1/26/2004¶

- **solar** various fixes to spells, more coming.

## 1/25/2004¶

- **LethalEncounter** Fixed some issues with the guilds.

- **LethalEncounter** No Rent items will now be deleted if your offline for more than 30 minutes.

## 1/24/2004¶

- **LethalEncounter** The guild management tool has been updated and works again.

- **LethalEncounter** Guilds will now work almost 100% like live, only a few of the #guild commands are left over, mainly for gm management.

- **kathgar** Added #revoke and #oocmute

- **LethalEncounter** Fixed some resist issues with some spells.

- **LethalEncounter** Fixed item charges from merchants.

- **LethalEncounter** Fixed expansion issues like not being able to use Adventure merchants.

- **solar** bodytypes should be working correctly from the db now. Also added it

to #spawn and #npcstats. Pets are all summoned, except necro which

are summoned and undead. Apply the bodytype_update.sql in release

to flag your mobs.

- **solar** /surname command corrects capitalization and rejects non alpha now.

- **solar** #name fixed * renames player target

- **solar** made some fixes to kathgar's revoke patch * it now works as intended.

## 1/23/2004¶

- **solar** LD clients should now be kicked when the LD timer is up, even if engaged.

- **solar** Buffs should be working correctly after zoning now.

- **solar** #gassign fixes

## 1/22/2004¶

- **solar** Corpses are now sent to clients zoning in.

## 1/21/2004¶

- **Trumpcard** Merged in mongrels fix for undead/invis. Use update sql provided in release to update.

- **solar** Buff fading should work for slots besides the first one now. This will

fix the 'mez bug' that was due to the icon not being stripped.

## 1/20/2004¶

- **solar** sense heading skill will now improve as you move around

## 1/19/2004¶

- **Scorpious2k** fixed faction command for quests

- **LethalEncounter** Fixed a problem with queued cursor items.

- **solar** fixes to #gassign

## 1/18/2004¶

- **LethalEncounter** Added item and spell bonuses to the mana regen formulas, they will now help.

- **LethalEncounter** Fixed a bug that was killing players even when they had hitpoints remaining.

- **LethalEncounter** Added server side filters

- **LethalEncounter** Added a new command (#setstat) that allows you to set a characters stats.

- **LethalEncounter** Added a new quest command that allows you to modify a characters stats.

- **LethalEncounter** Added the ability for a player to have more than one item on their cursor at once. They will be queued like on live.

- **Scorpious2k** added random name generator for char create

- **Scorpious2k** changed order of parameters in flag console command to allow for spaces in name

- **kathgar** Added FLAG_COMBINED and FLAG_IMPLICIT support, define COMBINED to try it

- **solar** fixed #mana

- **solar** fixed mana disappearing when you're interrupted mid cast

- **solar** applied kathgar's PetCommand crash fix

- **solar** fixed a pvp damage crash

- **solar** fixed channeling skill rolling over back to 1

- **solar** bumped PVP spell damage to ⅔ from ½ of normal

## 1/17/2004¶

- **Image** Memleaks for LDTimer, stamina_timer, CreateHPPacket have been fixed.

- **Image** World server now boots people with status < 0.

- **solar** Reworked melee hit/miss calculations to work better

## 1/16/2004¶

- **solar** Mez spells break properly on players now

- **solar** added a #stun command, takes a duration from 1 to 65535

- **solar** Fixed mana disappearing when a spell like cannibalize or necro

subversion is cast.

- **solar** Fixed incorrect conditional that was causing ALL damage done TO a

client to be halved. Now only client to client damage is halved.

- **solar** Fixed a bug with the spell cast timer bar disappearing prematurely

and the spell gems readying themselves while a spell was still being

cast.

- **solar** Spells should interrupt properly when you duck, or are otherwise

interrupted while casting.

## 1/15/2004¶

- **solar** HP should regen properly now

## 1/14/2004¶

- **solar** Divine Aura spells should now work

## 1/10/2004¶

- **LethalEncounter** Added ability for groups to zone.

- **LethalEncounter** Added the ability to use snares and roots in pvp.

- **LethalEncounter** Fixed mob movement to be more like live and to work correctly.

- **LethalEncounter** Added the tracking skill.

- **LethalEncounter** You will now get hit for max damage when you are sitting and an npc attacks.

- **LethalEncounter** Fixed loot messages.

- **LethalEncounter** Fixed loot so right click autoequips correctly now.

## ¼/2004¶

- **MYRA** changed to new opcode for follow

- **MYRA** changed to new opcode for taunt

- **MYRA** use new (5.x) Status labels in who for telnet connection

- **MYRA** Added code to depop at end of grid for wander type 4

- **MYRA** Added wander type 4 (single run)

- **MYRA** fixed eval in ExportVar per Eglin

- **MYRA** corrected spelling for var $uguildrank for event_timer (was $uguildrang)

- **MYRA** added vars $status & $cumflag per Eglin

- **MYRA** added vars $mobid & $mlevel per Eglin

- **MYRA** added missing commands + itemlink to perl

- **MYRA** added EVAL & KEEPERR to eval per Eglin's recommendation

- **MYRA** restore missing commands for qst type files & add itemlink

- **MYRA** fixed comma bug for me command

- **MYRA** fixed comma bug for echo command

- **MYRA** fixed comma bug for say command

- **MYRA** fixed comma bug for emote command

- **MYRA** fixed comma bug for shout command

- **MYRA** added itemlink(ItemNumber) command

## ½/2004¶

- **LethalEncounter** Added further support for eqstr_us.txt, this should cut down on lag.

- **Image** Fixed client lockup related to spells. aka 'spell sticking'.

## 1/1/2004¶

- **LethalEncounter** Updated spell structure to new spells_us.txt format. NOTE: You must have the latest eqlive spells_us.txt in your EQEmu directory.

---

## 2005

*Source: changelog/server/2005/index.html*

# 2005¶

## 12/30/2005¶

- **FatherNitwit** Fixed event_waypoint in quests

- **FatherNitwit** Refactored a lot of NPC pathing code (no functional changes)

- **FatherNitwit** Added zone flagging concepts/enforcement

- **FatherNitwit** Added **commands* #flags, #flagedit

- **FatherNitwit** Added quest functions: set_zone_flag, has_zone_flag, clear_zone_flag

Required SQL: CREATE TABLE zone_flags ( charID int NOT NULL, zoneID int NOT NULL, PRIMARY KEY(charID,zoneID) ); ALTER TABLE zone ADD flag_needed VARCHAR(128) NOT NULL DEFAULT '';

## 12/23/2005¶

- **FatherNitwit** Added #reloadstatic to reload doors, objects, zone points, etc... (zone in/out required)

- **FatherNitwit** Fixed mobs to buff their friends, not their enemies.

- **FatherNitwit** Allow support for quests on charmed NPCs.

- **FatherNitwit** Changed quest timers to be tied to the specific NPC, instead of the name being zone global.

- **FatherNitwit** Fixed quest global expiration times... durations should be accurate now.

- **FatherNitwit** Re-enabled Y (year) expiration times, and added a 'F' time to say it dosent expire.

## 12/18/2005¶

- **FatherNitwit** Removed doors from shared memory.

- **FatherNitwit** Hopefully fixed pottery firing in kilns.

## 12/15/2005¶

- **FatherNitwit** Fixed Levitate.

## 12/11/2005¶

- **FatherNitwit** Removed some worthless fields.

- **FatherNitwit** Rewrote all the pet creation code to be based on npc_types

- **FatherNitwit** Completely changed the pets table.

You prolly want to run:

DROP TABLE pets;

You must load up the SQL in Sql-Files/pets.sql

the new pets sql assumes NPC IDs 500-700 are free, so edit them as needed.

ALTER TABLE npc_types DROP fixedz;

## 12/09/2005¶

- **FatherNitwit** Fixed the issue where maxed out factions cannot be raised/lowered

- **FatherNitwit** Changed faction hits to properly ignore illusions.

- **FatherNitwit** Fixed an issue with converted chars and corrupt AAs. (not fully resolved)

- **FatherNitwit** Fixed the issue with mobs not pathing after respawning.

## 12/01/2005¶

- **FatherNitwit** added USE_RACE_CLASS_XP_MODS (disabled by default) to features.h

- **FatherNitwit** These fields are not used:

ALTER TABLE zone_points DROP keep_x;

ALTER TABLE zone_points DROP keep_y;

## 11/28/2005¶

- **Doodman** Found additional world opcodes

- **Doodman** Updated char select struct

## 11/24/2005¶

- **FatherNitwit** just some SQL updates you should run to make the recent aggro changes less annoying.

UPDATE npc_types SET _INT=80 WHERE _INT=75;

UPDATE npc_types SET _INT=60 WHERE _INT=80 AND ( bodytype=3 OR bodytype=8);

ALTER TABLE npc_types CHANGE _INT _INT mediumint(8) unsigned NOT NULL default '80';

## 11/17/2005¶

- **FatherNitwit** Fixed a crash in the map code

- **FatherNitwit** Tweaked mob usage of d_meele_texture*

## 11/11/2005¶

- **FatherNitwit** Changed most double prescision operations to single prescision.

## 11/10/2005¶

- **FatherNitwit** Fixed waypoint ID limit (was 65535).

- **FatherNitwit** Implemented the #wpinfo command

## 11/05/2005¶

- **FatherNitwit** Fixed the broken server side filters (reworked entirely).

- **FatherNitwit** Refactored damage code to be more consistent between PCs and NPCs.

- **FatherNitwit** Changed spell damage mechanism slightly to better utilize runes.

- **FatherNitwit** Tweaked a bit of illusion code to be more versitile.

## 11/03/2005¶

- **FatherNitwit** Fixed AA storage in the player profile.

## 10/28/2005¶

- **FatherNitwit** Fixed a lot of GCC 4.0 and 64 bit problems. Should build under both better now.

## 10/24/2005¶

- **FatherNitwit** Fixed mob int loading.

## 10/23/2005¶

- **FatherNitwit** Fixed Client->NPC->Client riposte.

## 09/28/2005¶

- **FatherNitwit** added quest::attacknpc and quest::attacknpctype

- **FatherNitwit** Cleaned up usage of Appearance in the code

- **FatherNitwit** Fixed faction ally checking for npc->npc faction

- **FatherNitwit** Removed some stupid rules reguarding npc aggro

- **FatherNitwit** Fixed some faction issues with aggro, guards should work reliably now.

## 09/25/2005¶

- **FatherNitwit** Fixed incorrect usage of EXPMod variable.

## 09/24/2005¶

- **FatherNitwit** Hopefully fixed bard instruments.

- **FatherNitwit** Fixed crash when loading DoD+ spells_us.txt file

- **FatherNitwit** Rewrote a ton of the perl parser internals to suck less.

- **FatherNitwit** Reworked a bit of netcode to minimize chances of #opcode crashing.

- **FatherNitwit** Actually loaded luclin attributes from DB.

- **FatherNitwit** Added npc stats to npc_types and use them.

ALTER TABLE npc_types ADD STR MEDIUMINT UNSIGNED NOT NULL DEFAULT '75';

ALTER TABLE npc_types ADD STA MEDIUMINT UNSIGNED NOT NULL DEFAULT '75';

ALTER TABLE npc_types ADD DEX MEDIUMINT UNSIGNED NOT NULL DEFAULT '75';

ALTER TABLE npc_types ADD AGI MEDIUMINT UNSIGNED NOT NULL DEFAULT '75';

ALTER TABLE npc_types ADD _INT MEDIUMINT UNSIGNED NOT NULL DEFAULT '75';

ALTER TABLE npc_types ADD WIS MEDIUMINT UNSIGNED NOT NULL DEFAULT '75';

ALTER TABLE npc_types ADD CHA MEDIUMINT UNSIGNED NOT NULL DEFAULT '75';

## 09/23/2005¶

- **FatherNitwit** Inverted XY coordinates on in zone objects and ground spawns.

- **FatherNitwit** Maybe fixed quests setting a waypoint in EVENT_WAYPOINT

ALTER TABLE ground_spawns ADD temp_x float NOT NULL;

UPDATE ground_spawns SET temp_x=min_x;

UPDATE ground_spawns SET min_x=min_y;

UPDATE ground_spawns SET min_y=temp_x;

UPDATE ground_spawns SET temp_x=max_x;

UPDATE ground_spawns SET max_x=max_y;

UPDATE ground_spawns SET max_y=temp_x;

ALTER TABLE ground_spawns DROP temp_x;

ALTER TABLE object ADD temp_x float NOT NULL;

UPDATE object SET temp_x=xpos;

UPDATE object SET xpos=ypos;

UPDATE object SET ypos=temp_x;

ALTER TABLE object DROP temp_x;

## 09/22/2005¶

- **FatherNitwit** Reworked quest signaling implementation to be less dumb. Also exported SignalNPC to perl.

- **FatherNitwit** Implemented a missing bard AE DOT spell type.

## 09/21/2005¶

- **FatherNitwit** Fixing a few issues with windows compiles and corpses.

## 09/19/2005¶

- **FatherNitwit** Added missing packet for player death to create a corpse.

## 09/16/2005¶

- **FatherNitwit** Fixed loot error case client hang, reported by Yablargo

## 09/15/2005¶

- **FatherNitwit** Fixed coin trading bug reported by Windcatcher

## 09/12/2005¶

- **FatherNitwit** Fixed adventure merchants

## 09/11/2005¶

- **FatherNitwit** Made temp merchant lists clear on world boot.

- **FatherNitwit** Fixed some shared memory issues on windows.

- **FatherNitwit** exported some more mob methods to perl.

## 08/26/2005¶

- **Doodman** Found most of the missing guild opcodes, except the manage ones.

- **Doodman** Moved guildlist to shared mem (ick) since zone now sends it too.

- **Doodman** Need to implement a way to recover the functionality of dynamicly

```
`adding/removing guilds with the shared mem solution
`
```

## 08/23/2005¶

- **FatherNitwit** Added range check for all combat abilities (reported by LoOsEr)

## 08/21/2005¶

- **FatherNitwit** Fixed gaining AA exp (buying still broken)

- **FatherNitwit** Fixed weapon procs

- **FatherNitwit** Added looting messages (links to come later)

- **FatherNitwit** Fixed instant spells acting like DoTs

--* Version Changed to 0.6.2DR1 ---

## 08/05/2005¶

- **FatherNitwit** Adding database support for both eye colors and beard type.

Required SQL:

ALTER TABLE npc_types ADD luclin_eyecolor2 int(10) unsigned NOT NULL default '1' AFTER luclin_eyecolor;

ALTER TABLE npc_types ADD luclin_beard int(10) unsigned NOT NULL default '0' AFTER luclin_beardcolor;

## 08/03/2005¶

- **FatherNitwit** Work on eqextractor to support the newest patch.

- **FatherNitwit** Worked on spawn struct to identify the remaining missing fields.

## 08/02/2005¶

- **FatherNitwit** Added initial fix for the shared bank dupe.

## 07/28/2005¶

- **FatherNitwit** Fixed $wp in EVENT_WAYPOINT

- **FatherNitwit** added #aggro to query aggro checking info for mobs.

- **FatherNitwit** fixed a couple strange things in the aggro code.

## 07/07/2005¶

- **FatherNitwit** Untested fix for zone point wildcards in GetClosestZone*

## 05/09/2005¶

- **FatherNitwit** Fix some stuff related to zoning process.

update zone set min_status=0 where min_status is null;

update zone set min_level=0 where min_level is null;

alter table zone change min_status min_status tinyint(3) unsigned default 0 NOT NULL;

alter table zone change min_level min_level tinyint(3) unsigned default 0 NOT NULL;

alter table zone change long_name long_name text NOT NULL DEFAULT '';

## 05/05/2005¶

- **FatherNitwit** Theoretically fixed a no-drop trading bug.

... Lots of work on 5/12/05 patch ...

## 05/05/2005¶

- **FatherNitwit** A bunch of work on ranged attacks and attack timers.

- **FatherNitwit** Fixed issue with the first time a new char gains exp.

- **FatherNitwit** Fixed delete character at char select.

- **FatherNitwit** Fixed fizzle messages.

- **FatherNitwit** Fixed /goto and other cross-zone player teleporting.

- **FatherNitwit** Initial work on making arrows show up when shot.

## 04/23/2005¶

- **LethalEncounter** Fixed compile errors on Windows

- **LethalEncounter** Fixed guild crash bug while logging in

- **LethalEncounter** Fixed most of the guild commands

## 04/13/2005¶

- **Cofruben** Fixed possible crashes using #npscpawn command.

- **Cofruben** Added a few more cheat locators.

## 04/10/2005¶

- **FatherNitwit** Reworked zone in code to make it more closely match live's ordering.

- **FatherNitwit** Fixed up stream factory problem with dynamic zones.

- **FatherNitwit** Added detailed connecting debugging.

- **FatherNitwit** Work on custom titles.

## 04/08/2005¶

- **FatherNitwit** Completely rewrote zoning code to make sense.

- **FatherNitwit** Fixed some discipline related effects

- **FatherNitwit** Fixed archery hit chance cap (was 47%)

- **FatherNitwit** Initial title system implementation

- **FatherNitwit** Gave berserkers some of their special abilities

- **FatherNitwit** Initial work on raid system, lots to do still.

- **FatherNitwit** Found leadership AAs in the player profile and update packet

- **FatherNitwit** Enforce attack timer constraints on ranged weapons

- **FatherNitwit** (seq) Located crystal counters in the player profile

- **FatherNitwit** (image) Many of the following changes were written or inspired by GuildWars code

- **FatherNitwit** Enforce reuse timers for combat abilities & instill doubt

- **FatherNitwit** Enforce class and range checks on service providing NPCs

- **FatherNitwit** Enforce item slots containing proper items

- **FatherNitwit** Enforce range checking on ranged weapons better

- **FatherNitwit** Made /hideme persistent across zoning

- **FatherNitwit** Finally fixed no drop items in tradeskill containers for real this time I hope.

Required SQL (added to upgrade.sql):

ALTER TABLE account ADD hideme TINYINT NOT NULL DEFAULT 0;

## 04/04/2005¶

- **FatherNitwit** Fixed guild member list struct, identified more fields of it (showeq)

- **FatherNitwit** (bUri) Fixed attack code with non-weapons and h2h weapons.

- **FatherNitwit** Split zone fog types into seperate DB fields.

- **FatherNitwit** Differentiated between guild and player tributes.

Required SQL: utils/0.6.1-upgrade.sql (will be updated until release)

## 01/15/2005¶

- **Doodman** Fixed charges/quantity

- **Doodman** Fixed IsStackable()

- **Doodman** Fixed some empty Handle() functons.

- **Doodman** Added instance level nodrop.

Required SQL:

alter table inventory add instnodrop tinyint(1) unsigned default 0 not null;

## 01/13/2005¶

- **Doodman** Merged source (FNW changes) in to LiveCompat

- **Doodman** SendItemPacket's are now sent deflated (speeds up merchants)

- **Doodman** Combining is now turned on in makefile.perl for zone

- **Doodman** Fixed world to notice zone drops immediately

- **Doodman** Guild_MOTD and bulk door packets are now sent deflated

- **Doodman** New item structure is in:

Items are preserialized in the database (utils/serialize_items.pl)

Item fields names in item struct exactly match the dn

Item fields now match the dump from (utils/load_13thfloor_items.pl)

```
` eqitems.13th-floor.org
`
```

Item table convert script: utils/items-0.6.0-DR2-0.6.1-DR1-convert.sql

## 01/10/2005¶

- **FatherNitwit** Disable sleep() in perl, it is bad news.

- **FatherNitwit** Fixed guild MOTD at login (hopefully).

- **FatherNitwit** Fixed minor security problem in SQL logging.

- **FatherNitwit** Added error reporting to waypoint editing commands.

- **FatherNitwit** Reworked client packet handling to use opcode dispatch

routines, which is paving the way for dynamic opcodes.

## 01/07/2005¶

- **FatherNitwit** Fixed rogue-like skill training (sneak, etc..)

- **FatherNitwit** Added spawn_limit field to spawnentry and npc_types

which represent the maximum number of that npc_type which can spawn

from that spawn group/in that zone overall. 0

---

## 2006

*Source: changelog/server/2006/index.html*

# 2006¶

## 12/24/2006¶

- **KLS** (WildcardX) Fix for generic tradeskill container combines

- **KLS** (WildcardX) Fix for quest::depop and multipul mobs in the same zone that share a NPCType ID

- **KLS** (WildcardX) Zones can now be flagged to disallow offensive actions.

- **KLS** (WildcardX) Fix for zone weather, should no longer rain in places with no set weather, such as dungeons.

- **KLS** Interrupts should only be caused by melee, not spell damage now

- **KLS** Roots should only break on spell damage now.

- **KLS** DoT Focus effects should work correctly

- **KLS** Spell Formula 122 (Splurt) should now function correctly.

- **KLS** Berserkers should find themselves with the ability to double attack.

- **KLS** Curse, poison and disease counters should no longer be factored into stacking, should keep certain dots and certain slows from overwriting and blocking each other.

- **KLS** Complete Heal buffs will no longer stack with or overwrite other complete heal buffs.

Required SQL:

ALTER TABLE `zone` ADD `cancombat` tinyint(4) NOT NULL default '1';

UPDATE `zone` SET `cancombat` = 0 WHERE short_name = 'nexus';

UPDATE `zone` SET `cancombat` = 0 WHERE short_name = 'poknowledge';

UPDATE `zone` SET `cancombat` = 0 WHERE short_name = 'potranquility';

## 12/19/2006¶

- **KLS** Fixed up Illusions a bit

- **KLS** Fixed a bug where the base2[0] field of a spell was not getting loaded correctly

- **KLS** Implemented Sacrifice Spells

- **KLS** Implemented Call of the Hero Spells

- **KLS** Implemented Silence spells

- **KLS** Implemented Invis Vs Animal Spells

- **KLS** Implemented Illusion Copy Spells

- **KLS** Implemented Dispel Detrimental Spells

- **KLS** Dispel Magic spells will skip spells with poison or disease counters.

- **KLS** Spells that imbue items(summon items with reagents, sacrifice) will not be affected by reagen conservation focus.

- **KLS** If a player is at max level the experience he has will cap at the max experience to gain the next level instead of being able to gain experience past his visible experience bar.

- **KLS** The max level you can group with and gain experience is now YourLevel*1.5 instead of YourLevel+8.

- **KLS** You'll only get an experience loss message if you actually lose exp now, no more You lost experience messages when you take a 0% rez.

## 12/15/2006¶

- **FatherNitwit** Fix for possible crash when NPCs are immune to damage.

- **KLS** Small fix for newly created player corpses, hopefully they will no longer act like they are npc corpses.

- **KLS** Changed how recourse works a bit, it is now done after the resist check.

- **KLS** Group spells should be able to land on the caster's pet now.

- **KLS** Fixed crazy Bash/Kick damage.

## 12/09/2006¶

- **KLS** Stun immune should apply to spin effects such as those found in One Hundred Blows.

- **KLS** Some cleanups in special attack and resist code.

- **KLS** Added a define SKILL_MAX_LEVEL in features.h that lets you define how high level you can get skills from the database, defaults to 75.

- **KLS** Damage shields wont proc on yourself any longer to avoid some wierdness. They only ever procced on yourself under special conditions so it shouldn't be noticable.

## 12/03/2006¶

- **FatherNitwit** Fixed a few issues related to quest global expiration.

## 12/01/2006¶

- **KLS** NPC ghosting fix with rule support.

- **FatherNitwit** Fixing up spell set loading crash.

- **KLS** More skill fixes

- **KLS** Moved the old class_skills system over to the new skills system.

## 11/28/2006¶

- **FatherNitwit** (bleh) Added #hatelist command.

- **FatherNitwit** (bleh) Work on windows build issues.

- **FatherNitwit** Optimized merchant list query during zone boot.

- **FatherNitwit** Fix a few race related issues in eqbuilder.

## 11/26/2006¶

- **FatherNitwit** Fixed berserker skill cap issue that KLS found.

## 11/25/2006¶

- **KLS** The way resists are calculate have been changed and are now somewhat tweakable with rules, and partial hits should work correctly.

- **KLS** Ripostes have been seperated from the attack code and will now apply to all attacks.

- **KLS** Skills and Spells that directly modify melee damage should now work and be applied to all attacks.

- **KLS** Some fixes and optimizations in the attack code.

- **KLS** Familiars will no longer aggro like regular pets.

- **KLS** Damage Shield Bonuses on items should no longer be backwards.

- **KLS** Heals will report the amount of damage healed to their targets and casters.

- **KLS** Pets will now spawn at %t\s pet instead of %t's pet, the client filters out ' in certain things like combat and considering.

- **KLS** Stun Immunity will now only apply to the stun portion of the spell instead of the whole spell.

- **KLS** Instrument Mods should send correctly on the reapplication of bard pulses.

- **KLS** Spells should no longer check instant heals/damage portions of the spell for stacking purposes, several spells that should have stacked before but didn't now should properly.

=11/24/2006

## 11/20/2006¶

- **KLS** Skill system tweaks and bug fixes.

- **KLS** Bard songs will now skill up while they are being sung instead of just when first cast.

=11/19/2006

## 11/07/2006¶

- **KLS** Changed how critical hits work, as a result things that could not crit before like special attacks, now can.

- **KLS** Cleave like effects should be fixed to do an increase of your already standing chance to critical instead of a flat increase.

- **KLS** Reworked much of the special attack code.

- **KLS** Applied haste to combat skill timers, they should give trouble much less often.

- **KLS** Monk skill damage will be more random but the max damage they can do has not changed.

- **KLS** Skills should be avoided less often, they were being avoided twice in the code instead of once.

- **KLS** Implemented basic strikethrough.

## 11/06/2006¶

- **FatherNitwit** (Cripp) periodic auto save.

- **FatherNitwit** LostZaphod's possible win32 azone fix. (untested)

- **FatherNitwit** (cbodmer) Regen multiplier rules.

## 11/04/2006¶

- **Rogean** Haste Fixes: Fixed Haste/Slow as well as Bard Songs (Including Overcap).

## 11/03/2006¶

- **KLS** Added Magoth's stun opcodes for both Titanium and 0.6.2 clients

- **KLS** Changed Object Clear opcode for Titanium

## 10/30/2006¶

- **FatherNitwit** (KLS) Fixes for max endurance calc on zone in

- **FatherNitwit** (KLS) Fix for rulesystem category issue.

- **FatherNitwit** Added rule support to world (no runtime manipulation yet)

- **FatherNitwit** Load the 'default' ruleset from the DB if no variable is set.

- **KLS** Fix for client corpses not appearing to clients who witnessed their death until they zone.

- **KLS** Updated detrimental and healing spell aggro.

- **KLS** Hate mods from spells should now work. (Enchanter Visage/Shadowknight Voice line of spells)

- **KLS** Found and implemented the Hate Added in detrimental spells. (Shadowknight Terror line of spells)

- **KLS** Change to let special messages use their correct types.

- **KLS** Group fix for leader being unable to invite a 3rd party member until he/she zones.

- **KLS** GroupInvite2 opcodes found for both Titanium and 0.6.2, make sure to get the updated .conf files.

- **KLS** Glow messages should only go off for instant spells.

- **KLS** How haste calculations have been calculated has been reworked somewhat, haste shouldn't break any more, nor should all hastes stack.

## 10/28/2006¶

- **FatherNitwit** Fix for NPC weapon appearance due to loot items.

- **aza77** Fixed SendAppearancePacket

- **aza77** Fixed a PvP bug that caused the zone to crash on death

## 10/26/2006¶

- **FatherNitwit** WildcardX's name cleanup.

- **FatherNitwit** Tweak for 64 bit pointer support in the item code of the struct strategy.

- **FatherNitwit** More const cleanup in npc.h

## 10/22/2006¶

- **FatherNitwit** added EVENT_COMBAT triggered when an NPC engages any form of

- **FatherNitwit** combat and when combat is over. $combat_state signals which.

- **FatherNitwit** Hopefully fixed d_meele_texture

- **FatherNitwit** Cleaned up a lot of const related issues (attrs, AAs, and more)

- **FatherNitwit** Moved a lot of NPC specific stuff from Mob into NPC

- **FatherNitwit** Reworked special attacks a bit (monk, kick, backstab):

- **FatherNitwit** they now use the standard combat hit chance forumals based on offense/defense instead of always hitting

- **FatherNitwit** they are now subject to damage avoidance (parry, riposte, etc.) like normal attacks

## 10/21/2006¶

- **FatherNitwit** Hopefully fixed spawn timer variance.

## 10/18/2006¶

- **FatherNitwit** Maybe fixed issue with losing items when zoning in mysql 5.

- **FatherNitwit** Fixed issue with color saving properly.

## 10/15/2006¶

- **FatherNitwit** (KLS) Implemented Endurance

- **FatherNitwit** (KLS) Implemented support for seperate discipline timers

- **FatherNitwit** (KLS) Fix for haste & slow issue on NPCs

- **FatherNitwit** (KLS) Fixed faction not changing issue (caused by min/max sticking fix)

- **FatherNitwit** (KLS) Changed con level code to be more accurate

- **FatherNitwit** Made /pet attack range a rule (Pets:AttackCommandRange) default to 150.

- **FatherNitwit** (KLS) Changed how consider and consider corpse is handled a bit, consider corpse should be more informative

- **FatherNitwit** (KLS) Fixed bug with charged/stacked items on corpses.

- **FatherNitwit** (KLS) Support for leaving naked corpses

- **FatherNitwit** Added rules: Character:DeathExpLossLevel, Character:CorpseDecayTimeMS

- **FatherNitwit** Character:LeaveNakedCorpses

- **FatherNitwit** Replaced db variable 'leavecorpses' with rule Character:LeaveCorpses

- **FatherNitwit** (KLS) hopefully fixing monk kill crash.

- **FatherNitwit** (KLS) made it so you can snare things while they're rooted

- **FatherNitwit** (KLS) made it so beneficial songs will stack with beneficial spells

- **FatherNitwit** (KLS) made it so a beneficial effect and a detrimental of an effect don't conflict

- **FatherNitwit** (KLS) let dots of the same resist type stack so long as they aren't the same spell

- **FatherNitwit** cleanup windows logging a bit

- **FatherNitwit** (eq4me) GCC 4+ build fixes

## 10/05/2006¶

- **FatherNitwit** (KLS) Fix for explicit spell stacking rule problem.

## 10/02/2006¶

- **FatherNitwit** (InsaneWallaby) Tradeskill skill gain fix.

- **FatherNitwit** (WildcardX) Improved spawnstatus command.

- **FatherNitwit** (number6) Work around for lay hands/harm touch recovery time hang.

- **FatherNitwit** Possible fix for faction sticking at min/max.

## 09/21/2006¶

- **FatherNitwit** Revert part of bard mod fix, and fix it right.

## 09/20/2006¶

- **FatherNitwit** Prevent stats from going negative.

- **FatherNitwit** Try to prevent skills from wrapping above 252 (still no support for higher)

- **FatherNitwit** Minor shop close tweak.

- **FatherNitwit** (Zuesrooster) Potential bard modifier fixes.

=09/07/2006

## 08/20/2006¶

- **FatherNitwit** Zero out buff counters when we occupy a new slot.

## 08/16/2006¶

- **FatherNitwit** Glorandwarf's updated AA.h

## 08/14/2006¶

- **FatherNitwit** More work on titanium AAs by Glorandwarf.

- **FatherNitwit** (Zuesrooster) Fix for pet self buffing.

## 08/10/2006¶

- **FatherNitwit** Changed logic in quest parser to potentially avoid windows crash (Zuesrooster)

- **FatherNitwit** (Zuesrooster) fixed aggro quest related crash.

- **FatherNitwit** Untested update of OP_AugmentItem (John Adams)

- **FatherNitwit** A little bit further on AAs (Glorandwarf)

## 07/27/2006¶

- **FatherNitwit** Added door info dump on click (DOORS__INFO)

## 07/23/2006¶

- **FatherNitwit** Enforce some zone requirements on zone in too.

- **FatherNitwit** Fixed minor tradeskill crash.

## 07/23/2006¶

- **FatherNitwit** (EverHood) Archery/self PvP mitigation changes

- **FatherNitwit** (EverHood) Regen tweaks

- **FatherNitwit** (EverHood) Fix DoT damage and messages

- **FatherNitwit** Killed erronious double-effects on regen/HoT buffs

- **FatherNitwit** Fixed replace-container client side appearance issue.

## 07/17/2006¶

- **FatherNitwit** Added new rules subsystem to allow game rules to be changed

```
` at runtime. more about this will come as time goes on.
`
```

- **FatherNitwit** Added #rules command to manage rules data from in game.

- **FatherNitwit** Renamed old #rules to #serverrules

- **FatherNitwit** Moved max level into the rules system (Character:MaxLevel)

- **FatherNitwit** Added GM-trained tradeskill caps to rule system (Skills:MaxTrainTradeskills)

- **FatherNitwit** Fixed intimidation skill cap

- **FatherNitwit** Fixed adventure opcodes for adventure merchants on Ti.

- **FatherNitwit** Fix interrupt cast opcode for Ti.

- **FatherNitwit** Tweak to missing-spell-creagent case, might fix it?

Requred SQL:

CREATE TABLE rule_sets (

ruleset_id TINYINT UNSIGNED NOT NULL auto_increment,

name VARCHAR(255) NOT NULL,

PRIMARY KEY(ruleset_id)

);

INSERT INTO rule_sets VALUES(0, "default");

UPDATE rule_sets SET ruleset_id=0;

CREATE TABLE rule_values (

ruleset_id TINYINT UNSIGNED NOT NULL,

rule_name VARCHAR(64) NOT NULL,

rule_value VARCHAR(10) NOT NULL,

INDEX(ruleset_id),

PRIMARY KEY(ruleset_id,rule_name)

);

## 07/16/2006¶

- **FatherNitwit** (EverHood) Implemented Eye of Zomm and Bind Sight

- **FatherNitwit** Reworked Eye of Zomm code

## 07/16/2006¶

- **aza77** Fixed the lift issue + keyitems at doors

- **aza77** Fixed + modified traps and added a new type of trap

ALTER TABLE `traps` ADD `message` VARCHAR( 200 ) NOT NULL AFTER `effectvalue2` ;

## 07/13/2006¶

- **FatherNitwit** Fixed zone crash when removing a guild member.

- **aza77** Added in game guild creation variables.GuildCreation + commands #guildcreate #guildapprove #guildlist

- **FatherNitwit** Fixed feign aggro crash.

## 07/12/2006¶

- **aza77** Added triggered only doors.

## 07/10/2006¶

- **FatherNitwit** Adding EverHood's lull fixes.

## 07/09/2006¶

- **FatherNitwit** Wizardanim has dicovered the opcode to partiall fix AAs for Ti!!

- **FatherNitwit** EverHood's Mob ghost running on (feign)death fix.

- **FatherNitwit** Redid walkspeed code to be caclualted from runspeed (EverHood inspired)

- **FatherNitwit** Fixed up run AA speed mods.

- **FatherNitwit** Added EVENT_NPC_SLAY when NPCs kill another NPC. (fanman55 inspired)

- **FatherNitwit** Fixed up a long running memory issue in quest::ChooseRandom

ALTER TABLE `npc_types` DROP walkspeed;

## 07/05/2006¶

- **aza77** Added variables.Rules + commands #rules #acceptrules

ALTER TABLE `account` ADD `rulesflag` TINYINT( 1 ) UNSIGNED NOT NULL DEFAULT '0';

## 07/04/2006¶

- **FatherNitwit** Maybe fixing feign memory.

- **FatherNitwit** EverHood's temp pets and group recourse fixes.

- **FatherNitwit** EverHood's NoLongerEngaged AI fix.

- **FatherNitwit** bufgix in log.ini reading.

## 06/29/2006¶

- **aza77** Get the SQL right:

ALTER TABLE `npc_types` CHANGE `hp_regen_rate` `hp_regen_rate` INT( 11 ) NOT

NULL DEFAULT '0';

ALTER TABLE `npc_types` CHANGE `mana_regen_rate` `mana_regen_rate` INT( 11 ) NOT

NULL DEFAULT '0';

## 06/28/2006¶

- **FatherNitwit** Added EverHood's feign memory fixes

- **FatherNitwit** Reverted regen of 0 to mean "auto config", and negative to mean "no regen"

- **aza77** Changed hp_regen + mana_regen such that negative values indicate no regen

ALTER TABLE `npc_types` CHANGE `hp_regen_rate` `hp_regen_rate` INT( 11 ) NOT

NULL DEFAULT '0';

ALTER TABLE `npc_types` CHANGE `mana_regen_rate` `mana_regen_rate` INT( 11 ) NOT

NULL DEFAULT '0';

UPDATE `npc_types` SET `hp_regen_rate` = '0' WHERE `hp_regen_rate` = '-1';

UPDATE `npc_types` SET `mana_regen_rate` = '0' WHERE `mana_regen_rate` = '-1';

## 06/27/2006¶

- **aza77** Added quest::setnextinchpevent + $inchpevent

- **aza77** Added quest::sethp

## 06/25/2006¶

- **aza77** Fixed PVP appearance issues

- **FatherNitwit** Fixed the #logsql command

## 06/20/2006¶

- **FatherNitwit** tweaked some ability timers and fixed up ranger crit damage

## 06/18/2006¶

- **FatherNitwit** necro DOT feign death fix (unicorn97211)

- **FatherNitwit** Disable kill-pet-on-feigndeath by default (features.h FEIGN_KILLS_PET)

MySQL 5 compatibility increases (WildcardX):

alter table account DROP packencrypt;

alter table character_ change extprofile extprofile blob NULL;

alter table player_corpses change data data blob NULL;

alter table player_corpses_backup change data data blob NULL;

## 06/15/2006¶

- **aza** Added MySQL5 support (FOR CUSTOM COMPILE ONLY)

ALTER TABLE spawn2 CHANGE `condition` `_condition` MEDIUMINT(8) UNSIGNED NOT

NULL DEFAULT '0';

## 06/07/2006¶

- **FatherNitwit** Fixed SetAATitle (#title), and experted it to perl.

- **FatherNitwit** Fixed quest money reward printing. (WildcardX)

## 06/03/2006¶

- **FatherNitwit** Fixed a client-side inventory appearance issue, may help with trade bugs.

## 05/31/2006¶

- **FatherNitwit** (aza) Added quest::unscribespells

- **FatherNitwit** fixed ranger critical hit chance.

- **FatherNitwit** Implemented conditions on windows.

- **FatherNitwit** maybe made NPCs stop buffing pets.

- **FatherNitwit** Fixed npc spawn limits.

- **FatherNitwit** Fixed feign death missing opcode.

- **FatherNitwit** Hopefully fixed an issue causing server to slow down terribly after being up for a day+.

- **FatherNitwit** Fixed crash on zone/world shutdown.

ALTER TABLE spawnentry DROP spawn_limit;

ALTER TABLE spawngroup ADD spawn_limit tinyint(4) NOT NULL default '0';

ALTER TABLE altadv_vars ADD class_type int unsigned NOT NULL DEFAULT 0;

## 05/06/2006¶

- **FatherNitwit** (aza) Enabled newer froglok classes.

- **FatherNitwit** (aza) Enabled several berserker combat skills.

- **FatherNitwit** Fixed possibly infinite recursion in map code.

- **FatherNitwit** Holding EQStreams open until they send all their data.

- **FatherNitwit** Trying to fix death disconnect (and failing)

- **FatherNitwit** Maybe fixed tinkering searching.

## 04/24/2006¶

- **FatherNitwit** Added new HTTP functionality for moving chars between accounts.

## 04/21/2006¶

- **FatherNitwit** Fixed bane damage loading problem.

## 04/20/2006¶

- **FatherNitwit** Hopefully fixed the unidentified stream crash and some memory leaks.

- **FatherNitwit** Fixed weapon affinity huge proc bonuses

- **FatherNitwit** Fixed spell-granted procs not getting removed.

- **FatherNitwit** Implemented the 'procrate' field on items.

## 04/13/2006¶

- **FatherNitwit** Fixed the issue of charmed mobs getting assists from their old friends.

- **FatherNitwit** Changed version number to 0.7.0

## 04/13/2006¶

- **FatherNitwit** fixed a crash related to client destructors and tradeskills

- **FatherNitwit** Adding the incstats canges from aza on the forums.

## 04/01/2006¶

- **FatherNitwit** FINALLY found and fixed the netcod crash I introduced a while back.

- **FatherNitwit** Fixed bard group buff tics.

- **FatherNitwit** Fixed the global guild chat going to everybody problem.

## 03/27/2006¶

- **Doodman** Added queuing for future packets, fixing lag reported by Richardo

## 03/25/2006¶

- **FatherNitwit** Fixed character deletion to remove guild member entries. (Aeris1)

## 03/24/2006¶

- **Doodman** Added live struct strategy. Can get to char select

## 03/22/2006¶

- **Doodman** Fixed Ti items

- **Doodman** Added some field name mappings to load_13thfloor_items script.

UPDATE items SET stackable=1 WHERE itemtype IN (14, 15, 17, 18, 19, 27, 37, 38, 55, 56);

## 03/22/2006¶

- **FatherNitwit** Refactored the netcode to move the opcode manager back into the stream.

## 03/21/2006¶

- **Doodman** Merge up from Source branch

- **Doodman** Fixed CreateItem

## 03/20/2006¶

- **FatherNitwit** Fixed invisibility vs. undead to only apply to undead mobs.

- **FatherNitwit** Added `slot` column to starting items to support much more robust configurations.

- **FatherNitwit** Updated char backups. (noted by typhoon)

Required SQL:

ALTER TABLE starting_items ADD slot MEDIUMINT NOT NULL DEFAULT -1;

ALTER TABLE character_backup ADD class TINYINT NOT NULL DEFAULT 0;

ALTER TABLE character_backup ADD level MEDIUMINT UNSIGNED NOT NULL DEFAULT 0;

ALTER TABLE character_backup DROP guild;

ALTER TABLE character_backup DROP guildrank;

ALTER TABLE character_backup DROP publicnote;

## 03/19/2006¶

- **FatherNitwit** A bunch of minor changes, should help some bugs in 0.6.6.

- **FatherNitwit** Wrote basic guild management pages, much more needed.

## 03/18/2006¶

- **FatherNitwit** Queue fix in netcode, should help crashing problem.

- **Doodman** Redid world port allocation not start looking for a port at the begining each time

- **Doodman** Made zone send it's port to world on connect, in case it is reconnecting to a restarted world

- **FatherNitwit** Changed version number to 0.6.6

- **FatherNitwit** Un-broke some outbound TCP connection stuff I broke to allow reconnecting.

- **FatherNitwit** Completely rewrote guilds in both world and zone.

- **FatherNitwit** Removed guilds from shared memory.

- **FatherNitwit** Removed the seperation between EQ ID and DB ID.

- **FatherNitwit** Fixed countless rediculous things about guilds.

- **FatherNitwit** Any change in guild state should update in real time now.

- **FatherNitwit** Guild leadership may need re-establishing since it changed from account to char based.

- **FatherNitwit** Guild structure in database has changed significantly.

Note: custom rank stuff is too much work for me to preserve in the DB, since I doubt

anybody uses it, so if you have them, you can figure it out yourself or remake them.

Required SQL:

ALTER TABLE character_ ADD class TINYINT NOT NULL DEFAULT 0;

ALTER TABLE character_ ADD level MEDIUMINT UNSIGNED NOT NULL DEFAULT 0;

CREATE TABLE guild_ranks ( guild_id MEDIUMINT UNSIGNED NOT NULL, rank TINYINT UNSIGNED NOT NULL, title VARCHAR(128) NOT NULL, can_hear TINYINT UNSIGNED NOT NULL, can_speak TINYINT UNSIGNED NOT NULL, can_invite TINYINT UNSIGNED NOT NULL, can_remove TINYINT UNSIGNED NOT NULL, can_promote TINYINT UNSIGNED NOT NULL, can_demote TINYINT UNSIGNED NOT NULL, can_motd TINYINT UNSIGNED NOT NULL, can_warpeace TINYINT UNSIGNED NOT NULL, PRIMARY KEY(guild_id,rank) );

## guild1 < guild2 by definition.¶

CREATE TABLE guild_relations ( guild1 MEDIUMINT UNSIGNED NOT NULL, guild2 MEDIUMINT UNSIGNED NOT NULL, relation TINYINT NOT NULL, PRIMARY KEY(guild1, guild2) );

CREATE TABLE guild_members ( char_id INT NOT NULL, guild_id MEDIUMINT UNSIGNED NOT NULL, rank TINYINT UNSIGNED NOT NULL, tribute_enable TINYINT UNSIGNED NOT NULL DEFAULT 0, total_tribute INT UNSIGNED NOT NULL DEFAULT 0, last_tribute INT UNSIGNED NOT NULL DEFAULT 0, banker TINYINT UNSIGNED NOT NULL DEFAULT 0, public_note TEXT NOT NULL DEFAULT '', PRIMARY KEY(char_id) );

ALTER TABLE guilds DROP eqid; ALTER TABLE guilds DROP rank0title; ALTER TABLE guilds DROP rank1title; ALTER TABLE guilds DROP rank1; ALTER TABLE guilds DROP rank2title; ALTER TABLE guilds DROP rank2; ALTER TABLE guilds DROP rank3title; ALTER TABLE guilds DROP rank3; ALTER TABLE guilds DROP rank4title; ALTER TABLE guilds DROP rank4; ALTER TABLE guilds DROP rank5title; ALTER TABLE guilds DROP rank5; ALTER TABLE guilds ADD tribute INT UNSIGNED NOT NULL; ALTER TABLE guilds ADD motd_setter varchar(64) NOT NULL DEFAULT '';

INSERT INTO guild_members (char_id,guild_id,rank,public_note) SELECT id,guild,guildrank,publicnote FROM character_ WHERE guild > 0 AND guild < 1500;

ALTER TABLE character *DROP guild; ALTER TABLE character* DROP guildrank; ALTER TABLE character_ DROP publicnote;

## 03/11/2006¶

- **FatherNitwit** Redid netcode outbound queue to properly handle sequence wrapping.

## 03/10/2006¶

- **Doodman** Worked up serialization for Ti and Live (/snicker)

- **Doodman** Converted the item table to match live (13th-floor) changes below (apply both)

- **Doodman** Worked items to be compatible for both (kept loreflag and loregroup)

6.2 -> Ti:

ALTER TABLE items CHANGE loreflag loregroup int not null;

ALTER TABLE items CHANGE UNK117 UNK123 int not null;

ALTER TABLE items CHANGE UNK150 UNK157 int not null;

ALTER TABLE items CHANGE UNK145 UNK152 int not null;

ALTER TABLE items CHANGE UNK140 UNK147 int not null;

ALTER TABLE items CHANGE UNK135 UNK142 int not null;

ALTER TABLE items CHANGE UNK130 UNK137 int not null;

ALTER TABLE items CHANGE UNK124 UNK130 int not null;

ALTER TABLE items CHANGE UNK121 UNK127 int not null;

ALTER TABLE items CHANGE UNK118 UNK124 int not null;

ALTER TABLE items ADD augslot1unk int not null AFTER augslot1type; ALTER TABLE items ADD augslot2unk int not null AFTER augslot2type; ALTER TABLE items ADD augslot3unk int not null AFTER augslot3type; ALTER TABLE items ADD augslot4unk int not null AFTER augslot4type; ALTER TABLE items ADD augslot5unk int not null AFTER augslot5type; ALTER TABLE items ADD enduranceregen int not null AFTER manaregen; ALTER TABLE items ADD notransfer int not null AFTER stacksize; ALTER TABLE items ADD UNK133 int not null AFTER notransfer;

Ti -> Live: ALTER TABLE items ADD UNK134 varchar(255) not null AFTER UNK133;

ALTER TABLE items CHANGE UNK130 potionbeltslots int not null; ALTER TABLE items CHANGE UNK133 stackable int not null;

## 03/08/2006¶

- **FatherNitwit** (BatCountry) Fixed throwing item crash.

- **FatherNitwit** (Hvitrev) Implemented Primsatic and Chromatic resists.

## 03/07/2006¶

- **FatherNitwit** Fixed up adding a launcher to not falsely report an error.

- **Doodman** Fixed sending old style info from world->ls (fixing minilogin)

- **Doodman** Fixed TCPConnection cleanup on socket closed by the remote

## 03/06/2006¶

- **Doodman** Fixed deadlock when zones are shutting down.

- **Doodman** Fixed MakeUpperString and MakeLowerString to function correctly on a NULL string

- **Doodman** Made HTTPSocket inherit from TCPConnection instead of using

- **Doodman** Fixed HTTP POST processing (needs a good workout still)

## 03/05/2006¶

- **FatherNitwit** Developed stream proxy, stream identifier, and struct strategy to support dynamic structures.

- **FatherNitwit** Developed initial patch support for 0.6.2 and Titanium.

## 03/04/2006¶

- **FatherNitwit** Fixed some broken logging in world.

- **FatherNitwit** Fixed the potential crash when zone connects to world.

## 03/04/2006¶

- **FatherNitwit** Significantly refactored the old TCPConnection/TCPServer code.

- **FatherNitwit** Rewrote almost the entire web server to get rid of most of the socket lib.

- **FatherNitwit** Removed everything but the HTTP framework from the socket lib.

- **FatherNitwit** Rewrite better have fixed the windows crash.

## 02/28/2006¶

Changed version number to 0.6.5-DR1

- **Doodman** Put in new XML configuration object and made zone/world use them

- **Doodman** Added auto ip configuration to world/LS

- **Doodman** Added auto ip/port configuration to zone

- **Doodman** Reworked logging in world to use the new logsys

- **Doodman** Made TCPConnection detect a closed socket like it should

- **FatherNitwit** Significantly refactored world for better code organization.

- **FatherNitwit** Significantly refactored the database object for better organization.

- **FatherNitwit** Fixed several valgrind errors.

- **FatherNitwit** Developed a custom webserver for world.

- **Doodman** Developed direct database support from perl.

- **FatherNitwit** Wrote many objects and pages for world.

- **Doodman** Wrote many objects and pages for world.

- **Doodman** Moved addon.ini (commands) into the database with world pages.

- **FatherNitwit** Developed a launcher for zone.

- **FatherNitwit** Developed world HTTP pages to manage launcher.

- **FatherNitwit** Fixed several issues with stats loading from the database.

- **FatherNitwit** Fixed high stat loading from the database.

- **FatherNitwit** Added `#grid max` command to help with grid creation.

- **FatherNitwit** Significant adjustments to combat, should bring things closer to live. Make sure your mobs have stats in the DB!

- **FatherNitwit** Fixed procs for NPCs with proc-only spell sets.

CREATE TABLE launcher ( name VARCHAR(64) NOT NULL, dynamics TINYINT UNSIGNED NOT NULL, PRIMARY KEY(name) );

CREATE TABLE launcher_zones ( launcher VARCHAR(64) NOT NULL, zone VARCHAR(16) NOT NULL, port MEDIUMINT NOT NULL DEFAULT '0', PRIMARY KEY(launcher,zone) );

CREATE TABLE commands ( command varchar(20) NOT NULL default '', access tinyint(3) unsigned NOT NULL default '0', PRIMARY KEY (command) );

## 01/20/2006¶

- **FatherNitwit** Reworked melee and ranged attack code significantly.

- **FatherNitwit** Properly support recomended level on weapon DMG now.

- **FatherNitwit** Re-implemented racial/body bane damage and elemental damage.

- **FatherNitwit** Added "Immune to Non-Magical Melee" flag to NPCs (W)

- **FatherNitwit** Added "Immune to non-Bane Melee" flag to NPCs (O)

- **FatherNitwit** Added canbind flag to zone table to completely prevent binding in certain zones.

Required SQL:

ALTER TABLE zone ADD canbind TINYINT NOT NULL DEFAULT '1';

## 01/14/2006¶

- **FatherNitwit** Fixed ranged misses not generating hate.

- **FatherNitwit** Find is as working as good as it ever was (straight line)

## 01/13/2006¶

- **FatherNitwit** Made some changes to buff stacking rules reguarding DoTs and beneficial overwrite.

## 01/12/2006¶

- **FatherNitwit** Fixed the "Buffs do not apply effects in client after zoning" issue.

## 01/09/2006¶

- **FatherNitwit** Made NPCs actually load: resists, attack_speed, findable

- **FatherNitwit** npc_types cleanup day (they dont work or are not used):

ALTER TABLE npc_types ADD attack_speed float NOT NULL default '0';

ALTER TABLE npc_types DROP ipc;

ALTER TABLE npc_types DROP banish;

ALTER TABLE npc_types DROP social;

## 01/08/2006¶

- **FatherNitwit** Fixed more windows compile errors on .net 2003+...

## 01/07/2006¶

- **FatherNitwit** Fixed VS.net projects and compiling. (.net 2002)

## 01/04/2006¶

- **FatherNitwit** Fixed the quad special attack to not require triple in order to work.

## 01/03/2006¶

- **FatherNitwit** Added new debug logging facility. Will be implemented further in the time to come

- **FatherNitwit** Added command #mlog to manipulate the new logging facility.

- **FatherNitwit** Load log settings from log.ini if present.

- **FatherNitwit** Made GM's fade detrimental buffs when they die.

- **FatherNitwit** Reworked much of the spell casting subsystem.

- **FatherNitwit** Reworked bards, they should work OK now!

- **FatherNitwit** Debug Logging written for: spell casting, spawns, spawn conditions

- **FatherNitwit** Fixed block training for monks and beastlords

- **FatherNitwit** Fixed damage shields

- **FatherNitwit** Fixed a bunch of spell stacking issues

- **FatherNitwit** Properly enforced range checking on all spells.

- **FatherNitwit** Hopefully fixed long recast delay enforcement.

- **FatherNitwit** Removed rule that disallowed beneficial spells cast by NPCs on PCs

- **FatherNitwit** Hopefully fixed pottery firing.

- **FatherNitwit** Fixed NPC buffing faction checks.

- **FatherNitwit** Added LOS checks for detrimental AOE spells.

- **FatherNitwit** Changed version number to 0.6.4DR1

---

## 2007

*Source: changelog/server/2007/index.html*

# 2007¶

## 12/06/2007¶

- **KLS** Fixed logic on duration 7 formula.. again.

## 12/02/2007¶

- **KLS** Reworked buff duration formula 7 calculations.

- **KLS** (Cripp)Added (Missing?) pathing z rules.

## 11/30/2007¶

- **FatherNitwit** Reworked pathing z code to be rules based instead of built time options.

## 11/29/2007¶

- **FatherNitwit** (Derision) Fix BestZ pathing cleanup code top stop hopping.

- **FatherNitwit** (Derision) New fix-z-on-load feature.

## 11/28/2007¶

- **Rogean** Fixed another no-drop trade hack.

## 11/26/2007¶

- **KLS** Dynamic zones will now not attempt to boot up more than one instance of the zone if two or more clients request it in quick succession.

- **KLS** Fixed: qglobals will now not be exported for npcs that do not have the qglobal flag set in the perl parser.

- **KLS** Added a new npc special attack 'H' for immune to aggro, mobs with this set should not aggro no matter what a person does to them.

- **KLS** Fixed ATK loading in item bonuses

- **KLS** AEDuration calculation will now take target type into account correctly

- **KLS** Player pets should now persist through a teleport spell

- **KLS** Players will now be able to target themselves for group spells if they are not in a group

- **KLS** Fixed some buff duration oddities.

- **KLS** Level should have somewhat less of an impact for players in the resist code.

## 11/14/2007¶

- **KLS** Swarm pets should be forced to correctly depop after their owner disappears.

- **KLS** NPCs should be able to use swarm pets correctly now.

- **KLS** #traindisc should no longer learn disciplines over already known disciplines.

- **KLS** Added a few more known spell effects to spdat.h, not implemented any yet

- **KLS** Rez experience should now only goto regular experience, not AA experience.

## 11/07/2007¶

- **KLS** Reworked swarm pets a bit

- **KLS** Swarm pets should no longer crash zones(I hope)

- **KLS** Swarm pets will now gain all their information from the normal pet tables and the spell data, as a result the aa_swarmpets table is now obsolete.

## 11/06/2007¶

- **KLS** Reverted client timeouts.

- **KLS** Fixed NPC HP and Mana Regen not loading from DB for NPCs

## 11/05/2007¶

- **WildcardX** Fixed a bug that prevented player corpse summoning spells from working on Linux platforms.

## 11/04/2007¶

- **WildcardX** The spell "Reanimation" will no longer restore any player experience. This is a 0% experience resurrection.

- **WildcardX** Corpses moved by a consented player will now remember where it was moved to, even after a zone restart.

- **WildcardX** Necromancers and Shadowknights can now summon corpses belonging to other players.

- **WildcardX** Corrected a bug that would have allowed Necromancers and Shadownights to summon corpses belonging to non-grouped party members.

## 11/03/2007¶

- **WildcardX** (Cavedude) Implemented perl wrappers for new quest methods supporting the Shadowrest zone implementation.

- **WildcardX** Fixed a bug that prevented a player from experiencing resurrection effects in designated no combat zones.

- **WildcardX** Fixed a bug in graveyard system that could leave a player corpse in the database, but without a location.

- **WildcardX** Fixed a bug that could prevent the corpse decay timer from expiring because the graveyard timer would reset before.

- **WildcardX** Implemented support for the Shadowrest zone. This is configured to be disabled by default.

- **WildcardX** Implemented the command #summonburriedplayercorpse.

- **WildcardX** Implemented the command #getplayerburriedcorpsecount.

- **WildcardX** Implemented the quest function bool summonburriedplayercorpse(int32 char_id, float dest_x, float dest_y, float dest_z, float dest_heading).

- **WildcardX** Implemented the quest function int32 getplayerburriedcorpsecount(int32 char_id).

Required SQL: alter table player_corpses add column IsBurried TINYINT(3) NOT NULL default 0; alter table player_corpses add column WasAtGraveyard TINYINT(3) NOT NULL default 0; insert into rule_values values(0, 'Zone:EnableShadowrest', 0);

## 11/01/2007¶

- **WildcardX** (TheLieka) Bug fix to discontinue player invisibility when the player loots.

- **WildcardX** (TheLieka) Bug fix to remove a type from the #npcedit loottable command.

- **WildcardX** Implemented corpse graveyard support for all zones. Once a zone is configured for a graveyard, a zone restart is necessary.

- **WildcardX** Zone shutdown and restart will result in all player corpses within the zone to be subject to the graveyard corpse timer.

- **WildcardX** Implemented the command #setgraveyard [zone name]. This command will create a graveyard for the designated zone based on your target's LOC.

- **WildcardX** Implemented the command #deletegraveyard [zone name]. This command will remove the graveyard for the designated zone (does not delete any corpses!).

Required SQL: alter table zone add column graveyard_id float NOT NULL default '0' after safe_z;

DROP TABLE IF EXISTS `graveyard`; CREATE TABLE `graveyard` ( `id` int(11) NOT NULL auto_increment, `zone_id` int(4) NOT NULL default '0', `x` float NOT NULL default '0', `y` float NOT NULL default '0', `z` float NOT NULL default '0', `heading` float NOT NULL default '0', PRIMARY KEY (`id`), UNIQUE KEY `zone_id` (`zone_id`) ) ENGINE=InnoDB DEFAULT CHARSET=latin1;

insert into rule_values values(0, 'Zone:GraveyardTimeMS', 1200000);

## 10/19/2007¶

- **WildcardX** (Bleh) Enhancement to avoid a zone crash by avoiding a null pointer.

- **WildcardX** (UrbeIT) Bug fix to allow pet spells to effect players in PVP.

- **WildcardX** (UrbeIT) Bug fix to allow players to remain invisible while in PVP.

- **WildcardX** (Foin) Bug fix to display the correct pet for Ogre and Iksar beastlords.

- **WildcardX** (slowglass) Bug fix to properly update LDoN points.

- **WildcardX** (cbodmer) Bug fix to allow the bank change button to properly work.

- **WildcardX** (zydria) Bug fix to allow players to meditate while mounted.

- **WildcardX** (Cavedude) Enhancement to allow berserkers and rangers the chance to triple attack.

- **WildcardX** (Cavedude) Enhancement to quest::movepc method to accept a heading value.

## 10/17/2007¶

- **KLS** Quick fix to quest::movegrp

## 10/11/2007¶

- **KLS** Familiars should fall under the pet system instead of their own system now, familiars should act in a much more behaved fashion when it comes to functionality shared with normal pets.

- **KLS** Added a network timeout for clients in zone, clients should linkdead from zone when their connection is suddenly severed.

- **KLS** (AiliaMorisato) Added some checks for item bonuses, bonuses should not calculate if the item is not equipable.

- **KLS** NPCs should now accept signals while engaged in combat.

## 10/10/2007¶

- **FatherNitwit** Quick fix for Divine Aura on pets exploit (KingMort)

## 10/09/2007¶

- **KLS** Tweaked my AC system a bit, should get less default defense and the system should be much more lienent overall,

goal is to allow people to see more of a benefit from having AC.

## 09/24/2007¶

- **FatherNitwit** (sfisque) Quick adjustment to item fishing probability.

## 09/07/2007¶

- **KLS** Fixed melee mitigation and tweaks and a small fix to AC.

- **KLS** Small changes to the order in the getweapondamage code to make it a little more efficient

- **KLS** Added a field that allows you to override a factions innate desire to assist their own faction in battle to the npc_faction table

Required SQL: alter table npc_faction add column ignore_primary_assist tinyint(3) not null default 0;

## 08/31/2007¶

- **KLS** (gernblan) Added spawn group info to #npcstats

- **KLS** (TheLieka) Fix for zone exp modifiers not being used

- **KLS** (inkubus) Lull and harmony spells should land on enemy targets and not cause any aggro, still some work to be done on the AE portion.

- **KLS** (cbodmer) Pet aggro changed, owner will no longer gain more aggro from proximity than the pet

- **KLS** (cbodmer) Support for LDoN style boxes (class 62 + body type 33) implemented

- **KLS** The error in acmod() should no longer complain as much.

Required: Opcode files have changed, be sure to update to the latest .conf files.

## 08/30/2007¶

- **KLS** Reworked Mob::GetWeaponDamage(), it will now return damage done by any item and NULL and will return a

value zero or less if we can't hit a mob with said item

- **KLS** Applied new GetWeaponDamage() to Attack and Special Attack code

- **KLS** Seperated Finishing Blow code to it's own function

- **KLS** Spell procs and innate procs should now function once again

- **KLS** NPC Weapons have more of an impact on NPC attack code now

- **KLS** Some NPC equipped items should correctly add bonuses to NPCs now

- **KLS** NPCs should no longer be able to dual wield with two-handed weapons

- **KLS** NPC weapons should properly show up if the item model is particularly high

- **KLS** Changed NPC_DW_CHANCE in features.h to 100% as default as opposed to the previous 5%

- **KLS** Archery will be affected by various crit AA effects and spell bonuses

- **KLS** Applied haste and slow modifiers to basic NPC special attacks such as kick and bash.

## 08/26/2007¶

- **KLS** Fixed a misplaced field in the titanium spawn structure that was causing some spawn display issues on titanium.

## 08/16/2007¶

- **KLS** Some cleaning up on autofire code

- **KLS** Reintroduction of item animation for archery

## 08/15/2007¶

- **KLS** Fixed an /autofire crash

- **KLS** Added some conditions to RangedAttack() for now. Should keep from using ranged attacks when we shouldn't be allowed to attack.

## 08/14/2007¶

- **KLS** Added /autofire

- **KLS** Fixed up SetAttackTimer() calculations a bit, especially when it comes to ranged attacks. Hopefully fewer instances where ranged attacks will be wasted because of the attack timer.

- **KLS** Ranged attack crits will now work no matter your chance to hit, also changed the appearances a tiny bit and added a min range check for /autofire.

- **KLS** Removed ReadBook packet size checking for now.. it was checking a wrong size and canceling out legitimate book requests

Make sure to update your .conf files to get /autoattack to work.

## 08/12/2007¶

- **KLS** A little bit more tinkering with how potions and stacks work.

## 08/11/2007¶

- **KLS** Fixed stackable potions in the item packet, they should now appear to have 1 charge instead of 0.

- **KLS** Added support for stackable items above 20.

- **KLS** Fixed forage, it will no longer overwrite slot 30 to create it's item, instead it will push the item onto the cursor like it should.

## 08/10/2007¶

- **KLS** Fixed a stacking issue and made res effects not count to normal stacking rules.

- **KLS** Implemented a few more passive AA effects.

- **KLS** Added CanThisClassBlock() for the avoid code

- **KLS** Addressed some inconsistancies in the CanThisClass line of functions, GM classes should be able to do everything their base class can now.

## 08/01/2007¶

- **FatherNitwit** (cavedude) Fix Iksar BL pet appearance.

## 07/30/2007¶

- **Rogean** Fixed an item dupe exploit.

## 07/28/2007¶

- **Rogean** Put in checks for No Drop Trading Hacks

## 07/26/2007¶

- **KLS** Updated AA_Data.sql, still work to be done but should now be more complete than older AA sources.

## 07/22/2007¶

- **FatherNitwit** Fixed another memory leak in world and zone.

- **KLS** Fixed up some message types so they match the client correctly.

## 07/21/2007¶

- **Rogean** Fixed LDoN Merchant Item Inspect

## 07/20/2007¶

- **FatherNitwit** (Striat) Fix for typos in perlparser.cpp to fix quest::me and quest::echo.

- **FatherNitwit** (Striat) Fix argument type in quest::setguild.

- **FatherNitwit** Fixed quest::settime

- **Rogean** Fixed up strikethrough a little

- **Rogean** Removed ability to proc on a riposte attack

- **Rogean** Implimented HoTT (Health of Target's Target) Functionality. This will only work for people with HoTT Built into their interface.

To get UI Files for a Target Window, see http://www.eqemulator.net/forums/showthread.php?p=135291

- **FatherNitwit** Fix a few memory leaks.

Changes to opcode files:

patch_Titanium.conf: OP_TargetHoTT=0x6a12

patch_6.2.conf: OP_TargetHoTT=0x3ef6

## 07/16/2007¶

- **FatherNitwit** (Glather) Fix for mobs showing weapons

- **FatherNitwit** (Cbodmer) Notify owner when buffs wear off pets.

## 6/06/2007¶

- **KLS** (Darkonig) Change to the way tradeskill containers are handled.

- **KLS** (Darkonig) Change to item->isStackable() implementation, should let certain items that the client lets stack also stack server-side.

## 6/01/2007¶

- **KLS** Addressed a memory leak in spell code and a memory leak in NPC destruction code.

## 4/13/2007¶

- **KLS** Fixed an issue with buff duration inc. that was causing buffs to lose their effects (I hope)

## 4/08/2007¶

- **KLS** Added support for the skill Frenzy.

- **KLS** Various tweaks and changes to some passive AA abilities.

- **KLS** Added #traindisc to train disciplines on the target player, #scribespells should no longer memorize disciplines to the spellbook.

- **KLS** Fixed an issue with spells that require components that use item ids higher than 32k

- **KLS** Fixed an issue with AAs and focus effects that increase buff duration not appearing correctly for clients until they zone.

## 4/02/2007¶

- **KLS** Implemented number6 inspired item cooldown timers.

- **KLS** Added rules: NPC:MinorNPCCorpseDecayTimeMS & NPC:MajorNPCCorpseDecayTimeMS to set the decay time in millisecond of mobs below 55 and greater or equal to 55 respectively

- **KLS** Addressed an issue that caused some beneficial spells to generate incorrect aggro amounts.

- **KLS** Implemented some more passive PoP AA skills.

- **KLS** Fixed an problem with avoidance AAs adding chance to be hit instead of subtracting it.

- **KLS** Small change to the way pets and familiars initially aggro, familiars should never aggro now.

- **KLS** Fixed an issue where the combat code was checking for warrior triple attack but the skill check would always fail.

- **KLS** Critical hits should now be filterable as critical hits.

- **KLS** Redid hp and mana calculations based on magelo formulas, should be much more accurate, especially when using AA that increase hp.

- **KLS** Made mend skill checks more lienent, shouldn't ever fail after 200 skill, shouldn't ever hurt you after 150

- **KLS** Initial implementation of hp balance spell effect.

- **KLS** Focus effects that limit max level should now correctly reduce the effect by a percentage if the spell is over the level cap

## 3/26/2007¶

- **FatherNitwit** Optimized the merchantlist_temp query on boot.

## 3/14/2007¶

- **KLS** Put in FNW's requested changes to tradeskill combines from the other day that I almost forgot about

- **KLS** Tradeskill combines should check for container type now.

## 3/11/2007¶

- **KLS** Attack() will not set our target unless we have no target now.

- **KLS** Tweaked some invis and hide stuff to hopefully catch more situations where it should break correctly.

- **KLS** Fixed the spell critical hit ratio to be accurate.

- **KLS** Spell Casting Deftness and Quick Buff should now work with spells that have duration formulas.

- **KLS** NPCs will no longer be restricted by the number of targets on their AE spells.

- **KLS** Spells base_1 will load as a 32 bit signed int instead of a 16 bit signed int, should correct some oddities with certain spells. For example certain summon spells using large item ids.

- **KLS** Fixed a tradeskill exploit with tradeskill containers and experimentation.

## 3/10/2007¶

- **Rogean** Fixed #si and minstatus

## 3/3/2007¶

- **FatherNitwit** Finally rewrote 'make depend' to properly track dependencies in linux builds

## 2/22/2007¶

- **KLS** Some more changes to AA system:

- **KLS** altadv_vars.cost_inc will now be unsigned to allow your skills to cost less per level

- **KLS** Client side aa effects are now loaded from the database once again

- **KLS** Updated AA_data.sql to include AAs up to planes of power.

- **KLS** Added #refundaa as a way for server GMs to refund a players alt ability points and give them back their points.

- **KLS** Implemented limited numbered hits on buffs.

- **KLS** Root and charm will now act as partial capable spells.

- **KLS** Vampires will act as undead, which is consistant with what the client thinks is undead.

Required SQL: CREATE TABLE aa_effects ( id int(10) unsigned NOT NULL auto_increment, aaid mediumint(8) unsigned NOT NULL default '0', slot tinyint(3) unsigned NOT NULL default '0', effectid mediumint(8) unsigned NOT NULL default '0', base1 mediumint(8) unsigned NOT NULL default '0', base2 mediumint(8) unsigned NOT NULL default '0', PRIMARY KEY (id), UNIQUE KEY NewIndex (aaid,slot) ) TYPE=MyISAM;

Optional SQL: Resource AA_Data.sql

## 2/18/2007¶

- **WildcardX** Player casted area of effect detrimental spells will not longer have an affect on players not engaged in PvP.

- **WildcardX** Fixed spawnlimit setting to control the maximum times a given npc_type can spawn in the same zone.

- **WildcardX** (Bleh) Fixed player emote animations.

- **WildcardX** Implemented a server-side check of a Client object's target to avoid it being null.

- **WildcardX** Fixed a zone crash that could occurr during a monk special attack or a rogue's backstab attack.

- **WildcardX** Area of effect beneficial spells will no longer affect non-player characters.

## 2/16/2007¶

- **KLS** Updating Changelog AA work to be more clear as well as the required SQL.

Required SQL: alter table altadv_vars add column cost_inc tinyint(4) not null default 0;

Optionally: Source in AA_data.sql

## 2/15/2007¶

- **WildcardX** Commented out the code supporting the deprecated OP_CloseContainer opcode.

- **WildcardX** Fixed world containers so when one player has closed a world container, another player can open it without the need for the first player to leave the zone.

- **KLS** Initial release of ongoing AA work

- **KLS** Most(Not all) Alternate Advancement abilities up to SoL Class working correctly with correct costs and client side effects

- **KLS** Fixed many many AA related bugs

- **KLS** Fixed Activatable AA buttons on titanium

- **KLS** Added #altactivate command to facilitate the new AA work

- **KLS** Added Character:ConsumptionMultiplier rule.

- **KLS** Server wont send a eat/drink message unless the player forces the client to eat/drink

- **KLS** Fixed an issue with TGB working in a backwards manner.

- **KLS** Fixed an issue with AE bard spells hitting the bard instead of the targets around him.

- **KLS** Fixed an issue with cancel magic spells that made them act as completely beneficial spells.

- **KLS** Added many missing spell effects into spdat.h

- **KLS** Fixed a beneficial aggro issue that was resulting in certain clicky items giving significant amounts of aggro.

- **KLS** MOBs with pets or familiars already out will not attempt to cast pet spells.

- **KLS** Curse, Poison, and Disease counters will go past 256 and all be active but will reset on zoning

- **KLS** Curse counters will work now.

- **KLS** Intimidation should work under the new skill cap rules.

- **KLS** Killing something will no longer clear your server side target unless you killed your target.

- **KLS** Fixed a int to float conversion issue in CalcRecommendedLevelBonus() (as per slowglass' post)

- **KLS** Fixed a crash issue related to resists, should help those crashing after zoning with a spell that has a heartbeat resist such as root.

- **KLS** Removed an unused spell function that didn't make much sense.

## 2/14/2007¶

- **WildcardX** Implemented a cap of 4 mobs affected by targeted area of effect spells. This is consistent with EQ live.

- **WildcardX** Implemented the succor line of spells.

- **WildcardX** Specific mobs can now be toggled as findable or not findable by the track skill. Mobs which are not findable will not appear on any track lists.

Required SQL: alter table npc_types add column trackable tinyint(4) not null default 1;

## 2/13/2007¶

- **WildcardX** Fixed bug that broke #zone command.

## 2/11/2007¶

- **WildcardX** Further enhancements to zone weather system to reduce the amount of work necessary to perform weather and to make it more logical.

- **WildcardX** Added a new opcode for both 6.2 and Titanium clients, OP_ZonePlayerToBind=0x385e. Please be sure to update your .conf files.

- **WildcardX** Implemented the beginnings of what will become a new "system" to deal with zoning.

- **WildcardX** Titanium clients will now zone correctly upon death and will not go link dead and get sent to character select screen.

- **WildcardX** Both 6.2 and Titanium clients will now return character view to first person from corpse hover after completing zone to bind point after death.

- **WildcardX** Group member camping will now auto-disband upon an actual logout.

- **WildcardX** Disbanding a link dead group member will no longer crash the zone.

- **WildcardX** Link dead group members will now automatically remove themselves from group.

- **WildcardX** Many zoning situations will now use "heading". This was largely being ignored before. However, there are still a couple more situations where this needs to be implemented. I will continue implementing "heading" as i continue to work on the zoning code.

- **WildcardX** (Cavedude) Implemented yet another container type to perform even more quest combines.

- **WildcardX** Added additional logging to zone "debug" and "error" to support zoning and intra-zone movement.

- **WildcardX** Group members disbanding in another zone will still fail to appear as removed from group from other group members, but disbanding this group member when he/she rejoins group in zone will no longer crash the zone and you will be able to re-add this former group member without having to destroy the whole group.

## 2/10/2007¶

- **FatherNitwit** Reworked NPC Idle spell casting to avoid extra LOS checks (based on KLS's observations)

- **FatherNitwit** Reworked NPC spell casting timers to be more consistent.

## 2/9/2007¶

- **Doodman** Fixed AdventurePoints_Update_Struct to be the correct struct. Same structure for both 6.2 and Ti. Changed core structure.

## 2/1/2007¶

- **WildcardX** (Bleh) Fixed quest globals.

- **WildcardX** Fixed the common error message MakeNameUnique() has been recording in logs about being unable to make a unique name for mobs greater than 100 in a zone.

Required SQL: ALTER TABLE quest_globals CHANGE expdate expdate INT;

## 1/29/2007¶

- **WildcardX** Cleaned up zone weather code for better efficiency. Weather checks will be more frequent when their is snow or rain and less frequent when the sun is out.

- **WildcardX** Made weather log messages more consistent and informative.

- **WildcardX** Druids are now replace bards has the second best tracker in the game. This is consistent with live.

- **WildcardX** Fixed tracking skill. Tracking will now return a full list of every mob within the tracker's skill range, not just the first 100 mobs.

- **WildcardX** Clients will now see their coins update from quests or player trades. No zoning is required anymore.

- **WildcardX** The server is now using the OP_MoneyUpdate opcode, instead of OP_MoneyOnCorpse opcode for coin updates.

- **WildcardX** Clients entering a zone will now receive a weather packet. This will ensure all clients in the same zone will experience the same weather.

## 1/23/2007¶

- **KLS** Fixed the change log so the current entries are correct

- **KLS** Fixed a small but significant crash.

## 1/15/2007¶

- **KLS** Fixed an issue with storing timers.

- **KLS** Added in hide and basic support of hide improving AAs later

- **KLS** Some more changes to how procs work, perma procs will not be influenced by mob stats, should make them easier to balance.

- **KLS** Some internal changes to critical hits with some future spell effects in mind shouldn't change functionality.

- **KLS** WildCardX's key changes, keys should now work even if they're not on your cursor and no matter where in your inventory it's on you, including your bank

- **KLS** Pickpocket should work considerably better.

- **KLS** Removed some obsolete discipline code that I ran across.

- **KLS** Character:ExpMultiplier rule should work correctly now.

- **KLS** Fixed an issue with the client position update code that should see the server sending fewer redundant client position update packets.

Required SQL:

ALTER TABLE `npc_types` ADD `see_hide` tinyint(4) NOT NULL default '0';

ALTER TABLE `npc_types` ADD `see_improved_hide` tinyint(4) NOT NULL default '0';

Optional SQL:

UPDATE `npc_types` SET `see_hide` = 1 WHERE see_invis = '1';

UPDATE `npc_types` SET `see_hide` = 1 WHERE see_invis_undead = '1';

## 1/07/2007¶

- **KLS** action_struct unknown06 renamed to instrument_mod to reflect it's behavior

- **KLS** WildCardX inspired weapon proc rate changes, proc rates should now load as a signed int instead of an unsigned int and should correctly calculate.

- **KLS** Some changes to the expired function of ptimers, it should return if the timer is expired whether or not the timer is enabled. This avoids certain situations where timers are disabled and then run down without ever being reenabled and essentially being locked down forever unless the database admin resets it manually.

- **KLS** Also fixed a small ptimer expire bug where if the timer just reached zero it would return expired until it was one second past zero.

- **KLS** Evade will no longer set the rogue's hate to 0, but instead will lower the hate by some amount based on level and the current hate of the monster. May need tweaking as don't know exact values.

- **KLS** Combat Range has been redone a bit so it no longer mixes ints and floats and also correctly factors in the size of the enemy you're fighting. Should prevent exploits where you can hit something rooted/permarooted but they cannot hit you back.

- **KLS** Rampage and enrage have been reworked and should work correctly, rampage will now carry a rampage list of 20 by default that does not get wiped until the monster stops fighting.

- **KLS** Fixed up spell fields and spell loading to make more sense, identified some fields. It should load in order now.

- **KLS** Sneak should now break when you deal / are dealt damage.

- **KLS** Hide should succeed a bit more and use the correct messages: "You have hidden your self from view", "You have failed to hide your self from view"

- **KLS** CalcAC() and CalcATK() now use signed values instead of unsigned.

- **KLS** When a mob returns to their guard point they should now correctly assume their guard heading.

- **KLS** Succor should fully wipe you from hate lists now, as should zoning.

- **KLS** Spin effects are now correctly capped at a max of level 55, all targets above this cannot be affected.

- **KLS** SE_LimitEffect should now correctly deal with any effect type the spell has and not just the ones hard coded into the server.

- **KLS** (Cripp)Fix for zone heading

---

## 2008

*Source: changelog/server/2008/index.html*

# 2008¶

## 12/31/2008¶

- **Congdar** Bots: Added rule EQOffline:BotManaRegen default 1.0 is fastest. 3.0 is closer to player regen rates

- **Congdar** Bots: Added rule EQOffline:BotFinishBuffing default true. Allows out of combat buffing to complete even if the bot is out of mana.

- **Congdar** Bots: Fixed bug where bot ownership could change to somebody else.

- **Congdar** Bots: Added caster AA's for critical damage

## 12/27/2008¶

- **Trevius** Changed QueryLoot so that commands that use it (#npcstats & #npcloot show) will now show Item Links instead of just Item Names.

- **Trevius** Added Item Links to #peekinv

- **Trevius** Added new console command "LSReconnect" to allow manually restarting the auto Login Server connect loops if they stopped for any reason

- **Trevius** Added a Reconnect option in the Web Tool to allow auto Login Server connect to restart if it has stopped and is not connected already.

- **Derision** New program, mailserver, to implement in-game mail. See: http://www.eqemulator.net/wiki/wikka.php?wakka=MailServer,

```
`or mailserver/readme.txt
`
```

Required SQL:

CREATE TABLE `mail` ( `msgid` int(10) unsigned NOT NULL auto_increment, `charid` int(10) unsigned NOT NULL, `timestamp` int(11) NOT NULL default '0', `from` varchar(100) NOT NULL, `subject` varchar(200) NOT NULL, `body` text NOT NULL, `to` text NOT NULL, `status` tinyint(4) NOT NULL, PRIMARY KEY (`msgid`), KEY `charid` (`charid`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8;

ALTER TABLE `character_` ADD `mailkey` CHAR( 16 ) NOT NULL ;

## 12/22/2008¶

- **Trevius**(Denivia) Pets that are on Hold will now follow their master

- **Trevius**(Denivia) Pets will no longer try to attack corpses

## 12/20/2008¶

- **KLS** Removed old unused Guildwars, RaidAddicts and GroupLinking code.

## 12/19/2008¶

- **KLS** Updated how spawn timers work, spawn timers will now be based off absolute time like regular timers which will allow them to tic down even when the server is offline.

- **KLS** Quest::clearspawntimers() has been disabled for now, will be reactivated in next update on spawn timers.

- **KLS** Likewise #repop force has been temp. disabled as well pending updated code.

=Update=

- **KLS** Enabled Quest::clearspawntimers() and #repop force once again.

- **KLS** Added quest::updatespawntimer(id, duration) to update the respawn time of a dead mob, this only applies if the mob is dead and will only apply once: ie. once the mob repops and dies again it will use it's normal respawn time unless this is called again. Not completely tested.

- **KLS** creategroundobject constructor should create objects with max charges now. Untested.

Required SQL: DROP TABLE IF EXISTS `respawn_times`; CREATE TABLE `respawn_times` ( `id` int(11) NOT NULL default '0', `start` int(11) NOT NULL default '0', `duration` int(11) NOT NULL default '0', PRIMARY KEY (`id`) ) ENGINE=InnoDB DEFAULT CHARSET=latin1;

ALTER TABLE `spawn2` DROP `timeleft`;

## 12/15/2008¶

- **KLS** Added 2nd pass to heal aggro to correctly divide aggro between those recieved not just give all recieved full aggro.

## 12/13/2008¶

- **Derision** Fixed a couple of causes of combat related zone crashes.

## 12/12/2008¶

- **Derision** Name of the seller now reported correctly in the /buyer window.

## 12/09/2008¶

- **AndMetal** Added Client::MakeItemLink function, which allows for augments in Item Links. Can be used for Chat & Task windows. See zone/inventory.cpp for detailed notes on usage in the source.

- **AndMetal** Updated quest::itemlink & loot drops to use MakeItemLink.

- **AndMetal** (trevius) Fixed a small typo in utils/export_spells.pl.

## 12/08/2008¶

- **Trevius** Changed #itemsearch output to now place itemlinks for all items it outputs from the search

- **Trevius** Increased the max results of #itemsearch from 20 up to 50

- **Trevius** Added alias #fi as an abbreviation of #finditem, to shorten the command

- **Trevius** Changed the default required status for accounts to access item search commands to min status of 10 (previously 0)

## 12/01/2008¶

- **Trevius** Moved mounts (Horses/Drogmors) into their own table instead of them being hard coded in the source.

Required SQL: utils/sql/svn/235_horses_table.sql

## 11/26/2008¶

- **cavedude00** Traps will no longer be trackable.

## 11/24/2008¶

- **AndMetal** Spells can now be loaded from the database, and is now enabled by default. Use utils/import_spells.pl to import, utils/export_spells.pl to export. Use -h on either for usage.

- **Trevius** Food and Drink will now actually give stats.

Required SQL: utils/sql/svn/229_spells_table.sql

## 11/22/2008¶

Trevius/ **AndMetal* Corrected the output of #showstats to provide accurate Attack Rating calculations.

- **Derision** Initialise animation to zero in the Mob constructor to prevent players sometimes appearing to run off when they first spawn.

- **Derision** /buyer /barter fix.

- **Trevius** Added Account Limiting to allow limiting how many characters can be logged in per account at once * See Optional SQL.

## 11/20/2008¶

- **Derision** Implemented /buyer (cash compensation only) and /barter. Update your patch_Titanium.conf from the utils directory.

REQUIRED SQL:

DROP TABLE IF EXISTS `buyer`; CREATE TABLE `buyer` ( `charid` int(11) NOT NULL, `buyslot` int(11) NOT NULL, `itemid` int(11) NOT NULL, `itemname` varchar(65) NOT NULL, `quantity` int(11) NOT NULL, `price` int(11) NOT NULL, PRIMARY KEY (`charid`,`buyslot`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8;

ALTER TABLE `trader_audit` ADD `trantype` TINYINT NOT NULL DEFAULT '0';

## 11/20/2008¶

- **cavedude00** (aza77) Added quest::collectitems.

- **cavedude00** (Rocker8956) Zones with IDs higher than 255 can now be instanced.

## 11/19/2008¶

- **seveianrex** (Varkalas) WAR Sturdiness AA Fix

- **AndMetal** zone-*.log files on Linux will allow read access to group members. You may need to erase any existing logs to see the change.

- **AndMetal** Added some logging for spell crits (SPELLS__CRITS)

## 11/18/2008¶

- **Derision** Bazaar: Added support for changing prices without ending Trader mode.

## 11/16/2008¶

- **Derision** Added command 'undyeme' to restore all a player's armor slots to their natural undyed state.

- **Trevius** (Denivia) Changed Expansive Mind AA so that it raises the Worn Mana Regen Cap (as it should) instead of just increasing mana regen.

- **Derision** Bazaar bug fix relating to items with -1 max charges.

Optional SQL:

INSERT INTO commands (command, access, description) VALUES ('undyeme', 0, 'Remove dye from all of your armor slots');

## 11/15/2008¶

- **seveianrex** Implemented AA use of SE_Accuracy (Ranger GoD AA "Precision of the Pathfinder" will have an effect now)

- **seveianrex** Implemented Enchanter GoD AA "Mesmerization Mastery"

- **seveianrex** Adjusted Monk Kick Mastery damage modifiers slightly.

- **Derision** Using Find Trader in the Bazaar will teleport you to the Trader.

- **Derision** Added Rule Bazaar:EnableWarpToTrader, default true.

- **Derision** Added Rule World:TutorialZoneID, default 189 (tutorialb).

- **Derision** MinPrice/MaxPrice in the Bazaar search window are now interpreted correctly as values in Platinum.

- **Derision** Bazaar bug fix.

## 11/14/2008¶

- **seveianrex** Adjusted Coat of Thistles AA modifier.

- **seveianrex** Implemented Pet Crits for NEC/MAG/BST (Deaths Fury, Elemental Fury, Warders Fury GoD era AAs)

- **Derision** Bazaar Trader mode (not Barter). Please test it well.

- **Derision** Updated OP_ShopDelItem for Titanium.

REQUIRED SQL:

DROP TABLE IF EXISTS `trader`; CREATE TABLE `trader` ( `char_id` int(10) unsigned NOT NULL default '0', `item_id` int(10) unsigned NOT NULL default '0', `serialnumber` int(10) unsigned NOT NULL default '0', `charges` int(11) NOT NULL default '0', `item_cost` int(10) unsigned NOT NULL default '0', `slot_id` tinyint(3) unsigned NOT NULL default '0', PRIMARY KEY (`char_id`,`slot_id`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8;

DROP TABLE IF EXISTS `trader_audit`; CREATE TABLE `trader_audit` ( `time` datetime NOT NULL, `seller` varchar(64) NOT NULL, `buyer` varchar(64) NOT NULL, `itemname` varchar(64) NOT NULL, `quantity` int(11) NOT NULL, `totalcost` int(11) NOT NULL ) ENGINE=MyISAM DEFAULT CHARSET=utf8;

UPDATE doors set opentype=155 where opentype=154 and zone='bazaar';

## 11/12/2008¶

- **Congdar** Bots: add command #bot lore * Casts Identify on the item on your mouse pointer

- **seveianrex** Tweaked the Slay Undead damage to once again. Damage should be in-line with live numbers now.

- **Angelox** (Kobaz): Fix for 'PIC register bx clobbered in asm' error

- **Angelox** Improved filtering on [bot track rare] option for Ranger

- **Angelox** Added option [bot track near] for Ranger

## 11/11/2008¶

- **Congdar** Bots: fix ghosting when runnning up to targets

## 11/10/2008¶

Trevius/ **Derision* Fix for GM Training Point exploit when de-leveling and leveling up again

## 11/10/2008¶

- **Derision** Implemented Looking For Group/Looking For Players Window. patch_Titanium_conf has been updated.

- **Derision** Visual Studio users should add world/lfplist.h and world/lfplist.cpp to their project.

REQUIRED SQL:

ALTER TABLE `character_` ADD `lfp` TINYINT( 1 ) UNSIGNED NOT NULL DEFAULT '0'; ALTER TABLE `character_` ADD `lfg` TINYINT( 1 ) UNSIGNED NOT NULL DEFAULT '0';

## 11/08/2008¶

- **Congdar** Bots: add command #bot resurrectme

- **Congdar** Bots: modify heal ai, more mana calcs

- **Congdar** Added Rule to allow melee to bind anywhere casters can bind, default is false

optional sql:

insert into rule_values values (1, 'Character:BindAnywhere', true);

- **seveianrex** Figured out what was crashing ranged procs. Is fixed and fully implemented now. Rangers rejoice..

- **seveianrex** Modified the way #melody works to improve the delay between songs being casted. Bards rejoice..

## 11/07/2008¶

- **seveianrex** GoD Rogue AA's: Seized Opportunity, Triple Backstab implemented

- **seveianrex** (LeftRoad) Provide a damage message to client when mob is killed by a spell

- **Congdar** Bots: reduce spam, fix crash when fighting Dain, change mana/hp from npc to client like calcs

- **Congdar** make heading calculation more efficient, change sint8 to float for float calculations and heading variable

- **seveianrex** Added #melody as a supplement for /melody until the OPcode can be located. Don't forget to:

INSERT INTO commands (command, access, description) VALUES ('melody', 0, 'A supplement for /melody until the OP code is found.')

- **seveianrex** Added support for defensive and ranged spell-effect based procs. Having some zone-crash issues with the ranged proc code for some reason, so it's commented out until I can fix it.

## 11/05/2008¶

- **Derision** Dyed armor color should now show up correctly to other players.

- **Derision** Implemented the Potion Belt.

## 11/03/2008¶

- **seveianrex** Added some scaling to the way NPC hitboxes are calculated. This corrects some of the issues with mobs like Wurms/Dragons who you could hit from miles away.

- **seveianrex** NPCs who are 5% HP or lower, are fleeing, and have a decent snare on will no longer cover so much distance.

- **seveianrex** Implemented Mob::GetSnaredAmount() function, utilized in the above. Returns the ABS() value of the snare.

## 11/01/2008¶

- **seveianrex** GoD AA Implementations: [CLR] Touch of the Divine, [BRD] Internal Metronome, [SHD] Improved Consumption of the Soul

- **Derision** Allow backtick through the CleanName filter.

- **Derision** Pickpocket should no longer occasionally bug the UI.

- **Derision** Pickpocketing money should no longer show twice the amount taken in the client.

- **Derision** Looting stackable PVPItem now works.

- **Derision** Client now updates correctly when a charge on an item with a right click effect is used. Update your patch_Titanium.conf

## 10/31/2008¶

- **seveianrex** Monk updates: Strikethrough AA, Mend Worsen Frequency Tweak, Kick Mastery AA Fix

- **seveianrex** Implemented Pet Flurries for MAG/BST/NEC

- **Derision** Extended quest::popup to take optional PopupID and buttontype (OK or YES/NO) fields.

## 10/30/2008¶

- **KLS** Spell crits should work reasonably well once again.

- **Derision** Fixed inability to jump introduced in Rev161.

## 10/29/2008¶

- **Derision** Mobs in water should no longer sink to the bottom.

- **cavedude00** Added rule to enable DeathExpLossMultiplier, or to use server code default.

Optional SQL: Insert into rule_values values (0, 'Character:UseDeathExpLossMult', 'true');

## 10/27/2008¶

- **seveianrex** Added server-side code for WAR sturdiness AA

- **Angelox** (Cbodmer) Experience loss based on cbodmers formula with added rule to regulate loss amount

- **Trevius** (Denivia) Added Critical Spell Damage for Lifetaps with the proper AAs

Optional SQL (options are 0-10, defaults to 3): Insert into rule_values values (0, 'Character:DeathExpLossMultiplier', 3);

## 10/26/2008¶

- **Derision** Implemented Bandolier. Test thoroughly before trusting it with your Epic.

- **Derision** Minor change to enable the spell Tiny Companion to work.

## 10/24/2008¶

- **seveianrex** Implemented various GoD AAs: Coat of Thistles, Rapid Strikes, Elemental Durability, Subtlety2, Strengthened Strike, Vicious Smash

- **seveianrex** Implemented GoD Monk AA "Kick Mastery"

- **Trevius** Adjusted the new Frenzy AAs code to fix a crash

- **Trevius** Removed the Shield Block for Paladin/SK AA until code is revised and working

- **Trevius** (Denivia) Added Advanced Theft of Life and Soul Thief for Necros and SKs

- **Trevius** (Denivia) Added Death Peace AA

- **Trevius** (Denivia) Added Blur of Axes and Vicious Strike AAs for Berserkers

- **Trevius** (Denivia) Added Shield Block AA for Paladin/SK

- **Derision** 'Killing' LDoN chest type objects(e.g. Vermin Nests) will now update kill activities.

- **KLS** Revert Lag fixes that were causing movement and facing abnormalities.

- **KLS** Fix to a few problems with quest::creategroundobject that was causing it to not work in some situations.

## 10/23/2008¶

- **Congdar** Clone NoDrop removal code to NoRent, Lore, NoTrade. Optionally enabled in the db Variables table DisasbleNoDrop=1 DisableNoRent=true DisableLore=1 DisableNoTrade=1

- **Congdar** Bot code cleanup, method call reduction

- **Congdar** Bot DoubleAttack method is more like clients

- **Congdar** Remove AFK leveling with bots

- **Angelox** Added command '#Bot evac' for Druid bots

- **Angelox** Added command '#Bot target calm' for Enchanter or Cleric bots

- **Trevius** Removed the * 10 multiplier from the SE_ProcChance since it isn't needed

- **KLS** Zone appearance should update for players zoning.

- **KLS** Added command #modifynpcstat

- **KLS** Added quest::modifynpcstat(identifier, value)

- **KLS** Fix potential crash in MobProcess

- **KLS** Added decay option to CreateGroundObject

- **KLS** Added spelltype mez(2048) and spelltype in combat buff(1024).

- **KLS** Setting level for npcs will now update their spawn level too.

- **KLS** Fix potential memory leak in item link code.

- **KLS** Changed resists a bit.

- **KLS** Added rule: Spells:ResistPerLevelDiff(85) 8.5 resist points per level diff

- **KLS** Added rule: Combat:BaseHitChance(54.0)

- **KLS** Added rule: Combat:HitPerLevelDiff(145) 45% per level diff

- **KLS** Added rule: Combat:AgiHitFactor(0.015)

- **Derision** Added 'Repeatable' column to to tasks table. Default 1 (true).

Required SQL:

ALTER TABLE `tasks` ADD `repeatable` TINYINT( 1 ) UNSIGNED NOT NULL DEFAULT '1';

## 10/22/2008¶

- **AndMetal** Fix for item links to prevent occasional zone crashes

- **AndMetal** Critical DOTs should now work correctly

- **AndMetal** Fixed sql/svn/125_aggrozone.sql to work with current command table schema

- **AndMetal** (Theeper) Shared Bank platinum. Added rule Character:SharedBankPlat(false) to enable since it is possible to dupe plat with multiple characters logged in on the same account at the same time

- **AndMetal** Fixed a few random compile warnings

- **Angelox** Bot Tracking improves as levels increase.

- **Angelox** Druid Bot is now next best tracker

- **AndMetal** Support for +Stat Cap (Wunshi's Focusing, etc)

- **AndMetal** New rules for tweaking spell crits: Spells:BaseCritChance(0), Spells:BaseCritRatio(0), Spells:WizCritLevel(12), Spells:WizCritChance(7), Spells:WizCritRatio(15)

- **AndMetal** Loot messages will now have item links instead of just the item name

## 10/21/2008¶

- **KLS** Some changes to make compiling with profiler enabled more error free.

- **KLS** Added player quest event EVENT_TASK_STAGE_COMPLETE exports $task_id and $activity_id.

- **KLS** Added player quest event EVENT_PICK_UP exports $picked_up_id for when a player picks up a ground spawn or dropped item.

- **KLS** Added quest::CreateGroundObject(itemid, x, y, z, heading) which lets the quest script create ground objects in the zone like if they had been dropped.

- **KLS** Objects should decay after they're loaded back into the world. Might want to backup your objects table till I can confirm this works 100%.

- **KLS** Lowered ground object decay time from 30 min to 5 min.

## 10/20/2008¶

- **AndMetal** (erde) Moved SVN SQL updates to utils/sql/svn. File name will start with the revision they were introduced & optional updates have optional somewhere at the beginning of the name

- **Derision/Trevius** Implemented sub EVENT_AGGRO_SAY

- **AndMetal** Implemented Reverse Damage Shield

- **AndMetal** Fixed +Damage Shield on items so that it doesn't work without having a Damage Shield spell first

- **AndMetal** (seveianrex) Hate w[h]iped on CoH

- **AndMetal** (via Yeahlight) New command: #aggrozone. Requires 100 status by default

## 10/19/2008¶

- **Angelox** Added a start to Bot tracking * Thanks Derision for all the help and know-how.

- **Derision** Altered damage shield message processing to be more like (the same?) as live.

- **Derision** If it exists, damage shield types are read from a new table (damageshieldtypes)

- **Derision** If no entry exists in the table, a default based on resist type is used.

Optional SQL: See utils/sql/damageshieldtypes.sql

## 10/18/2008¶

- **KLS** Reworked classic style traps.

- **KLS** Debuff style traps should function perfectly, the level field in the DB gives what level the caster is for resists in this case.

- **KLS** Added respawn and respawn variance to traps.

- **KLS** Increased range on sense traps.

- **KLS** Sense trap will now point the player in the direction of the trap they are sensing.

- **KLS** Disarm trap will no longer use sense trap's timer.

- **KLS** Disarm trap will no longer fail to disarm traps on success.

- **KLS** Increased range on disarm trap slightly.

- **KLS** Change to MakeRandomInt() and MakeRandomFloat()

- **KLS** Int generation be nearly 100% or more faster in most cases and float generation should be slightly faster in most cases

- **cavedude00** (seveianrex) Slay Undead Fix

- **cavedude00** (seveianrex) Levitate effect will no longer be removed in cases where you have two stacked lev spells and the first wears off.

- **cavedude00** (seveianrex) Hate list will now be cleared following CoH

- **cavedude00** (seveianrex) Group members will now see tradeskill emotes.

Required SQL: ALTER TABLE `traps` DROP `spawnchance`; ALTER TABLE `traps` ADD `respawn_time` INT(11) UNSIGNED DEFAULT '60' NOT NULL AFTER `skill`; ALTER TABLE `traps` ADD `level` MEDIUMINT(4) UNSIGNED DEFAULT '1' NOT NULL AFTER `skill`; ALTER TABLE `traps` ADD `respawn_var` INT(11) UNSIGNED DEFAULT '0' NOT NULL AFTER `respawn_time`;

## 10/17/2008¶

- **KLS** Tweaks to /pet attack

- **KLS** Renamed WhipeHateList to WipeHateList so I never have to view that spelling monster ever again.

- **cavedude00** (Rocker8956) Added shutdowndelay to zone query.

## 10/16/2008¶

- **Derision** Cosmetic change to foraging to correctly identify food/drink items.

- **cavedude00** Added rules to determine if /ooc and /auction should be server wide (true) or zone wide (false * Live Like).

- **cavedude00** #peqzone can no longer be used if invulnerable.

- **KLS** More changes to proc code. Added an option of calc. proc rate based on speed of the weapon

- **KLS** Added Rules: Combat:AdjustProcPerMinute(true), Combat:AvgProcsPerMinute(18.0), Combat:ProcPerMinDexContrib(0.075), Combat:BaseProcChance(0.035), Combat:ProcDexDivideBy(11000)

- **KLS** Tweak to monster AI to hopefully save computation.

Optional SQL: insert into rule_values values (0, 'Chat:ServerWideOOC', 'true'); insert into rule_values values (0, 'Chat:ServerWideAuction', 'true');

## 10/15/2008¶

- **Derision** Added OP_LevelAppearance to utils/patch_Titanium.conf and it is now sent to nearby clients (eye candy when you level)

- **Derision** (seveianrex) Alcohol Drinking / Skillup Fix

- **KLS** Change to proc code to correct some oddities with % chance to proc.

- **KLS** Changed how avoidance bonuses are calculated to be like other melee bonuses.

- **KLS** (seveianrex) Basic Pet Focus Implementation.

## 10/14/2008¶

- **Trevius** Charm Spells set to max level of 0 now have unlimited max level as they should

- **Derision** Player pets should no longer be fearable if npcspecialattks contains 'D'.

- **cavedude00** (Rocker8956) Changes to quest::getlevel and quest::setinstflag/setinstflagmanually to reduce DB access

- **cavedude00** (Rocker8956) Added quest::getinstflag

- **KLS** Fixed crash in shutdown delay, please test things for crashes before adding them, this was pretty obvious.

- **Derision** Removed requirement to be grouped for Translocate spells.

## 10/13/2008¶

- **Derision** Looting your corpse while liched/wolf form etc should now auto-equip items

## 10/12/2008¶

- **Derision** No more binding wounds while feigning death.

- **Derision** (Rocker8956) Movegrp quest command fix.

- **Derision** (LeftRoad) TEMPORARY(NORENT) items in a character inventory will be retained if you log back into that character within 30 minutes.

- **KLS** Implemented Raid::TeleportGroup() and Raid::TeleportRaid(), untested but should work.

- **KLS** (seveianrex) Critical DoT and Sinister Strikes AA.

## 10/11/2008¶

- **Derision** Resurrection fix.

- **KLS** Rebalanced skill ups.

## 10/10/2008¶

- **AndMetal** Added functions to calculate AA bonuses just like item & spell bonuses (not turned on yet)

- **Condgar** Fix for Bots wont Attack

- **Congdar** Fix low level bots hitting too hard

- **Derision** Prevent two instances of possible zone crashes due to null pointers.

- **Trevius** (Striat) Added quest commands for zone and world emotes * quest::ze() & quest::we()

- **Derision** Recalculate Pet bonuses on zoning before setting current HP/Mana.

## 10/09/2008¶

- **Congdar** Replace Client IsEngaged() checks in Bot Source with bot aggro check

- **Trevius** (AndMetal) Added quest Object SetOOCRegen() to adjust NPC Out of Combat Regen on the fly.

- **Trevius** Relocated the Empty Corpse check code so that the Decay Time rule for it will now work.

- **Trevius** Removed the Level 70 cap on the #traindisc command.

- **Trevius** Added optional rule to allow Max Level Attainable via experience to be set independant of other Max Level rule checks.

- **Derision** Reworked code to stop mobs fleeing if they have buddies to account for recent hate_list changes.

Optional SQL: Insert into rule_values values (0, 'Character:MaxExpLevel', 0);

## 10/08/2008¶

- **Congdar** Fix orphaned bots when camping/zoning

- **Congdar** Link bot assist with client auto attack

- **Derision** Added #titlesuffix command to add a title after a player's name.

## 10/07/2008¶

- **Congdar** Allow bot pets to be the main tank in a bot raid

- **Congdar** Remove old Sense Heading skill check

- **AndMetal** Web interface will now list open petitions.

- **Derision** #title should now prefix the target player's name, e.g. #title Lord_Protector (underscores are replaced with spaces, max 31 chars)

## 10/06/2008¶

- **Angelox** Fix Bot names in group window (now is 'Mybot' instead of 'Mybot000')

- **cavedude00** (erde) Fix for world and zone crashing when compiled on VS 2008 in release mode.

- **cavedude00** (Rocker8956) Zone shutdown timer rule.

- **cavedude00** Added cleanipc to makefile.

Required SQL: ALTER TABLE `zone` ADD column `shutdowndelay` bigint (16) unsigned NOT NULL default '5000'; INSERT INTO rule_values VALUES (1,'Zone:AutoShutdownDelay', 5000);

## 10/04/2008¶

- **Congdar** Double Attack redo, tested working

- **Congdar** Fix Bot follow bug when a bot gets killed

- **Derision** Added minlevel and maxlevel fields to tasks table and new quest function istaskappropriate(task).

- **Derision** All tasks in a TaskSet with a taskid of 0 as one of it's entries are now available to a player, subject to level restrictions.

- **Derision** (Spoon/Andmetal) Rez spells with effectdescnum != 82 or 39067 (6.2 spells_us) will give 100% Mana/HP restoration and no rez effects.

- **Derision** Corrected message when interrupting a spell with Shift-S.

- **Derision** Fix to display Frogloks correctly in /who all and /who all froglok (half of the change came from a post by Theeper on the forums).

Required SQL: ALTER TABLE `tasks` ADD `minlevel` TINYINT UNSIGNED NOT NULL DEFAULT '0', ADD `maxlevel` TINYINT UNSIGNED NOT NULL DEFAULT '0';

## 10/03/2008¶

- **Congdar** Add EQOffline Bot Source

- **Derision** Removed 'stepped' column from task table. See http://eqemulator.net/forums/showthread.php?p=157613

- **Derision** Added display of Task Description to #task show to aid in debugging a reported problem.

- **Derision** Lowered default required status for #task command from 250 to 150 for debugging purposes.

- **KLS** Removed some lingering printf from the raid stuff.

- **KLS** Auto attack code changed to not use target, instead we save the first target and now always use that.

- **KLS** Hate list will no longer work for non ai controlloed player characters.

- **KLS** Fix to crash in monk special attack function.

Required SQL: ALTER TABLE `tasks` DROP `stepped` ;

## 10/02/2008¶

- **KLS** (Congdar) Update to Tech. of Master Wu AA.

- **KLS** Revert of double attack change, people reporting non warriors were no longer double attacking properly.

- **KLS** Compile Warning in Database::GetZoneName()

- **KLS** Change to IsPlayerIllusionSpell() to make it more consistant, illusion spells can be more than 49 so we work off behavior and effect now.

- **KLS** Added AA__Message logs to project illusion code to try to track down an error.

## 10/01/2008¶

- **Derision** (erde) VS2008 Compile Fix (#if (_MSC_VER < 1500) #define vsnprintf _vsnprintf #endif

- **Derision** Fix to stop zone crashing when looting PVPItem and PVPReward is set to 3.

- **cavedude00** Group members will no longer recieve a split when a player corpse is looted.

## 9/30/2008¶

- **Derision** Task activities with an activitytype of <= 0 in the activities table will be sent with an activitytype of 9 to the client.

- **Derision** The reward field in the task table will now be displayed even if rewardid=0

- **cavedude00** (Rocker8956) Added quest function to get average group/raid level.

- **cavedude00** (Rocker8956) Changes to setinstflagmanually to allow deletion of instance flags and to allow manual flagging of raids, groups, and individuals.

## 9/29/2008¶

- **cavedude00** Added rule World:ClearTempMerchantlist to control whether world clears temp merchant items when started or not.

- **AndMetal** (Congdar) New Double Attack logic

- **Angelox** Keyring code fix, so clicky portals that require keys will work too.

- **AndMetal** Added AAs: Discordant Defiance, Blacksmithing Mastery, Baking Mastery, Brewing Mastery, Fletching Mastery, Pottery Mastery, Tailoring Mastery, Packrat, Expansive Mind, Veteran's Wrath, Advanced Fury of Magic Mastery, Destructive Fury

- **AndMetal** Ayonae's Tutelage should now calculate bonus for Singing

Optional SQL: insert into rule_values values (0,'World:ClearTempMerchantlist','true');

## 9/28/2008¶

- **AndMetal** Fixed exploit for pets ignoring Fear by using /pet commands

- **AndMetal** #wp add will now use the highest value in the grid_entries table + 1 if you don't use a Waypoint # or use 0

## 09/26/2008¶

- **cavedude00** (AndMetal) Deathblow AA

- **cavedude00** (AndMetal) Swift Journey AA

- **cavedude00** (AndMetal) Convalescence and Healthy Aura AAs

- **cavedude00** (AndMetal) Slippery Attacks AA

- **cavedude00** (trevius/Derision) Additional IP limiting rules

- **cavedude00** (Congdar) Further PC main and second hand attack fixes

- **cavedude00** (Derision) Fix for percent heals

- **cavedude00** (Theeper) Fix for quest:itemlink()

- **cavedude00** (Rocker8956) More work on zone instancing

Optional SQL: Insert into rule_values values (0, 'World:AddMaxClientsPerIP', -1 ); Insert into rule_values values (0, 'World:AddMaxClientsStatus', -1 );

## 09/25/2008¶

- **cavedude00** (trevius) IP Limiting Minor Fix

- **cavedude00** (trevius) New Quest Command quest::clearspawntimers()

- **cavedude00** (trevius) New Quest Command quest::traindiscs()

- **cavedude00** (trevius) Enraged, Flurry and Rampage Spamming Fix

- **cavedude00** (seveianrex) Implemented Project Illusion AA

- **cavedude00** (seveianrex) Corrected AA ding message

- **cavedude00** (Congdar) PC main and second hand attack fixes

- **cavedude00** (Cantus) 2H weapon damage bonus

- **cavedude00** (Derision) /who all friend

- **cavedude00** (Derision) All merchants will now show player sold items correctly

- **cavedude00** (Derision) Enter tutorial and Return Home buttons during char creation/select

- **cavedude00** (Derision) Implemented Task system

- **cavedude00** (Derision) Implemented Translocate and Sacrifice Confirmation Boxes

- **cavedude00** (Derision) Client popup window

- **cavedude00** (James76) Implemented keyring

- **cavedude00** (AndMetal) Corrected Technique of Master Wu AA

- **cavedude00** (AndMetal) Corrected some proc spells not working after zoning

- **cavedude00** (Hugghiebear) Charm will now fade if invis is cast

- **cavedude00** (AiliaMorisato) New command #advnpcspawn and related functions

- **cavedude00** (Rocker8956) Preliminary zone instancing

- **cavedude00** (KLS) Implemented raid system

- **cavedude00** Fixed autosplit (Thanks WildcardX!)

- **cavedude00** New command #peqzone

- **cavedude00** Several minor forage/fishing fixes

Required SQL is in utils/sql/09252008.sql Make sure you update your .conf files, also found in utils!

## 09/01/2008¶

- **KLS** (derision) Crash Fix.

- **KLS** (haecz) Non-Melee damage filter.

- **KLS** (LordKahel) Lore Slotted Augment.

- **KLS** (Spider 661 via trevius) Chaotic Potential AA

- **KLS** (Derision) OP_Sound update for titanium.

- **KLS** (ndnet via trevius) MQ Illegal Item Equip Detection

- **KLS** Modified faction modifiers for buying/selling.

- **KLS** (AndMetal) Spell blocking implementation

- **KLS** (Derision) Resurrection confirmation

- **KLS** (Cripp) Delete stale corpse backup typos

- **KLS** (AndMetal) CHA stacking buff bug resolved.

Required SQL: CREATE TABLE `blocked_spells` ( `id` int(11) NOT NULL auto_increment, `spellid` mediumint(8) unsigned NOT NULL default '0', `type` tinyint(4) NOT NULL default '0', `zoneid` int(4) NOT NULL default '0', `x` float NOT NULL default '0', `y` float NOT NULL default '0', `z` float NOT NULL default '0', `x_diff` float NOT NULL default '0', `y_diff` float NOT NULL default '0', `z_diff` float NOT NULL default '0', `message` varchar(255) NOT NULL default 'You cannot cast that spell here', `description` varchar(255) default NULL, PRIMARY KEY (`id`) )

## 08/15/2008¶

- **KLS** Fix for groups clearing on new group create.

- **KLS** Fix for null row access in Database::GetLeaderName()

- **KLS** CountDispellableBuffs now will validate buffs spells.

## 08/14/2008¶

- **KLS** Very basic work on raids.

- **KLS** Moved group id calls to their own database as to not be blocked by long character_ selects and such.

Required SQL (Your groups will break completely without this): CREATE TABLE `group_id` ( `groupid` int(4) NOT NULL, `charid` int(4) NOT NULL, `name` varchar(64) NOT NULL, PRIMARY KEY (`groupid`, `charid`) ) ENGINE = InnoDB;

## 08/13/2008¶

- **KLS** Added dispel field for npc spells as 512.

- **KLS** NPCs should be smarter about when they choose to cast certain spells; namely dots, lifetaps and dispels.

- **KLS** NPCs should continue to cast nuke spells for a longer period of time.

- **KLS** NPCs will no longer have a 2-3 sec forced delay between spell casts; it is now whatever the recovery time of the spell is just like players, beware.

- **KLS** (trevius) Change to npcAI recast delay cap 1000->10000 seconds.

- **KLS** Increased amount of mana npcs gain from int and wis.

- **KLS** New rule: NPC:CorpseUnlockTimer (150000) 2.5 min default on corpses being unlocked after loot instead of decay time / 2

- **KLS** New rule: NPC:EmptyNPCCorpseDecayTimeMS (0) empty npc corpses will decay after this long + 1000MS on the ground.

- **KLS** More changes to groups: text should now be correct in *almost* all situations.

- **KLS** Groups should stay synced in almost all situations and leader disbanding should be smoother.

- **KLS** Groups will clear their info on the aquisition of a reused id.

- **KLS** .conf file from earlier /rewind change should be correct now make sure to update it if you want it to function.

Optional SQL: UPDATE npc_spells_entries SET type='512' WHERE spellid='48'; UPDATE npc_spells_entries SET type='512' WHERE spellid='49'; UPDATE npc_spells_entries SET type='512' WHERE spellid='1526'; UPDATE npc_spells_entries SET type='512' WHERE spellid='1697';

## 08/11/2008¶

- **KLS** Group leader info should transfer to a new zone when the leader transfers to that zone.

- **KLS** Will now force a group update to players not in zone, text not correct.

- **KLS** Added #refreshgroup command * will refresh group visually from DB

- **KLS** Deleting stale corpses will now bury corpses instead of make them decay if shadowrest is enabled.

- **KLS** Small change to temp merchant lists with regards to charges.

- **KLS** Initial implementation of Technique of Master Wu

- **KLS** Spell's fizzles will now base their mana cost on the correct amount.

- **KLS** Tweak to spell casting expertise and mastery of the past

- **KLS** Hopefully fix to AEUndead spells hitting more than undead

Required SQL (Your groups will probably break completely without this): CREATE TABLE `group_leaders` ( `gid` int(4) NOT NULL, `leadername` varchar(64) NOT NULL, PRIMARY KEY (`gid`) ) ENGINE = InnoDB;

## 08/09/2008¶

- **KLS** Minor tweaks to heal aggro.

## 08/07/2008¶

- **KLS** Bald char fix revert, will try something else.

- **KLS** Wake The Dead initial implementation.

- **KLS** Hopefully better bald character fix base on kraeger's findings.

## 08/04/2008¶

- **KLS** (Derision) Pet Buff Window Implemented.

- **KLS** Charmed pets should now function with the pet window, as well as appear correctly in group.

- **KLS** Added rule Character:SkillUpModifier (100) to govern how fasts skill ups happen on a server. 100% = normal chance, 200% = double normal chance.

- **KLS** (Derision) Implemented quest journal npc say.

- **KLS** (Derision) Fix for npc not always facing attacker.

- **KLS** (Derision) Stop Pets Fleeing

- **KLS** (CodeMephit) Hunger and thirst for new characters.

- **KLS** Upped food/water eat/drink gains by a lot.

- **KLS** (greggg230) Aggro LOS fix.

- **KLS** Fix for bald characters hopefully.

- **KLS** (kraeger) RNG name fix.

- **KLS** Big bug fixes with healing aggro.

- **KLS** Charm spells will stop making a cha check after a certain resist adj threshold

- **KLS** Adjusted melee hit chances to be more forgiving.

- **KLS** Changed how +hit mods are applied

- **KLS** Roughly implemented Skill Attack spell effect.

Required: patch_6.2.conf and patch_Titanium.conf files have changed be sure to update them.

## 07/21/2008¶

- **KLS** (irv0) Fix for out of order ack not being sent in some situations.

- **KLS** (Derision) Pet bar OOC update fix.

- **KLS** Should have made client pets unable to give experience, untested but should work.

- **KLS** Healing aggro should function better for people not on the hate list.

- **KLS** Some work on public tradeskill objects saving their content between uses.

## 06/22/2008¶

- **KLS** Changed world/clientlist.cpp's line endings back to unix style line endings

- **KLS** Fixed up ipban based on updated code from TheLieka.

## 06/21/2008¶

- **KLS** Belated updates to azone including (derision)EQG fixes and some changes to make it easier to compile under windows.

- **KLS** Fixed inconsistant line endings in ruletypes.h; there are probably more line ending changes I didn't catch, please try to keep your line endings consistant with what's in the repo.

## 06/19/2008¶

Scorpious2k (Knightly): Correction of divine intervention text Scorpious2k (LordKahel): Support for defensive Instinct and Reflexive Mastery AA

## 06/18/2008¶

Scorpious2k (Derision): Fix for flee runspeed * linear flee speed reduction as HP drops Scorpious2k (Derision): Rule to prevent mobs from fleeing if they are being helped by other NPCs Scorpious2k (haecz): Distance check for corpse dragging Scorpious2k (haecz): Distance check for taunt Scorpious2k (greggg230): Merchant price faction/charisma fix Scorpious2k (greggg230): Faction will now show on /con for agnostic players Scorpious2k (BatCountry): Correction of a zone crash caused by reloading rules Scorpious2k (Congdar): Eliminated array index error/zone crash in spells

## 06/17/2008¶

Scorpious2k (TheLieka): Ban by IP Scorpious2k (cavedude/TheLieka): Ability to limit melee guys from being bound in certain zones. This changes the canbind column of the zone table. Value 0 means noone can bind, value 1 means only casters can bind, value 2 means anyone can bind in the zone (ie cities).

Required SQL: CREATE TABLE `Banned_IPs` ( `ip_address` VARCHAR(32) NOT NULL, PRIMARY KEY (`ip_address`) ) ENGINE = InnoDB;

Optional SQL: Insert into rule_values values (0, 'World:UseBannedIPsTable', 0); Update zone set canbind = 2 where zoneidnumber in (1,2,3,8,9,10,19,23,24,29,40,41,42,45,49,52,54,55,60,61,62,67,75,82,83,106,155);

## 06/14/2008¶

Scorpious2k(Trevius): Door names can now go beyond the 16 char limit to allow doors and other objects from later expansions to be used. The new max is 32 characters. Scorpious2k(Derision): New fear adjustment to cause mobs to flee at the correct rates instead of running very fast at certain percentages of health. Scorpious2k(TheLieka): Limit the number of connections for an IP address There are 2 new rule values. World:MaxClientsPerIP = Maximum number of simultaneous EQ Client connections allowed per IP address. Set the rule value to -1 to disable this feature. World:ExemptMaxClientsStatus = Minimum Account status to exempt the MaxClientsPerIP rule. This is helpful for the inevitable random family of 16 that live together, and all want to play on your server, as well as GMs, Devs, and QA staff. Again, set the rule value to -1 to disable this feature. Scorpious2k(TheLieka): Added /rewind command Scorpious2k(Striat): Quest Commands for Temp Race, Texture, Size and Gender Changes

Required sql: ALTER TABLE `doors` MODIFY COLUMN `name` VARCHAR(32) CHARACTER SET latin1 COLLATE latin1_swedish_ci NOT NULL;

## 05/30/2008¶

- **Scorpious2k** (Derision/Wiz) Added code to implement fear.

- **KLS** (Leika) Implemented detection of various MQ activities.

- **KLS** EVENT_CAST_ON should now export $spell_id properly.

- **KLS** Further expanded on fear implementation including addition of rules to govern it's behavior.

- **KLS** Fear on clients still uses stun but the stun should match up with the buff duration in a more accurate manner.

Hackers SQL table: DROP TABLE IF EXISTS `hackers`; CREATE TABLE `hackers` ( `id` int(4) NOT NULL auto_increment, `account` text NOT NULL, `name` text NOT NULL, `hacked` text NOT NULL, `zone` text, `date` timestamp NOT NULL default CURRENT_TIMESTAMP on update CURRENT_TIMESTAMP, PRIMARY KEY (`id`) ) AUTO_INCREMENT=8;

## 04/26/2008¶

- **KLS** Should have fixed discipline and combat ability timer overlap.

- **KLS** Added a rule for partial hits on fear, seperate from normal resist partial hits.

- **KLS** Fixed some quirks in the aggro system.

- **KLS** (Bulle)Added quest event EVENT_KILLED_MERIT will trigger if you got credit for doing the most damage to a lootable npc.

- **KLS** (Bulle)Added quest event EVENT_CAST_ON will trigger if a player casts on a npc.

- **KLS** Fixed crash in server-side check for removing detrimental effects.

- **KLS** (Magoth78), (Angelox)Added zone checks for levitating and being outdoors.

- **KLS** (haecz) Fix to dupe corpse money on a zone crash.

- **KLS** Changed root to resist per tic instead of partial hit.

Required SQL: alter table `zone` add column `canlevitate` tinyint (4) DEFAULT '1' NOT NULL after `cancombat` alter table `zone` add column `castoutdoor` tinyint (4) DEFAULT '1' NOT NULL after `canlevitate`;

## 04/22/2008¶

- **Rogean** Server-side check for removing detrimental spells.

## 04/13/2008¶

- **Rogean** Fixed a hack to sell no-drop items to merchants. (Reported by KingMort)

- **Rogean** Fixed #hideme, it won't show you zone in and then disappear anymore. (Reported by KingMort)

- **Rogean** Fixed /summon.

- **Rogean** Changes to /who all and GM's:

- 

GM * Tags will no longer show up unless your #gm on

You will not show up to players of lower status if your /anon and #gm on, if your #gm off and /anon you will show up as

a normal player, regardless of statuses.

## 04/09/2008¶

- **KLS** (AiliaMorisato)Fixed death packet bindzoneid and attack_skill fields being switched.

- **KLS** Added rule based caps for all PoP item abilities.

- **KLS** Agility will now affect a defenders chance to be missed slightly.

- **KLS** Added accuracy rating (10 AR. = 1% chance to hit) and (LordKahel)ATK to npcs.

- **KLS** Changed how mitigation is calculated slightly.

- **KLS** Enc animations will now respond to /pet get lost no matter what level of the animation empathy aa they have.

- **KLS** Hopefully fixed soul abrasion and consumption of the soul aas... again.

- **KLS** Added quest::forcedooropen(doorid), quest::forcedoorclose(doorid), and quest::isdooropen(doorid).

- **KLS** Changed archery calculations to be more similar to normal weapon damage calculations.

- **KLS** Taunt will now always add hate if the user is already on the top of the hate list.

- **KLS** Fixed EVENT_ZONE player event.

Character:ItemDamageShieldCap (30) Character:ItemAccuracyCap (150) Character:ItemAvoidanceCap (100) Character:ItemCombatEffectsCap (100) Character:ItemShieldingCap (35) Character:ItemSpellShieldingCap (35) Character:ItemDoTShieldingCap (35) Character:ItemStunResistCap (35) Character:ItemStrikethroughCap (35)

Required SQL: ALTER TABLE npc_types ADD ATK MEDIUMINT NOT NULL DEFAULT '0'; ALTER TABLE npc_types ADD Accuracy MEDIUMINT NOT NULL DEFAULT '0';

## 04/01/2008¶

- **Rogean** Fixed a merchant purchase packet exploit.

## 02/28/2008¶

- **WildcardX** Tweaked the code for the Divine Intervention spell line code and the Unfailing Divinity AA ability.

## 02/27/2008¶

- **WildcardX** Implemented HeadShot AA Ability.

- **WildcardX** Archery and throwing attacks will not cause you to suffer injury from your target's damage shield.

- **WildcardX** Implemented Spell: Death Pact.

- **WildcardX** Implemented Spell: Divine Intervention.

- **WildcardX** Implemented Unfailing Divinity AA Ability.

## 02/25/2008¶

- **WildcardX** Enchanters can now control their pets if they purchased the Animation Empathy AA.

- **WildcardX** Mobs now have a chance to resist fear spell line each tic.

- **WildcardX** Mobs now have a chance to resist charm spell line each tic.

- **WildcardX** Implemented Total Domination AA.

- **WildcardX** Reworked new charisma test. This test now evaluates factors like MR, CHA, mob and caster levels. It yields better live-like results.

- **WildcardX** Enchanter pets now get the /pet report and /pet health commands by default.

## 02/23/2008¶

- **WildcardX** Only characters with Pet Affinity AA can have group buffs casted on their pets.

- **WildcardX** Fixed a bug that would not allow a rune buff to be used in some situations.

## 02/22/2008¶

- **WildcardX** Characters can now have only one caster specialization skill above 50. If more than one specialization skill is detected above 50, then all specialization skills are reset to 1.

- **WildcardX** Reworked mana reduction calculations.

- **WildcardX** Implemented spell casting specilization checks.

## 02/21/2008¶

- **WildcardX** Removed the possible fix for the Call of Hero spell as it didnt actually fix the issue after extensive testing.

- **WildcardX** Added new command #scribespell. This will scribe a specified spell into the target's spell book.

- **WildcardX** Added new command #unscribespell. This will unscribe a specified spell from the target's spell book.

## 02/20/2008¶

- **KLS** Zone crash fix caused by calling the TryWeaponProc() method when dead.

- **WildcardX** Changed the quest function depopzone() to accept a parameter to specify if the spawn timers should resume or become disabled. 0 = Disable, 1 = Enable.

- **WildcardX** Added the quest function repopzone(). This function will cause a zone to repop it's spawns normally.

- **WildcardX** Possible fix for a zoning bug caused by the Call Of Hero spell.

- **WildcardX** Harmony/Pacify line of spells will now cause aggro when resisted.

- **WildcardX** Added a check against CHA to avoid aggro from a resisted Harmony/Pacify spell.

## 02/19/2008¶

- **WildcardX** Found a small efficiency for the code that determines if an item is equipable.

- **WildcardX** Re-worked the rune spell buff code to make it more efficient and reduce CPU utilization.

- **WildcardX** Added the quest function depopall(int npctype_id). This will remove all mobs from the zone with the specified npctype_id.

- **WildcardX** Added the quest function depopzone(). This will remove all mobs from the zone and NOT cause a repop.

## 02/10/2008¶

- **WildcardX** Mesmerize line of spells will now cause aggro when casted on a mesmerize immune mob.

- **WildcardX** Fixed enchanter spell Theft of Thought. This spell will now work as described.

- **WildcardX** The pacify/harmony line of spells will no longer require a line of sight check to complete a cast.

## 01/28/2008¶

- **WildcardX** Regenerated perl_mob.cpp due to deprecating the following methods: GetFamiliar(), SetFamiliar(), GetRune(), SetRune(), GetMagicRune(), SetMagicRune().

- **WildcardX** Enchanters, this is your patch! Characters will now benefit from all rune and spell rune spell effects all spell buffs will provide, consistent with spell rules.

- **WildcardX** Rune and spell rune spell buffs will now persist zoning and camping.

- **WildcardX** Fixed a zone crash caused by TryWeaponProc() method.

## 01/27/2008¶

- **WildcardX** Subtle changes to zoning code to allow both the 6.2 and Titanium client to perform all zoning operations similiar to live.

- **WildcardX** Fixed #zone and #goto commands for both the 6.2 and Titanium client.

## 01/25/2008¶

- **WildcardX** Regenerated perl_client.cpp and perl_groups.cpp due to parameter changes for Group::TeleportGroup and Client::MovePC methods. Changes to some quest files may be necessary.

- **WildcardX** void MovePC(int32 zoneID, float x, float y, float z, float heading)

- **WildcardX** void TeleportGroup(Mob* sender, int32 zoneID, float x, float y, float z, float heading)

- **WildcardX** Pets will now report their buff list along with their health.

- **WildcardX** Fixed a bug that resulted in a zone crash if spell error logging is turned on.

- **WildcardX** (cavedude) Corrected an item id and some small typos in fishing.

- **KLS** Fixed a potential crash in Mob::CheckWillAggro()

- **KLS** Tweaked melee accuracy.

- **KLS** Ironed out some quirks between min hit and the AC code that was keeping it from mitigating some hits into misses.

- **KLS** (Knightly)#time should no longer be off by an hour, $zonehour, $zonemin and $zonetime are now exported to perl

- **KLS** Added player quests, player quests are quests designed to be attached to player processes such as zoning and clicking objects.

- **KLS** Player quests are loaded as either 'quests/zonename/player.pl' or as a template in 'quests/template/player.pl'

- **KLS** Player quests will export qglobals the client should be able to see and the following events are available for player quests:

EVENT_TIMER with var $timer

EVENT_CLICKDOOR with var $doorid

EVENT_LOOT with vars $looted_id and $looted_charges

EVENT_ZONE with var $target_zone_id

EVENT_ENTERZONE with no special var

EVENT_LEVEL_UP with no special var

## 01/24/2008¶

- **WildcardX** Removed a 64 character cap length on merchant names sent during a merchant greeting.

- **WildcardX** Fixed a bug that allowed players looting their corpse at just the right time, to duplicate their items.

- **WildcardX** Fixed a bug I caused in group portals when I corrected the Succor/Evac line.

- **WildcardX** Druids and Wizards rejoice! Succor/Evac will now perform a real zone and clear your aggro!

- **WildcardX** GM's can now summon players from one zone to another.

- **WildcardX** Cleaned up some of the code that handles zoning.

- **WildcardX** (cavedude) Reworked LeaveCorpses and LeaveNakedCorpses rules to allow for more options.

- **WildcardX** (cavedude) Created Character:DeathItemLossLevel rule to define when a player will leave items on a corpse.

Required SQL: insert into rule_values values(0, 'Character:DeathItemLossLevel', 10);

## 01/22/2008¶

- **KLS** Clients will be immune to proximity aggro until they are finished loading now.

- **KLS** Slightly reduced the melee accuracy of clients.

- **KLS** Melee mitigation should now properly enforce minimum damage.

- **KLS** Increased the level based damage bonus for high level characters in melee combat.

- **KLS** Removed tic by tic healing aggro.

- **KLS** Fixed several potential crashes in various parts of the code.

- **KLS** (Knightly)Merchants will now use their clean names when conversing with players.

- **KLS** Fixed some improper casting in the GMSummon code.

- **KLS** Figured in a work around for corpses between the server and client becoming unsynced for /corpse

- **KLS** AA Consumption of the soul should now function correctly.

- **KLS** AA Soul Abrasion should now function correctly

## 01/19/2008¶

- **KLS** Slightly reduced the effectivness of the Flurry AA

- **KLS** Speed of the Knight AA implemented

- **KLS** Evade will now reduce hate by a static amount, the static amount of hate increased slightly.

- **KLS** Healing aggro should now not aggro pets instead of their owners,

- **KLS** Removed the clause that made it so healing aggro was only effective if the healer had 100 hate or more on the target, effectivly making healers below level 30 immune to healer aggro.

- **KLS** HideReuseTime on the server reduced by 1 second, should reduce the number of times a player sees the 'Reuse time not met' error message.

- **KLS** Pets should now default to taunt ON instead of taunt OFF

- **KLS** Fixed a typo in ZoneDatabase::UpdateSpawn2TimeLeft()

- **KLS** LDoN treasure should now really check only class and not body type.

- **KLS** Added new rule NPC:BuffFriends, if false npcs will only heal and not buff their friends, defaults to false.

- **KLS** Changed Mob::CheckHitChance() should be more consistant throughout the levels; puts more value into skill levels.

- **KLS** Changed Mob:AvoidDamage() to use a single roll system, as well as applied dex to parry, block and riposte chance and agil to dodge.

- **KLS** Brought the melee attack formula more in line with what it should be.

- **KLS** Added a moderate melee damage bonus to monks, and a small one to all classes at 50, 55 and 60.

- **KLS** Fixed an issue with strikethrough where it could go off even if you had no chance to strikethrough.

- **KLS** NPCs will now load their skills from the max skills of their level via the skill caps database instead of being randomly generated.

- **KLS** Increased the damage of backstab from str and dex and the general damage of several monk abilities.

- **KLS** Mob::GetProcID() should now try to fix SK spells automatically.

- **KLS** Aggro changes: Aggro has been changed to be based on a more live-like system, it is now based on potential damage instead of actual inflicted damage, hate is now unaffected by melee mitigation and resists.

- **KLS** Implemented jolt like effects straight into the aggro system, such effects should be calculated into a spells aggro regardless of resistance now.

- **KLS** Added an optional smart aggro list controlled by rule Aggro:SmartAggroList; true will enable it. This aggro list attempts to choose targets in a much smarter fashion, prefering players to pets, sitting and critically injured players to normal players, and players in melee range to players not.

Added several rules to adjust the aggro system with: Aggro:SmartAggroList ( true ) Aggro:SittingAggroMod ( 35 ) Aggro:MeleeRangeAggroMod ( 20 ) Aggro:CurrentTargetAggroMod ( 0 ) Aggro:CriticallyWoundedAggroMod ( 100 ) Aggro:SlowAggroMod ( 450 ) Aggro:IncapacitateAggroMod ( 500 ) Aggro:MovementImpairAggroMod ( 175 ) Changed Spells:SpellAggroModifier to Aggro:SpellAggroMod ( 100 ) Changed Spells:BardSpellAggroMod to Aggro:SongAggroMod ( 33 ) Changed Spells:PetSpellAggroMod to Aggro:PetSpellAggroMod ( 10 )

## 01/16/2008¶

- **KLS** Updated AA_Data.sql with various small fixes.

- **KLS** Changed HasPet() to check for the existance of the pet as mob as well as the petid, should sync up with GetPet() nicely now.

## 01/15/2008¶

- **KLS** LDoN /open will only check for class now, client does not enforce bodytype so neither will the server.

- **KLS** Numhits in disciplines should work correctly now

- **KLS** Changed many instances where HasPet() was being checked to verify that we have a valid pet pointer from GetPet(), GetPet() will be used instead, (it is possible to have a valid pet ID and an invalid GetPet() pointer)

- **KLS** Bind wound will no longer check for existance of skill, everyone gets this skill and it was breaking bind wound for people with 0 skill.

- **KLS** Fixed an issue that was keeping berserkers and rangers from triple attacking.

- **KLS** PickPocket should now correctly skill up on it's own through normal use.

- **KLS** GetMinLevel(int16 spell_id) will now return 0 if the level for the class was 255 instead of 255, many buff formulas do not work well with 255 which can cause some issues when a class can use a clicky item with a spell they cannot scribe normally.

- **KLS** GetProcID() should no longer have hard coded values.. whatever these represented are no longer valid in the current spell data.

## 01/14/2008¶

- **WildcardX** Replaced the corpse consent system with one that allows cross zone player consents.

## 01/13/2008¶

- **FatherNitwit** (Derision) Added tool (awater) to extract BSP tree with region type info from .s3d files into .wtr files.

- **FatherNitwit** (Derision) Added support for zone to load .wtr files.

- **FatherNitwit** (Derision) Employ water file to prevent under water mobs from sinking.

- **FatherNitwit** (Derision) Employ water file to enforce fishing near water.

New Rules (see ruletypes.h for more info):

- **Watermap**CheckWaypointsInWaterWhenLoading (Default: false)

- **Watermap**CheckForWaterAtWaypoints (Default: false)

- **Watermap**CheckForWaterWhenMoving (Default: false)

- **Watermap**CheckForWaterOnSendTo (Default: false)

- **Watermap**CheckForWaterWhenFishing (Default: false)

- **Watermap**FishingRodLength (Default: 30)

- **Watermap**FishingLineLength (Default: 40)

## 01/12/2008¶

- **WildcardX** (cavedude) Fixed beastlord pet sizes.

## 01/09/2008¶

- **KLS** Starting items will now be saved if they are placed in slots other than the primary 8, this includes inside bags and on the character's inventory and bank slots

- **KLS** Kick at level 55 or higher now has a chance to act as a spell interrupt as bash does.

- **KLS** (TheLieka) Stun Immunity for Frontal Stuns on Ogres

- **KLS** (TheLieka) Added out of combat regen to NPCs based on rule NPC:OOCRegen

- **KLS** NPCs with quests using the Perl Quest Parser should no longer stop if they do not have an EVENT_SAY sub

- **KLS** /autofire cleaned up some, fixed many situations where it shouldn't fire and it now will auto. use throwing weapons as well as bows

- **KLS** Ranged and Throwing attacks will break invis. correctly.

- **KLS** Added the following rules:

- Character:HealOnLevel (Default: false)

- Character:FeignKillsPet (Default: false)

- Character:ItemManaRegenCap (Default: 15)

- Character:ItemHealthRegenCap (Default: 15)

- Combat:UseIntervalAC (Default: false)

- Combat:PetAttackMagicLevel (Default: 30)

- NPC:SayPauseTimeInSec (Default: 5)

- NPC:OOCRegen (Default: 0)

## 01/08/06¶

- **FatherNitwit** Fixed more windows compile errors on .net 2003+...

---

## 2009

*Source: changelog/server/2009/index.html*

# 2009¶

## 12/30/2009¶

- **Derision** Update azone2 with EQG v4 support.

## 12/27/2009¶

- **Derision** Fix to set required heading when zoning.

## 12/23/2009¶

- **cavedude** (Kilelen) Added quest functions quest::checktitle(int titleset), quest::enabletitle(int titleset), and quest::removetitle(int titleset) to allow Perl to enable or remove titles for a player.

Required SQL: utils/sql/svn/1057_titles.sql

## 11/21/2009¶

- **KLS** Ad hoc task selectors should ignore tasks that are not enabled now.

## 11/19/2009¶

- **Congdar** Fixed Resist Stat Caps, Removed GetMax...() methods calculating some AA's twice.

## 11/18/2009¶

- **KLS** Added check for character deletion as pointed out by Rogean.

## 10/31/2009¶

- **AndMetal** Changed HP regen calculations to be Live-like. Basically higher level regen will be about 50% more than it is currently & FD regen should be better than standing, but less than sitting (instead of 25% of sitting regen).

- **AndMetal** Races that get the HP Regen "bonus" (Iksar & Troll by default) can be customized as a bitmask via rule Character:BaseHPRegenBonusRaces(4352).

- **AndMetal** Added #setallskills alias for #setallskill/#setskillall.

- **AndMetal** Added '#rules get [rule]' for a single rule & '#rules values [catname]' for a category to allow real-time viewing of the rule values from the zone (not the DB).

- **AndMetal** Added client HP, Mana, & Endurance regen info to #showstats/#mystats

## 10/30/2009¶

- **KLS** Exported DoSpecialAttackDamage() to perl::mob;

## 10/25/2009¶

- **WildcardX** Tweaked guilds a little to accomodate integrating BOTS.

- **WildcardX** Bots can not join guilds in the same way as characters can. Bots can only be members, not officers.

- **WildcardX** Deprecated the legacy BotRaids system and all #bot raid commands. Also deprecated the legacy botgroups table.

- **WildcardX** Renamed the #bot group order ... series of commands into only #bot group ...

1040_DeprecatedBotRaidsSystems.sql

## 10/23/2009¶

- **KLS** Added discussed work around for SoF > level 75 issue from forums.

- **WildcardX** Bot pets and bot pet items and bot pet buffs will now save their state to the database between zones and camps just like a character.

- **WildcardX** Add SQL to create unique columns in group_id and group_leaders tables in hopes of removing the last of the seemingly random issues with groups and zoning.

1038_grouptablesuniquecolumndefinitions.sql

1038_botpetstatepersists.sql

## 10/21/2009¶

- **WildcardX** Bots will now persist their buffs to the database while zoning or camped.

1036_botbuffs.sql

## 10/20/2009¶

- **WildcardX** Bots can now be a group leader. A character can now make not only a group mixed with both bots and other characters, but also groups with all bots and lead by a bot the character designates. Please see #bot botgroup help for details. The legacy BotRaids logic will be removed from the server code in the next 24/48 hours. This effectivly makes bot raiding the same as before the raid system was created. Much of the existing "#bot group order" commands will also be deprecated soon.

- **WildcardX** Fix for a bug with #bot botgroup add.

- **WildcardX** Fix for a bug with bot group leader's record in group_id table not removing any older records.

- **WildcardX** Fix for a bug that caused a bot group leader to say it is following itself.

- **WildcardX** Fix for a bug that caused a zone crash when a client ungracefully disconnects from zone but zone still runs and the client had spawned bots.

- **KLS** Added #globalview

- **KLS** QGlobals will update instantly for the zone they're in.

## 10/19/2009¶

- **WildcardX** Fixed a number of bugs with support bots zoning. Refactored the code and eliminated the botactives table.

1030_botzoningsupport.sql

## 10/18/2009¶

- **WildcardX** Bots can now zone with their bot owners as long as they are in a group. Bots not in a group will camp instead of zone.

1027_botactives.sql

## 10/17/2009¶

- **WildcardX** A character and a bot can now recieve an ldon adventure.

1022_botadventuring.sql

## 10/15/2009¶

- **AndMetal** Added rule Combat:ProcTargetOnly(true). Allows the change from Rev 606 that limits procs to only the target to be removed. Note: AE procs can still cause stability issues if it is set to false.

- **AndMetal** Fixed some "no newline at end of file" warnings.

- **AndMetal** Corrected formatting/typo for some # commands.

- **AndMetal** Fixed a memory leak in Client::ZonePC().

- **KLS** Changed how QGlobals are tracked on the server to reduce the amount of times we query the database. I've tested it quite a bit but if you find anything wrong with the new implementation: report it.

## 10/07/2009¶

- **Rogean** #motd now updates clients instantly serverwide.

## 09/30/2009¶

- **Rogean** Fixed possible crash in Mob::CheckWillAggro();

- **Rogean** Temporarily Disabled Fear MaxLevel Check causing a crash.

- **Trevius** Added Quest Commands quest::playerfeature(feature, setting) and quest::npcfeature(feature, setting) * See Wiki for details on usage.

- **Trevius** Added Quest Objects GetHairColor(), GetBeardColor(), GetEyeColor1(), GetEyeColor2(), GetHairStyle(), GetLuclinFace(), GetBeard(), GetDrakkinHeritage(), GetDrakkinTattoo(), and GetDrakkinDetails().

## 09/29/2009¶

- **Rogean** Direct Heal and Rune Aggro are now based off the mana cost of the spell.

- **Rogean** HoT Aggro is now based off the per-tic heal amount, when the spell lands.

- **Rogean** Fixed several issues with focus effects. Beneficial Hate Reduction Focus should now work.

- **Rogean** Fixed AA Spell Casting Subtlety not applying to heal aggro. Also changed to correct values.

## 09/27/2009¶

- **cavedude** (Shin Noir) Implemented Wizard AA: Teleport Bind.

- **cavedude** (tsowl) GMs will no longer need a key for locked portal doors.

- **cavedude** (tsowl) Fix for shared and normal bank dupes.

- **cavedude** (Nachyoz) Corrected a bug preventing $faction from reporting correct values.

- **cavedude** (drakelord) Runes will now block stuns, provided the damage does not exceed the rune's limit.

## 09/23/2009¶

- **gaeorn** small fix to pathing code for 64bit

- **gaeorn** a few changes to makefiles to clean things up

## 09/20/2009¶

- **Rogean** Small (Big?) Aggro change, melee swings now generate same aggro regardless of hit/miss/dodged.

- **Rogean** Aggro Formula changed to weapon_damage + dmg bonus + elemental dmg + (if applicable) bane dmg.

## 09/18/2009¶

- **KLS** Fixed an error with Perl::Group::GetMember(index) added Perl::Raid::GetMember(index).

- **KLS** Added new npc types field: 'unique_spawn_by_name'. NPC will only attempt to spawn if there isn't already a npc with it's exact name in the zone already.

- **Rogean** Added World IP Logging @ Login.

980_account_ip.sql

## 09/16/2009¶

- **KLS** Added support for raid all loot (type 4), raids will default to this loot type now(may have some appearance issues).

- **KLS** Added command #raidloot to change raid loot manually, this is needed for titanium if they want to switch from 4 to another and back to 4 since the client does not support type 4 natively.

- **KLS** Added private_corpse to npctypes to dictate whether a corpse will unlock to outside people or not, by default(0) it will unlock.

## 09/08/2009¶

- **Trevius** SoF * Corrected disciplines for SoF clients so they can load up to 100 instead of being cut-off at 50 max.

## 08/28/2009¶

- **KLS** Fix for bug with AI_Start not clearing feign death.

- **KLS** Worked out basics for /claim, not yet implemented but worked out all the packets needed for sof/titanium.

- **KLS** Finished with /claim implementation.

## 08/26/2009¶

- **KLS** Significantly lowered karma required to talk globally if using the system.

- **KLS** Fixed some small potential exploits.

- **KLS** Extended anti-spam to /tell, will extend fully to universal chat server soon.

- **KLS** Started work on /report but did not finish implementation yet.

- **KLS** Added hotzone support.

- **KLS** Finished /report implementation.

## 08/23/2009¶

- **WildcardX** *BOTS* Fixed a bug that made bots ghost when moving.

- **KLS** More tweaks to anti-hack systems, should trigger MQWarp less often.

- **KLS** Instituted a cooldown on looting items from corpses, 200ms per item looted.

## 08/17/2009¶

- **KLS** Fix for zonesummon variables influencing next zone attempt if you inner-zone first.

## 08/13/2009¶

- **KLS** Added method to enable / disable spawn2 entries from spawning, enabled by default obviously.

- **KLS** Two quest methods to modify spawn2 behavior quest::enable_spawn2(spawn2_id) and quest::disable_spawn2(spawn2_id), disable will force depop whatever mob is currently spawned in that spawn2 point if any.

- **KLS** quest::spawn_from_spawn2(spawn2_id), will force a spawn_2 point to spawn a npc even if disabled or it already has a npc spawned.

- **KLS** Exported several new C-Objects to perl: MobList, ClientList, NPCList, CorpseList, HateEntry, HateList. Examples of how to use can be found in utils/Examples/ListIteration.pl

## 08/11/2009¶

- **WildcardX** *BOTS* Refactored some bots code and implemented a new feature. Players can now inspect bots and their equipment just like players inspect other players. Enjoy!

- **Trevius** (Secrets) Minor fix for the new Maxlevel Scaling for NPCs to correct a HP issue if they have visible armor/weapons or buffs.

- **Trevius** SoF * Updated Opcodes for Voice Macros. They now function in SoF (/vtell, /vgroup, /vraid).

- **WildcardX** *BOTS* Cleaned up bot inventory code a little and fixed a bug that caused some items to display in incorrect slots in the inspection window.

- **WildcardX** *BOTS* Bot bards are now holding concerts for those willing to listen...

## 08/10/2009¶

- **WildcardX** Tweaked Groups a little to allow a group to consist of both Bots and Clients, doesn't matter what order you invite either nor does it matter how many of each.

- **WildcardX** *BOTS* A client camping out or zoning will now auto camp out all their bots and clean up any group those bots may have been in.

- **gaeorn** renamed zone->map to zone->zonemap to eliminate compile warning

- **gaeorn** added lots of type casting for 64bit compatibility

- **KLS** Added #revoke support to /auction and UCS chat channels.

- **KLS** Added rule Chat:KarmaGlobalChatLimit amount of karma needed to be able to chat in global channels below the minimum level and Chat:GlobalChatLevelLimit. By default the level is 8 and the karma amount equal to 24 hours of /played time. Meaning that unchanged someone must be >= level 8 or have more than a day of played time before they can chat in global channels.

## 08/09/2009¶

- **WildcardX** *BOTS* Fixed the bots illusion bug that caused a bots gender and race values to be changed to that of the illusion in the bots table.

- **WildcardX** *BOTS* Added new bots command, "#bot giveitem". This command lets you give a NO DROP, NO TRADE item to your bot as long as its on your cursor.

- **WildcardX** *BOTS* Added new commands, "#bot camp" and "#bot camp all". The first orders your bots to camp out if you target them. The second orders all bots you own to camp out, no need to target each.

- **Trevius** Created methods for when an NPC is spawned to clean up the NPC code some.

- **WildcardX** *BOTS* Fixed a bug caused by using #bot giveitem that didn't update the client that the iyem that was on the cursor is now gone.

- **WildcardX** *BOTS* Fixed a bug that crash the client when trading with a bot.

- **KLS** Fix for #ban

- **KLS** #ban will now update the player's flag and kick them from the server.

## 08/08/2009¶

- **WildcardX** *BOTS* More code refactoring.

- **WildcardX** *BOTS* Bots now appear as another client player to your client. This will lead to using your UI to perform operations like group invites/disbands and the raid UI. Perhaps even guilding your bot! (Thanks Trev for your assistance!)

- **WildcardX** Fixed a bug that negatively impacted BOTS when the NPC scaling logic was introduced. This caused bots to spawn as outrageously large levels, like level 185!

- **WildcardX** *BOTS* Bots can now be invited and disbanded from your group by simply using the group "Invite" and "Disband" buttons from the client's UI.

- **WildcardX** *BOTS* Tweak to the bots total play time calculation to make it more accurate.

- **KLS** Added #path meshtest simple to do a faster search on errant path nodes.

- **KLS** Modified the accurate hazard code to make automatic path maps with more accurate info that requires less manual editing afterward.

- **cavedude** (mackal) Pets will now be amiable to their owners, indifferent to all else.

- **cavedude** (mackal) Added $client->KeyRingCheck() and $client->KeyRingAdd() to allow Perl to manipulate the keyring.

- **cavedude** (mackal) Casting an invis spell on a player that already has a similar type invis spell will no longer drop the existing buff.

- **cavedude** (mackal) Corrected message string for heal spells.

- **cavedude** Added rule to determine at what HP a fleeing NPC will halt due to being snared.

## 08/07/2009¶

- **WildcardX** *BOTS* More code refactoring.

- **WildcardX** Implemented 4 additional abstract methods in the mob object, HasRaid(), HasGroup(), GetRaid(), GetGroup(). These will be implemented as common interfaces by any class deriving from Mob.

- **WildcardX** *BOTS* Tweaked bot logic so group channnel doesnt get spammed with every swing.

- **Trevius** Minor adjustment to the flow of logic for the MaxClientsSetByStatus rule to allow it to override settings for the additional max client rules if enabled.

- **Trevius** Corrected the Attack Rating portion of #showstats and #mystats

- **Trevius** (Secrets) Added new quest::gmsay("message") command that will send a message to all GMs (GMs only) on the server.

- **Trevius** (Secrets/Trevius) Added 2 new fields (maxlevel & scalerate) to npc_types for allowing NPCs to spawn within a range of levels and scale stats at the rate set

- **WildcardX** NPC is no longer a friend class in the Mob class. Moved the class member Mob::target to Mob's private scope to ensure other classes use the Mob::GetTarget() and Mob::SetTarget() methods.

- **WildcardX** *BOTS* Commented out code that let bots use the groups chat channel until I can fix I bug I found that causes bots to have their targets repeatedly reset to null values and back to their attacker while in combat.

Required SQL: utils/sql/svn/898_npc_maxlevel_scalerate.sql

## 08/06/2009¶

- **WildcardX** *BOTS* Significantly modified the bots table. Removed several unnecessary columns and changed many interger columns to accept signed values. Added new columns to track dates and times for bots.

- **WildcardX** *BOTS* Slowed bot runspeed to a more reasonable default value.

- **WildcardX** *BOTS* Bots will now depop instead of being murdered to go away.

- **WildcardX** Only a Client object will try to update its group id in the database when a group member is removed from the group.

- **WildcardX** *BOTS* Bots will now record their total play time.

- **WildcardX** Modified Group::AddMember() to be more bots friendly and removed specific bot code to do the same thing.

- **WildcardX** *BOTS* Modified the IsBotAttackAllowed() method to prevent a bot wizard's familiar from attacking.

- **WildcardX** *BOTS* More code refactoring. Bots will now use group message channel to communicate with the group (idea being bots may eventually be in a different zone than the group and/or client).

Optional SQL: *BOTS* utils/sql/svn/892_optional_bots_table_mod.sql Optional SQL: *BOTS* utils/sql/svn/893_optional_bots_table_mod.sql

## 08/05/2009¶

- **WildcardX** Fixed a bug that prevented COMBAT_EVENT signaling to NPC's from working correctly.

- **WildcardX** Bots will now call the database a lot less regarding their inventory. They can get info about their inventory from memory during runtime.

- **WildcardX** Bots appearance like face, hair, etc is now persisted to the database and used during runtime.

- **WildcardX** (Taurinus) Tweaked the way bots calculate their AA's so the code isn't as long and is easier to read.

- **WildcardX** A bot getting aggro will aggro its group members for them to come to the bots defense.

- **gaeorn** added utils/sql/svn/botsconvert.sql to convert old schema bots and inventory to new schema. if you need to convert old bots, use this instead of bots.sql.

## 08/04/2009¶

- **WildcardX** Fixed a bug that broke cash handins with NPC's.

- **WildcardX** Fixed a bug that reversed a riposte attack's target.

- **WildcardX** Merged the "bots" branch into trunk and removed the prior "EQBOTS" system from trunk. Please carefully evaluate this version before making any decision to upgrade your servers.

- **Trevius** Added a Distance option for quest::follow(entity_id, distance) to allow setting the distance for the NPC to follow at.

## 08/02/2009¶

- **realityincarnate** SoF * Added opcode values to avoid packet dumps of some of the more annoying unknowns

- **realityincarnate** SoF * Tradeskill success messages now display the recipe name instead of %1

- **realityincarnate** Added #myskills command to bring up an SoF-style skills window showing current and capped skill levels

- **realityincarnate** Skills can no longer pass the cap from initial training (specifically bard meditate)

## 7/31/2009¶

- **WildcardX** Implemented a method to calculate the reciprocal heading of a specified mob object.

## 7/30/2009¶

- **Trevius** Added heading option and bool option for saving guard spot to quest::moveto(x,y,z,[h,saveguardspot?]).

- **Trevius** Added rule MaxClientsSetByStatus. If True, IP Limiting will be set to the status on the account as long as the status is > MaxClientsPerIP.

## 7/29/2009¶

- **AndMetal** Small fix to quest::scribespells() to return the correct amount of scribed spells.

- **AndMetal** #setaapoints/#setaapts will now consistently add the correct amount of AA points. Also added a rule AA:ExpPerPoint(23976503).

- **AndMetal** Added a little bit of logging for exp (CLIENT__EXP). Disabled by default.

Optional SQL: utils/sql/svn/853_optional_rule_aaexp.sql

## 7/27/2009¶

- **gaeorn** changes to login server to compile under linux. added linux makefile for linux. converted utf16 sql files to normal ascii text.

- **KLS** Fix for issue where client would stop recieving communication when recieving more than 36 nodes in a find reply. Resolved by capping the amount of nodes find can return, more than 36 will result in unable to easily find message.

## 7/26/2009¶

- **AndMetal** AGI Penalty for being encumbered now matches the Titanium client. The old formula was much higher than the client was reporting.

- **AndMetal** Added InLiquid() function to the WaterMap class. Will return true if you're in Water or Lava (or both?)

- **AndMetal** Converted to some more Message Strings in zone/spells.cpp.

- **AndMetal** Changed GetNextAvailableSpellBookSlot() & FindSpellBookSlotBySpellID() to return a result much faster.

- **AndMetal** The scribespells commands/quest functions should no longer overwrite existing spells & will use only unused book slots.

- **KLS** Added #path resort nodes to facilitate with keeping the pathing nodes in order.

- **KLS** Fix for crash from adding/removing nodes.

- **KLS** Combat range will now check the z axis as well.

## 7/25/2009¶

- **KLS** Added a much more accurate but slower Hazard Detection algorithm for #path process that will calculate water and very spikey terrain between two points, other instances of PathManager::NoHazards untouched.

- **KLS** Added #path move and #path disconnect all.

## 7/24/2009¶

- **Derision** Moved RecalcWeight to after CalcAABonuses in bonuses.cpp because valgrind complained aabonuses.packrat was used uninitialised.

- **Derision** Fixed memory leak in /who all processing.

- **KLS** Added functionality to #path to faciliate making .path files in game, including a very CPU intensive #path process filename which will try to create a connected path from unconnected laid out nodes.

- **KLS** /find will now do a hazards check.

## 7/22/2009¶

- **realityincarnate** Added quest::factionvalue() command to give more logical faction values than the client uses (Scowling = 1, Ally = 9)

## 07/21/2009¶

- **Trevius** Added a 4th type for quest::getlevel(type) that will get the characters level2 value, which is the max level the character has ever reached.

- **Trevius** Added a 3rd option for saylink() to allow the link to be different than the say message. Ex quest::saylink("bind my soul", 0, "bind your soul")

## 07/20/2009¶

- **Trevius** Corrected/Updated some minor size stuff with illusions and player races.

## 07/19/2009¶

- **Trevius** EVENT_PROXIMITY_SAY will now work whether you have a target or not.

- **Trevius** Added bool option to quest::saylink() to allow them to be silent. Ex. quest::saylink("silent link",1)

- **Trevius** Added quest::FlyMode() command to allow setting flymode on players via quest scripts.

- **WildcardX** Fixed the build by casting this->GetTarget() as NPC in void Client::Handle_OP_ItemLinkClick method as a parameter to a EVENT_SAY call.

- **WildcardX** Added the changelog file to the solution for convenience.

- **realityincarnate** Spells cast from items now reduce the charges before creating spell effects (stops loregroup conflict with Gloves/Hammer of Infuse)

## 07/15/2009¶

- **Trevius** (Shendare) New object command (#object List|Add|Edit|Move|Rotate|Save|Copy|Delete|Undo) to manipulate objects in real-time from in-game in almost every possible way!

## 07/14/2009¶

- **WildcardX** (for BOTS alpha code only) Set textures to 0 to create the correct appearance of a naked bot on spawn without any equipment.

- **AndMetal** Changed AA Effects to be loaded into a map instead of a static array.

- **AndMetal** Changed weight in the client class to uint32 from int16 since the client uses 32 bits for the weight. This should prevent it from overflowing.

- **AndMetal** Corrected Packrat from 10% per level to 1% per level per the Titanium client. It also now affects coin weight (also 1% per level) per the Titanium client.

- **AndMetal** Cleaned up a few compile warnings.

- **WildcardX** Advanced a couple error messages before a return statement in the EQEmuLoginServer project.

## 07/13/2009¶

- **KLS** Reimplemented pet hate scaling.

- **KLS** Removed code that ports you if you're found warping.

- **WildcardX** (for BOTS alpha code only) Inviting a bot to group will show the bot name without any numeric characters (ie, mob::cleanname()).

- **WildcardX** (for BOTS alpha code only) Detecting pacified mobs via spell effect type instead of specific spell id's.

## 07/12/2009¶

- **Trevius** Added "featuresave" option to #npcedit that will save all currently set facial features.

- **Trevius** Fixed crash for #randomfeatures if no target was selected before using it.

- **Congdar** Fix EQBOTS AISpells break. Add new rules, features too much to list.

- **KLS** Upped default monk melee damage, halved default monk special attack damage by a little over half.

SQL: /utils/sql/svn/773_monk_rules.sql

## 07/11/2009¶

- **KLS** SoF * Changed raid join packet encode slightly.

- **KLS** SoF * Added workaround for disconnection on death for now.

- **WildcardX** Fixed BOTS so the bot doesn't warp to its owner.

- **WildcardX** All commands for the BOTS system can be tested now except for bot raiding and bot group raiding.

## 07/10/2009¶

- **Trevius** (Zeice) Added #mystats command as an alternative to #showstats that only shows stats for the client or it's own pet.

- **WildcardX** Migrated more code from EQBOTS to BOTS. The BOT code is less buggy than last iteration and now has even more active features that can be tested but there is a known issue or two I am aware of and working to correct.

- **KLS** Fix for fear not wearing off properly.

- **KLS** Small tweaks to npc spell ai.

- **KLS** SoF * Raids should now function properly.

## 07/09/2009¶

- **WildcardX** Migrated more code from EQBOTS to BOTS. The BOTS code can do basic functions now but its still "buggy" compared to EQBOTS until migration/integration is complete.

- **KLS** Clients are no longer immune to charm.

- **KLS** Added several checks for IsFeared where we were previously only checking IsStunned.

- **KLS** EVENT_COMBAT should no longer be called when a NPC dies.

- **KLS** Changed way AISpells was loading, did away with arbitrary 16 spell limit on npc spell lists.

## 07/08/2009¶

- **WildcardX** Migrated more code from EQBOTS to BOTS.

- **WildcardX** Included StringIDs.h to the zone project file and allowed the ";" to replace the "," characters in the WORLD project file.

- **Trevius** Added rule ArcheryBaseDamageBonus to allow easy adjustments to archery base damage

- **Trevius** SoF * Adjusted how AAs are loaded to allow all to be fully functional. This is a temp work-around until the correct way is finalized.

- **KLS** Lowered aggro backstabs generates by roughly ⅔ for a high level rogue, probably a bit less for a low level rogue.

- **KLS** Backstab will now use the backstab damage field from items instead of weapon damage.

- **KLS** Redid all combat skill ups, can only skill up against light blue targets or better for offensive and defensive actions, wont work against clients or NPCs who don't have aggro lists.

- **KLS** Mobs will prefer targets who are not feared to targets who are feared when selecting new targets.

- **KLS** Added Rule (Character, MaxFearDurationForPlayerCharacter).

- **KLS** Fear will now cause PCs to run instead of just be stunned, beware.

## 07/07/2009¶

- **Derision** Fix for mobs getting stuck if their path between waypoints attempts to take them 'under the world'.

## 07/06/2009¶

- **KLS** Reworked EVENT_ATTACK to be more efficient.

- **KLS** Reworked EVENT_COMBAT to be both more efficient and smoother, no longer having an arbitrary delay before it fires.

- **KLS** Took out code in HateList::IsEmpty() that no longer makes any sense to me, it should be noticably faster.

- **KLS** Took out old unused quest::flagnpc stuff.

- **KLS** Added #netstats command, allows GM to view the network sent/recv & sent/recv per second on their target or themselves.

- **WildcardX** Migrated more code from EQBOTS to BOTS and reworked BOTS to derive from NPC object instead of Mob.

## 07/05/2009¶

- **gaeorn** (drakelord) Added slow migitation. Set npc_types.slow_mitigation with the portion of slow you want mitigated: 0 = 0%, 1 = 100%, .5 = 50%, etc.

- **AndMetal** AAs are now calculated in CalcBonuses for clients.

```
` AAs that have been converted: (Advanced) Innate STR / STA / AGI / DEX / INT / WIS / CHA, Innate Enlightenment, Natural Durability, Physical Enhancement, Planar Durability, Packrat. They should already be in the PEQ aa_effects table.
 For new AAs, you'll want to modify the StatBonuses struct in zone/mob.h. You'll also need to add a case in ApplyAABonuses in zone/bonuses.cpp to add it to aabonuses.
`
```

- **AndMetal** (via Congdar) Fix for quest::traindiscs().

- **AndMetal** Fixed Packrat. However, it doesn't seem to be updating correctly to the client (or we're taking too much off).

- **AndMetal** Added weight to #showstats, accurate to 1 decimal point.

- **KLS** NPCs will no longer try to base their attack speed off weapons they're using, the code wasn't working anyway.

- **KLS** Lowered monk kick damage and damage table bonuses but added rules to govern this damage so they can be boosted up for any servers that want.

- **KLS** More work on ranged damage for npcs, not yet fully implemented but quest functions can cause NPCs to ranged attack.

- **KLS** Added quest::IsEffectInSpell(spell_id, effect_id), quest::IsBeneficialSpell(spell_id), quest::GetSpellResistType(spell_id), quest::GetSpellTargetType(spell_id)

Required SQL:

utils/sql/svn/745_slow_mitigation.sql

## 07/03/2009¶

- **KLS** Fix for AA reuse timer text.

- **KLS** Added rules to replace defines: Combat:MaxRampageTargets, Combat:MaxFlurryHits

- **KLS** Redid inner workings of rampage a bit to be more efficient memory wise and to hold an unlimited number of rampage targets instead of capping at 20.

- **KLS** Made ranged combat stuff virtual so I can implement npc ranged attacks tomorrow.

- **KLS** Added 3 perl functions for the mob scalar type: SetEntityVariable(id_num, var), GetEntityVariable(id_num) and EntityVariableExists(id_num), taking int32 for id_num and string for var. Allows someone to store as many variables on the entity being targeted as they would like.

## 07/02/2009¶

- **KLS** Berserker NPCs will now frenzy instead of kick.

- **KLS** Fix for GetHateRandom() method crash if there are 0 people on the hate list.

- **KLS** Repop force was broken when we went to the instancing system, it has now been fixed.

- **KLS** Updated #advnpcspawn to be able to edit respawn and variance timers of spawn points in game.

## 07/01/2009¶

- **AndMetal** Added rules for Sacrifice, which also corrects the minimum level you can use it on: Spells:SacrificeMinLevel(46), Spells:SacrificeMaxLevel(69), & Spells:SacrificeItemID(9963).

- **AndMetal** Switched to some more Message String IDs.

- **AndMetal** quest::scribespells can now accept minimum level as a 2nd argument. Examples: quest::scribespells(60,60) will scribe just level 60 spells, quest::scribespells(75,71) will scribe spells from 71 through 75.

- **AndMetal** Ditto with #scribespells, quest::traindiscs, & #traindiscs.

- **AndMetal** quest::scribespells & quest::traindiscs will now return the amount of spells/disciplines that were scribed/learned (an optional way to verify success or failure).

- **AndMetal** #scribespells & #traindiscs will limit the max level to whatever the rule Character:MaxLevel is set to, unless you have GM Mode turned on, in which case it's limited to 255 (uint8).

- **AndMetal** Fixed a compile error introduced in Rev 729.

- **gaeorn** SE_Harmony and SE_ChangeFrenzyRad effects were reversed. This is based on info from alla regarding spells post OoW that only have SE_Harmony effect (reaction radius).

- **KLS** Added NPC code 'd' to make npcs be able to see through feign death attempts. (mostly implemented, still have to look into aggroing people who are feigned by proximity)

- **KLS** Fixed a typo in the petition code and un-reverted the petition.h file (hi, there's a reason it was changed).

- **KLS** Added mob perl object HealDamage(amount, caster = 0);

Optional SQL: utils/sql/svn/732_sacrifice_rules.sql

## 06/30/2009¶

- **Derision** Fix for mobs in pathing enabled zones fleeing at low health at full run speed.

- **Derision** Made rule Map:UseClosestZ default to false. Only set true if using azone2 generated maps (specifically those for EQG zones).

- **realityincarnate** Starting cities are now tracked for newly created characters.

- **realityincarnate** Enabled the /setstartcity command for characters without a start city assigned.

- **realityincarnate** Added $client->SetStartZone and $client->GetStartZone perl commands.

- **KLS** Petitions will assign id based on character id instead of this stupid desyncing junk.

- **KLS** Max NPC name length increased to 50 characters up from 30.

- **KLS** Save on zone success will now commit immediately instead of possibly delaying. Hopefully will help with some of the situations where people zone to bad locations.

- **gaeorn** New rule NPC:SmartLastFightingDelayMoving. When true (default), if a mob is already wandering home during a FD pull and the puller stands up and then FD again, the mob's timer to return home will not reset, but instead will return home immediately. The timer will be reset if the mob forgets about the FD puller.

- **gaeorn** New rule Combat:AssistNoTargetSelf. When assisting a target without a target: true = target self (default), false = leave target as was before assist (this is the behavior on live).

Optional SQL:

utils/sql/svn/730_smart_delay_moving.sql utils/sql/svn/731_rule_assist_notarget_self.sql

## 06/29/2009¶

- **Derision** Fixed a pathing bug relating to nodes incorrectly culled from the front of a path.

- **KLS** Reworked bind code a bit.

- **KLS** Pets no longer get client war/berserker crit bonuses.

## 06/28/2009¶

- **Derision** Began work on pathfinding for aggro/fear and Find NPC.

The path files for the first few zones can be found at http://code.google.com/p/projecteqemu/downloads/list Put the .path files in your Maps directory with your .map and .wtr files.

Optional SQL:

utils/sql/svn/721_pathing_rules.sql

## 06/27/2009¶

- **KLS** Specialization should now never increase the amount of mana it takes to cast a spell.

- **KLS** Fix for mana preservation focus not functioning correctly.

- **KLS** Fix for duration enhancement focus effects not affecting detrimental spells.

- **KLS** Fix for summoning focus not reducing the cast time of nec/beast pets serverside.

- **KLS** Insufficient mana serverside check will now be before any modifiers instead of after, if you don't have enough mana in your mana pool to cast a spell after modifiers but do before modifiers the spell will cost your entire mana pool.

- **KLS** Added new npc code 'g', lets npcs resist spells by casters that are not in melee range.

- **WildcardX** More code migration from EQBOTS to BOTS.

## 06/26/2009¶

- **Trevius** SoF * Tradeskill containers within a character inventory can now combine recipes.

- **Trevius** SoF * Items with Recast Delays no longer appear as greyed out.

- **KLS** More changes to archery damage.

## 06/25/2009¶

- **Trevius** Structure work for Player Profile Recast Timers and Illusions in 6.2 Client.

## 06/24/2009¶

- **Trevius** #wc (wearchange) as well as all of the facial feature commands will now retain armor tint when used.

- **Trevius** Using #wc now makes temporary changes visible by all clients.

- **Trevius** Decimals can now be used with the #size command instead of it only accepting whole numbers.

- **Trevius** Size is now identified in the illusion struct for SoF and Titanium.

- **KLS** Implemented quiver haste.

- **KLS** Change to ranger stationary archery bonus. (Re: Nerfed)

- **KLS** Adjusted high level ranger archery hate.

- **KLS** Fix for mana reduction focus effect checking base instead of base2

- **KLS** Fix for hybrids not getting mana reduction effects.

Optional SQL: /utils/sql/svn/710_tint_set_naming.sql

## 06/23/2009¶

- **KLS** /surname changes

- **KLS** Implemented OP_ClearSurname

- **KLS** (gaeorn) Several 64-bit compile and runtime fixes

- **KLS** (gaeorn) NPC wander back rules.

- **Trevius** #texture will now allow player races to retain armor tint for both PCs and NPCs.

- **realityincarnate** bug fix for changing max_hp with the modifynpcstat command

Required SQL: /utils/sql/svn/704_rules.sql

## 06/22/2009¶

- **Trevius** (Rabayn) When creating recipes, it is no longer required that componentcount be on separate rows from the successcount or failcount row.

- **Trevius** (takatok) AA Shield Block added.

- **Trevius** (Shendare) Armor Tint on NPCs can now be set on a per-slot basis.

- **cavedude** Added rules to disable/change #peqzone debuffs. Cleaned up code regarding it some.

- **Derision** Fixed the BestZ stuff I broke in Rev686

- **WildcardX** More work migrating EQBOTS code into BOTS.

Required SQL: /utils/sql/svn/702_aashieldblock_tint_table.sql /utils/sql/svn/703_peqzone_rule.sql

## 06/20/2009¶

- **WildcardX** Migrated more code for BOTS from database.cpp to bot.cpp.

- **AndMetal** Added rule 'Zone:PEQZoneReuseTime' to adjust the reuse time on the #peqzone command. Defaults to 300 per change in Rev 612.

- **AndMetal** Correction to the item link code used in quests.

- **AndMetal** Cleaned up zone/StringIDs.h to make it easier to read, plus added some additional String IDs.

- **AndMetal** Cleaned up fishing some.

- **AndMetal** Fishing failures should now happen immediately instead of waiting for the timer to run.

Optional SQL: /utils/sql/svn/699_peqzone_rule.sql

## 06/19/2009¶

- **KLS** NPCs will no longer warp to their very first waypoint if they start on a grid, make sure they're spawned near their first waypoint!

- **KLS** Added quest::SetRunning(value) (1 for run, 0 for walk) to let a NPC run when out of combat instead of walk.

- **KLS** Added quest::IsRunning() return 0 for walk, 1 for run to let quest know if the npc is walking or running.

cavedude (nilbog): Added many missing pet names.

- **realityincarnate** Restricted monster summoning to things more traditionally considered monsters (no boats, among others)

## 06/18/2009¶

- **Derision** Fixed some flawed database queries and a few compile warnings.

- **Derision** Added command #reloadtitles to reload titles from the database.

- **Derision** Added second optional argument to #title and #titlesuffix to save the title to the database if 1.

- **Derision** Added second optional argument to $client->SetAATitle/SetTitleSuffix to save the title to the database.

- **realityincarnate** Monster Summoning pets should work properly now.

## 06/17/2009¶

- **Derision** Removed redundant flymode on/off in water code (not needed since Rev161).

- **Trevius** New fields added to the alt_vars table to allow SoF and Titanium to both use it.

- **KLS** Aggro tweaks + melee spell procs wont proc off ranged attacks anymore.

Required SQL: /utils/sql/svn/687_aa_table_changes.sql

## 06/16/2009¶

- **Derision** Old corpses summoned by Expedient Recovery will no longer rebury after 5 seconds.

- **Derision** Added optional duration parameter to quest::popup.

- **Trevius** SoF * Adventure Merchant Selling is now functional.

- **Trevius** SoF * Items with click effects now show the min level required to click them.

- **Trevius** SoF * Items being sold now show the correct price that the merchant will pay for them.

- **cavedude** Changed the items-0.6.0-DR2-0.6.1-DR1-convert.sql error message to stop confusing people.

- **cavedude** Green con KOS NPCs will now aggro clients while sitting.

- **Derision** Spells Gems now stay greyed out after zoning until their recast time is met.

- **KLS** More aggro tweaks.

- **KLS** Fix for zone crash from world server.

- **WildcardX** Migrated more code for BOTS from database.cpp to bot.cpp.

## 06/15/2009¶

- **Trevius** SoF * The following fields now show up on items that have values set for them, but the stats are not actually used by the server yet:

```
` svcorruption, purity, backstabdmg, dsmitigation, heroic_str, heroic_int, heroic_wis, heroic_agi, heroic_dex, heroic_sta
 heroic_cha, heroic_mr, heroic_fr, heroic_cr, heroic_dr, heroic_pr, heroic_svcorrup, healamt, and spelldmg
`
```

- **Trevius** SoF * Corrected Max Stat calculation for SoF clients over level 75.

- **Trevius** Fix for compile error; should have been fixed already *hint*.

- **Trevius** More tweaks to make illusions work better with features and armor/helm graphics

- **Trevius** Added alias #rf for the #randomfeatures command. Note that the feature changes are not permanent.

- **Trevius** Changed the default way of loading spells to now load from the spells_new table instead of from the spells_us.txt file.

- **Derision** Implemented the Title Window.

- **KLS** Aggro tweaks.

- **KLS** Fixes to compile errors/warnings.

Required SQL: \utils\sql\svn\665_heroic_resists.sql Required SQL: utils/sql/svn/667_titles.sql

Recommended SQL: (This is recommended for databases that don't stay current with PEQ or are custom) UPDATE items SET backstabdmg = damage WHERE backstabdmg = 0 AND itemtype = 2;

- **Warning** If you do not have a spells_new table yet, you must create one and load spells into it or zones will crash when loading in. To create the spells_new table, use the SQL from \utils\sql\svn\230_spells_table.sql After creating the table, you can import or export your spells from the spells_us.txt file by using the scripts: import_spells.pl export_spells.pl

The easiest way to import your spell file to the table is to move the import_spells.pl file to your main server directory where your spells_us.txt file and your eqemu_config.xml file are. Then run the following command at a command prompt: perl import_spells.pl

See this post for more information on importing/exporting the spell file: http://www.eqemulator.net/forums/showpost.php?p=160509&postcount=45

## 06/14/2009¶

- **Trevius** Added new command #randomfeatures which will randomize all possible features for playable races.

- **Derision** Code support for Steadfast Servant Veteran AA.

- **Derision** Added entity_list::GetRandomClient accessible from Perl.

- **Dersiion** Fixed infinite loop in EntityList::RadialSetLogging.

- **Derision** AATimers are now sent at level 1 rather than level >= 51.

- **KLS** Fix for name_filter checking.

- **KLS** Name filters will now apply to surnames and will consider any name with 3 repeating characters or more invalid.

- **KLS** Fix for compile error; should have been fixed already *hint*.

## 06/13/2009¶

- **Derision** Implemented SE_PercentXPIncrease and Resist caps.

- **Trevius** Removing an Illusion should now restore all features to their original settings in most cases.

- **Trevius** SoF * Adjusted Power Source code some to remove a bug with using the slot.

- **Derision** Implemented SE_SummonAndResAllCorpses

- **KLS** Rebalanced some spell effects aggro values.

- **KLS** Hate added should now be treated correctly.

- **KLS** Archery should now cause aggro.

- **KLS** Added rule Aggro:PetAggroAmount to control how much hate a pet causes, 50% default.

- **KLS** Bash will now cause extra hate depending on the AC of the shield you're using if any.

- **KLS** Implemented resist reduction and hate reduction spell focus.

- **KLS** quest::updatespawntimer will now set the respawn timer in the database.

- **KLS** Stole Trevius' idea to let augments work as focus items.

## 06/12/2009¶

- **Trevius** The #nukeitem command and related quest commands is now able to remove items on the cursor and within bag slots of the cursor.

- **Trevius** SoF * The Power Source Slot is now a usable slot. Items set to use slot 22 in the items table will be able to use this new slot.

- **KLS** On successful completion of an adventure players should be removed from the adventure immediately instead of after 30 minutes.

## 06/11/2009¶

- **AndMetal** Rule values can be viewed and modified through the web interface. They're updated into the database only, so they won't go into effect until you restart the server.

## 06/10/2009¶

- **realityincarnate** Added /makeleader command functionality

- **realityincarnate** Non-leaders can no longer kick members from the group

- **KLS** Added $zoneweather perl export

## 06/09/2009¶

- **Trevius** Added rule Combat:ArcheryStationaryPenalty to allow adjustment of the Archery damage penalty for moving or rooted targets.

- **KLS** Backstab tweak again.

- **KLS** Added Perl **commands* GetItemAt(slot), GetAugmentAt(slot, aug_slot) both returning type ItemInst usable from the Client object.

- **KLS** Added Perl command: IsType() for use on the ItemInst object.

Optional SQL: \utils\sql\svn\646_archery_penalty_rule.sql

## 06/08/2009¶

KLS(realityincarnate): Charms: Added charm item scaling with scriping support and initial work on evolving items. KLS(realityincarnate): Added perl method $client->GetModCharacterFactionLevel(FactionID) KLS(realityincarnate): Added perl method $group->GetMember(index)

- **KLS** Added perl method $client->GetLDoNWins()

- **KLS** Added perl method $client->GetLDoNLosses()

- **KLS** Added perl method $client->GetLDoNWinsTheme(theme 1-5)

- **KLS** Added perl method $client->GetLDoNLossesTheme(theme 1-5)

- **KLS** Added support for item clicklevel and item clicklevel2

- **Trevius** Increased spellbook from 400 to 480 in the Player Profile for use with SoF (60 page spell book)

- **Trevius** SoF * Added new functions to SoF.cpp for converting Slot IDs between Titanium and SoF

- **Trevius** SoF * Corrected the location of the spellbook field in the Player Profile to fix an issue with loading spells

- **WildcardX** Check in of the start of what will become the new BOTS subsystem/framework. This is far from done so just continue to use the existing EQBOTS code you have been using.

- **KLS** Change to dangerous item inst aug creation, hopefully addresses segfault on 64 bit linux.

- **KLS** Hopefully fix for pets not giving adventure credit to players in ldon instances.

## 06/07/2009¶

NOTE (WildcardX): This version of the server code is a little dangerous for BOT enabled servers. I do not recommend using this revision for BOT enabled servers. Most of the existing BOT code is going to be re-implemented as a "BOT" object in the server code so until I complete this architecture change the BOT code may become somewhat unstable. I apologize for the inconvience but this is necessary to allow the server code for the BOTs to be more flexible and extensible than it is now.

- **Derision** Check for duplicate lore items when fishing.

- **Derision** Fixed a memory leak in fishing/foraging code.

- **WildcardX** Traded static integer values for the appropriate enumeration that defines group action types.

- **WildcardX** A Player grouping with one or more BOTS will now correctly be set as the group leader.

- **WildcardX** You can now target your BOT to disband it from the group just as you would a player. This does not call the logic that #bot group remove does, though. Keep using the BOT command for now.

- **WildcardX** A group of one Player and a BOT can now request a LDoN Adventure, but doing so will crash the zone.

- **KLS** Change to BS formula: moved backstab bonus to damage table. Still might be off but I have another change in mind if so.

- **KLS** Fix for bug in client calcbonuses.

## 06/06/2009¶

- **Trevius** SoF * Corrected Char select Primary/Secondary slot display order.

- **Trevius** SoF * Added gender to the conversion for bodytypes 66 and 67, which should resolve any remaining issues with it.

- **Derision** New Universal Chat Server combining both mail and chat server functionality.

```
` Required to support mail, chat and friends/ignore for SoF clients.
 See http://www.eqemulator.net/wiki/wikka.php?wakka=UCS
`
```

- **WildcardX** Corrected the project file for eqlaunch. This should allow eqlaunch to execute correctly for Windows XP and Windows 2003 Server.

- **WildcardX** Corrected database table definition that created a bug which prevented a BOT from being created.

REQUIRED SQL:

CREATE TABLE `friends` ( `charid` int(10) unsigned NOT NULL, `type` tinyint(1) unsigned NOT NULL default '1' COMMENT '1 = Friend, 0 = Ignore', `name` varchar(64) NOT NULL, PRIMARY KEY (`charid`,`type`,`name`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8;

634_TrapTemplateDefaultValue.sql

## 06/05/2009¶

- **Derision** SoF * Adventure OPCode updates

## 06/04/2009¶

- **Trevius** SoF * Added conversion for bodytypes 66 and 67 so they are now untargetable, invisible and have no showing name as they should be.

- **Congdar** Bots * Implemented raid maintarget, updates to magepet and pvp. Added Sinister Strikes & Strikethrough AAs and several other updates.

- **KLS** Pets will no longer gain aggro from their owners before their owners load in. Fixes both a dupe and crash issue.

- **KLS** Players will no longer take damage or die before they finish loading into the game.

- **KLS** Fixed a crash in /open.

## 06/03/2009¶

- **KLS** Used Cbodmer old ldon trap code as a base for ldon trap implementation. About 50% of the code for this system was his so I figured he deserves credit too.

- **Derision** Added messages when Leadership Exp is toggled on/off.

- **Derision** Fixed bug where group retained Leadership AA benefits of previous leader.

Required sql: 621_LDoNTraps.sql Updated titanium .conf file for ldon opcodes. Will look at other clients later.

## 06/02/2009¶

- **Trevius** Updated the new Adventure Opcodes for SoF

## 06/02/2009¶

- **KLS** Forgot to update .conf files with the merge. Please update yours if haven't.

- **KLS** Added settable flavor text to adventure recruiter entries.

Required sql: 619_Adventure_Recruiter_Flavor.sql

## 06/01/2009¶

- **KLS** (takatok) Fix for agil being factored twice in to-hit calc.

- **KLS** (tsowl) Reimplemented corpse reloading timer fix. Should work with burried corpses now. (Sorry it took so long to get back to).

- **KLS** Finished implementing Assassinate and Rescue adventure type

- **KLS** AC in calc will now not cap at 0. What this means: A level 65 hitting a level 1 will now hit for a majority of attacks at or near maximum damage, it should affect any other situations.

- **KLS** Spells shouldn't cause interrupts any longer.

- **KLS** LDoN theme "ALL" items should show up properly now.

- **KLS** Added sanity check on adventure merchant for both lore items and trying to purchase items of one theme that has a min point requirement while not meeting that requirement.

- **KLS** Rule Adventure:ItemIDToEnablePorts will now actually cause the door to ignore this rule if it is set to 0.

- **KLS** Changed the evacuate work around to use zone 1 and zone 2 instead of plane zones that probably have requirements set on them.

## 05/31/2009¶

- **realityincarnate** Added EVENT_CAST to player quests

- **realityincarnate** AA $quest functions: $client->GetAAPoints(), SetAAPoints(value), AddAAPoints(number), RefundAA(), GetSpentAA()

- **KLS** Procs will now only occur on a player's targeted mob.

- **realityincarnate** fixed a calculation error with spent AA's

- **KLS** Merged instance branch to trunk.

## 05/30/2009¶

- **KLS** Redid procs a bit, spell procs should work more consistently and ppm formula should be less broken and will also take into account haste now.

Highly suggested you change your Combat:AvgProcsPerMinute rule to 2.0 if you want it to be live like.

- **Derision** Group Leadership AA

REQUIRED SQL:

ALTER TABLE `group_leaders` ADD `assist` VARCHAR( 64 ) NOT NULL , ADD `marknpc` VARCHAR( 64 ) NOT NULL , ADD `leadershipaa` TINYBLOB NOT NULL ;

OPTIONAL SQL:

INSERT INTO `rule_values` VALUES (1,'Character:KillsPerRaidLeadershipAA','50',''); INSERT INTO `rule_values` VALUES (1,'Character:KillsPerGroupLeadershipAA','50','');

## 05/29/2009¶

- **Derision** Lay Hands/Harm Touch hot buttons now remain depressed across zoning until reuse timer is up.

## 05/28/2009¶

- **Congdar** Bots * updates to bot pvp, raidexp and magepet

## 05/27/2009¶

- **Trevius** SoF * Added new opcode and structure to support the Respawn Window. It isn't fully functional yet, but most of the code is there now.

- **Congdar** Bots * Fixed botraid experience distribution.

## 05/26/2009¶

- **WildcardX** Fixed a bug that displayed the name of a target being summoned in an incorrect format.

- **Angelox** Bots* Weapons that proc'd rune-types were proc'ing for the whole group. 3 fighters with PGTs made you pretty much bullet-proof.

## 05/25/2009¶

- **cavedude** (gaeorn) Added a possible fix for some NPCs not always spawning.

- **Congdar** Bots * Added PvP for bots.

- **WildcardX** (erde) Added include for limits.h.

## 05/24/2009¶

- **KLS** Fixed dodge/parry/riposte, lowered their effectiveness from skill points slightly.

- **Congdar** Bots *Added new command #bot magepet [earth|water|air|fire|monster]* Select the pet type you want your Mage bot to use.

## 05/23/2009¶

- **KLS** Spells with 0 spell mod will now act as if their mod was 100% or normal instead of 0% of normal.

- **KLS** (Derision) Implemented discipline reuse timer's client side effects

- **Congdar** New feature to choose if a key should go on the keyring or not.

required sql 564_nokeyring.sql

## 05/21/2009¶

- **Trevius** Added new quest command quest::saylink() to create itemlinks in quest text that can be clicked for a response

Recommended SQL: .\utils\sql\svn\553_saylink_table.sql

## 05/20/2009¶

- **Angelox** Bots* Bots can't stack invis-undead, invis-live, or any other invis type spell.

- **KLS** Fix for NPCs jumping in place when they have the fixpathingZ rules for movement enabled.

- **KLS** Traps will no longer attempt to clean up their npcs, every time a trap is destroyed so are the NPCs so it's redundant and risky.

- **Congdar** Bots * Added Magician AA Elemental Durability, Fixed #bot corpse summon, AI Tweak

## 05/19/2009¶

- **Trevius** Identified hairstyle, haircolor, beard, and beardcolor in the Titanium Illusion struct so the related commands now work in Titanium.

- **KLS** PvP info will only be set if the server type is set to 1 (pvp)

- **KLS** Adjusted chances on dodge/parry/riposte modifiers

- **KLS** Made experience con scaling into a rule.

- **KLS** Added Rules: (Character, UseXPConScaling), (Character, LightBlueModifier), (Character, BlueModifier), (Character, WhiteModifier), (Character, YellowModifier), (Character, RedModifier)

- **Derision** Bandolier bug fix.

- **Derision** Equipped items that should confer an extra potion belt slot now do so in Titanium and the 6.2 client (was already working in SoF).

- **Angelox** Bots* (Congdar) fixed Bot illusion / change form spells as to who is affected.

- **Angelox** Bots* added check to Bot pacify for casting from a distance.

## 05/18/2009¶

- **Trevius** New Commands added: #face, #helm, #hair, #haircolor, #beard, #beardcolor, #heritage, #tattoo, #details

- **Trevius** Adjusted the #fixmob command to use all features. The new format is "#fixmob featurename prev/next"

- **Trevius** Corrected the R524 optional SQL file

## 05/16/2009¶

- **Trevius** (Shendare) Added armor tinting functionality for NPCs by setting it in the npc_types table

- **Trevius** Added base support for illusions to use all facial features, but functionality still needs to be added.

- **Derision** Reverted (Minimum 3% chance to proc from weapon proc buffs)

- **KLS** Reduced chance to hit for min damage with AC.

- **KLS** Added AC scaling by level, will put it in a rule soon.

- **KLS** Enabled both petition window 'p' and pvp window 'ctrl p' on titanium/sof; neither are functional but they're enabled now and we can work on that later.

- **Congdar** Bots * fix compile error and update to current combat code

- **Congdar** Bots * fix pet exploit

- **KLS** Added backward compatibility to older corpses.

Required SQL: .\utils\sql\svn\527_npc_armor_tint.sql

## 05/15/2009¶

- **Trevius** (Trevius/Shendare) Swapped Beardcolor and Beard in the spawn struct for Titanium and Titanium Facial Features should be finalized now.

- **Trevius** SoF * Drakkin Specific Features (Heritage, Tattoo and Details) should now be fully functional for NPCs and PCs

- **Derision** Minimum 3% chance to proc from weapon proc buffs (e.g. vampiric embrace, call of sky etc.)

- **Trevius** Added encode for Illusion packets in Titanium so they see Drakkin as human after clicking off an illusion

- **Trevius** Optional SQL for adding a notes field to the rule_values table with notes from ruletypes.h

Required SQL: .\utils\sql\svn\518_drakkin_npc_type_features.sql Optional SQL: .\utils\sql\svn\524_rule_values_notes.sql

## 05/14/2009¶

- **Trevius** More work on Facial Features for Characters. Trying to get them functioning properly without hacks before adding SoF Features.

- **Trevius** SoF * Character Facial Features other than Drakkin specific ones all now work 100% in Character Select and in game.

## 05/13/2009¶

- **Trevius** SoF * (Shendare) Corrected the FaceChange Structure and added an encode to make it work

- **Trevius** SoF * Identified the Drakkin related fields of the Character Select Structure

- **KLS** Fix for elemental dmg not calculating correctly.

## 05/12/2009¶

- **Trevius** SoF * (Shendare) Added a temp commented out test section of code to spawn struct encode

- **Trevius** SoF * (Shendare) Identified hairstyle, haircolor, flymode, drakkinheritage and drakkintattoo in the spawn struct

- **Trevius** SoF * (Shendare) Changed facial feature code for getting features slightly

- **Trevius** SoF * Identified beardcolor, invis, and drakkinspikes in the spawn struct

- **Trevius** SoF * Updated the OP_CastSpell to convert bag slot from Titanium to SoF for potion use

- **KLS** Reverted player corpse changes from 5/10 as they caused shadow rest to stop functioning.

- **KLS** Fixed the /bug structure and updated the table to be more useful.

Required SQL: .\utils\sql\svn\503_bugs.sql

## 05/11/2009¶

- **mackal** Added a function to allow Perl to check augments within items.

- **cavedude** Increased bind wound skill up speed some.

- **KLS** Fix for potentially dangerous typo in spawn conditions code.

- **KLS** Removed some non-functioning but still taking up database resources database code.

- **KLS** Change to a spawn2 table query to reduce disk writes.

Suggested SQL: ALTER TABLE `spawn2` DROP INDEX `ZoneGroup`, ADD INDEX `ZoneGroup` (`zone`);

## 05/10/2009¶

- **KLS** Fix for a add/remove raid looter across zones error.

- **KLS** Changed order of split raid exp, ensures amount given to a player is always at least 1.

- **KLS** (tsowl) Various Fixes

## 05/09/2009¶

- **realityincarnate** Modified quest::say to allow npcs to speak in other languages, added $langid quest variable

- **realityincarnate** Made low language skill/drunkenness a bit less understandable

- **realityincarnate** Duplicate lore items from foraging/ground spawns are now handled correctly

- **realityincarnate** Lore items in the shared bank no longer trigger conflicts with items in individual inventories

- **KLS** Fix for Group:: and Raid:: splitexp bonus calculations happening once for every person in the group / raid, resulting in very high numbers for group and non-positive numbers for raid.

- **Trevius** SoF * Corrected a minor issues with new mounts where they weren't setting helm texture properly.

## 05/08/2009¶

- **Derision** Fixed a bug where a pet set to guard would appear not to stop on returning to it's guard spot after being ordered to attack.

- **Derision** Fixed a bug where a mob aggroed would sometimes appear to run past it's target.

## 05/07/2009¶

- **Trevius** (Erde) The Web Tool now shows the name of the process running each Dynamic zone (example: dynamic_01)

## 05/06/2009¶

- **Angelox** Bots: Added command '#bot shrinkme' requires Shaman or Beastlord (defaults to Shaman).

- **Derision** Added redux_aa2, redux_rate2 fields to aa_actions.

- **Derision** Improved Hasty Exit should now reduce the reuse time of Escape.

- **Derision** The reuse timer in the AA window now shows the reuse time reduced by applicable AAs.

```
`(although if you purchase an AA that reduces the reuse time, you must camp before the reduced reuse time will be updated).
`
```

REQUIRED SQL:

ALTER TABLE `aa_actions` ADD `redux_aa2` MEDIUMINT( 8 ) UNSIGNED NOT NULL DEFAULT '0', ADD `redux_rate2` TINYINT( 4 ) NOT NULL DEFAULT '0'; UPDATE `aa_actions` SET `redux_aa2` = '886', `redux_rate2` = '10' WHERE `aa_actions`.`aaid` =243 AND `aa_actions`.`rank` =0 LIMIT 1 ;

## 05/05/2009¶

- **Trevius** SoF * Melee stun/bash no longer causes you to spin

- **Trevius** SoF * Spell Fizzles and Interrupts no longer cause abnormally long refresh times

- **realityincarnate** Fixed lore check bug with items in lore group -1

- **KLS** DoTs should no longer break roots early.

- **KLS** Added Special Attack hit magical 'm' and special attack hit bane 'b', will allow the mobs affected to hit things that require magical or bane weapons to hit.

## 05/04/2009¶

- **KLS** Code block for pets getting sent into attack did not verify that other was not null, causing rare crashes the old way and a pretty common crash with it's new positioning. This has been corrected.

- **Derision** Updated spell_type in altadv_vars table to reflect the shared reuse timer ID that it really is.

- **Derision** AA reuse timers should now display correctly with hotkeys remaining depressed when appropriate.

- **KLS** Code block for pets getting sent into attack did not verify that other was not null, causing rare crashes the old way and a pretty common crash with it's new positioning. This has been corrected.

- **KLS** Added area rampage 'r' npc special attak code.

- **Congdar** Bots * Added Rogue Triple Backstab AA, Enhanced #bot list, Fixed beneficial weapon procs to not effect the entire group.

- **realityincarnate** Fix for SoF attunable items

- **realityincarnate** Added checks for multiple items in the same lore group

- **Congdar** Bots * Fix Cleric resurrect spell selection, Added zone profiles, Fixed crash with bot follow

REQUIRED SQL: utils/sql/svn/463_altadv_vars.sql

## 05/03/2009¶

- **KLS** Some optimizations for the aggro code. Added a timer for aggro checking will do it twice a second by default: lower AItarget_check_duration in features.h if aggro feels too sluggish for your tastes and recompile.

- **Derision** Increased reuse_time in AA_DBAction to a uint32 to support reuse timers greater than 18 hours.

- **Derision** Code support for Chaotic Jester Veteran AA.

- **Congdar** Bots * Improve Cleric healing ai, fix ae break, update attack code.

- **Congdar** Bots * Fix sql error for bot table

- **KLS** (Secrets) min/max damage updated to int32

- **KLS** Fixed a bug with accuracy tweaks and finished them up. The system should work fairly well now.

- **KLS** Removal of several rules associated with the dual accuracy system and the old system for defensive and offensive accuracy bonus.

- **KLS** Some warning fixes on MSVS.

- **KLS** Fixed pets not getting sent into battle on attack.

- **KLS** (theblaz) Pets who were previously guarding after a pet attack command will return to their guard spot; though it appears a stop moving packet is missing on the pet guard spot waypoint.

- **KLS** Rampage will no longer hit the main tank unless the main tank is the only target in range.

- **KLS** Swarm pets will once again disappear when their target dies.

- **KLS** Added zone zone profiling stuff.

## 05/02/2009¶

- **realityincarnate** Augment Item Info.

- **realityincarnate** Show helm option will now save on camping/zoning.

- **Derision** Corrected a few memory leaks.

- **Derision** 'Live'/Anniversary patches no longer registered.

- **Derision** Fix for random client crashes when combining items in world containers (e.g. augmenting items).

- **BWStripes** Fix for quest::echo.

- **erde** Added long zone name support to the web interface.

- **Cripp** Fix for the web interface for those using Perl 5.10.

- **Congdar** Bots * randomized face/hair etc. so they don't all look the same. Fixed Bard AE songs.

## 4/30/2009¶

- **Congdar** Bots * bots can now use bows, new command '#bot archery'. Added Ranger archery AA's. Reduced chat mana spam. Tweaked spell ai. Fixed memory leak. Updated '#bot corpse summon'.

- **Derision** SoF * AAs affecting stats now show the correct stats in the client.

- **Derision** Tweaked base resists to match the client.

- **gatorman** Fix for QuickSummoning AA (to include Call of the Hero)

- **Congdar** Bots * root/snare spell ai fix

## 4/29/2009¶

- **Trevius** SoF * Added rule for setting a startzone for SoF Clients separate from where Titanium Clients are set to start. Set as Zone ID number.

optional sql: utils\sql\svn\447_sof_startzone_rule.sql

## 4/27/2009¶

- **Derision** SoF: Reading books/notes/scrolls now works.

## 4/25/2009¶

- **Derision** SoF: Ranged attack animations.

- **Derision** When shooting a bow, there is no longer a superfluous 1HS animation.

## 4/23/2009¶

- **Trevius** (realityincarnate) Added new quest command quest::varlink(item_id) for putting item links into variables.

- **Derision** Fix for Tradeskill combines where a LORE ingredient is returned.

- **Derision** Fix for pet names containing spaces losing the space after zoning/camping.

- **Derision** Fixed bug where Return Home sent players bound in Grobb to Qeynos/Unknown Zone.

## 4/22/2009¶

- **Derision** When Tribute is manually deactivated, it should stay deactivated.

- **Derision** Tribute will not continually try and reactivate when you run out of tribute points.

## 4/20/2009¶

- **Derision** Added EVENT_PROXIMITY_SAY

## 4/19/2009¶

- **Wolftousen** Player Flurry rate was slightly increased

- **Wolftousen** Player Flurry messages will now show up as red text, but use the same filter as NPC flurry messages

- **Wolftousen** Rage Volley no longer requires you to have an thrown weapon in your ranged slot

- **Wolftousen** Rage Volley now uses the proper damage calculation and is not based on the item you have in the ranged slot

- **Wolftousen** Rave Volley can no longer be dodged/blocked/parried/reposted.

- **Wolftousen** Procs from Buffs have been tweaked to go off more often **Wolftousen* Players will now receive the "proper" bonus HP for stamina above 255.

- **Wolftousen** Knight class Tactical Mastery AA was implemented and should now give the strike through message

- **renoofturks** Created rule Aggro:StunAggroMod to dial in on aggro of stun based attacks.

- **cavedude** Reverse DS and some DS will now cause aggro on intial cast.

- **realityincarnate** Controllable boats should now work. Please see: http://eqemulator.net/forums/showthread.php?p=167892#post167892 for additonal information.

- **realityincarnate** Safe fall skill up is now checked on failure.

Optional SQL:

INSERT INTO rule_values VALUES(1,'Aggro:StunAggroMod',750);

## 4/18/2009¶

- **Derision** Changed Account Session Limiting to kick off the old connection and allow the new one.

- **drakelord** Rest State HP and MP Bonus

- **Derision** SoF * Combat/Rest state indicator now works.

- **Derision** No longer need to zone for /corpse to work.

- **Derision** Fixed Bazaar bug.

Optional SQL:

INSERT INTO rule_values VALUES(1,'Character:RestRegenPercent',0); INSERT INTO rule_values VALUES(1,'Character:RestRegenTimeToActivate',30);

## 4/13/2009¶

- **Congdar** Bots * Fix release vs. debug compile for focus effects, updated bots to new attack code.

## 4/13/2009¶

- **Trevius** SoF * Corrected corpse looting slots so that the correct item is looted when there are multiple on a corpse

- **Trevius** SoF * Item Links from corpse looting messages now display properly for both client versions

- **Derision** Personal Tribute should now have an effect serverside, rather than just showing increased stats in the client.

- **Derision** Deactivating Tribute should no longer crash the client.

- **Derision** SoF * Personal Tribute should now work.

## 4/12/2009¶

- **Trevius** SoF * Commands that return itemlinks will now show the full name instead of cutting off the first 5 characters

Trevius/ ***Derision** SoF* Fix for subitem serialization.

- **Derision** SoF * Corrected money update opcodes.

- **Derision** SoF * Bazaar Trader mode.

## 4/11/2009¶

- **Trevius** SoF * Stopped the bogus "Deleting Item" messages from being sent to SoF Clients

- **cavedude** (Congdar): You can now safely delete a key item after its been added to your keyring.

- **cavedude** (realityincarnate): Added quest::MerchantSetItem and quest::MerchantCountItem to add temp items to a merchantlist. See Wiki for usage.

- **cavedude** Added rule World:MinGMAntiHackStatus to manage the min status checked against the GM AntiHack list.

- **Derision** Sof: Added support for regular /who

## 4/10/2009¶

- **Derision** Tradeskill recipes involving weapons as an ingredient should no longer dupe the weapon.

- **Derision** Expendable items with charges are now deleted when the last charge is used.

- **Derision** Tradeskill skillups now based on unmodified skill level.

- **Derision** (realityincarnate): Prevent bard skillups for instruments they aren't trained in.

- **Derision** (realityincarnate): Implemented SE_Hunger (e.g. for Song of Sustenance).

- **Derision** (realityincarnate): Undying armor by setting RGB to 255 255 255 fixed.

- **Derision** (realityincarnate): Title suffix quest command, Syntax: $client->SetTitleSuffix(title)

- **Derision** (erde): cleanipc fix for GCC 4.3.2

- **Derision** (BWstripes): Beastlord pets are now named SoAndSo's Warder.

## 4/09/2009¶

- **Derision** Fix for Alchemy, Poison Making and Tinkering.

## 4/08/2009¶

- **Derision** Added $client->GetClientVersion(). Returns: 1 (6.2 Client), 2 (Titanium), 3 (SoF)

## 4/07/2009¶

- **Derision** Fixed crash in chatserver.

- **Derision** Fixed possible crash in QuestManager::attacknpc

## 4/06/2009¶

- **Derision** (Image): Check packet length is at least 4 bytes in EQStream::ProcessPacket

- **Derision** (Image): EQStreamFactory::ReaderLoop * Assure that the incoming buffer contains an opcode to analyze.

- **Derision** (Image): Sanity checks on OP_SessionResponse/OP_SessionStatRequest size in EQStream::ProcessPacket

## 4/05/2009¶

- **Derision** GM Training: SoF * Points now update correctly in the Training Window.

- **Derision** GM Training: Points now update correctly in the Training Window for languages.

- **Derision** GM Training: The correct amount of money is deducted from the player profile.

- **Derision** SoF * Mapped findable field in Spawn struct and OP_FindPersonRequest/Reply.

- **Derision** SoF * Duelling now works.

- **KLS** Compile option to ignore login fatal errors in world.

## 4/04/2009¶

- **Derision** Tracking: Now works in SoF and as a side effect, Tracking 'sort by distance' works properly in 6.2 and Titanium clients.

## 4/03/2009¶

- **Congdar** Bots * Added Healing and Lifetap AA's and Focus Effect support

- **Derision** SoF * Fix for incorrect animation (NPCs frozen/walking while standing still).

## 3/29/2009¶

- **Derision** SoF * OP_PetBuffWindow, OP_Charm, OP_Stun

## 3/28/2009¶

- **Derision** SoF * Tasks now work.

- **Derision** SoF * OP_Sacrifice, OP_Sound, OP_OnLevelMessage, OP_PopupResponse

- **Derision** Item Links in Task Descriptions are now formatted correctly based on the client version.

## 3/25/2009¶

- **Derision** 'Hack' to display Froglok/Drakkin corpses correctly.

- **Derision** SoF * OP_Translocate & OP_LevelAppearance

## 3/23/2009¶

- **Trevius** SoF * Corrected Right Click item effects so they no longer fizzle

- **Trevius** SoF * Right Clickable item effects with set recast delays now observe that delay properly

- **Trevius** SoF * Item Effect Charges now get used and updated properly

- **Trevius** SoF * Food and Drink are now consumed at the proper rates

## 3/21/2009¶

- **Derision** Implemented 'Your total time entitled on this account' in /played.

## 3/20/2009¶

- **Trevius** SoF * Fixed a fairly major crashed caused when attempting to use the 8 new bank slots, or shared bank

- **Trevius** SoF * Banking is now fully functional including the 8 new bank slots, shared bank and bag slots in the bank

- **Trevius** SoF * Bandolier and Potion Belt are now both functional

- **Trevius** SoF * Filled in multiple missing opcodes

## 3/19/2009¶

- **Trevius** SoF * Grouping should now be fully functional

- **Trevius** SoF * (Xinu) Added many missing opcodes

- **Angelox** Bots* More mobs for the "#bot track rare" filter.

- **Derision** Fixed memory leak in Chatserver /announce processing.

## 3/15/2009¶

- **Trevius** SoF * Tradeskill Objects/Containers and Augment Pools should now be fully functional

- **Trevius** SoF * PC to PC/NPC trading should now be fully functional without bugs

- **Trevius** SoF * Auto-Consume and Right Click consume of food/drink is functional

- **Trevius** SoF * Right Click Effects on Items now works in most cases, but needs coding to clean it up a bit

- **Trevius** SoF * Spell Interrupts are now functioning properly

## 3/15/2009¶

- **cavedude** (realityincarnate) Languages can now be taught to other players. Also implemented drunk speak.

- **cavedude** (realityincarnate) Bonuses will now properly apply when switching items with bandolier.

- **cavedude** (realityincarnate) Corrected some instances of Bard songs that were incorrectly requiring an instrument.

- **cavedude** (Wolftousen) Fixes for Rage Volley, Blur of Axes, and Dead Aim.

- **Derision** Spells that damage the caster will now do full damage.

- **Congdar** Spells that summon items with charges will now summon said item fully charged.

- **Angelox** Bots:Added a few more mobs to the "#bot track rare" filter.

- **Congdar** Bots * Added commands #bot saveraid, #bot spawnraid, #bot groupraid

required sql: utils\sql\svn\386_bot_save_raid.sql

## 3/14/2009¶

- **Trevius** SoF * Tradeskill/Augment Combines in tradeskill containers/objects now works, but currently bugs players when they close the window.

- **Derision** Fixed bug when activating a bandolier set without a required item in your inventory.

- **Trevius** SoF * Identified more fields in the Spawn Struct; Face, LFG, Beard, ShowHelm and more

## 3/13/2009¶

- **Trevius** SoF * Added a few more encodes/decodes to resolve more slot change issues related to the addition of the Power Source Slot

- **Trevius** SoF * Ammo now depletes properly when used. Probably some other minor issues resolved by this change as well.

## 3/12/2009¶

- **Trevius** SoF * AAs can now be trained and will update without needing to zone. Point Spent is still wrong.

- **Trevius** SoF * Char Select now shows Primary and Secondary items properly.

## 3/10/2009¶

- **Trevius** SoF * PC to PC/NPC Trading now works, though canceling a trade will bug the character and require them to zone or relog

- **Trevius** SoF * Players can now sell to merchants

- **Trevius** SoF * Corrected a bug introduced in Revision 376 that was causing single stackable items to not be stackable

## 3/09/2009¶

- **Trevius** SoF * Buffs and debuffs now last for the correct duration.

## 3/08/2009¶

- **Trevius** SoF * Corrected Item Struct to fix the issue with non-stackable items showing up as being stackable

- **Trevius** SoF * Identified an unknown field in Item Serialization as being item charges and set it accordingly so that items should now show accurate current charges.

- **Trevius/Xinu** SoF *Adjusted a few opcodes for more accuracy* No visible change yet

## 3/07/2009¶

- **Trevius** SoF * AAs now show up in the AA window, but do not give bonuses yet.

- **Trevius** SoF * Spent AA points are partially showing up, but still need work.

- **Trevius** SoF * Updated some grouping structs, but grouping still isn't working just yet

- **Trevius** SoF * Buffs can now be clicked off, but the duration still isn't working for them

- **cavedude** Added new AA, group, and raid EXP multiplier rules. Removed the associated variables.

- **cavedude** Removed the USE_RACE_CLASS_XP_MODS define as it was outdated and horribly broken.

- **cavedude** Added group XP bonus. The larger the group, the higher the XP gain.

- **cavedude** Added XP bonus for Warrior, Rogue, and Halfling.

- **cavedude** Corrected ZEM for AAs.

- **cavedude** (Thanks to mackal) Pet Affinity will no longer effect charmed pets.

- **cavedude** (realityincarnate) Bard songs that require instruments will now require them.

Please note: XP gain has pretty much been overhauled. You may need tweak the multiplier rules for your server.

Optional SQL:

REPLACE INTO `rule_values` VALUES ('1', 'Character:ExpMultiplier', '0.5'); INSERT INTO `rule_values` VALUES ('1', 'Character:AAExpMultiplier', '0.5'); INSERT INTO `rule_values` VALUES ('1', 'Character:GroupExpMultiplier', '0.5'); INSERT INTO `rule_values` VALUES ('1', 'Character:RaidExpMultiplier', '0.2');

## 3/03/2009¶

- **Angelox** Fixed most (if not all) npc pet ghosting at zone safepoints.

## 3/02/2009¶

- **cavedude** (realityincarnate) Implemented Bard song Magical Monologue

- **cavedude** (Theeper) Attuneable items will now save over zoning/camping and will no longer auto-loot from corpses.

- **cavedude** Implemented quest::buryplayercorpse, similar syntax as quest::getplayerburriedcorpsecount. This will bury and depop the oldest of a specified player's unburried coprses. It will bury all corpses, but it only depops corpses in the same zone, or in zones that aren't currently open. Hopefully, somebody else out there can finish this one up so corpse summoners can be implemented.

## 2/28/2009¶

- **WildcardX** Begun work on LDoN expansion. Adventure Recruiter window is now operational.

## 2/27/2009¶

- **Trevius** SoF * Corrected the NewZone struct a bit, which fixed Fall Damage and Environment Damage

- **WildcardX** Implemented the rogue skill, Apply Poison. Includes support for the 6.0 client, Titanium and SoF.

## 2/26/2009¶

- **Trevius** Added #define options in /zone/attack.cpp to allow an easy switch to use the old hit change code until the new code is finalized.

- **Trevius** Added new rule MinRangedAttackDist for setting the Minimum Ranged Attack Distance

- **Trevius** SoF * Updated the SoF opcodes, one of which corrects a false Hacker message and log entry

Optional SQL: 364_ranged_dist_rule.sql

## 2/25/2009¶

- **KLS** Fix for backwards rule in anti-spam.

## 2/24/2009¶

- **KLS** Added initial anti-spam features to global chat operations at popular request.

- **KLS** Added option to turn off IP verification in chat and mail servers (for people who use internal networks and find it troublesome).

- **cavedude** Added peqzone column to zone to allow or deny access to zones using #peqzone.

- **cavedude** #peqzone will give you the approximate time remaining before reusing.

- **cavedude** Altered merchant price structure to better match Live. Created rules to govern its behaviour. See ruletypes.h for basic explanations!

- **cavedude** Added command #givemoney.

- **Trevius** SoF * Corrected WearChange Struct so primary and secondary items now show properly after zoning and #wc works as well.

Required SQL: ALTER TABLE `account` ADD `karma` INT(5) UNSIGNED DEFAULT '0' NOT NULL AFTER `revoked`; ALTER table zone ADD column `peqzone` tinyint(4) NOT NULL default '1';

Optional SQL: 360_peqzone.sql

## 2/23/2009¶

- **Trevius** (Xinu) SoF * Many more Opcodes filled in from the client

- **Trevius** SoF * Doors are now able to open and clickable portals now function as well

- **Trevius** SoF * Armor tint from dyes is now showing properly

- **Congdar** Bots: '#bot group remove' now removes any of your spawned bots, if it's a group leader then that whole group

- **KLS** Changes to combat: -AC has a slightly higher chance to mitigate into a miss than before -AC is no more effective per point but the bonus ac every character and npc gets in the calculation has been effectively increased. -The accuracy falloff from level is now more variable based on defender's level, this should address the issue where at higher levels you can grind npcs that are still blue or light blue at little risk. -The base chance to hit has been increased. -Added both hit and avoidance mods for class types that are adjustable by rules. -Archery now has an accuracy penalty that is rule adjustable, with ranger buffs the penalty should make it so archery is slightly more accurate than melee at default. -Skill is now a flat 0.33% chance to miss for every point under your max skill you are. -The benefit from agility to avoidance has been decreased by roughly 33%. -Maximum chance to hit is now 95%, down from 99%.

- **KLS** Bug fix in skill up with the skill up mod rule.

Recommended SQL and Optional SQL: 356_combat.sql

## 2/21/2009¶

- **cavedude00** Removed Combat:ChanceToHitDivideBy rule. Default value is now Live Like.

Required SQL: delete from rule_values where rule_name = 'Combat:ChanceToHitDivideBy';

- **Congdar** Bots: Revert svn328

Required SQl: delete from rule_values where rule_name = 'EQOffline:SpawnBotCount';

```
` delete from rule_values where rule_name = 'EQOffline:CreateBotCount';
 delete from rule_values where rule_name = 'EQOffline:BotQuest';
`
```

- **Congdar** Bots: UN-Revert svn328 + bug fixes

(if you updated to svn354)

Required SQl: 328_bot_management.sql

Optional SQL: 328_optional_bot_management.sql

## 02/19/2009¶

- **Trevius** (Xinu) SoF * Many Opcodes filled in from the client

- **Trevius** SoF * Aligned the Player Profile a bit more. Should be pretty accurate now

- **Trevius** SoF * Added Drakkin race again for use of equipment. Should work correctly this time.

## 02/19/2009¶

- **KLS** SoF * Fix for ammo

- **Angelox** Bots: Fixed '#bot track' command

- **Angelox** Bots: Fixed broken entry in BotAI.cpp for '#bot track rare' command

- **Angelox** Bots: 'Fixed #bot gate airplane' typo

- **Congdar** Fix for Flash of Steel AA

## 02/18/2009¶

- **Trevius** SoF * Combat Damage message now show up in the chat window

- **Trevius** SoF * GM Skill Trainers will now actually train skills

- **Angelox** Bots: Added emerald, skyfire, hateplane, skyplane to command #bot gate.

- **Trevius** SoF * Backed out item stat fix for SoF due to it causing the problem to happen in Titanium

## 02/17/2009¶

- **Trevius** SoF * Added Drakkin race to the source so $race and probably other race related stuff can use it.

- **Trevius** SoF * Added multiple opcodes

- **Trevius** SoF * Cleaned up the patch_SoF.conf file some

- **Derision** SoF *Enter Tutorial/Return Home buttons work* Enter Tutorial directly on char creation does not.

- **Derision** SoF * OP_ZonePlayerToBind (no more disconnection on death).

- **Derision** SoF * Target nearest NPC (F8) now works.

- **Derision** SoF * /who all now works.

- **cavedude00** SellRate column in items will now help determine an item's sell price.

- **cybernine186** Optional system to ensure GMs are logging on from a known IP.

- **Trevious** SoF * Drakkin now gain stats from items and weapons now work for combat

- **Trevious** SoF * Drakkin now start with Common Tongue, Dragon and Elder Dragon Languages maxed

Required SQL: utils/sql/svn/340_gm_ips.sql

## 02/16/2009¶

- **Trevius** SoF * The Item Struct should be aligned almost perfectly now.

- **Trevius** SoF * Merchant Lists, Buying and Selling are now all functional

- **Trevius** SoF * Looting Items and Currency from Corpses is now functional

- **Trevius** SoF * Item Links are now functional

- **Trevius** SoF * Combat animation is now functional

- **Trevius** SoF * More opcodes added/updated

- **Trevius** SoF * Titanium users will now see Drakkins (and any race over 473) as a normal Human race

## 02/15/2009¶

- **KLS** SoF * Item movement and bag support.

- **AndMetal** Augments are now visible when linking items.

- **Trevius** SoF * Adjusted the new Item Structure to align more fields

- **Trevius** SoF * Added OP_Consume and OP_LootRequest opcodes

- **cavedude00** (AndMetal) AAs now use skill_id instead of index for prereqs.

- **cavedude00** (mackal) Implemented Improved Instrument Mastery, Improved Singing Mastery, and Echo of Taelosia AAs.

- **cavedude00** Created Combat:ChanceToHitDivideBy rule and increased default value to 1250.

Required and Optional SQL: utils/sql/svn/326_aas.sql

- **KLS** SoF * Fix for item slots in bags.

- **KLS** SoF *Added work around for client inventory, it should no longer crash and items shouldn't fail to load.* fingers crossed*

- **KLS** SoF * Implemented summon item packet.

- **Congdar** Bots * Expaneded BotCount Management

required sql: utils/sql/svn/328_bot_management.sql

optional sql: utils/sql/svn/328_optional_bot_management.sql

## 02/14/2009¶

- **Derision** SoF * New struct for OP_ExpansionInfo

- **Derision** SoF * Character Creation now works.

- **Derision** SoF * support now compiled in by default.

- **Derision** Small changes to compile SoF under Windows

- **KLS** SoF * initial inventory load.

- **KLS** Change to streams, streams will now initialize to an unestablished state instead of closed. Prevents a race condition that would cause the client to hang on identification.

- **Trevius** SoF * Identified most or all needed fields in the illusion struct for future use.

- **WildcardX** Made Perl v5.10 the default for WIN32 compiles.

- **WildcardX** (Angelox) Added many header declarations to make gcc v4.3 happy.

## 02/13/2009¶

- **WildcardX** Compatibility for Perl 5.10. WIN32 compiles will still need to rename perl58.lib to perl510.lib.

## 02/12/2009¶

- **Trevius** Identified the Size, Eye Color and Texture fields in the SoF spawn structure.

- **Trevius** Added multiple Opcodes for SoF

## 02/12/2009¶

- **cavedude00** Added #findzone (#fz) command to aid in getting a zone's short_name or id.

- **cavedude00** #peqzone now accepts both short_name and zoneidnumber.

## 02/09/2009¶

- **Angelox** Bots:Added command '#bot corpse summon' for Necromancer.

## 02/08/2009¶

- **Trevius** Corrected Z Coordinate on clientupdates in SoF. All Client and NPC positition structures should now be accurate

- **Trevius** Corrected the Object structure in SoF. Objects should now all load in the correct location and size.

- **Trevius** Added a few new Opcodes for SoF.

- **Trevius** Corrected the Opcode for OP_RequestClientZoneChange * Zoning is now fully functional including zone commands

## 02/07/2009¶

- **cavedude00** Added faction modifiers for Berserker and Froglok.

- **Derision** Fixed item load failure when using MySQL 5.1.

Required SQL: ALTER TABLE `faction_list` ADD COLUMN `mod_c16` smallint(6) NOT NULL default '0' AFTER `mod_c15`; ALTER TABLE `faction_list` ADD COLUMN `mod_r330` smallint(6) NOT NULL default '0' AFTER `mod_r161`;

## 02/05/2009¶

- **Trevius** NPC coning is now working in SoF.

- **Trevuis** NPCs and Players can now be targeted in SoF.

- **Trevius** Corrected the illusion packet structure in SoF so helm change will work with the #fixmob command

- **Trevius** Adjusted the #fixmob and #race commands to allow up to 586 races (the max for SoF)

- **Trevius** Client Self position updates now report correct X, Y, and Heading in SoF, but still need Z corrected.

- **Trevius** All other position updates (NPC or other clients) now seems to be accurate.

- **Trevius** Names are now viewable over NPC and Player's heads

- **Angelox** Bots: charm level problem fixed.

## 02/04/2009¶

- **Derision** Fixed ammo consumption.

## 02/02/2009¶

- **Derision** Fix for temp merchantlists where a merchant has a single item with slotid=1

## 02/01/2009¶

- **Angelox** Bots:(leslamarch) corrected the'#bot gate [combines]' typo.

- **Angelox** Bots: Added '#bot dire charm'.

- **Angelox** Bots: Both 'charm' and 'dire charm' will now choose from three charmer classes.

- **Angelox** Bots: Added '#bot pet remove' (can't charm a mob while sporting a pet).

- **Angelox** Bots: Fixed exploit where player could remove charmed mobs at will.

- **Derision** Merchant lists with gaps should now not cause problems wih temporary merchant lists.

- **Derision** Logging to the eventlog table for trades with NPCs is now controlled by two rules rather than the loglevel variable.

Required SQL: ALTER TABLE `eventlog` ADD `event_nid` INT NOT NULL DEFAULT '0';

Optional SQL: INSERT INTO `rule_values` VALUES (0, 'EventLog:RecordSellToMerchant', 'false'); INSERT INTO `rule_values` VALUES (0, 'EventLog:RecordBuyFromMerchant', 'false');

## 01/31/2009¶

- **Trevius** Adjusted the NewZone Structure for SoF * Players can now move and spawns appear in place

- **Trevius** Adjusted the WearChange Structure for SoF * Armor shows, but need Tint to work still

- **Trevius** Adjusted the Object Structure for SoF * Objects now load, but need more work

- **Trevius** Added many new opcodes for SoF

- **Trevius** Adjusted when SendExpZonein is sent for SoF only

- **Trevius** Added new Opcode List file for SoF development purposes only

Note: You must move the patch_SoF.conf file from /utils into your server directory for the opcode updates

## 01/31/2009¶

- **Derision** Tweaks to temp merchant list window updates.

- **cavedude00** Renamed the AugSlotUnk items columns to AugSlotVisible.

Required SQL: utils/sql/svn/292_augslots.sql

## 01/29/2009¶

- **KLS** VC71 solution files.

## 01/28/2009¶

- **Angelox** Bots: Added a directory with the BOT Makefiles for Windows and Linux.

## 01/27/2009¶

- **Derision** Bazaar bug fix.

- **Angelox** Bots: Added command '#bot runeme' (Enchanter Rune spells)

Optional SQL: utils/sql/svn/285_optional_bot_spell_update.sql (removes auto-runes)

## 01/24/2009¶

- **Trevius** Initial Addition of Secrets of Faydwer Patch files. Must uncomment the #define in common/patches/patches.cpp to use SoF for now.

## 01/22/2009¶

- **Derision** Fixed a buffer overflow problem.

## 01/19/2009¶

- **cavedude00** Increased itemid limit to 120,000.

- **cavedude00** Meditate will now skill up at a more Live Like speed.

## 01/18/2009¶

- **Derision** Fixed a cause of zone crashes.

- **Congdar** Worn items with charges will no longer delete when the charges are used up.

## 01/17/2009¶

- **Derision** Fixed several cases of integer overflow relating to moving large amounts of money around.

- **Angelox** Bots: Added command '#bot gate', for Druid Circles or Wizard Portals (Druid Primary).

- **Angelox** Bots: Changed BotCount to RULE_INT.

## 01/16/2009¶

- **Derision** Implemented voice macros (CTRL-V). Update your opcodes.

- **Derision** Food and drink should no longer be auto-consumed in the Bazaar

- **Derision** Added rule Spells:TranslocateTimeLimit. If >0, translocate must be accepted within this number of seconds.

Optional SQL: (Required to enable voice macro use on your server

REPLACE INTO `rule_values` VALUES (0, 'Chat:EnableVoiceMacros', 'true');

## 01/14/2009¶

- **Derision** Fixed makefile references for rulesys.o

- **Derision** Mapped field in LogServer_Struct to allow voice macro window to be opened (needs work on Opcodes to make it functional).

## 01/12/2009¶

- **Derision** Removed code that stole all your money if you logged on with more than 1 million of any denomination of coin on your person.

## 01/11/2009¶

- **Angelox** Bots: Added rule 'EQOffline:BotCount' defaults to 5, for desired amount of bots in the group * values are 0-5 (0 means bots are disabled, max limit is 5).

- **Derision** Mail/Chatchannels: Added sanity check on packet size in EQPacket::ChatDecode.

- **Derision** Mail/Chatchannels: Increased stream timeout from 45 to 135 seconds.

- **Derision** Mail: Use correct opcodes for sending Headers. **utils/mail_opcodes.conf updated**

- **Derision** Chatchannels: Recognise and ignore AFK command.

- **Derision** Chatchannels: Added uptime command (usage ;uptime or /chat uptime).

- **Congdar** Bots: Added Lore item check to command #bot inventory remove

## 01/08/2009¶

- **Congdar** Bots: Fix compile issue under linux for Visible Gear update.

- **Angelox** Bots: Updated required SQL, utils/sql/svn/250_bot_spell_update.sql (some spells were still being auto-casted)

- **Derision** Chatserver: Fix for crash when multiple connections are made in quick succession.

## 01/07/2009¶

- **Angelox** Bots: Added command '#bot charm' (requires enchanter in group). Charm does not work while Chanter has pet so I added the grouped Chanters pet to '#bot group remove' (remove the pet before #bot charm).

- **Angelox** Bots: '#bot sow wolf' should not affect pets anymore.

- **Derision** Chatserver: Added some extra syntax error checking to prevent crashes.

- **Angelox** Bots: Added Wizard class and level check to the '#bot evac' command

- **Angelox** Bots: Added '#bot invis see' for see invisible

Required SQL:

DELETE FROM npc_spells_entries where (npc_spells_id >=701 and npc_spells_id <=712) AND spellid=80;

- **Congdar** Fix NPC::RemoveItem(uint16 item_id) to uint32 to work with items that have id's larger than 65535. '#npcloot remove [itemid]' will now successfully remove items with larger id's from npc loot.

- **Congdar** Bots: Visible gear will now show correctly when trading/equipping bots.

## 01/04/2009¶

- **Angelox** Bots: Added command '#bot endureb' (enduring breath).

- **Angelox** Bots: Hopefully fixed bug where other sowers replaced primary sower (Druid).

## 01/03/2009¶

- **Angelox** Bots: remade/improved commands '#bot levitate'and '#bot invis'

## 01/02/2009¶

- **Congdar** Bots: update command #bot inventory list Now shows gear as item links. Removed (Bot) as last name during bot creation.

Optional SQL: update npc_types set lastname='' where isbot=1;counter** Fixed zoning bug where you zoned back into the same zone, but it looked like you were in the new zone.

## 01/01/2009¶

- **Angelox** Bots: Added command '#bot sow' (Druid has options)

- **Angelox** Bots: Added command '#bot levitate'.

- **Angelox** Bots: Added command '#bot invis' * (has options).

Required SQL: utils/sql/svn/250_bot_spell_update.sql

- **Angelox** Bots: Added command '#bot resist' (has options, don't use optional sql if you don't want).

Optional SQL: utils/sql/svn/250_optional_bot_spell_update.sql

- **Derision** Added chatserver for Chat Channel support. mail_opcodes.conf updated in utils.

- **Derision** See: http://www.eqemulator.net/wiki/wikka.php?wakka=ChatChannels

REQUIRED SQL:

CREATE TABLE `chatchannels` ( `name` varchar(64) NOT NULL, `owner` varchar(64) NOT NULL, `password` varchar(64) NOT NULL, `minstatus` int(5) NOT NULL default '0', PRIMARY KEY (`name`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8;

also see utils/sql/svn/249_chatchannels.sql for suggested system channels.

---

## 2010

*Source: changelog/server/2010/index.html*

# 2010¶

## 01/01/2011¶

- **Derision** UF: Tweaked Arrow_Struct and implemented new OPCode for changing player size.

## 12/31/2010¶

- **Derision** UF: Fix for extended duration buffs not reporting correctly after first tic.

## 12/30/2010¶

- **Derision** Added a new table aa_required_level_cost to allow specifying a required level and cost for each rank of an AA.

- **Derision** Implemented spell formulas required by AA versions of Harm Touch/Lay on Hands.

- **Caryatis** ShowStatWindow was changed to ShowWindow and had some features added

- **Caryatis** title_type = 0 for custom titles, 1 for first and last name and 2 for guild titles

- **Caryatis** Implemented a limit on how low a weapon speed can be when procs are calculated to reflect the innate swing speed limit

Required SQL:

utils/sql/svn/1790_required_aa_required_level_cost.sql

If there is no entry in this new table for a given rank of an AA, then the level (class_type) and cost_inc from altadv_vars will be used as normal.

## 12/28/2010¶

- **Derision** /corpsedrag & /corpsedrop. Optional SQL: utils/sql/svn/1784_optional_corpsedrag_rules.sql

## 12/25/2010¶

- **Derision** Underfoot: Correct OP_SwapSpell

- **Derision** SoD/Underfoot: List of traders in /bazaar dropdown now works.

- **Derision** Implemented Advanced Tracking AA.

## 12/24/2010¶

- **Trevius** (Orkim) Zone Short Name restriction fixes.

## 12/21/2010¶

- **Derision** HoT: OP_SendFindableNPCs

- **gaeorn** bugfix for quest::movegrp to work with raids. no really, its fixed this time

## 12/15/2010¶

- **Trevius** Added an extra check for buffs while zoning to make sure it is a valid spell being applied.

- **Derision** Underfoot * Fix for /dismount not dispelling horse and Group Leadership fixes (opcode changes).

- **Congdar** fix for bot trading exploits

## 12/13/2010¶

- **gaeorn** fixed underfoot to properly handle new packet struct for LoadSpellSet_Struct

- **Derision** Underfoot * UCS should now retain /announce setting properly.

## 12/11/2010¶

- **gaeorn** bugfix for quest::movegrp to work with raids

- **Derision** UCS Support for Underfoot and later clients

- **Congdar** bot item trading fixes for lore, dual wield, augmenting, inspecting

## 12/10/2010¶

- **gaeorn** fixed quest::movegrp to work with raids

- **gaeorn** fixed casting group spells in a raid

- **gaeorn** (vanicae) code support for tactical mastery warrior aa

- **gaeorn** (vanicae) code support for touch of the divine cleric aa

- **gaeorn** (vanicae) item loot messages when in a raid

- **gaeorn** (Wolftousen) fixed spawn variance

## 12/09/2010¶

- **Derision** Updated HoT opcodes following patch.

## 12/07/2010¶

- **Trevius** Resolved a potential zone crash with memorizing spells.

- **Trevius** Added $item1_charges, and $item1_attuned exports for all 4 turn in slots item1-item4 for EVENT_ITEM.

- **Trevius** Fixed GetMinDMG() so it should work now.

## 12/03/2010¶

- **Caryatis** Fix for SpellResistChance effect.

Required SQL: utils/sql/svn/1755_required_sql_fear_resist_aas.sql

## 12/01/2010¶

- **Caryatis** Fix for Reflect Spells and Healing Adept AAs

- **Caryatis** Showstats has been updated.

Required SQL: utils/sql/svn/1754_required_sql_healing_adept_aa_fix.sql

Optional SQL: utils/sql/svn/1753_optional_haste_cap_rule.sql

## 11/30/2010¶

- **Trevius** SoF+ * Stacked Potions will no longer show a factor of how many you have remaining in the potion belt.

- **Trevius** Increased the max spell ID allowed in the spell book from 20000 to 50000.

- **Derision** Underfoot. Corrected PP for LDoN points, Tribute and Leadership AA. Corrected offset comments/unknown names.

## 11/27/2010¶

- **Derision** Renamed Live patch to Underfoot.

- **Derision** Added basic support for current live patch (HoT).

- **Caryatis** Reverted Bot changes due to crash issues

- **Caryatis** Reverted physical resist changes until we can find a more live-like solution

- **Caryatis** Gender Illusions are now functional

- **Caryatis** Implemented SE_Twinproc and Reflect spells

Note:

HoT support is limited to being able to enter a zone with spawns and items. Combat, spells, moving items around, basically anything other than zoning, spawns, initial inventory load and movement will NOT work. Note ZoneUnavailable is not implemented, so let at least one dynamic zone finish booting before attempting to enter. This support is mainly to allow people to admire HoT zones, full playable HoT support is not planned at this time.

Optional SQL for zone and zonepoint table (thanks to robregen for the collects):

utils/sql/svn/1747_optional_HoT_zone_and_zonepoints.sql

For spawns etc, go to the PEQ logs repo for data collected by robregen.

Optional SQL:

utils/sql/svn/1750_optional_sql_reflect_rule.sql

## 11/24/2010¶

- **Trevius** The Rule, NPC:ReturnNonQuestNoDropItems, will now also return items that have been Attuned to a character as well as normal NO DROP items if set to true.

- **Trevius** Fixed an issue with tradeskill auto-combines.

- **Caryatis** Fix for SpellResistChance, Hit-limited focus effects(eg Gift of Mana) & SpellDamageShield(no longer will trigger on beneficial spells).

- **Caryatis** Showstats window will not show mana fields if the class does not use mana(to preserve the already shaky alignment).

- **Caryatis** (bad_captain) Removed the level bonus granted to standing mana regen, it was not like live and diminished the need to sit or use a horse considerably.

- **Caryatis** (bad_captain) Bots have been updated, see forums for complete details(new command: #bot showstats).

- **Caryatis** (Secrets) Haste values can exceed 127%(ie Can o' Whoop Ass).

Optional SQL: utils/sql/svn/1746_optional_sql_bot_manaregen

## 11/22/2010¶

- **JJ** Updated waypoint handling to properly account for aggro and quest engagements. NPCs will no longer skip waypoints when distracted from their grid path when resuming wandering.

## 11/21/2010¶

- **Caryatis** Implemented SE_SkillDamageAmount & SE_Amnesia(silence vs disciplines), SE_CripplingBlow

- **Caryatis** Updated Silence so that is no longer prevents the use of disciplines(like live)

## 11/20/2010¶

- **Caryatis** Fix for discs being resisted too much, beneficial spells and resurrection effects will no longer be resistable.

- **Caryatis** Fix for CriticalHitChance being calculated incorrectly, leading to massively increased crit rates.

- **Caryatis** Fix for Healrate effect

- **Caryatis** Implemented ManaAbsorbPercentDamage, ReduceSkillTimer, HpToMana and LimitSpellGroup effects.

- **Caryatis** Updated DamageModifier effect to be more robust.

Required SQL: utils/sql/svn/1737_required_sql_rule_and_aa_update

Optional SQL: utils/sql/svn/1736_optional_sql_feral_swipe

## 11/14/2010¶

- **Derision** Underfoot: Buff removal should now work correctly.

- **Derision** Underfoot: Fixed Pet Buff window.

- **Trevius** Fixed quest::setnextinchpevent().

- **Trevius** Added Player EVENT_GROUP_CHANGE that exports variables $grouped and $raided when changes in group or raid status are made

- **Trevius** Added Perl Client MarkCompassLoc(x, y, z) and ClearCompassMark().

- **Trevius** Minor rewrite to EVENT_HP again to use less variables.

## 11/13/2010¶

- **Derision** Corrected OP_Track for Underfoot/June 8 2010 Client.

- **Derision** Corrected FindPersonRequest_Struct for Underfoot/June 8 2010 Client.

- **Derision** Buying AAs seems to work better now for Underfoot/June 8 2010 Client.

- **Derision** Most Pet commands should now work for Underfoot/June 8 2010 Client.

- **Caryatis** Corruption resist is now fully functional

- **Caryatis** Showstats has been updated.

- **Caryatis** Implemented SpellOnKill and CriticalDamageMob effects.

- **Caryatis** Fix for CriticalSpellChance

Required SQL: utils/sql/svn/1723_required_sql_corruption.sql

Optional SQL: utils/sql/svn/1723_optional_sql_new_stats_window_rule.sql

## 11/10/2010¶

- **Caryatis** Added support for HealAmt, SpellDmg, Clairvoyance, DS Mitigation, SE_SpellDamageShield, SE_SpellDamage

- **Caryatis** Heroics fully supported now(points in brackets are how many Heroics to achieve a gain)

- **Caryatis** hInt = For int-based casters, increases mana pool, mana regen(25), and the maximum amount of mana regen a character can have(25).

- **Caryatis** hWis = For wis-based casters, increases mana pool, mana regen(25), and the maximum amount of mana regen a character can have(25).

- **Caryatis** hStr = Increases endurance pool, endurance regen(25), and the maximum amount of endurance regen a character can have(25). Also increases damage done by melee attacks(10) and improves the bonus granted to armor class while using a shield(2).

- **Caryatis** hSta = Increases hit point pool, hit point regen(25), and the maximum amount of hit point regen a character can have(25). Also increases endurance pool, endurance regen(25), and the maximum amount of endurance regen a character can have(25).

- **Caryatis** hAgi = Increases endurance pool, endurance regen(25), and the maximum amount of endurance regen a character can have(25). Also increases the chance to dodge an attack(25), grants a bonus to defense skill(10).

- **Caryatis** hDex = Increases endurance pool, endurance regen(25), and the maximum amount of endurance regen a character can have(25). Also increases damage done by ranged attacks(1), improves chance to successfully assassinate or headshot(10), and improves the chance to riposte, block, and parry incoming attacks(25).

- **Caryatis** hCha = Improves reaction rolls with some NPCs(25) and increases the amount of faction you gain or lose when faction is adjusted(5).

- **Caryatis** AA Focus revamped to support new effects

- **Caryatis** Disciplines will no longer be dispelled

Optional SQL: utils/sql/svn/1719_optional_triggerOnCastAAs.sql

## 11/09/2010¶

- **Caryatis** Implemented MaxHPChange, SkillDmgTaken, Endurance Pool and Stun Resist.

Optional SQL: utils/sql/svn/1717_optional_rule_bash_stun_chance.sql

## 11/07/2010¶

- **Congdar** Fixed OP_InterruptCast for newer clients(SoF, SoD, Live). You'll now see Npc's and other players cast interrupted message properly.

## 11/06/2010¶

- **Trevius** Fixed an issue with EVENT_HP that was sending $hpevent with a value of -1 in certain cases.

## 11/04/2010¶

- **Trevius** Added new Perl Client GetAAExp() quest object.

- **Trevius** Corrected the level based Experience quest command and task reward functionality to not affect AA Experience.

## 10/30/2010¶

- **KLS** Added NPC::AddAISpell() and NPC::RemoveAISpell() to perl NPC object.

- **KLS** Added field to limit AAs based on account creation time.

- **KLS** Implemented fade on meditate field for spells like the higher yaulp spells (it will fade just before a regen tic).

- **JJ** Cleaned up Win32 build locations, moved eqlaunch into build folder, and set project dependencies to guarantee build order in Windows.

## 10/16/2010¶

- **Trevius** Added optional slot_id field to Client SummonItem(item_id, charges, attune, aug1, aug2, aug3, aug4, aug5, slot_id) * Default is slot 30 (cursor).

## 10/16/2010¶

- **Trevius** Added Perl Item IsAttuned() and GetCharges() quest commands.

- **Trevius** Added Attune and Aug fields to Client SummonItem(item_id, charges, attune, aug1, aug2, aug3, aug4, aug5)

## 10/15/2010¶

- **Trevius** NPCs can now load a default.pl file from the /quests/zone_short_name/ of the zone they are in.

## 10/14/2010¶

- **Trevius** Added Race 502 Boats to be a controllable boat race.

## 10/10/2010¶

- **Trevius** Added Perl Client AddLevelBasedExp(exp_percentage, max_level=0) command to add experience as a percentage of the client's current level up to the max level entered.

- **Trevius** Level based experience percentage rewards for tasks can now be set using a negative value of the max level * 100 + experience percent (IE. -510 for 10% exp up to level 5).

## 10/09/2010¶

- **Trevius** Object model names can now use up to 32 characters.

- **Trevius** Zone short names can now use up to 32 characters.

- **Trevius** Added extra checks before AIYellForHelp call is made to prevent potential issues.

- **Secrets** Added Perl Client GetIP() and NPC GetMinDMG() commands.

- **KLS** Adjust procs: only check once per round now instead of once per hit, this will result in lower proc rates especially for dual wielding classes but this is how it should behave. Adjust your proc per minute rule up if you desire higher proc rates under this change.

- **KLS** Directional Cone Spells; still needs a little work as it isn't 100% accurate but it works enough that there's no point in me sitting on it.

Required SQL: utils/sql/svn/1696_modify_zone_and_object_tables.sql

## 10/03/2010¶

- **Derision** Fixed bug in SoD+ tracking.

- **JJ** Removed redundant namespace usage.

## 10/02/2010¶

- **Derision** Players disconnected with the Respawn Window up will now return to bind.

- **Derision** Players rezzed in an instance via the Respawn Window will no longer zone.

- **Derision** Implemented Blocked Buffs.

- **Derision** Fixed Blocked Buff spam every time you zone.

- **Derision** Implemented OP_ClearBlockedBuffs.

## 09/29/2010¶

- **Derision** Fixed crash in combat logging when a player was DoTted, zoned and then died from the DoT.

- **Derision** Spells should no longer land on players with the Respawn Window up (e.g. AE DoTs, Evac spells).

- **Derision** The client should now ummem spells on death when the Respawn Window is in use.

## 09/26/2010¶

- **WildcardX** Updated bots.sql to catch a couple database object changes that affected bots over the last months.

## 09/25/2010¶

- **Derision** Only one Rez confirmation box is allowed to be up at a time (per character).

- **Derision** Enabled Respawn Window for SoF and later clients. Rule disabled by default.

- **Derision** Respawn Window only pops-up if a corpse is left (so #gm off to test it).

Optional SQL (and to enable it):

utils/sql/svn/1672_optional_rules_respawn_window.sql

## 09/24/2010¶

- **Congdar** Remove obsolete bot code, fix compile warning

## 09/23/2010¶

- **Congdar** Bots can now equip multi slot items in the desired slot. The first available empty slot will get the item.

- **Congdar** Bots now check Lore and Dual Wield with the new multi slot item code.

## 09/13/2010¶

- **JJ** Fix to prevent NPCs using death animation from facing target during EVENT_SAY and EVENT_ITEM

- **Derision** Fix for missing tradeskill objects etc in SoF and later clients.

- **Derision** Reverted stun resist changes.

## 09/12/2010¶

- **Derision** /guildstatus now works for SoD and UF.

- **Caryatis** Spells with a Melee Lifetap effect now cap the heal at the percentage specified in the spell data.

- **Caryatis** Work on stun resists.

- **Vanicae** Fix for potential world crash in online guild-member processing.

## 09/11/2010¶

- **Vanicae** Fix for guild management window updates

- **wheeljack** Fix for missing tradeskill favorites

- **Vanicae** Tribute Focus, SE_DivineSave, SE_Flurry, SE_Accuracy

- **wheeljack** Fix for losing items in world containers

- **pfyon** quest::createBot()

- **Derision** None potions that are potion belt enabled (mod rods etc) should now work from the potion belt when they are inside a bag.

- **Derision** Recast timers should now be honoured for clicky items with a single charge (e.g. Modulating Rod).

- **gaeorn** more fixes for newer gcc/glib

## 09/08/2010¶

- **gaeorn** fixes for new stricter version of gcc/glib

## 09/08/2010¶

- **JJ** ChannelMessageSend in Client now cleans the "from" name to allow NPCs to be used as the message sender.

## 09/06/2010¶

- **Trevius** Added to Perl Mob: SetSlotTint(material_slot, red_tint, green_tint, blue_tint).

- **Trevius** Added to Perl Mob: WearChange(material_slot, texture, color).

- **Trevius** Added to Perl Mob: GetArmorTint(material_slot).

- **Trevius** Changed EVENT_COMBAT to now export the normal client variables when combat state changes to 1.

## 08/28/2010¶

- **Derision** Fixed potential buffer overrun in item_struct. NOTE: Linux users may have to increase shmmax.

- **Trevius** Added to Perl Mob: SetGlobal(varname, newvalue, options, duration, other=NULL).

- **Trevius** Added to Perl Mob: TarGlobal(varname, value, duration, npcid, charid, zoneid).

- **Trevius** Added to Perl Mob: DelGlobal(varname).

## 08/26/2010¶

- **Trevius** Added new Perl Mob quest object GetItemStat(itemid, stat).

- **Trevius** Added new Perl Client quest object NPCSpawn(target_npc, option, respawntime=1200) to do create, add, update, remove, and deletes just like #npcspawn.

- **Trevius** Fixed a potential crash while augmenting items.

- **Trevius** Fixed a crash caused by using tradeskill container objects created with the CreateGroundObjectFromModel() quest command.

- **Trevius** Added an optional decay time setting for quest::creategroundobjectfrommodel(modelname, x, y, z, heading, [type], [decay_time]).

- **Trevius** Decay time is now optional for quest::creategroundobject(itemid, x, y, z, heading, [decaytime]) (default is not to decay at all).

## 08/25/2010¶

- **JJ** Updated PP comments/unknowns to match size changes over time

## 08/24/2010¶

- **gaeorn** mana updates for group should be sent to SoD clients when in raid now

## 08/23/2010¶

- **Trevius** EVENT_TARGET_CHANGE now also works for player scripts.

- **Trevius** Added new EVENT_ITEM_CLICK for SoF+ clients. File naming format is: /quests/items/script_.pl (I.E. /quests/items/script_12345.pl)

- **Trevius** Effect Name overrides (SoF+) for the following item table fields: clickname, procname, wornname, focusname, or scrollname.

- **Trevius** Added to Perl Object: SetEntityVariable(id, var), EntityVariableExists(id), and GetEntityVariable(id).

- **Trevius** Added Rule UseRaceClassExpBonuses to allow choosing whether to use the Racial and Class Experience Bonuses (Default: True).

OPTIONAL SQL: utils/sql/svn/1625_optional_rule_class_race_exp_bonus.sql

## 08/15/2010¶

- **Derision** Fixed crash when a mob died to a DoT in a zone where buff timers are suspended.

## 08/14/2010¶

- **Derision** Spells/Songs with a Locate Corpse effect now work in SoD and later clients.

- **Derision** Spells/Songs with a Sense Undead/Summoned/Animal effect now work in SoD and later clients.

- **Trevius** Exported Perl Mob SetCurrentWP(waypoint), Perl NPC SetSaveWaypoint(waypoint), and Perl Client GetTotalSecondsPlayed().

- **Trevius** Changed grid from int32 to sint32 since grid pausing requires negative values.

## 08/13/2010¶

- **Derision** Elemental Draw should now work for SoD.

## 08/08/2010¶

- **Derision** Added check for invalid neighbour nodes on loading .path files.

- **wheeljack** Fixed Bazaar search for items with focus effects.

- **wheeljack** Buff Timer Suspension.

- **wheeljack** Tradeskill messages for missing components.

REQUIRED SQL:

ALTER TABLE zone ADD suspendbuffs tinyint(1) unsigned NOT NULL DEFAULT 0; UPDATE zone SET suspendbuffs = 1 WHERE short_name IN ('guildlobby', 'guildhall');

## 08/01/2010¶

- **Trevius** Exported the following to Perl Mob: GetWaypointX(), GetWaypointY(), GetWaypointZ(), GetWaypointH(), GetWaypointPause(), and GetWaypointID().

## 07/27/2010¶

- **Trevius** Exported SpellFinished(spell_id, spell_target = this, mana_cost = 0) to Perl Mob.

## 07/26/2010¶

- **Trevius** (Secrets) Added quest::creategroundobjectfrommodel(modelname, x, y, z, heading, [type]) command.

- **Trevius** (Secrets) quest::creategroundobject(itemid, x, y, z, heading) now returns object ID.

- **Trevius** (Secrets) Added Object List Iteration functions GetObjectByDBID(id), GetObjectByID(id), GetObjectList().

- **Trevius** (Secrets) exported Objects to Perl with the following **commands*

```
` IsGroundSpawn(), Close(), Delete(reset_state=false), StartDecay(), DeleteItem(index), IsObject(),
 Save(), SetID(set_id), ClearUser(), DBID(), GetID(), GetX(), GetY(), GetZ(), GetHeading(), VarSave(),
 GetType(), SetType(type), GetIcon(), SetIcon(icon), GetItemID(), SetItemID(itemid), SetLocation(x, y, z),
 SetX(XPos), SetY(YPos), SetZ(ZPos), SetHeading(heading), SetModelName(name), GetModelName(), Repop(), Depop().
`
```

## 07/25/2010¶

- **Trevius** (Caryatis) Added the following Spell Effects:

```
` SE_SympatheticProc, SE_ImprovedSpellEffect, SE_SpellVulnerability, SE_SpellTrigger
 SE_InterruptCasting, SE_CastOnWearoff, SE_ApplyEffect, SE_BossSpellTrigger, SE_Twincast
 SE_HealRate, SE_SkillDamageTaken, SE_EffectOnFade, SE_MaxHPChange, and SE_EndurancePool.
`
```

## 07/19/2010¶

- **gaeorn** fix for foraging

## 07/17/2010¶

- **JJ** Added events for tradeskill failure and success.

- **JJ** Added quest flag for tradeskills to be handled by perl. Required SQL in the utils folder.

## 07/14/2010¶

- **Trevius** Hopefully fixed the issue for SoF+ clients alcohol consumption causing item loss.

## 07/13/2010¶

- **Derision** Azone2 * Fixed crash processing fungalforest and possibly other Underfoot V4 .eqg zones.

- **Derision** Azone2 * Culled placeable shrooms to reduce fungalforest .map from ~80 to ~20MB.

## 07/11/2010¶

- **Trevius** Live * Environmental damage is now functional on this client.

## 07/08/2010¶

- **gaeorn** fixed confusing and likely flawed logic in GetZoneForage()

## 07/06/2010¶

- **Trevius** Fix to prevent a potential item loss bug.

- **Trevius** Fix for Nimbus Particle Effects to make them appear properly.

- **JJ** Added $oncursor as an export to the parser.

- **JJ** Added ability for NPCs to use heading in waypoint table. Added option to use heading when adding waypoints in game (-h switch). NPCs will use in-stride heading if the default heading (-1) is used. Optional SQL included in the utils folder.

## 06/24/2010¶

- **Trevius** EVENT_CLICKDOOR should now always show the correct door ID from the $doorid export.

- **Trevius** Doors with IDs higher than 126 should now work.

- **Trevius** Added perm_effect and client fields to SpellEffect(effect, [duration, finish_delay, zone_wide, unk20, perm_effect, client]).

## 06/23/2010¶

- **KLS** Instances can use spawn conditions now, requires SQL change in required sql folder. Also updating will wipe all current spawn condition variables so you'll want to make sure they're set in the new table. (ps instance_id=0 for base zones!)

- **KLS** Added expedition expire warning to dynamic zones that aren't LDoNs, requires conf change for SoF/SoD.

## 06/22/2010¶

- **gaeorn** replaced calls to rand() with calls to MakeRandomInt()

## 06/20/2010¶

- **KLS** Added command #maxskills to max your skills instead of having to #setskill everything for testing.

- **KLS** Implemented partial melee and spell runes.

- **KLS** Right click tome learning in sof/sod.

- **KLS** Adjusted AC; should now be more sensitive to changes in gear as well as implemented softcaps.

## 06/19/2010¶

- **Trevius** Stopped NPCs from sending an appearance packet for each WP they arrive at or depart from.

## 06/18/2010¶

- **Trevius** Nimbus particle effects now show correctly from spells/clickies.

- **Trevius** Removed the ability to stack the same Nimbus particle effect repeatedly.

- **Trevius** Existing Nimbus particle effects are now sent to players as they zone in.

- **Trevius** EVENT_SPAWN should work better for more quest commands now. Please report any bugs/issues with this change.

- **Trevius** SoF/SoD/Live * Stand state appearances are now set in the spawn struct.

REQUIRED SQL: utils/sql/svn/1548_nimbuseffect_required.sql

## 06/16/2010¶

- **gaeorn** fixed possible bug with unlocking cursed containers in LDoN

- **Trevius** SoF/SoD/Live * Corrected the item structures to allow summonedflag setting to show on items.

- **Trevius** SoD/Live * Identified Clairvoyance and added it to load from the DB to be shown on items.

- **Trevius** SoD * Possible fix for empty corpse looting bugging clients.

- **gaeorn** fixed another issue with the integer transformation for the RNG where it was not converting from a double float properly

## 06/15/2010¶

- **Secrets** Characters with HPs higher than 30k will no longer be set back to 30k current health when zoning.

- **gaeorn** fixed integer transformation for RNG as it previously would only return the high value of the low to high range if the RNG returned exactly 0xffffffff

- **Trevius** The following item fields now load from the database: EliteMaterial LDoNSellBackRate ScriptFileID ExpendableArrow QuestItemFlag.

- **Trevius** Identified some unknown fields in the database from 13th floor findings, and removed multiple unused fields.

- **Trevius** The summonedflag field is copied from UNK109 field.

REQUIRED SQL: utils/sql/svn/1542_items_table_cleanup.sql

## 06/10/2010¶

- **gaeorn** modified method of transforming RNG output into a range of integers. this should improve the equalization of the distribution of the returned random numbers

## 06/09/2010¶

- **Trevius** Added new Perl Mob quest object SpellEffect(effect, [duration, finish_delay, zone_wide, unk20, unk26]) for sending a spell paticle effects without casting a spell.

- **gaeorn** replaced random number generator with the first one on this page: http://www3.ocn.ne.jp/~harase/megenerators.html

## 06/08/2010¶

- **Trevius** Added new quest::resettaskactivity(task, activity) command for resetting a task activity done count to 0.

## 06/07/2010¶

- **gaeorn** compile fixes for linux

- **KLS** Added EVENT_SPELL_EFFECT_TRANSLOCATE_COMPLETE, EVENT_SPELL_EFFECT_BUFF_TIC_CLIENT, EVENT_SPELL_EFFECT_BUFF_TIC_NPC in the similar style of the other spell effect events.

## 06/06/2010¶

- **KLS** Added spell quests. Spell quests reside in {EQEMU_DIR}/quests/spells/ and are in the format of {spell_id}.pl. (ex: C:/eqemu/quests/spells/15.pl for greater heal)

- **KLS** Spell quests allow the overriding of specific spell effect. If a spell quest and sub exists then a spell's effect aside from buff duration and knockback is not used and instead the script is executed.

- **KLS** Two acceptable subs for spell quests: EVENT_SPELL_EFFECT_CLIENT and EVENT_SPELL_EFFECT_NPC and has a special export of $caster_id.

## 05/27/2010¶

- **Trevius** Unreverted the revert from R1502 and added a fix for the tradeskill container combine issue.

- **Trevius** Fixed a crash when using NukeItem on the Power Source slot for a Titanium client.

## 05/25/2010¶

- **KLS** Many changes..

- **KLS** Rewrote much of the adventure subsystem; moved from zone based calculations to world based.

- **KLS** Implemented adventure leaderboard (sort by # kills only)

- **KLS** Custom merchant (Adventure/PvP/Discord) purchases should attempt to put the item in a player's inventory before the cursor.

- **KLS** Corpses should move to an adventure GY if possible on the end of an adventure.

- **KLS** Adventures should always award points to zoning/offline players when they reconnect now.

- **KLS** Collect adventures will populate the zone with enough dropped items always automatically now, relying on drop rates is now out of the picture.

- **KLS** Mech. treasure chests will now be affectable by spells and destroyable; at least until we figure out the spawn structure on SoF and beyond to enable them correctly with rogue skills.

- **KLS** Addressed an issue that made chests slightly harder to open than they were intended to be.

- **KLS** Addressed a few issues with raids not being duplicated along with groups in the code. This should be apparent in the spell code.

- **KLS** Added a default ruleset to the zone table and added a version to the zone table. Version will default to 0 if non is found (base zone).

- **KLS** OP_MoveItem will ignore requests from a slot to the same slot.

- **KLS** Lowered the quick loot timer significantly, hopefully loot all works better.

- **KLS** Several memory leak and exploit fixes.

- **KLS** This could all probably use a bit more testing that I was able to give it as one person, I believe I got most if not all the crash bugs though!

## 05/22/2010¶

- **Trevius** Exported ModifyNPCStat(identifier, newValue) to Perl NPC.

- **Trevius** Added a check for destroying items to ensure the source slot is the cursor.

- **Trevius** Moved the SwapItem() check to verify the source and destination slots are both valid before doing anything else.

- **Trevius** The client will now be updated to delete an item if the server does not see an item in that slot while moving items around.

## 05/20/2010¶

- **Trevius** Added new Perl Mob quest object CameraEffect(duration, intensity, singleclient). Duration is in ms, intensity is from 0 to 10, and singleclient can be set to a client.

## 05/18/2010¶

- **Trevius** Live * Corrected the end of the Item Structure.

## 05/17/2010¶

- **Trevius** Live * Updated more Live Opcodes. The list should be about 95%+ accurate now. Live Client is very playable now.

- **Trevius** Increased the race max to 667 for #race and #fixmob race to match Live's current race count.

## 05/14/2010¶

- **Trevius** Added new Perl Mob quest object QuestReward(client, silver, gold, platinum) that awards money to the client and makes the quest completed sound.

- **Trevius** Added 2 new optional fields to Perl Client quest object MaxSkill(skillid, [class, level]).

- **Trevius** Minor corrections for SetSkill(skill_num, value) and AddSkill(skillid, value) to set skill values to int16 instead of int8.

## 05/13/2010¶

- **Trevius** Live * Updated Player Profile and Spell Buff Structs to allow the May 12th Live patched client to enter the game.

- **Trevius** Live * Updated about 50% of the opcodes so most basic stuff should be functional.

- **Derision** Live * Encoded OP_GroundSpawn plus updated OP_ClickObject/OP_ClickObjectAction.

- **Derision** Added Live to the list of clients reported by #cvs.

## 05/12/2010¶

- **Trevius** SoD * Coin no longer adds weight for this client server-side, since the client itself no longer adds coin weight

- **Trevius** SoD * Heroic Stats should now add the correct amount of HP/Endurance/Mana to match the client in most cases.

- **Trevius** The scribespell and traindisc commands and quest commands should sort Disciplines properly once again.

## 05/11/2010¶

- **Derision** Guild invitations to a player already in receipt of an invitation will now be rejected.

- **Derision** Fixed quest::pvp("off")

- **gaeorn** fixed a couple issues with the login server code.

## 05/10/2010¶

- **Trevius** SoD * Heroic Stats/Resists now increase the cap server-side as they should.

## 05/09/2010¶

- **Derision** Live * Added an encode for OP_ChannelMessage

- **Derision** Live * Encoded OP_GuildsList and corrected OP_GuildUpdateURLAndChannel.

- **Derision** Live * Door and Group OPCodes. Set OP_GroundSpawn=0x00000 until an encode can be done for it (was causing crashes, particularly in PoK).

## 05/08/2010¶

- **Derision** Guild Bank fix.

Trevius(Derision): Added special handling for certain types of opcodes to correct an issue on the Live client.

- **Trevius** SoF/SoD * Type 5 clicky items can no longer be used if the character does not meet the race/class requirements of the item.

- **Trevius** Live * Can now log into the game with new character fine, but some existing characters cause zoning loops.

- **Derision** Live * Added a Decode for OP_ChannelMessage

- **Derision** Live * Corrected OP_Camp, OP_MoveItem and OP_ItemPacket.

- **Derision** Live * Corrected: OP_SetChatServer2, OP_MemorizeSpell, OP_CastSpell, OP_Death, OP_Animation, OP_SenseHeading

- **Derision** Live * Corrected: OP_Damage, OP_TargetCommand, OP_MobHealth, OP_DeleteSpawn, OP_AutoAttack, OP_AutoAttack2

- **Derision** Live * Corrected: OP_SaveOnZoneReq, OP_Track, OP_TrackTarget (Tracking messages not yet working, probably due to Filter opcode).

- **Derision** Live * LogServer_Struct.

- **Derision** Live * Corrected OP_FormattedMessage and padded out ServerFilter_Struc to match live. OP_WhoAllResponse.

## 05/05/2010¶

Trevius(Derision): Fixed a potential crash related to Saylinks and Antispam code.

- **Trevius** Live * Initial update to the Live patch files. Can only get to a blank character select at this point.

## 05/04/2010¶

- **Trevius** SoF/SoD * Resolved an issue that was preventing some AAs from being able to be trained properly.

- **Derision** Updating a character's Alt or Banker flag no longer resends the entire guild member list.

- **joligario** quest::givecash cleaned up.

- **Congdar** SoF: Fix starting city for freeport characters.

## 05/03/2010¶

- **Derision** The facility to flag 'Alts' in the Guild Management Window now works for those clients that support it.

- **Derision** The facility to specify a Guild chat channel and URL now work for those clients that support it.

- **Derision** SoD * Item links for Task rewards now display correctly in the task window.

REQUIRED SQL: utils/sql/svn/1451_guilds.sql

## 05/02/2010¶

- **Derision** The Guild Management Window should now reflect the true online status and zone of members at all times.

- **Derision** Added a command, #cvs (Client Version Summary) to display connected client version counts.

OPTIONAL SQL: utils/sql/svn/1450_cvs.sql

## 05/01/2010¶

- **Trevius** Added new Perl NPC quest object GetSwarmTarget() to get the ID of a swarm pet's set target.

- **Trevius** Added new Perl NPC quest object SetSwarmTarget(target_id) to set the ID of a swarm pet's target.

- **Derision** Group member locations are now always updated in entity_list.SendPositionUpdates (for SoD group member location on map).

- **Derision** Certain detrimental spells will still allow the player to enter a rested state.

REQUIRED SQL: utils/sql/svn/1446_allowrest_required.sql

OPTIONAL SQL: (Read the comments in it before executing) utils/sql/svn/1446_allowrest_optional.sql

## 04/30/2010¶

- **Trevius** Fixed a bug that would cause clients in an existing trade to get bugged if another client tried to trade with them during their existing trade.

- **Trevius** Added new Perl Mob quest object MakeTempPet(spell_id, [name=NULL, duration=0, target=NULL]).

- **Trevius** Added new Perl NPC quest object GetSwarmOwner() to get the ID of a swarm pet's owner.

- **Trevius** Hide will now break if you move when not sneaking, even if you have invisibility on.

- **Derision** Fixed bug in Guild Bank.

- **gaeorn** reverted my change from 4/24 as it did not work.

## 04/29/2010¶

- **gaeorn** fixed tables to avoid login server hang if ServerTagDescription in tblWorldServerRegistration is null

Optional SQL: utils/sql/svn/1436_login_server_table_fix.sql

## 04/28/2010¶

- **Trevius** Attempting to trade with a player who is already in a trade will now give the "I'm busy right now" message for all clients.

- **Derision** Applied slot conversion so Apply Poison should now work in SoF.

- **gaeorn** login server now creates db entries for unregistered servers to keep same id across sessions

- **Derision** Fixed a cash amount display bug when the two participants in a Barter transaction are using different clients.

## 04/27/2010¶

- **Trevius** SoD/SoF * Clicky items with charges can no longer be cast if they have 0 charges left.

- **Secrets** Mana can now exceed 32k without rolling over to 0.

## 04/26/2010¶

- **Trevius** SoD/SoF * Failing a clicky item cast in certain scenarios should no longer cause the client to get bugged where the spells won't refresh.

- **Trevius** SoD/SoF * Cast bars from clicky items now use the cast time from the item, not from the spell.

- **Trevius** SoD * Potions in the potion belt can now be used even if they are inside bags.

## 04/25/2010¶

- **Derision** Fixed azone2 to handle missing model files (no longer crashes on oldfieldofbone.eqg)

## 04/24/2010¶

- **gaeorn** possible fix for long standing reconnect to login server problem if login server connection is down for an extended period of time.

- **Trevius** SoD * Added AA support for Harm Touch and Lay on Hands to replace the innate skills of the PAL/SK classes.

Optional SQL: utils/sql/svn/1410_optional_sod_aas_ht_and_loh.sql

## 04/23/2010¶

- **cavedude** Added Drakking to faction_list, updated wolf form and Skeleton.

REQUIRED SQL: ALTER TABLE `faction_list` ADD COLUMN `mod_r42` smallint(6) NOT NULL default '0' AFTER `mod_r14`; ALTER TABLE `faction_list` ADD COLUMN `mod_r367` smallint(6) NOT NULL default '0' AFTER `mod_r330`; ALTER TABLE `faction_list` ADD COLUMN `mod_r522` smallint(6) NOT NULL default '0' AFTER `mod_r367`; UPDATE faction_list SET mod_r367 = mod_r60; UPDATE faction_list SET mod_r42 = mod_r120; ALTER TABLE `faction_list` DROP COLUMN `mod_r60`; ALTER TABLE `faction_list` DROP COLUMN `mod_r120`;

## 04/22/2010¶

- **Trevius** Added the following to Client Perl; GetEndurance(), GetMaxEndurance(), GetEnduranceRatio(), SetEndurance(amount).

- **Trevius** SoD * Size fix for player races.

- **Trevius** SoD * Manual consumption of food/drink works and deletes the consumed item.

- **Trevius** SoD * Consumption of alcohol now gives a chance for skilling up tolerance and also deletes the consumed item.

## 04/21/2010¶

- **Trevius** SoD * The Mana and Endurance formulas are as close as I can get them for now.

- **Trevius** SoD * NPC default size is now 6 if the database is set to 0.

- **Trevius** It is no longer possible for current Endurance to be higher than max Endurance.

- **Trevius** Corrected a mistake pointed out by Rogean that was sending an unnecessary packet when clients were moving.

## 04/19/2010¶

- **gaeorn** bug fix so login server does not send world local_ip if option local_network is not set in login.ini

## 04/18/2010¶

- **Trevius** SoD * Added HP formulas for the SoD client, and a new rule to enable them for SoD clients only.

Optional SQL: utils/sql/svn/1394_optional_rule_sod_hp_mana_end.sql

## 04/17/2010¶

- **gaeorn** fixed login server auto-reconnect

cavedude (Leere): Tradeskill recipe learning

- **Congdar** fix windows compile: warning C4405: 'crc32' : identifier is reserved word

- **Congdar** fix windows compile: warning C4554: '>>' : check operator precedence for possible error; use parentheses to clarify precedence

- **Congdar** fix windows compile: warning C4800: 'char *' : forcing value to bool 'true' or 'false' (performance warning)

Required SQL: utils/sql/svn/1392_recipe_learning.sql

## 04/16/2010¶

- **KLS** (Leere) Melody Fix.

- **KLS** Other merges from spell branch, some more to come. Tell me if there are any crashes I only tested it for about 25 minutes.

## 04/15/2010¶

cavedude (Leere): Increased the number of tradeskill favorites that can be stored client side to 500. cavedude (Leere): Fixed avgcoin. cavedude (renoofturks): Fixes to SK harm touch.

- **cavedude** Lowered snare movement speed when fleeing to 41% or higher to allow "Snare" to prevent movement at all levels.

- **gaeorn** multiple login server support in world. protocol to update login server account information from within game. "trusted" field for world accounts in loginserver to limit where account updates can come from. in eqemu_config.xml, use to specify first of multiple login servers. increment the number to specify additional login servers. NOTE: be sure to replace the entry or you will be limited to just one login server. MULTIPLE LOGIN SERVERS WILL NOT WORK WITH MINILOGIN.

Required SQL for loginserver tables: alter table tblWorldServerRegistration add ServerTrusted integer NOT NULL after ServerAdminID;

## 04/12/2010¶

- **Derision** SoD * /who , /whotarget now work.

- **Derision** Corpses summoned in Shadowrest should no longer decay before you can finish looting them.

## 04/11/2010¶

- **Derision** SoD * Corpses should now vanish instantly rather than decay when using /hidecorpse.

- **Derision** SoD * Players can now see other players buffs in their target window.

- **Derision** SoD *Tracking* Player filter now works.

- **Trevius** SoD * Added Primary/Secondary weapon textures into the spawn struct for non-playable races.

## 04/10/2010¶

- **Trevius** SoD * Identified showhelm in the spawn struct.

- **Trevius** SoD * Corrected Face in the Player Profile. Frogloks and Vah Shir now show matching head and body correctly.

- **Trevius** SoD * Added Mana and Endurance update packets for clients.

## 04/08/2010¶

- **Derision** SoD * Tracking Auto-refresh should no longer fail with Recovery timer not met.

- **Derision** SoD * Previously memmed spells are now unmemmed when loading a spell set.

- **Derision** SoD * Added Slot conversion to ApplyPoison_Struct (Apply poison should work as well as Titanium).

- **Derision** AllButSoD * Fixed bug in Barter code.

## 04/06/2010¶

- **Derision** SoD * Players may now be tracked and fixed a bug where tracking would not work when switching tracking targets without cancelling tracking.

- **Derision** SoD * Initial work on /hidecorpse serverside support. All but /hidecorpse looted should work.

## 04/05/2010¶

- **Derision** SoD * Loot All now works.

## 04/04/2010¶

- **Derision** SoD * Group member (client or bot) mana and endurance should update correctly in the group window.

- **Derision** SoD * Altered SpawnStruct encode to send colors for all playable races (including corpses and NPCs).

- **Derision** SoD * Group Main Assist may be assigned via the Group Window. As the group leader cannot explicitly assign it to himself, use /grouproles set 2

- **Leere** A moving mob that becomes mezzed will no longer appear to continue moving.

- **Fourier** Added location to the output of #listnpc.

## 04/03/2010¶

- **Trevius** SoF/SoD * Total Spent AA Points now show correctly for these 2 clients.

- **Trevius** Froglok characters now default to size 5 instead of 7. This corrects size issues when using illusions.

- **Derision** SoD * Bazaar Trader Mode/Bazaar Search should now work correctly.

- **Derision** SoD * Found the helm field in the spawn struct.

- **Derision** SoD * Implemented new packets for sending the list of findable NPCs to the client.

- **Derision** SoD * Flymode and Titles in the spawn struct.

## 04/02/2010¶

- **Derision** SoD * Group Leadership AA should mostly work (Main Assist is no longer a GLAA and Health Awareness seems intermittent).

- **joligario** Pet behavious change.

- **Trevius** SoF/SoD * Added clicky item checks to match previous clients. All clicky item hacker entries should now be actual hack attempts.

- **Trevius** Added an extra hacker check for clicking a must equip effect without having it equipped.

- **Trevius** SoD * Removed the opcodes for the Pet Buff Window until the structure is updated. Prevents pet classes from crashing when pets are buffed.

- **Derision** SoD * Pet Buff Window now works.

- **Derision** SoD * Fixed OnLevelMessage struct (popup windows).

- **Derision** SoD * Fixed Barter mode.

- **Congdar** (Taurinus) Drakkin bots

## 04/01/2010¶

- **Derision** SoD * Tracking

- **Derision** SoD * Fixed price bug when buying from merchants.

- **Trevius** SoD * Spell books now display all scribed spells (was previously hiding the first 9 slots).

- **Trevius** SoD * Stopped the Barter error that was reporting when logging in due to an incorrect opcode.

## 03/31/2010¶

- **Derision** SoD * Groups should be as functional as previous clients, except Group Leadership AA doesn't work.

- **Derision** SoD * Fixed items being incorrectly flagged as No Trade/Copied

## 03/30/2010¶

- **Trevius** SoD * Corrected the opcode for Mob Health Updates so they update properly.

- **Trevius** SoD * Added a few new Opcodes and Structures for SoD packets that aren't used yet.

## 03/28/2010¶

- **Derision** SoD * Fixed client animation/runspeed glitch.

- **Derision** All Clients * Player position updates to other players should be more accurate.

- **Trevius** Updated #race and #fixmob commands to allow up to race 626 which is the total for the SoD client.

- **Derision** SoD * Very preliminary work on groups. You can form a group, but nothing else.

## 03/27/2010¶

- **Trevius** SoD * A couple more Opcode updates.

- **Trevius** SoD * Some group structures work, but grouping is still not functional.

- **Derision** SoD * Fixed random client crashes due to spawn packets and invisible mobs should now be invisible.

- **Derision** SoD * Did a basic Encode on OP_WhoAllResponse. Still needs work for various flags (LD/Trader/Buyer) etc.

## 03/26/2010¶

- **Trevius** SoD * Finished updated Opcodes and they should now be caught up with what we have in SoF.

- **Trevius** SoD * Updated Item Struct and now 1 inventory item can load correctly.

- **Trevius** SoD * Updated Position Update packet structures.

- **Trevius** SoD * Character Inventory now fully loads.

- **Trevius** SoD * AAs now load and appear to function properly.

- **Derision** SoD * Spawns work, sometimes. Client will crash randomly sometimes when receiving spawns

- **Derision** SoD * Added SoD.cpp to .vcproj files

- **Derision** SoD * Found showname field in Spawn Struct.

- **Derision** SoD * Identified equip_chest2 field in Spawn Struct.

- **Trevius** SoD * Looting now works.

- **Trevius** SoD * Commands that display item links now show links correctly.

## 03/25/2010¶

- **Trevius** SoD * Updated PlayerProfile_Struct and CharacterSelectEntry_Struct

- **Trevius** SoD * Updated Spawn_Struct and the encode (hackish for now), but can get in game with it!

## 03/24/2010¶

- **Trevius** SoD * Updated the NewZone struct and encode

## 03/23/2010¶

- **Trevius** SoD * Initial addition of the Seeds of Destruction patch files. Note: The SoD Client is not functional at all yet, but work has begun!

## 03/22/2010¶

- **Derision** Implemented the Guild Bank.

REQUIRED SQL: utils/sql/svn/1293_guild_bank.sql

## 03/20/2010¶

- **cavedude** Added $client->UpdateGroupAAs(), exported GetGroupPoints() and GetRaidPoints() to Perl.

## 03/19/2010¶

- **cavedude** Added $client->GetLDoNPointsTheme() Perl function.

- **Trevius** Added new EVENT_TARGET_CHANGE perl event. It triggers when an NPC target changes or is removed. It exports $hastarget which is 0 if no target and 1 if there is a target.

- **Trevius** Exported new quest objects to Perl Mob * SetRace(race), SetGender(gender), and SetTexture(texture).

- **Trevius** Exported to Perl Mob * SendIllusion(race,[gender,texture,helmtexture,face,hairstyle,haircolor,beard,beardcolor,drakkin_heritage,drakkin_tattoo,drakkin_details,size]).

- **Trevius** Added rule: Character:DeathExpLossMaxLevel * Any level greater than this will no longer lose experience. Default is 255 (disabled).

Optional SQL: utils/sql/svn/1290_optional_exp_loss_rule.sql

## 03/18/2010¶

- **Trevius** Added 3 new Perl Entity commands * GetMobByID(id), GetNPCByID(id), and GetNPCByNPCTypeID(npc_id).

- **Congdar** Bots: Fixed picklock and summon corpse

## 03/16/2010¶

- **Trevius** Saylinks should no longer cause zone crashes if used outside of EVENTs. They should function from anywhere now.

## 03/13/2010¶

- **Trevius** Added new SetFlyMode(0|1|2|3) Perl Mob command.

- **Trevius** NPCs in flymode 1 or 2 will no longer use BestZ when pathing to waypoints.

- **Trevius** Added new optional single client argument to SendAppearanceEffect(effect1, effect2, effect3, effect4, effect5, client) to allow sending the effect only to specific players.

## 03/12/2010¶

- **joligario** Fixed some spelling mistakes.

## 03/11/2010¶

- **Congdar** bots can now equip items with augments. required sql: \utils\sql\svn\1280_bot_augs.sql

- **Congdar** new bot command '#bot augmentitem' Allows you to augment items for your other bot classes. Your must have the Augmentation Sealer window filled.

## 03/10/2010¶

- **Derision** Begging should no longer bug the client. Still needs some work around chance/amount/skillups etc.

## 03/07/2010¶

- **Derision** Fix for temporary items on merchants appearing to increase in price.

- **Leere** Refinement to above and fix for purchase price of stacked items != displayed price * quantity.

## 03/05/2010¶

- **Trevius** Inspecting SoF players is now possible.

- **Derision** A mob corpse will now be left even if a Bot's pet does the most damage.

## 03/03/2010¶

- **Trevius** Added functionality to the EQEmu Web Tool to show IP information based on account searches.

- **Derision** Set Message Type for spells wearing off, experience and leadership messages so they aren't classed as 'Other' by the client chat filters.

- **Derision** Removed -fpermissive from zone/makefile so invalid type conversions should now cause an error rather than a warning for Linux compiles.

## 03/01/2010¶

- **Trevius** Added 2 new optional arguments to quest::gmsay(text, [color, send_to_world?]) * allows changing color and sending to world or just zone.

- **Trevius** Normal Saylinks should now work without requiring a target for proximity says. Silent saylinks still require a target.

- **Trevius** Added a check for valid slots when moving items from 1 slot to another.

- **Trevius** NPCs using 2 Hand Pierce weapon models can be set to skill 99 in the prim_melee_type field of the npc_types table to show the correct attack animations and messages.

## 02/26/2010¶

- **Derision** Fix for crash in Mob::DetermineSpellTargets.

- **Congdar** fixed bot right-click inspect window title bar shows player name instead of target bot name.

## 02/25/2010¶

- **Secrets** Added new Perl::Client command, ReadBook(Book Text, Type), to allow sending a book/scroll to clients via quests. Type 0 = scroll, type 1 = book.

- **Trevius** GMs with #gm on should now be able to /target NPCs across the zone again.

- **joligario** Fixed typo relating to Pet pursuit speed in MobAI.cpp

- **joligario** Manual WP Add fix.

- **joligario** Fixed duplicate declaration of command_wp in command.h

## 02/24/2010¶

- **Derision** SoF: TRADER/BUYER will now be displayed as appropriate in /who for SoF clients.

## 02/23/2010¶

- **Trevius** Added new Perl::Mob quest object SendAppearanceEffect(effect1, effect2, effect3, effect4, effect5) which can send up to 5 particle effects at once.

- **realityincarnate** spells requiring dragon/giant targets will now work on velious raid targets

## 02/22/2010¶

- **Trevius** Added 2 new fields (prim_melee_type and sec_melee_type) to the npc_types table to allow setting attack animations/messages to go with weapon models (Default is 28 * Hand to Hand)

- **Trevius** Added Perl Quest Objects; GetPrimSkill(), GetSecSkill(), SetPrimSkill(skill_type), SetSecSkill(skill_type) for altering the above setting temporarily.

Required SQL: utils/sql/svn/1259_npc_skill_types.sql

## 02/17/2010¶

- **Trevius** Added new quest::untraindiscs() command to untrain all disciplines

- **Trevius** Added Client Perl Objects UntrainDisc(slot) and UntrainDiscAll() to untrain either just 1 discipline slot or all disciplines

- **Trevius** Added functionality to quest::traindisc() to allow it to use the spell_globals table and system

- **Trevius** Added in code to prevent a zone crash related to group/raids using group recourse spells as a temporary fix until the Spells branch goes live

## 02/15/2010¶

- **Gaeorn** (iRFNA) Fixed flaw in IsPureNukeSpell() logic. Fixes bug where bots were healing enemies.

- **Derision** Added default value to suspendeduntil column in utils/sql/svn/1195_account_suspendeduntil.sql

## 02/07/2010¶

- **Derision** Reverted cross-zone group invites from Rev1086

## 02/06/2010¶

- **Trevius** Added an account status setting option to the database page of the EQEmu Web Tool.

## 02/02/2010¶

- **Richardo** Added options wep1 and wep2 to #npcedit to allow changing primary and secondary weapon models.

## 02/01/2010¶

- **Trevius** Renamed BoolNPCSpecAtks() to HasNPCSpecialAtk() to fit better into the proper naming format and to make more sense.

- **Derision** Added $client quest methods to get current PVP point and crystal counts and to award PVP points and crystals.

- **Derision** Mapped out the part of the player profile used for recording recent PVP kills.

- **Derision** Removed EVENT_WAYPOINT. Use EVENT_WAYPOINT_ARRIVE or EVENT_WAYPOINT_DEPART instead.

## 01/31/2010¶

- **Trevius** Exported new BoolNPCSpecAtks() to Perl::Mob. This can be used to check if an NPC has certain special attacks set.

- **Derision** Added support for purchasing from Discord Merchant (Class 59).

- **Derision** Added support for purchasing from Norrath's Keepers and Dark Reign Merchants (Classes 67 and 68).

- **Derision** Added commands #setpvppoints and #setcrystals 

- **Derision** EVENT_POPUPRESPONSE is now passed to player.pl

## 01/30/2010¶

- **cybernine186** Implemented the #suspend command.

Required SQL: utils/sql/svn/1195_account_suspendeduntil.sql

## 01/28/2010¶

- **gaeorn** added EQEmuLoginServer/EQCryptoAPI.h (contents from a EQEmu forum post by KLS)

## 01/28/2010¶

- **Rabayn** Fixed reference to freed memory in Doors::HandleClick.

- **Derision** Anti Kill-Stealing fix.

## 01/27/2010¶

- **Trevius** Suspend Minion AA now requires level 62 or greater to use it.

- **Secrets** Implemented quest::voicetell(PlayerName, MacroNumber, RaceNumber, GenderNumer).

## 01/26/2010¶

- **Trevius** Exported new ProjectileAnim(mob, item_id, [IsArrow?, speed, angle, tilt, arc]) command to perl::mob.

- **Trevius** Added the following to perl::NPC * GetSpawnPointX(), GetSpawnPointY(), GetSpawnPointZ(), GetSpawnPointH(), GetGuardPointX(), GetGuardPointY(), and GetGuardPointZ()

- **Derision** Leadership abilities should now work correctly for groups with 1 Player + Bots.

## 01/25/2010¶

- **Trevius** Exported CheckLoSToLoc(x, y, z, [mob_size]) to perl::mob.

- **Trevius** Exported FindGroundZ(x, y, [z_offset]) to perl::mob.

## 01/24/2010¶

- **Trevius** Exported CheckLoS() to perl::mob.

- **Trevius** Added SoF Decode/Encode for OP_InspectAnswer. SoF clients can now inspect Titanium clients and everything shows up properly. SoF clients still cannot be inspected at all by either client.

- **Derision** Fix for armor not showing to other player's after looting your corpse.

- **Derision** Call of the Hero should no longer transfer aggro to the caster.

- **LeftRoad** Implemented /pet leader command.

- **Derision** Fix for item loss when going Linkdead with items in the trade window.

- **Derision** /getguildmotd now works.

- **Derision** Fixed Bazaar search filter for Endurance, Attack, HP & Mana Regen, Haste and Damage Shield.

## 01/23/2010¶

- **Trevius** Added NPC:ReturnNonQuestNoDropItems rule to enable/disable a new feature that allows all NO DROP items to be returned if turned into a non-item-quest NPC (no EVENT_ITEM).

- **Trevius** Removed a possible exploit with quest turn-ins.

- **Derision** Added check for spell target type SummonedPet (e.g. Elemental Draw).

- **Derision** Implemented /searchcorpse GM command.

- **Derision** Reset Trade Accepted state if money is added to a trade.

- **Derision** Shrunk/Grown players/mobs will now appear the correct size to new players entering the zone.

- **Derision** OP_GuildMemberList for SoF (used to populate Guild Management Window Roster.

- **Derision** OP_GuildDemote for SoF.

- **Derision** OP_GuildPublicNote for SoF.

- **Derision** Corrected message produced when trying to use Suspend Minion on a charmed pet.

Optional SQL: utils/sql/svn/1144_optional_rule_return_nodrop

## 01/22/2010¶

- **Trevius** Adjusted quest::wearchange(slot, texture) so it will now show the weapon slot changes to players who zone in after the change has already happened.

- **Derision** Implemented Secondary Forte AA.

## 01/21/2010¶

- **Trevius/Andmetal** Added new Spell Globals system. Adding spells to the new spell_globals table with a qglobal name and value there will require characters to have the matching qglobal in the quest_globals table in order to scribe spells via the quest::scribespells command. Note: Only integers can be used for values currently.

- **Trevius** Added EnableSpellGlobals rule to enable/disable the new Spell Globals system.

- **Trevius** Minor change to how NPC loot tables are handled for selecting drops. This should make actual drop rates a bit closer to how they are set in the database.

- **WildcardX** Implemented a new client animation rate to server-side speed ratio for bots to make bot movement as precise and natural looking as possible. It is possible all other Mob's could benefit from this same tuning if anyone wants to try it on their server.

- **WildcardX** (Frumph) Implemented a new set of #bot commands to customize bot appearances within the game!

- **WildcardX** (Frumph) Fixed so bot spell casters don't ghost while casting a spell with a long cast time and bot casters don't sit while a spell is being casted.

- **WildcardX** Fixed bot casters from doing rapidly and repeatidly going from sit to stand and back to sit during buff casting.

Required SQL: utils/sql/svn/1136_spell_globals.sql

## 01/20/2010¶

- **Trevius** Added quest::wearchange(slot, texture) to allow any slot to be changed to any texture/weapon model. This works just like the #wc , command.

- **blmille2** Implemented Calliav line of spells.

- **Derision** Reverted flawed change to client_packet.cpp.

## 01/19/2010¶

- **WildcardX** Tweaked bot spell healing ai to improve general group healing.

- **WildcardX** Fixed a zone crash caused by adding an non-existent mob to a bot's hate list.

- **blmille2** Implemented Suspend Minion and Persistent Minion AA.

- **garim12** Mastery of the Past AA Ranger/Beastlord version fix.

- **WildcardX** Added new command, #distance to return the in game distance between you and your target.

- **WildcardX** Bot casters will now stay in ange to cast heals and other spells during combat.

## 01/18/2010¶

- **WildcardX** Potential bug fix for #bot camp zone crash bug. Continued work on bot animations. (thanks much to Frumph and Secrets for their assistance)

- **joligario** New EVENT_WAYPOINT_ARRIVE and EVENT_WAYPOINT_DEPART. The old EVENT_WAYPOINT will be removed shortly, so be sure to replace all occurences of EVENT_WAYPOINT with EVENT_WAYPOINT_DEPART in all your current scripts.

- **joligario** Faction values of zero are no longer written to the faction_values table.

- **WildcardX** Smoothed out bot melee animations. Another attempt at isolating the #bot camp zone crash bug.

## 01/17/2010¶

- **WildcardX** More bot ai refactoring that is focused on making the bot movements more smooth and accurate. Still a lingering issue when bots fight a mob that has a giant body type.

- **WildcardX** Bots in melee range of their target will now seperate themselves some so they won't appear so much on top of each other in combat. "Tank" classes will always be closer than "DPS" classes.

- **WildcardX** Fixed a issue with bot pet hitpoints not persisting correctly to the database and an issue that prevented the client from getting all HP updates for bots and their pets.

## 01/15/2010¶

- **Derision** Added check in Handle_ApplyPoison to verify the specified inventory slot contains a poison in case the player moved items around after beginning to apply the poison.

- **Derision** Fixed a bug where Mend would not report failures for skill levels below 75.

## 01/15/2010¶

- **WildcardX** Refactored the general bot ai logic. It appears I have bots properly showing their run animations and bots will now stand before they cast a spell. Because I touched soo much bot ai code, this rev should be evaluated fully before implementing on a public play server. I may decide to revert this rev of the bot code if it proves too unstable.

## 01/14/2010¶

- **WildcardX** Fixed a bug in the EQEmuLoginServer that resulted in the server not processing login requests because the application's connection to its MySQL database engine was closed. I have implemented an auto reconnect feature of the MySQL client api.

- **WildcardX** Cleaned up a couple compiler warnings for EQEmuLoginServer.

- **WildcardX** Refactored some code that worked fine on a Windows OS, but was incompatible with a Linux OS. New code is compatible with both operating systems.

## 01/13/2010¶

- **WildcardX** Implemented auto melee or archery weapon selection for the bot ranger if the bot ranger is level 61 or better and the bot owner toggled the #bot archery command. After toggeling once, the bot then decides on archery or melee until the #bot archery command is toggled again or the bot zones or camps.

- **WildcardX** Fixed a bug that prevented bots from being created on systems running MySQL on a linux OS. Windows MySQL servers were unaffected.

- **WildcardX** Enchanter bots will no longer cast any illusions as part of "buffing". In the near future, I will implement a new #bot command to cast illusions instead.

- **WildcardX** Fixed a bug that prevent enchanter bots from casting any damage over time or nuke spells against their target.

- **WildcardX** Fixed a bug that caused bots to "ghost" as they followed their client owner.

## 01/12/2010¶

- **WildcardX** Implemented a bot spellcasting ai overhaul that improves upon the existing ai and creates a framework to expand additional ai enchancements around for bot coders. NOTE: Please evaluate this version of bots BEFORE you replace your existing server as this is still a work in progress.

- **WildcardX** Implemented bot wizard nuke spell selection for the new bot spellcasting ai.

- **WildcardX** Fixed various bugs to now allow any characters except the bot owner to give bot commands or spawn the bot. Also fixed #bot mana command to filter out non-caster bots.

## 01/10/2010¶

- **Derision** /invite can now be used to invite a player in another zone into a regular group.

## 01/09/2010¶

- **Derision** Changed Client::GroupInvite2 to use the Invitee name passed in the OP_GroupInvite packet rather than the player's target.

## 01/08/2010¶

- **WildcardX** Fixed a bug that allowed a bot to be created with the same name as an existing player character. This would cause said bot to not zone with other bots the group.

- **WildcardX** Added new bot command, #bot mana. This will give a mana report for all spawned bots in the zone. Bot mana report spamming is now disabled.

## 01/07/2010¶

- **WildcardX** Fixed a EQEmuLoginServer crash that can happen as the result of a null reference in the database code.

- **WildcardX** Fixed a bug with bot archery. The command shouldn't crash the zone and the bot should correctly display the bow only.

## 01/06/2010¶

- **WildcardX** Fixed a bug that prevented Bot casters from casting if a mob becomes enraged.

- **WildcardX** Changed #bot list and #bot spawn commands to use bot name instead of the bot table id

- **WildcardX** Added new commands to save, load, delete and view bot groups. See the #bot botgroup help command to view them.

- **WildcardX** Fixed SQL syntax issues with database scripts for bots.

- **WildcardX** Fixed a bug that may have made it difficult to add bots to bot only groups.

1077_botgroups.sql

## 01/05/2010¶

- **WildcardX** Fixed the EQEmuLoginServer project file, fixed a crash caused by referencing a NULL object and made a couple improvements to error handling.

- **Derision** Fix for quest::depopall related crash.

- **WildcardX** Improved healing for Bots inspired by contribtions from Bad_Captain! Bot healers won't let a HoT spell block them from casting a heal spell when in combat.

- **WildcardX** Bot pets will now seek to engage their target's from behind when their Bot master's are fighting the same mob from in front.

---

## 2011

*Source: changelog/server/2011/index.html*

# 2011¶

## 12/12/2011¶

- **Trevius** Pets set to a petpower of -1 in the pets table will scale stats to the petpower like they used to.

## 12/11/2011¶

- **Bad_Captain** Fixed hatelist/aggro bug I introduced in rev 2087 causing NPCs to attack the closest client instead of the top of their hatelist.

- **Bad_Captain** Updated some live opcodes for EQExtractor.

## 12/06/2011¶

- **Leere** Added IsFromSpell to Attack() to allow its use from spell effects. This allows the Rampage AA to actually hit mobs again.

- **Leere** Added a rule for the minium hasted delay that can be reached for weapons. Default set to 400 based on best guesses from the Moss-Covered Twig tests posted on the net.

- **Congdar** (ptarp)compile warnings in windows

- **Bad_Captain** Fixed Enchanter's Mezmerization AA * it was extending buffs 35%, now extends mez spells by 1 tick / rank.

- **Bad_Captain** Fixed NPC aabonuses issue(s) * NPCs were trying to access nonexistent aabonuses within combat code (hatemod as an example)

- **Bad_Captain** Temporary Fix on crash due to non-player spell proc from Monster Summoning Pets until I can figure out the cause.

- **Bad_Captain** Bot changes / fixes including maintaining HP & Mana after camp/zone/death, ability to maintain aggro over clients, taunting toggle command (#bot taunting [on|off]), delay death AA, and others. Please see http://www.eqemulator.org/forums/showthread.php?p=205139#post205139 for all Bot changes.

Required SQL: 2087_required_bots_hp_and_mana_and_spell_updates.sql

## 12/05/2011¶

- **Trevius** Crash fix for trying to zone into a flagged zone without having the flag.

## 12/04/2011¶

- **Secrets** Added QueryServ for VS2010 x86/x64. QueryServ allows queries to be sent to it for use on an external database, through the means of packets.

Currently, the only thing it logs is a #command input, but that will be expanded onto soon. A suggestion for our developers would be to move any statistic logging stuff (hackers table, eventlog, etc) over to it eventually

to save processing power on the main executable's machine. This will allow for things like discovered items to work a bit more better resource-wise.

- **Akkadius** Added #advnpcspawn setversion (version#) * This will change the instance version in which the targeted NPC resides in

- **Akkadius** Added #npcedit setanimation (stand, sit, crouch, dead, loot (0-4)) so that setting animations are much easier. This also makes animations much more reliable setting them with the spawn packet rather than through Perl.

- **Akkadius** Added /MP switch to VS2008 so that it will compile with multiple processors

- **Akkadius** Fixed compiles for VS2008 from the Queryserv commit

- **Secrets** Added #qtest , which will populate the remote database through QueryServ with information as a test only. Requires 255 status by default.

- **Trevius** LDoN points are now capped at 2,000,000,000 instead of ~16,000, and no longer roll back to 0 if they exceed the cap limit.

Reccomended SQL: (ON QueryServ's database, NOT the main db) utils/sql/queryserver/2079_queryserver.sql

## 12/01/2011¶

- **Secrets** v90 toolset bugs reported on forums. In order to use Perl 5.14, you MUST upgrade to VS2010 (preferrably ultimate), if you do not have vs2010, it will default to Perl 5.10 and you will be unable to use the much more stable Perl 5.14, an upgrade is reccomended.

- **Secrets** Fixed Windows x64 rulesys bug where it would store them as an x64 version of an int (long long) and mess up the ordering of pointers, resulting in certain rules not loading properly.

NOTE: For those having issues compiling vs2010, there will be a guide up shortly to help you set up your dev environment. In the meantime, make sure your "Additional Include" and "Additional Library" paths

are correct and pointing at the right location. Failure to do so will result in mysql header/lib and perl header/lib issues. If you are looking for zlib x64, it's in SVN.

## 11/30/2011¶

- **Secrets** Implemented Visual Studio 11 and Visual Studio 10 project/sln files.

- **Secrets** Added x64 configuration settings to VS11 and VS10 project files/SLN files.

- **Secrets** Changed WIN32 define to _WINDOWS across the board. In the case where WIN32 is needed over WIN64 (ie; assembly references) there is still WIN32 defines and a new WIN64 define.

- **Secrets** Upgraded ActiveState Perl lib define to 5.14 -* others still work but it is strongly reccomended to use 5.14 as it contains less memory leaks.

- **Secrets** Added Zlib 1.2.3 x64 to the SVN for use with the windows solution files.

- **Secrets** Fixed vs2008 project files to reflect the new _WINDOWS define

- **Secrets** Perl 5.14 Compile Fix

NOTE: Since VS11 is in beta, I only set up the debug options. You should use Vs2010 Ultimate to compile in x64 mode. NOTE2: Perl 5.14 is stable, but if you absolutely need to use 5.10, ctrl f search for "perl514.lib" and replace it with "perl510.lib" NOTE3: A forum post will be made for help with compiling Windows x64 on EQEmulator.org, it is an experimental feature but has less issues than x64 linux, imo.

## 11/28/2011¶

- **Leere** Fixed a problem with no drop items inside of bags when trading with NPCs. Pets retain buff based procs through zoning now.

## 11/26/2011¶

- **Leere** NPCs now have the ability to ignore level limits for stuns. This ability can be turned off via rule. Also added a rule for what the base stun immunity level is for spells with a max level of 0.

- **Leere** NPCs (and thus pets) are now able to equip items in non-visble slots. They will also look inside of bags that are traded to them for those items.

The pets table was expanded. It can now map to several npc IDs for the same pet type string, based on pet power. (This has replaced the old approach of letting pet power be a direct boost to NPC stats. The intention is to now have distinct npc_type table entries for the various pet power levels that a pet supports.) Pet naming and pet control was likewise moved out of code logic and to the pets table. (The default pet control is now petFamiliar rather than petOther.) Pets can now have items already equipped when summoned. The equipment sets used for that can be shared between pets and also be nested up to a depth of 5.

Pets are no longer stored as part of the profile blobs.

Pets (charmed and summoned) belonging to clients should no longer attempt to assist other NPCs if they hear a call for help.

Required SQL: utils/sql/sv/2069_required_pets.sql

## 11/21/2011¶

- **Akkadius** Implemented NPC Special Attack 'Z'. This will keep clients from being able to attack an NPC altogether similar to live.

## 11/17/2011¶

- **Congdar** Fix charms Platinum Disc and Gold Pin. You'll need updated items\CHRMGold.pl and \items\CHRMPlatinum.pl once pushed to the quest repository.

## 11/17/2011¶

- **Lerxst** Fixed crash when calculating random focus effect from an augment when the base item had no focus effect.

Also added some bulletproofing in case that isn't the only place an invalid spell id might be passed.

## 11/16/2011¶

- **Akkadius** Added the ability to specify doors/objects/ground spawns to load for all versions of the same zone regardless by setting the value to -1.

This reduces serious redundancy of copying the same data over and over for instances.

Required SQL: utils/sql/svn/2062_required_version_changes.sql

## 11/15/2011¶

- **Trevius** Potential zone crash fix for Discovered Items pointed out by Congdar.

## 11/09/2011¶

- **Trevius** Fixes for issues caused by the extra SoF+ item click checks.

## 11/05/2011¶

- **Trevius** Added extra checks for SoF+ item clicks.

## 11/01/2011¶

- **Trevius** Added Discovered Items table to track who discovered an item for the first time and when.

- **Trevius** Added new EVENT_DISCOVER_ITEM player event. It exports the item id to the $itemid variable.

- **Trevius** Added Rule Character:EnableDiscoveredItems to make item discovery tracking optional.

Required SQL: utils/sql/svn/2057_required_discovered_items.sql

Optional SQL: utils/sql/svn/2058_optional_rule_discovered_items.sql

## 10/31/2011¶

- **Leere** Changed raid leadership ability costs to match client expectations.

- **Leere** All stuns should now treat a max level of 0 as meaning level 55.

## 10/24/2011¶

- **Akkadius** Mysql CLI changes

- **Akkadius** Preliminary work to some future additions, added int32 Database::GetGuildDBIDByCharID(int32 char_id)

## 10/23/2011¶

- **Akkadius** Another memory leak in parser.cpp, NewEventList never deallocated

- **Akkadius** Reduced code checking redundancy in several places regarding functions that reference ExecWeaponProc, only valid invalid spells are checked and logged.

- **Akkadius** (Lerxst/Akkadius) Approximately 8 memory leak fixes based on findings from 'cppcheck', some found in loot, popup windows and a few other places.

- **Akkadius** (Lerxst) Various quest object fixes, sanity checks and initiator adjustments

- **Akkadius** (Lerxst) Minor trading code adjustments

- **Akkadius** (Lerxst) Logic fixes with bot code

- **Sorvani** Critical hit filter should work again.

- **Secrets** Reverted my changes.

## 10/22/2011¶

- **Derision** Underfoot: Extended Buffs should now last the correct time without needing to zone.

## 10/21/2011¶

- **Derision** Fixed rez bug.

- **Akkadius** Fixed a spell crash that has been reported on The Hidden Forest with TryFadeEffect

- **Akkadius** Fixed a spell crash with ExecWeaponProc when a spell or weapon procs a spell that does not exist, you can catch the invalid spells in your spells log if you have them enabled

## 10/20/2011¶

- **Trevius** Fix for Perl Doors GetID() command.

- **Akkadius** Mysql #command CLI * Fixed an issue where the query string was being escaped

- **Akkadius** Mysql #command CLI * Added switches -s and -h. Switch -s providing space between the select lines in a query, -h highlighting every other row to be more readable

## 10/19/2011¶

- **KLS** (lerxst2112) Client::Message memory leak

- **Trevius** Potential crash fix for MoveTo() being used on an NPC that has a grid with wandertype 3.

## 10/14/2011¶

- **Leere** More than 6 members of a raid can now receive raid experience.

- **Sorvani** Added AE Rampage message and filter

## 10/11/2011¶

- **KLS** Added Ebon/Radiant crystal reclaim for the clients I have.(Titanium/SoD/Underfoot)

- **KLS** Seperated buffs from the player profile.

- **KLS** Seperated buffs allowed me to fix the counters on buffs for the newer clients across zone lines, as well as melee and magic runes are no longer limited to 65k as they are no longer uint16s.

- **KLS** Added ability to save variables to items. Via $client->SetCustomItemData(13, "SomeVariable", 1024); #give our mainhand some variable.

- **KLS** Added ability to retrieve items from the inventory in perl with $client->GetItemInInventory(slot_id);

- **KLS** Fixed Item::IsAugmentable() to return correctly if the first augment slot is not used.

- **KLS** Updated for latest code and readded Derisions' cross-zone /inviting. I've been testing it for a while now and can't find any real issues with it so I readded it.

- **KLS** Added class and race combo's into the database so they can be potentially changed; only SoF+ clients will correctly display this.

- **KLS** Fixed a bug in WorldDatabase::GetCharSelectInfo.

- **KLS** Changed internal faction values to go in order this change will break some quests in the short term but should be more intuitive in the long run.

- **KLS** Changed player.pl loading slightly: it will now look for player quests in the following order: .\quests{zone}\player_v{instance_version}.pl, .\quests{zone}\player.pl, .\quests\templates\player.pl

- **KLS** CanClassX functions are no longer hardcoded, they will now check the skillcaps data instead.

- **KLS** EntityVariables are now identified with a string instead of an int ex: $npc->SetEntityVariable("SomeId", 5), this shouldn't break any existing quests.

- **KLS** Fixed an issue where bard songs could get stuck in the *on* position even if the bard had turned singing off.

- **KLS** Fixed an issue where merchants would load and send items more than once in cases where npcs had merchants that shared merchant_ids in a zone.

## 10/09/2011¶

- **Akkadius** Fixed an optional argument in client 'NukeItem'

- **Akkadius** Added two #npcedit commands; armortint_id and alt_currency_id

- **Akkadius** Exported $client->GetAggroCount();, this will get how many NPC's are aggroed on the client. This can also be used to determine when in combat.

- **Akkadius** Mysql ingame basic CLI to run select queries or execute queries from in-game, default account access 250, be careful when using this.

- **Akkadius** (Lerxst) Added a crash fix for spells that do not find a valid item in the database SE_SummonItem

Optional SQL: utils/sql/svn/2023_optional_mysqlcli.sql

## 10/01/2011¶

- **Trevius** Added Destructible Objects for Underfoot.

## 09/25/2011¶

- **Derision** Implemented Tune Of Pursuance AA.

## 09/24/2011¶

- **JJ** Added hacker entry for possible instant camp disconnects.

## 09/23/2011¶

- **Trevius** Destructible Objects now change damage states as they reach 75%, 50%, 25% and 0%.

- **Trevius** Added Perl Mob quest object SendUntargetable(to_client, in) to toggle the ability to be targeted.

## 09/22/2011¶

- **Trevius** Initial implementation of Destructible Objects (SoD only for now). Most of the work was done by Derision.

To Create a Destructible Object, use the 'lastname' field in npc_types to set the model (ie. DEST_DEV_TENT1), and add "o" in the 'npcspecialatks' field.

## 09/21/2011¶

- **Leere** Damage shields should no longer break root spells.

## 09/20/2011¶

- **Trevius** New rule added to allow a cap for GM skill training on specializations (default is 50).

- **Trevius** #maxskills will now only set specializations to 50 each to prevent them from all resetting to 1.

- **Trevius** GM Trainers will no longer allow training more than 1 (or 2 if you have the AA) specializations above 50.

- **Bad_Captain** Added rule for Bot AAs by expansion, bot bash fix (bots with bask/slam skill could bash regardless of weapon(s) or shield), various bot AA fixes, added a few bot AAs

Optional SQL: utils/sql/svn/2015_optional_specialization_training_rule.sql utils/sql/svn/2016_optional_rule_bot_aa_expansion.sql

## 09/12/2011¶

- **Leere** (Tabasco) Added a deque for signals received by an NPC.

- **Sorvani** Various message type fixes, most notably NPC Flurry/Enrage/Rampage and Pet Flurry/Rampage.

## 09/05/2011¶

- **Akkadius** (Akkadius/Lerxst) Fixed Beastlord 1.5 and 2.0 pet clickies.

## 09/03/2011¶

- **KLS** Added working Alternate Currency system for SoD and SoF(Untested but hopefully works).

- **KLS** Added two fields to merchantlist that allows one to filter which items are offered to players by minimum faction and minimum level.

- **KLS** Max stacks on items increased from 254 to 32767.

- **Akkadius** Modified items id cap to 200,000

- **Akkadius** Changed Perl Client Object 'NukeItem' to use the new fields implemented by KLS's Alternate Currency revision:

$client->NukeItem(itemnum, [where_to_check, 1 = invWhereWorn, 2= invWherePersonal, 4 = invWhereBank, 8 = invWhereSharedBank, 16 = invWhereTrading, 32 = invWhereCursor]); Ex: $client->NukeItem(1001, 2);

- **Akkadius** (Lerxst) Fixed Enduring Breath bot code, adjusted level requirements and added Beastlord class case.

Required SQL: utils/sql/svn/2004_charges_alt_currency.sql

## 09/01/2011¶

- **Derision** Spell resist messages now use the same MT as fizzles (for chat filter purposes).

## 08/28/2011¶

- **Bad_Captain** Rewrote Bot AAs to use aabonuses and GetAA(). Also added a few AAs.

- **Bad_Captain** Fixed Bot chance to hit. (they never missed with their primary weapon attacks, and only missed ~5% with their offhand)

- **Bad_Captain** Added WipeHateList to bot group attack, bot group follow, and bot group guard to allow target switching and keeps bots and their pets from attacking their target when you no longer want them to. (suggested by Criimson)

## 08/23/2011¶

- **Trevius** Exported to Perl Mob: SetDeltas(delta_x, delta_y, delta_z, delta_h), SetLD(value), SetTargetDestSteps(target_steps).

- **Trevius** (SuperUserJD) SpellOnTarget fix for casting beneficial spells on group members while in a raid.

## 08/21/2011¶

- **Derision** Added rule to prevent looting corpses when a player has an item on the cursor (to prevent item loss using Loot All).

- **Derision** Alcohol intoxication is maintained across zoning (can be turned off with a rule).

- **Derision** Intoxication level affects STR/STA/DEX/AGI/WIS/INT.

- **Derision** Added 'Update' button to #showstats window for SoD+ clients.

Optional SQL: utils/sql/svn/1998_optional_intoxication_and_looting_rules.sql

## 08/18/2011¶

- **Leere** Removed lore item from the restrictions for pick pocket.

## 08/13/2011¶

- **Derision** Player pets will now show their owners name. UF users can turn this off in options.

- **Derision** SoD/UF: Beneficial Pet Buffs can be clicked off in the Pet Window.

- **Derision** Underfoot: Can now click off buffs in the short buff box. Removed registraion of HoT in patches.cpp

## 08/12/2011¶

- **Bad_Captain** Fixed double class / race stats for bots.

## 08/09/2011¶

- **Derision** Underfoot: OP_ClearSurname

## 08/05/2011¶

- **Akkadius** Corrected a grammatical error with training disciplines.

## 08/04/2011¶

- **Bad_Captain** Updated Bot::MeleeMitigation to match mob version.

## 08/02/2011¶

- **Trevius** (Akkadius) Exported Freeze() and UnFreeze() to Perl Client.

## 07/27/2011¶

- **Caryatis** Added Special Attack 'p' (Makes mob immune to pacify)

- **Caryatis** Added Special Attack 'j' (Tether * returns mob to spawn point if its distance away from spawn point is greater than its aggro range)

- **Caryatis** Added Special Attack 'J' (Leash * same as Tether except heals mob to full, strips all buffs and wipes the hatelist as well)

- **Caryatis** Fixed TGB(if you cast a group buff with a corpse or an npc thats not a client's pet as target, it will use your group instead)

## 07/26/2011¶

- **Congdar** redo world container check

## 07/24/2011¶

- **Caryatis** Added support for higher level invis and see invis(eg Ethereal Invisibility & Skylight Sagacity)

- **Congdar** update check to world containers

## 07/23/2011¶

- **Congdar** (Criimson)Bot dyes (and tweaks)

- **Congdar** (lerxst2112)Bot dyes (and tweaks)

- **Bad_Captain** Fixed Bot GetAC() and GetATK() to work with #ShowStats

## 07/22/2011¶

- **Congdar** update check for Lore

## 07/17/2011¶

- **Congdar** (pfyon, Criimson)Various bot tweaks

- **Caryatis** Updated My/Showstats window.

Required SQL: utils/sql/svn/1974_required_bot_spells_update

## 07/16/2011¶

- **Trevius** Exported AssignToInstance(instance_id) to Perl Client.

## 07/14/2011¶

- **Caryatis** Implemented the Extra Skill Damage itembonus(+bash, +kick dmg)

Optional SQL: utils/sql/svn/1972_optional_extradmg_item_cap.sql

## 07/14/2011¶

- **Leere** Fix for reading books in SoF and later clients.

## 07/13/2011¶

- **Derision** OP_DisciplineUpdate for SoF and Underfoot (expanded Disc struct in UF player profile, added encode for Disc update).

## 07/12/2011¶

- **Caryatis** Added Perl Object: $mob->SetBodyType(bodytype).

- **Caryatis** Fixed issue with swarm(and wake the dead) pets where they would not despawn if they spawned as the target died.

- **Caryatis** Changed when mobs enrage to 9%(from 14%) to match live, with a rule to customize the value if wanted.

- **Caryatis** Added rule to allow matching of new live rules for enrage(it was removed from all non player-pet npcs).

Optional SQL: utils/sql/svn/1968_optional_enrage_rules.sql

## 07/11/2011¶

- **erde** FreeBSD compile fix for Rev1963 (no strncpy in FreeBSD).

## 07/10/2011¶

- **Derision** Underfoot * Support for /emote

- **Derision** Underfoot * Support for Guild Creation via new window in Underfoot.

- **Derision** SoD+ * Changing group leader should update Group Leadership AA to that of the new leader.

- **Caryatis** Live like focus effect behaviour added(Improved Damage, Healing and Reduce Manacost focus effects will now be random if the spell contains both a min(effect_base_value) and max value(effect_limit_value)

Optional SQL:

utils/sql/svn/1962_optional_guild_creation_window_rules.sql utils/sql/svn/1963_optional_rule_live_like_focuses.sql

## 07/09/2011¶

- **Derision** Underfoot * Instrument modifiers / AAs should now improve runspeed.

## 07/06/2011¶

- **Trevius** Fix for EVENT_ITEM_CLICK_CAST bugging Titanium clients.

## 07/05/2011¶

- **Trevius** Fix for EVENT_ITEM_CLICK_CAST for SoF+ clients.

- **Trevius** (Akkadius) Added new rule Console:SessionTimeOut for adjusting console session timeout.

Optional SQL: utils/sql/svn/1960_optional_console_timeout_rule.sql

## 07/02/2011¶

- **JJ** Split wander type 4 to allow depop with/without spawn timer. Type 4 is with, type 6 is without.

## 06/26/2011¶

- **JJ** Added functions to count all corpses, get corpse ids, and allow checking of items on player corpses

## 06/25/2011¶

- **JJ** (Leere) Fix for bards in reagent code

## 06/24/2011¶

- **KLS** Dest zone would buffer overflow if it was >= 16 characters, fixed.

- **KLS** Comment clean up + added EntityList::FindDoor($doorid) to perlXS

- **KLS** Fixed the PerlXS export for GetDoorByID and GetDoorByDBID

- **Sorvani** Added door object perl functions GetKeyItem(), SetKeyItem([value]), GetNoKeyring(), SetNoKeyring([value]). Example Usage: my$doorobj = $entity_list->FindDoor(6); $doorbj->SetKeyItem(10615); $doorbj->SetNoKeyring(1);

- **JJ** (Akkadius) Exported some task functions to perl.

## 06/23/2011¶

- **JJ** (Sorvani) Stop forcing client to tutorial when button not selected.

## 06/22/2011¶

- **Trevius** Added new Perl Mob quest object RemoveNimbusEffect(effectid) for removing permanent nimbus particle effects.

- **JJ** EVENT_CLICKDOOR now passes the zone version to perl.

## 06/20/2011¶

- **JJ** Added message to client when using #instance destroy command.

- **JJ** Altered doors index to include version to help bring door ids below 256 in zones with multiple versions. Required SQL provided.

Required SQL: utils/sql/svn/1946_doors.sql

## 06/19/2011¶

- **JJ** (Leere) Fixed reagent consumption oddities

## 06/18/2011¶

- **JJ** Depop with spawntimer reset option now works properly. Default use is changed to false.

- **KLS** Added some minor stuff

- **KLS** Added animation field to spawn2 that will control what the spawned npc will do at their guard point. 0 = eaStanding, etc etc

- **KLS** Tweaked books in SoF+ as they weren't displaying right; it may still not be perfect though I haven't tested it with every book in the game. Required SQL Provided.

## 06/17/2011¶

- **KLS** Lowered resolution on QuestTimer process timer to actually allow you to use sub 1 second times.

- **KLS** Added quest::settimerMS(timer, duration) to allow timers not in integer second intervals.

- **JJ** Moved ENTERZONE event for items to execute before SCALE_CALC.

## 06/15/2011¶

- **Secrets** Modified the pound command #reloadstatic to respawn doors after it despawns them.

- **Secrets** Made the default door dest zone be "NONE" for quest::createdoor's constructor

- **Secrets** Added potential fix for UCS assertion error under windows after being up for so long.

## 06/14/2011¶

- **Secrets** Opcode to remove all doors.

- **Secrets** Perl door support.

- **Secrets** Perl objects added for Doors since first PerlDoors commit: SetSize, GetSize, SetIncline, GetIncline, GetOpenType, SetOpenType

- **Secrets** Added quest::createdoor(model, x, y, z, h, [opentype], [size]) . This spawns a door similar to quest::creategroundobjectfrommodel, and can be manipulated in the same way as other doors. To save it, get the door object using $entity_list->GetDoorByID(id), as it returns an entity ID (and preliminary DBID/DoorID is stored on the object itself) upon creation of the door. otherwise the door is temporary, and does not save the stored DBID. $doorobj->CreateDatabaseEntry() saves it and its temporary DBID + DoorID.

- **Secrets** Added door object perl functions GetLockpick() and SetLockpick([value]).

## 06/10/2011¶

- **JJ** Added more tables to remove entries from when deleting character.

## 06/06/2011¶

- **Secrets** Adjusted the default value for Character:SkillCapMaxLevel. It now defaults to 75 because PEQ only has skillcaps up to 75, and if the level is higher than 75 it will always return 0, breaking skills. (layer 8 issue fix)

- **Secrets** Made stat cap adjustable via rules, Character:StatCap. The client won't be in sync but that's what #mystats is for. 0 = feature disabled, defaults to 0.

## 06/05/2011¶

- **Derision** Fixed /yell

## 06/04/2011¶

- **Secrets** Fixed pet HP resetting if the pet is above 32k when zoning.

- **Secrets** Fixed player HP rollover bug (~495k hitpoints, rarely encountered) with AAs by temporarily casting it as a float.

NOTE: the client only displays 10 million hitpoints in titanium. Keep that in mind when designing items. Only issue is displaying them, unlike the rollover bug you won't die and it will show on show/mystats.

- **Secrets** Fixed damage on weapons above 255. They only display on SoF+ clients, and Titanium will simply show a cosmetic issue (an incorrect value). You can set an item to any value up to the max for an uint32 and it will work.

- **Secrets** Added rules for the low-level damage cap. There is a rule for the pre-10 cap, and one for the pre-20 cap. Defaults to 20 and 40 respectively.

REQUIRED: You will have to recompile sharedmem with this update. Items will fail to load otherwise.

## 05/31/2011¶

- **Trevius** Added EVENT_CLICK_OBJECT to player quest events. It exports variable $objectid which holds the entity id of the clicked object.

## 05/29/2011¶

- **Secrets** (Akkadius) Added quest::createguild(name, leader) for creating a brand new guild.

## 05/28/2011¶

- **Trevius** Added quest::getguildnamebyid(guild_id) for getting a guild name from the guild ID.

## 05/25/2011¶

- **JJ** Implemented Arcane Tongues research AA. Chance for research success increases for each rank (10, 25, 50).

- **JJ** Implemented New Tanaan Crafting Mastery tradeskill AA. Each rank allows an additional tradeskill above 200.

Note: For servers with players who have tradeskills already above the limit without previously purchasing these AAs will freeze the chance to increase until they purchase the proper amount of NTCM AAs.

## 05/24/2011¶

- **KLS** Changed Mob::NPCSpecialAttacks(atk, perm) to Mob::NPCSpecialAttacks(atk, perm, [reset = 1], [remove = 0]).

This should allow one to add and remove flags individually without having to reset everything each time.

ex:

$npc->NPCSpecialAttacks(RQ, 0); //would enable the npc to rampage and quad.

$npc->NPCSpecialAttacks(S, 0, 0); //Would enable the NPC to summon as well as rampage and quad by telling it to set S but don't reset the earlier flags.

ex: $npc->NPCSpecialAttacks(RQS, 0); //would enable the npc to rampage, quad and summon. $npc->NPCSpecialAttacks(S, 0, 0, 1); //Would enable the NPC rampage and quad by telling it to set S but don't reset the earlier flags and also remove the flag being set.

## 05/23/2011¶

- **JJ** (Akkadius) Fixed camera shake usage output.

## 05/22/2011¶

KLS and Co: -All liquid should count for skill ups. -Finished unified quest interface... this is fairly large and will probably have a few problems here and there; report them to me and ill fix them asap. The goal behind the system is to allow more than one scripting system to work at a time (though with limited interaction due to pre-existing implementation limitation). This was a feature requested by the Dalaya community as they plan to merge back to the eqemu codebase and clients but are stuck with an old parser and thousands of files that can't be realistically rewritten in a short time frame.

## 05/20/2011¶

- **JJ** Doubled buffer for tradeskill search when using experiment mode. Outputs message in error log when matches exceed buffer.

## 05/17/2011¶

- **JJ** Changed tradeskills to distinguish world containers in multiple recipe matches. Split invalid container vs. non-unique recipe error log entries. Allowed server to select first match for duplicate recipe contents.

## 05/16/2011¶

- **JJ** (Zothen) UCS message logic fix.

- **JJ** (Zothen) Learning basics clean name fix.

## 05/09/2011¶

- **KLS** (lerxst2112) *nix compile fix.

- **KLS** Added #picklock #sensetrap and #disarmtrap for LDoN traps since they still don't work quite right on the newer clients because we don't implement destructable objects yet.

## 05/08/2011¶

- **Congdar** (Timothy_nonax) Add Bot Command ( #bot pull )

## 05/03/2011¶

- **Trevius** (Vaion) Fix for focus effect decay over max level.

- **Trevius** (Zothen) Crash fix for UCS.

- **Trevius** Rule added for Skill Caps Max Level to resolve issues with servers that have Chars over level 75 after Rev1875.

Optional SQL: utils/sql/svn/1889_optional_skill_cap_rule.sql

## 05/02/2011¶

- **Secrets** Added OP_CameraEffect for Titanium.

- **Secrets** Added **commands* #reloadallrules, #reloadrulesworld, and #camerashake. These default to

- **Secrets** Added optional "global" flag as item 5 in the $mob->CameraEffect() quest object. This does #camerashake, but in quest form.

- **Secrets** #reloadallrules reloads rules in every single zone plus world. #reloadrulesworld reloads the rules in world only.

- **Secrets** #camerashake shakes the camera in every zone with required args intensity and duration.

## 04/24/2011¶

- **Trevius** Added new Perl Mob quest objects GetItemHPBonuses() and GetSpellHPBonuses().

## 04/17/2011¶

- **Secrets** Converted PVP flags to be a variable, as there are other PVP rulesets embedded in the client. These will need code support to work properly. (IsAttackAllowed specifically.)

- **Secrets** Enabled Firiona Vie ruleset as an option. This disables OOC, makes languages hard to understand between races (somehow), and disables no-drop. If set to 2, this rule will only affect GMs, allowing players to be traded no-drop items from GMs. Player-to-Player trades are still considered active hacks, and are still detected.

- **Secrets** Made a rule to toggle the GM Petition Window in titanium. You will need the guide petition files for that client, and it still needs code support to work. (find these yourself.)

- **Secrets** Added expansion settings to the rule_values table instead of the variables. The PVP settings will also be here now, too. (See Optional SQL with this update.)

- **Secrets** Fixed an issue pointed out by Trevius in the previous commit.

Optional SQL: utils/sql/svn/1885_optional_rules_fv_pvp_expansions.sql

## 04/13/2011¶

- **BadCaptain** Bot spell update* Group Heals, debuff spells, spell recast timers, healing AI tweaked, bot bards can now have more than one song active

Optional SQL: utils/sql/svn/1884_optional_bot_spells_update.sql

## 04/12/2011¶

- **Trevius** The mana regen portion of bard songs is no longer affected by instrument mods.

- **Trevius** (scruffy) Identified opcodes for /zone and petition queue on Titanium.

## 04/06/2011¶

- **Derision** Underfoot: Corrected OP_CompletedTasks.

## 03/30/2011¶

- **Trevius** Implemented spell formulas 1001 to 1998. They subtract/add values by increasing amounts each tick based on the formula * 1000 value.

## 03/23/2011¶

- **JJ** (Danyelle) Face fix for Iksar Beastlord pet.

## 03/21/2011¶

- **JJ** (Jaekob/Danyelle) Texture fix for Iksar Beastlord pet.

## 03/11/2011¶

- **Trevius** Skill caps now use the MaxLevel rule for deciding max level of skill caps instead of being hard capped at level 75.

- **Trevius** All spells can be blocked in a zone by setting a spell id of 0 in the blocked_spells table.

- **Trevius** If a zone has all spells blocked by setting spell id 0 in blocked_spells, any additional spells added for that zone will become exceptions and be allowed.

- **Trevius** Reverted Sorvani's swarm pet change from Rev1872 due to some bugs it caused for normal pets.

## 02/24/2011¶

- **Trevius** Power Source slot can now be augmented.

- **Trevius** Corrected spell formula 122 (Splurt) and implemented the reverse splurt (Ex. Corath Venom) where damage reduces each tic.

## 02/22/2011¶

- **gaeorn** (sorvani) fix to make swarm pets not be targetable as NPCs

## 02/19/2011¶

- **Trevius** Added variable export $slotid to EVENT_ITEM_CLICK and EVENT_ITEM_CLICK_CAST, which exports the slot id of the item that triggered the event.

## 02/18/2011¶

- **Trevius** Fixed a potential crash in TrySpellOnKill().

- **Derision** Underfoot: Bard instrument modifiers now show (as focus effects) in the item stats window.

- **Derision** Allowed fishing in 'VWater' (Region type 7) on the basis this is the only type of water in Sleeper and you can apparently fish there.

## 02/17/2011¶

- **Derision** Fixed bug in GetZoneForage where generally only the first three zone specific items could actually be foraged.

- **gaeorn** (sorvani) fix for bard pacify songs

## 02/13/2011¶

- **Trevius** Finalized implementation of Item Faction Mods. The bonuses now remove if the item is unequiped.

- **Trevius** Added Rule Character::ItemCastsUseFocus * If true, this allows item clickies to use focuses that have limited max levels on them

- **Derision** Handle Spell duration formula 15 (for Distillate of Skinspikes).

Optional SQL: utils/sql/svn/1859_optional_item_casts_use_focus_rule.sql

## 02/11/2011¶

- **Trevius** Implemented item faction modifier stats (i.e. factionmod1, factionamt1).

- **Trevius** Added Power Source slot to item stat (charm) scaling.

- **Derision** SoD+: Fixed bug when looting items from last two inventory slots (commonly seen when using Loot All).

- **gaeorn** only send hp/mana/endurance updates to group members when in raid instead of entire raid

## 02/10/2011¶

- **JJ** (c0ncrete) Fixed shared bank database query to match schema.

## 02/08/2011¶

- **Trevius** Replaced most uses of strncpy with strn0cpy for consistency and stability.

- **Trevius** Increased zone name loading to 32 characters for doors.

Required SQL: utils/sql/svn/1847_required_doors_dest_zone_size_32.sql

## 02/07/2011¶

- **Derision** SoD/UF: /makeleader and changing Group Leader via Roles works.

- **Derision** If the leader of a group of exactly 3 members quits, leadership should now be transferred to another member.

## 01/30/2011¶

- **Caryatis** Stability fixes for Mystats window.

## 01/26/2011¶

- **Derision** Support for door opentype 57 (instant intra-zone portals which don't require the client to click, such as in the bazaar).

Note: For opentype 57, the client automatically sends the click when the player moves onto the portal.

Optional SQL, to set the bazaar portal discs to type 57 (they are type 58 in the PEQ database, but collects show they should be type 57):

update doors set opentype = 57 where zone = 'bazaar' and name = 'PORTAL_DISC';

## 01/24/2011¶

- **Trevius** Exported GetFreeSpellBookSlot(start_slot=0) and GetSpellBookSlotBySpellID(spell_id) to Perl Client.

- **Trevius** Fix for potential crash with EVENT_ITEM_CLICK.

- **Trevius** (Secrets) Identified OP_SpellEffect for Titanium.

- **Congdar** bad_captain: more Bot Updates / Fixes V 2.0

## 01/22/2011¶

- **Congdar** fix stack buffer overflow

## 01/20/2011¶

- **Congdar** bad_captain: Bot Updates / Fixes V 2.0

## 01/18/2011¶

- **Trevius** Changed Perl NPC AddItem(itemid, charges, slot = 0) to AddItem(itemid, charges = 0, equipitem = true) since slot was unused anyway.

- **Trevius** Added equipitem option to quest::addloot(item_id, charges = 0, equipitem = true).

## 01/16/2011¶

- **Caryatis** Fix for Phantom line of discs not working.

- **Caryatis** Fix for buffdurationformula 5(0 value results in a 3 tick spell, was set to 1 tick).

- **Caryatis** Fix for discs(and AAs) setting a reuse timer if used while not able to(ie stunned)

- **Caryatis** Implemented SE_VoiceGraft

- **Caryatis** Added scaling for pet focus items based on the pet power in the spell file.

## 01/15/2011¶

- **Caryatis** Fix for fear effects not fading when the buff does, also added check so that a negative recast is not set with SE_ReduceReuse

## 01/14/2011¶

- **Trevius** (l0stmancd) Fix for invalid slot move warnings on SoF+ clients.

- **Trevius** (l0stmancd) Fix for potential item loss issue while using an inventory augmentation sealer.

- **Trevius** Adjustment to the augmentation code logic to remove potential issues.

- **Trevius** Added updateclient option to Perl Client TakeMoneyFromPP(copper, updateclient=false).

- **Derision** UF: Translated command code for /pet hold

- **Caryatis** Implemented SE_ReduceReuseTimer(epic 1.5/2.0 focuses, sof type3), SE_BlockNextSpellFocus(chance to block next spell matching focus)

- **Caryatis** Implemented SE_SetBodyType, SE_SpellOnDeath, SE_BlockSpellEffect, SE_Leap, SE_ImmuneFleeing, SE_AddMeleeProc

- **Caryatis** Delay Death AA is now functional(optional sql).

Optional SQL: utils/sql/svn/1823_optional_delay_death.sql

## 01/13/2011¶

- **JJ** (Leere) Exported quest::LearnRecipe(recipe_id) to PERL

## 01/12/2011¶

- **gaeorn** possible fix for some short duration buffs (bard songs) fading one tick early

- **Caryatis** Changed SE_NoCombatSkills to SE_CombatSkills(0 = spells only, 1 = discs only)

- **Caryatis** Implemented SE_SpellDurationIncByTic(formerly SE_FocusCombatDurationMod), it adds tics to spells/discs

- **Caryatis** Added support for Special Attack 'Y'(Ranged Attack), so when an NPC can't reach or summon his target, he will use range if able to

- **Caryatis** Implemented SE_Forceful_Rejuv(refreshes spell gems), SE_HealFromMana, SE_ManaDrainWithDmg, SE_EndDrainWithDmg

- **Caryatis** Implemented SE_LimitHPPercent, SE_LimitManaPercent, SE_LimitEndPercent(limit you to a certain % while you have the buff)

- **Caryatis** Implemented SE_SwarmPetDuration(swarm pet focus)

- **Caryatis** Res Timer changes have been reverted temporarily.

Optional SQL: utils/sql/svn/1817_optional_npc_archery_bonus_rule.sql

## 01/11/2011¶

- **gaeorn** fixed lull max level check to account for no max level

- **Caryatis** Change to Doppelganger NPCID due to PEQ's next rev already using the IDs.

- **Trevius** Added quest::stopalltimers() to allow stopping all current timers on an NPC at one time.

- **Trevius** Added option to stop all timers when using #reloadquest by adding any argument after the command (ie. "#reloadquest 1"). Also added new #rq alias for the command.

Required SQL: utils/sql/svn/1813_required_doppelganger_npcid_change.sql

## 01/09/2011¶

- **Caryatis** Viral spells are now supported(field191 determines how many targets it will spread to and field 192 determines how often(in seconds)).

- **Caryatis** Lull spells will now only work on the levels they were intended to.

- **Caryatis** Corpses now have a res timer(like live). You may res a corpse as many times as you want however you will only recieve exp for the first.

Optional SQL: utils/sql/svn/1809_optional_rules.sql

## 01/08/2011¶

- **Caryatis** Implemented Target's Target(target type 46). Places effect on your target's target(ie cast with mob as target but spell lands on mob's target)

## 01/05/2011¶

- **Trevius** Changed xpreward field in the tasks table to be signed so it can display negative values for the level based experience rewards.

- **Trevius** Tasks now show item links in Task Rewards correctly for all clients.

- **Trevius** Tasks now reward any set Experience and/or Coin even if the rewardmethod is set to 2 (perl quest).

- **Caryatis** Mobs now summon starting at 97%, not 94%(like live).

- **Caryatis** Charmed pets can no longer summon mobs from out of their LoS while charmed.

- **Caryatis** All fixed duration charm spells now have fixed duration instead of only 2 that were supported.

- **Caryatis** SpinStun effects now work on mobs up to the max level that the spell denotes(previously limited to 55 regardless of spell info)

- **Caryatis** SpinStun durations have been changed to be pulled from the effect_value, instead of buff duration(which stopped alot from working), also spins mobs now

- **Caryatis** Implemented SE_Fearless(Valiant Companion), SE_AntiGate(Translocational Anchor), SE_DispelBeneficial(various spells and clicks)

- **Caryatis** Implemented SE_IncreaseBlockChance, SE_CurrentEnduranceOnce, SE_CurrentManaOnce, SE_AEMelee(duration rampage)

- **Caryatis** Persistent Casting AA is now functional(required sql)

- **Caryatis** Rampage(-) and Destructive Force(+) have changed, the duration on both has been altered based on the live spell info(required sql)

- **Caryatis** Flurry will no longer hit the highest on hatelist, it will hit the mobs current target like live(fixes rooted flurrying mobs).

- **Caryatis** Updated spdat.h with current status of all spell effects

- **Caryatis** Reorganized spell_effects.cpp to remove alot of the clutter of effects handled elsewhere

Required SQL: utils/sql/svn/1803_required_tasks_xpreward_signed.sql utils/sql/svn/1804_required_ae_melee_updates.sql

## 01/04/2011¶

- **Trevius** (l0stmancd) BagType 53 can now be used as an Augmentation Sealer from inventory.

- **Caryatis** Implemented SE_Doppelganger(Doppelganger AA is now functional)

Required SQL: utils/sql/svn/1802_required_doppelganger.sql

## 01/03/2011¶

- **Caryatis** Implemented SE_GravityEffect(424)

- **Caryatis** Added rule for endurance to be included in rest regeneration

Optional SQL: utils/sql/svn/1799_optional_rest_regen_endurance_rule.sql

## 12/11/03¶

- **LethalEncounter** Added Archery in for pvp.

- **LethalEncounter** Fixed a throw bug.

- **LethalEncounter** Fixed char select colors not matching your colors in game.

## 11/11/03¶

- **Doodman** Fixed zone crash in CheckCloseArrgo() during assist checking based on

flawed if logic.

## 11/11/03¶

- **LethalEncounter** Fixed Stamina issues.

## 10/11/03¶

- **Trumpcard** Lots of performance improvements to combat code/AI code. Streamlined several calls, and found and removed unneeded calls

```
` in MobAI that were causing serious bottlenecks. Went through and caught a few memory leaks, and converted
 many deletes to safe deletes.
`
```

---

## 2012

*Source: changelog/server/2012/index.html*

# 2012¶

## 01/01/2013¶

- **Uleat** Fixed the wear change issue where the server was not translating the SoF, SoD and UF clients' update request properly.

- **Uleat** Fixed the non-clickable quest reward bug triggered when the item was in a container and the player traded the item or zoned.

- **Vaion** RoF: Found Opcode for Item Previews. Made base packet support so that Item Preview (Alt+Right Click) works. Still a few issues to hash out.

## 12/31/2012¶

- **Derision** RoF: Added encode/decode for BlockedBuffs and OP_FindPerson. Added opcodes for FindPerson and RestState

- **Derision** RoF: Found XP/AAXP in the PP. Updated OP_ExpUpdate/OP_LevelUpdate.

## 12/30/2012¶

- **Derision** RoF: Did some work on buffs & buff removal. OP_SetChatServer2 for UCS. Encode for OP_HPUpdate

## 12/29/2012¶

- **Derision** RoF: Added Leadership AA into the PP. Few opcodes to make Track work.

- **Derision** RoF: Some spell related opcodes and PetCommands struct update.

- **Vaion** RoF: Fixed OP_PetCommands and OP_TargetCommand to correct opcodes. Identified OP_Jump.

- **Vaion** Fix for an issue with attuneable augments and an issue in guild bank.

- **Sorvani** Fix for pets causing a crash. Do not set rule > 25!

- **Trevius** RoF: Corrected wearchange packet structure.

- **Trevius** RoF: Added new arguments to #wc ( #wc [wear slot] [material] [ [hero_forge_model] [elite_material] ] ) * Example: "#wc 1 5 6"

- **Trevius** RoF: Hero's Forge Robes can now be used with #wc by using wear slot 7 * Example: "#wc 7 6 11"

- **Akkadius** Guild Bank crash fix, checking for valid items before going through the iterator

REQUIRED SQL: utils/sql/queryserv/2340_required_maxbuffslotspet.sql

## 12/28/2012¶

- **Derision** RoF: Found GM and PVP flags in PP.

- **Derision** RoF: Found endurance & some group/raid leadership stuff in PP.

- **Sorvani** Restricted pet buffs to 25. could be made a rule when/if the extpp gets changed to handle it.

- **Sorvani** Changed a few more VS2010 projects to build as $ProjectName

## 12/27/2012¶

- **Sorvani** Removed #PRAGMA statements around OP_CharacterCreate from patch files now that real problem with RuleI is resolved.

- **Derision** RoF: Found more of the Spawn_Struct bitfield values.

## 12/24/2012¶

- **Akkadius** Fixed an issue where quest::createdoor would return a door id of 0 when doors exist with version -1 (All Zones)

## 12/23/2012¶

- **Trevius** RoF * Fixed the item struct so items can be loaded properly.

- **Trevius** RoF * Added back all of the opcodes that were previously identified and a few more.

- **Derision** RoF * Commented out lots of Guild opcodes that were causing crashes.

- **Derision** RoF * Updated RequestClientZoneChange struct and encode. Altered default Bitfields setting to only apply tyo NPCs

- **Derision** RoF * Updated RoF.cpp to remove all the warnings in a Linux compile

## 12/22/2012¶

- **Secrets** Fixed the x64 portability issue reported by Akkadius. No idea how long this has been broke but at least it's fixed.

## 12/21/2012¶

- **Sorvani** Items with zero charges remaining and located in a bag will no longer get set to MaxCharges when looted from a corpse. Round 2.

- **Sorvani** (Hateborne) copy paste issue in Mob::TryDivineSave corrected

- **Trevius** RoF * Fixed the Character Select Struct, which should prevent an error when trying to enter world on certain characters.

- **Trevius** RoF * Character Creation is now functional.

- **Trevius** RoF * Identified more fields in the Player Profile and added the correct checksum so the current packet should work (thanks Derision).

- **Trevius** RoF * Added the opcode for max characters to allow up to 10 chars to be created per account instead of 0 (thanks Noport).

- **Trevius** RoF * Fixed Drakkin Appearances at Character Select. Appears that all facial/body features are now perfectly aligned.

- **Uleat** QueryServ player trade log code is now enabled. Set the rules_value to true to enable logging.

REQUIRED SQL: utils/sql/queryserv/2304_qs_playertradelog.sql

## 12/20/2012¶

- **Akkadius** Changed maxlevel default value and value for lootdrop_entries, this is a thing more affecting servers with higher than 127 so this doesn't affect many people.

OPTIONAL SQL: utils/sql/svn/2300_optional_loot_changes.sql

## 12/19/2012¶

- **Trevius** RoF * More work on RoF Structs and added the Client Version stuff.

- **Trevius** RoF * Removed/Disabled most opcodes until we are further along and then I will add them all back in and populate the rest.

- **Trevius** RoF * Added a new packet dealing with membership status, but it may need more work.

- **Uleat** Added inspect message functionality for SoF+ clients.

- **Uleat** Added bot command #bot setinspectmessage (use #bot setinspectmessage help)

REQUIRED SQL: utils/sql/svn/2299_required_inspectmessage_fields.sql

## 12/18/2012¶

- **Lerxst** Added the RoF.cpp files to the patches folder of the project for the vs2008 people.

## 12/17/2012¶

- **Sorvani** Added the RoF.cpp files to the patches folder of the project for the windows people.

- **Akkadius** Added EntityList::GetDoorsByDoorID(int32 id) which is exported to Perl $entity_list->GetDoorsByDoorID

- **Akkadius** Added Door Class object $Door->GetDoorID(); to return the obvious Door ID for the entity

## 12/15/2012¶

- **Trevius** Initial addition of the RoF client. Currently disabled by default. Uncomment the 2 RoF lines in common/patches/patches.cpp to enable the client.

## 12/13/2012¶

- **Sorvani** (Uleat) Player Inspect works for Titanium users again. Spell casting from a clicky effect checks that the item is still in the slot it was cast from before applying the affect and removing the charge (if applicable).

## 12/08/2012¶

Secrets/ **Akkadius* Implemented the customary ability to scale an NPC's spell damage or healing % by a modifier loaded from the npc data in npc_types This will allow an NPC to do for example 150% of the damage of their damage spells if spellscale is set to '150' 'healscale' field needs to be set to affect heals in a similar manner Both of these can also be accessed via ModifyNPCStat through 'healscale' and 'spellscale'

REQUIRED SQL: utils/sql/svn/2283_required_npc_changes.sql

## 12/06/2012¶

- **Secrets** Fixed OP_PVPStats in HoT to the proper opcode, OP_WebLink. You can use $client->SendWebLink("website"); in perl to use this functionality to pop open a web browser ingame.

## 12/05/2012¶

- **Akkadius** Ability to send signals through the Telnet console to character: signalcharbyname 

## 12/04/2012¶

- **Sorvani** (Uleat) Update to inspect (SoF+) and corpses to related to handling power sources. Titanium inspect still broken.

- **Vaion** Renamed the rule for targeting swarm pets so that it make sense with the code.

OPTIONAL SQL: utils/sql/svn/2280_optional_rule_targetableswarmpet-rename.sql

## 12/3/2012¶

- **Vaion** New rule created for handling whether swarm pets are targetable or not. Set to false for default to allow targeting swarm pets.

OPTIONAL SQL: utils/sql/svn/2278_optional_rule_targetableswarmpet.sql

## 12/2/2012¶

- **Secrets** Pets can no longer proc from any hand other than their primary hand. This fixes an issue where beastlord pets could proc two, three or four from dual wielding/double attacking pets (as well as a general mechanics fix).

- **Secrets** NPCs will no longer attempt to heal through walls. There is now a LOS check for friendly NPC heals through walls. This was especially apparent in the PEQ database in Splitpaw, where you could have maybe 10 NPCs healing through walls at a time. I don't recall this ever happening on live past OoW. If this is incorrect revert it and make it a rule.

## 12/1/2012¶

- **Vaion** Swarm Pets are now untargetable. They still gain aggro, are attackable and can be casted on by NPCs, but clients cannot target them.

- **Sorvani** Items with 0 charges will no longer get a free recharge when players die. Changed the TargetName property for all projects to be $(ProjectName). The only project that will have a new name is chatserver. It is now called ucs matching the linux build.

## 11/27/2012¶

- **Sorvani** fix for newly created items with unlmiited charges to actually be usable.

- **Sorvani** (Uleat) Lore check is now made for items inside bags being trade before the trade completes.

- **Akkadius** Started first works of implementing QueryServ for what it was meant to be used

- **Akkadius** Moved QueryServ to it's own configuration block in the eqemu_config.xml (example):

localhost3306rootpasswordqueryserv

- **Akkadius** QueryServ can now be used on a separate server and can use an entirely separate database as it was meant to

- **Akkadius** Added 'loottable_id to NPC::ModifyNPCStat which also changes quest::ModifyNPCStat(identifier, newValue); as well

- **Akkadius** Fixed heap corruption in quest_globals that would occur if a value over 64 bytes was created

- **Akkadius** Changed value size in qglobals from 64 bytes to 128 bytes

- **Akkadius** Added #reloadworld * This command will reload every single zones Perl quests and repop them

- **Secrets** Minor code fix for qglobals. Since we removed the id field from qglobals, I suppose we shouldn't use it in code.

- **Secrets** Warning fix for a quest function.

- **Secrets** Fixed a crash issue where player corpses did not exist at all in a function (ie; they were disabled) yet we are trying to use an invalid pointer

- **Secrets** durp, i'm retarded. memleak fix.

Perl Changes:

- **Akkadius** Added EVENT_DISCONNECT to global_player.pl/player.pl * Event that triggers whenever a character disconnects from the world

- **Akkadius** Added EVENT_CONNECT to global_player.pl/player.pl * Event that triggers whenever a character connects to the world

- **Akkadius** Added EVENT_TASK_UPDATE to global_player.pl/player.pl * Event that triggers whenever a donecount is incremented in a task, exports variables: $donecount, $activity_id and $task_id

- **Akkadius** Added EVENT_TASK_COMPLETE to global_player.pl/player.pl * Event that triggers whenever a task is complete, this can sort of be checked in EVENT_TASK_STAGE_COMPLETED already but this is more finite, exports variables: $donecount, $activity_id and $task_id

- **Akkadius** Added EVENT_TASK_FAIL to global_player.pl/player.pl * Event that triggers whenever a task has failed, exports variables: $task_id

- **Akkadius** Added \(client->SignalClient(\)data), it uses the client as the initiator and the client that gets sent the data, good for entity_list iterations through client

- **Akkadius** Exported $client->AddAlternateCurrencyValue(currency_id, amount); originally created by KLS

- **Akkadius** Added quest::gettaskactivitydonecount(task, activity); which obviously will get the amount done in a task based on task and activity

- **Akkadius** Added cross zone client signalling capability by character ID: quest::crosszonesignalclientbycharid(char_id, data);

- **Akkadius** Added cross zone client signalling capability by character Name: quest::crosszonesignalclientbyname(Name, data);

- **Akkadius** Added cross zone client messaging capability by character Name: quest::crosszonemessageplayerbyname(Type, Name, Message);

- **Akkadius** Added the ability to flow #commands through Perl, by flow meaning if the command doesn't process through the traditional command system, it will dump the output to EVENT_SAY in player.pl/global_player.pl based on rule Chat:FlowCommandstoPerl_EVENT_SAY

QueryServ Changes:

- I plan on adding much more logging to this server, but for now I've started with the following:

- QueryServ requires rules to be enabled before packets get sent to QueryServ, otherwise World/Zone doesn't need to even craft the packets for logging

- **Akkadius** Logging all player kills through QueryServ, you need to have QueryServ:PlayerLogNPCKills Rule Enabled, type: 0 = Solo, 1 = Group, 2 = Raid

- **Akkadius** Player trades logging started but definitely not finished

- **Akkadius** Removed the rules system from QueryServ, rules should only be read from World/Zone

REQUIRED SQL: utils/sql/queryserv/2268_QueryServ.sql

Database Changes:

- **Akkadius** Added a field in `character_` called `firstlogon` that will essentially be booled true when a player logs on, it handles a characters online status between world and zone and ultimately gets used in EVENT_CONNECT

- **Akkadius** Completely dropped the `id` column in `quest_globals`, the (`charid`, `npcid`, `zoneid`, `name`) fields will act as the primary keys, tested and working fine. This solves capping out on ID's as they are unecessary.

- **Akkadius** Changed value size of `quest_globals` field `value` from 64 bytes to 128 bytes

- **Akkadius** Removed an AA that was causing heap corruption

REQUIRED SQL: utils/sql/svn/2268_required_updates.sql

## 11/25/2012¶

- **JJ** Initial fix for /MQZone detection to reduce false positives.

- **Sorvani** Corrected Improved Familiar pre-req and commited Vaion's AA update to fix animation Empathy.

Required SQL: utils/sql/svn/2264_required_aa_updates.sql

## 11/24/2012¶

- **Sorvani** (Vaion) Added /pet no cast and /pet focus

Required SQL: utils/sql/svn/2262_required_pet_discipline_update.sql

## 11/23/2012¶

- **cavedude** (Tabasco) Re-added probability, setting it to 100 (default) effectively bypasses probability and no additional roll is made. Setting it to 0 prevents the table from being rolled at all, so you can disable the table but still keep the entries if needed.

Required SQL: utils/sql/svn/2260_probability.sql

## 11/22/2012¶

- **Sorvani** Tabasco sent in this bugfix: Ranged attack crash

It doesn't happen every time, but if an NPC is flagged for ranged attacks and they kill their target, the AIProcess function continues on under the assumption that the target is still available.

I just adjusted it to set a flag and do the actual attack at the end of the function. I haven't been able to reproduce the crash since.

## 10/31/2012¶

- **Akkadius** Added the ability to govern player max levels through the source per character. It will look for a qglobal named 'CharMaxLevel', type 5 qglobal, if the rule is enabled and the character flag is set, they will not be able to pass that level.

Optional SQL: utils/sql/svn/2243_optional_char_max_level_rule.sql

## 10/22/2012¶

- **Lerxst2112** Fixed issue in AddMoneyToPP where the amount of silver was being added to copper instead of the leftover copper.

## 10/03/2012¶

- **Sorvani** Disabled optimization around the DECODE(OP_CharacterCreate) in all SoF+ patches to force character creation to validate correctly.

## 10/02/2012¶

- **Sorvani** A NPC that is immune to Mez, Slow, Fear, Charm, or Snare will now generate aggro based on the respective spell's normal aggro.

## 09/28/2012¶

- **Sorvani** SE_SummonCorpse will now work in raid groups.

## 09/27/2012¶

- **Bad_Captain** Bots* Changed #bot healrotation timer to allow decimal values.

- **Bad_Captain** Bots* Rewrote bot AAs to load from DB.

- **Bad_Captain** Bots* Synced bot code to client code for aabonuses, attack, spell casting, etc., as the result of the client aabonuses changes.

## 09/23/2012¶

- **Kayen** Fix for crippling blow chance, other minor fixes related to bonuses.

## 09/20/2012¶

- **Kayen** AA dbase table fixes * Archery Mastery, Fury of Magic.

REQUIRED SQL: utils/sql/svn/2215_required_aa_updates

## 09/19/2012¶

- **KLS** Faction mods (Race, Class, Deity) can now be added on the fly, without adding database columns or editing the code. Source in the database change, run utils/factionmod.pl, and then drop the faction_list table to convert.

REQUIRED SQL: utils/sql/svn/2214_faction_list_mod.sql

## 09/18/2012¶

- **cavedude** Overhauled loot system. I've outlined the new system on the forums here: http://www.eqemulator.org/forums/showthread.php?t=35770

REQUIRED SQL: utils/sql/svn/2213_loot_changes.sql

## 09/16/2012¶

- **Kayen** Implemented SE_HealFromMana changed to SE_HealGroupFromMana * now implemented correctly.

## 09/14/2012¶

- **Kayen** Implemented SE_CriticalHealRate * Focus that increase chance for heals cast on you to critical.

- **Kayen** Implemented SE_IncreaseNumHits * Focus that can inceases max number of hits a buff can have before being removed.

- **Kayen** Removed SE_Twinproc * This is not an actual spell effect, Twin proc is now correctly implemented as on live using SE_Twincast.

- **Kayen** Implemented SE_TwoHandBluntBlock * Chance to block when using two hand blunt weapon (similiar to shield block).

- **Kayen** SE_NegateEffect will now negate all AA, item and spell bonuses for the specified effects.

- **Kayen** Added support to allow for certain bonuses to now properly be calculated when cast as debuffs (ie decrease chance to critical hit)

- **Kayen** Implemented rule to allow certain bonuses to be calculated by adding together the value from each item, instead of taking the highest value.

*Ie. Add together all worn cleave effects, ferocity effects ect.

OPTIONAL SQL: utils/sql/svn/2209_optional_additive_bonus_rule.sql (disabled by default)

## 09/13/2012¶

- **cavedude** Uleat implemented the following changes:

The bandolier function should no longer CAUSE desyncs. Its use can still be affected by previous issues, just like any manual swap. Message cues have been temporarily added to certain procedures to indicate to the player that a possible desync condition exists and that they should zone or relog to correct the situation immediately.

The chance of player corpses becoming bugged should now be minimal. Corpse processing was changed to better emulate client behavior when 'RespawnFromHover' is set to true or false. Message cues and #commands were added to help determine whether a corpse is bugged. (Previously, queued cursor items were sent to the corpse..but, the packet builder did not include the 8000-series of items when a player looted their corpse.)

Tweaked several areas where item swaps were not handled properly, or at all, and the client-server inventories became desyncronized. Additional areas are still suspect for causing desync's. (A 'ResyncInventory' method is in-work to eliminate the need for item deletion...)

Client::SummonItem now limits the size of a summoned stack to the value of stacksize in the database. If you are using script to summon stacks greater than item->stacksize, this action was/is incorrect and you will need to modify your 'quest' to summon multiple stacks.

command changes:

```
`#equipitem * modified partial stack movements..if a partial stack would be left on cursor, the action now fails.
#corpse * added subcommand 'InspectLoot'..works for client and npc corpses..additional information with client.
#peekinv * added stack size(charges) to report and modified the cursor depth reporting of bag slots.
#zopp * new command for troubleshooting..forces a client 'trade' or 'summon' to desync the client inventory.
`
```

references: http://www.eqemulator.org/forums/showthread.php?t=35604 *CSD Support Patch* http://www.eqemulator.org/forums/showthread.php?t=35629 __ CSD Bugged Corpse Patch http://www.eqemulator.org/forums/showthread.php?t=35699 * CSD Bandolier Patch

- **cavedude** (mackal) Damage shields by default will no longer count towards EXP gain. (Rule also added to change this behaviour.)

- **cavedude** (mackal) Extended targets should now clear when aggro is lost using skills.

- **cavedude** (mackal) AAs with shorter reuse timers should now reset if the cast failed (interrupted.)

- **KLS** Fixed a cause of raids disbanding on zoning.

OPTIONAL SQL: INSERT INTO `rule_values` VALUES (1, 'Combat:EXPFromDmgShield', 'false', 'Determine if damage from a damage shield counts for EXP gain.');

## 09/12/2012¶

- **Kayen** Implemented NPC Special Attack 'i'. Immune to Taunt.

- **Kayen** Implemented: SOF+ live like stacking of AA's that belong to the same series in the AA window (Expection: AA's that use hot keys).

- **Kayen** Implemented SE_SpellEffectResistChance * Increase chance to resist specific spell effects ie. Charm

- **Kayen** Revision to how AA focus effects are handled to correclty utilize live AA data.

- **Kayen** Almost all 'General' and most 'Archetype' AA's implemented through Underfoot.

- **Kayen** aaID data (AA.h) updated through VoA expansion.

Following AA effects are now implemented as bonuses: You must update your 'aa_effects' table with 'required_aa_updates.sql' for these to work. MISC AA: Spell Casting Subtlety now implemented with bonus SE_ChangeAggro MISC AA: Many AA that are spell focus effects now implemented using live data. MISC AA: Finishing Blow ect, will now implemented using bonus, SE_FinishingBlow and SE_FinishingBlowLvl. ENC AA: Total Domination now implemented with bonus SE_CharmBreakChance. SK AA: Soul Abrasion now implemented with bonus SE_ImprovedDamage2. *Many fixes to previously implemented AA effects.

REQUIRED SQL: utils/sql/svn/2208_required_aa_updates OPTIONAL SQL: utils/sql/svn/2208_optional_aa_stacking_rule.sql (If false will disable AA stacking for all clients) OPTIONAL SQL: utils/sql/svn/2208_optional_EnableSoulAbrasionAA *If using an older server spell file (pre SOF), will need to run this to correctly populate the 'spellgroups' field.

## 09/07/2012¶

- **Bad_Captain** Bots* Fixed an issue where bots couldn't have spells with target type of ST_GroupClientAndPet cast on them.

- **Bad_Captain** Bots* Added #bot healrotations command. Please see forums for more information.

## 09/04/2012¶

- **cavedude** Added NPC:UseMultiQuest rule to turn multiquest support on or off.

OPTIONAL SQL: INSERT INTO `rule_values` VALUES (1, 'NPC:UseMultiQuest', 'false', 'If true, NPC will remember items handed to them for classic multiquest support.');

## 09/03/2012¶

- **Akkadius** First set of efforts to clean up Windows compiling. See:

http://www.eqemulator.org/forums/showthread.php?p=212217#post212217

- Cleaned up x64 compiles, x86 compiles coming right up

- 

Removed pragma comments and forced them to be used under 'Additional Dependencies' (Windows)

- 

**Akkadius** Fixed-up Release & Debug 32-bit compiles

- **Akkadius** Uploading includes and libraries for both x64 and x86 so that VS2010 can automatically reference those libraries and requires no configuration

- **Akkadius** All project types have had includes and libraries linked to the appropriate machine type

- **Akkadius** Most project types have been set to /MP (Multiprocessor compile) and Warning Level 1 to filter most of the garbage

- **Akkadius** Got the rest of the VS2010 compiles working on a fresh SVN:

```
` Debug x64|x64 = Debug x64|x64
 Debug|Win32 = Debug|Win32
 Debug|x64 = Debug|x64
 DebugBots x64|x64 = DebugBots x64|x64
 DebugBots|Win32 = DebugBots|Win32
 Release x64|x64 = Release x64|x64
 Release|Win32 = Release|Win32
 ReleaseBots x64|x64 = ReleaseBots x64|x64
 ReleaseBots|Win32 = ReleaseBots|Win32
 ReleaseBots|x64 = ReleaseBots|x64
`
```

## 09/02/2012¶

- **cavedude** (image) Added Classic Multiquest support.

- **cavedude** Added quest::clearhandin and #clearquestitems so that multiquest can co-exist with out current system without issues.

REQUIRED plugin: utils/defaults/plugins/check_handin.pl (Or use PEQ quests repo)

## 08/27/2012¶

- **Akkadius** (Uleat) Temporary dupe fix until we can iron this out the way it should be (Not use signed ints in the blob). This should trap a majority of it to client saves.

- **Akkadius** Account shared platinum field type change (signed to unsigned) to no longer allow negative values...

REQUIRED SQL: utils/sql/svn/2195_required_sharedplatupdates.sql

## 08/17/2012¶

- **Kayen** Taunt skill updated to work consistent with live.

*You can now taunt NPC's over the users level. (RULE: TauntOverLevel)

*Taunt success chance should be accurate to live. Penalty of not being at max skill lv can be adjusted with (RULE: Combat:TauntSkillFalloff)

*Live messages for taunt success and failure are now implemented. (Note: Only NPC races that can 'talk' will say the success message).

- **Bad_Captain** Bots* Fixed an issue when with bot spell timers that could lead to a crash.

- **Kayen** Fixed SQL files from rev2185+ that were not saved as .sql

OPTIONAL SQL: utils/sql/svn/2189_optional_taunt_rules OPTIONAL SQL: utils/sql/svn/2185_optional_NPCFlurryChance_rule (run this again)

## 08/16/2012¶

- **Kayen** Complete revision of the Death Save and Divine Save effects and related bonuses to be consistent with live. *Death Save (Death Pact/DI) will no longer fire on death. It should only fire when less 15% HP but not killed.* Death Save chance is determined soley by charisma of client with the buff. (RULE: DeathSaveCharismaMod) *Divine Intervention baseline is now correctly set to 8000HP (from 50k) (RULE: DivineInterventionHeal)* AA Touch of the Divine provides upon failure of first Death Save, a second roll and if successful will do a portion of the original heal value. (Ie DI=8000HP with ToTD-3(60%) your heal will be 8000_0.6 = 4800HP)_ Implemented functionality for later expansion Death Save effects (Divine Intercession ect) These can add heal value to the base heal which is limited by level (ie Heal 10,0000+8000 if client less then level 80)

*Divine Save (AA Unfailing Divinity) only fire upon death of client with this effect and is independent of Death Save effect.* Increased ranks of AA only increase the chance of firing upon death. Heal value does NOT increase with rank. *Upon firing you will still recieve the Divine Aura like buff, which now also correctly removes all determental effects.

- **Kayen** Implemented: SE_Purify * Removes determental buffs. Value determines how many buffs are removed.

- **Kayen** Added RULE MaxCastTimeReduction * Max percent your spell cast time can be reduced by spell haste(is/was 50%).

Following AA effects are now implemented as bonuses: You must update your 'aa_effects' table with 'required_aa_updates.sql' for these to work. MISC AA: Internal Metronome/Channeling Focus now implemented with bonus, SE_ChannelChanceSpells. MISC AA: Concentration now correctly implemented with bonus, SE_ChannelChanceItems. MISC AA: Pet Affinity now implemented with bonus, SE_GivePetGroupTarget. MISC AA: Spell Casting Expertise, Mastery of the Past ect will prevent fizzles from spells under certain level, SE_MasteryofPast. BRD AA: Extended Notes/Sionachie's Crescendo will increase ranage of songs with bonus, SE_SongRange. BRD AA: Jam Fest now implemented with bonus, SE_CastingLevel2. CLR AA: Unfailing Divinity now implemented with bonus SE_Unfailing Divinity. CLR AA: Touch of the Divine now implemented with bonus SE_DivineSave. DRU AA: Enchanted root/Viscid Root (was implemented completely wrong), now uses bonus SE_RootBreakChance. *If a root is cast on the target and target has this AA it will decrease the chance for that root to break from any damage spells. The damage spells can be cast by any one, not just the client with the bonus. Added RULE: RootBreakFromSpells* Baseline is/was set at 20% chance from nukes.

REQUIRED SQL: utils/sql/svn/2188_required_aa_updates OPTIONAL SQL: utils/sql/svn/2188_optional_miscspelleffect_rules

## 08/13/2012¶

- **Kayen** Update to how chance to hit bonuses are applied.

*Accuracy spell effect will now stack with Hit Chance spell effect. (Accuracy/15 = 1% chance to hit).

*Skill specific Hit Chance effects should stack correctly now.

*Accuracy/Hit Chance effects that DECREASE your chance to hit will now function.

- **Kayen** Minor update to duel wield, chance bonuses will be correctly applied to baseline dw chance.

- **Kayen** Implemented Perl MOB Quest Object SetFlurryChance(value) (ie 50 = 50% chance for NPC flurry if special atk "F")

- **Kayen** Implemented Perl MOB Quest Object GetFlurryChance(value) returns flurry chance.

- **Kayen** Added rule to adjust server wide flurry chance (Default = 20%) *Perl object will override this.

Following AA effects are now implemented as bonuses: You must update your 'aa_effects' table with 'required_aa_updates.sql' for these to work. MISC AA: Dead Aim, Precision of the Hunter, Scout's Efficiency will now calculate from bonus SE_Accuracy. MISC AA: Combat Agility line will now calculate from bonus SE_AvoidMeleeChance. (Now implemented through SoD) MISC AA: Combat Stability line will now calculate from bonus SE_CombatStability. (Now implemented through SoD) MISC AA: Double Riposte, Return Kick now calculated from bonus SE_GiveDoubleRiposte. (New AA's implemented that use this) MISC AA: Natural Durability, should be working correctly now from bonus SE_MaxHP. MISC AA: Ambidexterity will now apply properly to increase chance to duel wield from bonus SE_Ambidexterity. MISC AA: Flurry,Rapid Strikes will now properly be applied from bonus SE_Flurry. (New AA's implemented that use this) MISC AA: Pet AA's that give flurry chance will now be applied by bonus, SE_PetFlurry. MAG AA: Elemental Agility was incorrectly giving melee mitigation instead of avoidance, to now use SE_PetAvoidance. MAG AA: Elemental Durability will now add to pet max hp with bonus, SE_PetMaxHP.

REQUIRED SQL: utils/sql/svn/2185_required_aa_updates OPTIONAL SQL: utils/sql/svn/2185_optional_NPCFlurryChance_rule

## 08/12/2012¶

- **Bad_Captain** Fixed an issue when using bots where you would not get xp when your pet did most of the damage and you are not grouped.

- **Bad_Captain** Added rule to enable receiving xp from bots not in your group. Defaults to false.

OPTIONAL SQL: utils/sql/svn/2183_optional_bot_xp_rule.sql

## 08/08/2012¶

- **Kayen** Updates to critical hit calcuations to be consistent with live.

*Baseline critical rate is determined by DEX stat (255 dex = 2%),this baseline is then modified by item,spell and AA critical chance bonuses.

*Pet critical baseline is determined by the rate from AA effects that give pets the ability to critical. (Can not crit w/o this effect)

- **Kayen** Slay Undead effect will now be working consistent with live.

*Slay rate is no longer effected by critical hit rate, it uses it's own predetermined rates from the spell effect data.

*Damage modification will now be much closer to that of lives utilizing the spell effects damage modifier.

*Example(AA Slay Undead I* Rate: 225 (2.25%) Damage Mod: 680%)

*Note that that spell effects using Slay Undead (Holyforge) will stack with AA and increase the damage and the rate.

- **Kayen** Crippling Blow's derived from spell effects will now be calculated consistent with live.

*Cippling blow chance is determined by modifying your critical hit chance.

*Example (Savage Onslaught* 200% chance to crippling blow) If you have a base chance to critical hit of 10%

and you score a critical hit, you will then have a 20% chance to crippling blow.

- **Kayen** Fixed effect for AA 'War Cry' will now provide group fear immunity for duration.

- **Kayen** Few new AA's added including shaman Ancestral Aid and Spirit Channeling.

Following AA effects are now implemented as bonuses: You must update your 'aa_effects' table with 'required_aa_updates.sql' for these to work. MISC AA: 'Combat Fury', 'Fury of the Ages' will now calculate from bonus SE_CriticalHitChance. MISC AA: 'Veteran's Wrath' will now calculate from bonus SE_CriticalDmgMod. MISC AA: All AA that give pet criticals will be calculated from SE_PetCriticalHit. PAL AA: 'Slay Undead', 'Vanquish Undead' will now calculate from bonus SE_SlayUndead. (Holyforge now works correctly)

REQUIRED SQL: utils/sql/svn/2178_required_aa_updates

## 08/06/2012¶

- **Kayen** Fixes to rev2176 * Double Attack, EndlessQuiver, Run Speed.

REQUIRED SQL: utils/sql/svn/2176_required_aa_updates will need to be applied again for Run Speed fix.

## 08/05/2012¶

- **Kayen** Complete revision of how double attack chance is calculate to be consistent with live.

- **Kayen** Berserker 'Frenzy' skill attack will now function as it does on live. Gives a chance for 1-3 attacks using frenzy skill specific damage.

*Note: This will be a considerable nerf to bersekers because it was previously coded to give actual melee rounds using weapon damage.

- **Kayen** Implemented a few miscellaneous new AA's, mostly from DODH. (These will show in OoW Window in Titanium)

- **Kayen** Added almost all remaining spell effects into spdat.h (~90% defined).

- **Kayen** Alternate Advancement Update: In the process of coverting most of the hard coded AA data out of the source and into the 'aa_effects' table

using live data. These effects are then reimplemented using the bonus system in the broadest possible way, most of these effects will

also be useable as regular spell/item effects. This will allow developers in the future to adjust,implement and customize AA effects

without requiring source changes. Beware in doing this, many AA effects that were previously either implemented incorrectly or with values

not consistent with live data will be adjusted to be as accurate as possible.

Following AA effects are now implemented as bonuses: You must update your 'aa_effects' table with 'required_aa_updates.sql' for these to work. MISC AA: All innate run speed AA's have been converted to use bonus SE_BaseMovementSpeed. MISC AA: All bind wound related AA have been converted to use bonuses, SE_ImprovedBindWound, SE_MaxBindWound. MISC AA: Shield Block will now be calculated using bonuses, SE_ShieldBlock. MISC AA: Sinister Strike will now correctly allow your off hand weapon to recieve a weapon damage bonus, SE_SecondaryDmgInc. MISC AA: Strengthened Strike/Vicious Smash/Kick Mastery will now accurately to live add skill damage to respective special abilities. MISC AA: StrikeThrough, Tactical Mastery *will now be calculated from bonus, SE_Strikethrough2. MISC AA: Ferocity, Knight's Advantage ect* will now be calculated from bonus SE_DoubleAttackChance. MISC AA: Harmonious Attacks, Bestial Frenzy *will allow double attack chance using bonus SE_GiveDoubleAttack (any class can be given this) MISC AA: Weapon Affinity, will now use SE_ProcChance. MISC AA: PunishingBlade, SpeedoftheKnight will now allow an extra 2 Handed attack using bonus, SE_ExtraAttackChance. BRD AA: Fleet of Foot will now correctly allow bards to run over the speed cap using, SE_IncreaseRunSpeedCap. WAR AA: Previously non functional 'Stalwart Endurance' and 'Dauntless Preservence' now working using bonus, SE_FrontalStunResist MNK AA: HightenedAwareness* Implemented using bonus, SE_BlockBehind. MNK AA: Technique of Master Wu *Will now correclty use a random monk special attack, chance for double/triple attack as SE_DoubleSpecialAttack. MNK AA: Dragon Punch* Implemented as now using bonus SE_SpecialAttackKBProc, (base1 = 100 [25% proc chance at 100] base2 = skill) RNG AA: Endless Quiver *Implemented as SE_ConsumeProjectile which gives a percent chance NOT to consume an arrow. (EQ base1 = 100) RNG AA: Archery Mastery* Implemented as SE_ArcheryDamageModifier which gives a percent increase to archery attacks. BER AA: Throwing Mastery *Implemented using SE_DamageModifier. BER AA: Blur of Axes, Vicious Frenzy* will now correctly add skill damage to 'Frenzy' skill attacks. ROG AA: Triple Backstab, SiezedOpportunity, Chaotic Stab * as bonus, SE_TripleBackstab, SE_FrontalBackstabChance,SE_FrontalBackstabMinDmg.

REQUIRED SQL: utils/sql/svn/2176_required_aa_updates Optional SQL: utils/sql/svn/2176_optional_FrenzyBonus_rule Optional SQL: utils/sql/svn/2176_optional_aa_expansion_sof_fix (Allow AA to show proper expansion in SOF+ clients)

## 08/01/2012¶

- **Bad_Captain** Fixed bot compile issue introduced in Rev 2171.

- **Bad_Captain** Integrated Kayen's skill attack code with bots' code, as well as other changes from Rev 2171.

## 07/31/2012¶

- **Akkadius** (KLS) Fix for global_player.pl synchronization. There was an issue where certain subroutines were not passing as global

## 07/26/2012¶

- **Kayen** Fixed: SE_ImmuneFleeing * Will now disable fleeing if used after mob begins to run, will not effect fleeing from fear.

- **Kayen** Implemented Perl MOB Quest Object SetDisableMelee(1=Disabled) * Prevents the ability to auto attack.

- **Kayen** Implemented Perl MOB Quest Object IsMeleeDisabled()

- **Sorvani** corrected build name for queryserv project in all the various build types.

## 07/24/2012¶

- **Kayen** Implemented: SE_HundredHands (incorrectly marked as already implemented) * Increases/Decrease actual weapon delay by % of value.

- **Kayen** Implemented: Missing modifications from the Archery/Throw damage pathways.

*SkillAmount/SkillDamageTaken mods, ability to Block/Dodge/Parry ranged attacks (Can not riposte), other new focus/mod effects.

- **Kayen** Fixed: aaThrowingMastery will no longer be applied 2x per throw.

- **Kayen** Implemented: Damage bonus to skill attacks from specific armor slot AC (ie KICK from BOOT AC) can adjust with rule 'SpecialAttackACBonus'

- **Kayen** SE_MinDamageModifier should now apply to skill specific effects and to special attacks.

- **Kayen** Implemented: Complete revision of SE_SkillAttack. (+ required various fixes/adjustments to functions related to special attacks)

*This spell effect performs a physical attack from a specific skill with a set weapon damage value and chance to hit modifier.

*Attacks will now calculate correctly and use their actual respected pathways utilizing all skill specific mods/bonus.

- **Kayen** Implemented Perl MOB Quest Object DoMeleeSkillAttackDmg(target, weapon_damage, skill, chance_mod, focus, CanRiposte)

- **Kayen** Implemented Perl MOB Quest Object DoArcheryAttackDmg(target,NULL,NULL, weapon_damage, chance_mod, focus)

- **Kayen** Implemented Perl MOB Quest Object DoThrowingAttackDmg(target,NULL,NULL, weapon_damage, chance_mod, focus)

Optional SQL: utils/sql/svn/2171_optional_SpecialAttackACBonus_rule

## 07/18/2012¶

- **Kayen** Implemented NPC Special Attack 'K'. Immune to Dispell.

- **Kayen** Fixed SE_RangedProc to be applied after zoning, calculate proc rate correctly, utilize numhits.

- **Kayen** Fixed a bug that would cause NPC procrates to be incorrectly effected by equipped weapon delay.

- **Kayen** Modified functions related to obtaining proc chance to no longer recalculate the 'attack rate' every swing.

Instead it will use the already calculated attack timer values. (Not implement for BOTs, but should be no compile problems).

- **Kayen** Fixed for buff issue with rev2167.

## 07/16/2012¶

- **Kayen** Implemented: SE_SpellProcChance, SE_CharmBreakChance, SE_BalanceMana, SE_DotCritDmgIncrease, SE_TripleAttackChance, SE_Taunt

```
` SE_BardSongRange, SE_ACv2, SE_ManaRegen_v2, SE_SpellCriticalFocus, SE_AdditionalHeal2, SE_HealRate2,
 SE_CriticalHealOverTime2, SE_CriticalHealChance2, SE_SkillDamageAmount2, SE_LimitSpellSkill, SE_LimitClass
 SE_LimitExcludeSkill, SE_ShieldBlock, SE_BlockBehind
`
```

- **Kayen** Implemented: SE_Empathy * A focus limited debuff which causes (spells/skill attacks) cast on target to do +X amount more damage.

```
` *This spell effect is often limited using SE_LimitSpellSkill.
 *(Ie. If empathy value is 1000 and limited to evocation, all nukes on target using evoc. will get +1000 damage)
`
```

- **Kayen** Implemented: SE_SpellPowerIncrease * Can be used to apply a worn/buff focus effect with limits for...

```
` 1) Additional bard instrument modifiers.
 2) Healing/Damage focus to bard songs. (Note: This is only effect that can do this).
 3) Increase effectiviess of casted/disc Skill Attacks.
 4) General use stackable Healing/Damage focus.
 5) Increase the value of melee runes by focus amount.
`
```

- **Kayen** SE_HPtoMana will no longer drain your HP before the spell is finished casting. Effect now handled as a bonus using best value.

- **Kayen** SE_SpellVulunerability will now correctly calculate and apply the highest value if target has mulitple effects.

- **Kayen** Fixed an issue where DOTs cast by an NPC on another NPC would not generate hate per tick. Improved how we calc damage from DOTs.

- **Kayen** SE_BlockSpellEffect was implemented incorrectly and has been revised to SE_NegateSpellEffect.

```
` *It is not meant to block buffs, rather it negates the specific spell bonuses or effects from buffs you already have.
 *Currently functional with any effect that is handled under bonuses, and focus effects.
`
```

- **Kayen** Vastly improved how we handle melee/spell runes/partial mitigation runes ect. Should be significantly more efficient.

```
` *Melee/Spell Mitigation runes and ManaAbsorbPercentDamage effects will now use the best mitigation value if multiple effects.
`
```

- **Kayen** Improved the process we use to get spell/item focus effects. An initial check if the client has a specific focusType

is done while checking for item/spell bonuses. GetFocusEffect will no longer check all inventory and buff slots every cast for the

focusType if that focusType doesn't exist on the client. This should improve performance since these checks are done 10-20x per cast/proc.

## 07/15/2012¶

- **Secrets** Fixed an issue with saylinks above 255 characters. If you do want to use saylinks above 255 characters, it is reccomended you adjust the varchar field in the saylinks table to a "TEXT" field, which supports up to 65535 characters.

## 07/13/2012¶

- **Bad_Captain** Fixed another bug that allowed pets to steal xp when using bots.

- **Bad_Captain** Bots: Persisting spell & discipline timers.

- **Bad_Captain** Bots: Bot pets will no longer continuously try to get behind a mob if they are tanking.

- **Bad_Captain** Bots: Fixed potential duplicate lore item bug when trading with bots.

- **Bad_Captain** Bots: Fixed bot compile issue from Rev 2160.

- **Bad_Captain** Bots: Fixed multiple issues with #bot spawn and #bot botgroup load (c0ncrete).

- **Bad_Captain** Bots: Implemented new #bot defensive command for Warriors and Knights. Includes most of the code required to implement disciplines for bots. Requires disc AI & disc lists.

Required SQL: utils/sql/svn/2164_require_bots_bottimers.sql

## 07/09/2012¶

- **Kayen** Fixed issue causing npc special attacks (kick/bash ect) to do extra damage.

- **Kayen** Fixed major crash bug with rev2159.

- **cavedude** AFTERDEATH npc_emote will now use emoteid instead of npcid.

## 07/08/2012¶

- **Kayen** Implemented: SE_SkillProc, SE_SkillProc2 which can be limited by SE_LimitToSkill * Procs an effect when a specific skill is used

```
` *Functional with all melee skills, special attacks, backstab, taunt, dodge,block,parry,riposte.
`
```

- **Kayen** Added checks to attack process to prevent mob from performing certain actions after being killed (riposte, defensive proc ect).

- **Kayen** Fixed bug where if client had delay death effect NPC would not be able to attack them if HP < -11, clients without delay death will now bleed again.

- **Kayen** Implemented: SE_CastingLevel2, SE_ReduceHate

- **Kayen** Fix to bug where some spell procs and defensive procs were not loading after zoning.

- **Kayen** Updated spdat.h with many new live spell effects that were previously 'unused'.

## 07/05/2012¶

- **Kayen** Implemented: SE_Manaburn: Drains mana for damage/heal at a defined ratio up to a defined maximum amount of mana.

- **Kayen** Implemented: SE_CastonNumHitFade: Casts a spell when a buff fades due to its numhits being depleted.

- **Kayen** Implemented: support for all remaining live spell effects that use 'numhits'.

```
` Significantly optimized how all spell effects that utilize 'numhits' are handled throughout the source.
`
```

- **Kayen** Fixed: SE_DefensiveProc *Proc rate will now be calculated similiar to live.* Spell specific rate modifcations will now work.

- **Kayen** Added Rule: Combat:AvgDefProcsPerMinute (Default = 2.0) Determine defensive procs per minute.

- **Kayen** Added Rule: Combat:DefProcPerMinAgiContrib (Default = 0.075) Determines how much agility effects proc rate.

Optional SQL: utils/sql/svn/2159_optional_defensiveproc_rules

## 06/29/2012¶

- **Kayen** Implemented Perl NPC Quest Object GetSlowMitigation()

- **Kayen** Implemented Perl NPC Quest Object GetAttackSpeed()

- **Kayen** Implemented Perl NPC Quest Object GetAccuracyRating()

- **Kayen** Fixed: Slow Mitigation (was not loading from dbase),optimized its application in source and added lives slow mitigation messages.

```
` Slow mitigation Messages: 'slighty' 0.00 * 0.25 'partial' 0.25-0.75 'mostly' 0.75-1
`
```

- **Kayen** Implemented: SE_AttackSpeed4: 'Inhibit Melee' effect works different then regular haste/slow effect

```
` 1) If target is hasted (or no haste) Inhibit Melee will decrease attack speed by the Inhibit Melee value.
 2) If target is slowed Inhibit Melee is applied as a percent change to remaining attack speed after regular slow.
 ie. You cast 75% Slow (25 attack speed remains) then apply 25% Inhibit melee (18.75 attack speed remains): Final slow 81.75%
`
```

- **Kayen** Added Rule: Spells:CharismaEffectiveness (Default = 10) Deterimes how much resist modification charisma applies to charm/pacify checks (10 CHA = -1 resist mod).

- **Kayen** Added Rule: Spells:CharmBreakCheckChance (Default = 25) Determines percent chance for a charm break check to occur each buff tick.

- **Kayen** Reworked code to that handles charm breaks/lull to be accurate to live and more functional in general.

```
` 1) Each charm buff tick there is a default 25% [Rule.CharmBreakCheckChance] chance to trigger a spell resistance check.
 2) Spell resistance check then adds an additional bonus resist modification based casters Charisma at a default
 ratio of 10 CHA per -1 resist mod [Rule.CharismaEffectiveness]
 3) If resisted (ie Charm is to break) Total Domination AA is then applied to give another chance to maintain the charm.
`
```

- **Kayen** Implemented: SE_AdditionalHeal: Focus Effect that adds an additional heal amount to the casted spell.

- **Kayen** Implemented: SE_CastOnCure: Casts a spell on cured target.

- **Kayen** Implemented: SE_CastOnCurer: Casts a spell on the curer of the target.

- **Kayen** Modified: Mob::TryFadeEffect to avoid interaction wtih Twinproc effect.

- **cavedude** (Uleat) Multiple changes and additions to doors, per the forums.

Optional SQL: utils/sql/svn/2156_optional_charm_break_rule.sql

## 06/25/2012¶

- **Trevius** Reviewed and Committed the below by **Kayen*

- **Kayen** Added Rule: AvgSpellProcsPerMinute (Default = 6.0) Determines proc rate of spells applied from sympathetic focus effect

- **Kayen** Added Rule: ResistFalloff (Default = 67) Max that level that will adjust our resist chance based on level modifiers

- **Kayen** Adjusted Mob::TrySpellOnKill()

- Will now check AA, Items and Buffs for SE_SpellOnKill (Same logic problem as TrySpellOnDeath)

- Level of the npc you killed and the spell_id used to kill it now both passed into the function.

- SE_TrySpellOnKill will now correctly check if there is a min level of the npc required for the spell effect to work (max value in spelldat)

- **Kayen** Implemented: SE_SpellOnKill2: For deterimental spells where landing the kill gives x% chance to give a buff.

- **Kayen** Sympathetic proc now calculates chance to proc a sympathetic spell accurately like live using Procs per minute.

- **Kayen** Adjusted Mob::TrySpellOnDeath() * Now checks all avialable effects and trys to use each one.

- **Kayen** Fixed SE_TargetsTarget * Target's Target must be in CombatRange to recieve the effect (Verified from live)

- **Kayen** Fixed TryApplyEffect * No longer incorrectly lands on the target's target's taget. (Example of spells that use this are Shaman Mending Couterbias)

- **Kayen** Adjusted Twincast to now select the buff with the highest chance to Twincast and use that, it will also stack with item focus and AA (when implemented).

- **Kayen** Removed the mana cost portion from twin casting a spell.

- **Kayen** Fix for SE_SympatheticProc * The focus effect now checks all items/buffs for the focus effect and adds all returned proc spellid's to a list from which one is randomly selected.

- **Kayen** Implemented SE_FF_Damage_Amount * Focus/Buff that adds damage to the casted spell. Usually found on spell group limited augments and stackable with SE_SpellDamage.

- **Kayen** Adjusted SE_SpellDamage to be handled properly as a focus effect.

- **Kayen** Extra damage from Focuses is now calculated correctly for DoTs

- **Kayen** Implemented Perl NPC Quest Object SetSpellFocusDMG(focus amount) * Focus all npc direct/dot damage spells by value

- **Kayen** Implemented Perl NPC Quest Object SetSpellFocusHeal(focus amount) * Focus all npc healing spells by value

- **Kayen** Implemented Perl Mob Quest Object ModSkillDmgTaken(skill_num,value) * Set a weakness/bonus of weapon attacks to a Mob

- Example: mob can be set to take 5% more damage from blunt weapons * ModSkillDmgTaken(0,5)

- Stacks with spell/item bonuses * Setting skill to -1 will effect all skills

- **Kayen** Implemented Perl Mob Quest Object GetModSkillDmgTaken(skill_num) * Returns only the quest skill mod for specified skill

- **Kayen** Implemented Perl Mob Quest Object GetSkillDmgTaken(skill_num) * Returns the total skill damage taken mod for the specified skill (item+spell+quest_mod value)

- **Kayen** Implemented Perl Mob Quest Object SetAllowBeneficial(false) * Allow a specific Mob to be healed/buffed by a client

- **Kayen** Implemented Perl Mob Quest Object GetAllowBeneficial() * Returns SetAllowBeneficial flag

- **Kayen** Implemented Perl Mob Quest Object IsBeneficialAllowed(target) * Returns if target can have beneficial spells cast on them

- **Kayen** Implemented Perl Mob Quest Object ModVulnerability(resist type, value) * Set Spell Vulnerability of mob by resist type(0-9) ALL = -1

- Example: mob can be set to take 5% more damage from Fire spells (2,5);

- Applied effect will stack with spell buff effects.

- If a resist type SPECIFIC and a resist type ALL mod are applied to the same MOB, the SPECIFIC value will be used if spell cast on MOB is the same resist type.

- **Kayen** Implemented Perl Mob Quest Object GetModVulnerability(resist type) * Return the quest applied value for each resist (ALL = -1)

Optional SQL: utils/sql/svn/2154_optional_rule_spell_procs_resists_falloff.sql

## 06/22/2012¶

- **Secrets** (mackal) Spells now display to all clients and can be filtered as such.

- **Secrets** Damage Shields now go to the proper filter, and do not show the non-melee damage to everyone.

## 06/03/2012¶

- **Akkadius** Added the ability to run a dual-stack global_player.pl with the existing player.pl that will run locally in quests/zone/player.pl or quests/templates/player.pl

- This allows the player.pl to be ran globally without interference of a local script (quests/zone/player.pl OR quests/templates/player.pl)

- 'global_player.pl' simply needs to be added to quests/templates/global_player.pl to be parsed otherwise it will not be loaded

- 'global_player.pl' parses after the local player.pl

- 'global_player.pl' parses all of the same events a regular player.pl does and will work with any new subroutines added to it in the future

- Thanks Derision for being a pair of eyes on a part of the diff for this

## 06/02/2012¶

- **cavedude** Exported quest::addldonwin(wins, theme); and quest::addldonloss(losses, theme);

## 05/30/2012¶

- **Bad_Captain** Fixed bug that allowed pets to steal xp when using bots.

- **Bad_Captain** Bots: Fixed bug that allowed bots to sometimes cast HoT buffs during combat instead of HoT heals.

- **Bad_Captain** Bots: Tweaked bard casting chances to restore twisting of multiple songs.

- **Bad_Captain** Bots: Implemented Shaman cannibalization during combat.

## 05/13/2012¶

- **cavedude** Corrected the text merchants give when they refuse to sell to you.

- **cavedude** The graveyard timer will now resume when a dynamic GY zone boots, instead of resetting.

- **cavedude** When a corpse is moved to the graveyard, it will no longer attempt to use an instanced version of the zone.

- **cavedude** Added the ability to load NPC emotes from the DB. Wiki entry for this will be at http://www.eqemulator.net/wiki/wikka.php?wakka=NPCEmotes when I write it up.

REQUIRED SQL: utils/sql/svn/2142_emotes.sql

## 05/06/2012¶

- **Akkadius** Added the ability to load a default.pl script underneath quests/templates

## 05/05/2012¶

- **Derision** Fixed reference to freed memory in Mob::BardPulse, plus a couple of minor memory leaks in Load/SavePetInfo

## 05/01/2012¶

- **Derision** Corpses no longer appear in Extended Target Auto slots.

## 04/30/2012¶

- **Derision** Fixed some minor bugs with Extended Targeting (if the tank/assist/puller had a target before you allocated an XT slot to that function, you would not see the target unti they changed target).

## 04/29/2012¶

- **Derision** UF+: Support for the Extended Target window (aside from the Raid target types).

- **Derision** Fixed Extended Target bugs where CurrentTargetPC targets were incorrectly cleared when leaving a group, and a CurrentTargetPC wasn't updating when they zoned in.

REQUIRED SQL: utils/sql/svn/2136_extended_targets.sql

Note: Default number of Extended Targets is 5. This is stored as a column in character_ GMs can increase a players slots by targetting them and typing #xtargets where n is between 5 and 20.

## 04/22/2012¶

- **Trevius** VoA * The AA Window now populated AAs. AA hotkeys can be created, but purchasing still needs work.

## 04/21/2012¶

- **sorvani** Bard AE DoTs should now be affected by mods correctly.

## 04/19/2012¶

- **cavedude** quest::buryplayercorpse will now despawn corpses in zones other than the client's current location, preventing dupes.

- **cavedude** Added quest::summonallplayercorpses (same syntax as quest::summonburriedplayercorpse) which will depop and summon all of the player's corpses, buried or not.

- **cavedude** Fixed a bug that caused some summoned corpses to use a static 5 minute decay timer.

- **cavedude** Changed player_corpses_backup schema to match player_corpses. If the rule is enabled, corpse backups will now be created for players that are high enough level to drop items to their corpses.

- **cavedude** Added a rule to determine whether or not to remove player corpse backups older than 2 weeks.

- **cavedude** #corpse now has options to depop a single player corpse, or every corpse belonging to a single player.

- **cavedude** You can now specify if a faction hit is temporary (is removed when player camps/zones) or whether or not to display the faction hit to the player in-game.

If temp in npc_faction_entries is set to:

0 (Default): Faction is permanent, player recieves a message. (Same functionality as we had previously.)

1: Faction is temporary, player does not recieve a message.

2: Faction is temporary, player recieves a message.

3: Faction is permanent, but player does not recieve a message.

- **cavedude** Added an optional argument to quest::faction to utilize the functionality and values listed above.

- **cavedude** Added minlevel and maxlevel to lootdrop_entries. The player credited with the kill (most hate) has their level checked against both columns, and if they are lower than the specified minlevel, or higer than the max, that item entry if it exists is removed from the NPC before it becomes a corpse.

- **cavedude** You can now specify if a NPC automatically repops (rerolls against their spawngroup) or depops after the reverse spawn timer is up.

If despawn in spawngroup is set to:

0 (Default): Do not depop or repop, no depop timer is set. (Same functionality as we had previously.)

1: Despawn the current NPC and repop the spawngroup after the associated spawn2 timer is up (including variance.)

- Repop, after the value specified in despawn_timer is up (also uses spawn2 variance.)

3: Depop the NPC after the spawn2 timer is up + variance.

- Depop the NPC after despawn_timer is up + variance.

Example: Setting despawn to 1 will despawn the NPC and immediately respawn the spawngroup after it has been up for the length of its spawn2 timer + variance.

Example: Setting despawn to 4 and despawn_timer to 3600 will depop the NPC after it has been up for an hour + variance. It then will respawn after its normal respawn timer is up.

- **cavedude** Fixed a crash in groups.cpp.

Required SQL: utils/sql/svn/2133_required_faction_loot_despawn.sql (Backup your data first!)

## 04/17/2012¶

- **Bad_Captain** Bots: Added Bot Group Messages and #bot groupmessages command to turn them on or off per bot or for all bots.

- **Bad_Captain** Bots: Fixed bugs that allowed more bots to be spawned than specified in the Bots:SpawnBotCount rule, fixed bug that allowed more bots to be created than specified in the Bots:CreateBotCount rule, and fixed slow buffing bug.

- **Bad_Captain** Bots: Various spell ai tweaks (including HoT spells should no longer block other heals from being cast in certain situations and hybrids should use less mana by healing less often).

- **Bad_Captain** Bots: Removed client xp gain from bots outside the player's group.

## 04/14/2012¶

- **Trevius** Fixed inspect for SoF+ clients, which was broken by Rev2128.

## 04/15/2012¶

- **Derision** Added support for the 'Looking For Guild' window.

Required SQL: utils/sql/svn/2129_required_lfguild.sql

IMPORTANT NOTE:

To use this feature, you must be running the querserv process. If you are not running queryserv, LFGuild will not work, but your server will run normally in all other respects.

Underfoot users can bring up the LFGuild Window by pressing the EQ buton and selecting Players/Looking For Guild.

I think all other clients can only access the feature by clicking on the notice boards in the Guild Lobby. To allow them to do this, you must add the following to the SUB EVENT_CLICKDOOR of your guildlobby/player.pl

if((\(doorid >= 5) && (\)doorid <= 38)) { $client->OpenLFGuildWindow(); }

## 04/14/2012¶

- **Trevius** VoA * Corrected a few alignment issues with the item struct and it should be fully aligned now.

- **Trevius** VoA * Identified a few new item fields including: Prestige, SkillModMax, SkillModExtra, and Power

- **Trevius** VoA * #summonitem and functions that summon items such as quests are now fixed.

- **Trevius** VoA * Identified multiple Membership fields, which corrects multiple issues such as limited inventory slots, assigned AA limit, level limit, shared bank, and more.

- **Trevius** Added packet length verification to all packet handling that was missing it.

## 04/13/2012¶

- **Secrets** VoA * Character Creation is now functional. Fixed creation request struct (opcodes were right), and membership is now sent (characters can now be created!)

- **Secrets** VoA * Membership levels are now sent to the client via the SendMembership opcode. Hardcoded to be like older clients for now. Might need bag slots looked into; upon applying this, bag slots & items went missing.

- **Secrets** Updated #race command to support races up to 714 (as per the 4/12/2012 client)

- **Trevius** VoA * Items now display food/drink correctly and consuming them is now functional.

- **Trevius** VoA * Items no longer display UKNOWN SKILL for skill mods on some items that don't have skill mods set.

- **Trevius** VoA * Items no longer display Prestige on them.

- **Trevius** VoA * Buying from merchants is now functional, though selling to merchants is not yet.

- **Trevius** VoA * Disabled the Guild Member List temporarily to prevent guilded characters from crashing.

## 04/12/2012¶

- **Trevius** VoA * Casting Spells and Click Effects on items is now functional.

## 04/11/2012¶

- **Trevius** VoA * Corrected the Player Profile which should now be perfectly aligned.

- **Trevius** VoA * More Opcode and Struct corrections/adjustments.

## 04/09/2012¶

- **Trevius** VoA * Identified/corrected some more opcodes and packet structures.

- **Trevius** VoA * Merchants now display items for sale, but purchasing is not yet functional.

- **Trevius** VoA * Added new packet for setting the max number of characters allowed to be created on an account (10 for now).

## 04/08/2012¶

- **Trevius** VoA * Identified/corrected some more opcodes.

- **Trevius** VoA * Items can now be moved around through all slots.

- **Trevius** VoA * Updated structs that use inventory slots to use the new format. Still need to verify some of the struct changes.

## 04/07/2012¶

- **Trevius** Initial addition of the VoA (March 21 2012) client. To enable, you must uncomment the VoA lines in /common/patches.

- **Trevius** Many of the core systems are basically functional, but this client is still in an early development phase and not recommended for normal players yet.

- **Trevius** Non-Player Race spawns will cause the client to crash, so it is recommended to test it in an empty zone.

- **Trevius** Also, items in the bank will cause it to crash, but normal inventory seems to work fine so far.

- **Trevius** You cannot create a character on this client yet, so you must use an existing character.

- **Derision** VOA: Fixed zoning. Adjusted spawn encoding.

## 04/02/2012¶

- **JJ** Removed additional library and include directories from windows projects as they were not standard locations for all.

## 03/29/2012¶

- **Sorvani** Resurrections effects will again be applied to characters who are in a zone where combat is not allowed (GL, PoK etc) when they receive a rez.

## 03/19/2012¶

- **Bad_Captain** Bots: A few fixed for #bot stance command

## 03/19/2012¶

- **Bad_Captain** Bots: Implemented bot stances. See forum post.

Required SQL: utils/sql/svn/2107_required_bot_stances.sql

## 03/2/2012¶

- **Bad_Captain** Fixed potential crash in group roles code when a group member is removed.

## 02/28/2012¶

- **Sorvani** Added check for ST_AEBard song before sending spell SPELL_NO_HOLD

- **Bad_Captain** Implemented Group Roles via UI (SoD+) *Set group roles, maintains across zones, save/load grouprole sets (load doesn't appear to work on UF* may be a client bug as client doesn't send request to the server for saved group roles as SoD client does)

- **Bad_Captain** Fixed FindType to allow for spell effects > 127. Observed by bots trying to cure corruption (effectid 369) when client has a mount (summonhorse effectid 113: 369-128-128=113).

- **Bad_Captain** Bots* fixed bot summoning of client corpses, fixed ability to spawn more bots than allowed via server rule (#bot botgroup load was not checking for SpawnBotCount rule), fixed bot issue with receiving buff with Group with Pets target type.

Required SQL: utils/sql/svn/2104_required_group_roles.sql

## 02/11/2012¶

- **Secrets** Fixed two more hanging issues introduced regardless of the item discovery feature was on or off.

- **Secrets** Fixed a hanging issue introduced regardless of the item discovery feature was on or off. Keep in mind the item discovery feature still takes a reasonable amount of time to work, and this will be fixed in a future update.

- **Secrets** Added OP_IncreaseStats for use with the #incstats command (and other things, in due time!)

- **Secrets** Added QueryServ to the VS2008 project in preparation of moving eventlog, hackers, discovered items, and other non-essential database tasks over to it.

## 02/03/2012¶

- **Trevius** Added accout_status field to the discovered_items table to make it easier to remove accidental GM item discovery from the table.

Required SQL: utils/sql/sv/2099_required_discovered_items_account_status.sql

## 01/28/2012¶

- **Trevius** The version field in the zone_points table can now be set to -1 if you want all versions of the zone to inherit the same zone points.

- **Trevius** Added extra option to the "#npcspawn create" command that will try to create the npc_type ID within the standard range for the current zone (zone_id * 1000). Usage: "#npcspawn create 1"

Required SQL: utils/sql/sv/2098_required_zonepoint_version_changes.sql

## 01/14/2012¶

- **Trevius** Added Grid ID to the #npstats command output.

## 01/06/2012¶

- **Trevius** Increased MAX_ITEM_ID to 200000 to match the new item ID max. This is only used for Min Status on items.

## 01/02/2012¶

- **Trevius** Fix for loading buffs on suspended pets.

- Fixed GM Trainers, they should now work as intended.

---

## 2013

*Source: changelog/server/2013/index.html*

# 2013¶

## 12/26/2013¶

- **mackal** Added classes_required to merchantlist (same bitmask as items)

## 12/24/2013¶

Secrets (Akkadius): Perl $client->SilentMessage("Message"); addition, this is a pre-req for a Perl plugin I've shared with EQEmu. This function essentially mimics a player speaking with an NPC * which is used in popup window responses

- **Secrets** Added functionality to Perl for $client->PlayMP3("name of file").

Usage varies, but typically you can place an MP3/WAV/XMI in the EQDir//sounds, pfs, s3d, or root client folder and it will play through this Perl function. Example, $client->PlayMP3("combattheme1.mp3") or $client->PlayMP3("TUTBTrade1.mp3")

All clients except Secrets of Faydwer and 6.2 have their opcodes identified for this function. The struct + supported params is the same throughout versions.

Use $client->PlayMP3 with an invalid sound file to stop playback or simply wait for it to end.

- **KLS** Added functionality to Lua for Client:PlayMP3(filename)

- **KLS** Added functionality to Lua for Client:SendMarqueeMessage(type, priority/opacity, fade_in_time_ms, fade_out_time_ms, duration_ms, msg)

## 12/16/2013¶

- **Kayen** Implemented SE_ArcheryDoubleAttack (Chance to do an extra archery attack)

- **Kayen** Implemented SE_ShieldEquipDmgMod (Increase damage in primary hand if shield equiped)

- **Kayen** Implemented SE_ShieldEquipHateMod (Increase hate generated if shield equiped)

- **Kayen** Implemented SE_TriggerOnAmountValue (Trigger spell if HP/Mana/End bellow X value or num pet on target)

## 12/16/2013¶

- **Kayen** Fix to SE_BlockNextSpellFocus to make it functional again.

## 12/15/2013¶

- **mackal** Moved the blocked buff check down so we get spell effects like on live

- **Kayen** Implemented SE_ReduceHealing (Reduces amount of healing on target by X amount)

- **Kayen** Implemented SE_CastonFocusEffect (Triggers spell as part of a focus, when that focus effect is used)

- **Kayen** Implemented SE_IncreaseHitDmgTaken (Effect is triggered when X amount of damage is taken)

- **Kayen** More fixes for various spell triggers/procs to now properly use their resist modifier.

## 12/14/2013¶

- **mackal** Blocked buffs shouldn't fail, they should just not be applied.

- **JJ** Changed enable/disable recipe to confirm change made.

## 12/13/2013¶

- **Kayen** Implemented additional functionality for SE_CurrentHP utilizing base2 values. (ie limit to body type)

- **Kayen** Implemented SE_MitigateMeleeDamageSP (Partial Melee Rune that only is lowered if melee hits are over X amount of damage)

- **Kayen** Implemented SE_SpellOnAmtDmgTaken (Effect is triggered when X amount of damage is taken)

- **Kayen** Fix for various spell triggers/procs to now properly use their resist modifier.

- **Kayen** Fix to mob->ModSkillDmgTaken(skill_num, value), setting value to -1 will now properly effect all skills.

## 12/11/2013¶

- **mackal** Fixed issue with crippling blow from berserker frenzy not actually doing anything

- **mackal** Fix haste caps

## 12/04/2013¶

- **mackal** Fixed SpellType_Charm case in AICastSpell

## 12/03/2013¶

- **mackal** Added #showspellslist to view a mobs spell list

- **mackal** Fix procing off of unattackable things

## 12/02/2013¶

- **JJ** Bandaid fix to CopyCharacter function.

## 11/29/2013¶

- **mackal** Stacking issues should be resolved now, probably could be optimized more, but went from 3 loops that do stuff to 3 where only 2 really does stuff and one breaks early in most cases, so slightly better

## 11/23/2013¶

- **Secrets** Fixed an issue related to a zone crash where the count of the abilities in an AA was 0, leading to a size 0 buffer issue.

## 11/19/2013¶

- **Secrets** Fixed an issue with two zone crashes reported on PEQ related to the buff restrictions code and AAs.

- **mackal** Partially make use of dot_stacking_exempt (case when it's 1 is implemented, -1 case isn't)

## 11/18/2013¶

- **mackal** Added assistradius to npc_types, defaults to aggroradius if set to 0 (old behaviour)

## 11/17/2013¶

- **Sorvani** fixed leash and tether special abilities to use the specified range correctly.

- **mackal** Rewrote the Mob::_GetMovementSpeed fix an issue that arose from the change on 11/11

- Added the rule Character:BaseRunSpeedCap (default 158) so people can customize what their runspeed cap is. Hardcapped to 225 so stuff doesn't get too crazy.

## 11/16/2013¶

- **Leere** Fixed the drinking message for auto-consume, it will again correctly show up for forced consumption instead.

- **mackal** Added Mob::DoCastingChecks() which will check for various fail conditions while the casting bar is up. This is called after Mob::DoCastSpell() starts the casting and before it returns.

## 11/15/2013¶

- **mackal** Fixed Mob::CalcFocusEffect()'s SE_LimitEffect

- **Leere** Fixed a stacking issue for SE_StackingCommand_Block

## 11/13/2013¶

- **mackal** Implemented bard song effect cap. You can set the base cap with the rule Character:BaseInstrumentSoftCap, defaults to 36 or "3.6" as it is sometimes referred to.

- **mackal** Fix Echo of Taelosia and Ayonae's Tutelage to increase the mod cap instead of further improving the instrument mod

- **mackal** Implemented Singing/Instrument Mastery as an AA bonus.

## 11/11/2013¶

- **mackal** Changed the way walk speed is calculated to allow mobs to have their walk speed equal a 100% movement reduction

## 11/09/2013¶

- **Leere** Fixed Bard mana regen, they now only are affected by items and AA.

## 11/07/2013¶

- **KLS** Added a system to use the BaseData system in the client.

- **KLS** Added an optional utility to import spells, skill caps and base data (will import from ./import and export to ./export).

Be sure to source the SQL and run shared_memory.

## 11/06/2013¶

- **JJ** (Kingly_Krab) Fix for #npcedit qglobal command.

## 11/01/2013¶

- **JJ** Added in-game commands to enable/disable tradeskill recipes

-Commands: #enablerecipe recipe_id, #disablerecipe recipe_id

-Perl: quest::enablerecipe(recipe_id), quest::disablerecipe(recipe_id)

-Lua: eq.enable_recipe(recipe_id), eq.disable_recipe(recipe_id)

## 10/31/2013¶

- **Leere** Add the ability to disable a tradeskill recipe

## 10/28/2013¶

- **Uleat** Client patch prep work for extending usable skill range (no apparent issues with Ti through RoF[12-10-2012] testing * i.e., clients showed proper skills and they didn't crash)

- **Uleat** This final patch aligns the existing server PlayerProfile_Struct with the previous changes. The pp_struct, as well as the character 'pp' blob, remains unchanged in size and alignment. The only difference is that the first trailing 100 bytes of the unknown array have been re-assigned to the skills array, and the unknown array decreased by the same amount.

Notes:

- The existing configuration will allow the use of any new skills up to 99

- Due to this new segment of the blob having never been written to properly, we may have erratic data there that needs to be cleared before use

- None of the new skills are coded to use these 'new' skill slots

- A per-client method will still need to be observed when coding for the new skill uses

## 10/27/2013¶

- **Uleat** Attempted fix for high level (12) debug compile failures

Notes:

- Explicit Windows vs. Linux code was not changed due to my inability to compile Linux code

- Only CMake accessible flags were corrected if adding the 'std' namespace did not correct the issue

- the tag [CODEBUG] was added to failed code identifed by the above note

- 

If you are having compile issues after this patch is committed, look to the changes here first

- 

**Uleat** Changed riposte fail check to proper failure criteria * (x

## 10/24/2013¶

- **mackal** Fix some memory leaks in Mob::SpellOnTarget

## 10/21/2013¶

- **mackal** Changed GetMinLevel return 0 for more cases that EQ uses for some reason ...

- **mackal** Added buff level restrictions, set the Spells:BuffLevelRestrictions to false to have the old behavior.

## 10/18/2013¶

- **Uleat** Expanded the 'Bag Type' enumeration to include all known values. Also, set in place additional 'Bag Type' to 'Skill Type' conversions. Some of these will need to be verified before activation.

- **Uleat** Cleaned up some unused enumerations to show a move towards standardization. More to come...

## 10/12/2013¶

- **mackal** Allow Titanium and lower clients to enter Tutorial zone from character select

- **Bad_Captain** Fixed merc crash issue by updating special_abilities & vwMercNpcTypes (Sorvani).

- **Bad_Captain** Bots* added out of combat bard songs & #bot bardoutofcombat on|off command to turn them on/off.

## 10/11/2013¶

- **JJ** (mackal) Allow use of Go Home button when Tutorial still selected in RoF.

## 10/10/2013¶

- **Secrets** Fixed zone shutdown (or #reloadqst) reinitalization of Perl. This should allow for Perl 5.14 and later to work on Windows under the new quest system.

- **mackal** Beneficial single target buffs shouldn't have their mana/timers set if they fail to cast after the Mob::SpellOnTarget call in Mob::SpellFinished

- **JJ** Revert change to EnterWorldPacket introduced on 22 April 2013 to fix inability to enter Tutorial or Go Home from character select screen.

## 10/09/2013¶

- **mackal** Fixed some more instances of the AA timer being eaten

## 10/08/2013¶

- **mackal** Added IsBuffSpell(spell_id) that will return true if the spell has a duration, so would end up in effects/song/discs etc windows on the client

- **mackal** Replaced instances of using CalcBuffDuration to determine if a spell was a buff with IsBuffSpell

- **mackal** Removed Mob::HasBuffIcon since it was doing what IsBuffSpell does in a more convoluted way with a rather misleading name

- **mackal** Fixed issues that arose from the 10/03/2013 change

## 10/05/2013¶

- **Sorvani** fixed issue with stackable items being created with 0 charges cause by fix to SummonItems

## 10/03/2013¶

- **mackal** Fix when the random +1 tick is added to nerf extension focus effects to where they should be

## 09/30/2013¶

- **Sorvani** Changed SummonItem to only summon an item with max charges when said default value is present and not on zero charges

- **mackal** Fixed issue with #showstats showing your level for a bunch of values

## 09/13/2013¶

- **mackal** Add support for /pet hold on and /pet hold off (UF and RoF)

## 08/29/2013¶

- **KLS** Removed Common Profiler and Zone Profiler. They're well past outdated status and are just code bloat.

- **KLS** Fix for reported issue on forums with skills that could potentially be trained before a player achieved the level to train.

## 08/20/2013¶

- **Uleat** Fix for bot pet spell buff corruption (existing db issues will correct themselves through pet death attrition)

## 07/18/2013¶

- **KLS** Fix for crash in special_abilities code due to existing use of some dangerous code we didn't catch before.

## 07/15/2013¶

- **Sorvani** fix for lua_general.cpp funtion get_spawn_condition

- **Uleat** added non-extensioned wildcard filter to ...\dependencies.gitignore to fix tortoisegit inclusion errors (fixes commit and display overlay issues.)

## 07/13/2013¶

- **KLS** Added packet class and helper functions to Lua.

- **KLS** Added quest event: event_unhandled_opcode

## 07/11/2013¶

- **KLS** Added a few lua functions.

- **KLS** Redid the npcspecialatk system with a new system that is more flexible but a little more complicated (this will break any 3rd party tools that deal with them).

Instead of a string such as "ERS" to denote "Enrage Rampage Summon" abilities are indexed by their ability number, level and params separated by '^'. It is stored in the following format: ability,level[,param0,param1,param2,param3,param4,param5,param6,param7] Params will be read until there are 8 total or a '^' is reached. Eg: 'ERS' -> '2,13,11,1

Levels allow us to dictate how abilities behave that may be different even though they're the same ability. Params allow us to further refine behaviors on a case by case basis. Passing 0 as a param will use the default value.

NOTE: Be sure to source 2013_07_11_NPC_Special_Abilities.sql. Also due to the large impact this has on a database it is very HIGHLY SUGGESTED to BACKUP YOUR DATABASE FIRST.

The following are the special abilities currently in the game as well as their levels and parameters currently in use:

SPECATK_SUMMON = 1 Level 1: Summon target to NPC Level 2: Summon NPC to target Param0: Cooldown in ms (default: 6000) Param1: HP ratio required to summon (default: 97)

SPECATK_ENRAGE = 2 Param0: HP ratio required to enrage (default: rule NPC:StartEnrageValue) Param1: Enrage duration in ms (default: 10000) Param2: Enrage cooldown in ms (default: 360000)

SPECATK_RAMPAGE = 3 Param0: Proc chance (default: 20) Param1: Rampage target count (default: rule Combat:MaxRampageTargets) Param2: Percent of a normal attack damage to deal (default: 100) Param3: Flat damage bonus to add to the rampage attack (default: 0) Param4: Ignore % armor for this attack (default 0) Param5: Ignore flat armor for this attack (default 0) Param6: Percent of npc's natual crit that can go toward this rampage (default: 100) Param7: Flat crit bonus on top of npc's natual crit that can go toward this attack (default 0)

SPECATK_AREA_RAMPAGE = 4 Param0: Proc chance (default: 20) Param1: Rampage target count (default: 1) Param2: Percent of a normal attack damage to deal (default: 100) Param3: Flat damage bonus to add to the rampage attack (default: 0) Param4: Ignore % armor for this attack (default 0) Param5: Ignore flat armor for this attack (default 0) Param6: Percent of npc's natual crit that can go toward this rampage (default: 100) Param7: Flat crit bonus on top of npc's natual crit that can go toward this attack (default 0)

SPECATK_FLURRY = 5 Param0: Proc chance (default: rule Combat:NPCFlurryChance) Param1: Flurry attack count (default: rule Combat:MaxFlurryHits) Param2: Percent of a normal attack damage to deal (default: 100) Param3: Flat damage bonus to add to the flurry attack (default: 0) Param4: Ignore % armor for this attack (default 0) Param5: Ignore flat armor for this attack (default 0) Param6: Percent of npc's natual crit that can go toward this attack (default: 100) Param7: Flat crit bonus on top of npc's natual crit that can go toward this attack (default 0)

Ex: Normal Flurry with 25% proc rate and 100% crit chance that ignores 500 armor. 5,1,25,0,0,0,0,500,0,100

SPECATK_TRIPLE = 6 SPECATK_QUAD = 7 SPECATK_INNATE_DW = 8 SPECATK_BANE = 9 SPECATK_MAGICAL = 10 SPECATK_RANGED_ATK = 11 UNSLOWABLE = 12 UNMEZABLE = 13 UNCHARMABLE = 14 UNSTUNABLE = 15 UNSNAREABLE = 16 UNFEARABLE = 17 UNDISPELLABLE = 18 IMMUNE_MELEE = 19 IMMUNE_MAGIC = 20 IMMUNE_FLEEING = 21 IMMUNE_MELEE_EXCEPT_BANE = 22 IMMUNE_MELEE_NONMAGICAL = 23 IMMUNE_AGGRO = 24 IMMUNE_AGGRO_ON = 25 IMMUNE_CASTING_FROM_RANGE = 26 IMMUNE_FEIGN_DEATH = 27 IMMUNE_TAUNT = 28

NPC_TUNNELVISION = 29 Param0: Aggro modifier on non-tanks (default: rule Aggro:TunnelVisionAggroMod)

NPC_NO_BUFFHEAL_FRIENDS = 30 IMMUNE_PACIFY = 31

LEASH = 32 Param0: Range (default: aggro range * aggro range)

TETHER = 33 Param0: Range (default: aggro range * aggro range)

DESTRUCTIBLE_OBJECT = 34 NO_HARM_FROM_CLIENT = 35

The following Lua API functions were added to deal with the new system: Integer GetSpecialAbility(Integer ability); Integer GetSpecialAbilityParam(Integer ability, Integer param); Void SetSpecialAbility(Integer ability, Integer level); Void SetSpecialAbilityParam(Integer ability, Integer param, Integer value); Void ClearSpecialAbilities(); Void ProcessSpecialAbilities(String str);

The old API functions that worked with letters still exist for backwards compatibility reasons but wont be updated further.

## 07/08/2013¶

- **Secrets** Cleanup of some log functions that did not have an 'off' function.**

- **Secrets** Unknown opcode messages only show on EQDEBUG* >= 5 or higher now. (including the dumped packet)

_NOTE: We recommend for debugging and feature development that you keep EQDEBUG to 5 or higher. For production environments, we recommend 1 to help with CPU performance on windows machines and disk I/O on all platforms. *_Affected filters: NET**ERROR NET**DEBUG

## 07/05/2013¶

- **KLS** Added some lua functions

- **KLS** Fixed some lua functions

- **KLS** Perl now will (like lua) keep track of the values you return from EVENT_*. This allows perl to use the extra behavior in things like EVENT_DEATH. Now generally the perl system is now considered deprecated (in favor of lua in the long term) I felt this was too big a change to pass up adding when I got it working.

## 07/02/2013¶

- **KLS** Exported eq.follow(entity_id, [distance]) and eq.stop_follow() to lua.

## 07/01/2013¶

- **mackal** Fix Monster Summoning related to giants/cyclops

- **mackal** Prevent Monster Summoning from summoning a portal in bothunder

- **KLS** Merge of lua branch to master

See: http://www.eqemulator.org/forums/showthread.php?t=37008 for more detailed information on what is added.

Upgrade notes:

-'templates' quest folder needs to be renamed 'global'

-'items' quest folder needs to be moved into the 'global' folder

-'spells' quest folder needs to be moved into the 'global' folder

-EVENT_PROXIMITY_SAY needs to be enabled via quest before it will work, calling quest::enable_proximity_say() in EVENT_SPAWN will suffice.

-quest::handleturnin, quest::completehandin, quest::resethandin, and quest::clearhandin have been removed. Take a look at https://code.google.com/p/projecteqquests/source/browse/trunk/quests/plugins/check_handin.pl plugin::mq_process_items, plugin::check_mq_handin, plugin::clear_mq_handin for MQ viable replacements.

-Some spell quests that overwrote the effects from the spell they were cast on no longer function properly on perl, it's suggested you make the spells empty or rewrite the broken quests in lua and return a non-zero value.

-Some item quests have changed in a subtle way, though it's unlikely any quests are impacted and the thread has more information if you found any of your quests broke. As far as I know for example: PEQ didn't have to update any of its nearly 70 item quests.

-Cazic Touch (982) no longer shouts the name of the thing it is targeting without a script.

-EVENT_DEATH now triggers before the death is complete. For the old functionality you may use EVENT_DEATH_COMPLETE. It might be a good idea to replace all EVENT_DEATH with EVENT_DEATH_COMPLETE in existing spells.

We sought to minimize changes required but it's still a bit disruptive so take a few minutes when upgrading to make sure everything is correct. Most notably quest::clearhandin was used in some popular plugins to avoid a dupe involved with its code and now that it's gone those will not function if fixes are not applied.

## 06/16/2013¶

- **Secrets** Fixed an issue with RoF items and Req/Rec level above 100 appearing yellow. Recommended to enable the #iteminfo command for items that have a req/rec above 100 to display proper information regarding the info.

## 06/15/2013¶

- **KLS** (image) Potentially could bypass some spell checks by passing a specially crafted spell slot. This has been addressed.

## 06/12/2013¶

- **KLS** Merge Hateborne's hp cap stuff

- **KLS** We haven't updated changelog in a while but there's been:

-Some string stuff

-A lot of fixes to things like caps.

-More work on custom mod stuff (including examples)

-Fix for login not bailing out if it cant connect to a db

-Quite a few warning changes.

## 05/09/2013¶

- **Uleat** (Updated: 06/12/2013) Fixed a few observed bot issues and an beneficial AE casting bug:

Added missing Bot primary weapon proc call (secondary and ranged already exist)

Added Bard Bot instrumentation bonuses

Added checks to avoid AE Buff casting on enemy mobs

Fixed a few typos in 'Vah Shir'-related code

(Please post any discrepancies as bugs)

## 05/05/2013¶

- **Tabasco** Added EVENT_ITEM_TICK for interactive item quest scripts. (See https://github.com/josheb/quests_dc/blob/master/items/12204.pl)

Added simple account flags. Would this work better as an additional qglobal category?

Added SendMessage to EQW, useful for using CURL to broadcast to the server.

Added WorldShutDown to EQW for timed world shutdowns, also updated console worldshutdown command to optionally use timed behavior.

Added numerous modding hooks and mod_functions.cpp for easy custom formulas or future lua integration.

Added various rules for monk AC bonus weight, archery bonuses, kick/bash stuns and mob stun levels.

required SQL: 2013_05_05_Account_Flags.sql

required SQL: 2013_05_05_Item_Tick.sql

## 04/28/2013¶

- **PiB** Implement CRC16 using CRC32.

## 04/27/2013¶

- **PiB** Verify OP_Ack size & fix crash in BasePacket::build_raw_header_dump due to uninitialised timestamp.

- **Derision** Verify minimum size of OP_Packet, OP_Fragment and OP_OutOfOrderAck.

## 04/24/2013¶

- **Bad_Captain** Fixed a couple of merc stat issues.

- **Bad_Captain** Removed unneeded bot pet AI.

- **Bad_Captain** Fixed a few bot aggro issues. (Uleat)

## 04/20/2013¶

- **JJ** Fixed rare case where heals from buffs could go negative.

## 04/12/2013¶

- **Derision** Moved entity_list.Clear() prior to destruction of Perl objects in zone shutdown as I was seeing a segfault due to attempts to call EVENT_HATE_LIST as mobs were being destroyed.

## 04/09/2013¶

- **mackal** Realized I was an idiot, changed salvage script to be better

optional SQL: 2013_04_09_SalvageCleanOld.sql * run if ran old script

## 04/08/2013¶

- **mackal** Implemented Salvage AA

required SQL: 2013_04_08_Salvage.sql

script: generate_salvage.py * will generate the entries for some exceptions for salvage returns.

## 04/04/2013¶

- **mackal** Implemented SE_ForageAdditionalItems as a bonus

required SQL: 2013_04_04_NaturesBounty.sql

## 04/03/2013¶

- **mackal** Overloaded Mob::Say_StringID with the option to provide a message type

- **mackal** Switched rest of the Pet Messages to MT_PetResponse (Leader commands intentionally left the old way)

## 04/2/2013¶

- **Bad_Captain** Fixed Merc lack of use of heal over time spells (causing excessive healing).

- **Bad_Captain** Fixed pet mitigation/AC issues.

## 04/01/2013¶

- **mackal** AA reuse timers now start when you hit the button and are reset upon failure

- **mackal** Instant Cast bard AAs can now be used while singing a song

## 03/30/2013¶

- **mackal** Fixed most of the pet talking, all use StringIDs now. Pet now informs you when it taunts.

## 03/23/2013¶

- **mackal** Fix issues with escape not always working and fixed SE_FadingMemories to have the message since the message isn't part of the spell data.

Escape now uses just the spell and not the AA Actoin

Fading Memories now only uses the AA Action to eat mana

## 03/21/2013¶

- **Bad_Captain** Fixed merc buffing bugs.

- **Bad_Captain** Added checks before dismissing merc to prevent possible bugged mercs.

- **Bad_Captain** Merged in Secret's merc memory leak fixes.

## 03/20/2013¶

- **mackal** Fixed stacking issues with SE_Limit* (ex. Unholy Aura Discipline and Aura of Reverence)

## 03/18/2013¶

- **Bad_Captain** Fixed zone crash due to merc focus effects & tribute.

- **Bad_Captain** Fixed merc aggro issues when client in melee range & spell recast timers.

- **Bad_Captain** Added melee DPS spells/disciplines & support.

## 03/17/2013¶

- **Secrets** Fixed that pesky merc memleak.

- **Secrets** Bit of code cleanup regarding mercs.

## 03/15/2013¶

- **Derision** RoF: Added ENCODE for Resurrect_struct (Accepting a rez should now work).

- **Derision** Fixed a couple of memory leaks in Rez code.

## 03/14/2013¶

- **JJ** (NatedogEZ) Fix for hate list random never selecting last member of hate list.

- **Bad_Captain** Fixed Merc spell recast timers.

- **Bad_Captain** Changed how Mercs add mobs to their hate lists (should prevent IsEngaged() issues).

- **Bad_Captain** Initial Caster DPS Merc spell casting AI, including initial Merc stance implementation.

- **Bad_Captain** Mercs now suspend when their owner dies to prevent them being bugged (until it can be fixed).

OPTIONAL SQL: 2013_03_14_Merc_Spells.sql

## 03/09/2013¶

- **Zaela_S** Stop mobs aggroing on dead players when using RespawnFromHover.

- **Derision** Removed _log message from zone/CatchSignal on Linux as it can deadlock on shutdown if another signal is received while the _log call is being processed.

- **Derision** Added some error logging into ZoneDatabase::NPCSpawnDB for #npcspawn create.

## 03/07/2013¶

- **af4t** Melee tomes with names beginning "Skill:" (e.g. RNG Warder's Wrath, etc) can be memorized now, by hand-in-to-guildmaster or right-click-from-inventory.

## 03/02/2013¶

- **af4t** Stop NPCs aggroing each other with buffs/beneficial spells.

## 03/2/2013¶

- **Bad_Captain** Fixed Merc depop bug.

- **Bad_Captain** Added merc rest regen.

- **Bad_Captain** Fixed merc group spell casting bug where mercs would continue to try to cast group buffs on pets of caster who didn't have Pet Affinity AA.

## 03/1/2013¶

- **Bad_Captain** Fixed Merc duplicate save bug.

- **Bad_Captain** Focus items, spell_scale and heal_scale now work implemented and new merc equipment (with focus items).

- **Bad_Captain** Added checks during merc hire, unsuspend, & timer update for states where a merc can't be hired, unsuspended, or can't be retained due to insufficient funds, no room in group, in raid, invalid merc data, etc, and give appropriate feedback.

- **Bad_Captain** Added rules for charging of merc purchase and upkeep costs.

REQUIRED SQL: 2013_03_1_Merc_Rules_and_Equipment.sql

## 02/27/2013¶

- **KLS** Changed how shared memory works: Instead of System V/windows pagefile shared memory we now have shared memory that's backed by the filesystem. What that means is basically instead of EMuSharedMem(shared library) we now have shared_memory(executable), shared memory will be persistent between runs until you delete or reload it using the shared_memory executable.

STEPS FOR PEOPLE WHO CAN'T BE BOTHERED TO FIGURE IT OUT: 1) Create a directory in the place you run world/zone named shared and make sure files can write there. 2) Run the shared_memory executable from the same place you run world/zone (it's basically doing the loading we would do on startup so will take a moment). 3) Run world/zone/whatever

## 02/25/2013¶

- **af4t** Add Touch of the Wicked AA redux to SK Improved Harm Touch and Leech Touch.

## 02/22/2013¶

- **mackal** Mobs will now be removed from XTargets when they get back to their way point, should be last instance of XTarget mobs not clearing when they are not aggroed anymore

## 02/19/2013¶

- **Derision** World should no longer crash if the start_zone query fails at character creation.

## 02/18/2013¶

- **Bad_Captain** Moved merc save to merc table, save merc buffs, added cure and rez spells to healer merc.

- **JJ** Chat garbled for drunk characters.

- **Derision** Charmed pets should no longer be targettable with F8. Charmed pets no longer get a surname of Soandso's Pet.

- **mackal** Added potionbelt tool tip

- **KLS** Added EVENT_DEATH to Player Quests

REQUIRED SQL: 2013_02_18_Merc_Rules_and_Tables.sql OPTIONAL SQL: 2013_02_18_Merc_Spells.sql

## 02/17/2013¶

- **Derision** Added optional guildid and minstatus parameters to quest::gmsay(, [color], [toworld], [guildid], [minstatus])

- **Derision** Client version is now returned by the stream proxy as a number.

- **Derision** Fixed bug where BecomeTrader packets were only being sent to the Trader, not all other clients in the bazaar.

## 02/16/2013¶

- **mackal** Fix AA reuse timer calc

- **mackal** Remove old filters and change all remaining old to new (Also fix Auction filtering out OOC as well due to incorrect define)

## 02/12/2013¶

- **Kayen** AA fix

REQUIRED SQL: utils/sql/svn/2504_required_aa_updates.sql

## 02/11/2013¶

- **Derision** RoF: Added ENCODE for OP_BeginCast (fixes no sound during spell casting). Corrected OP_DeleteSpell.

## 02/10/2013¶

- **JJ** (mackal) Language skill up should use proper function.

- **JJ** SetLanguageSkill now updates client immediately. Both functions do proper limit checks.

Added two missing languages. Skill level 0 in a spoken language now shows 'in an unknown tongue'.

- **JJ** Initial implementation of a GarbleMessage function and implemented for languages. Can be shared with drunk speaking.

## 02/09/2013¶

- **KLS** Was pointed out to me that we're in violation of ActiveState Licensing terms for their perl distribution.

To rectify this we have removed the Windows perl binaries from the source.

## 02/06/2013¶

- **Uleat** Changed conversion of bot armor colors from long to unsigned long. Conversion error led to #FFFFFFFF for all returns.

## 02/05/2013¶

- **cavedude00** Added heading to start_zones

- **Uleat** Fixed the 'nude' bot issue. Mob::texture was not set to the appropriate value and forcing an unclad body model.

- **Uleat** Fixed the show/hide helm feature. Added rebroadcast of packet so that changes take place immediately instead of after zoning.

- **KLS** Addressed several (completely stupid and inexcusable) bugs in the avoidance code that made it impossible to dodge and parry in certain situations.

As a note: please don't touch the avoidance code if you don't know what you're doing, seriously.

Required SQL: utils/sql/svn/2482_required_start_zones.sql

## 02/03/2013¶

- **Trevius** RoF: More work on Bazaar Traders.

- **Sorvani** Items with more than 1 charge should be purchased at max charges again. This does not fix players recharging by sell/buyback method. That will come in the future.

## 02/02/2013¶

- **Trevius** RoF: Fixed some opcodes related to surnames and traders. Surnames can now be cleared.

- **JJ** Fix to #spawn: Automatically truncate name if too long so spawn will happen as expected rather than a NameTooLong NPC.

- **JJ** Fix to #spawn: Output actual NPC result after creation rather than projected result before.

## 02/01/2013¶

- **Trevius** RoF: Loading Spell Sets now unmems spells before meming the new set.

- **Trevius** RoF: Turning on Trader mode in bazaar now works, but no further trader functionality is available yet.

- **Akkadius** Fixed an issue where global_npc.pl was not initializing (initially)

## 01/31/2013¶

- **cavedude00** (mackal) Rune aggro fix

- **cavedude00** (Drajor) Tradeskill skillneeded fix.

## 01/30/2013¶

- **Kayen** Various AA fixes, mostly related to SOF display issues.

REQUIRED SQL: utils/sql/svn/2471_required_aa_updates.sql

## 01/29/2013¶

- **Secrets** Another attempt to fix this bot/merc group crash on zoning.

- **cavedude** Added $client->GetInstanceID() Perl export.

## 01/28/2013¶

- **Secrets** Fixed a crash issue involving invalid buff slots in SpellEffect code. (Crash fix.)

- **Secrets** QuestParserCollection no longer processes EventPlayer in the case that a player zones and the group is still valid via linkdeath. (Crash fix.)

- **Secrets** Added the command #augmentitem. Does the same thing that the #bot augmentitem command does but without the bot command needing to be active. Default 250 status.

- **JJ** Added quest::depop_withtimer() which will depop NPC and start spawn timer (a replacement for $npc->Depop(1) code if desired)

## 01/27/2013¶

- **Trevius** Fixed a bug introduced in Rev2448 that caused some spell casting to use all of a player's mana.

- **Trevius** Mercenary buffs now display in the Target Buffs window.

- **Trevius** RoF: Populated a couple more bit fields in the spawn struct.

- **Trevius** Mercenaries are no longer targetable with NPC targeting hotkeys.

## 01/26/2013¶

- **Derision** RoF: Updated spell buffs in the PP to account for instrument_mod/bard_modifier.

- **Sorvani** Missed a spot on the stun proc aggro change.

- **Trevius** Fixed Mercenary Upkeep Timers and Stances again for UF and SoD.

- **Trevius** Fixed Mercenary Upkeep Timers to properly restart after the timer is up for all clients.

- **Bad_Captain** Mercs * Initial spell casting AI committed.

- **KLS** Added crash logging for Windows builds.

- **Trevius** Mercenaries now despawn when a player camps out or disconnects in any way.

- **Trevius** Players with a Mercenary spawned can now be invited to and join another group with their mercenary.

- **Sorvani** (mackal): Moved stunproc rule implmentation to catch all cases

OPTIONAL SQL: utils/sql/svn/mercs.sql -* rerun for updated merc stats & merc spell lists

## 01/25/2013¶

- **Sorvani** Implemented max aggro from stun proc set to 400. It is rule based set rule to -1 for unlimited.

- **Derision** RoF: Should fix x10 Buff bug.

- **Trevius** Reworked some of the code dealing with Mercenary packets and spawning them. There is still some work to be done, but the basics are more solid now.

- **Trevius** Mercenaries function much more consistently now for Hiring, Suspending, Unsuspending, Dismissing.

- **Trevius** Mercenaries no longer fail to group up after being hired, unsuspended or after zoning/logging in.

## 01/24/2013¶

- **Trevius** RoF: The #fixmob command can now go up to race 724 when cycling through races.

- **Trevius** RoF: The #npcstats command no longer truncates itemlinks.

## 01/23/2013¶

- **Trevius** RoF: Corrected multiple opcodes.

- **Trevius** RoF: Apply Poison is now functional.

- **Trevius** RoF: /getguildmotd is working.

- **Trevius** RoF: GM commands /changename, /summon, /emotezone, and /emoteworld are working.

- **Trevius** RoF: Sense Traps is now working.

- **Trevius** RoF: Potion Belt is now functional.

- **Trevius** RoF: /who and /who all now display the correct player counts.

## 01/21/2013¶

- **Akkadius** Should have fixed some scenarios where the global_npc.pl script wasn't unloading correctly

- **Trevius** RoF: Alternate Currencies now display correctly in the inventory window.

- **Trevius** Changed one of the mercenary data packets to use the same packet Live does instead of the Merchant packet.

- **Uleat** RoF: Aligned the extended client slots back into slottype 0. Previously, corpse looting stopped after looting the ninth slot. (There's still an issue addressing slots 31 and 32..this cannot be efficiently corrected until an inventory rework is performed.)

- **Uleat** Fixed a corpse looting issue where the power source item (slot 9999) was being omitted from the corpse inventory. A previous oversight on my part. Also refined message reporting. (RoF: increased corpse slot limit to 34)

- **Uleat** Power Source items will now report in 'worn' instead of 'inv' when using #peekinv.

## 01/20/2013¶

- **KLS** intN types have changed to more closely reflect C99 and C++11 types:

intN was an unsigned int of N bits -> it is now a signed int of N bits.

sintN was a signed int of N bits -> it has been removed in favor of intN.

uintN is still unsigned.

The existing types in the code have been changed automatically(intN -> uintN, sintN -> intN), but keep this in mind when developing in the future.

## 01/19/2013¶

- **Akkadius** Implemented global_npc.pl, this is very similar to global_player.pl where any normal NPC script will run dual-stack or in tandem with the global_npc.pl located in the templates folder

- **Akkadius** Implemented the ability to modify EXP and AAEXP modifiers per Level, these are loaded from an optional table (level_exp_mods) that is attached to the commit, you MUST enable the rule first!

- **Akkadius** Added #reloadlevelmods * which will reload level mods from the `level_exp_mods` table

- **Derision** RoF: Guild name now appears in the Guild Management window and over player's heads. /guildstatus now works. Guild members status now updates in the GMW.

- **Uleat** Corrected the BulkSendInventory process for incomplete item trade returns resulting from a server crash. Previous code used an external reference and items were never moved..and hence, lost once a new trade occurred.

- **Uleat** Added mlog messages to existing BulkSendInventory code to report hidden item movements and deletions. All BSI and helper processes now log movements/deletions.

- **Uleat** Added two new client pre-entry inventory validation methods * RemoveDuplicateLore and MoveSlotNotAllowed. Duplicate lore was not checked and IsSlotAllowed failures were not handled. Both were causes of persistent desyncs.

- **Uleat** Corrected a bug in ItemInst::IsSlotAllowed that 'passed' PowerSource slot checks regardless of ItemInst::Slots value.

- **Uleat** [Client-Server Inventory Desyncronization] Most CSD bugs should now be corrected, or at least, compensated for. Please post any desync issues as a new bug post or pm a Dev or GM if it involves an exploit.

Optional SQL: \utils\sql\svn\2428_optional_levelbasedexpmods.sql

## 01/18/2013¶

- **Akkadius** Fixed an size value of hp_regen_rate for NPC's so values don't roll over into negative values

- **KLS** EQEmu has been setup to use CMake, this is mandatory.

Visit http://www.eqemulator.net/wiki/wikka.php?wakka=CMake for instructions on Windows/GCC.

## 01/17/2013¶

- **Uleat** Added opcode handlers for OpenInventory(SoF and SoD) and OpenContainer(SoF, SoD, UF and RoF). Both still need slot translators.

- **Uleat** Changed internal SwapItem method from void to bool return. Added appropriate code to handle returns.

- **Uleat** Added an abbreviated form of the resync code * SwapItemResync. Handles failed item swaps on a case-by-case basis.

- **Uleat** Fixed a bug that allowed duplication of non-stackable, charged items..lore or otherwise. (Sorry cheaters...)

## 01/16/2013¶

- **Derision** RoF: Updated OP_LogServer encode based on a live packet in order to enable 'Enter Tutorial from character select.

- **Secrets** Added five new functions to perl for clients: GetBindX, GetBindY, GetBindZ, GetBindHeading, and GetBindZoneID. They all have an optional parameter of index of playerprofile's bindpoint.

- **Secrets** Added an optional parameter to GetBind for index.

## 01/15/2013¶

- **Derision** RoF: Added Encode for OP_TaskDescription and removed RoF specific code for it from tasks.cpp

- **Derision** Fixed some compiler warnings.

- **Trevius** RoF: Varlinks and Saylinks now display properly for RoF.

- **Trevius** RoF: Started work on Mercenaries. They are partially functional but need more work.

- **Trevius** RoF: Started work on Guilds. The guild window can now display members, but the guild name does not yet display.

## 01/14/2013¶

- **Derision** RoF: Fixed bug that was causing only one task to show in the Active Task window.

- **Derision** Fixed potential crash in QuestManager::varlink. Removed some unused variables that gcc was warning about.

## 01/13/2013¶

- **Derision** RoF: Encoded OP_TaskHistoryReply and added temporary handling for short OP_TaskActivity packets until encode is down for that.

- **Derision** Deleted Anniversary/HoT/VoA and Live patches.

- **Derision** Updated StaticGetZoneName with all zones currently in the PEQ database.

- **Trevius** RoF: Disciplines now update without zoning.

## 01/12/2013¶

- **Derision** RoF: Personal Tribute and the Pet Buff Window now work.

- **Derision** Fixed potential crash in SendPetBuffsToClient.

- **Derision** RoF: Accounted for the fact the Duplicate Lore item message now includes the item's name.

- **Trevius** RoF: The Task Selector Window is now functional.

## 01/11/2013¶

- **JJ** Added rule check to zone * no need to load Merc Templates if Mercs aren't allowed.

## 01/10/2013¶

- **Trevius** RoF: Corrected multiple opcodes.

- **Trevius** RoF: #finditem now displays itemlinks correctly.

- **Trevius** RoF: Started work/testing to get Tasks functioning. Don't click tasks in the history tab or client will freeze.

- **Trevius** Added some possible crash fixes.

- **Bad_Captain** Mercs * temp fix for possible crash when dying with RespawnFromHover on, fixed infinite stats (buffs continually adding to stats).

## 01/09/2013¶

- **Derision** RoF: Corrected LDoN merchant opcodes, added encode for OP_AdventureMerchantSell. Updated PP with available LDoN points.

- **Bad_Captain** Mercs * removed debug messages, fixed regen.

## 01/08/2013¶

- **Derision** RoF: Marked position of Monk 'Mend' skill cooldown timer in PP. Fixed a typo.

- **Bad_Captain** Mercs * Merged from branch. Initial merc commit to trunk with semi-functional tank mercs.

- **Uleat** RoF: Changed opcode so that is handled properly. (Was writing to the log about twice-per-second.)

- **Trevius** RoF: Death no longer crashes players and the respawn window is now functional.

- **Trevius** RoF: More work on slot conversions. This time for the cursor buffer.

- **Trevius** RoF: Some work on Guild Master Training packets, but still only seeing languages displayed.

REQUIRED SQL: utils/sql/svn/2383_required_group_ismerc.sql - *adds ismerc column to group_id table OPTIONAL SQL: utils/sql/svn/2380_optional_merc_rules.sql -* Contains rules for mercs including rule to enable mercs OPTIONAL SQL: utils/sql/svn/2380_optional_merc_merchant_npctypes_update.sql - *Contains npc_types & spawn updates for merc merchants in PoK OPTIONAL SQL: utils/sql/svn/2380_optional_merc_data.sql -* Contains basic merc data, template info, & merc merchant entries OPTIONAL SQL: utils/sql/svn/mercs.sql - *Contains merc stats & armor* to be replaced as needed with updated stats, spells, etc. Allows a complete resourcing of file

## 01/07/2013¶

- **Trevius** RoF: /who and /who all now function properly.

- **Trevius** RoF: Adjusted/corrected some of the slot conversion functions.

- **Kayen** Various AA Fixes including a critical crash bug.

REQUIRED SQL: utils/sql/svn/2376_required_aa_updates.sql

## 01/06/2013¶

- **Kayen** Fix for missing and incorrect Healing Adept AA values.

- **Trevius** RoF: Possible crash fix for logging in on some server builds.

- **Trevius** RoF: Added VoA to the #cvs command output.

- **Derision** RoF: Short buffs should appear in the song/short buff box.

Lerxst/ **Hateborne* Updated Mob::TryDivineSave to allow someone to be saved even if there are no additional effects to be cast and rearranged the buff fading so the spell effect isn't lost before it can be cast.

REQUIRED SQL: utils/sql/svn/2370_required_aa_updates.sql

## 01/05/2013¶

- **Trevius** RoF: Tradeskill combines (auto-combine and experiment) are now functional.

- **Trevius** RoF: The Popup Message window is now functional.

- **Trevius** RoF: Increased the max race id for #race to 724 (the max for RoF).

- **Trevius** RoF: Corrected the opcode for Augmenting Items and adjusted the struct, but it looks like it may require considerable work to implement the new augment system.

- **Akkadius** Trap Zone Crash issue where message is empty

- **Akkadius** Fixed a warning regarding AC

- **Vaion** RoF: Books now work properly.

## 01/04/2013¶

- **Trevius** RoF: Looting items and loot all are now functional.

- **Trevius** RoF: Trading to NPCs and Players is now functional.

- **Trevius** RoF: AA Purchases are now functional.

- **Trevius** RoF: Opening Tradeskill Objects is now possible.

- **Trevius** RoF: Moving items into Tradeskill Objects is now possible, but combines will bug the client.

- **Uleat** QS: Added 4 additional logging options [MerchantLogTransactions], [PlayerLogDeletes], [PlayerLogHandins], [PlayerLogMoves]

- **Uleat** QS: PlayerLogHandins is partially enabled..currently logs NPCtypeID and Client-side trade information only.

- **Uleat** QS: Renamed 1 existing source files to maintain logging name continuity [PlayerLogTrades].

- **Uleat** Fixed minor issue that was causing armor glitches with RoF clients from UF and lower clients.

- **Uleat** Fixed minor bug in the #iteminfo command where the material value reported 0x20xx.

REQUIRED SQL: utils/sql/svn/2361_required_qs_rule_values.sql REQUIRED SQL: utils/sql/queryserv/2361_QueryServ.sql REQUIRED SQL: utils/sql/queryserv/2304_QueryServ.sql (rename '2304_qs_playertradelog.sql' * Does not need to be re-sourced)

## 01/03/2013¶

- **Trevius** RoF: Fixed slot conversion issues for Bank and Shared Bank

- **Trevius** RoF: Normal Merchants are now fully functional for buy/sell

- **Trevius** RoF: Item Links now display item stats when clicked, but the links are still truncated.

- **Trevius** RoF: Corrected the Illusion Struct and corrected some opcodes.

- **Trevius** RoF: Updated the DeleteSpawn struct and added an encode for it.

- **Trevius** RoF: Hopefully fixed Consuming food/drink.

## 01/02/2013¶

- **Vaion** RoF: Crash prevention for Item Preview window.

- **Trevius** RoF: Finished identifying basically all of the remaining RoF opcodes.

- **Akkadius** Fix for Guild Crash again...

---

## 2014

*Source: changelog/server/2014/index.html*

# 2014¶

## 12/30/2014¶

- **Trevius** (RoF2) Aug Type 21 no longer shows the "Buy Now" button in the aug slot of items.

- **Trevius** (RoF2) Identified the "Copied" item flag with the help of Uleat.

## 12/29/2014¶

- **Trevius** (RoF2) Identified a few Item Fields and resolved an issue with cloth armor not accepting certain augments that they should.

- **Akkadius** Updated $client->UpdateTaskActivity to have optional argument ignore_quest_update IE: Client::UpdateTaskActivity(THIS, TaskID, ActivityID, Count, [ignore_quest_update])

- **Akkadius** Also updated internal UpdateTaskActivity methods to optionally ignore quest based task updates to prevent feedback

## 12/28/2014¶

- **Uleat** Implemented class Client::TextLink as a replacement for the dozens of individual link formatters.

## 12/27/2014¶

- **Akkadius** Add option to automatic database upgrade script 5) Download latest Opcodes from Github

- **Trevius** (RoF2) Fixed dropping items on the ground so they go to ground level instead of camera height.

- **Trevius** Show Helm Option should be functional again.

- **Kayen** Implemented npc special ability (43) CASTING_RESIST_DIFF which sets innate resist modifier on ALL spells used by that NPC. Ie. 43,1,-200 will set a -200 innate resist diff, so if your npc cast

a spell that has a -10 resist modifier the final resist diff would be -210.

## 12/25/2014¶

- **Uleat** Updated 'links' code for all clients

## 12/24/2014¶

- **Trevius** (RoF+) Added herosforgemodel field to the npc_types table.

- **Trevius** (RoF2) Updated item links from #npcstat command output.

- **Trevius** (RoF+) Implemented Hero's Forge Armor for NPCs. Set the herosforgemodel field in npc_types table to the model (example: 84 for full set, or 12107 for robe).

- **Trevius** (RoF+) Hero's Forge Armor now overrides NPC texture settings. To display Hero's Forge Armor Helms, set helmtexture field to anything other than 0.

## 12/23/2014¶

- **Uleat** Tidied up some ItemInst* declarations and added some nullptr checks.

- **Trevius** (RoF+) Added support for Hero's Forge Robe Models. Set herosforgemodel field in items table to exact model such as 11607, 11707, etc.

## 12/22/2014¶

- **Trevius** (RoF2) Fixed Tracking.

- **Trevius** (RoF+) Added a work-around for the cursor buffer issue.

## 12/21/2014¶

- **Trevius** (RoF2) Fixed Extended Targets Window by correcting opcodes.

- **Trevius** (RoF/RoF2) Fixed Guild Rank in the Player Profile, which prevents the guild rank message on login/zone.

## 12/20/2014¶

- **Akkadius** Updated #cvs to display RoF2 Client Stream count

## 12/19/2014¶

- **Trevius** (RoF2) Fixed Leadership AA Purchasing and Recipe Search by correcting opcodes.

- **Trevius** Fixed Armor Tinting (players and NPCs) that was broken during a previous update.

- **Trevius** (RoF2) Fixed Rest Timer, Show Helm Option, Auto-Consent Options, and identified Krono in the PP.

- **Trevius** Fixed Selling for Alternate Currency Merchants for RoF and RoF2.

## 12/18/2014¶

- **Trevius** Finished lining up the RoF2 Player Profile Struct. Zone times are now normal, and everything from the PP is accurate in game now.

- **Trevius** Fixed zoning after death for RoF2.

## 12/17/2014¶

- **mackal** Use vectors for route stuff, should be more CPU cache friendly so faster

- **Secrets** EQStream changes as recommended by a community member in private.

## 12/15/2014¶

- **Trevius** (RoF+) Implemented the 6th Augment Slot for Items.

- **Trevius** Player Corpses now saved attuned settings for Items.

Info

**Required SQL** utils/sql/git/required/2014_12_15_multiple_table_updates.sql

## 12/13/2014¶

- **mackal** Fix guild rank spam on zone (needed to be in OP_PP).

- **Trevius** (RoF+) Implemented Armor Ornamentation using Hero's Forge Armor Models. To use, create an ornamentation augment and set the herosforgemodel field in the items table.

- **Trevius** (RoF+) Added command #heromodel (#hm for short) * Usage: #heromodel [hero forge model] [ [slot] ] (example: #heromodel 63)

Info

**Required SQL** utils/sql/git/required/2014_12_13_inventory_table_update.sql

## 12/12/2014¶

- **mackal** Add special attack 42, Ignore Root Aggro Rules. This allows you to root a mob and have them still use the normal aggro rules (so they will attack the one with most hate, not closest)

## 12/09/2014¶

- **Trevius** (RoF+) Implemented Hero's Forge Armor Models for Items. To use, set herosforgemodel field in the item table to a model number such as 63 (for example).

- **mackal** SoF+ swarm pets will no longer be F8able (without a hack!)

## 12/08/2014¶

- **Secrets** Added a feature that allows an EQ client to log in directly to World without having to enter the LoginServer, provided the 'password' field is set in WorldServer.

## 12/04/2014¶

- **Kayen** Ranged attacks will now more accurately check MAX firing range, fixing the issue where you would

hit ranged attack and nothing would happpen due to incorrect server side range checks.

- **Trevius** Initial addition of the RoF2 client from May 10th 2013 (currently available on Steam as the F2P client).

- **Trevius** RoF2 is disabled by default, but you can enable by editing /common/patches/patches.cpp (see comments)

## 12/01/2014¶

- **Trevius** Mercenaries now spawn as the same Gender and Size of the Merchant they are purchased from.

- **Trevius** Mercenaries now spawn with randomized facial features when purchased.

- **Trevius** Setting a lastname for NPCs will now override any hard coded lastname (such as GM Trainers).

Info

**Required SQL** utils/sql/git/required/2014_12_01_mercs_table_update.sql

## 11/28/2014¶

- **Trevius** Fixed a zone crash related to numhits for spells.

- **Trevius** Fixed a query related to group leaders logging in.

Trevius (Natedog): Fixed a world crash related to attempting to join an adventure with Mercenaries.

## 11/27/2014¶

- **Kayen** Projectiles (ie Arrows) fired from archery will now do damage upon impact instead of instantly (consistent w/ live).

Info

**Optional SQL** utils/sql/git/optional/2014_11_27_ProjectileDmgOnImpact.sql

## 11/25/2014¶

- **Trevius** Spells that modify model size are now limited to 2 size adjustments from the base size.

- **Trevius** Fix to prevent Mercenaries from being set as Group Leader.

## 11/24/2014¶

- **Trevius** Added Rule NPC:EnableMeritBasedFaction (disabled by default) * Allows faction gain to work similar to experience.

## 11/22/2014¶

- **Trevius** Grouping with Mercenaries is now considerably less buggy.

- **Trevius** Fixed an issue with Spell Globals related to high Character IDs.

- **Trevius** Crash fix for Swarm Pets.

## 11/19/2014¶

- **Trevius** Mercenaries now Dismiss, Suspend, Unsuspend, and Die correctly.

## 11/18/2014¶

- **Trevius** Mercenaries can now zone once again.

## 11/17/2014¶

- **mackal** Correct OP_AugmentInfo reply. This fixes RoF display issue with Adventurer's Stone. Still issues with UF/SoF/SoD though.

## 11/16/2014¶

- **mackal** fix size issue with ControlBoat_Struct and exploit fix in OP_BoardBoat

- **Akkadius** Implemented Automatic Database update and versioning system

- **Akkadius** Created database revision define, this is located in version.h in common #define CURRENT_BINARY_DATABASE_VERSION 9057

- This revision define will need to be incremented each time a database update is made

- 

Along with a revision define increment, you will need to update the db_update manifest located in:

https://raw.githubusercontent.com/EQEmu/Server/master/utils/sql/db_update_manifest.txt

- An entry needs to be made at the bottom of the manifest, the entry is quite simple

- Example: 9057|2014_11_13_spells_new_updates.sql|SHOW COLUMNS FROM `spells_new` LIKE 'disallow_sit'|empty|

- 

This latest example is checking to see if the spells_new table contains the column 'disallow_sit', if its empty, the update needs to be ran

More examples of match types below:

Example: Version|Filename.sql|Query_to_Check_Condition_For_Needed_Update|match type|text to match

0 = Database Version

1 = Filename.sql

2 = Query_to_Check_Condition_For_Needed_Update

3 = Match Type * If condition from match type to Value 4 is true, update will flag for needing to be ran

contains = If query results contains text from 4th value

match = If query results matches text from 4th value

missing = If query result is missing text from 4th value

empty = If the query results in no results

not_empty = If the query is not empty

4 = Text to match
 * The manifest contains all database updates 'Required' to be made to the schema, and it will contain a working backport all the way back to SVN -

currently it is tested and backported through the beginning of our Github repo

- 

On world bootup or standalone run of db_update.pl, users will be prompted with a simple menu that we will expand upon later:

## 11/15/2014¶

- **Uleat (Natedog)** A better fix for OP_ShopPlayerBuy * doesn't cause the issues that I introduced

- **Kayen** Implemented NPC Special Ability 41 'Allow To Tank', gives NPC opportunity to take aggro over a client in melee range.

- **Kayen** Updated swarm pet AI to be consistent with live.

### Old AI¶

Swarm pet would lock on to target until target died, then depop as soon as target died.

### New AI¶

Swarm pet will attack cast on target, NOT perma locked it can change targets if attacked by something else that generate more hate. When target dies swarm pet will follow owner, if owner is attacked by something else the swarm pet will attack it (until duration timer despawns the pet).

- **Kayen** Updated perl quest function: MakeTempPet(Tspell_id, name=nullptr, duration=0, target=nullptr, sticktarg=0)

- **Kayen** Implemented perl quest function: Mob::TypesTempPet(npctypesid, name=nullptr, duration=0, follow=0, target=nullptr, sticktarg=0)

Note: 'sticktarg' field will cause the swarm pet to use the OLD AI

Rule to use OLD AI only * default is disabled

Info

**Optional SQL** utils/sql/git/optional/2014_11_15_SwarmPetTargetLock.sql

## 11/14/2014¶

- **Secrets** Identified object size and solidtype as flags. Exported them as functions to Perl.

- **mackal** Don't use the hack for charms that doesn't work on RoF

- **mackal** UF too

- **mackal** Tit

- **mackal** SoF

- **mackal** SoD

- **mackal** 62 (untested)

## 11/13/2014¶

- **Kayen** Implemented target type (44) 'Beams' (which projects an AE infront of caster with a specified length and width).

- **Kayen** Implemented target type (32) AE Target HateList

- **Kayen** Implemented target type (36) Area Client Only

- **Kayen** Implemented target type (37) Area PC Only

- **Kayen** Implemented target type (39) Group No Pet

- **Uleat** PlayerLogMerchantTransactions does not support partial stack purchase logging at this time

## 11/12/2014¶

- **Uleat** Changed 'GMTrainee' struct to reflect the actual client hard-coded max skill count (100) * applies to all currently supported clients (6.2->RoF)

## 11/11/2014¶

- **Uleat** Third attempt at a fix for GM trainer zone crashes... (this is starting to look like a KLS fix...)

## 11/10/2014¶

- **Uleat** Fix for GM Trainer crashing server (really!)

- **JJ** Yellow faction messages.

## 11/09/2014¶

- **Kayen** Implemented support for spell target type (45) 'Target Rings' on Underfoot (does work earlier expansions). Thanks to Lecht for figuring out the op_code side.

- **JJ** Implement new Live-like faction adjustment message using rule Client:UseLiveFactionMessage.

Optional SQL: utils/sql/git/optional/2014_11_09_LiveFactionMessages.sql

## 11/06/2014¶

- **mackal** Tracking default sort will now be correct order

- **Trevius** Fixed dynamic merchant list loading. Allows any merchant to be used in any zone.

## 11/03/2014¶

- **Secrets** Fixed an overflow in melee lifetap calculations (int16 vs int32)

- **Secrets** Fixed overflow on AC and ATK values that can go out of range.

- **Secrets** Merc/Bot fixes for previous updates.

- **Secrets** Changed a lot of int16s for stat-related functions to int32 because they were causing combat formula overflows (int16/int32 mismatch).

- **Secrets** Linux fix?

## 11/02/2014¶

- **Akkadius** Added out of range checking for Spell Save/Loads

## 11/01/2014¶

- **Trevius** Fixed potential crash related to Pets/Mercs buffs when targeting themselves.

- **JJ** (noudess) Revamped faction system. See https://github.com/EQEmu/Server/pull/256

## 10/28/2014¶

- **Uleat** Added Client::InterrogateInventory(). Can be invoked by #interrogateinv and is also called when Handle_OP_MoveItem() calls for SwapItemResync()

## 10/22/2014¶

- **Uleat** Fix for stacking items in a world object..added a new command option: #peekinv world * will show world container contents, if one is in use by target.

## 10/20/2014¶

- **mackal** Inspect Buffs rank 1 will now show NPC buffs in target window (SoD+)

## 10/19/2014¶

- **Uleat** Updated command #peekinv to display item links properly in RoF clients

- **mackal** Group Mentoring in raids

- **mackal** Inspect Buffs (text only version) works in raid groups

- **mackal** Make use of the Inspect Buffs op/packet. 62 SOL until someone finds its op

## 10/18/2014¶

- **mackal** Implement group mentor, sharing leadership exp (SoF+ only)

- **mackal** Add gaining of group leadership while in raids

## 10/16/2014¶

- **Uleat** Fixed the auto-conversion view naming error and renamed the views in the script files. Added a fix sql for databases that auto-converted.

Fix SQL: ../sql/git/bots/deprecated/2014_10_16_Lower_Case_View_Fix.sql

## 10/15/2014¶

- **Uleat** Cleaned up load/drop bots sqls, added '../utils/sql/git/bots/deprecated' and '../deprecated/load_bots_old.sql' (use this file on pre-player blob conversion databases.)

Notes: I modifed the behavior of both load and drop bots to fail on the first operation if their modifications have been performed already.

```
` 'load_bots.sql' will explicitly add bot schema, while 'drop_bots.sql' will explicitly drop it. I also added a few lines to change
 a few altered tables back to their original state * as of the date in the file.
`
```

## 10/13/2014¶

- **mackal** Partially implement leadership and raids

- Currently working: client side only effects and stat bonuses

- Not working: Mark NPC, and other stuff that need extra server side support

- Currently only UF tested (Tit and 62 may just work, others need packet work)

## 10/12/2014¶

- **Akkadius** Fix for LDON Character Stat load

## 10/11/2014¶

- **mackal** Implement Raid MOTD for UF

Don't forget 2014_10_11_RaidMOTD.sql!

## 10/09/2014¶

- **Uleat** Added 'BOTS' conversion code to supplement the database 'PlayerProfile' blob conversion that Akkadius recently implemented

## 10/07/2014¶

- **mackal** Identified tutorial flag in all charcreate packets, reworked logic to correctly set homes binds

## 10/05/2014¶

- **Uleat** Added Server<->Corpse slot translators needed for re-enumeration (inactive until phased in)

## 10/03/2014¶

- **Uleat** Fixed Ti(6.2) OP_AugmentInfo translation that I broke (does not currently need and I mis-read a process)

- **Uleat** Moved client patch OP_LootItem slot translation to external handlers

## 10/02/2014¶

- **Kayen** Exported to PERL $client->SendSpellAnim(targetid, spellid)

This function sends the spell graphic of a spell without actually having to cast the spell.

## 10/02/2014¶

- **Uleat** First round of Ti/6.2 translators added * needed for re-enumeration

## 10/01/2014¶

- **Kayen** Exported to PERL $client->SendColoredText(color, msg)

- **mackal** Exported SendColoredText to lua

## 09/30/2014¶

- **Uleat** Implemented click-casting from bag slots for clients that natively support it (RoF)

## 09/28/2014¶

- **mackal** Add support for post June 18, 2014 Hundred Hands Effect spells (they changed the formula and stuff)

set Spells:Jun182014HundredHandsRevamp to true if you're using a spell file from June 18, 2014+

## 09/27/2014¶

- **Kayen** Implemented perl function $mob->GetSpellStat(spell_id, identifier, slot);

Note: identifier is the stat field in spells_new, slot is used for certain effects like effectid, base,base2, max ect.

Example $mob->GetSpellStat(121, "range"); //Returns spell range

Example $mob->GetSpellStat(121, "effectid", 1); //Returns the the value of effectid1

This will allow you to pull almost all the data for any spell in quest files.

- **mackal** Move the client's SetAttackTimer to the end of Client::CalcBonuses to keep the haste in sync

- **mackal** Correct haste/slow "stacking" rules

- **mackal** Correct SE_AttackSpeed4 to respect unslowable

- **mackal** Make the haste be between 1-225 like the client (100 = haste) to ...

- **mackal** Correct Hundred Hands effect and use formula provided by devs

## 09/24/2014¶

- **Uleat** Re-ordered server opcodes and handlers to give them some predictability of location (I need this for the inventory re-enumeration.)

- **mackal** Added helper function bool EQEmu::IsTradeskill(uint32 skill)

## 09/23/2014¶

- **Kayen** Spell recourse effects will now be applied AFTER the base spells effects have been applied (consistent with live).

- **Kayen** SE_ApplySpell and SE_TriggerSpell will now be applied based on which effect slot they are used in (instead of always before all spell effects are checked).

Note: If a spell has multiple SE_TriggerSpell effects within it. Only one will be able to trigger. (If you want multiple spells use SE_ApplySpell)

## 09/22/2014¶

- **Akkadius** #resetaa now covers the function of #resetaa and #refundaa

- **resetaa will wipe all AA data, refund the spent points into the available points and send character to character select properly**

- **Akkadius** Removed #refundaa

- **Akkadius** Removed a lot of debug code for blob conversion

- **Akkadius** Changed status logging for loads/saves to Debug category

## 09/21/2014¶

- **Akkadius** Player Profile Blob to Database Conversion

- 

Summary: HUGE difference in database speeds reads/writes and 1:10 datasize difference

The new character storage engine unlike the character_ table before, is able to properly index data and make use of

proper MySQL/MariaDB caching optimizations and performance has increased phenominally

PERFORMANCE AND STATISTICS FIGURES (Varies on hardware):

- EZ Server Character data size of 2.6GB `character_` table alone now takes up approx 600MB

- Character Data Loads take approx .03 seconds BEFORE MySQL/MariaDB cache

- Character Data Loads take approx .001-.0035 seconds AFTER MySQL/MariaDB cache

- Character Data Saves take approx .0001 * .003 for any particular save operation

- Database Auto Conversion: When the 'character_' table exists, World boot-up will queue an auto-conversion prompt and convert all of your characters, BACKUP

YOUR DATABASE BEFORE CONVERTING, here is an EASY backup script: http://wiki.eqemulator.org/p?MySQL_DB_Backup_Script

- On auto conversion, the following tables are created automatically:

Table: `character_skills` * Stores Character Skills

- Table: `character_languages` * Stores Character Language

- Table: `character_bind` * Stores Character Bind point and Home Bind point designated by is_home bool field

- Table: `character_alternate_abilities` * Stores all Character AA

- Table: `character_currency` * Stores all Platinum/Gold/Silver/Copper and character related currencies

- Table: `character_data` * Stores basic character data (Fields from `character_` table migrated to this table)

- Table: `character_spells` * Stores character spells

- Table: `character_memmed_spells` * Stores character memorized spells

- Table: `character_disciplines` * Stores character disciplines

- Table: `character_material` * Stores character armor dye textures

- Table: `character_tribute` * Stores character tributes

- Table: `character_bandolier` * Stores character bandoliers

- Table: `character_inspect_messages` * Stores character inspection messages (Moved from `character_` table)

- Table: `character_leadership_abilities` * Stores character Leadership AAs

- Loads: Majority of Player profile loads now occur at Client::Handle_Connect_OP_ZoneEntry

LoadCharacterFactionValues(uint32 character_id, faction_map & val_list);

LoadCharacterSpellBook(uint32 character_id, PlayerProfile_Struct* pp);

LoadCharacterMemmedSpells(uint32 character_id, PlayerProfile_Struct* pp);

LoadCharacterLanguages(uint32 character_id, PlayerProfile_Struct* pp);

LoadCharacterDisciplines(uint32 character_id, PlayerProfile_Struct* pp);

LoadCharacterSkills(uint32 character_id, PlayerProfile_Struct* pp);

LoadCharacterData(uint32 character_id, PlayerProfile_Struct *pp, ExtendedProfile_Struct* m_epp);

LoadCharacterCurrency(uint32 character_id, PlayerProfile_Struct* pp);

LoadCharacterBindPoint(uint32 character_id, PlayerProfile_Struct* pp);

LoadCharacterMaterialColor(uint32 character_id, PlayerProfile_Struct* pp);

LoadCharacterBandolier(uint32 character_id, PlayerProfile_Struct* pp);

LoadCharacterTribute(uint32 character_id, PlayerProfile_Struct* pp);

LoadCharacterPotions(uint32 character_id, PlayerProfile_Struct* pp);

LoadCharacterLeadershipAA(uint32 character_id, PlayerProfile_Struct* pp);

- 

Saves: Occur all over the code now instead of calling full saves

SaveCharacterBindPoint(uint32 character_id, uint32 zone_id, uint32 instance_id, float x, float y, float z, float heading, uint8 is_home);

SaveCharacterCurrency(uint32 character_id, PlayerProfile_Struct* pp);

SaveCharacterData(uint32 character_id, uint32 account_id, PlayerProfile_Struct *pp, ExtendedProfile_Struct* m_epp);

SaveCharacterAA(uint32 character_id, uint32 aa_id, uint32 current_level);

SaveCharacterSpell(uint32 character_id, uint32 spell_id, uint32 slot_id);

SaveCharacterMemorizedSpell(uint32 character_id, uint32 spell_id, uint32 slot_id);

SaveCharacterMaterialColor(uint32 character_id, uint32 slot_id, uint32 color);

SaveCharacterSkill(uint32 character_id, uint32 skill_id, uint32 value);

SaveCharacterLanguage(uint32 character_id, uint32 lang_id, uint32 value);

SaveCharacterDisc(uint32 character_id, uint32 slot_id, uint32 disc_id);

SaveCharacterTribute(uint32 character_id, PlayerProfile_Struct* pp);

SaveCharacterBandolier(uint32 character_id, uint8 bandolier_id, uint8 bandolier_slot, uint32 item_id, uint32 icon, const char* bandolier_name);

SaveCharacterPotionBelt(uint32 character_id, uint8 potion_id, uint32 item_id, uint32 icon);

SaveCharacterLeadershipAA(uint32 character_id, PlayerProfile_Struct* pp);

- 

Deletes:

DeleteCharacterSpell(uint32 character_id, uint32 spell_id, uint32 slot_id);

DeleteCharacterMemorizedSpell(uint32 character_id, uint32 spell_id, uint32 slot_id);

DeleteCharacterDisc(uint32 character_id, uint32 slot_id);

DeleteCharacterBandolier(uint32 character_id, uint32 band_id);

DeleteCharacterLeadershipAAs(uint32 character_id);

- 

Now occur all over the code and only trigger when necessary

- Two FULL saves when looting a corpse, this has been reduced to just currency saves on initial loot and trimmed to one save since AddToMoneyPP did it already

- Every time a player moves coin with any situation (Splits/Trades/Merchant/Skills/Bank Coin Exchange/Coin Moves), a full save is made, this is now just a currency save

- Every time a player skilled up at a skill vendor, a full blob save hit was made, this is not just a currency hit

- Every time an AA was purchased, a full save was made

- Every time a spell was scribed/swapped, disc was trained

- When a client exists a zone, when a client enters a zone

- 

NOTE: These amount of excessive saves have caused scalability issues that cause the `character_` table to hang which causes process hangs that affect the whole server

because of the slowness of the `character_` table and the blob not allowing any indexing to occur

- 

All functions that once depended on the `character_` table are now rewritten to appropriately read from the `character_data` table

- 

Database query errors that occur during conversion or from and load/save/delete character functions are now leveraged via ThrowDBError and logs now go to

Server_Folder_Root/eqemu_query_error_log.txt (You cannot log errors natively through MySQL)

- 

DBASYNC IS NOW COMPLETELY REMOVED * This was mainly for Character data async loads/saves and merchantlist loads

- 

Side implementations: Perl Exports:

quest::crosszonesetentityvariablebynpctypeid(npctype_id, id, m_var) * Sets entity variables world wide with specified npctype_id

- quest::crosszonesignalnpcbynpctypeid(npctype_id, data) * Signals all NPC entities world wide with specified npctype_id

- $client->GetTaskActivityDoneCount(TaskID, ActivityID) * Gets task activity done count by task id and activity id for client entity

VIEW TABLE SIZE AFTER CONVERT:

SELECT CONCAT(table_schema, '.', table_name) as table_name, CONCAT(ROUND(table_rows / 1000000, 2), 'M') rows, CONCAT(ROUND(data_length / ( 1024 1024 1024 ), 2), 'G') DATA, CONCAT(ROUND(index_length / ( 1024 1024 1024 ), 2), 'G') idx, CONCAT(ROUND(( data_length + index_length ) / ( 1024 1024 1024 ), 2), 'G') total_size, ROUND(index_length / data_length, 2) idxfrac FROM information_schema.TABLES WHERE `table_name` LIKE 'character_%' ORDER BY DATA DESC;

## 09/20/2014¶

- **mackal** Fix crash in SendEnterWorld on illegally long names

- **mackal** The client only lets you enter 15 characters for your name (UF at least)

- **mackal** Add rule Spells:SHDProcIDOffByOne for pre-UF spell file, set to true, UF+ set to false

- **KLS** #suspend and #ban now have required messages to record the reason for the ban/suspension.

## 09/19/2014¶

- **mackal** Added Client::Tell_StringID (used in tell queue messages)

- **mackal** Tell queues (and offline) messages now show correctly

- **mackal** Fix starting with capital check

## 09/18/2014¶

- **mackal** Implement tell queues

Currently set to a limit of 20 by default (World:TellQueueSize) I was unable to hit the limit on live though (100+)

The required SQL nukes the old tell queue table, which may or may not be in your DB

Optional SQL adds the rule to the DB to allow easy of change

Note: this does not play well with multiple sessions with the same name on (crash and relog and have multiple sessions) but normal tells don't play well either

## 09/16/2014¶

- **mackal** Implement spell formula 137 (BER AA Desperation)

Uleat (NateDog): Fix for LoadBuffs() crash when a spell with a non-persistent Illusion effect was loaded.

- **mackal** Fix some effect calcs + implement more (derived from the client)

## 09/15/2014¶

- **Kayen** Nimbus effects will now be reapplied after zoning and will be removed when associated buff fades.

## 09/13/2014¶

- **mackal** Fix rogues not having Thieves' Cant

## 09/09/2014¶

- **mackal** Incrase Mob kick/bash timer by 3

see: http://www.eqemulator.org/forums/showthread.php?t=38734

- **mackal** Fix slow effect on NPC special attack reuse timers

see: http://www.eqemulator.org/forums/showthread.php?t=38734

- **mackal** Slow fixes to bots!

- **mackal** Revamped how NPC attack rate is set

SQL: 2014_09_09_attack_delay.sql

- **mackal** Added attackdelay to #npcedit

## 09/08/2014¶

- **mackal** Fix slow calc

see: http://www.eqemulator.org/forums/showthread.php?t=38734

## 09/07/2014¶

- **Akkadius** Fixed ROF Augment item dupe with not checking for available slots properly and adding items to the virtual instance

## 09/06/2014¶

- **Uleat** Tweaked 'Smart' trading code to return main slots before sub slots in stackable and free space search processes. (If enough people ask for it, I'll add an optional rule to allow 'bag packing' * the original implementation behavior)

## 09/05/2014¶

- **Uleat** Fix for cursor item loss when zoning. (Thanks to the other devs who traced and fixed the 'macro' issue!)

- **mackal** Fix size getting nuked with lua's SendIllusionPacket

## 09/03/2014¶

- **Secrets** Identified the routines needed to augment items in RoF. Currently, only Insert and Remove are supported. Swap and Destroy do not work due to missing functions related to the cursor.

- **mackal** Added work around command to show numhits on your buffs (#shownumhits)

- **Uleat** Fix for timer issue introduced by Zone::ShutDown() fix.

## 09/02/2014¶

- **Secrets** Identified OP_GuildPromote for RoF clients.

- **Secrets** Fixed promotion, demotion, transferring a leader and displaying of client ranks in the Rain of Fear client. The rain of fear client, as such, will only have 3 ranks like the other clients, but supports a theoretical 8 ranks later.

Secrets/ **Akkadius* Fixed an issue involving character name lookup in the new DB code.

- **mackal** crash fix checking DivineAura in hate_list.cpp

- **Secrets** Reverted some code that got in the main branch that shouldn't have gotten there.

- **Uleat** Changed #loc to report the same precision as /loc for Cartesians

## 08/31/2014¶

- **KLS** Fixed a bug in fishing in S3D zones

- **KLS** Fixed a bug in turnins with new any abstraction

- **KLS** Fixed a few quest related inconsistencies.

- **KLS** Added Lua EntityList::ChannelMessage(from, type, msg, language)

## 08/30/2014¶

- **mackal** (noudess) Merchants should be more descriptive of why they don't sell to you

## 08/26/2014¶

- **Uleat** Implemented 'Smart' Player Trade transfers. Trades are processed by containers, stackables and then all remaining. QueryServ logs have been updated to match these transactions.

Note: QueryServ logs previously listed 'Items' on the main entry table. This indicated the number of slots affected and not the actual number of items.

This field now indicates the actual number of items transferred. For non-stackable, the value is '1' and stackable is the number of charges. A _detail_count

property has been added to both 'Trade' and 'Handin' structs to indicate the number of details recorded..though, not tracked..it could be added.

## 08/24/2014¶

- **Uleat** Fix (attempted) for zone crashes related to zone shut-down. This change disables all Mob AI and disables/deletes all Mob timers once Zone::ShutDown() is called. More areas will be addressed as reports come in.

Note: Perl and Lua quests tested to work..please post any aberrant behavior. (I finally set my spell-check to US English...)

- **Akkadius** Character creation process crash fix and query cleanup

- **Akkadius** Created `character_lookup` table for applications that mirrors all `character_` table fields minus blob fields for application lookups

- A 2.4GB character_ table will take 7 seconds to query on a SSD versus .1s on the character_lookup table

- This also causes applications like Magelo to burst reads of the entire character table because of the blob fields that come with the reads, as much as 500-600MB/s even if a indexed id filter is provided

- This field is synchronized on player save and has 0.001s DB hit

- When we split out from the blob, ideally this table can be removed

- Required SQL: utils\sql\git\required\2014_08_24_character_lookup.sql

## 08/23/2014¶

- **Akkadius** Changed zone process window title format, example: 'crushbone :: clients: 6 inst_id: 1 inst_ver: 0 :: port: 7015'

- **Akkadius** Most of the following changes are QueryServ related, fully implemented its original functionality to be able to offload

intensive or metric based logging to a remote server process that could exist on another server entirely

- **Akkadius** Implemented Player Event Logging Types (Go to table `qs_player_events`)

```
` 1 = Player_Log_Quest,
 2 = Player_Log_Zoning,
 3 = Player_Log_Deaths,
 4 = Player_Log_Connect_State,
 5 = Player_Log_Levels,
 6 = Player_Log_Keyring_Addition,
 7 = Player_Log_QGlobal_Update,
 8 = Player_Log_Task_Updates,
 9 = Player_Log_AA_Purchases,
 10 = Player_Log_Trade_Skill_Events,
 11 = Player_Log_Issued_Commands,
 12 = Player_Log_Money_Transactions,
 13 = Player_Log_Alternate_Currency_Transactions,
 * All QueryServ logging will be implemented with a front end in EoC 2.0 very soon
 * Architecture page: http://wiki.eqemulator.org/p?QueryServ_Architecture
`
```

- **Akkadius** Changed all QS Error related logging to 'QUERYSERV__ERROR'

- **Akkadius** (Natedog) (Crash Fix) Legacy MySQL bug revert for loading AA's

- **Akkadius** Implemented Perl Quest objects (LUA still needed to be exported):

- quest::qs_send_query("MySQL query") * Will send a raw query to the QueryServ process, useful for custom logging

- quest::qs_player_event(char_id, event_desc); * Will process a quest type event to table `qs_player_events`

- **Akkadius** Added MySQL Tables

- `qs_player_aa_rate_hourly`

- `qs_player_events`

- 

Source table structures from:

utils\sql\git\queryserv\required\08_23_2014_player_events_and_player_aa_rate_hourly

To get the complete QueryServ schema, source from here:

- utils\sql\git\queryserv\required\Complete_QueryServ_Table_Structures.sql

- **Akkadius** Added rules for each logging type, source rules here with them enabled by default:

- utils\sql\git\queryserv\required\Complete_QueryServ_Rules_Enabled.sql

- **Akkadius** Spawn related logging cleanup

- **Akkadius** General code cleanup

- **Akkadius** More to come for QueryServ

## 08/22/2014¶

- **Uleat** Rework of Trade::FinishedTrade() and Trade::ResetTrade() to parse items a little more intelligently.

Trade window items are now sent to client inventory in this order:

- Bags

- Partial stack movements

- All remaining items

If any of these procedures cause any problems, please post them immediately.

## 08/20/2014¶

- **Uleat** Rework of Trade::AddEntity() * function used to move items into the trade window. Now accepts argument for 'stack_size' and updates client properly.

Note: I tested trade with Titanium:{SoF,SoD,UF,RoF} in both directions and no client generated an OP_MoveItem event for attempting to place a stackable

onto a partial stack already in the trade window. The only way to achieve stacking is to click on the receiving client. If there is a partial stack remaining

on the cursor after the OP_MoveItem event, and there is room available, the client will generate subsequent events to move the remaining count.

## 08/19/2014¶

- **Akkadius** Implemented a Stop_Return feature (Accidental item handin prevention) that will be symmetrically used with plugin::return_items that I am currently running live testing on EZ before releasing to EQEmu. This does not hurt to have this in the source.

- **Akkadius** Fixed crash where 'attacker' validation is not being checked

- **Akkadius** Removed petition console spam that does not follow traditional logging and is useless

- **Akkadius** Made fix with SympatheticProcChances where it was checking for TempItem->Focus.Effect instead of TempItemAug->Focus.Effect

## 08/18/2014¶

- **Uleat** Fix for https://github.com/EQEmu/Server/issues/127 -* also activated a remarked action in doors.cpp to eliminate a memory leak.

## 08/16/2014¶

- **KLS** (addmoreice) Trying out some unstable DB changes. Do backup your database before trying them as master will be considered unstable for a few days at least.

Uleat (Noudness): Fixed a floating-point comparison error that led to the notorious 'client bounce' (this is not related to the

'mob falling' due to not having maps installed.) This fix also eliminates a sizeable amount of unnecessary out-going packets due

to invalid orientation corrections.

Note: This patch is probably of significant enough importance that admins may wish to manually apply this to older server builds.

The number of packets reduced per second should be approximately (num_stationary_close_clients *(num_close_clients* 1)). This will

likely have the most effect in zones like: Nexus, Bazaar, Guilds (Halls) and RAID INSTANCES * where players don't move around a lot.

## 08/15/2014¶

- **Uleat** Reactivated the Bot::Spawn() code for sending post-spawn wear change updates..temporary until I can sort out the proper usage.

## 08/13/2014¶

Uleat (Kingly_Krab): Fix for bot chest armor graphic glitch. (fix also caused RoF #wc to work properly)

## 08/02/2014¶

- **Kayen** Implemented spell_news fields

- npc_no_los (check if LOS is required for spells)

- InCombat, OutofCombat * Used together to restrict spells to only be cast while

in/out of combat (beneficial) or if target is in/out of combat (detrimental).

-min_dist, min_dist_mod, max_dist, max_dist_mod * Scales spell power based on targets distance from caster.

*This will require further work to fully implement but will work with 90% of live spells as is.

*If making custom spells do not include effects that can't be scaled (like a spell trigger)

- min_rage sets minimum distance range that must be away from target.

Info

**Required SQL** utils/sql/git/required/2014_08_02_spells_new.sql

## 07/31/2014¶

- **Uleat** More inventory slot constant conversions. This should be the bulk of everything..but, due to the size of the server code, there

may be some hidden ones. (client_packet.cpp and the client translators still need a thorough review.)

Note: Please report any abnormal behaviour with inventory-related content..each diff file was reviewed 3 times..but, things CAN be missed.

- **Uleat** Test fix for client crashes in Bazaar, while actively selling, with a charm in the Trader's Satchel.

## 07/27/2014¶

- **Uleat** More updates to the dictionary. Added a 'constants' file for each client translator..these will tie-in to the dictionary. Started

replacement of hard-coded numeric values with a pre-defined constant. This will help in the transition.

## 07/16/2014¶

- **Uleat** Initial commit of new client/server 'dictionaries' * work in-progress... Changed equipment slot references to reflect new naming

conventions. Lua enumerations maintain both the old and new names as to not break existing scripts..but, the old names are deprecated.

## 07/14/2014¶

- **KLS** Changes to CMake build

- Lua builds by default now

- Common has been renamed common

- Binary files will now be put into ${CMAKE_BINARY_DIR}/bin instead of ${CMAKE_BINARY_DIR}/Bin

- The last two are of note to people on non-windows systems as case sensitivity is important. Edit your scripts accordingly, thank you.

## 07/10/2014¶

- **Kayen** Updated table npc_spells to now support defensive and ranged procs.

Note: Proc rate modifier work as it does for spell effects (ie 200 = 200% baseline chance modifier)

Table is also now contains 12 AI spell casting variables that can be set to fine tune casting behaviors per spell set.

Global default rules have also been added that can further fine tune all content if no specific variables are set.

Descriptions of new AI casting fields in npc_spells 'fail_recast' AI spell recast time(MS) when an spell is cast but fails (ie stunned) 'engaged_no_sp_recast_min' AI spell recast time(MS) checked when no spell is cast while engaged in combat. (min time in random) 'engaged_no_sp_recast_max' AI spell recast time(MS) checked when no spell is cast while engaged in combat. (max time in random) 'engaged_b_self_chance' Chance during first AI Cast check to do a beneficial spell on self (ie check to heal self) 'engaged_b_other_chance' Chance during second AI Cast check to do a beneficial spell on others.(ie check to heal others) 'engaged_d_chance' 'Chance during third AI Cast check to do a determental spell on others (ie check to nuke others) 'pursue_no_sp_recast_min' AI spell recast time(MS) checked when no spell is cast while chasing target. (min time in random) 'pursue_no_sp_recast_max' AI spell recast time(MS) checked when no spell is cast while chasing target. (max time in random) 'pursue_d_chance' Chance while chasing target to cast a detrimental spell. 'idle_no_sp_recast_min' AI spell recast time(MS) checked when no spell is cast while idle. (min time in random) 'idle_no_sp_recast_max' AI spell recast time(MS) checked when no spell is cast while idle. (max time in random) 'idle_b_chance' Chance to cast a beneficial spell while idle (ie cast heal on self while out of combat).

- **Kayen** Updated table npc_types, adding field 'ranged_type' and 'ammo_idfile' 'ranged_type' Will set what skill / animation is used when NPC uses a ranged attacked (special ability 11) 'ammo_idfile' Will set what projectile graphic an NPC uses in a ranged attacked (special ability 11) Format IT#### (same as item 'idfile') (*Set to IT11118 for some fun*) Added parameters: SPECATK_RANGED_ATK = 11 Param0: Min Ranged distance (default: 25) Param1: Max Ranged distance (default: 250) Param2: Percent Chance to Hit modifier Param3: Percent Total Damage modifier

- **Kayen** Updated to Chance to Hit code with how bonuses are applied to be consistent for all effects. Added field to npc_types 'Avoidance' which will modify chance to avoid melee Added rules to set max and min chance to hit from melee/ranged (Default 95% / 5%)

Required SQL: utils/sql/git/required/2014_07_10_npc_spells.sql Optional SQL: utils/sql/git/optional/2014_07_10_AICastingRules.sql

## 07/5/2014¶

- **Kayen** Updated SE_Sanctuary * Adjust way hate lowering effect worked to be more accurate

- **Kayen** Updated SE_SympatheticProc * Revised proc rate formula to be accurate to live.

Sympathetic foci on items with proc rate mod will now benefit from that modifier.

Sympathetic foci can now be placed on AA's (This should always be slot1 in the AA)

- **Kayen** Implemented SE_IllusionPersistence* Allows illusions to last until you die or the illusion is forcibly removed.

- **Kayen** Added rule 'PreNerftBardAEDot' for SE_BardAEDot to allow it to once again do damage to moving targets. (Set to true)

- **Kayen** Completely revised SE_SkillProc, SE_LimitToSkill, SE_SkillProcSuccess to overall just work better and more accurately, AA support.

Required SQL: utils/sql/git/required/2014_07_04_AA_Update.sql

## 07/2/2014¶

- **Kayen** Implemented SE_Sanctuary * Places caster at bottom hate list, effect fades if caster cast spell on targets other than self.

- **Kayen** Implemented SE_ResourceTap * Coverts a percent of dmg from dmg spells(DD/DoT) to hp/mana/end.

- **Kayen** Implemented SE_FactionModPct * Modifies faction gains and losses by percent.

- **Kayen** Re-Implemented SE_TriggerMeleeThreshold and SE_TriggerSpellThreshold correctly * Trigger spell if owner of buff

takes more than the specified damage amount in a SINGLE hit, then fade the buff.

- **Kayen** Implemented SE_LimitSpellClass * Focus Limits spell to pre defined categories. (3=Cures,3=Offensive, 6=Lifetap)

- **Kayen** Changed SE_LimitMaxMana to SE_MeleeVulnerability * Weakness/Mitigation verse melee damage

(Despite lives SPA lable as the former it clearly is not what the effect does from all spell examples)

- **Kayen** Updated SE_BardAEDot to no longer damage target while target is moving (consistent with live)

- **Kayen** Update SE_InterruptCasting: Will now work for instant spells (as well as over time).

## 06/25/2014¶

- **Kayen** Updated SE_Hate (Renamed from SE_Hate2) to now properly work for instant +/* hate spells.

- **Kayen** Updated SE_FadingMemories * Base value will be properly utilized to set % chance for fade effect to work.

- **Kayen** Implemented SE_StrikeThough (Was incorrectly defined as implemented previously) * Works same as item bonus.

- **Kayen** Update SE_Taunt * Limit value if present will now add instant hate.

- **Kayen** Implemented SE_MassGroupBuff * Allows next group buff cast to be a MGB (AA now uses this)

- **Kayen** Implemented SE_IllusionOther * Allows next Illusion buff (self only) cast to be cast on target. (AA now uses this)

- **Kayen** Update SE_AETaunt * Base value will now determine AE taunt range (This will not result in any change to currently used spells).

- **Kayen** Updated SE_ReclaimPet * Correct forumla for mana returned to properly return 75% of actual pet spell mana cost.

- **Kayen** Implemented SE_ImprovedReclaimEnergy * Modifies % mana returned from SE_ReclaimPet.

- **Kayen** Implemented SE_HeadShot, SE_HeadShotLevel * Defines headshot damage and level requirements.

Revised HeadShot mechanic so damage now receives all archery bonuses, proc chance can be set to either (lives new Proc Per minute

system, or flat chance based on dex (formula updated).

- **Kayen** Implemented SE_Assassinate, SE_AssassinateLevel * Defines assassinate damage and level requirements.

Revised Assassinate mechanic so damage now receives all backstab bonuses, proc chance can be set to either (lives new Proc Per minute

system, or flat chance based on dex (formula updated). Assassinate can now proc from THROW if behind target, various other adjustments.

- **Kayen** Fix to AA Finishing Blow missing aa_effects data, update required SQL.

Revised Finishing blow so that damage now receives all melee bonus. Support also for this effect if placed on items or spells.

- **Kayen** Implemented SE_PetMeleeMitigation * Bonus applied to pet owner. Gives AC to owner's pet.

Info

**Required SQL** utils/sql/git/required/2014_06_25_AA_Update.sql

**Optional SQL** utils/sql/git/optiional/2014_06_29_HeadShotRules.sql

## 06/17/2014¶

- **Kayen** Implemented SE_AStacker, SE_BStacker, SE_CStacker, SE_DStacker.

These effects when present in buffs prevent each other from stacking,

Any effect with B prevents A, C prevents B, D prevents C.

- **Kayen** Implemented SE_DamageModifier2 (Stacks with SE_DamageModifier, mods damage by skill type)

- **Kayen** Implemented SE_AddHatePct (Modifies +/* your total hate on NPC by percent)

- **Kayen** Implemented SE_AddHateOverTimePct (Modifies +/* your total hate on NPC by percent over time)

- **Kayen** Implemented SE_DoubleRiposte (Modifies +/ *your double riposte chance)* Not used in any live effects

- **Kayen** Implemented SE_Berserk (Sets client as 'Berserk' giving chance to crippling blow) *Not used in any live effects

- **Kayen** Implemented SE_Vampirsm (Stackable lifetap from melee effect) *Not used in any live effects

- **Kayen** Minor fixes to how lifetap from melee effects are calced. Removed arbitrary hard cap of 100%, Negative value will now dmg client.

- **Kayen** Fix to issue that prevented NPC's from receiving HP Regeneration derived from spell buffs.

- **Kayen** Fixes and Updates for melee and spell mitigation runes.

- **Kayen** Update to SE_NegateAttack, 'max' value can now set upper limit of damage absorbed. DOT ticks will no longer be absorbed.

- **Kayen** Implemented SE_Metabolism * Modifies food/drink consumption rates. [Data for AA is already in database]

- **Kayen** Update to SE_BalanaceMana, SE_BalanceHP to support limit value which caps max mana/hp that can be taken per player.

## 06/13/2014¶

- **Kayen** For table 'npc_spell_effects_entries' setting se_max for damage shield effects (59) will now determine the DS Type (ie burning)

Setting se_max to 1 for SkillDamageTaken effects (127) will allow for stackable mitigation/weakness same as quest function ModSkillDmgTaken.

- **Kayen** Implemented SE_AlterNPCLevel (not currently used on live). Will +/* to NPC level. When fade will revert back to original level.

- **Kayen** Implemented 'special_abilities' 38 ALLOW_BENEFICIAL (Allows an NPC to recieve player buffs/heals)

- **Kayen** Implemented 'special_abilities' 39 DISABLE_MELEE (Prevents NPC from auto attacking, will still aggro)

Note: These two special abilities were previously implemented and still remain as quest functions. (SetDisableMelee() and SetAllowBeneficial())

## 06/8/2014¶

- **KLS** Changed lua API: eq.get_globals(client, npc) has been removed. Use eq.get_globals(npc, client) instead.

There's a bug with something in gcc 4.6.3 (maybe other versions) on x86 that this is attempting to combat.

## 05/17/2014¶

- **Secrets** Identified the opcode/struct for guild ranks in Rain of Fear+ clients.

- **Secrets** Implemented a work-around for Rain of Fear clients to have all guild permissions until proper database support is added for newer ranks.

## 05/14/2014¶

- **Kayen** Rooted NPC's will no longer target players with Divine Aura effect if they are the closest target and other targets exist on the hate list.

## 05/12/2014¶

- **Uleat** Re-arranged functions in Item.cpp to somewhat match the order they are declared in Item.h. Should make finding their location a little easier when using declarations as a guide. (This will facilitate readability of an upcoming change...)

## 05/07/2014¶

- **Kayen** AA/Item/Spells that allow pets to critical and flurry will now work on the owners swarm pets consistent with live.

## 05/05/2014¶

- **Uleat** Oops! Wrong state check (conn_state != client_state)

- **Uleat** Test fix to eliminate seemingly random crashes when an AE spell is being used. (Possible access to uninstantiated pointers during client connection process when someone casts a beneficial AE spell within range of a connecting client.)

## 04/29/2014¶

- **KLS** Implemented new map code based on some of Derision's earlier work. Old maps still work with this system and don't need to be regenerated. We're still working on a new azone solution for better/more efficient maps.

## 04/27/2014¶

- **Kayen** Implemented new table 'npc_spells_effects' and 'npc_spells_effects_entires'

- Implemented new field in 'npc_spell_effects_id' in npc_types.

- These are used to directly apply spell effect bonuses to NPC's without requirings spells/buffs. Example: Allow an npc to spawn with an innate 50 pt damage shield and a 5% chance to critical hit. Please see the wiki page: http://wiki.eqemulator.org/p?npc_spell_effects_entries for details. *NPC's can now do critical heals / damage spells if bonus is applied from table.

## 04/25/2014¶

- **cavedude** Corrected a crash in spawn_conditions caused by NPCs on a one way path.

- **cavedude** Added strict column to spawn_events which will prevent an event from enabling if it's mid-cycle.

- **cavedude** Prevented disabled or strict spawn_events from enabling when the zone first boots.

- **cavedude** Fixed the quest function toggle_spawn_event under Perl.

If you're using the quest function toggle_spawn_event (worked on Lua only) it has changed syntax to: toggle_spawn_event(int event_id, bool enable, bool strict, bool reset_base)

Info

**Required SQL** utils/sql/git/required/2014_04_25_spawn_events.sql

## 04/23/2014¶

- **Kayen** Improved SE_LimitCombatSkills will now more accurately determine if a spell is a combat proc.

- **Kayen** SE_LimitInstant will now also work when set to include instant spells

Info

**Optional SQL** utils/sql/git/optional/2014_04_23_FocusComabtProcs.sql Note: Set to false, if enabled will allow all combat procs to receive spell focuses.

## 04/21/2014¶

- **Secrets** Crash fix for more hatelist crashes.

- **Secrets** Hate list fixes, again.

- **Secrets** Revert of hatelist changes.

## 04/20/2014¶

- **Secrets** Changed the functionality of EQDEBUG cmake flag. It now suppresses logs, but shows crashes in any scenario when set to 1. It will also now show crashes even if the log system is disabled.

- **KLS** Change to how quest signals work, signals with no delay will now be added to the signal queue. This addresses an odd timing issue where NPCs are in a state of life/death flux when a signal from event_death goes off.

- **KLS** Added cmake flags to define how logging behavior works for each different log type.

- **Secrets** Crash fix for Hatelist crash observed

## 04/18/2014¶

- **Akkadius** Added #command error message suppression for those who don't want to see 'Command is not recognized' constantly

- You need to have rule 'Chat:SuppressCommandErrors' set to true, this is set to false by default

Info

**Required SQL** 2014_04_18_Suppress_Command_Error.sql

## 04/15/2014¶

- **Akkadius** Exported $client->SendMarqueeMessage(type, priority, fade_in, fade_out, duration, msg) * Will be available for simple plugin use

- **Akkadius** Exported $client->ExpeditionMessage(THIS, ExpdID, Message) 

- In use with custom expedition mod that will be released soon

## 04/12/2014¶

- **Kayen** Fixed an with the slow mitigation code that would cause it to spam the message. Optimized the way the variable is handled for slow mitigation.

Info

**Required SQL** utils/sql/git/required/2014_04_12_SlowMitigation.sql

This changes the variable type in the sql table from FLOAT to INT and updates your database

(When setting slow mitigation 50 = 50%, 100 = 100% ect. You can also set > 100 which will cause slow to become haste now with appropriate in game msg given)

## 04/10/2014¶

- **Kayen** Added 'no_target_hotkey' field to npc_types table. This will prevent the NPC from being targeted with F8 ( **Warning* Will also turn it's name YELLOW)

- **Kayen** Added a rule to make all (Player cast) Swarm Pets not targetable with F8 (nearest NPC) by default ( **Warning* Will also turn pets names YELLOW). This is semi-hack but it works.

- **Kayen** Player cast swarm pets can now be healed and buffed consistent with live.

Info

**Optional SQL** utils/sql/git/optional/2014_04_10_SwarmPetNotTargetableWithHotKey.sql

**Required SQL** utils/sql/git/required/2014_04_10_No_Target_With_Hotkey.sql

Note: For the required new npc_types field you DO NOT need to set values for swarm pets if you enable the above rule.

## 04/09/2014¶

- **Kayen** Implemented ability to use the actual live spell projectile graphics that are defined in the modern spell file.

*This is disabled by default. Recommend enabling if your server uses an UF+ spell file AND most of your players use UF+ clients.

- **Kayen** Expanded the PERL ProjectileAnim(mob, item_id, [IsArrow?, speed, angle, tilt, arc, IDFile]) so you can now just set the weapon model graphic IT####

Example: ProjectileAnim($npc, 0, 0, 1, 0, 0, 0, "IT10747") This will shoot an SK 2.0 sword.

- **Kayen** Updated wizard innate critical damage modifier to be from 20-70% of base damage (based on live parses)

Info

**Optional SQL** utils/sql/git/optional/2014_04_09_SpellProjectileRule.sql Note: This sql also contains a query to check if your spell file is compatible.

## 04/06/2014¶

- **Uleat** Changed Mob::CanThisClassDualWield() behavior. This should let non-monk/beastlord dual-wielding classes attack with either fist as long as the other hand is occupied.

Notes: See this thread for more information and to provide feedback: http://www.eqemulator.org/forums/showthread.php?p=229328#post229328

## 04/05/2014¶

- **Akkadius** Fix for the Fix for the Fix: Rule Combat:OneProcPerWeapon was created so that you can revert to the original proc functionality for custom servers that have balanced their content around having more than 1 aug proc on weapons. By having this rule set to 'false' you revert this functionality. This rule is set to 'true' by default as the original functionality from Live was intended to be

- **Akkadius** (Performance Adjustment) Removed AsyncLoadVariables from InterserverTimer.Check() in both zone and world. By watching the MySQL general.log file on mass zone idle activity, you can see that the query 'SELECT varname, value, unix_timestamp() FROM variables where unix_timestamp(ts) >= timestamp' is called every 10 seconds. This function is loading variables that are initially loaded on World and Zone bootup. When running a large amount of zone servers, the amount of MySQL chatter that is produced is enormous and unnecessary. For example, if I ran 400 zone servers, I would see 3,456,000 unnecessary queries from all idle or active zone processes in a 24 hour interval.

- **Secrets** Added a rule to enable multiple procs from the same weapon's other slots if a proc is deemed to trigger, Defaults to true.If Combat:OneProcPerWeapon is not enabled, we reset the try for that weapon regardless of if we procced or not. This is for some servers that may want to have as many procs triggering from weapons as possible in a single round.

Info

**Optional SQL** utils/sql/git/optional/2014_04_05_ProcRules.sql

## 04/04/2014¶

- **Kayen** Implemented 'Physical Resists' (Resist Type 9) to be consistent with live based on extensive parsing. SQL will add new field to npc_types 'PhR' and fill in database with values consistent with observations

Info

**Required SQL** utils/sql/git/optional/2014_04_04_PhysicalResists.sql

## 04/03/2014¶

- **Kayen** Implemented live like spell projectiles (ie. Mage Bolts).

Info

**Optional SQL** utils/sql/git/optional/2014_04_03_SpellProjectileRules.sql

Note: The rules in this SQL are for setting the item id for the graphic used by the projectile on different clients.

## 04/01/2014¶

- **mackal** Implemented ability for a merchant to open and close shop. Lua quest functions: e.self:MerchantOpenShop() and e.self:MerchantCloseShop(). GM Commands: #merchant_open_shop (short: #open_shop) and #merchant_close_shop (short: #close_shop) default to status 100, just in case you need to force the merchants status

- **Trevius** Fixed potential endless quest loop with EVENT_COMBAT and WipeHateList().

## 03/31/2014¶

- **Uleat** Fix for unconscious skillups.

- **Uleat** Fix for crash issue with nullptr reference in recent Client::SummonItem() work.

- **Uleat** Added rule for GM Status check code in Client::SummonItem().

Note: Rule default is set to 250..but, implementation is on hold until load item code handles the database 'minstatus' field.

- **Uleat** Added RuleB(Bots, BotLevelsWithOwner). Bots will auto-update as their owner levels/de-levels. Appearance packets are sent to show the 'leveling effect' as well as updating client entities.

- **Trevius** Prevented an endless loop crash related to EVENT_TASK_STAGE_COMPLETE.

Optional Bot SQL: utils/sql/git/bot/optional/2014_03_31_BotLevelsWithOwnerRule.sql Note: This sql is required to activate the optional behavior.

## 03/27/2014¶

- **Kayen** SE_Gate will now use have a fail chance as defined by its base value in the spell data.

- **Kayen** SE_Succor will now have a baseline fail chance of (2%). Rule added to adjust this as needed.

- **Kayen** SE_FeignDeath will now have a fail chance as defined by its base value in the spell data.

Optional SQL: utils/sql/git/optional/2014_03_27_SuccorFailRule.sql

## 03/22/2014¶

- **Uleat** Moved the existing 'load_bots' and 'drop_bots' sqls into the emu git repository for the time being. Look to the

/utils/sql/git/bots/ folder to find them. The 'load_bots' sql has been updated to include the below fix, as well as

collecting the multiple files into one. This should allow HeidiSQL to now run it properly. (You will still need to

search for the optional scripts for the time being.)

- **Uleat** Fixed bot guild script failure. For existing bot databases only, use this sql file to update the affected table and view.

Required Bot SQL: 2014_03_22_BotGuildMember_ScriptFailureFix.sql

## 03/19/2014¶

- **Kayen** Further refinements to root, charm, mez and fear behaviors * See commit message for full details

New rule for 'Fear' break chance, and updates to default settings of various rules. Optional SQL: utils/sql/git/optional/2014_03_19_RulesUpdates.sql

## 03/18/2014¶

- **Uleat** Fixed the name/account discrepancy in the Client::SummonItem() code as well as the origin of the mistake (thanks K_K!)

- **Uleat** Condensed and rearranged certain snippets of code in SummonItem(). Added a 'augslotvisible' check to validation check.

Note: If you are experiencing issues with SummonItem, please enable 'INVENTORY_ERROR' logging if it not active on your server.

## 03/17/2014¶

- **Uleat** Updated Client::SummonItem() to check for valid item combinations when augmentations are passed.

- **Uleat** Changed the return type of Client::SummonItem() from void to bool. Calling methods and APIs have not been update as yet.

- **Uleat** Fixed the RoF Item structure to properly pass the 'augrestrict' variable. RoF clients now show restrictions in the Item Information window.

Optional SQL: 2014/03/17_EnforceAugmentRules.sql Note: This adds the rules Inventory:EnforceAugmentRestriction, Inventory:EnforceAugmentUsability and Inventory:EnforceAugmentWear. If you run into script/recipe issues, running this sql file will set the default enforcement rules to false. If you still run into issues, you may want to check that your scripts are not trying to augment non-common items. Please post any failures as bugs and be sure to include the base item ID, as well as any augment IDs that you are using.

## 03/12/2014¶

- **Kayen** Melee/Magic runes are now calculated as bonuses. Resolved issues with runes not working and not fading properly.

## 03/08/2014¶

- **Kayen** Revision to lull/harmony/pacification code to be consistent with live based on extensive personal parsing.

*Lulls on initial cast do not check regular resists (MR ect) but only apply a flat ~7.5 % resist chance + level modifier

*If Lull is resisted, a second resistance check is made this time using regular resists and a charisma modifier (same as charm)

which if 'resisted' will cause the caster to gain aggro.

## 03/05/2014¶

- **mackal** Corrected rogue's evade to be single target

- **sorvani** fixed crash issue 119

## 03/04/2014¶

- **Sorvani** Created RemoveFromInstance and RemoveAllFromInstance to remove a single player or all players in an instance.

- **Sorvani** Exported to Lua as eq.remove_from_instance(instance_id) and eq.remove_all_from_instance(instance_id).

- **Kayen** Revision to root code to be consistent with live based on extensive personal parsing.

*ROOT has a 40% chance to do a resist check to break each buff tick.

*If multiple roots on target. Root in first slot will always and only be check to break from nukes.

*If multiple roots on target and broken by spell. Roots are removed ONE at a time in order of buff slot.

*Roots on beneficial spells can not be broken by spell damage.

Optional SQL: utils/sql/git/optional/2014_03_04_RootRule.sql

## 03/03/2014¶

- **mackal** Implemented deadly strikes and gave rogues higher innate throwing crit chance

New rules: Combat:RogueCritThrowingChance, Combat:RogueDeadlyStrikeChance, Combat:RogueDeadlyStrikeMod Defaults should give fairly close to live results

## 03/02/2014¶

- **Kayen** Revision to charm code to be consistent with live based on extensive personal parsing.

*Charisma ONLY effects the initial resist check when charm is cast with 10 CHA = -1 Resist mod up to 200 CHA

*Charisma DOES NOT extend charm durations.

Optional SQL: utils/sql/git/optional/2014_03_02_CharmRules.sql

- **mackal** Melee Crits, HoTs, DoTs messages should now be filtered correctly on all clients.

Clients that also support seeing others DoTs will now see them if they don't filter them

note: some newer clients have a 'mine only' option for HoTs but it functions the same as show

## 02/27/2014¶

- **cavedude** Exported TrainDisc to Lua.

## 02/26/2014¶

- **Kayen** Implemented SE_FrenziedDevestation * increase critical spell chacnce and 2x mana cost for DD spells

- **Kayen** Fixed SE_SpellProcChance * Now works on spell dervived procs

- **cavedude** Added two new NPC special_abilities. ALWAYS_FLEE, which forces the NPC to always flee ignoring FleeIfNotAlone and FLEE_PERCENT which allows you to change the HP an individual NPC will flee at. If no value is set, the rule is used as normal.

- **cavedude** Fixed an issue where rectangular roamboxes could cause an NPC to get stuck on a single coord.

- **cavedude** Added a new roambox column, mindelay allowing you to have more control over the roambox delay.

- **Uleat** Fix for 'sqrt' failure on vs2010 clients

- **image** Added idle zone timer to save CPU cycles.

Required SQL: utils/sql/git/required/2014_02_26_roambox_update.sql

## 02/24/2014¶

- **cavedude** Better flee runspeed calculation. Added rule Combat:FleeMultiplier to alter this behavior.

- **Sorvani** Updated GetUnusedInstanceID to not recycle instance ID's unless it has reached max (65535)

## 02/23/2014¶

- **Secrets** Exported the client object SendTargetCommand to Perl.

- **cavedude** Merchants will now keep better track of charges.

## 02/20/2014¶

- **Kayen** Implemented SE_MitigateDotDamage * dot spell mitigation rune with max value

- **Kayen** Implemented SE_DistanceRemoval * removed from target when target moves X amount of distance away from where initially hit.

Required SQL: utils/sql/git/2014_02_20_buff_updates.sql

## 02/18/2014¶

- **Kayen** Implemented SE_TriggerOnReqCaster * triggers a spell which a certain criteria are met (below X amount of hp,mana,end, number of pets on hatelist)

- **Kayen** Implemented SE_ImprovedTaunt * Locks Aggro On Caster and Decrease other Players Aggro by X% on NPC targets below level Y

- **Kayen** Fixed an error where SE_ChangeAggro was adding its bonus x 2 for spell generated aggro. (this applies also to spell casting subtlety AA reduction)

## 02/14/2014¶

- **Kayen** Fixes for buffs not fading under certain conditions in revised numhits system, and other fixes.

- **Kayen** Implemented support for spell_new field CastRestrictions (limits what type of targets spells can effect).

*A detailed list describing what the values used in this field do can be found in Mob::PassCastRestriction*

- **Kayen** Implemented support for spell_new field not_reflectable, no_partial_resists.

Required SQL: utils/sql/git/2014_02_13_spells_new_updates.sql Names many unknown fields in the table.

## 02/13/2014¶

- **Sorvani** Renamed the instance_lockout and instance_lockout_player tables to instance_list and instance_list_player. Cleaned up the Database::GetUnusedInstanceID logic.

Required SQL: utils/sql/git/2014_02_13_Rename_instance_lockout_tables.sql

## 02/10/2014¶

mackal (Secrets): Re-wrote the entity list to be a std::map. This should be used for direct entityID lookups and is noticably faster performance-wise. Also should result in less nil pointers potentially.

- **Secrets** Fixed a crash issue that could occur on #repop related to quest timers.

- **Kayen** Divine Arbiration and other similar spell effects will now utilize a spell range check.

- **Kayen** Revised how heal amount is calculated to properly incorporate all current focus effects/bonuses.

- **Kayen** Various updates/fixes/clean-ups to focus effect related code. Focus effect limits should now all work properly.

## 02/09/2014¶

- **Sorvani** Added new spawn condition onchange action: DoRepopIfReady. Choosing this will not repop mobs when the spawn condition is enabled if they have an existing respawn timer. Additionally, this condition will not even attempt repop when the condition is is changed to disabled. Will be in use on PEQ for: Cragbeast Queen in Natimbi.

- **Secrets** Fixed a weird crash issue with deletion of pointers if task loading fails.

## 02/2/2014¶

- **Kayen** Revised how spell/dot damage is calculated to properly incorporate all current focus effects/bonuses.

Required SQL: utils/sql/git/2014_02_02_SpellCriticalsAA.sql

## 01/27/2014¶

- **Kayen** Implemented SE_CriticalMend (chance to critical monk mend)

- **Kayen** Implemented SE_IncreaseChanceMemwipe (increases the chance to wipe hate with memory blurr)

- **Kayen** Implemented SE_FcStunTimeMod (modify stun duration from casted spells)

- **Kayen** Implemented SE_StunBashChance (increase chance to stun from bash)

Required SQL: utils/sql/git/2014_01_27_CritcalMendAA.sql

## 01/26/2014¶

- **Kayen** Revised 'dispel' type spell effects (ie cancel magic) to be consistent with live

## 01/23/2014¶

- **Kayen** Implemented SE_FfLimitUseType (focus limit to numhits type)

## 01/20/2014¶

- **cavedude** Live-Like weather system (Thanks to robregen for figuring it out!)

- **mackal** Implemented not_extendable spell flag

- **mackal** Moved Spell Casting Reinforcement to DB

- **mackal** Moved Mez Mastery to DB

- **Kayen** Complete revision of the numhits systems to utilize 'numhits type' field in spell file.

## 01/18/2014¶

- **sorvani** Implemented for Lua eq.get_characters_in_instance(uint16 instance_id), return a Lua HashTable

- **mackal** NPCs will now cast their charms.

## 01/13/2014¶

- **Kayen** Numerous minor fixes to spell effects.

- **Kayen** Changed SE_ArcheryDoubleAttack -> SE_DoubleRangedAttack (now works with throwing ect)

- **Kayen** Changed SE_IncreaseHitDmgTaken -> SE_TriggerMeleeThreshold (now only works on melee)

- **Kayen** Changed SE_MitigateMeleeDamageSP -> SE_MeleeThresholdGuard

- **Kayen** Implemented SE_SpellThresholdGuard (Partial Spell Rune that only is lowered if spell hits are over X amount of damage)

- **Kayen** Implemented SE_TriggerSpellThreshold (implemented Trigger effect on X amount of spell damage taken)

- **Kayen** Changed SE_ReduceHealing -> SE_FcHealAmtIncoming (focus limited Add/Remove amount of healing on target by X amount)

- **Kayen** Change SE_CriticalHealChance2 -> SE_CriticalHealDecay

- **Kayen** Change SE_CriticalHealOverTime2 -> SE_CriticalRegenDecay

- **Kayen** Implemented SE_CriticalDotDecay

Note: 'Decay' effects means the chance to critical decays based on the level of the spell using the effect (like focus decay)

- **Kayen** Implemented SE_FfLimitUseMin (focus limit to require a min amount of numhits value)

- **Kayen** Implemented SE_FcLimitUse (focus to increases numhits count by percent)

- **Kayen** Implemented SE_LimitRace (Limits to spells cast by a certain race)

- **Kayen** Implemented SE_FcMute (silences casting of spells that contain specific spell effects) ie silence only heals

## 01/09/2014¶

- **mackal** Add pet size preservation like live (zone, camp, etc)

## 01/07/2014¶

- **mackal** Moved pet can attack check to before it tries to attack, which is more live like.

## 01/03/2014¶

- **mackal** Crash prevention for emote.

## 01/02/2014¶

- **mackal** Stuns from beneficial spells (Harvest) ignore immunity

---

## 2015

*Source: changelog/server/2015/index.html*

# 2015¶

### 12/29/2015¶

**Akkadius**

### Implemented Zone Controller¶

- When a zone boots, it will spawn an invisible npc by the name of zone_controller

- Lua and Perl scripts can be represented with this npc as **zone_controller.pl/lua**

- This NPC's ID is ruled be define **ZONE_CONTROLLER_NPC_ID** 10

#### Quest Events¶

Two EVENT's uniquely are handled with this NPC/controller (They only work with the zone_controller NPC)

- **EVENT_SPAWN_ZONE**

- All NPC spawns in the zone trigger the controller and pass the following variables

$spawned_entity_id

- $spawned_npc_id

- **EVENT_DEATH_ZONE**

- All NPC deaths in the zone trigger the controller event and pass the following variables:

$killer_id

- $killer_damage

- $killer_spell

- $killer_skill

- $killed_npc_id

## 12/28/2015¶

**Kinglykrab**

### Added GetInstanceTimer() to Perl and Lua¶

Added GetInstanceTimerByID(instance_id) to Perl and Lua.

Info

If you do not provide an instance id in the method it defaults to instance id 0 and returns 0 for time remaining.

Added UpdateZoneHeader(type, value) to Perl and Lua

Info

UpdateZoneHeader allows you to manipulate fog color, fog density, and many other zone header settings on the fly in Perl and Lua

## 12/21/2015¶

**Natedog**

### Updated Item Table Fields and Added a Few Missing Fields for Evolving Items¶

DO NOT implement Heirloom items till the inventory code is fixed to allow placing NO DROP items in your shared bank. (but item field located on items table)

NYI - SkillModMax: Max skill point modification from the percent mods. EX: 100% 2HSlashing (Max 50) * can only increase 2hslash by 50 MAX! (item field located though)

**Kinglykrab** Added GetMeleeMitigation() for NPCs and Clients in Perl and Lua.

This allows you to check total item, spell, and AA melee mitigation contribution.

## 12/19/2015¶

**Kinglykrab** Added many methods to Perl and Lua, list below:

- SeeInvisible()

- SeeInvisibleUndead()

- SeeHide()

- SeeImprovedHide()

- GetNimbusEffect1() * returns first nimbus effect

- GetNimbusEffect2() * returns second nimbus effect

- GetNimbusEffect3() * returns third nimbus effect

- IsTargetable()

- HasShieldEquiped()

- HasTwoHandBluntEquiped()

- HasTwoHanderEquiped()

- GetHerosForgeModel() * returns int32 Hero's Forge model

- IsEliteMaterialItem() * returns uint32 Hero's Forge Model

- GetBaseSize() * returns Mob's base size

- HasOwner()

- IsPet()

- HasPet()

- IsSilenced()

- IsAmnesiad()

## 12/16/2015¶

**Noudess** Repaired issue with Bind Wounds on someone else. Message was not coming out on client (hold still) and a bind wounds on someone already binding their wounds would interrupt their bind and make them stand. Also removed some duplicate messaging.

## 12/14/2015¶

- **Kinglykrab** Added IsBlind() and IsFeared() functionality to Perl and Lua.

- Note: Both methods are Mob methods and may be used on NPCs or PCs.

- **Natedog** Added Discipline functions, UpdateInstanceTimer function, and UnmemSpellBySpellID to lua and perl Examples: https://gist.github.com/Akkadius/9d30291f94cad55cbb54be37377c7f65

## 12/07/2015¶

**Uleat**

### Command Alias Changes¶

- To add a command alias, edit the database table `command_settings` * here, you will find three columns: `command`, `access` and `aliases`

- Adding command aliases require that the command contain an entry in `command_settings`.`command`

- Only 'real' commands go inside of the command_init() function in command.cpp .. if you wish to add aliases, you must enter them into the database

- 'Real' commands are loaded first .. then any access/alias data is loaded and applied afterwards

- Duplicate aliases will be ignored .. only the first encountered occurrence will be honored * if it does not conflict with an existing command name

- Aliases should not contain whitespace and should be '|' (pipe) delimited

- The restriction on the number of aliases has been removed .. though each alias will still be limited to the access level of the parent command

- If you need need more name space for aliases, simply edit the `command_settings` table and increase the size of the `aliases` column

- The old `commands` table has been renamed to `commands_old` for reference

- All of the current 'standard' commands have been added to the new `command_settings` table

- YOU WILL NEED TO VERIFY/IMPORT OLD ACCESS VALUES AS THIS CHANGE REVERTS ALL COMMAND ACCESS VALUES TO THEIR PEQDB DEFAULTS

## 11/30/2015¶

**Uleat** Changed criteria for a few bots scripts from count to null/not null in hopes of fixing special case failures

## 11/22/2015¶

**Uleat** Fix for loginserver project compile failure

## 11/7/2015¶

**Akkadius**

### Implemented #repopclose¶

- Real case use: Large zones with 700 NPC's and you are making fast quick tweaks to nearby NPC's you can refresh just the NPC's around you instead of all in the zone

- This can be quite the time saver

- This command will depop all NPC's and only respawn the NPC's that are 500 units around you or unless you specify otherwise

## 11/2/2015¶

**Akkadius**

### **Performance Optimizations**¶

- Performance boost (exponential) - Adjusted default idle cast check timers in rules

- **Spells:AI_IdleNoSpellMinRecast** - 500 (Now 6000) 6 seconds

- **Spells:AI_IdleNoSpellMaxRecast** - 2000 (Now 60000) 60 seconds

- Database version **9089** will take care of this update automatically only if you used the default values

- The CPU cost of NPC's checking the entire entity list to cast beneficial spells (Heals/Buffs) becomes extremely high when higher NPC count zones exist (Based off of process profiling)

- Distance checks for every single NPC to every single other NPC who are casting beneficial spells occur every .5 * 2 seconds unless npc_spells dictates other values, which most of the time it does not

- 

Zones that once fluctuated from 1-8% CPU with no activity (Idle but players present) now idle at .5% based on my testings due

to this change in conjunction with the past few performance commits, these are zones that have 600-800 NPC's in them
* These values normally are overridden by the spells table (**npc_spells**), fields (**idle_no_sp_recast_min**, **idle_no_sp_recast_max**)

## 11/1/2015¶

**Akkadius**

### Server Backend Optimizations¶

Made many performance optimizing oriented code changes in the source

- Added Rate limit the rate in which signals are processed for NPC's (.5 seconds instead of .01 seconds)

- Added Perl Export Settings which should heavily reduce the Perl footprint

- 

Normally when any sub EVENT_ gets triggered, all kinds of variables have to get exported every single time an event is triggered and

this can make Perl very slow when events are triggered constantly

The two most taxing variable exports are the item variables ($itemcount{} $hasitem{} \(oncursor{}) and qglobals (\)qglobals{})

- qglobals can pose to be an issue quickly when global qglobals build up, it is highly recommend to use the GetGlobal() and SetGlobal() methods instead as they don't reference the hashmap $qglobals{} that is rebuilt every single time a sub event is triggered

- A stress test conducted with 10,000 samples shows an excess of time taken to export variables

After the Perl Export Settings table is implemented, and all exports are shut off you see the following test result:

The difference of eliminating unneeded exports brings the overhead and footprint of 10,000 triggers from 54 seconds to 2 seconds

- In a 10,000 sample test (10,000 sub event triggers), exporting item variables adds 12 seconds alone, when item variables are only needed in EVENT_ITEM and EVENT_SAY a majority of the time if at all

- In a 10,000 sample test (10,000 sub event triggers), exporting qglobals with approximately 1,000 global qglobals in the database creates about 11-20 seconds of delay on its own (Depending on hardware of course)

- I've written a parser that has determined which of these exports are needed in which sub routines and have turned off all of the unneeded exports in sub routines that do not need them and used it to create the default table that will be installed in the database.

- The export table is called **perl_event_export_settings** and it resembles the following structure and contains all current 81 EVENTS

- 

If a change is made to this table while the server is live and running, you can hot reload all zone process settings via:

**reloadperlexportsettings**
* For those who wonder what "exports" are, they are reference to variables that are made available at runtime of the sub event, such as
 * (export_qglobals) (Heavy) : $qglobals https://github.com/EQEmu/Server/blob/master/zone/embparser.cpp#L916
 * (export_item) (Heavy) : $itemcount{} $hasitem{} $oncursor{} https://github.com/EQEmu/Server/blob/master/zone/embparser.cpp#L1103
 * (export_zone) : $zoneid, $instanceid, $zoneln etc. https://github.com/EQEmu/Server/blob/master/zone/embparser.cpp#L1083
 * (export_mob) : $x, $y, $z, $h, \(hpratio etc. [https://github.com/EQEmu/Server/blob/master/zone/embparser.cpp#L1032](https://github.com/EQEmu/Server/blob/master/zone/embparser.cpp#L1032)
 * (export_event) : (event specific) IE: EVENT_SAY (\)text) https://github.com/EQEmu/Server/blob/master/zone/embparser.cpp#L1141

## 10/16/2015¶

**Uleat** Added command '#bot clearfollowdistance [ | spawned | all ]' to coincide with the activation of the load/save feature for follow_distance

## 10/13/2015¶

**Uleat** Important update to 2015_09_30_bots.sql * fix for orphaned entries causing crashes during the conversion process

Info

Please visit the thread below if you encounter issues during the conversion process

## 10/12/2015¶

- **Uleat** Implemented 'bots' database versioning Note: See thread for more information: http://www.eqemulator.org/forums/showthread.php?t=40091

- **Kayen** Feign death will now break when hit by casted spells, consisted with live. Implemented suport for AA/spell effect which provides a chance to avoid FD breaking from spells.

## 10/10/2015¶

**Kayen** Updated mechanics to be consistent with live regarding how invisible breaks when the client is the target of a spell. Invisible will drop whenever a client is hit with a detrimental spell, regardless of if resisted, if it does damage or AOE. Hide skill now also follows the same rules as above. Implemented support for Rogue AA * Nerves of Steel which gives a chance for hide NOT to break when client is hit with an AOE spell.

## 09/25/2015¶

**Uleat**

### Implemented "Inventory Snapshot" Feature¶

#### Rules¶

- **Character:ActiveInvSnapshots -** *active (true) or inactive (false default)*

- **Character:InvSnapshotMinIntervalM** - minimum time between snapshots (in minutes)

- **Character:InvSnapshotMinRetryM** - minimum time to attempt a retry after a failed snapshot (in minutes)

- **Character:InvSnapshotHistoryD** - minimum time to keep snapshot entries (in days)

- **commands**

- 

# invsnapshot - Takes a snapshot of target client's inventory (feature active or inactive)¶

- 

# clearinvsnapshots [use rule]¶

- *Clears snapshot entries based on bool argument ([true]* honors the 'InvSnapshotHistoryD' rule, [false] * erases all)

## 08/02/2015¶

- **Shendare** VS2013 query StringFormat glitches when "%f" is passed for the int GetRunSpeed().

- **Shendare** In CreateNewNPCCommand(), the npc_type_id and spawngroupid are created in the database, but never set in the spawn class, so later it can't delete them with #npcspawn remove or #npcspawn delete.

## 07/27/2015¶

**Uleat** Reworked the QS Audit code in Handle_OP_ShopPlayerBuy (\zone\client_packet.cpp) to help eliminate potential for exception errors

## 07/22/2015¶

**mackal** Corrected some hate value calcs based on updated http://www.eqemulator.org/forums/showthread.php?t=39819

Rule Aggro:MaxStunProcAggro to Aggro:MaxScalingProcAggro since the cap applies to more than stuns

## 07/16/2015¶

**mackal** Rework spell aggro based on http://www.eqemulator.org/forums/showthread.php?t=39819

## 07/15/2015¶

- **Hateborne** Added optional ability to enforce task level requirements in perl and lua via an added, optional parameter to $client->AssignTask and quest::assigntask

```
`quest::assigntask(703); # this still assigns the task as normal, no functional change
quest::assigntask(703, 1); # this will assign the task, provided the character meets the db-stored level requirements
$client->AssignTask(703, $npc->GetID()); # still assigns the task as normal, no functional change
$client->AssignTask(703, $npc->GetID(), 1); # this will assign the task, provided the character meets the db-stored level requirements
`
```

## 07/06/2015¶

**mackal**

### Implement Triple Attack Skill¶

- Parses showed about rand(1000) for the chance, may need more investigating

- Corrected Double Attack chances as well

- Running optional 2015_07_06_TripleAttack.sql will set current toons to their max skill

- This is optional because the admins might want to go a different route.

## 07/05/2015¶

**mackal**

### Rewrite NPC Combat Attack Round Logic¶

- An NPC "quading" is really just an NPC with innate dual wield that doubles on both hands

- The old rules allowed NPCs to hit 6 times in one round

- NPCs also seem to have their own skill progression for DW/DA

Info

See: http://www.eqemulator.org/forums/showthread.php?t=38708

You can set **Combat:UseLiveCombatRounds** to false to use the old rules

PC Double Attack rates kind of follow the same thing but still needs to be implemented

**Kinglykrab**

### **Quest, Bot Changes**¶

- Added bot saylinks (thanks Uleat!)

- Command aliases for #augmentitem (#aug), #findnpctype (#fn), #findspell (#fs)

- Bot command changes: #bot sow -> #bot speed, #bot magepet -> #bot setpet, #bot resurrectme -> #bot resurrect

- Changed all occurrences of burried to buried in the code.

- client_packet.cpp was referencing old columns in character_corpses, not sure how we didn't already see this before.

## 7/4/2015¶

**mackal**

### Reworked the Activated Avoidance Skills¶

Reworked the activated avoidance skills (riposte, dodge, etc) based on dev quotes. This also fixes the order things are checked (avoidance skills, THEN hit/miss). Also riposte immunity from the increase riposte chance spell effect.

## 7/2/2015¶

**KLS / Mackal**

- AA system has been rewritten fixing a ton of bugs and extending functionality while making it easier to create new AA points.

- New tables are needed and so older data will need to be migrated to the new system.

- The SQL saves the old aa points spent/avail/character_alt_abilities data if any server ops want to do something different than PEQ did with it.

- Will try to get a wiki entry written up next week some time explaining the system but it's really not hard to follow the db tables in the meantime.

## 7/1/2015¶

**Akkadius**

- Fix an issue where emote messages would overflow the buffer of 256 by increasing the size and changing some of the initialization

- Added a custom Health Update message that will display in the middle of the players screen, to enable this server wide you must enable rule 'Character:MarqueeHPUpdates'

**Haynar**

- Fixed some runspeed issues with Perl and LUA scripts

- Updated #showstats and #npcstats for new speed calcs to display speeds again in familiar float format.

- Improved client movement while AI Controlled, such as feared and charmed. Movement will be much smoother from clients perspective.

## 06/12/2015¶

**Uleat** Adjusted SessionStats to better reflect a sister implementation

## 06/07/2015¶

- 

**Uleat** Implemented optional rule for using disenchanted bags. Action triggers at the same point that temporary items are removed.

Optional SQL: utils/sql/git/optional/2015_06_07_TransformSummonedBagsRule.sql
* **mackal** changes to AA packets since more fields have been identified
* **mackal** fix exploit with expendable AAs punching holes in the aa_array and staying around longer than they are welcomed

## 05/25/2015¶

- **Akkadius** Implemented disjointed zone based time, this can be triggered via quest methods

- **Akkadius** Added parameter to LUA and Perl method settime(hour, minute, [update_world = true])

- If update_world is false, the zone will then unsubscribe itself from regular worldserver time synchronizations

- Basically this localizes the zones time and keeps it from syncing with world updates

- **Akkadius** Added DB ver 9082 with update to add npc_types texture columns if table does not currently have them

## 05/22/2015¶

**Uleat** Added null-term declaration for character names in ENCODE(OP_CharInfo) * where appropriate

## 05/20/2015¶

**mackal** Bard instrument mods should be more consistent with live. Zoning will keep instrument mod for long duration buffs (selo's). Still need to have procs/doom effects to inherit the instrument mods from their source buff/whatever

## 05/18/2015¶

**KLS** Changed how fishing locates water to hopefully be a bit more accurate at the expense of a bit more cpu power per line cast.

## 05/15/2015¶

**Uleat** Added check to EntityList::CheckSpawnQueue() to bypass dereference if returned iterator is npc_list.end() * should fix the debug assertion failure crash

## 04/30/2015¶

**mackal**

### Implement Mob and Client Melee Push¶

You can set Combat:MeleePush to false to turn off or change Combat:MeleePushChance to increase the chance an NPC can be pushed PCs are always pushed, need to do more testing to verify.

## 04/22/2015¶

**Uleat**

### Debug Assertion Fix¶

Probable fix for 'Debug Assertion Failure' in Client::GarbleMessage() when calling the 'isalpha' macro.

Reference: https://connect.microsoft.com/VisualStudio/feedback/details/932876/calling-isdigit-with-a-signed-char-1-results-in-a-assert-failure-in-debug-compiles

## 03/29/2015¶

- **Secrets** Identified the Target Ring fields for RoF/RoF2.

- **Secrets** Added a perl accessor for the last target ring position received from the client. Usage: $client->GetTargetRingX(), $client->GetTargetRingY(), $client->GetTargetRingZ()

## 03/12/2015¶

- **Akkadius** [eqemu_update.pl V7] Add Option 9) LUA Modules * Download latest LUA Modules (Required for Lua)

## 03/11/2015¶

- **Akkadius** [eqemu_update.pl] Add Option 7) Plugins * Download latest Perl plugins

- **Akkadius** [eqemu_update.pl] Add Option 8) Quests * Download latest PEQ quests and stage updates

- **Akkadius** [eqemu_update.pl] Set version 5 of script

## 03/10/2015¶

- **Akkadius** [eqemu_update.pl] Add Option 6) Download Latest map and water files

## 03/04/2015¶

- **Akkadius** Fix Spell Book Deletion

## 03/03/2015¶

- **Uleat** Fix for 'Invalid Slot ID' messages. Bag slot count is now enforced during database saves to eliminate existing 'hidden' duplicated items..sorry MQ2 users...

- **Uleat** Fix for Item loss during corpse looting and possible item loss when purchasing items from LDoN or Adventure merchants. (cursor-related)

## 02/27/2015¶

- **Uleat** Final 'tweak' for light sources until a valid issue arises. Wearable equipment now matches client behavior. Stackable light sources are bugged in the client..but, the current timer update implementation alleviates this condition.

## 02/26/2015¶

- **Uleat** Updated light source criteria to (hopefully) match what the client uses (still needs tweaking)

- 

**Uleat** Changed 'general' light source checks to accept the last valid light source (client behavior)

Notes:

"Fire Beetle Eyes" are still causing issues in general slots (no item movement sound effect)

- Wearable equipment types still register as valid light sources when in general slots (needs exemption criteria)

## 02/23/2015¶

- 

**Noudess** Allow for a rule to set starting swimming && SenseHeading value.

I moved the swimming override to char create instead of setting it

every time a char enters a zone.

Also added rules to not ignore, but rather forrce sense heading packets to be used to train it instead of maxing it out like before.

- **Uleat** Fix for RoF+ clients showing active 'Return Home' button when action is not available (swapped 'GoHome' and 'Enabled' fields in RoF-era CharacterSelectEntry structs)

## 02/21/2015¶

- **Noudess** Starting erudites that were supposed to start in paineel were landing in erudin on Titanium. Fixed to be paineel.

## 02/20/2015¶

- **mackal** Implement claims for RoF/RoF2 (should no longer crash the client!)

- fixed bugs related to claims for the rest of the clients (woo infinite loops)

## 02/18/2015¶

- **Trevius** Fix for potential recursive loops if using RemoveFromHateList() within EVENT_HATE_LIST.

## 02/17/2015¶

- 

**Uleat** Implemented per-client character creation limiting. Caps are unknown atm..so, don't get over-zealous!

Notes:

Titanium is hard-coded to min/max of 8 in both the server and client translator code (client doesn't support variations in available character count)

- SoF thru RoF2 have had their max characters raised to 12 from 10

- 

Changing the number of characters per account is accomplished by:

1) Setting consts::CHARACTER_CREATION_LIMIT to the desired count in the client's constants file in ../common/patches/

2) Ensuring that eq_dictionary's EmuConstants::CHARACTER_CREATION_LIMIT is equal-greater than the client's new value..referencing is good

3) Recompiling the server code
 * A rules-based qualifier may be added at some point

## 02/16/2015¶

- **Trevius** (RoF2) Bazaar Trading (Buying/Selling) is now fully functional. Bazaar (/bazaar) search is not yet functional.

- **mackal** (RoF2) Send the bard focus effects, note custom servers will need to fix their items, server side we still use the old system, but RoF2 wasn't showing anything with not sending focus, so send them

## 02/14/2015¶

- **Trevius** (RoF2) Bazaar is now partially functional. RoF2 clients can start/end trader mode and other clients can purchase from them. No other functionality yet.

- **Uleat** Implemented higher bandolier and potion belt counts for clients that support it..you will still need to activate them through the proper aa's, etc...

## 02/12/2015¶

- **Akkadius** Implement zone based gravity, required SQL DB change

- To test `zone` table `gravity` values, change the value and use #zheader to test

## 02/11/2015¶

- **Trevius** (RoF+) Bandolier no longer displays a Treasure Chest Icon when no Bandoliers are set.

## 02/09/2015¶

- **Trevius** (RoF+) Setting Alt flag on characters in the Guild Management Window is now saved and functional for filtering.

- **Trevius** (RoF+) Guild Invites between RoF+ and previous Clients is now functional.

## 02/08/2015¶

- **Kayen** Implemented npc special ability (44) COUNTER_AVOID_DAMAGE which when applied to the ATTACKING NPC will make their attacks more difficult to be avoided by riposte/dodge/parry/block.

- Parama0: Negative modifer value that affects ALL avoid damage types dodge/parry/riposte/block) chance on defender. Ie (44,50 = 50 pct reduction to ALL)

- Parama1: Negative modifer value that affects RIPOSTE chance on defender. Ie (44,1,0,50 = 50 pct reduction to riposte chance)

- Parama2: Negative modifer value that affects PARRY chance on defender. Ie (44,1,0,0,50 = 50 pct reduction to parry chance)

- Parama3: Negative modifer value that affects BLOCK chance on defender. Ie (44,1,0,0,0,50 = 50 pct reduction to block chance)

- 

Parama4: Negative modifer value that affects DODGE chance on defender. e (44,1,0,0,0,0,50 = 50 pct reduction to dodge chance)

Example of usage: Player has Improved Dodge V (+50 pct dodge chance), you want to negate this bonus you would set 44,1,0,0,0,0,50 on your NPC.

## 02/07/2015¶

- **Akkadius** Reduced #repop time dramatically by taking down hundreds of individual SELECT/DELETE/INSERT queries in routines and bringing it down to very few

## 02/06/2015¶

- **Uleat** Updated returns for Inventory and ItemInst const iterators. (const

## 02/05/2015¶

- **Trevius** Fixed Environmental Damage for RoF2.

## 02/03/2015¶

- **Trevius** Crashfix for TempName() when numbers are passed at the end of the name.

- **Uleat** Tweaking of item type exclusions to alleviate strobing conditions with light sources

## 02/02/2015¶

- **Akkadius** Implement Packet logs with dumps

- Category: 41: Packet: Server -> Client With Dump

- 

Category: 42: Packet: Server -> Client With Dump

See: http://wiki.eqemulator.org/p?Logging_System_Overhaul#packet-logging-levels

## 02/01/2015¶

**mackal**

### Add Quest Debugging to LUA¶

```
` eq.debug("Test debug level implicit 1")
 eq.debug("Test debug level explicit 1", 1)
 eq.debug("Test debug level explicit 2", 2)
 eq.debug("Test debug level explicit 3", 3)
`
```

**Akkadius**

### Add Packet Logging Categories¶

- 5 *Packet: Client -> Server* Logs::Client_Server_Packet

- 39 *Packet: Server -> Client* Logs::Server_Client_Packet

- 

40 *Packet: Client -> Server Unhandled* Logs::Client_Server_Packet_Unhandled

See: http://wiki.eqemulator.org/p?Logging_System_Overhaul#packet-logging

## 01/31/2015¶

- **Trevius** Fixed FindGroundZ() and GetGroundZ() to once again utilize the X and Y arguments that are passed to them.

## 01/30/2015¶

**Akkadius**

Implemented event type **EVENT_ENVIRONMENTAL_DAMAGE**

This event triggers when taking any sort of environmental damage. Example use:

```
`sub EVENT_ENVIRONMENTAL_DAMAGE{
 quest::debug("EVENT_ENVIRONMENTAL_DAMAGE");
 quest::debug("env_damage is " . $env_damage);
 quest::debug("env_damage_type is " . $env_damage_type);
 quest::debug("env_final_damage is " . $env_final_damage);
}
`
```

- Implemented LUA counterpart of this same implementation above

- **Bobaski** Add PoK New Merchant **sql/git/optional/2015_01_30_poknowledge_spell_vendors.sql**

## 01/29/2015¶

- **Trevius** Added more information to Mercenary Logging.

- **Trevius** Added potential fix for Mercenaries that fail to unsuspend.

- **Trevius** Added a new "statscale" field to the merc_stats table that can be used to quickly balance Mercenary Stats based on Level.

- **Trevius** The new "statscale" field now combines with the Mercs::ScaleRate rule value (default 100 percent for both).

## 01/28/2015¶

**Akkadius**

### Added Logs::DebugQuest Category Per Request from Trevius (Great idea)¶

- Exported quest::debug(log_message, [debug_level = 1)

```
`quest::debug("This is a test debug message, level 1 (default)");
quest::debug("This is a test debug message, level 1", 1);
quest::debug("This is a test debug message, level 2", 2);
quest::debug("This is a test debug message, level 3", 3);
`
```

- Uses traditional logging system to output this category

- Required MySQL Source in Database version 9070

## 01/27/2015¶

- **Trevius** Removed "Mercenary Debug:" from the Mercenary Log entries.

- **Trevius** Resolved duplicate "You have no Mercenaries" messages when zoning without owning a Mercenary.

- **Trevius** Mercenaries should now always be able to unsuspend if the timer is up.

- **Trevius** More work on Mercenaries and Grouping to reduce bugs and redundant queries.

- **Uleat** Finished ClientVersion update to include patch file and namespace updates * don't forget to copy the renamed 'patch_UF.conf' into your eqemu directory.)

## 01/26/2015¶

- **Uleat** Changed Corpse::MoveItemToCorpse() to allow 'by address' passing of removed item slot list. Fixed a bug that kept soul-bound items inside of bags from attuning properly

## 01/25/2015¶

- **Trevius** Fixed an issue where Mercenaries were causing several DB queries per second while suspended.

- **Trevius** Added Logs::Mercenaries to the new Logging System. Logging of Mercenary information is off by default with the required SQL.

## 01/24/2015¶

- 

**Uleat** Added equipment light source functionality to all mob derived classes (may still need tweaking...)

Notes:

In addition to equipment light sources, innate npc_type light sources have already been activated

- Valid light source values are 0 thru 15 (values are bitmask checked and limited to 0x0F)

- Not all classes handle equipment light sources the same way due to their equipment/loot list configurations

- Spell (casting?) light sources may be implemented at some point..more information is needed

- Currently, loot list (general inventory) light sources are limited to ItemTypeMisc and ItemTypeLight to avoid issues with worn-specific light sources emitting

- Augment light sources are not recognized by the client and, therefore, not implemented in the server code

## 01/22/2015¶

- **Akkadius** Massive Log System overhaul, see: https://github.com/EQEmu/Server/wiki/Logging-System

## 01/21/2015¶

- 

**Uleat** Added `light` field to npc_types load query (all six clients tested positive for functionality.)

Note: This only affects 'innate' light. Equipment (other) light is still in-work.

Optional SQL: utils/sql/git/optional/2015_01_21_NPC_Types_Light_Field_Primer.sql

## 01/20/2015¶

- **Uleat** Fix for Inventory::_HasItemByUse(bucket) using the parent container when searching for bag container items.

## 01/19/2015¶

- **Uleat** Changed 'enum EQClientVersion' to 'enum class ClientVersion.' Other light modifications were made to accommodate this namespace. Added 'RoF2' to the lua client version enumeration.

## 01/15/2015¶

- **Uleat** Attempted fix for elusive inventory bug:

- Removed 'iter_queue' typedef and converted lcast to explicit or auto defines

- Reworked several functions that manipulate the cursor queue

- Found/corrected one occurrence of post-processing iterator incrementing in an ItemInstQueue handler

- Added many scope declarations in code that handles inventory manipulation (loose macros are bad...)

- **Uleat** Added Item_Struct pointer checks to ItemInst methods that did not have them

- **Uleat** Changed IsEquippable(race,class) to use bit-wise 'and' (&) over '(x%2)

## 01/13/2015¶

- **Uleat** Placed an upper limit on the cursor queue save loop.

- **Trevius** (RoF2) Guild invites now add new members as members instead of recruits, and /guild chat works properly.

- **Trevius** (RoF2) Guild Promote is now functional.

## 01/12/2015¶

- **Uleat** Fix for OP_FormattedMessage text link server crashes

- **Uleat** Added text link translators for OP_TaskDescription (RoF+ -* all clients current)

- **Uleat** Fix for load_bots.sql using '\' as a delimiter (Changed to '$$')

## 01/11/2015¶

- **Uleat** Added text link translators for OP_TaskDescription (Ti thru UF..RoF+ in-work)

## 01/10/2015¶

- **Uleat** Added text link translators for OP_Emote

## 01/09/2015¶

- **Uleat** Added text link translators for OP_FormattedMessage

## 01/08/2015¶

- **Trevius** Added some extra checks and clean-up related to Groups and Mercenaries.

## 01/07/2015¶

- **Uleat** Excluded text link body from message scrambling in Client::GarbleMessage()

- **Trevius** Mercenaries now load directly from tables only. The vwMercNpcTypes view is no longer required and can be deleted.

- **Trevius** Query fix for group_leaders table. This may resolve some crashes/bugs related to Mercs/Bots and Groups.

## 01/06/2015¶

- **Trevius** Changed the pet command #defines to be based on RoF2 list of pet commands and added decodes to Titanium, SoF and SoD.

- **Trevius** (RoF+) The /pet focus on/off and /pet hold on/off commands are now functional.

- **Trevius** Added defines for all remaining pet commands and some support for them as well.

## 01/05/2015¶

- **Uleat** Fixed (added translators for) item/text links. Only 'OP_ChannelMessage' and 'OP_SpecialMesg' are currently handled..more text channels will be added as the need arises.

## 01/03/2015¶

- **Trevius** (RoF2) /shield (shielding) and /key (key ring) are both now functional after opcode updates.

## 01/02/2015¶

- **Trevius** (RoF2) *Hopefully* Fixed looting incorrect items from NPCs. Please report any issues!

- **Trevius** (RoF2) Now able to loot items past the 10th slot on NPC corpses.

- **Trevius** Attuned Items can now be auto-looted and will equip properly.

- **Trevius** Mercenaries and Bots will no longer take a share from /split or /autosplit

---

## 2016

*Source: changelog/server/2016/index.html*

# 2016¶

### 12/03/2016¶

**Uleat**

### Added hack detection to trade code¶

- If illegal items are found in trade slots when the 'trade' button is clicked, the trade is cancelled and a message is sent to the offending player

- Future revisions will, at a minimum, log the player as a hacker once the quirks have been worked out

## 12/01/2016¶

**Uleat** Disabled RoF+ clients from augmenting items not in their possessions slots (0-29, 9999, 251-330) to abate an exploit in the current code

## 10/17/2016¶

- **Uleat** Moved namespace ItemField from item_instance.h to shareddb.cpp * the only place it is used

- **Uleat** Separated class Inventory from item_instance files into inventory_profile files

- **Uleat** Renamed class Inventory to EQEmu::InventoryProfile

- **Uleat** Renamed enum class InventoryVersion to MobVersion

## 10/16/2016¶

**Uleat**

### Renaming Work¶

- Renamed struct **EQEmu::ItemBase** to **EQEmu::ItemData** and class **ItemInst** to **EQEmu::ItemInstance**

- Added class **EQEmu::InventorySlot**. Re-attached pertinent inventory token references to **EQDictionary**

## 10/15/2016¶

**Uleat** Changed filenames to facilitate future inventory naming conventions

## 10/09/2016¶

**Noudess** Rogue usage of merchants while utilizing sneak was limited to temporary items, as the code that checked faction per item sold did not take into account that rogue was sneaking. Now sneaking rogues can see full inventory on merchants (well, unless an item requires a + faction value)

## 09/12/2016¶

**Akkadius**

### Massive Overhaul of the Update System and EQEmu Server Management Utility Framework¶

- `eqemu_server.pl` is now a general EQEmu Server management utility framework that can be used to extend to many purposes. It's main purpose is to simplify server management

- `eqemu_server.pl` changes

- 

Menu has been completely changed, instead of a number based (enter number and hit enter)

you now type commands within the menu (Ex: 'database')
 * Handles last mile installation for Windows Servers (See Github Readme)
 * Handles last mile installation for Linux Servers (See Github Readme)
* Ubuntu
* Debian
* Fedora
* CentOS
 * Now checks for Internet connection before performing web requests

### Database Updates¶

- 

Regular schema updates now happen automatically, if new binaries present updated

database schema changes, script will backup first, auto update database, and continue

world bootup
* Regular bots database schema changes now happen automatically similarily to the above
* Database checks can also be ran manually via the script menu

### CLI Arguments¶

- 

Arguments passed to eqemu_server.pl can execute the same name-based operations that

are present in the interactive menu

Example: "perl eqemu_server.pl opcodes" will download opcodes

- Example: "perl eqemu_server.pl backup_player_tables" will backup and export player tables

### Bots¶

- Bots can now be automatically setup in Linux or Windows via the 'setup_bots' command

- Windows will auto download binaries and install, along with installing bots db schema

- Linxu will auto compile binaries and install, along with installings bots db schema

### Utility scripts¶

- 

Linux now has the following utility scripts for download, available via menu 'utility_scripts'

and via Linux default install:

server_launcher.pl

- server_start_dev.sh

- server_start.sh

- server_status.sh

- server_stop.sh

### Usage analytics¶

Info

**eqemu_server.pl** now collects usage analytics, this is very helpful for our developers

- Example: We can see how many installs have been performed:

- https://github.com/EQEmu/Server#server-installs

- This helps us see how often certain utilities are used as well

### Console Messages¶

All script messages have been prefixed with a bracket action Ex: [Update] [Database] [Info] to be more consistent with our log conventions

### "New Server" Utility¶

Running 'new_server' from the main menu or 'perl eqemu_server.pl new_server' while in a completely new folder with just the script present, will allow a server operator to initiate a full clean PEQ install in that folder. Pulling down all assets and installing a PEQ database with the name the server operator gives the prompts in the script

## 09/10/2016¶

**noudess** Task system experience based on a % of a level did not take into account the hell levels rule. Now it does.

## 09/03/2016¶

**Uleat** Changed 'Bind Wound' behavior to match the best references that I could find for post-2004 era.

Info

If you wish to retain the old method, source in the optional **2016_09_03_old_bind_wound_rule**.**sql** script file.

## 08/27/2016¶

**Kinglykrab**

### Added Pptional IP-Based Account Exemptions¶

- To use this system simply set World:EnableIPExemptions to true and create an entry in the ip_exemptions table.

- Example: exemption_ip of IP 192.168.1.4 in ip_exemptions with exemption_amount of 1 will allow only 1 account to login from IP 192.168.1.4.

- Note: If there is no exemption, the amount of accounts logged in from a singular IP will default to World:MaxClientsPerIP

## 08/23/2016¶

**noudess** Force mobs on a depop @ end pathgrid to still do this on idle zones. This makes them be more random after a zone is idle, rather than always showing up at start point when 1st person logs into an idle zone. Much more like live. I didn't think this will be much of a performance problem. Once they path and depop, no more cpu usage.

## 08/14/2016¶

**mackal**

### Implement Linked Spell Reuse Timers¶

- For whatever reason this is a bit unfriendly, but that's how it is on live.

- Titanium is especially unfriendly with large differences in reuse times (ex higher canni and the first 4)

- Unsure when this went live for spells, but canni was at least linked at OoW launch

## 08/13/2016¶

**Kinglykrab**

### Implemented **O**ptional Avoidance Cap Rules¶

- Serves to eliminate God-like characters on custom servers with high item stats

#### Rule Names¶

- **Character:EnableAvoidanceCap** (default is false)

- **Character:AvoidanceCap** (default is 750, beyond 1,000 seems to make characters dodge all attacks)

## 08/02/2016¶

**Uleat**

### Changed "SendZoneSpawnsBulk" Behavior to Use Near/Far Criteria (live-like)¶

- Zone-to-Zone client loading will see a small decrease in time (less than 10~15%)

- World-to-Zone client loading appears to greatly benefit from this (tested 'devastation' - pre-change: ~22 seconds, post-change: 12~15 seconds)

- This change does not affect the final spawning of mobs in the client

## 07/31/2016¶

**mackal**

### Implemented More Spell Gems!¶

- There are a few things still left to due like make dealing with losing gems nice (reset AAs, going to an older client etc)

- Sadly SoF disc release doesn't support gem 10 like one might expect :(

- So changed clients:

- SoD = 10

- UF = 12

- RoF/RoF2 = 12. I know the UI supports 16, but the client does not and can cause client crashes

- The quest APIs assume you pass a valid spell gem

## 07/28/2016¶

**Uleat**

### Implemented Zone Memory-Mapped File Usage¶

- Zone map files are converted to pre-loaded binary files, bypassing the (sometimes) time-consuming raw data transform process

- There are three ways to convert files

```
` -* Do nothing! The zone bootup process will check for a mmf file and load it, if found, or create it after the 'normal' transform process is complete
 -* Use the command line option: zone convert_map <zone_name>.map (for singular conversions)
 -* Drop the 'convert_maps_to_mmfs.pl' into your server directory and execute it for a batch conversion
 -* Note: Any zone maps not pre-converted will be processed once a zone is booted up that does not have one
`
```

- To enable this feature, you must have the 'USE_MAP_MMFS' option checked in cmake and have built binaries on that

- To disable this feature, or if you encounter problems, disable the 'USE_MAP_MMFS' option and rebuild your binaries

- This feature will test the validity of your zlib library. If you get errors/crashes upon conversion, then your zlib1.dll is most likely suspect (check our forum for solutions)

## 07/25/2016¶

**mackal**

### Fix up the SpellBuff Struct¶

- THERE MAYBE BUGS

- there shouldn't though, most of the hackery was from badly named fields causing confusion

## 07/09/2016¶

**Uleat**

### Important Fix for mob pathing¶

- This should fix failed pathing issues (and high cpu usage for zone.exe) for mobs in affect zones

- Changed variable 'gridno' type from int16 to int32 to reflect actual return value of fetch (values do exceed 32767 aka int16.max)

- Precision loss from int32 to int16 conversion was causing grid id to be changed to quest controlled movement in cases where (gridno & 0x8000

## 06/28/2016¶

- **Noudess** Resurrection effects now block certain buffs like on live.

- **Noudess** Added message about why spells are blocked (rule based)

- **Noudess** Added new rule: Client:UseLiveBlockedMessage

- **Uleat** Fix for bot inventory save failure involving items with unlimited charges

## 06/13/2016¶

- **Noudess** Changes personal faction earned min/max to -2000/2000 from -3000/1200

## 06/06/2016¶

- **Uleat** Reworked EQEmuDictionary to use class LookupEntry

## 06/01/2016¶

- **Uleat** Implemented EQEmu::TintProfile

- **Uleat** Implemented EQEmu::TextureProfile

## 05/31/2016¶

- **Uleat** Converted enumeration MaterialSlots to EQEmu::textures::TextureSlot

## 05/28/2016¶

- **Uleat** Merged client_version and inventory_version into emu_versions files

## 05/27/2016¶

- **Uleat** Renamed EQEmu::Item_Struct to EQEmu::ItemBase (and appropriate files) to coincide with new inventory naming conventions

## 05/25/2016¶

- **Uleat** Renamed and moved enumeration SkillUseTypes to EQEmu::skill::SkillType * added class EQEmu::SkillProfile, though not implemented at this time

- **Uleat** Some more work on eq_dictionary

## 05/21/2016¶

- **Uleat** Moved struct Item_Struct into namespace EQEmu along with associated enumerations * enumerations into namespace EQEmu::item (run shared_memory)

- **Uleat** Fixed a few possible crash points in linux builds associated with augments/ornamentations

## 05/18/2016¶

- **Uleat** Changed client 'constants' files to 'limits'

## 05/10/2016¶

- **Uleat** Converted client translators' 'SerializeItem()' to recursive, single buffer methodology. Titanium SerializeItem() now adds a null term between parent items instead of the invoking function

- **Uleat** Converted server 'BulkSendInventoryItems()' to use single buffer methodology

- **Uleat** Added 'ItemInst::Serialize()' overload to make use of the above single buffer methodology

## 05/08/2016¶

- **Uleat** Re-coded Titanium client translator 'SerializeItem()' to use coded property assignments over file enumerated ones

## 04/22/2016¶

- **Uleat** Reworked ClientVersion into namespace EQEmu; Added InventoryVersion

- **Uleat** Delinked current inventory slot enumeration and constants from EQEmu::constants and global definition (inv2 pre-work)

## 04/19/2016¶

- **Uleat** Changed the recent EQEmu rework to eliminate the nested class design (possible cause of VS2015 update crashes * unverified)

- **Uleat** Some more inv2 convergence work

## 04/15/2016¶

- **Uleat** Reworked EQDictionary into namespace EQEmu

## 04/08/2016¶

- **Uleat** Added Heal Rotation HOTs (Heal Override Targets) that can be set for proactive healing (default HR behavior is reactive)

- **Uleat** Added the ability to save/load/delete Heal Rotations based on targeted member * load is automatic when ^hrcreate is used on a bot that has a saved HR entry

## 04/07/2016¶

- **Uleat** Rework of eq_dictionary to facilitate inventory work

## 04/05/2016¶

- **Uleat** Moved database query code out of bot.cpp and into the new BotDatabase class

## 03/25/2016¶

- **Uleat** Fix for heal rotation 'Stack Overflow' error

- **Kayen** Defensive procs will now only proc once per attack round (instead of every attack chance) Live like modifier added that decreases defensive proc chance if you are higher level then your attacker.

## 03/24/2016¶

### AE Taunt Fixes, New Bot Command System¶

- **Kayen** Fix for AE taunt to use correct range and hate modifier. Fix for spell effect version of taunt to use correct range.

- **Uleat** Activation of new 'Bots' command system

- You will need to re-run cmake to capture the file additions and then re-compile your server binaries

- You will also need to manually run eqemu_update.pl and select the bots update option * you should have 2 pending updates: 9001 & 9002

- The new command system is accessed with the '^' character * start with '^help' and see where that takes you

- More information can be found on the eqemu forums

## 03/05/2016¶

**mackal**

### Implement Extra Bind Points (Secondary Recall)¶

- For SE_Gate, base2 is which bind to use (starting at 1)

- For SE_BindAffinity, base1 is which bind to set (starting at 1)

- For SE_GateCastersBindpoint, base1 is which bind to use (starting at 1)

There was actually no spells that don't send to the main bind, but it uses a base1 of 1 which matches with SE_Gate This also doesn't break anything

## 03/01/2016¶

- **Uleat** Fix for LDoN treasure 'npcs' not leaving a corpse (please report any issues..)

## 02/29/2016¶

- **Uleat** Change in AddItemBonuses *now includes ammo slot for skill mods only. Defined SoD* client SkillModMax packet property (client does not show..but, does enforce.)

## 02/11/2016¶

- **Hateborne** Added IgnoreSpellDmgLvlRestriction rule (boolean) to ignore the 5 level spread when checking to add SpellDmg

## 02/10/2016¶

- **Hateborne** Added FlatItemExtraSpellAmt rule (boolean) to allow SpellDmg on items to be added as raw damage versus scaled.

## 01/26/2016¶

**Uleat**

### Berserker Piercing Fixes, Item Weight Conversions¶

Fix for Berserker 'Piercing' skill issues. Server Admins: If you run custom skill sets, this patch touches the code segments that you will need to modify if you have changed the default berserker 1H-/2H-piercing skill values.

Uleat (Daerath): Fix for precision-loss item weight conversions in older clients.

- WARNING: YOU MUST RE-RUN SHARED_MEMORY.EXE BEFORE STARTING SERVER OR ITEM LOSS WILL OCCUR!

- Note: Cmake must be re-run to include/exclude the required files

## 01/13/2016¶

### #flag Modification, Item Links in #summonitem¶

- **Kinglykrab** Modified #flag so you can refresh your target's account status (GM status level) without them having to relog.

- Just target the person whose flag you want to refresh and type #flag.

- **Uleat** Added itemlink functionality to the #summonitem command. Current use is limited to extracting the item id from the link.

- Invoking by item link '#summonitem Arrow' produces the same result as by item id '#summonitem 8005'

## 01/12/2016¶

- **Athrogate** Adding ClearCompassMark() to Lua.

- Lua didn't have ClearCompassMark(). Perl already had this.

## 01/12/2016¶

- **Uleat** Fix for tradeskill containers remaining locked after a RoF+ client leaves. Intermediary fix for RoF+ clients accessing tradeskill containers when in use by another player (thanks Natedog!)

---

## 2017

*Source: changelog/server/2017/index.html*

# 2017¶

## 10/08/2017¶

**Mackal**

### Rework **Regens**¶

Regen will now match whats reported by modern clients, besides where they lie due to known bugs

HP and END regens are now based on the BaseData.txt values allowing easy customization

#### Cases¶

- The client always applies hunger penalties, it appears they don't exist anymore on live you can turn them on with a rule

- The way the client gets buff mana/end regen benefits incorrectly applies the bard mod making these values lie sometimes

## 9/17/2017¶

**Akkadius**

### Fix Food / Drink Consumption¶

Fix 95% of food/water consumption issues, if there are additional modifiers for race/class combos * those will need to be applied

### FixZ Offset Client Calc Added¶

Add model/race offset to FixZ calc (KLS)

Stages should be put in place if not already: https://wiki.project1999.com/Food_and_drink#Stages_of_Hunger_and_Thirst

Values stored in the database are 0-6000, previously we capped it at 6000 but previous math would have normal values in the 60k+ range in order for food to be consumed at a reasonable rate. We are now using more native logic where 1 = 1 minute

## 7/14/2017¶

**Akkadius**

### HP Update Tuning, Position Updates¶

- HP Updates are now forced when a client is targeted

- Client position updates should be smoother (granted the client has a good connection)

- Clients should also no longer randomly disappear

## 7/11/2017¶

**Akkadius**

### HP / Mana / Endurance Optimization Updates¶

- Raid/Group/XTarget HP/Mana/Endurance updates now only send when percentage changes

- Raid/Group Mana/Endurance updates should now update real-time once again

- Fixed an issue with clients looking like they are 'skipping' when they are moving in view of another client

- Fixed an issue with NPC's who are ghosted in plain view of a client when they are not really there

## 7/9/2017¶

**Akkadius**

### More HP Update Optimizations¶

Fix HP update issues, rework logic for more accurate HP updates

### Massive Performance Increases via Pruning Unnecessary Packet Sends¶

- Massive reductions in unnecessary network traffic especially during high spam combat fights

- HP Updates now only send to others when HP percentage changes (0-100%)

HP Updates were sending excessively even during idle zones when HP wasn't changing at all

- Attack animations now only send once per second versus up to a hundred times a second per Mob/Client

- 17,000 OP_ClientUpdate packets per second have been observed in combat scenarios, some of the major culprits have been throttled without affecting what the client should see

- Before and After packet differences under similar load/tests (Packets per second)

| 

Packets Per Second 
| Packet Type 
| After Optimizations 

| 7,000 - 8,000pps 
| OP_Animation 
| 600-800pps 

| 13,0000 - 17,000 
| OP_MobHealth 
| 1-10 pps 

| 15,0000 - 20,000 
| OP_ClientUpdate 
| 500-1,000 

- Packet reports from a 46 client test here https://gist.github.com/Akkadius/28b7ad2fdd82bdd15ea737c68f404346

- Servers who use Marquee HP updates will also receive far less packet spam as they will only be sent when HP changes

## 7/1/2017¶

**Akkadius**

### Resolve Issues with NPC's Hopping to the Ceiling in Small Corridors¶

- Improved grounding issues with NPC's during combat

- Improved scenarios where NPC's need to be dragged out of the ground - they should correct themselves far more consistently

- Scenarios where an NPC is coming up from the bottom floor, or from the top floor, they will correct much better

## 6/28/2017¶

**Akkadius**

### More Z Correction Fixes¶

- Fixed issues with Z correctness when NPCs are pathing on normal grids

- Fixed issues with Z correctness when NPCs are engaged with players following

- NPC corpses should fall into the ground far less

## 6/25/2017¶

**Akkadius**

### Rule System Improvements, Saylink Optimizations¶

New rules made by developers are now automatically created when world boots up, this keeps from having to issue schema SQL updates every time rules are added.

Whenever a rule isn't present in the database, it will be automatically created

Sped up saylink retrieval x1000 helpful for dialogues, plugins with many saylinks by adding table index

## 4/16/2017¶

**KLS**

### Network Code Overhaul¶

#### Client¶

- UDP client stack completely rewritten should both have better throughput and recover better (peq has had far fewer reports of desyncs)

#### Server Backend¶

- TCP Server to Server connection stack completely rewritten.

- Server connections reconnect much more reliably and quickly now.

- Now supports optional packet encryption via libsodium (https://download.libsodium.org/doc/).

- Protocol behind the tcp connections has changed (see breaking changes section).

- API significantly changed and should be easier to write new servers or handlers for.

- Telnet console connection has been separated out from the current port (see breaking changes section)

Because of changes to the TCP stack, lsreconnect and echo have been disabled.

- The server tic rate has been changed to be approx 30 fps from 500+ fps.

- Changed how missiles and movement were calculated slightly to account for this (Missiles in particular are not perfect but close enough).

#### Breaking changes¶

- Users who use the cmake install feature should be aware that the install directory is now %cmake_install_dir%/bin instead of just %cmake_install_dir%/

- To support new features such as encryption the underlying protocol had to change... however some servers such as the public login server will be slow to change so we've included a compatibility layer for legacy login connections:

- You should add 1 to the login section of your configuration file when connecting to a server that is using the old protocol. 

- The central eqemu login server uses the old protocol and probably will for the forseeable future so if your server is connecting to it be sure to add that tag to your configuration file in that section.

- Telnet no longer uses the same port as the Server to Server connection and because of this the tcp tag no longer has any effect on telnet connections.

To enable telnet you need to add a telnet tag in the world section of configuration such as

```
`<telnet ip="0.0.0.0" port="9001" enabled="true"/>
`
```

## 4/1/2017¶

**Akkadius**

### Log System Performance Enhancements¶

Cleaned up some of the NPC to NPC aggro code, only do aggro checks to other NPC's when the NPC is flagged for it

Reworked how all log calls are made in the source

```
`// Before
Log.Out(Logs::General, Logs::Status, "Importing Spells...");

// After
Log(Logs::General, Logs::Status, "Importing Spells...");
`
```

We're now using a cpp macro to check if the logging category is enabled before even trying to process strings and do string building

#### The Performance Difference¶

- It's 200-300x faster especially when log statements are inside very hot code paths. We already had most hot paths checked before we logged them, but this blankets all existing logging calls now and not just the select few we had picked out in the source

- Strings don't get copied to the stack, popped and pushed constantly even when we hit a log statement that actually isn't going to log anything

## 03/30/2017¶

**Akkadius**

### More Server Backend Optimizations¶

Fixed an overhead issue where many hot paths would trigger quest subroutines and beneath that the code would try to see if a quest existed perpetually (checking if file exists) even though it should have determined the quest didn't exist the first time.

This caused a lot of overhead in an instance where an entire zone of NPC's is pathing, triggering **EVENT_WAYPOINT_ARRIVE** and **EVENT_WAYPOINT_DEPART** when there is no `global_npc.pl/lua`, or all NPC's pathing don't have a quest assigned, similar behavior would occur. This goes for any other type of **quests: spells, items, encounters** etc.

## 03/28/2017¶

**Akkadius**

### **Server Optimizations Again?**¶

- Fixed a large overhead issue where every single NPC in a zone was checking to depop themselves as a swarm pet every 3ms regardless of being a swarm pet or not. Swarm pets now check to depop only when their timer is up

- Removed a timer where clients would constantly calculate light amount on equipment every 600ms, instead clients will update light when changing equipment or entering a zone

- Disabled enraged timer checks for NPC's that do not actually have enrage as a special attack

- Don't process **ProjectileAttack** checks for NPC's that are not engaged in any combat

## 03/27/2017¶

**Akkadius**

### Server Optimizations Chapter XVII, Client to NPC Aggro Scanning Rework¶

#### Before¶

Before when reverse aggro checks were done (client to NPC), checks would happen every 750 milliseconds where a client would check an entire entity list with distance calcs and other checks for aggro, with many clients in a zone and many NPC's this would add a lot of unnecessary overhead. A temporary adjustment on 3/25 was made and upped the check to 6 seconds

#### Now¶

Now, there is a new methodology to scanning. The client will build a cache list of NPC's within close range as defined in new rule: **RULE_INT(Range, ClientNPCScan, 300)** and will also get any NPC that has an aggro range beyond that defined range to use in the frequent checks for aggro, the result is far less overhead

Client scanning changes when moving versus not moving, the client will scan aggro every 500 milliseconds while moving, and 3000 milliseconds aggro check when not moving, with a 6000ms re-fetch for close NPC's

#### Changes Demo¶

## 03/25/2017¶

**Akkadius**

### **More Performance Profiling Improvements**¶

- Reduced CPU footprint in non-combat zones doing constant checks for combat related activities

- Reduced CPU footprint in cases where a client is checking for aggro excessively every 750 milliseconds. This has been adjusted to 6 seconds per new rule **RULE_INT(Aggro, ClientAggroCheckInterval)**

Info

When zones have many players, with many NPC's, this adds up quickly

## 03/12/2017¶

**Akkadius**

### **Implemented Packet Range Rules for Performance and Unnecessary Packet Sends**¶

```
`RULE_INT ( Range, Say, 135 )
RULE_INT ( Range, Emote, 135 )
RULE_INT ( Range, BeginCast, 200)
RULE_INT ( Range, Anims, 135)
RULE_INT ( Range, SpellParticles, 135)
RULE_INT ( Range, DamageMessages, 50)
RULE_INT ( Range, SpellMessages, 75)
RULE_INT ( Range, SongMessages, 75)
RULE_INT ( Range, MobPositionUpdates, 600)
RULE_INT ( Range, CriticalDamage, 80)
`
```

(Readability) Also cleaned up some formatting in messaging and packets so it is easier to understand what is going on with the code

## 03/09/2017¶

**Uleat**

### Fixed a Few Bot Trading Glitches¶

- Add a temporary fail clause for partial stack transfers to prevent client item overwrites

- Return messages no longer repeat the top cursor item when multiple items are pushed there

- Test slot for client returns is now handled appropriately for parent and bag searches

- FindFreeSlotForTradeItem() now begins at the correct bag index on subsequent parent iterations

- First step of implementing inventory v2.0

## 03/08/2017¶

**Uleat**

### Complete Rework of the Bot Trading System¶

- Equipment slot priority can now be tailored... though, a recompile will be required

- All item validations and slot assignments for trades and returns are now performed before any actual item movements occur

- Failed trade/returned items will now go straight into the client's inventory, just like a normal trade transaction

- A 'green' message appears at the end of each successful trade informing the trader of 'accepted' and 'returned' item counts

- Bots respond to the trader directly now instead of using BotGroupSay()

- Bots will still only allow trades from their owner (currently, too high a risk of exploit and/or malicious activity)

- Partial stack movements (i.e., ammo refills) have been scoped..but, not implemented

- I have not been able to reproduce any 'illegal' weapon combinations with this code

- NOTE: The report of item duplication with bot return items appears to be an inventory desync condition

- I experienced this condition both before and after the rework with RoF+ clients (UF* appears ok)

- The bug lies within the actual client inventory system and not with bot trades

- Please post any issues with this change as they arise

## 02/27/2017¶

**Uleat**

### Bot Movement Changes¶

- Clients (players) appear to be on a different speed scale than other entities (NPCs, etc...)

- The server does not calculate deltas/velocities for moving players..those come the client itself

- GetBotWalkspeed() and GetBotRunspeed() are specific to bot movement calculations

- The class Mob equivilents are not scalared so that a 'client-oriented' value can still be attained

- The value of ~1.786f is derived from the ratio of 1.25f/0.7f (npc speed/client speed)

- Modifying the two speeds like this is a rough guess-timate..but, appears to at least bring the incongruous behavior to acceptable levels

## 02/26/2017¶

**Uleat**

### Bot Spell Changes¶

Moved bot `npc_spells` entries from '701-712' to 3000 + .. also, added melee types for future expansion

Moved bot spell casting chance values into database * this will allow admins to tailor their bots without having to rebuild server code

- Each entry uses a 3-dimensional identifier: [spell type index][class id][stance index]

- [spell type index] is not the SpellType_## bit value..use SpellType_##Index instead

- [class id] values of 1-16 are valid and hold a direct correlation to server-coded player class values

- [stance index] is a direct correlation (0-6)

- the 'conditional fields' are currently predicated on 4 compounded boolean states:

`pH_value` represents bit '0'

- `pS_value` represents bit '1'

- `pN_value` represents bit '2'

- `pD_value` represents bit '3'

- all other conditional fields are masked based on these 4 predicates

- the full conditional field enumeration is as follows:

`nHSND_value` * negative Healer/Slower/Nuker/Doter

- `pH_value` * positive Healer

- `pS_value` * positive Slower

- `pHS_value` * positive Healer/Slower

- `pN_value` * positive Nuker

- `pHN_value` * positive Healer/Nuker

- `pSN_value` * positive Slower/Nuker

- `pHSN_value` * positive Healer/Slower/Nuker

- `pD_value` * positive Doter

- `pHD_value` * positive Healer/Doter

- `pSD_value` * positive Slower/Doter

- `pHSD_value` * positive Healer/Slower/Doter

- `pND_value` * positive Nuker/Doter

- `pHND_value` * positive Healer/Nuker/Doter

- `pSND_value` * positive Slower/Nuker/Doter

- `pHSND_value` * positive Healer/Slower/Nuker/Doter

- Single* and mixed-bits fields should be filled-in based on the boolean 'AND' concept

- (i.e., if 'healer' then `pH_value`=x; if 'slower' then `pS_value`=y; if 'healer' AND 'slower' then `pHS_value`=z; )

- most cases can allow the same value across all fields..but, there are some that shouldn't and this format allows for their discrimination

- Valid `##_value` entries are 0-100..though, the field accepts up to 255... Anything above 100 is clamped to 100 upon loading, however...

- Not all conditions are currently coded and changing a field may not produce any results

- The 'default' database values will be changed and tweaked as bot spell code modifications occur

## 02/25/2017¶

**Uleat**

### Implemented Rule-Based Node Pathing for Bots¶

- This currently applies to out-of-combat following movement and blocked los in-combat movement

- The default is set to 'true' (use node pathing)..so, consider disabling it if cpu use is too high

- If you want to disable node pathing, apply the optional sql `2017_02_25_bots_use_pathing_rule.sql` file located in the utils/sql/git/bots/optional sub-directory. This will apply a 'false' rule..but, it can be changed as desired

- This helps with bot movement..but, there are still issues...

### Implemented Rule-Based Position Update Packet with Movement Timer Check for Bots¶

- This currently only applies to out-of-combat movement

- The default is set to 'false' (original behavior) to help save bandwidth (each bot will send an update packet every 1/10th of a second when enabled)

- If you want to enable the position update packet, apply the optional sql `2017_02_25_bots_update_position_with_timer_rule.sql` file located in the utils/sql/git/bots/optional sub-directory. This will apply a 'true' rule..but, it can be changed as desired

- This appears to help with/eliminate rubber banding

## 02/23/2017¶

**Uleat**

### Moved Bot Spell Casting Chance Values into Database¶

...this will allow admins to tailor their bots without having to rebuild server code

- Each entry uses a 4-dimensional identifier: [spell type index][class index][stance index][conditional index]

- [spell type index] is not the SpellType_## bit value..use SpellType_##Index instead

- [class index] values of 0-15 are valid and determined by subtracting 1 from the actual class value

- [stance index] is a direct correlation (0-6)

- the [conditional index] is currently predicated on 2 compounded boolean states:

not primary healer/not primary slower: 0

- primary healer/not primary slower: 1

- not primary healer/ primary slower: 2

- primary healer/primary slower: 3

- Valid `value` entries are 0-100..though, the field accepts up to 255... Anything above 100 is clamped to 100 upon loading, however

- Not all conditions are currently coded and changing a field may not produce any results

- The 'default' database values will be changed and tweaked as bot spell code modifications occur

## 02/20/2017¶

**Uleat**

### Reworked Bard Bot Spell Twisting and Updated their Spell (song) List¶

Added ability to shift to pre-combat song buffing by selecting a non-pet npc target, eliminating the need to mix all bard buff songs together

## 2/19/2017¶

**Akkadius** Added a fix for limiting the amount of items sold in a stack when the resulting return coin is higher than the supporting struct for returning coin

## 01/31/2017¶

**Uleat** Modifed bot movement behavior in an attempt to 'normalize' it. This is a hack fix and will be revisited at some point. (Probably just need a follow function rather than use movement, when the leader of the follow chain is moving.)

## 01/26/2017¶

**Uleat** Change rogue bot behavior to eliminate twirling combat. They will only get behind the mob if they are not the mob's target or if the mob is feared or fleeing. This may lower rogue bot dps a small fraction..but, is more in-line with realistic game mechanics.

## 01/17/2017¶

**Mackal**

### Combat Revamp¶

- This change brings melee combat into line with how combat is done on live.

- This correctly applies the PC damage tables and corrects stacking order of many spells

- Given the scope of what had to be rewritten, it was not feasible to preserve the old combat system.

This means you will likely have to rebalance your server, which sucks, but this is very

accurate so shouldn't require any more changes, at least none that would cause you to have

to rebalance your server again.

- For rebalancing, I would recommend running the optional SQL and tweaking from there.

- To help with rebalancing there is a simulator included at utils/combat-sim.

- You can enter the mitigation or offense values you would like to balance around (#showstats will show you them)

a 1 on the sim is min damage 20 is max.

- Quick recommendations for best ways to improve PC DPS, give them some worn (or AA) SE_DamageModifier and/or SE_MinDamageModifier

---

## 2018

*Source: changelog/server/2018/index.html*

# 2018¶

## 12/30/2018¶

**Akkadius (KLS)**

### NPC Movement Overhaul¶

Info

"Recently, we landed massive changes to pathing logic (Navmesh) with NPC's that took a while to iron out but has been an immensely positive addition to the EQEmu server core. With that, it's made us realize how much some related functionality needed to be addressed and that involves "NPC movement logic". We've been needing to address NPC movement logic for years as it has been fragmented and inconsistent all over the code which has made fixing actual movement related issues a nightmare. There are many other technical things that we can go into about it but the important part is that it is much improved! Special thanks to KLS for putting in a lot of work to make this happen"

#### NPC Behavioral Changes¶

- NPC's should now smoothly path between source and destination, rather than "skipping" all over the place between path points and sending sometimes several position updates, there should only be one update until NPC changes heading or speed

- NPC pathing during flee and fear should be far improved

- NPC pathing inside of water should be far improved

- NPC transitions between water and land should now be seamless

- NPC transitions over verticals (hills) should be smoother as well

- NPC "Stuck" logic during path finding should be improved

- NPC Z coordinate plane correction now occurs during path calculation projection properly (as it should) instead of brute forcing the current Z location along different path projections

## 12/16/2018¶

**Akkadius**

### Implemented Global Base Scaling, DevTools, GM Command Saylink Support and New Logging Categories¶

- Implemented: Global Base Scaling: https://github.com/EQEmu/Server/wiki/NPC-Scaling

- Implemented: Beginning of DevTools * more to be added over time (Status >= 200)

- Display NPC info on target

- Display Client info on target

- Display NPC show commands on target

Loot

- Grids

- Emotes

- Implemented: Support for saylinks to be used in GM commands

- Deprecated: Commands

- **listnpcs**

- Implemented: Commands

- **list [npcs.|players.|corpses|doors|objects] [search]**

Provides clickable saylinks to go to entities

- **scale [static/dynamic] (With targeted NPC)**

- **scale [npc_name_search] [static/dynamic] (To make zone-wide changes)**

- **scale all [static/dynamic]**

- **devtools (alias #dev)**

- Implemented: New Logging categories automatically injected into `logsys_categories` table

- Fixed an issue where newly injected categories were turned on by default

## 12/15/2018¶

**Kinglykrab**

### Added multiple new instance related quest functions.¶

```
`# Allows you to pull the instance ID of a client by character ID
quest::GetInstanceIDByCharID(const char *zone, int16 version, uint32 char_id);

# Allows you to assign an instance to a client by character ID
quest::AssignToInstanceByCharID(uint16 instance_id, uint32 char_id);

# Allows you to remove a client from an instance by character ID
quest::RemoveFromInstanceByCharID(uint16 instance_id, uint32 char_id);
`
```

### Added spell buckets, similar to spell globals¶

- Uses a new **spell_buckets** table and the **Spells:EnableSpellBuckets** rule. Added max level by data bucket.

- Uses data bucket `char_id-CharMaxLevel` and `Character:PerCharacterBucketMaxLevel` rule

## 10/09/2018¶

**Uleat**

### Added bot owner options¶

- Usage: `^owneroption [option] (or aliased as: ^oo [option])`

- Options are saved in the database and therefore, persistent

- Implemented option 'deathmarquee'

- Toggles client owner flag to show marquee message when a bot dies (default: disabled)

## 10/07/2018¶

**Uleat**

### Fixed a few bot issues¶

- Fix for bot item trades not attuning

- Fix for bot mana, endurance not updating properly

## 10/06/2018¶

**Uleat**

### Fixed a Few Bot Issues¶

- Fix for bot 'stop melee level' not honoring setting level over rule level

- Fix for missing bot combat spell casting when within melee range

- Fix (in-work) for bots 'forgetting' current target when it flees

## 09/18/2018¶

**Uleat**

### Notes for manual conversion of quest script inventory slot values¶

You should use reference/lookup values provided by the lua and perl apis to avoid skirting safety checks and to ensure that the values used are the correct ones for your needs

OldNew

```
`my $charmitem = $client->GetItemIDAt(0);
for($for_x = 22; $for_x < 30; $for_x++) {...}
for($slot1 = 0; $slot1 <= 30; $slot1++) {...}
`
```

```
`my $charmitem = $client->GetItemIDAt(quest::getinventoryslotid("charm"));

# General Inventory
my $slot_begin = quest::getinventoryslotid("general.begin");
my $slot_end = quest::getinventoryslotid("general.end");
for($for_x = $slot_begin; $for_x <= $slot_end; $for_x++) {}

# Possessions 
my $slot_begin = quest::getinventoryslotid("possessions.begin");
my $slot_end = quest::getinventoryslotid("possessions.end");
for($for_x = $slot_begin; $for_x <= $slot_end; $for_x++) {}
`
```

## 09/03/2018¶

**Uleat**

### Re-work of #invsnapshot Command and Implementation of Automatic Inventory Snapshots¶

- Inventory snapshots are now taken automatically using the interval rule values - if snapshots are enabled

- Command `invsnapshot` now has more options available to include a restore feature

- A pop-up help menu is available

- Argument 'capture' is available to anyone with status high enough to register the command

- Advanced options are only available to players with 150 status or greater

- Argument 'list' provides a list of "timestamp : item count" entries

- Argument 'parse' displays a "slot : item id : item name" listing of valid snapshots by timestamp

- Argument 'compare' shows a 'difference' comparison of "snapshot-to-inventory" changes

- Argument 'restore' applies a saved snapshot to the player's inventory (with a pre-clearing call)

## 08/13/2018¶

**Uleat**

### Activation of RoF+ Clients Two Additional General Slots and Integration of SoF+ Clients PowerSource Slot¶

- Inventory 'Possessions' main slots are now contiguous and implemented to RoF2 standards

- `slotGeneral9`(31) and `slotGeneral10` (32) are now active

- Possessions slot enumerations are now defined as between `slotCharm` (0) and `slotCursor` (33)

- `slotPowerSource` (21) is no longer a special case slot (9999)

- Special code has been added to exclude 'slotPowerSource,' 'slotGeneral9' and 'slotGeneral10' from server actions in clients that do not support them.

- The LUA Quest API has been updated to use the new slot enumeration as well as having some slot range definitions added

- The Perl Quest API now has a look-up function to provide token-to-value translations, definitions are similar to LUA

- In both LUA and Perl, it is HIGHLY recommended that any custom scripts using hard-coded inventory slot values be updated to use the constants/lookup methods as any old values are no longer guaranteed to be accurate

- Database will have existing inventory slot values modified to the new standard and table `items` entries will also be updated to the 'correct' equipable slot bitmask

- Script (quest) updates are required with this change

Info

The proper way to reference inventory slots is to use either intrinsic lookups (c/c++ & perl) or to use valid const ref declarations (c/c++ & lua). Any other method is not guaranteed to be accurate and may result in item loss and/or unexpected/undefined behavior

## 07/10/2018¶

**Akkadius**

### Adjusted DataBuckets to Use Other Acceptable Time Formats¶

```
`quest::set_data('key', 'value', '1d');
`
```

### Databucket Time Input Examples¶

| 

Input 
| Value 

| 15s 
| 15 seconds 

| s15 
| 15 seconds 

| 60m 
| 60 minutes 

| 7d 
| 7 days 

| 1y 
| 1 year 

| 600 
| 600 seconds 

## 07/09/2018¶

**mackal**

### Rework of Task System - Shared Tasks Still Unsupported¶

- The tables now have better named columns, which hopefully won't need to be explained

- Text1 is now target_name, Text2 is now item_list, Text3 is now description_override

- Tasks can now reward faction hits, this is just normal NPC Faction ID entries because I was lazy

- The "Task" type tasks are now supported, a player can only be doing one of these at a time

- Activity IDs for use spell on and use skill on have been identified but not implemented

- Identified "duration code" for unlimited duration tasks (None = 0, Short = 1, Medium = 2, Long = 3)

- Activities can now have multiple zones separated by ';'

- tasks.startzone removed since it actually just uses first activity

- skill_list and spell_list are both IDs that can be separated by ';' (still unimplemented though)

## 07/07/2018¶

**Akkadius**

### Implemented a MUCH Better Replacement for "qglobals" called "DataBuckets"¶

Info

Guide can be found here https://github.com/EQEmu/Server/wiki/Data-Buckets

## 07/05/2018¶

**Uleat**

### Reintegration of Inventory-Based EQDictionary References¶

- Standardized 'CONSTANT_DECLARATION' and 'enumerationValue' tokens for most of the affected references

- Added 'BEGIN' and 'END' constants to many inventory-based ranges to help eliminate '< SIZE'-type comparisons

- Eliminated multiple, duplicated reference points of the same value context (bye, bye namespace legacy!)

- Most server values are now linked to the implementation client directly through a 'using ##' directive

## 05/28/2018¶

**Akkadius**

### Lots of Changes! Maps, Pathing, Zone Shutdown, Aggro Distances¶

- Fixed an issue where size 0 NPC's hop in and out of the ground at idle

- NPC's now open doors within proximity given the door doesn't have locked requirements

- #reloadallrules will now display zones that have had their rules reloaded to GM's

- Zones should now respect "shutdowndelay" in the zones table at all times

- Fixed an issue where boats would snap to the bed of the body of water

- Added rule Aggro:NPCAggroMaxDistanceEnabled * defaults to true

- Changed map directory load structure to

- maps/base/*.map

- maps/nav/*.nav

- maps/water/*.wtr

- maps/path/*.path

**KLS**

### Implemented navigation mesh¶

- All up to date maps and navs can be found https://github.com/Akkadius/EQEmuMaps

- To update maps either check out the maps found in the above repository or use the maintenance command: `perl eqemu_server.pl maps`

## 03/28/2018¶

**Kayen**

### Spell Changes to Fade Effect¶

SE_CastOnFadeEffect, SE_CastOnFadeEffectNPC, SE_CastOnFadeEffectAlway triggered spell will now hit the correct targets.

## 03/07/2018¶

**Uleat**

### Added GM Command #ucs to Force a Reconnect to UCS Server¶

- Works in place of client auto-reconnect packet in zones where feature is unsupported

- Currently, you will need to manually re-join channels

## 03/04/2018¶

**Uleat**

### Updated UCS Versioning¶

- SoF and higher clients have a new opcode identified (update your *.conf files)

- Rework of previous ucs connectivity code

- Unrelated: Zone::weatherSend() now takes an optional parameter for singular updates (as in client entering zone) - prior to this, every client already in-zone received a weather update packet whenever a new client zoned in

## 02/18/2018¶

**Uleat**

### Bug Reporting Fix and Overhaul¶

- Fixed bug reporting for SoD+ clients

- Added ability to disable bug reporting (set rule 'Bugs:ReportingSystemActive' to 'false')

- Implemented a more detailed reporting system (set rule 'Bugs:UseOldReportingMethod' to 'false') - New system is not currently compatible with script-based monitoring

- Soft-removal of defunct 'Petition Bug' system

## 02/14/2018¶

**mackal**

### Fix Heading - Quests broken¶

Please report any other issues with heading, most things were tested and worked

You can use `eqemu_server.pl` to run a conversion to fix your headings in quests. Some may need manual review.

## 02/10/2018¶

**mackal**

### Add Global Loot system¶

This will allow us to implement global loot similarly to how it works on live This system reuses our current loottable tables which the global_loot table references. The limits for the rules to govern if a table should be rolled are min level, max level, rare, raid, race, class, bodytype, and zone race, class, bodytype, and zone are a pipe | separated list of IDs.

## 01/31/2018¶

**Uleat**

### Re-Work of Bot::AI_Process()¶

- Removed a 'ton' of unneeded packet updates

- Added a 'leash' to the distance a bot can travel

- Added a 'main assist' feature to target control (set using group roles)

- Added combat 'jitter' movement to complement the existing rogue movement

- Attack can now be aborted if target contains no leash owner nor bot hate and leash owner turns off auto-attack

- Please report any issues with the bot AI code

Added a work-around for heal rotations crashing the server - under certain conditions.

## 01/28/2018¶

**Mackal**

### Spell AI Tweaks¶

AI spells are treated as "innate" spells (devs use this term, and I think this is what they mean by it) These spells are spammed by the NPC, lots of encounters on live work like this and this will greatly reduce the need to do quest scripting on these types of encounters.

You can safely run update npc_spells_entries set priority = priority + 1 where priority >= 0; if you want to disable this new behavior

---

## 2019

*Source: changelog/server/2019/index.html*

# 2019¶

## 12/25/2019¶

**Akkadius**

### **World CLI Interface Overhaul**¶

- We've added a CLI interface to the world process which can be handy for various things, such as showing build version, database schema, database version or other utility things like setting account status. This feature is built in such a way that makes it easier for the development team to also add other commands in the future

- Added an internal single source of truth for where we maintain our database schema for different types of tables. These lists will be significant for things like export/import commands, future plans for multi-tenancy etc.

- Player Tables

- Content Tables

- State Tables

- Server Tables

- Login Tables

- CLI Interface Changes

- Commands that used option flags are arguments are now proper arguments as shown in examples. This is reflected in the Loginserver CLI as well and the documentation has been changed to reflect

Old

- ./world database:set-account-status --name=* --status=*

- New

- ./world database:set-account-status {name} {status}

- ./world database:set-account-status myaccount 255

```
`eqemu@9044748fdbe2:~/server$ ./bin/world --help

> EQEmulator [WorldServer] CLI Menu

database
 database:schema Displays server database schema
 database:set-account-status Sets account status by account name
 database:version Shows database version
world
 world:version Shows server version
`
```

## 12/10/2019¶

#### Uleat¶

### Fixes and New Bot Command¶

- Fix for pets breaking mez during combat

- Fix for bot classes having skills they should not

- Added bot command `itemuse`

- This command will cause spawned bots to report if they can use the item which you currently hold on your cursor

- To use this command, simply pick up an item and type `^itemuse`

- All spawned bots will check their inventories based on the items 'Slots' property and report that it is usable by them (no report if not usable)

- Each bot will give a report for each eligible slot

- To give the item to any reporting bot, simply click the **text link** with their name in it

- This will invoke the `inventorygive` command using `^inventorygive byname botname`

- All rules governing use of the bot command `inventorygive` apply

- You may also use the **optional** argument `^itemuse empty` to have bots only report empty inventory slots that can use it

## 12/8/2019¶

#### Uleat¶

### New Bot Command Option `^follow chain`¶

- This command will affect a chain follow effect, starting with the bot owner

- All spawned bots will be included in this follow order unless they have previously been issued a follow command

- The chain processing will skip all bots with the `manual_follow` flag set

- This flag may be removed by issuing a `^follow reset` on the affected bot or bots

- The flag is temporary and is reset upon camping or zoning

## 12/3/2019¶

#### Uleat¶

### New Bot Commands and Owner Option¶

- Added bot command `applypoison`

- This will apply item type `42` poisons (rogue-crafted) to an owner's targeted rogue bot's weapon

- Class and level restrictions are observed

- The application chance is the same as that for rogue players attempting to apply poison

- To apply, simply place the poison on your cursor and type `^applypoison`

- You will receive a success/fail message and the item will be consumed in both cases

- This effect remains active during the time in zone - just like a player's poison application

- Added rule `Bots:AllowApplyPoisonCommand` to allow the command to be **enabled** or **disabled** per server admin's needs (default is **true**)

- Added bot command `applypotion`

- This will apply item type `21` potions to any bot targeted by its owner

- Class, race and level restrictions are observed

- Potion-type rogue poisons must be applied using this command

- Casting time requirements are currently bypassed - expect a change in behavior at some point

- To apply, simply place the potion on your cursor and type `^applypotion`

- You will receive a success/fail message and the item will be consumed in both cases

- This effect is retained as a 'casted buff' and will remain until expired or removed

- Added rule `Bots:AllowApplyPotionCommand` to allow the command to be **enabled** or **disabled** per server admin's needs (default is **true**)

- Added rule `Bots:RestrictApplyPotionToRogue` to allow a restriction of `applypotion` to rogue-only potions (i.e., poisons) (default is **true**)

- Added bot owner option `buffcounter`

- When enabled, any bot buff with a counter will display a marquee message indicating how many 'hits' remain

Note: Bot owner option `deathmarquee` messages have been changed to `red` in color.

Notes:

In order to get potion effects to work properly after zoning or camping, I had to borrow code from the client connection handler.

It's unknown whether this code helps in the case of bots recasting buffs upon zoning and spawning..but, I did notice the lack of rebuffing in many cases - will watch!

#### Uleat¶

### Changed `Bots:AAExpansion` to `Bots:BotExpansionSettings`¶

- Changed this rule property from an enumerated value to a bitmask

- Renamed rule to coincide with the property change

- Works the same as `World:ExpansionSettings` in regards to active expansions (defaults to **16383** - same as the world rule)

- Added code to bot aa assignment to honor the per-expansion restrictions

- This rule may be expanded in the future to other bot-related systems

## 11/25/2019¶

#### Uleat¶

### New Command `#nudge`¶

- Added command `nudge` to facilitate npc placement and orientation

- Command accepts up to 4 arguments (**x**,**y**,**z**,**h**) and may use any combination, in any order

- Acceptable values are float-type for all parameters

- Values are interpreted as offsets and not absolute values

- Adjustments are 'set' by applying the command `#fixnpc`

- This command is ideally suited for macro (hotkey) use

- Real-time updates are broadcast to clients..but, there may be 'visible' glitches if you try to use the command too fast (limited by packet broadcast timer)

- Examples of use:

- `#nudge x=1.00 y=-1.00 z=3.45 h=-11.38`

- `#nudge x=2.33 z=-1.01`

- `#nudge h=133.00 z=-12.34`

## 11/18/2019¶

#### Uleat¶

### EVENT_COMBINE_VALIDATE¶

- Added the new event `EVENT_COMBINE_VALIDATE`

- This event is processed as the very last step in a tradeskill combine process just before the actual combine action

- Its use is automatic and criteria may be added to the `global_player` file for whichever scripting api that you are using

- The initial candidate for special validation is tradeskill recipe #10344 - "Clockwork Scout Module"

```
`function event_combine_validate(e)
 if (e.recipe_id == 10344) then
 if (e.validate_type:find("check_zone")) then
 if (e.zone_id ~= 289 and e.zone_id ~= 290) then
 return 1;
 end
 end
 end

 return 0;
end
`
```

- For this recipe, the combine is only allowed in two zones, `tipt` and `vxed`

- The active recipe id will always be passed by integer as the variable `recipe_id`

- In this case, the active `validation_type` of `check_zone`, the current zone id will be passed by integer as the variable `zone_id`

- From there, a simple check against valid zones can be made

- Invalid zones will return a non-zero value resulting in a failure to validate the combine..hence, cancelling it

- Valid zones will return a zero value and allow the combine to occur normally

- The validation types can be expanded

- This initial implementation is to alleviate a current bug

Note: This change requires a quest update to capture the new global player files, or the changes may be added manually.

#### Noudess¶

### Fix for client positions upon entering or exiting a boat¶

## 10/5/2019¶

#### Uleat¶

### Bot AI and Command Changes¶

- Added two new '**Owner Option**' features:
*

- `altcombat` - **enabled**, bots aggro based on owner's attack state; **disabled**, pet-like behavior

- `autodefend` - **enabled**, bots defend owner on aggro; **disabled**, no action taken

- Renamed bot command `^hold` to `^suspend` (same action and counter to `^release`)

- Repurposed bot command `^hold` to override all attack actions

- Reworked `^guard` to allow all 'normal' actions and for bots to return to their guard spots when idle

- Bot command `^attack` should now work as intended - with noted exceptions above

- Revamped bot command `^pull`:
*

- Pulling bot will travel to entity, gain aggro, then return to home position

- Aggro is attained through the use of the low-damage spell 'Throw Stone'

- Pulling candidacy is currently determined by a 4-tier ranking system

## 9/30/2019¶

**Akkadius**

### Login Server Changes¶

- Auto convert insecure world server admin passwords during the world authentication process

- Add CLI support for updating world admin account `world-admin:update --username=* --password=`*

## 9/19/2019¶

**Kinglykrab**

Fixed Maximum Status value in entity_list.QueueClientsStatus.

- Maximum Status of 250 was causing status levels 251 to 254 to be excluded from the queue.

## 9/17/2019¶

**Akkadius**

### Login Server Overhaul¶

Info

There's a few weeks of solid work wrapped in this update, you can review the changes in this pull request if you wish

#### Login Server Highlights¶

- Database schema includes all new tables, to migrate see migration reference below

- All new config file **JSON format** `login.json` found in `./loginserver/login_util/login.json`

- Now has an embedded **Web API** on port 6000 by default, details can be found at Loginserver API

- Now has a rich embedded **CLI interface**, details found at Login CLI Interface

- Now uses **Scrypt** for encryption which you can learn more about here

- Now automatically updates weak encryption methods during client login to the latest encryption method (Scrypt) in use on the fly

- Now properly supports string escaping in all database calls 

- **Now no longer requires you to specify a Local LAN subnet in the config to detect LAN world servers and LAN player connections**. The server now can intelligently detect RFC1918 local LAN subnets in the requests to properly mark both World Server connections and Player connections appropriately (Plug-N-Play)

- A **production and stage/testing** server of the **same long name / short** name pair can now live together as long as one world is registered

- Code is heavily cleaned up, many parts not perfect but far far improved

- Many many bug fixes, stability improvements

- Improvements made to **world -> loginserver** and **loginserver -> world** **reconnects** through **keep-alive**. If a world is disconnected it will properly picked up by world and vise versa. Which also allows the chance for the process to reconnect sooner because it knows it had a connection die instead of waiting for it to be told

- Improvements made to **world -> zone** and **zone -> world** disconnects through **keep-alive** for example on Linux if world had been killed, it would not gracefully reconnect to all zone processes and vise versa

### Migrating a Legacy Login Server¶

Info

To migrate your Legacy login server, follow this guide Migrating your Legacy Loginserver

## Log System Enhancements¶

- The popular C++ library FMT is now powering most of our logging FMT Library

- Migrated thousands of log calls to use now simplified log aliases, the most recent up to date list can be found here

https://github.com/EQEmu/Server/blob/master/common/eqemu_logsys_log_aliases.h

The main reason for these changes is that it simplifies the use of logging by developers, it also makes it far easier to create logging statements because we no longer need to look up printf codes to match variable types going into logging calls as our FMT library that we are using will detect the types at runtime

Using the category log aliases also heavily simplifies the amount of verbosity that goes into simply typing the log statements to begin with

We have *Detail* level aliases, but we are trying to keep from using detail in categorized logging, if you are using detail you probably either need to use another specialized category. The only time detail should ever really be used is if it is incredibly spammy to the rest of the logging in the same category

Old Logging StyleNew Logging StyleNew Log Aliases

```
`Log(Logs::General, Logs::ZoneServer, "Connecting to MySQL... ");
Log(Logs::General, Logs::Error, "Failed to connect to database: Error: %s", errbuf);
Log(Logs::Detail, Logs::Spells, "Bard song %d started: slot %d, target id %d", bardsong, bardsong_slot, bardsong_target_id);
Log(Logs::Detail, Logs::Combat, "Final damage after all reductions: %d", hit.damage_done);
`
```

```
`LogInfo("Connecting to MySQL... ");
LogError("Failed to connect to database: Error: {}", errbuf);
LogSpells("Bard song [{}] started: slot [{}], target id [{}]", bardsong, (int) bardsong_slot, bardsong_target_id);
LogCombat("Final damage after all reductions: [{}]", hit.damage_done);
`
```

```
`LogEmergency
LogAlert
LogCritical
LogError
LogWarning
LogNotice
LogInfo
LogDebug
LogAA
LogAADetail
LogAI
LogAIDetail
LogAggro
LogAggroDetail
LogAttack
LogAttackDetail
LogPacketClientServer
LogPacketClientServerDetail
LogCombat
LogCombatDetail
LogCommands
LogCommandsDetail
LogCrash
LogCrashDetail
LogDoors
LogDoorsDetail
LogGuilds
LogGuildsDetail
LogInventory
LogInventoryDetail
LogLauncher
LogLauncherDetail
LogNetcode
LogNetcodeDetail
LogNormal
LogNormalDetail
LogObject
LogObjectDetail
LogPathing
LogPathingDetail
LogQSServer
LogQSServerDetail
LogQuests
LogQuestsDetail
LogRules
LogRulesDetail
LogSkills
LogSkillsDetail
LogSpawns
LogSpawnsDetail
LogSpells
LogSpellsDetail
LogTCPConnection
LogTCPConnectionDetail
LogTasks
LogTasksDetail
LogTradeskills
LogTradeskillsDetail
LogTrading
LogTradingDetail
LogTribute
LogTributeDetail
LogMySQLError
LogMySQLErrorDetail
LogMySQLQuery
LogMySQLQueryDetail
LogMercenaries
LogMercenariesDetail
LogQuestDebug
LogQuestDebugDetail
LogLoginserver
LogLoginserverDetail
LogClientLogin
LogClientLoginDetail
LogHeadlessClient
LogHeadlessClientDetail
LogHPUpdate
LogHPUpdateDetail
LogFixZ
LogFixZDetail
LogFood
LogFoodDetail
LogTraps
LogTrapsDetail
LogNPCRoamBox
LogNPCRoamBoxDetail
LogNPCScaling
LogNPCScalingDetail
LogMobAppearance
LogMobAppearanceDetail
LogStatus
LogStatusDetail
`
```

### RFC5424 Log Categories¶

RFC5424 Log Categories have been introduced, they are meant to simplify the use of common logging scenarios that don't require specific categories

```
`LogEmergency
LogAlert
LogCritical
LogError
LogWarning
LogNotice
LogInfo
LogDebug
`
```

When using any of these macros, logging output will append the process name before the message itself, thus deprecating process specific categories

#### Example¶

```
`[WorldServer] [Info] Purging expired data buckets
[WorldServer] [Info] Loading zones
[WorldServer] [Info] Clearing groups
[WorldServer] [Info] Clearing raids
[WorldServer] [Info] Clearing inventory snapshots
[WorldServer] [Info] Loading items
[WorldServer] [Info] Loading skill caps
[WorldServer] [Info] Loading guilds
[LoginServer] [Warning] Remote address was null, defaulting to stream address 127.0.0.1
`
```

## 9/4/2019¶

**Uleat**

Added code to restore rule notes to their original values

## 9/2/2019¶

**Uleat**

Added code to inject new rules into the 'default' ruleset and remove orphaned rules from all rulesets

- New rules are only added using the 'default' ruleset - Other rulesets will need to be added manually or through in-game updates

- Rule notes are now loaded into the system's hard-coded entries and will now propagate properly into database updates

- Defunct rules will have their orphaned entries removed from the 'rule_values' table for the all rulesets

## 8/30/2019¶

**Uleat**

Added code to inject new commands and remove orphaned commands from both command systems

- New commands are added with their status ('access') set to the server default value - no aliases are defined

- Defunct commands will have their orhpaned entries removed from the command settings table for each system

## 8/16/2019¶

**Akkadius**

### Simplified Roambox Usage and Improve Roambox AI¶

### New Roambox GM Commands¶

- Implemented command #roambox set [move_delay]

- Implemented command #roambox remove

### New Roambox Quest API Calls¶

```
`$npc->SetSimpleRoamBox(box_size, [move_distance], [move_delay]);
`
```

```
`NPC:SetSimpleRoamBox(box_size, [move_distance], [move_delay]);
`
```

### New GM Commands!¶

- Spawngroup data now hot reloads on #repop

- Command #npceditmass now lists column options when one isn't properly specified

- Implemented command #spawneditmass [search] [option] with options [respawn_time] currently implemented

## 8/11/2019¶

**Akkadius**

### Bulk Editing GM Commands! #npceditmass¶

Added bulk edit command `#npceditmass [column-to-search] [column-search-value] [change-column] [change-value]`

### #findzone Enhancements!¶

- Modified #findzone to include clickable saylinks to both regular zone (if able) and private gmzone instances

- Added command #findzone [expansion-number] expansion to show zones via expansion

## 8/6/2019¶

**Akkadius** Optimizations to movement updates to eliminate ghosting possibilities in larger zones

## 7/22/2019¶

**Uleat**

### Windows Build Work¶

Added script \vcxproj_dependencies.py a script to help determine conflicting project dependencies (alpha-stage)

## 7/10/2019¶

**Akkadius**

### NPC Flymode Changes - Commands and DB Changes¶

- Add #npcedit flymode [0 = ground, 1 = flying, 2 = levitate, 3 = water, 4 = floating]

- Added "flymode" to npc_types database table

## 7/3/2019¶

**Akkadius/KLS**

### **Packet Compress, CPU, Position Update Optimizations**¶

- Optimizations to packet updates introduced back into the source post network code overhaul

- Optimizations made to position update packets by sending updates far less frequently when not in line with zone:max_movement_update_range

- Optimizations made to position updates in respect to the much higher resolution of navmesh path finding that we were using. We have cut down on the resolution of path finding / updating so that we reduce the CPU overhead of path*finding and subsequent client update packets that get generated this action

- Optimization made by adjusting ZLIB compression rate that was accidentally set to a compression level of 4 a long time ago

### Added #netstats Command¶

- Added #netstats admin command to troubleshoot connection issues in detail

### Zone Process now Has an Embedded Websocket Server¶

Websocket server is now available in zone and is bound to the same UDP port that the zoneserver listens on

- Currently implemented websocket API calls at the zone level

- get_packet_statistics

- get_opcode_list

- get_npc_list_detail

- get_door_list_detail

- get_corpse_list_detail

- get_object_list_detail

- get_mob_list_detail

- get_client_list_detail

- get_zone_attributes

- get_logsys_categories

- set_logging_level

Example of a Typescript client: https://gist.github.com/Akkadius/52d12d0379f36cf81c51b3b7da13db37

- Library Changes

### EQEmu Server Build Changes - Using Submodules¶

- 

We now use git submodules for libraries / dependencies versus manually downloading to the dependencies folder and/or storing

said dependencies within our codebase itself
* To update dependencies (Required for compiling)
 * `git submodule init`
 * `git submodule update`
* Libraries now in submodules
 * [glm] https://github.com/g-truc/glm.git
 * [flm] https://github.com/fmtlib/fmt.git
 * [libuv] https://github.com/libuv/libuv.git
 * [cereal] https://github.com/USCiLab/cereal.git
 * [websocketpp] https://github.com/zaphoyd/websocketpp.git
 * [recastnavigation] https://github.com/EQEmu/recastnavigation.git

## 6/24/2019¶

**Uleat**

### Reworked BotDatabase Into a Functional Add-On for ZoneDatabase¶

- Eliminated the database connection associated with class BotDatabase

- All behaviors remain the same with the exception of the calling object

- To invoke a BotDatabase function, use `database.botdb` rather than `botdb`

## 3/1/2019¶

**Noudess**

### Major Faction Conversion to Use Real Client Data¶

Pull request #802 New min/max personal faction per faction. Use of actual client mods for race/class/deity.

This PR involves major changes to your database and server operators quests

The clients recently exposed raw data included

- Min/Max personal faction for each faction

- Actual faction id the client uses for each faction

- Actual mods that come into play when a PC cons an opponent that determine your overall con to that faction

#### Approach¶

The approach I took resulted in minimal change to the code base. I did alter the code to enforce the new validated min/max from the client. This min/max applies to personally earned faction. So if a faction has a min of 0 and a max of 2000, that means your personally earned value can never go below 0 or over 2000. The actual con, will, however often do so because of class/race/deity modifications. I also changed the con ranges, per Mackal's data that was proven to be accurate

| 

Faction 
| Value 

| Ally 
| 1100+ 

| Warmly 
| 750 to 1099 

| Kindly 
| 500 to 749 

| Amiable 
| 100 to 499 

| Indifferent 
| 0 to 99 

| Apprehensive 
| -1 to -100 

| Dubious 
| -101 to -500 

| Threateningly 
| -501 to -750 

| Ready to Attack 
| -751 

The above means that dubious is a much **smaller** range now. For that reason the scripts modify any custom faction base values to put them in the same range, hopefully as the creators of the **custom factions** intended.

Also to be noted as characters that have a faction between **-501 and -700 wont be dubious anymore**, they will be **threateningly**. This is expected with the new ranges, but might take players by surprise as the old ranges we used were more liberal but were incorrect.

The database is changed extensively, but really only content. We're translating `faction_list` to use the clients ids. As such every place a faction_is is used, namely (see below) are being converted

- **faction_list**

- **faction_list_mod**

- **npc_faction** (primary_faction field only)

- **npc_faction_entries** (faction_id field only)

- **faction_values**

Quests will also automatically be adjusted. This MUST be done after the PR sql and before starting the server. This is automated by **eqemu_server.pl** (or starting world)

Be assured, custom factions that you may have created, or obsolete or duplicate factions in our original faction_list, that you may have used, will be preserved. Anything that does not map directly is being moved to the 5000 range in faction_list and any references are corrected to point there.

A great example of this is **Ebon Mask** and **Hall of the Ebon Mask**. Many PEQ DB style servers have both of these. Some have used one, some the other. We map **Ebon Mask** to the clients Ebon mask and the Hall of the **Ebon Mask** gets moved to the **5000** range, and all its references are preserved. However, if you would like to make proper use of client mobs to Ebon mask, or other factions that have duplicitous entries, I recommend you manually move to using the correct one. In that way all of the new raw data mapped in from the client into **faction_list_mod** will get used instead of what your db had before these values were known.

In my experience converting 4 different server's data, there are only about 20 factions moved into the 5000 range.

This PR has only 1 new, permanent table **faction_base_data**, which is taken right from the client. The base field is left in case you want to mod your server, but we are very sure that the client doesn't use a base. It uses global mods to race or class for this as you'll see in the new **faction_list_mod**

The PR makes many backup tables, and two mapping tables that are used during the conversion process to fix quests. This table was hand created by analysis. This table serves no purpose after conversion except an audit trail if we see any issues.

I will release a new PR that will clean up all these backups and temporary tables in about a month.

## 2/7/2019¶

**Uleat**

### Merc and Bots Now Use the Same Stance Standard¶

- Both classes will now use the same stance standard

- Pushed stance types up to EQEmu::constants

## 2/4/2019¶

**Uleat**

### Added GM-Command "profanity"¶

- This is a server-based tool for redacting any language that an admin deems as profanity (socially unacceptable within their community)

- Five options are available under this command

- `list` __ shows the current list of banned words

- `clears` the current list of banned words

- `add` adds to the banned word list

- `del` deletes from the banned word list

- `reload` forces a reload of the banned word list

- All actions are immediate and a world broadcast refreshes other active zones

- The system is in stand-by when the list is empty..just add a word to the list to begin censorship

- Redaction only occurs on genuine occurrences of any banned word

- Banned words are replaced with a series of '' characters

- Compounded words are ignored to avoid issues with allowed words containing a banned substring

- If 'test' is banned, 'testing' will not be banned .. it must be added separately

- Extreme care should be exercised when adding words to the banned list

- Quest failures and limited social interactions may alienate players if they become inhibiting

- System commands are allowed to be processed before redaction occurs in the 'say' channel

- A longer list requires more clock cycles to process - so, try to keep them to the most offensible occurrences

- Fix for bots ceasing combat when their 'follow me' mob dies

- Bots will revert to their client leash owner (bot owner or client group leader) when their FollowID() mob is no longer valid

- Combat will no longer be interrupted in these cases

- Does not apply to bot owner death

## 1/26/2019¶

**Uleat**

### Fix for class Bot not honoring NPCType data reference¶

- Fixes bots not moving on spawn/grouping issue

- Report any issues with non movement-related behavior

## 1/24/2019¶

**Uleat**

### Extended Server SpellBook Entries to RoF2 Standard...¶

...and added per-client restriction of spell id max

- Bumped server spellbook entry capacity to 720 spells

- Server keeps all 'learned' spells as found

- Access is limited by the clients' limitations of spellbook capacities and max spell ids

- This is done to avoid losing spells by switching from newer clients to older ones

- Existing behavior is kept in place for illegal access conditions

- Each client is still restricted to its spellbook capacity (400, 480, 480, 720, 720, 720 - respectively)

- Each client is restricted to its max supported spell id (9999, 15999, 23000, 28000, 45000, 45000 respectively)

- Please report any abnormal behavior so it may be addressed

- Removed server-side checksum of player profile..wasted calculation since it's performed again in all translators

## 1/20/2019¶

**Uleat**

### Added "spells" Entry to EQDictionary¶

**Akkadius**

### **Extended GM-Command #goto, New #who, #gmzone Commands**¶

- [Command] Extended #goto via #goto [playername]

- This will work cross zone, cross instance, in zone etc.

- It works on top of the original #goto (target) and #goto x y z

- [Command] Implemented server side #who

- Searches can be filtered by

Account Name

- Base Class Name

- Guild Name

- IP

- Player Name

- Race Name

- Zone Short Name

- 

Features a clickable (Goto) saylink that will bring you directly to a player regardless of

whether or not they are in an instance
* [Command] Implemented: #gmzone [zone_short_name] [zone_version=0] [identifier=gmzone]
 * Zones to a private GM instance

### Fixes to NPC's Ghosting at Zone Entrances¶

Fix issue where NPC's clip into the world and the client interprets them at coordinates _**_0,0,0

This issue would show itself when NPC's would bunch up by a zone-in

## 1/15/2019¶

**Uleat**

### Activated Per-Expansion Support for Active Inventory Slot Addressing¶

- Server honors expansions that alter bank size and power source, general9 and general10 slots

- Server honors gm flag behaviors for the active inventory slots of each client

## 1/11/2019¶

**Uleat**

### Modified Rules System to Ignore All Runtime Modifications...¶

of 'World:ExpansionSettings' and 'World:UseClientBasedExpansionSettings' fields.

- These fields are no longer allowed to be changed during server runtime through the command system

- Major synchronization issues between server and clients result when these fields are altered in-game

- It is not recommended to update these fields via sql queries while the server is in operation

- Failure to observe these warnings will result in abhorant behavior and loss of items

- Modify these fields during server operation at your own risk!

## ¼/2019¶

**Akkadius**

Global base scaling data has been updated in new database binary revision

## 1/1/2019¶

**Akkadius**

### New DevTool Commands, Categories, Logging and Scaling¶

- Logging: Added new logging category `MobAppearance`

- **DevTools** Proximity show of NPC now shows a "Path finding" circle around the proximity nodes to more clearly display

- **Scaling** Global base scaling data now refreshes from the database on #repop

- **Commands** Implemented command #killallnpcs [npc_name] for testing, leave blank for all attackable NPC's

### NPC and Player Textures¶

- Textures that have been changed with #wearchange / #wc or any wearchange quest script call will now stick for new clients entering a zone

- Weapon models for NPCs changed using wearchange will stick as well during combat and when new clients enter the zone

- The above changes allow for customization of a zone and NPC's without needing static data configured on npc_types table data and allows for much more customization options

### Implemented Ornamentation Quest API Calls¶

PerlLua

```
`$client->SetPrimaryWeaponOrnamentation(uint32 model_id);
$client->SetSecondaryWeaponOrnamentation(uint32 model_id);
`
```

```
`client:SetPrimaryWeaponOrnamentation(uint32 model_id);
client:SetSecondaryWeaponOrnamentation(uint32 model_id);
`
```

Both of these API calls persist an ornamentation to the weapon in the inventory table and will load both in character select and cross zone

---

## 2020

*Source: changelog/server/2020/index.html*

# 2020¶

## 12/30/2020¶

#### hg¶

### DZ / Expedition System¶

The expedition system enables the ability to create Dynamic Zone instances managed by the client's Expedition interface window. This system allows clients to add and remove members of a Dynamic Zone while providing built-in event lockout timer support.

The system is currently quest driven and provides quest APIs to create zone instances without the burden of manually tracking and validating lockout conflicts among characters. The system should have zero impact on servers that don't make use of it.

#### Summary of additions¶

- Added `Expeditions` and `DynamicZones` logging categories

- Added `Expedition` and `DynamicZone` rule categories

- Added database tables `expeditions`, `expedition_lockouts`, `expedition_members`, `character_expedition_lockouts`, and `dynamic_zones`

- Added `#dz` GM/developer command (minimum status 80)

- Added `#dzkickplayers` client command (minimum status 0)

- This performs the `/kickplayers exp` command for pre-RoF clients

- Added Lua and Perl expedition quest APIs

- Updated opcodes used for client expedition window and /dz commands

- Opcodes only updated for Titanium, SoD, Underfoot, and RoF2 clients (SoF and RoF1 clients may be missing functionality)

For more details and quest API usage see the Expedition System documentation.

## 9/19/2020¶

**Noudess**

**Fixed bugged pet buttons (sit and taunt)**

The pet window sit button **was** often out of sync. Also pet's were frequently still marked as sitting internal to the server due to the owner being attacked, or other issues.

A pet on guard will always return to guard after a battle. A pet sitting, will switch to follow mode after a battle. Pet HP sitting regen bonus will now only happen when the pet is actually ooc and sitting.

After hearing from @Trust that the taunt button was also out of sync often, I looked into that as well.

The client stores the status of an active pet's taunt setting. This is stored across sessions. The old approach was to try and force taunt on, on pet creation as well as logging on and zoning. Client messages, sometimes in response to out attempts, would end up toggling our taunt value away from what we just set it to.

Taunt now behaves as follows:

**Clients previous to UF**

Only client on/off clicks change state. Default is taunt on. Zoning and logging on both default to true.

UF+ Clients:

**On 1st time pet summoning via spell:**

The pet is created with taunting off. This matches the client.

**On logging in with an existing pet:**

The client sends a message if the pet was taunting when you logged off, which will turn it on, since pet creation now defaults to taunting=false in the constructor.

**On zoning:**

The pet's state is set from it's saved value in the database. The client is not involved, but will match as pet state is preserved by the client across zoning.

**On suspend minion:**

The pet's state is set from it's saved value in the database. The client is not involved, but will match as pet state is preserved by the client across zoning.

## 8/16/2020¶

**Noudess**

**Added new quest api to lua and perl to allow quests to enable/disable mob processing in empty zones.**

This topic in general deserves some discussion. In empty zones, mob processing typically does not take place, but quest timers do fire. Over the past year I have added multiple enhancements to this, and this is the latest of those enhancements.

Calling the quest::processmobswhilezoneempty(1/0) or lua counterpart eq.process_mobs_while_zone_empty(true**/**false) from a quest file enables or disables normal processing of mobs (movement, aggro, etc) in a zone, even when that zone is empty. Without these calls, a quest that say, happens once an hour and involves mobs spawning, moving and attacking (each other) would operate correctly in an empty zone.

In the **past** few months I added these other enhancements along the same line:

**A rule that allows mob processing to continue for a set # of seconds after the zone goes empty. This allows mobs that chased someone to a zone line for example, to move back rather than just standing at the zone line.**

RULE_INT(Zone, SecondsBeforeIdle, 60, "Seconds before IDLE_WHEN_EMPTY define kicks in")

**Allowing grid types 4 and 6 to always process, even when zone is empty.**

This change allows mobs like Fippy that spawn and run a fixed grid and despawn to complete their run on time, rather than always running the second someone enters a zone that was empty. This could be used for boats on servers, if they are placed on one of these types of grids.

This is the current logic that dictates mob processing. So mob processing occurs if the flag process_mobs_while_empty is set (this is the new quest api I just added), there are clients in the zone, the mob is on a grid that despawns at the end, or the zone is settling after all clients have left (my rule I added above).

```
`if (zone->process_mobs_while_empty || numclients > 0 ||
 mob->GetWanderType() == 4 || mob->GetWanderType() == 6 ||
 mob_settle_timer->Enabled())
`
```

## 8/16/2020¶

**Akkadius**

### **Virtual Zone Points (ZoneLines)**¶

This PR adds support for virtual zone points ********

Because the zone points that are sent to the client use an internal index lookup, it does not really give us power over determining or creating zone points in some cases. While this works in most of the data we've collected, there are scenarios where we'd like to create zone points entirely server side

We've added 3 new fields to the `zone_points` table `is_virtual` `width` `height`

When a zone point is virtual it follows different rules, a box is created using the x, y, z with the width and the height into consideration

New command **#showzonepoints** will list all of the zone points in a zone whether they are client side driven or virtual. It will also show a physical representation of the zone points in game

### Enhanced DevTools Menu¶

DevTools menu now displays whenever a GM enters a zone, it also has many more tools available

## 8/15/2020¶

**Akkadius**

### Loot Drop Filtering Adjustments¶

https://github.com/EQEmu/Server/pull/1105

- Add new logging category "Loot"

- Adds fields `npc_min_level` and `npc_max_level` to `lootdrop_entries` which runs checks against the current NPC as long as the field values are non-zero

- Fields `minlevel` and `maxlevel` are renamed to `trivial_min_level` and `trivial_max_level` respectively for `lootdrop_entries` for item drops to be filtered based on the player level

- Before, `trivial_max_level` defaulted to `127` in the database, this became an issue on some servers and some scenarios, the default has been adjusted to simply be 0 and only check if the value is non-zero

## 7/30/2020¶

**Akkadius**

This PR / changelog covers many things; it would be preferred to not have a PR this large ever but considering the sweeping changes, it needed very careful testing, coordination and rollout

| 

Component 
| Reference 

| **Expansions Support / Content Filtering** 
| expansion-content-filtering 

| **Multi Tenancy** 
| multi-tenancy 

| **Repository Pattern (Developer Tool)** 
| repositories 

Info

**This PR has been running on PEQ for over 3 months stable**

Info

**PEQ Editor Accompanying Branch (JJ)** https://github.com/ProjectEQ/peqphpeditor/compare/min-max-expansions

### General¶

- Add `Merchants` and `ZonePoints` logging categories

- Add fix for object display issues on RoF2 where objects would float, we are using GroundZ to correct these. Previous clients auto corrected objects and snapped them to the ground level, newer clients do not do this

- Added `WorldContentService` which has the responsibility of setting / getting content context for the server, expansions, flags etc.

- Added an optional second database connection to the config "content_database" that will use a separate database connection for queries that target content tables. If none is specified it falls back to the default connection pointer

- Added connection labels to MySQL connect messages

- Added magical global helper methods `ZoneID(string short_name)` `ZoneName(zone_id)` `ZoneLongName(zone_id)` which are all pre-loaded in memory to be used at the zone or world level for common needs

- Added official single source of truth in `database_schema.h` which defines different table types `player`, `content`, `server`, `state`, `queryserv`, `login`, `version`

- Fix issues with world CLI interface returning exit code 1 (error) versus exit code 0 (success)

- Saylinks are added to `#fi` command for summoning items

### Performance Improvements¶

- Task goallists now bulk load

- Spawns prefer bulk loading

- Improvements to grid loading logic (bulk load)

### New Commands¶

- Added in-command `#gearup` - which takes in tooling data to automatically gear a GM test toon with expansion specific best-in-class gear

- Added in-game command `#copycharacter [source_char_name] [dest_char_name] [dest_account_name]`

- `Added console CLI command via world character:copy-character`

### Quests¶

New methods available to support expansion & content filtering

PerlLua

```
`quest::is_content_flag_enabled(string flag_name)
quest::set_content_flag(string flag_name, bool enabled)

quest::is_classic_enabled()
quest::is_the_ruins_of_kunark_enabled()
quest::is_the_scars_of_velious_enabled()
quest::is_the_shadows_of_luclin_enabled()
quest::is_the_planes_of_power_enabled()
quest::is_the_legacy_of_ykesha_enabled()
quest::is_lost_dungeons_of_norrath_enabled()
quest::is_gates_of_discord_enabled()
quest::is_omens_of_war_enabled()
quest::is_dragons_of_norrath_enabled()
quest::is_depths_of_darkhollow_enabled()
quest::is_prophecy_of_ro_enabled()
quest::is_the_serpents_spine_enabled()
quest::is_the_buried_sea_enabled()
quest::is_secrets_of_faydwer_enabled()
quest::is_seeds_of_destruction_enabled()
quest::is_underfoot_enabled()
quest::is_house_of_thule_enabled()
quest::is_veil_of_alaris_enabled()
quest::is_rain_of_fear_enabled()
quest::is_call_of_the_forsaken_enabled()
quest::is_the_darkend_sea_enabled()
quest::is_the_broken_mirror_enabled()
quest::is_empires_of_kunark_enabled()
quest::is_ring_of_scale_enabled()
quest::is_the_burning_lands_enabled()
quest::is_torment_of_velious_enabled()
quest::is_current_expansion_classic()
quest::is_current_expansion_the_ruins_of_kunark()
quest::is_current_expansion_the_scars_of_velious()
quest::is_current_expansion_the_shadows_of_luclin()
quest::is_current_expansion_the_planes_of_power()
quest::is_current_expansion_the_legacy_of_ykesha()
quest::is_current_expansion_lost_dungeons_of_norrath()
quest::is_current_expansion_gates_of_discord()
quest::is_current_expansion_omens_of_war()
quest::is_current_expansion_dragons_of_norrath()
quest::is_current_expansion_depths_of_darkhollow()
quest::is_current_expansion_prophecy_of_ro()
quest::is_current_expansion_the_serpents_spine()
quest::is_current_expansion_the_buried_sea()
quest::is_current_expansion_secrets_of_faydwer()
quest::is_current_expansion_seeds_of_destruction()
quest::is_current_expansion_underfoot()
quest::is_current_expansion_house_of_thule()
quest::is_current_expansion_veil_of_alaris()
quest::is_current_expansion_rain_of_fear()
quest::is_current_expansion_call_of_the_forsaken()
quest::is_current_expansion_the_darkend_sea()
quest::is_current_expansion_the_broken_mirror()
quest::is_current_expansion_empires_of_kunark()
quest::is_current_expansion_ring_of_scale()
quest::is_current_expansion_the_burning_lands()
quest::is_current_expansion_torment_of_velious()
`
```

```
`eq.is_content_flag_enabled(string flag_name)
eq.set_content_flag(string flag_name, bool enabled)

eq.is_classic_enabled()
eq.is_the_ruins_of_kunark_enabled()
eq.is_the_scars_of_velious_enabled()
eq.is_the_shadows_of_luclin_enabled()
eq.is_the_planes_of_power_enabled()
eq.is_the_legacy_of_ykesha_enabled()
eq.is_lost_dungeons_of_norrath_enabled()
eq.is_gates_of_discord_enabled()
eq.is_omens_of_war_enabled()
eq.is_dragons_of_norrath_enabled()
eq.is_depths_of_darkhollow_enabled()
eq.is_prophecy_of_ro_enabled()
eq.is_the_serpents_spine_enabled()
eq.is_the_buried_sea_enabled()
eq.is_secrets_of_faydwer_enabled()
eq.is_seeds_of_destruction_enabled()
eq.is_underfoot_enabled()
eq.is_house_of_thule_enabled()
eq.is_veil_of_alaris_enabled()
eq.is_rain_of_fear_enabled()
eq.is_call_of_the_forsaken_enabled()
eq.is_the_darkend_sea_enabled()
eq.is_the_broken_mirror_enabled()
eq.is_empires_of_kunark_enabled()
eq.is_ring_of_scale_enabled()
eq.is_the_burning_lands_enabled()
eq.is_torment_of_velious_enabled()
eq.is_current_expansion_classic()
eq.is_current_expansion_the_ruins_of_kunark()
eq.is_current_expansion_the_scars_of_velious()
eq.is_current_expansion_the_shadows_of_luclin()
eq.is_current_expansion_the_planes_of_power()
eq.is_current_expansion_the_legacy_of_ykesha()
eq.is_current_expansion_lost_dungeons_of_norrath()
eq.is_current_expansion_gates_of_discord()
eq.is_current_expansion_omens_of_war()
eq.is_current_expansion_dragons_of_norrath()
eq.is_current_expansion_depths_of_darkhollow()
eq.is_current_expansion_prophecy_of_ro()
eq.is_current_expansion_the_serpents_spine()
eq.is_current_expansion_the_buried_sea()
eq.is_current_expansion_secrets_of_faydwer()
eq.is_current_expansion_seeds_of_destruction()
eq.is_current_expansion_underfoot()
eq.is_current_expansion_house_of_thule()
eq.is_current_expansion_veil_of_alaris()
eq.is_current_expansion_rain_of_fear()
eq.is_current_expansion_call_of_the_forsaken()
eq.is_current_expansion_the_darkend_sea()
eq.is_current_expansion_the_broken_mirror()
eq.is_current_expansion_empires_of_kunark()
eq.is_current_expansion_ring_of_scale()
eq.is_current_expansion_the_burning_lands()
eq.is_current_expansion_torment_of_velious()
`
```

### Repositories¶

**Highlights**

- Heavily reducing the mental overhead of having to interact with the database at the programmatic level

- It creates an object representation of our tables (persistence layer) with a 1:1 mapping with what is in the source by having row values stored in a struct (Data Transfer Object)

- We reduce manual overhead by having code generation generate our database table representations

- Ease of maintenance; whenever we make schema changes, rerunning the repository updates fields and subsequent methods keeping code changes minimal 

**Methods Implemented**

- Single insertion covered by `InsertOne`

- Single update covered by `UpdateOne`

- Single delete covered by `DeleteOne`

- Single select covered by `FindOne`

- Bulk selection method via filtered `GetWhere(std::string where_filter)`

- Bulk deletion method via filtered `DeleteWhere(std::string where_filter)`

- Bulk insertion methods handled automatically via `InsertMany`

- Select all covered by `All`

**Code Generation**

This is a result of the repository generator located at

```
`./utils/scripts/generators/repository-generator.pl

# Help
perl ~/code/utils/scripts/generators/repository-generator.pl [server-location] [table_name|all]

# Example
perl ~/code/utils/scripts/generators/repository-generator.pl ~/server/ all
`
```

**Example Use (How do I use this?)**

Starting at line 358 in the following Gist is an example CLI command that uses all of the above methods as examples; above line 358 is an example of what the a repository can look like

https://gist.github.com/Akkadius/e341974521692000aa1eeaa2b6dcb091#file-gistfile1-cpp-L358

## 7/7/2020¶

**Kinglykrab**

**Add hot reload saylinks.**

**Completely overhauled cross zone and world wide methods in quest API.**

PerlLua

```
`quest::crosszonecastspellbycharid(character_id, spell_id);
quest::crosszonecastspellbygroupid(group_id, spell_id);
quest::crosszonecastspellbyraidid(raid_id, spell_id);
quest::crosszonecastspellbyguildid(guild_id, spell_id);
quest::crosszonedisabletaskbycharid(character_id, task_id);
quest::crosszonedisabletaskbygroupid(group_id, task_id);
quest::crosszonedisabletaskbyraidid(raid_id, task_id);
quest::crosszonedisabletaskbyguildid(guild_id, task_id);
quest::crosszoneenabletaskbycharid(character_id, task_id);
quest::crosszoneenabletaskbygroupid(group_id, task_id);
quest::crosszoneenabletaskbyraidid(raid_id, task_id);
quest::crosszoneenabletaskbyguildid(guild_id, task_id);
quest::crosszonefailtaskbycharid(character_id, task_id);
quest::crosszonefailtaskbygroupid(group_id, task_id);
quest::crosszonefailtaskbyraidid(raid_id, task_id);
quest::crosszonefailtaskbyguildid(guild_id, task_id);
quest::crosszonemoveinstancebycharid(character_id, instance_id);
quest::crosszonemoveinstancebygroupid(group_id, instance_id);
quest::crosszonemoveinstancebyraidid(raid_id, instance_id);
quest::crosszonemoveinstancebyguildid(guild_id, instance_id);
quest::crosszoneremovespellbycharid(character_id, spell_id);
quest::crosszoneremovespellbygroupid(group_id, spell_id);
quest::crosszoneremovespellbyraidid(raid_id, spell_id);
quest::crosszoneremovespellbyguildid(guild_id, spell_id);
quest::crosszoneresetactivitybycharid(character_id, task_id, activity_id);
quest::crosszoneresetactivitybygroupid(group_id, task_id, activity_id);
quest::crosszoneresetactivitybyraidid(raid_id, task_id, activity_id);
quest::crosszoneresetactivitybyguildid(guild_id, task_id, activity_id);
quest::crosszoneupdateactivitybycharid(character_id, task_id, activity_id, activity_count);
quest::crosszoneupdateactivitybygroupid(group_id, task_id, activity_id, activity_count);
quest::crosszoneupdateactivitybyraidid(raid_id, task_id, activity_id, activity_count);
quest::crosszoneupdateactivitybyguildid(guild_id, task_id, activity_id, activity_count);
quest::worldwideassigntask(task_id, enforce_level_requirement, min_status, max_status);
quest::worldwidecastspell(spell_id, min_status, max_status);
quest::worldwidedisabletask(task_id, min_status, max_status);
quest::worldwideenabletask(task_id, min_status, max_status);
quest::worldwidefailtask(task_id, min_status, max_status);
quest::worldwidemessage(type, message, min_status, max_status);
quest::worldwidemove(zone_short_name, min_status, max_status);
quest::worldwidemoveinstance(instance_id, min_status, max_status);
quest::worldwideremovespell(spell_id, min_status, max_status);
quest::worldwideremovetask(task_id, min_status, max_status);
quest::worldwideresetactivity(task_id, activity_id, min_status, max_status);
quest::worldwidesetentityvariableclient(variable_name, variable_value, min_status, max_status);
quest::worldwidesetentityvariablenpc(variable_name, variable_value);
quest::worldwidesignalclient(signal, min_status, max_status);
quest::worldwidesignalnpc(signal);
quest::worldwideupdateactivity(task_id, activity_id, activity_count, min_status, max_status);
`
```

```
`eq.cross_zone_cast_spell_by_char_id(character_id, spell_id);
eq.cross_zone_cast_spell_by_group_id(group_id, spell_id);
eq.cross_zone_cast_spell_by_raid_id(raid_id, spell_id);
eq.cross_zone_cast_spell_by_guild_id(guild_id, spell_id);
eq.cross_zone_disable_task_by_char_id(character_id, task_id);
eq.cross_zone_disable_task_by_group_id(group_id, task_id);
eq.cross_zone_disable_task_by_raid_id(raid_id, task_id);
eq.cross_zone_disable_task_by_guild_id(guild_id, task_id);
eq.cross_zone_enable_task_by_char_id(character_id, task_id);
eq.cross_zone_enable_task_by_group_id(group_id, task_id);
eq.cross_zone_enable_task_by_raid_id(raid_id, task_id);
eq.cross_zone_enable_task_by_guild_id(guild_id, task_id);
eq.cross_zone_fail_task_by_char_id(character_id, task_id);
eq.cross_zone_fail_task_by_group_id(group_id, task_id);
eq.cross_zone_fail_task_by_raid_id(raid_id, task_id);
eq.cross_zone_fail_task_by_guild_id(guild_id, task_id);
eq.cross_zone_move_instance_by_char_id(character_id, instance_id);
eq.cross_zone_move_instance_by_group_id(group_id, instance_id);
eq.cross_zone_move_instance_by_raid_id(raid_id, instance_id);
eq.cross_zone_move_instance_by_guild_id(guild_id, instance_id);
eq.cross_zone_remove_spell_by_char_id(character_id, spell_id);
eq.cross_zone_remove_spell_by_group_id(group_id, spell_id);
eq.cross_zone_remove_spell_by_raid_id(raid_id, spell_id);
eq.cross_zone_remove_spell_by_guild_id(guild_id, spell_id);
eq.cross_zone_reset_activity_by_char_id(character_id, task_id, activity_id);
eq.cross_zone_reset_activity_by_group_id(group_id, task_id, activity_id);
eq.cross_zone_reset_activity_by_raid_id(raid_id, task_id, activity_id);
eq.cross_zone_reset_activity_by_guild_id(guild_id, task_id, activity_id);
eq.cross_zone_update_activity_by_char_id(character_id, task_id, activity_id, activity_count);
eq.cross_zone_update_activity_by_group_id(group_id, task_id, activity_id, activity_count);
eq.cross_zone_update_activity_by_raid_id(raid_id, task_id, activity_id, activity_count);
eq.cross_zone_update_activity_by_guild_id(guild_id, task_id, activity_id, activity_count);
eq.world_wide_assign_task(task_id, enforce_level_requirement, min_status, max_status);
eq.world_wide_cast_spell(spell_id, min_status, max_status);
eq.world_wide_disable_task(task_id, min_status, max_status);
eq.world_wide_enable_task(task_id, min_status, max_status);
eq.world_wide_fail_task(task_id, min_status, max_status);
eq.world_wide_message(type, message, min_status, max_status);
eq.world_wide_move(zone_short_name, min_status, max_status);
eq.world_wide_move_instance(instance_id, min_status, max_status);
eq.world_wide_remove_spell(spell_id, min_status, max_status);
eq.world_wide_remove_task(task_id, min_status, max_status);
eq.world_wide_reset_activity(task_id, activity_id, min_status, max_status);
eq.world_wide_set_entity_variable_client(variable_name, variable_value, min_status, max_status);
eq.world_wide_set_entity_variable_npc(variable_name, variable_value);
eq.world_wide_signal_client(signal, min_status, max_status);
eq.world_wide_signal_npc(signal);
eq.world_wide_update_activity(task_id, activity_id, activity_count, min_status, max_status);
`
```

## 6/30/2020¶

**Kinglykrab**

**Add GetDisplayAC() to Perl/Lua.**

PerlLua

```
`$client->GetDisplayAC();
`
```

```
`client:GetDisplayAC();
`
```

**Add DyeArmorBySlot() to Perl/Lua.**

PerlLua

```
`$client->DyeArmorBySlot(slot, red, green, blue, [use_tint = 0x00]);
`
```

```
`client:DyeArmorBySlot(slot, red, green, blue, [use_tint = 0x00]);
`
```

**Add MoveZoneInstance methods to Perl/Lua.**

PerlLua

```
`$client->MoveZoneInstance(instance_id);
$client->MoveZoneInstanceGroup(instance_id);
$client->MoveZoneInstanceRaid(instance_id);
`
```

```
`client:MoveZoneInstance(instance_id);
client:MoveZoneInstanceGroup(instance_id);
client:MoveZoneInstanceRaid(instance_id);
`
```

**Add cross-zone player move utilities.**

PerlLua

```
`quest::crosszonemoveplayerbycharid(character_id, zone_short_name);
quest::crosszonemoveplayerbygroupid(group_id, zone_short_name);
quest::crosszonemoveplayerbyraidid(raid_id, zone_short_name);
quest::crosszonemoveplayerbyguildid(guild_id, zone_short_name);
`
```

```
`eq.crosszonemoveplayerbycharid(character_id, zone_short_name);
eq.crosszonemoveplayerbygroupid(group_id, zone_short_name);
eq.crosszonemoveplayerbyraidid(raid_id, zone_short_name);
eq.crosszonemoveplayerbyguildid(guild_id, zone_short_name);
`
```

## 6/28/2020¶

**Akkadius**

- Fixed an issue where when a client first enters a zone; an NPC may not be aware of their presence immediately

- Fixed a UCS issue where a crash or another UCS connection would delete connection pointers; this should keep UCS connected more reliably

- Lowered the rate in which animation packets are throttled to 500ms from 1000ms; this should keep faster animations from being gated from being sent

**Kinglykrab**

- Fix $npc->RecalculateSkills() in Perl.

#### Added Quest API MoveZone Methods¶

PerlLua

```
`$client->MoveZone(zone_short_name);
$client->MoveZoneGroup(zone_short_name);
$client->MoveZoneRaid(zone_short_name);
`
```

```
`client:MoveZone(zone_short_name);
client:MoveZoneGroup(zone_short_name);
client:MoveZoneRaid(zone_short_name);
`
```

#### Added Quest API CrossZone Task Methods¶

PerlLua

```
`quest::crosszoneassigntaskbycharid(character_id, task_id, enforce_level_requirement);
quest::crosszoneassigntaskbygroupid(group_id, task_id, enforce_level_requirement);
quest::crosszoneassigntaskbyraidid(raid_id, task_id, enforce_level_requirement);
quest::crosszoneassigntaskbyguildid(guild_id, task_id, enforce_level_requirement);
`
```

```
`eq.cross_zone_assign_task_by_char_id(character_id, task_id, enforce_level_requirement);
eq.cross_zone_assign_task_by_group_id(group_id, task_id, enforce_level_requirement);
eq.cross_zone_assign_task_by_raid_id(raid_id, task_id, enforce_level_requirement);
eq.cross_zone_assign_task_by_guild_id(guild_id, task_id, enforce_level_requirement);
`
```

#### Added Quest API Discipline Task Methods¶

PerlLua

```
`$client->GetDisciplineTimer(timer_id);
$client->ResetDisciplineTimer(timer_id);
`
```

```
`client:GetDisciplineTimer(timer_id);
client:ResetDisciplineTimer(timer_id);
`
```

## 6/23/2020¶

**Noudess**

Updated #grid show command to use alphabetic names so names display properly (numerics were getting stripped) and stacked the names of nodes that are in the same #loc.

Added code to make sure that mobs that call for help, complete that activity before starting to move toward target. As written (previously) a mob could be out of earshot of his neighbors because movement started immediately. It was a race condition that nearly always resulted in mobs within the attacked mobs assist radius not hearing the call.

**Kinglykrab**

Added command #findrace [name|id].

Added zone ID to #findzone.

Added eq.zone(short_name) to Lua.

Added eq.zone_group(short_name) to Lua.

Added eq.zone_raid(short_name) to Lua.

Added quest::zonegroup(short_name) to Perl.

Added quest::zoneraid(short_name) to Perl.

## 5/26/2020¶

**Noudess**

SQL to load correct mods into faction_list_mod for Drakkin and Guktan races as well as Agnostic deity mods. Only to be used on databases converted to using the client faction ids.SQL found in optional SQL area as: utils/sql/git/optional/drakkin_guktan_faction_data.sql

## 5/11/2020¶

**Kinglykrab**

### Added GetNPCBySpawnID() to Perl/Lua.¶

PerlLua

```
`$entity_list->GetNPCBySpawnID(spawn_id);
`
```

```
`eq.get_entity_list():GetNPCBySpawnID(spawn_id);
`
```

### Add several cross zone methods to Perl/Lua.¶

PerlLua

```
`quest::crosszonemessageplayerbygroupid(type, group_id, message);
quest::crosszonemessageplayerbyraidid(type, raid_id, message);
quest::crosszonemessageplayerbyguildid(type, guild_id, message);
quest::crosszonesignalclientbygroupid(group_id, value);
quest::crosszonesignalclientbyraidid(raid_id, value);
quest::crosszonesignalclientbyguildid(guild_id, value);
quest::crosszonesetentityvariablebygroupid(group_id, value);
quest::crosszonesetentityvariablebyraidid(raid_id, value);
quest::crosszonesetentityvariablebyguildid(guild_id, value);
`
```

```
`eq.cross_zone_message_player_by_group_id(type, group_id, message);
eq.cross_zone_message_player_by_raid_id(type, raid_id, message);
eq.cross_zone_message_player_by_guild_id(type, guild_id, message);
eq.cross_zone_signal_client_by_group_id(group_id, value);
eq.cross_zone_signal_client_by_raid_id(group_id, value);
eq.cross_zone_signal_client_by_guild_id(guild_id, value);
eq.cross_zone_set_entity_variable_by_group_id(group_id, value);
eq.cross_zone_set_entity_variable_by_raid_id(raid_id, value);
eq.cross_zone_set_entity_variable_by_guild_id(guild_id, value);
`
```

## 4/14/2020¶

**Akkadius**

### UCS / Raid / Zone Fixes¶

**Raid::GetRaidByClient**

On PEQ we noticed via zone with high CPU footprint spending tons of time in in function `Raid::GetRaidByClient` where we excessively loop through all raids in zone, all members in the raid to return back a simple raid pointer. Now, we cache the pointer lookup instead of running the entire loop constantly. For perspective, with 100 toons in a zone all in a raid, you will easily see 4k/s calls to this function which adds up on a CPU profile (nuts)

**CPU Profile** https://gist.github.com/Akkadius/a5c55654d4b729697964f938c824030f

**Call Measurement Example**

```
`eqemu@ce0931611614:~$ tail -f ~/server/logs/**/*.log | grep "returning cached raid" | pv -lr 2>&1 >/dev/null
[4.04k/s]
`
```

**UCS**

We also noticed UCS sucking up a lot of CPU with 1,500 players online

**CPU Profile** https://gist.github.com/Akkadius/14efe565caf468cc892293fd95cc0377

- Converted to a less aggressive loop frequency 31.25 FPS and converted to using UV library

- No longer load characters into UCS context that are soft deleted

- Fixed UCS bug where it would not reconnect properly after a crash / improper shutdown

- Fixed UCS bug where it was not registering a new connection properly, and sending a "Not Available" to all zones right after it is in fact "Available"

- Added Logging in zone that clearly says whether or not UCS is online or not

- Properly removing UCS connected clients even if the /q /ex connections resolving by sending keepalive packets #735 this prevents UCS from looping over ghosted clients making unnecessary database calls and sending improper connected client counts

- Removed tons of verbose LogInfo logging and replaced the calls for LogDebug as it was writing to disk excessively for mostly debugging related information

**Zone**

- We are now properly shutting down zone processes by killing the UV loop instead of doing a hard process exit, allowing the zone to shut everything else down gracefully

## 4/9/2020¶

**Akkadius**

### Implement SendToGuildHall and Improve Instance ID Cycling¶

Instead of purging immediately expired instances every 7.5 minutes, we will purge expired instances from the database table after they've been completely expired for an entire day every 7.5 minutes. The reason for this is that the code will still determine that an instance is expired when it needs to; but in order to not re-use the same instance ID not long after it had been freed while a zone is still online with the same instance ID, we're simply going to wait a grace period of 1 day to purge those entries as it will not harm anything

Client::SendToGuildHall() will send a client to a Guild Hall instance for 90 days based on a configurable rule. This will send the player to a Guild Hall instance regardless of whether they are in a Guild or not and it is up to the discretion of the server operator to check for guild id before making the call. If you are not guilded, you share an instance with other non-guilded players

We pull instance remaining time out of the database once on zone bootup because the timer class is returning the value in milliseconds which causes the values to overflow and improperly show remaining instance time for instances that are open for long period of time

Created new rule category `Instances`

```
`RULE_INT(Instances, ReservedInstances, 30, "Will reserve this many instance ids for globals... probably not a good idea to change this while a server is running")
RULE_BOOL(Instances, RecycleInstanceIds, true, "Will recycle free instance ids instead of gradually running out at 32k")
RULE_INT(Instances, GuildHallExpirationDays, 90, "Amount of days before a Guild Hall instance expires")
`
```

This exports Lua / Perl method `client->SendToGuildHall`

## ⅘/2020¶

**Kinglykrab**

- Added getcharidbyname(name) to Perl/Lua.

PerlLua

```
`quest::getcharidbyname(name);
`
```

```
`eq.get_char_id_by_name(name);
`
```

- Added getcharnamebyid(char_id) to Perl/Lua.

PerlLua

```
`quest::getcharnamebyid(char_id);
`
```

```
`eq.get_char_name_by_id(char_id);
`
```

## 3/31/2020¶

**Kinglykrab**

- Added getitemname(item_id) to Perl/Lua.

PerlLua

```
`quest::getitemname(item_id);
`
```

```
`eq.get_item_name(item_id);
`
```

- Added getspellname(spell_id) to Perl/Lua.

PerlLua

```
`quest::getspellname(spell_id);
`
```

```
`eq.get_spell_name(item_id);
`
```

- Added gettaskname(task_id) to Perl/Lua.

PerlLua

```
`quest::gettaskname(task_id);
`
```

```
`eq.get_task_name(task_id);
`
```

- Added CheckInstanceByCharID(instance_id, char_id) to Perl/Lua.

PerlLua

```
`quest::CheckInstanceByCharID(instance_id, char_id);
`
```

```
`eq.check_instance_by_char_id(instance_id, char_id);
`
```

## ⅗/2020¶

**Noudess**

- Added a new field (always_aggro_foes) to npc_types. If non-zero, the npc/mob will always aggro foes regardless of intelligence or level. This was so mobs such as the int casters in Befallen, who will agro their enemies regardless of level and I didn't want to have to reduce the _int field of INT caster NPCs to achieve the aggro.

## 3/2/2020¶

#### Uleat¶

### Monk Bot Changes¶

- Added a 'monk' class special attack timer to class NPC

- Monk bots will now use the ability `Tiger Claw` on a seperate timer from the other disciplines - resulting in an additional attack

- Bot usage of `Master Wu's Technique` now falls inline with current client behavior (rules and all)

- Added bot owner option `monkwumessage` to toggle a notification message to the bot's owner whenever `MWT` triggers (off by default .. use `^oo monkwumessage` to enable/disable)

**Special Note:**

By default, all classes process class attacks based on active timers. This involves checking attackability of target with every call - which is VERY expensive when done every server processing cycle since the timer is always 'ready.'

I added code to disable 'class' timers in classes that don't use them or are inactive because they don't have a skill. Class-based timers will not reactivate..but, skill-based ones will once a `CalcBotStats` call is made during the 'leveling' process. (If the skill is not available after leveling, the timer will disable itself again.)

Hopefully, this will help reduce bot cpu usage.

Please report any issues on our forums or in Discord - Thanks!

## 2/4/2020¶

#### hg¶

### **Auto Consent Implemented with Group / Raid / Guild Consent**¶

- Auto Consent client options are now supported. Toggling these options results in consenting (or denying) a player's current corpses.

- These options are now also saved and restored for characters.

- The /consent and /deny commands for group, raid, and guild are now implemented. These commands are not case sensitive.

- `/consent group` - adds current group id to all character corpses

- `/consent raid` - adds current raid id to all character corpses

- `/consent guild` - adds current guild id to all corpses and updates db

- `/deny group|raid|guild` - sets the consent type id to 0 on all corpses

- Consent and deny commands are throttled to once every two seconds

- When consenting a player by name, both the corpse owner and the player being consented receive a message for every (loaded) zone a corpse is in.

- Corpses now store the list of consented player names. Previously clients stored a list of players they could drag corpses for.

Guild consent is persistent. The `character_corpses` table has a new `guild_consent_id`column which is updated when a player issues a guild consent command. This means guild consented corpses may be dragged by guild members after a corpse is loaded (summoning the corpse to another zone or loading the corpse in a previously unloaded zone)

Group and raid consent are not persistent. Corpses will lose these consents when a corpse is summoned or if the corpse is loaded by a zone after consent was issued.

## 1/15/2020¶

#### Uleat¶

### Update to EVENT_COMMAND and EVENT_BOT_COMMAND¶

The handlers for EVENT_COMMAND and EVENT_BOT_COMMAND have been updated to allow a 'no change' behavior.

Script files using these event types will perform as before without the need to move the command scripting into them .. so long as there is no defined function for them.

Once a definition is given, the old method of using EVENT_SAY to handle them will no longer work and the new formatting must be applied.

If you have any questions, please direct them to our forums or the `#support-quest-scripts` channel in discord.

## 1/10/2020¶

**Akkadius**

### Character Soft Deletes¶

Unless new system rule **Character:SoftDeletes** (default: true) is disabled, characters will now no longer hard delete from all respective character tables and will only be marked as deleted via the newly created `deleted_at` column that can be found in the `character_data` table. This can make it far easier to recover accidentally deleted characters

## 1/7/2020¶

#### Uleat¶

### EVENT_COMMAND and EVENT_BOT_COMMAND¶

- EVENT_COMMAND now processes its own code and is no longer shared with EVENT_SAY

- EVENT_BOT_COMMAND was added..but, will have limited functionality until more of the Bot class is exposed in the scripting apis

- Both event types have new or updated entries on the Events page

- In the template scripts, just replace the example command data with your own

- Perl: `"command_name" => [<status_required>, "command_description"]`

- Lua: `["command_name"] = {<status_required>, "command_description"}`

- Anything in the `command_data` hash will be automatically parsed upon any `#help` call - to include partial matching criteria

- The same is true for `bot_command_data`

- These templates are not required for use..but, do provide a basic 'use' structure so that command coding is simplified and easier to implement

- Older 'say' command code may still work as-is..though, it has not been tested

---

## 2021

*Source: changelog/server/2021/index.html*

# 2021¶

## 11/25/2021¶

**Akkadius** [Hotfix] Crash fix that apparently didn't make it in another PR

**Akkadius** [Hotfix] Default PR #1758 to false

**Akkadius** [Hotfix] Line ending changes

**Akkadius** Revert "[BugFix] Charm Targeting and other issues. (#1655)"

**Akkadius** Revert "Shared task kill update fix"

**Akkadius** Shared task kill update fix

**Akkadius** [Charm] Push up fragments of Kayen's PR back up (#1659)

**Akkadius** [Commands] Fix Z on #spawnfix (#1647)

**Akkadius** [Dialogue Window / Saylinks] Missing Changes (#1574)

**Akkadius** [DiaWind] Tag Adjustments for title, button_one, button_two (#1610)

**Akkadius** [GM Command] Door Manipulation Command Port (#1524)

**Akkadius** [GM Commands] Split GM Commands Into Separate Files (#1766)

**Akkadius** [Hotfix] Fix freeze formatting for Quest API parsing (Spire) (#1547)

**Akkadius** [Hotfix] Gate some new shared task logic behind task rule (#1656)

**Akkadius** [HP Updates] Fix for Titanium clients not being updated properly by removing client version check (#1596)

**Akkadius** [Loginserver] Add config option to display player count (#1738)

**Akkadius** [Loginserver] Add some resiliency to LS requests (#1663)

**Akkadius** [Loginserver] Code Cleanup and Tweaks (#1653)

**Akkadius** [Loginserver] Health Checks (#1665)

**Akkadius** [Loginserver] Worldserver Name Sanitization (#1739)

**Akkadius** [Rez] Fix Z during Resurrection (#1648)

**Akkadius** [Saylinks] Fix auto saylink injection edge cases (#1620)

**Akkadius** [Saylinks] Implement Auto Saylink Injection (#1525)

**Akkadius** [Saylinks] In-Memory Saylink Lookups (#1644)

**Akkadius** [Saylinks] Multiple saylinks in brackets (#1643)

**Akkadius** [Shared Tasks] Task Kill Update Fix (#1573)

**Akkadius** [Shared Tasks] World Reload Task Data on #task reloadall (#1641)

**Akkadius** [Spells/Disciplines] Bulk Train / Scribe (#1640)

**Akkadius** Update changelog.txt

**Alex** [Networking] Servertalk Legacy World Connections for Login (#1662)

**Chris** [Bots] Fix for Bot Pets Taunting (#1519)

**Cole-SoD** Minor corrections (#1582)

**Cole-SoD** [Zone] Add LavaDamage and MinLavaDamage support to ZoneHeader (#1540)

**cybernine186** [Rules] Gate /tgb, /autofire and /melody (#1679)

**hg** [Cleanup] Remove unused door variable. (#1685)

**hg** [Hotfix] Add include to fix windows build (#1657)

**hg** [Loginserver] Identify unknown login client packet fields (#1680)

**hg** Make columns in doors table not nullable (#1597)

**hg** [Quest API] Add back removed lua class properties (#1742)

**hg** [Quest API] Add client->SummonBaggedItems(bag_item_id, bag_items_ref) to Perl/Lua.

**hg** [Quest API] Add mob SetPet and RemovePet quest apis (#1569)

**hg** [Quest API] Add perl hash apis for dz creation (#1571)

**hg** Remove unnecessary includes (#1585)

**hg** [Repositories] Use repositories to load doors (#1572)

**hg** [Shared Tasks] Start solo task replay timers from completion time (#1568)

**JJ** [Bug Fix] Removed unused pointer. Fixes #157. (#1748)

**JJ** [Config] Delete extra versions (#1763)

**JJ** [Hotfix] Optional SQL for existing servers (#1756)

**JJ** [Loginserver] Increase IP/hostname size a bit more (#1765)

**JJ** [Logs] Show local_address in correct location (#1721)

**JJ** Make room for host names.

**JJ** Update 2021_03_03_instance_safereturns.sql (#1636)

**KayenEQ** [API] mob->SpellEffect small perl fix (#1820)

**KayenEQ** [BugFix] Charm Targeting and other issues. (#1655)

**KayenEQ** [BugFix] Fix for bard song instrument mod formula from recent update (#1654)

**KayenEQ** [Bug Fix] Fix for dual wield animation when same delay weapons. (#1671)

**KayenEQ** [Bug Fix] Healing pets not correctly dropping out of combat status (#1603)

**KayenEQ** [Bug Fix] Melee Life tap overflowing and causing damage (#1773)

**KayenEQ** [Bug Fix] Prevent critical DOTs from affecting beneficial damage over time (#1710)

**KayenEQ** [BugFix] Remove potential nullptrs in Virus Code (#1658)

**KayenEQ** [Bug Fix] SOF+ clients item click recast timer not met check (#1682)

**KayenEQ** [Combat] Updates to IMMUNE_MELEE_NONMAGICAL mechanics (#1616)

**KayenEQ** [Commands] #tune command rewrite (#1677)

**KayenEQ** [Bug Fix] Fixes IMMUNE MELEE NONMAGICAL logic (#1606)

**KayenEQ** [Bug Fix] Bard instrument modifiers applying to effects when it shouldn't under certain conditions. (#1822)

**KayenEQ** [Quest API] Added NPC special ability to modify Riposte/Dodge/Parry/Block chance (#1683)

**KayenEQ** [Bug Fix] Prevent buffs that Persist Death from being removed from SE_SpellOnDeath (#1604)

**KayenEQ** [API] mob->SpellEffect can now properly display spell effect that are used on a target. (#1785)

**KayenEQ** [Spells] Allow item click effects to have cast time and recast time modified by focus effects. (#1695)

**KayenEQ** [Spells] Corrected implementation of SE_Purify 291 (#1541)

**KayenEQ** [Spells] Fixed proc rate for Ranged procs (#1715)

**KayenEQ** [Spells] Fix to prevent Charmed Pets from continuing fight target if owner is dead. (#1600)

**KayenEQ** [Spells] Implemented SPA 415 SE_FFItemClass (#1688)

**KayenEQ** [Spells] Implemented SPA 511 SE_Ff_FocusTimerMin (#1645)

**KayenEQ** [Spells] Implemented SPA 512 SE_Proc_Timer_Modifier, Fixed AA procs not working (#1646)

**KayenEQ** [Spells] Rework for SPA 413 SE_FcBaseEffects and Bard updates (#1629)

**KayenEQ** [Spells] Rework of Virus Effect code (#1593)

**KayenEQ** [Spells] Support for SPA 161 and 450 to give percent spell or dot mitigation from Items or AA's. (#1793)

**KayenEQ** [Spells] Updated Memory Blur SPA 63 - Implemented Live Mechanics (#1559)

**KayenEQ** [Spells] Update SPA 101 SE_CompleteHeal (#1544)

**KayenEQ** [Spells] Update SPA158 Reflect (#1590)

**KayenEQ** [Spells] Update to Charm target restriction code (#1666)

**KayenEQ** [Spells] Update to how Bard Instrument mods are applied to spell effects (#1628)

**KayenEQ** [Spells] Update to IsCombatProc checks (#1741)

**KayenEQ** [Spells] Update to SPA305 (#1545)

**KayenEQ** [Spells] Update to SPA 442 and 443 (SE_TriggerOnReqTarget, SE_TriggerOnReqCaster) (#1543)

**KayenEQ** [BugFix] Charm Targeting Fix (#1668)

**KayenEQ** [Spells] Update and fix for SPA382 SE_NegateEffect (#1670)

**KayenEQ** [Spells] Fix for Spell Buff Max Hits not displaying when initially cast (#1554)

**KayenEQ** [BugFix] Missing safe delete of action packet (#1635)

**Kinglykrab** [Bug Fix] Allow invisible to be cast on Raid Group members. (#1607)

**Kinglykrab** [Bug Fix] Dialogue Window Name replace. (#1581)

**Kinglykrab** [Bug Fix] Fix Character Recast Type -1 saving to database. (#1598)

**Kinglykrab** [Bug Fix] Fix Elemental Illusion spells not using proper texture. (#1691)

**Kinglykrab** [Bug Fix] Fixes EVENT_DISCONNECT for /quit and /exit. (#1542)

**Kinglykrab** [Bug Fix] Fix missing format in client message. (#1637)

**Kinglykrab** [Bug Fix] Fix Mob::ShowStats() Proximity Display. (#1708)

**Kinglykrab** [Bug Fix] Fix OpenSSL Support for Windows (#1625)

**Kinglykrab** [Bug Fix] Fix possible #proximity crash. (#1639)

**Kinglykrab** [Bug Fix] GetSpellStat() Identifiers were comparing improperly. (#1552)

**Kinglykrab** [Bug Fix] Loginserver Error String Constants. (#1747)

**Kinglykrab** [Bug Fix] Resolves issues with improper genders and textures on spells. (#1533)

**Kinglykrab** [Bug Fix] Send appearance wasn't setting size properly when changing races. (#1586)

**Kinglykrab** [Bug Fix] Trim output in hidden dialogue response. (#1587)

**Kinglykrab** [Bug Fix] Trim trailing whitespace off output in Popup. (#1584)

**Kinglykrab** [Cleanup] Add Entity ID to ShowStats() NPC display. (#1770)

**Kinglykrab** [Cleanup] Convert DeleteItemInInventory quantity to int16. (#1767)

**Kinglykrab** [Cleanup] Make use of AccountStatus constants wherever status is checked or used. (#1764)

**Kinglykrab** [Cleanup] Utilize ConvertSecondsToTime() method. (#1805)

**Kinglykrab** [Commands] Add #emptyinventory Command. (#1684)

**Kinglykrab** [Commands] Add #findfaction Command. (#1697)

**Kinglykrab** [Commands] Add #findskill [search criteria] Command. (#1674)

**Kinglykrab** [Commands] Add #findtask [search criteria] Command. (#1675)

**Kinglykrab** [Commands] Adds #dye command. (#1537)

**Kinglykrab** [Commands] Cleanup #advnpcspawn and #npcspawn Commands. (#1754)

**Kinglykrab** [Commands] Cleanup #aggro Command. (#1799)

**Kinglykrab** [Commands] Cleanup #aggrozone Command. (#1798)

**Kinglykrab** [Commands] Cleanup #camerashake Command. (#1787)

**Kinglykrab** [Commands] Cleanup #cast Command. (#1706)

**Kinglykrab** [Commands] Cleanup #checklos Command. (#1744)

**Kinglykrab** [Commands] Cleanup #corpse Command. (#1790)

**Kinglykrab** [Commands] Cleanup #cvs Command. (#1709)

**Kinglykrab** [Commands] Cleanup #damage Command. (#1789)

**Kinglykrab** [Commands] Cleanup #disablerecipe Command. (#1816)

**Kinglykrab** [Commands] Cleanup #distance Command. (#1707)

**Kinglykrab** [Commands] Cleanup #enablerecipe Command. (#1817)

**Kinglykrab** [Commands] Cleanup #endurance Command. (#1719)

**Kinglykrab** [Commands] Cleanup #faction Command. (#1716)

**Kinglykrab** [Commands] Cleanup #findnpctype Command. (#1714)

**Kinglykrab** [Commands] Cleanup #flags Command. (#1783)

**Kinglykrab** [Commands] Cleanup #fov Command. (#1701)

**Kinglykrab** [Commands] Cleanup #ginfo Command. (#1788)

**Kinglykrab** [Commands] Cleanup #givemoney Command. (#1781)

**Kinglykrab** [Commands] Cleanup #givemoney Command. (#1804)

**Kinglykrab** [Commands] Cleanup #heal Command. (#1717)

**Kinglykrab** [Commands] Cleanup #instance Command. (#1803)

**Kinglykrab** [Commands] Cleanup #invul Command. (#1780)

**Kinglykrab** [Commands] Cleanup #killallnpcs Command. (#1797)

**Kinglykrab** [Commands] Cleanup #lastname Command. (#1802)

**Kinglykrab** [Commands] Cleanup #loc Command. (#1752)

**Kinglykrab** [Commands] Cleanup #mana Command. (#1718)

**Kinglykrab** [Commands] Cleanup #memspell Command. (#1801)

**Kinglykrab** [Commands] Cleanup #myskills Command. (#1796)

**Kinglykrab** [Commands] Cleanup #npccast Command. (#1699)

**Kinglykrab** [Commands] Cleanup #npcstats Command. (#1690)

**Kinglykrab** [Commands] Cleanup #nukebuffs Command. (#1795)

**Kinglykrab** [Commands] Cleanup #nukeitem Command. (#1782)

**Kinglykrab** [Commands] Cleanup #peqzone Command. (#1794)

**Kinglykrab** [Commands] Cleanup #permaclass Command. (#1777)

**Kinglykrab** [Commands] Cleanup #permagender Command. (#1779)

**Kinglykrab** [Commands] Cleanup #permarace Command. (#1778)

**Kinglykrab** [Commands] Cleanup #pvp Command. (#1800)

**Kinglykrab** [Commands] Cleanup #raidloot Command. (#1757)

**Kinglykrab** [Commands] Cleanup #reloadquest Command. (#1712)

**Kinglykrab** [Commands] Cleanup #setaapts Command. (#1750)

**Kinglykrab** [Commands] Cleanup #setaaxp Command. (#1751)

**Kinglykrab** [Commands] Cleanup #setanim Command. (#1791)

**Kinglykrab** [Commands] Cleanup #setcrystals Command. (#1745)

**Kinglykrab** [Commands] Cleanup #setfaction Command. (#1792)

**Kinglykrab** [Commands] Cleanup #setlanguage Command. (#1705)

**Kinglykrab** [Commands] Cleanup #setpvppoints Command. (#1755)

**Kinglykrab** [Commands] Cleanup #setskill Command. (#1704)

**Kinglykrab** [Commands] Cleanup #showskills Command. (#1698)

**Kinglykrab** [Commands] Cleanup #showspellslist Command. (#1703)

**Kinglykrab** [Commands] Cleanup #showstats Command. (#1700)

**Kinglykrab** [Commands] Cleanup #stun Command. (#1749)

**Kinglykrab** [Commands] Cleanup #viewnpctype Command. (#1713)

**Kinglykrab** [Commands] Cleanup #viewzoneloot Command. (#1702)

**Kinglykrab** [Commands] Cleanup #worldshutdown Command. (#1694)

**Kinglykrab** [Commands] Cleanup #zclip Command. (#1812)

**Kinglykrab** [Commands] Cleanup #zcolor Command. (#1813)

**Kinglykrab** [Commands] Cleanup #zheader Command. (#1814)

**Kinglykrab** [Commands] Cleanup #zonelock Command. (#1711)

**Kinglykrab** [Commands] Cleanup #zsafecoords Command. (#1806)

**Kinglykrab** [Commands] Cleanup #zsave Command. (#1807)

**Kinglykrab** [Commands] Cleanup #zsky Command. (#1808)

**Kinglykrab** [Commands] Cleanup #zstats Command. (#1687)

**Kinglykrab** [Commands] Cleanup #zunderworld Command. (#1809)

**Kinglykrab** [Commands] Convert item ID search to use saylinks similar to name search. (#1589)

**Kinglykrab** [Commands] Further implement #worldwide functionality. (#1693)

**Kinglykrab** [Commands] Overhauled #npcedit. (#1538)

**Kinglykrab** [Commands] Remove #bug Command. (#1737)

**Kinglykrab** [Commands] Remove #clearinvsnapshots Command. (#1736)

**Kinglykrab** [Commands] Remove #connectworldserver Command. (#1735)

**Kinglykrab** [Commands] Remove #crashtest Command. (#1734)

**Kinglykrab** [Commands] Remove #d1 Command. (#1733)

**Kinglykrab** [Commands] Remove duplicate commands. (#1819)

**Kinglykrab** [Commands] Remove #ipc Command. (#1732)

**Kinglykrab** [Commands] Remove #listnpcs Command. (#1696)

**Kinglykrab** [Commands] Remove #logtest Command. (#1731)

**Kinglykrab** [Commands] Remove #manastat Command. (#1730)

**Kinglykrab** [Commands] Remove #mysqltest Command. (#1729)

**Kinglykrab** [Commands] Remove #numauths Command. (#1728)

**Kinglykrab** [Commands] Remove #optest Command. (#1727)

**Kinglykrab** [Commands] Remove #qtest Command. (#1725)

**Kinglykrab** [Commands] Remove #refundaa Command. (#1726)

**Kinglykrab** [Commands] Remove #sendop Command. (#1722)

**Kinglykrab** [Commands] Remove #serversidename Command. (#1720)

**Kinglykrab** [Commands] Remove #synctod Command. (#1723)

**Kinglykrab** [Commands] Remove #testspawn and #testspawnkill Commands. (#1724)

**Kinglykrab** [Commands] Remove #test, #spon, and #spoff Commands. (#1686)

**Kinglykrab** [Commands] Remove #zonespawn Command. (#1811)

**Kinglykrab** [Commands] Remove #zuwcoords Command. (#1810)

**Kinglykrab** [Dialogue] Add hidden response support. (#1583)

**Kinglykrab** [Dialogue] Add support for Dialogue Window buttons. (#1546)

**Kinglykrab** [Dialogue] Add support for Dialogue Window titles. (#1563)

**Kinglykrab** [Door Manipulation] Resolve some typos and add a GM check. (#1550)

**Kinglykrab** [Quest API] Add attuned/augment support to client->SummonBaggedItems() in Perl/Lua. (#1580)

**Kinglykrab** [Quest API] Add client->ReadBookByName(book_name, book_type) to Perl/Lua.

**Kinglykrab** [Quest API] Add corpse->GetLootList() and npc->GetLootList() to Perl and Lua. (#1529)

**Kinglykrab** [Quest API] Add corpse->RemoveItemByID(item_id, quantity) to Perl and Lua. (#1535)

**Kinglykrab** [Quest API] Add cross zone and world wide dialogue windows to Perl/Lua. (#1599)

**Kinglykrab** [Quest API] Add EVENT_COMBINE to Perl and Lua. (#1536)

**Kinglykrab** [Quest API] Add EVENT_CONSIDER_CORPSE to Perl and Lua. (#1530)

**Kinglykrab** [Quest API] Add EVENT_CONSIDER to Perl and Lua. (#1531)

**Kinglykrab** [Quest API] Add GetHateRandomBot(), GetHateRandomClient(), and GetHateRandomNPC() to Perl/Lua. (#1613)

**Kinglykrab** [Quest API] Add GetIPExemption(), GetIPString(), and SetIPExemption(exemption_amount) to Perl/Lua.

**Kinglykrab** [Quest API] Add IsNPCSpawned(npc_ids) and CountSpawnedNPCs(npc_ids) to Perl/Lua. (#1570)

**Kinglykrab** [Quest API] Add LavaDamage and MinLavaDamage to UpdateZoneHeader in Perl/Lua. (#1578)

**Kinglykrab** [Quest API] Add remove LDoN Win/Loss to Perl and Lua. (#1611)

**Kinglykrab** [Quest API] Add Spell methods to Perl. (#1631)

**Kinglykrab** [Quest API] Add UntrainDiscBySpellID(spell_id, update_client) to Perl/Lua. (#1565)

**Kinglykrab** [Quest API] Alphabetize Lua method exports. (#1673)

**Kinglykrab** [Quest API] Alphabetize Perl method exports. (#1672)

**Kinglykrab** [Quest API] Convert all char arrays to strings. (#1612)

**Kinglykrab** [Quest API] Convert Spell Events to similar formats and exports. (#1618)

**Kinglykrab** [Quest API] Cross zone and world wide method overhaul. (#1520)

**Kinglykrab** [Quest API] Further char array cleanup. (#1634)

**Kinglykrab** [Quest API] Simplify bulk Scribe and Train logic. (#1660)

**Kinglykrab** [Quest API] Typo in Perl $entity_lsit->IsMobSpawnedByNpcTypeID(). (#1576)

**Kinglykrab** [Rules] Add Archery/Throwing Ammo Consumption Rules. (#1743)

**Kinglykrab** [Rules] Add Resurrection Sickness rules for Characters/Bots. (#1692)

**Logan** [Rules] Added rule to extend max race id (#1630)

**Michael Cook (mackal)** Fix Channel TellEcho issues (#1676)

**Michael Cook (mackal)** Fix issue with new summmon method putting players OOB (#1649)

**Michael Cook (mackal)** Fix linking tests due to ddcb184 (#1769)

**Michael Cook (mackal)** [Summoning] Make Summon a bit more live like (#1539)

**mmcgarvey** [Rules] Add optional rule for lifetap heals (#1689)

**Natedog2012** [Bug Fix] Do not check tics remaining on non-buff spells (#1633)

**Natedog2012** [Bug Fix] Fix startzone rule to default players to correct zone when not found … (#1669)

**Natedog2012** Fix resetAA to actually remove all AAs except granted AAs (#1681)

**Natedog2012** [Quest API] Add EVENT_LOOT_ZONE to zone_controller (#1608)

**Natedog2012** [Rules] Add optional rules for HealAmt and SpellAmt to scale DoTs/HoTs. (#1661)

**Natedog2012** [Rules] Add option rule to load AA based on CurrentExpansion rule (#1758)

**Paul Coene** (akkadius/login-changes) Fix issue with droplimit code (#1650)

**Paul Coene** [Bug Fix] Edge cases where min_drop 1 not honored with valid choices (#1617)

**Paul Coene** [BugFix] Remove detection of client pets from Sense[Summoned|Undead|Animal] spells (#1601)

**Paul Coene** [Bug Fix] Urgent - Previous fix for TimeSync on static zones broke dynamic zones. (#1605)

**splose** [Bug Fix] Autofire attacking yourself (#1776)

**splose** [Bug Fix] Frenzy is supposed to use 1H Animation. (#1774)

**splose** [Bug Fix] - Monk AA Spirit of Master Wu (#1775)

**splose** define caster to fix a crash from #1618 (#1632)

**splose** [Rules] Missing Character:TradeskillUpTailoring (#1667)

## 9/9/2021¶

**Akkadius** [Compile Fix] Squelch warnings

**Akkadius** [Quest API] Port DiaWind Plugin to Native Quest API (#1521)

**Akkadius** [Hitpoints] Remove HP Update Throttling (#1517)

**Akkadius** [Hotfix] Fixing FMT Format Crash (#1516)

**Akkadius** [Logging] Implement World GMSay Logging (#1505)

**Akkadius** Pad zero size packets which is what we did on encrypted connections prior to #1464 (#1504)

**Akkadius** [Repositories] Add datetime support to repositories (#1503)

**Akkadius** [Server] Tweak inter process keepalive timers; this is a very tiny overhead for inter-process chatter to check for connection liveness (#1502)

**Akkadius** [Shared Tasks] Shared Tasks System Implementation (#1451)

**Alex** [Netcode] Remove security from servertalk connections (#1464)

**Dencelle** [Cheat Detection] Anti-Cheat reimplementation (#1434)

**Gangsta** [Quest API] Sit method (#1449)

**Gangsta** [Spells] IsInvisSpell() Method + InvisRequireGroup Rule (#1453)

**KayenEQ** [Feature] Implemented /shield ability and related affects (#1494)

**KayenEQ** [Spells] Fix SE_TwinCastBlocker to block twinproc (#1476)

**KayenEQ** [Spells] Implemented SPA 482 SE_Skill_Base_Damage_Mod (#1474)

**KayenEQ** [Spells] Implemented SPA 498 and 499 (extra attack chance effects) (#1475)

**KayenEQ** [Spells] Added constant labeling to all StatBonuses that use as arrays. (#1485)

**KayenEQ** [Spells] Allow SE_SecondaryForte 248 to be calculated as a bonus instead of hardcoded AA (#1507)

**KayenEQ** [Spells] Bug fix for AOE Harmony/Lull (#1472)

**KayenEQ** [Spells] Fix SPA 209 SE_DispelBeneficial not causing aggro (#1495)

**KayenEQ** [Spells] Focus related functions to use int32 instead of int16

**KayenEQ** [Spells] Implemented SPA 390 SE_FcTimerLockout (#1496)

**KayenEQ** [Spells] Implemented SPA 471 SE_Double_Melee_Round (#1492)

**KayenEQ** [Spells] Implemented SPA 476 SE_Weapons_Stance and Live-like AA Enable/Disable Toggle (#1477)

**KayenEQ** [Spells] Implemented SPA 489 SE_Worn_Endurance_Regen_Cap (#1493)

**KayenEQ** [Spells] Implemented SPA 504 and 506 (#1488)

**KayenEQ** [Spells] Major update to cast restriction code and new spell field 'caster_requirement_id' (field220) implemented (#1508)

**KayenEQ** [Spells] New SPA focus effects and focus limits (#1462)

**KayenEQ** [Spells] SPIndex fix for wrong const in variable (#1487)

**KayenEQ** [Spells] Updated pet suspend code to use spell effect data and bonuses (#1501)

**KayenEQ** [Spells] Updated SE_NegateSpellEffect SPA 382, new functionality (#1514)

**KayenEQ** [Spells] Update for SPA 403 and 404 (#1482)

**KayenEQ** [Spells] Update SPA 339 SE_TriggerOnCast (#1478)

**KayenEQ** [Spells] Update to SPA 130 and SPA 131 focus calculation, focus code improvements (#1486)

**KayenEQ** [Spells] Update to focus SE_BlockNextSpell (#1479)

**Kinglykrab** [Bug Fix] Shared Bank Charges Fix (#1511)

**Kinglykrab** [Quest API] Add GetHealScale() and GetSpellScale() to Perl and Lua. (#1515)

**Kinglykrab** [Quest API] Adds new methods to NPCs and Corpses (#1510)

**Kinglykrab** [Quest API] Modify GetItemStat() and GetSpellStat() functionality. (#1509)

**Logan** [Mods] Added Hastev3Cap (#1506)

**Michael Cook (mackal)** [CI] Enable Bots (Typo) in Drone Config (#1481)

**Michael Cook (mackal)** [cmake] Update min cmake version due to fe7cb76 (#1489)

**Michael Cook (mackal)** Fix bots with ExtraAttackChance changes (#1480)

**Michael Cook (mackal)** [Spells] Implement PVP resist and duration overrides (#1513)

**splose** [Hitpoints] More HP Fixes - Remove Hacks (#1518)

### [Shared Tasks] Shared Task System Implementation (#1451)¶

See [Shared Tasks] Design Doc for design details. Huge props to @hgtw co-writing this system with me over the past 6 months or so

**Demo Videos During Development**

- [Shared Tasks] Task Update Stress Testing

- [Shared Tasks] Demo #2 Member Updating (Delete, Add, Leader) & Task Sync

- [Shared Tasks] Functionality Demo

**Goals**

- Shared tasks implementation to be as simple as possible

- Shared tasks implementation to be least invasive to existing Quest API’s (Keep majority existing functionality)

- Shared tasks to be least invasive to existing zone state management handling and use the zone-level state management to be a “client” or “subscriber” of * world when handling a task of type “shared”

- Utilize all of the zone-level state management but insert middleware to intercept functionality where world should be authoritative over state management

- World should be able to fully restore shared task state on crash or restart and pick up exactly where it left off

- Attempt to keep zone as un-aware of any shared task state data as possible; none if at all possible outside of caches for duplicate update checking

**High Level Notes**

- Shared task creation fully works out of the box either through existing `quest::assigntask()` or `quest::taskselector()` methods. You cannot mix shared tasks with regular tasks in the task selector window.

- Validation fully in place for Shared Task requests / adding and removal of players

- World keeps all shared task state and keeps the local state of players in sync with the single source of truth (World) through `SharedTaskManager`

- `DynamicZones` were decoupled from `Expeditions` by HG to be able to be used flexibly with Shared Tasks

- Most crucial shared task messaging support has been added. Eg. players being removed, added, leadership transfer, acquiring, validation etc.

- Existing task packets consolidated and cleaned up

- Lockouts fully implemented (Task timers)

- Rate limiters added to some task commands for a small DOS mitigation layer

- Shared Task completions get historically recorded for any sort of player logging

**Client Command Support**

- /tasktimers

- /taskplayerlist

- /taskremove

- /taskmakeleader

- /taskadd

- /taskquit

**New Tables**

- character_instance_safereturns - Handles instance safe returns

- character_task_timers - Character task timers / lockouts

- completed_shared_task_activity_state - Historical Shared Task information

- completed_shared_task_members - Historical Shared Task information

- completed_shared_tasks - Historical Shared Task information

- shared_task_activity_state - Shared Task activity state

- shared_task_dynamic_zones - Shared Task dynamic zones associations

- shared_task_members - Shared Task members

- shared_tasks - Shared Tasks

```
`describe character_instance_safereturns;
+------------------+------------------+------+-----+---------+----------------+
| Field | Type | Null | Key | Default | Extra |
+------------------+------------------+------+-----+---------+----------------+
| id | int(10) unsigned | NO | PRI | NULL | auto_increment |
| character_id | int(10) unsigned | NO | UNI | NULL | |
| instance_zone_id | int(11) | NO | | 0 | |
| instance_id | int(11) | NO | | 0 | |
| safe_zone_id | int(11) | NO | | 0 | |
| safe_x | float | NO | | 0 | |
| safe_y | float | NO | | 0 | |
| safe_z | float | NO | | 0 | |
| safe_heading | float | NO | | 0 | |
+------------------+------------------+------+-----+---------+----------------+
9 rows in set (0.001 sec)

MariaDB [peq]> describe character_task_timers;
+--------------+------------------+------+-----+---------------------+----------------+
| Field | Type | Null | Key | Default | Extra |
+--------------+------------------+------+-----+---------------------+----------------+
| id | int(10) unsigned | NO | PRI | NULL | auto_increment |
| character_id | int(10) unsigned | NO | MUL | 0 | |
| task_id | int(10) unsigned | NO | MUL | 0 | |
| timer_type | int(11) | NO | | 0 | |
| expire_time | datetime | NO | | current_timestamp() | |
+--------------+------------------+------+-----+---------------------+----------------+
5 rows in set (0.001 sec)

MariaDB [peq]> describe completed_shared_task_activity_state;
+----------------+------------+------+-----+---------+-------+
| Field | Type | Null | Key | Default | Extra |
+----------------+------------+------+-----+---------+-------+
| shared_task_id | bigint(20) | NO | PRI | NULL | |
| activity_id | int(11) | NO | PRI | NULL | |
| done_count | int(11) | YES | | NULL | |
| updated_time | datetime | YES | | NULL | |
| completed_time | datetime | YES | | NULL | |
+----------------+------------+------+-----+---------+-------+
5 rows in set (0.000 sec)

MariaDB [peq]> describe completed_shared_task_members;
+----------------+------------+------+-----+---------+-------+
| Field | Type | Null | Key | Default | Extra |
+----------------+------------+------+-----+---------+-------+
| shared_task_id | bigint(20) | NO | PRI | NULL | |
| character_id | bigint(20) | NO | PRI | NULL | |
| is_leader | tinyint(4) | YES | | NULL | |
+----------------+------------+------+-----+---------+-------+
3 rows in set (0.000 sec)

MariaDB [peq]> describe completed_shared_tasks;
+-----------------+------------+------+-----+---------+-------+
| Field | Type | Null | Key | Default | Extra |
+-----------------+------------+------+-----+---------+-------+
| id | bigint(20) | NO | PRI | NULL | |
| task_id | int(11) | YES | | NULL | |
| accepted_time | datetime | YES | | NULL | |
| expire_time | datetime | YES | | NULL | |
| completion_time | datetime | YES | | NULL | |
| is_locked | tinyint(1) | YES | | NULL | |
+-----------------+------------+------+-----+---------+-------+
6 rows in set (0.000 sec)

MariaDB [peq]> describe shared_task_activity_state;
+----------------+------------+------+-----+---------+-------+
| Field | Type | Null | Key | Default | Extra |
+----------------+------------+------+-----+---------+-------+
| shared_task_id | bigint(20) | NO | PRI | NULL | |
| activity_id | int(11) | NO | PRI | NULL | |
| done_count | int(11) | YES | | NULL | |
| updated_time | datetime | YES | | NULL | |
| completed_time | datetime | YES | | NULL | |
+----------------+------------+------+-----+---------+-------+
5 rows in set (0.000 sec)

MariaDB [peq]> describe shared_task_dynamic_zones;
+-----------------+------------------+------+-----+---------+-------+
| Field | Type | Null | Key | Default | Extra |
+-----------------+------------------+------+-----+---------+-------+
| shared_task_id | bigint(20) | NO | PRI | NULL | |
| dynamic_zone_id | int(10) unsigned | NO | PRI | NULL | |
+-----------------+------------------+------+-----+---------+-------+
2 rows in set (0.000 sec)

MariaDB [peq]> describe shared_task_members;
+----------------+------------+------+-----+---------+-------+
| Field | Type | Null | Key | Default | Extra |
+----------------+------------+------+-----+---------+-------+
| shared_task_id | bigint(20) | NO | PRI | NULL | |
| character_id | bigint(20) | NO | PRI | NULL | |
| is_leader | tinyint(4) | YES | | NULL | |
+----------------+------------+------+-----+---------+-------+
3 rows in set (0.000 sec)

MariaDB [peq]> describe shared_tasks;
+-----------------+------------+------+-----+---------+----------------+
| Field | Type | Null | Key | Default | Extra |
+-----------------+------------+------+-----+---------+----------------+
| id | bigint(20) | NO | PRI | NULL | auto_increment |
| task_id | int(11) | YES | | NULL | |
| accepted_time | datetime | YES | | NULL | |
| expire_time | datetime | YES | | NULL | |
| completion_time | datetime | YES | | NULL | |
| is_locked | tinyint(1) | YES | | NULL | |
+-----------------+------------+------+-----+---------+----------------+
6 rows in set (0.001 sec)
`
```

**Newly Handled Ops**

- OP_SharedTaskAcceptNew

- OP_SharedTaskAddPlayer

- OP_SharedTaskInvite

- OP_SharedTaskInviteResponse

- OP_SharedTaskMakeLeader

- OP_SharedTaskMemberChange

- OP_SharedTaskMemberInvite

- OP_SharedTaskMemberList

- OP_SharedTaskPlayerList

- OP_SharedTaskQuit

- OP_SharedTaskRemovePlayer

- OP_SharedTaskSelectWindow

- OP_TaskRequestTimer

- OP_TaskSelectWindow

- OP_TaskTimers

**Relevant Shared Task Source Files**

```
`./common/shared_tasks.h
./common/shared_tasks.cpp
./common/repositories/completed_shared_tasks_repository.h
./common/repositories/completed_shared_task_members_repository.h
./common/repositories/shared_task_dynamic_zones_repository.h
./common/repositories/completed_shared_task_activity_state_repository.h
./common/repositories/shared_task_members_repository.h
./common/repositories/shared_tasks_repository.h
./common/repositories/base/base_shared_task_dynamic_zones_repository.h
./common/repositories/base/base_completed_shared_tasks_repository.h
./common/repositories/base/base_shared_tasks_repository.h
./common/repositories/base/base_shared_task_activity_state_repository.h
./common/repositories/base/base_completed_shared_task_members_repository.h
./common/repositories/base/base_shared_task_members_repository.h
./common/repositories/base/base_completed_shared_task_activity_state_repository.h
./common/repositories/shared_task_activity_state_repository.h
./zone/shared_task_zone_messaging.cpp
./zone/shared_task_zone_messaging.h
./world/shared_task_world_messaging.cpp
./world/shared_task_manager.cpp
./world/shared_task_world_messaging.h
./world/shared_task_manager.h
`
```

**Images**

### [Quest API] Port DiaWind Plugin to Native Quest API¶

This PR ports the following Perl plugin to native source and is available to both Lua and Perl

https://docs.eqemu.io/quest-api/perl/plugins/diawind

**New Quest API Methods**

```
`$client->DialogueWindow("markdown");
$client->DiaWind("markdown"); // alias
`
```

```
`e.other:DialogueWindow("markdown");
e.other:DiaWind("markdown"); // alias
`
```

**Markdown**

- **{lb}** = Light Blue Color

- **{y}** = Yellow Color

- **{gold}** = Gold Color

- **{g}** = Green Color

- **{r}** = Red Color

- **{gray}** = Gray Color

- **~** = End Color Tag ()

- **>** = Response Text (Not Visible) - This is what the player responds with, for example: [What else do we need to do?>

- **** = Response Text (Visible) - If a NPC has multiple brackets, it will give the player multiple saylinks to click, if there is just one [bracket] inline with the text, the player will respond by clicking 'Yes' on the window

- **+66+** = Animation number - As long as there is a number between two plus signs together, the NPC will perform that animation

- **+salute+** = Animation phrase - This references

- **{bullet}** - Equivalent to a bullet such as the one in this list

- **{in}** - Will indent the text

- **{linebreak}** - Will create a linebreak

- **mysterious** - If the text 'mysterious' is anywhere in the text, it will not show up in the player window, but it will format the window as 'Mysterious Voice tells you'

- **wintype:0/1** - If this is 1 the window will be Yes/No

- **popupid:ID** - If this option is present, it will give the popup window and ID

- **noquotes** - This tells the window to not use any quotes for special formatting at times

- **nosound** - No sound affect will play with the window

- **=Timer=** - If a number is specified between the two ==, it will countdown a timer on the popup window

**Images**

**HTML Color Codes**

You can also callout the follow color codes to use in the window as well by calling them out in brackets

```
`{color_name}something~
`
```

```
` {"black", "#000000"},
 {"brown", "#804000"},
 {"burgundy", "#800000"},
 {"cadet_blue", "#77BFC7"},
 {"cadet_blue_1", "#4C787E"},
 {"chartreuse", "#8AFB17"},
 {"chartreuse_1", "#7FE817"},
 {"chartreuse_2", "#6CC417"},
 {"chartreuse_3", "#437C17"},
 {"chocolate", "#C85A17"},
 {"coral", "#F76541"},
 {"coral_1", "#E55B3C"},
 {"coral_2", "#C34A2C"},
 {"cornflower_blue", "#151B8D"},
 {"cyan", "#00FFFF"},
 {"cyan_1", "#57FEFF"},
 {"cyan_2", "#50EBEC"},
 {"cyan_3", "#46C7C7"},
 {"cyan_4", "#307D7E"},
 {"dark_blue", "#0000A0"},
 {"dark_goldenrod", "#AF7817"},
 {"dark_goldenrod_1", "#FBB117"},
 {"dark_goldenrod_2", "#E8A317"},
 {"dark_goldenrod_3", "#C58917"},
 {"dark_goldenrod_4", "#7F5217"},
 {"dark_green", "#254117"},
 {"dark_grey", "#808080"},
 {"dark_olive_green", "#CCFB5D"},
 {"dark_olive_green_2", "#BCE954"},
 {"dark_olive_green_3", "#A0C544"},
 {"dark_olive_green_4", "#667C26"},
 {"dark_orange", "#F88017"},
 {"dark_orange_1", "#F87217"},
 {"dark_orange_2", "#E56717"},
 {"dark_orange_3", "#7E3117"},
 {"dark_orange_3", "#C35617"},
 {"dark_orchid", "#7D1B7E"},
 {"dark_orchid_1", "#B041FF"},
 {"dark_orchid_2", "#A23BEC"},
 {"dark_orchid_3", "#8B31C7"},
 {"dark_orchid_4", "#571B7e"},
 {"dark_purple", "#800080"},
 {"dark_salmon", "#E18B6B"},
 {"dark_sea_green", "#8BB381"},
 {"dark_sea_green_1", "#C3FDB8"},
 {"dark_sea_green_2", "#B5EAAA"},
 {"dark_sea_green_3", "#99C68E"},
 {"dark_sea_green_4", "#617C58"},
 {"dark_slate_blue", "#2B3856"},
 {"dark_slate_gray", "#25383C"},
 {"dark_slate_gray_1", "#9AFEFF"},
 {"dark_slate_gray_2", "#8EEBEC"},
 {"dark_slate_gray_3", "#78c7c7"},
 {"dark_slate_gray_4", "#4C7D7E"},
 {"dark_turquoise", "#3B9C9C"},
 {"dark_violet", "#842DCE"},
 {"deep_pink", "#F52887"},
 {"deep_pink_1", "#E4287C"},
 {"deep_pink_2", "#C12267"},
 {"deep_pink_3", "#7D053F"},
 {"deep_sky_blue", "#3BB9FF"},
 {"deep_sky_blue_1", "#38ACEC"},
 {"deep_sky_blue_2", "#3090C7"},
 {"deep_sky_blue_3", "#25587E"},
 {"dim_gray", "#463E41"},
 {"dodger_blue", "#1589FF"},
 {"dodger_blue_1", "#157DEC"},
 {"dodger_blue_2", "#1569C7"},
 {"dodger_blue_3", "#153E7E"},
 {"firebrick", "#800517"},
 {"firebrick_1", "#F62817"},
 {"firebrick_2", "#E42217"},
 {"firebrick_3", "#C11B17"},
 {"forest_green", "#4E9258"},
 {"forest_green_1", "#808000"},
 {"gold", "#D4A017"},
 {"gold_1", "#FDD017"},
 {"gold_2", "#EAC117"},
 {"gold_3", "#C7A317"},
 {"gold_4", "#806517"},
 {"goldenrod", "#EDDA74"},
 {"goldenrod_1", "#FBB917"},
 {"goldenrod_2", "#E9AB17"},
 {"goldenrod_3", "#C68E17"},
 {"goldenrod_4", "#805817"},
 {"grass_green", "#408080"},
 {"gray", "#736F6E"},
 {"gray_1", "#150517"},
 {"gray_2", "#250517"},
 {"gray_3", "#2B1B17"},
 {"gray_4", "#302217"},
 {"gray_5", "#302226"},
 {"gray_6", "#342826"},
 {"gray_7", "#34282C"},
 {"gray_8", "#382D2C"},
 {"gray_9", "#3b3131"},
 {"gray_10", "#3E3535"},
 {"gray_11", "#413839"},
 {"gray_12", "#41383C"},
 {"gray_13", "#463E3F"},
 {"gray_14", "#4A4344"},
 {"gray_15", "#4C4646"},
 {"gray_16", "#4E4848"},
 {"gray_17", "#504A4B"},
 {"gray_18", "#544E4F"},
 {"gray_19", "#565051"},
 {"gray_19", "#595454"},
 {"gray_20", "#5C5858"},
 {"gray_21", "#5F5A59"},
 {"gray_22", "#625D5D"},
 {"gray_23", "#646060"},
 {"gray_24", "#666362"},
 {"gray_25", "#696565"},
 {"gray_26", "#6D6968"},
 {"gray_27", "#6E6A6B"},
 {"gray_28", "#726E6D"},
 {"gray_29", "#747170"},
 {"green", "#00FF00"},
 {"green_1", "#5FFB17"},
 {"green_2", "#59E817"},
 {"green_3", "#4CC417"},
 {"green_4", "#347C17"},
 {"green_yellow", "#B1FB17"},
 {"hot_pink", "#F660AB"},
 {"hot_pink_1", "#F665AB"},
 {"hot_pink_2", "#E45E9D"},
 {"hot_pink_3", "#C25283"},
 {"hot_pink_4", "#7D2252"},
 {"indian_red", "#F75D59"},
 {"indian_red_2", "#E55451"},
 {"indian_red_3", "#C24641"},
 {"indian_red_4", "#7E2217"},
 {"khaki", "#ADA96E"},
 {"khaki_1", "#FFF380"},
 {"khaki_2", "#EDE275"},
 {"khaki_3", "#C9BE62"},
 {"khaki_4", "#827839"},
 {"lavender", "#E3E4FA"},
 {"lavender_blush", "#FDEEF4"},
 {"lavender_blush_1", "#EBDDE2"},
 {"lavender_blush_2", "#C8BBBE"},
 {"lavender_blush_3", "#817679"},
 {"lawn_green", "#87F717"},
 {"lemon_chiffon", "#FFF8C6"},
 {"lemon_chiffon_1", "#ECE5B6"},
 {"lemon_chiffon_2", "#C9C299"},
 {"lemon_chiffon_3", "#827B60"},
 {"light_blue", "#0000FF"},
 {"light_blue_1", "#ADDFFF"},
 {"light_blue_2", "#BDEDFF"},
 {"light_blue_3", "#AFDCEC"},
 {"light_blue_4", "#95B9C7"},
 {"light_blue_5", "#5E767E"},
 {"light_coral", "#E77471"},
 {"light_cyan", "#E0FFFF"},
 {"light_cyan_1", "#CFECEC"},
 {"light_cyan_2", "#AFC7C7"},
 {"light_cyan_3", "#717D7D"},
 {"light_golden", "#ECD672"},
 {"light_goldenrod", "#ECD872"},
 {"light_goldenrod_1", "#FFE87C"},
 {"light_goldenrod_2", "#C8B560"},
 {"light_goldenrod_3", "#817339"},
 {"light_goldenrod_yellow", "#FAF8CC"},
 {"light_grey", "#C0C0C0"},
 {"light_pink", "#FAAFBA"},
 {"light_pink_1", "#F9A7B0"},
 {"light_pink_2", "#E799A3"},
 {"light_pink_3", "#C48189"},
 {"light_pink_4", "#7F4E52"},
 {"light_purple", "#FF0080"},
 {"light_salmon", "#F9966B"},
 {"light_salmon_1", "#E78A61"},
 {"light_salmon_2", "#C47451"},
 {"light_salmon_3", "#7F462C"},
 {"light_sea_green", "#3EA99F"},
 {"light_sky_blue", "#82CAFA"},
 {"light_sky_blue_1", "#A0CFEC"},
 {"light_sky_blue_2", "#87AFC7"},
 {"light_sky_blue_3", "#566D7E"},
 {"light_slate_blue", "#736AFF"},
 {"light_slate_gray", "#6D7B8D"},
 {"light_steel_blue", "#728FCE"},
 {"light_steel_blue_1", "#C6DEFF"},
 {"light_steel_blue_2", "#B7CEEC"},
 {"light_steel_blue_3", "#646D7E"},
 {"lime_green", "#41A317"},
 {"magenta", "#FF00FF"},
 {"magenta_1", "#F433FF"},
 {"magenta_2", "#E238EC"},
 {"magenta_3", "#C031C7"},
 {"maroon", "#810541"},
 {"maroon_1", "#F535AA"},
 {"maroon_2", "#E3319D"},
 {"maroon_3", "#C12283"},
 {"maroon_4", "#7D0552"},
 {"medium_aquamarine", "#348781"},
 {"medium_forest_green", "#347235"},
 {"medium_orchid", "#B048B5"},
 {"medium_orchid_1", "#D462FF"},
 {"medium_orchid_2", "#C45AEC"},
 {"medium_orchid_3", "#A74AC7"},
 {"medium_orchid_4", "#6A287E"},
 {"medium_purple", "#8467D7"},
 {"medium_purple_1", "#9E7BFF"},
 {"medium_purple_2", "#9172EC"},
 {"medium_purple_3", "#7A5DC7"},
 {"medium_purple_4", "#4E387E"},
 {"medium_sea_green", "#306754"},
 {"medium_slate_blue", "#5E5A80"},
 {"medium_spring_green", "#348017"},
 {"medium_turquoise", "#48CCCD"},
 {"medium_violet_red", "#CA226B"},
 {"midnight_blue", "#151B54"},
 {"orange", "#FF8040"},
 {"pale_turquoise", "#92C7C7"},
 {"pale_turquoise_1", "#5E7D7E"},
 {"pale_violet_red", "#D16587"},
 {"pale_violet_red_1", "#F778A1"},
 {"pale_violet_red_2", "#E56E94"},
 {"pale_violet_red_3", "#C25A7C"},
 {"pale_violet_red_4", "#7E354D"},
 {"pastel_green", "#00FF00"},
 {"pink", "#FAAFBE"},
 {"pink_1", "#FF00FF"},
 {"pink_2", "#E7A1B0"},
 {"pink_3", "#C48793"},
 {"pink_4", "#7F525D"},
 {"plum", "#B93B8F"},
 {"plum_1", "#F9B7FF"},
 {"plum_2", "#E6A9EC"},
 {"plum_3", "#C38EC7"},
 {"plum_4", "#7E587E"},
 {"purple", "#8E35EF"},
 {"purple_1", "#893BFF"},
 {"purple_2", "#7F38EC"},
 {"purple_3", "#6C2DC7"},
 {"purple_4", "#461B7E"},
 {"red", "#FF0000"},
 {"red_1", "#F62217"},
 {"red_2", "#E41B17"},
 {"rosy_brown", "#B38481"},
 {"rosy_brown_1", "#FBBBB9"},
 {"rosy_brown_2", "#E8ADAA"},
 {"rosy_brown_3", "#C5908E"},
 {"rosy_brown_4", "#7F5A58"},
 {"royal_blue", "#2B60DE"},
 {"royal_blue_1", "#306EFF"},
 {"royal_blue_2", "#2B65EC"},
 {"royal_blue_3", "#2554C7"},
 {"royal_blue_4", "#15317E"},
 {"salmon_1", "#F88158"},
 {"salmon_2", "#E67451"},
 {"salmon_3", "#C36241"},
 {"salmon_4", "#7E3817"},
 {"sandy_brown", "#EE9A4D"},
 {"sea_green", "#4E8975"},
 {"sea_green_1", "#6AFB92"},
 {"sea_green_2", "#64E986"},
 {"sea_green_3", "#54C571"},
 {"sea_green_4", "#387C44"},
 {"sienna", "#8A4117"},
 {"sienna_1", "#F87431"},
 {"sienna_2", "#E66C2C"},
 {"sienna_3", "#C35817"},
 {"sienna_4", "#7E3517"},
 {"sky_blue", "#82CAFF"},
 {"sky_blue_1", "#6698FF"},
 {"sky_blue_2", "#79BAEC"},
 {"sky_blue_3", "#659EC7"},
 {"sky_blue_4", "#41627E"},
 {"slate_blue", "#357EC7"},
 {"slate_blue_1", "#737CA1"},
 {"slate_blue_2", "#6960EC"},
 {"slate_blue_3", "#342D7E"},
 {"slate_gray", "#657383"},
 {"slate_gray_1", "#C2DFFF"},
 {"slate_gray_2", "#B4CFEC"},
 {"slate_gray_3", "#98AFC7"},
 {"slate_gray_4", "#616D7E"},
 {"spring_green", "#4AA02C"},
 {"spring_green_1", "#5EFB6E"},
 {"spring_green_2", "#57E964"},
 {"spring_green_3", "#4CC552"},
 {"spring_green_4", "#347C2C"},
 {"steel_blue", "#4863A0"},
 {"steel_blue_1", "#5CB3FF"},
 {"steel_blue_2", "#56A5EC"},
 {"steel_blue_3", "#488AC7"},
 {"steel_blue_4", "#2B547E"},
 {"thistle", "#D2B9D3"},
 {"thistle_1", "#FCDFFF"},
 {"thistle_2", "#E9CFEC"},
 {"thistle_3", "#C6AEC7"},
 {"thistle_4", "#806D7E"},
 {"turquoise", "#00FFFF"},
 {"turquoise_1", "#43C6DB"},
 {"turquoise_2", "#52F3FF"},
 {"turquoise_3", "#4EE2EC"},
 {"turquoise_4", "#43BFC7"},
 {"violet", "#8D38C9"},
 {"violet_red", "#F6358A"},
 {"violet_red_1", "#F6358A"},
 {"violet_red_2", "#E4317F"},
 {"violet_red_3", "#C12869"},
 {"violet_red_4", "#7D0541"},
 {"white", "#FFFFFF"},
 {"yellow", "#FFFF00"},
 {"yellow_1", "#FFFC17"},
 {"yellow_green", "#52D017"}
};
`
```

### [Logging] Implement World GMSay Logging (#1505)¶

Also work peeled from #1451

This enables world GM say logging and relays all messages to all zoneservers.

This was especially helpful during Shared Tasks work where we need / want to see real live communication of packets being sent back and forth between world and zone

**Example**

This also adds the following rule which is enabled by default

```
`RULE_BOOL(Logging, WorldGMSayLogging, true, "Relay worldserver logging to zone processes via GM say output")
`
```

Of course operators will need to be mindful of not turning on excessive logging but should be fine performance wise under normal conditions

## 7/27/2021¶

**Akkadius** [Hotfix] SendIllusion revert to October

**Akkadius** [Repositories] Regenerate repositories with int64 support, reserved word support (#1440)

**Akkadius** [Repository Generator] Add int64/bigint support, add support for reserved words (#1439)

**Akkadius** [Repository Usage] Migrate NPC Scale Manager to use repositories (#1441)

**Dencelle** [Code] Addition of zone constants for hard coding (#1443)

**Dencelle** [Commands] Make #maxskills work on target. (#1445)

**E Spause** Add SetGMStatus to LUA, cleanup unused variable, cleanup naming of new function added to Client class, remove unneeded return on void function. (#1471)

**Gangsta** [Merchants] Fix issue where an item purchased with 1 charges actually is bought with 0 charges

**Gangsta** [Bugfix] Fixes guards assisting mobs against players (#1448)

**KayenEQ** [Spells] Projectiles Update (#1468)

**KayenEQ** [Feature] New SPAs pass 1 (#1454)

**KayenEQ** [Feature] New SPAs pass 2 (#1459)

**KimLS** Fix for compile issue when you either don't have openSSL or you're using a version not supported by httplib

**Kurt Gilpin** [Inventory] Remove Trader's Satchel ID from inventory.cpp (#1423)

**Michael Cook (mackal)** Add defines (commented) for further known SPAs (#1446)

**Michael Cook (mackal)** [Bug Fix] spell cast time cap issue introduced in e5b9d72 (#1435)

**Michael Cook (mackal)** [Spells Cleanup] Unify and add most hardcoded spell IDs (#1438)

**Natedog2012** Allow NPCs to aggro player pets with NPCAggro field set in database and new rule AggroPlayerPets set to true (#1450)

**splose** [Quest API] Add $client->SetGMStatus() (#1465)

## 6/12/2021¶

**Alex** [Bots] Add Bot scripting capabilities to the source. (#1378)

**Alex** [Bots] Remove hardcoded race-class combinations from bots. (#1375)

**Alex** [Bug Fix] Fix CMakeLists.txt so compile works. (#1387)

**Alex** [Commands] Add #findclass [search criteria] command. (#1384)

**Alex** [Commands] Add #viewzoneloot [item id] command. (#1382)

**Alex** [Pets] Unhardcode Beastlord pet values. (#1379)

**Alex** [Quest API] Add ChangeLastName() and ClearLastName() to Lua. (#1386)

**Alex** [Quest API] Add SetHideMe() to Perl/Lua. (#1388)

**Alex** [Quest API] Add getcleannpcnamebyid(npc_id) to Perl/Lua. (#1383)

**Alex** [Quest API] Add several methods to Perl/Lua API for LDoN stuff. (#1356)

**Alex** [Shared Bank] Add additional popup to shared bank warning message, as client-side filters can cause the message to be unseen. (#1368)

**Alex** [Spells] Adds a rule to allow right-click memorize from spell scrolls. (#1377)

**Dencelle** [Bug Fix] EntityList::AESpell fix for Pacify / Mez (#1354)

**Dencelle** [Bug Fix] Fix for charges not being sold correctly (#1357)

**Dencelle** [Bug Fix] NPC not breaking charm correctly (#1363)

**Kurt Gilpin** (HEAD -> master, origin/master) Fix crash when casting with no target (#1390)

**Michael Cook (mackal)** Magic numbers bad (#1373)

**Michael Cook (mackal)** This skill bonus was suppose to only apply to monks with epics (#1364)

**Michael Cook (mackal)** [Bug Fix] EntityList::AESpell was off by one (#1351)

**Michael Cook (mackal)** [Fix] Fix Spell Cast Time reduction issues (#1369)

**Michael Cook (mackal)** [Quest API] Add Lua_Mob::GetShuffledHateList (#1381)

**Michael** [Rule] Allow Skill ups from items (Default: On) (#1376)

**Paul Coene** [GM Command] #list npcs Goto option now goes to higher Z if selected NPC is a boat. (#1349)

**RoTPvP** [PVP] Pvp guard assist code. (Guards will assist in PvP based on faction) (#1367)

**RoTPvP** [Spells] Added a pet check to Cazic Touch (#1365)

**TurmoilToad** [Docs] Create CODE_OF_CONDUCT.md (#1360)

**hg** [Dynamic Zones] Store min and max players on dz (#1355)

**hg** [Expeditions] Avoid expedition leader change if only member (#1372)

**hg** [Expeditions] Move member compass updates to dz (#1371)

**hg** [Expeditions] Store members on dynamic zone (#1358)

**hg** [Quest API] Add write overloads to lua packet quest api (#1366)

**hg** [Repository Generator] Fix repository generator on windows (#1353)

**regneq** [Time] strict spawn_events now take into account EQ minute. (#1370)

**splose** [Bug Fix] Allow GMs to chat when stunned (#1380)

**splose** [Rules] Add rule to allow you to cast invis on already invis'd players (#1361)

## 5/10/2021¶

This changelog entry encompasses the past 6 months of updates and PR's

**Akkadius** Drone Build Pipeline (#1144)

**Akkadius** [DevTools] Improve DevTools Toggling Options (#1161)

**Akkadius** [Door Opening] Rule to let configure Animal Door Opening (#1231)

**Akkadius** [Repositories] Insert repository improvements (#1236)

**Akkadius** [Scheduler] Event scheduler implementation (#1257) **Akkadius** Move data aliases after null checks for safety [skip ci]

**Akkadius** Revert "[BUG] Fix for Group Leader Disband Issue"

**Akkadius** Update repo with latest template [skip ci]

**Akkadius** [Hotfix] DB Manifest

**Akkadius** [Hotfix] Incorrect Perl usage method (docs)

**Akkadius** [Hotfix] Remove test branch fields from repo

**Akkadius** [Installer] Swap unstable powershell download for Perl LWP::Simple call

**Alex** [CLE] Reset iterator in IsAccountInGame() (#1345)

**Alex** Add HasDisciplineLearned() to Perl/Lua.

**Alex** Add ScaleNPC() to Perl and Lua. (#1238)

**Alex** Add SetRadiantCrystals() and SetEbonCrystals() to Perl/Lua. (#1159)

**Alex** Add character-specific zone-based experience modifiers. (#1326)

**Alex** Add new experience modifiers table to GetCharacterTables() and GetPlayerTables() in database_schema.h. (#1338)

**Alex** Add removeitem(item_id, quantity) to Perl/Lua. (#1156)

**Alex** Convert NPC Spell AI from int16 to uint16. (#1262)

**Alex** Fix Perl NPC GetAvoidanceRating() Perl Croak. (#1333)

**Alex** Fix SQL for NPC Spells. (#1265)

**Alex** [Bug Fix] Zone Heading for Binds, Summons, Teleports, and Zoning. (#1328)

**Alex** [Experience] Add exp mod to npc types to let a server op change the exp modifier (#1252)

**Alex** [Library] Update zlibng (#1255)

**Alex** [Quest API] Add HTML color tag method to Perl and Lua. (#1324)

**Alex** [Quest API] Add IsHorse() to Perl and Lua. (#1264)

**Alex** [Quest API] Add IsRaidTarget() to Perl and Lua (#1347)

**Alex** [Quest API] Add Mob-based data bucket methods to Perl/Lua. (#1237)

**Alex** [Quest API] Add new zone name methods to Perl and Lua. (#1309)

**Alex** [Quest API] Add secondstotime(duration) to Perl and Lua. (#1281)

**Alex** [Quest API] Convert Client GetLastName() method export to Mob export. (#1331)

**Alex** [Quest API] Resolves traindiscs and scribespells issues in Perl/Lua. (#1249)

**Alex** [Rules] Cleanup all unused rules. (#1308)

**Alex** quest::getspellname() and quest::getclassname() fixes/additions. (#1158)

**E Spause** Add safeguard for issue with mobs pathing to 0,0,0 on teleport nodes with values 0,0,0 (#1140)

**JeffyW** [Installer] $ENV support, formatting, and optimizations (#1340)

**KimLS** Fix for issue in movement manager where a drop aggro can happen and processing continues.

**Michael Cook (mackal)** Add include to PATH_SUFFIXES for Windows builds (#1246)

**Michael Cook (mackal)** Add string util search_deliminated_string (#1260)

**Michael Cook (mackal)** Feature/underworld (#1146)

**Michael Cook (mackal)** Fix NPC Scale Manager leaking (#1254)

**Michael Cook (mackal)** Fix some leaks of groups/raids (#1242)

**Michael Cook (mackal)** Fix va_list leaks in MakeAnyLenString/AppendAnyLenString (#1240)

**Michael Cook (mackal)** Hack to fix repulsable bard charms (#1320)

**Michael Cook (mackal)** LuaJIT calls it lua51.lib/dll on Windows ... (#1247)

**Michael Cook (mackal)** Provide more search paths for luajit (#1216)

**Michael Cook (mackal)** Switch scheduled hot zone check to search instead of split (#1313)

**Michael Cook (mackal)** [Bug Fix] Add Bounds Checking to OP_LFGCommand Comment Processing

**Michael Cook (mackal)** [Bug Fix] Fix use-after-free corruption with some DB calls (#1335)

**Michael Cook (mackal)** [Bug Fix] Misc Bard Song Fixes (#1317)

**Michael Cook (mackal)** [Cleanup] Nuke Make/AppendAnyLenString (#1251)

**Michael Cook (mackal)** [Cleanup] Only link Lua with zone (#1288)

**Michael Cook (mackal)** [Cleanup] use std::make_unique (#1259)

**Michael Cook (mackal)** [Fix] Clean up Filtered/MessageString functions (#1311)

**Michael Cook (mackal)** [Lua/Cmake] Prefer LuaJIT over normal Lua (#1235)

**Michael Cook (mackal)** [Rule] Add a rule to disable the Pet Resist buff (#1337)

**Michael Cook (mackal)** [Strings] Split String Optimizations (#1325)

**Michael Cook (mackal)** zlib-ng1.dll ends up in a different path (#1268)

**Paul Coene** #grid delete was deleting the grids everywhere (#1346)

**Paul Coene** Added RACE_BOAT_533 to IsBoat() (#1154)

**Paul Coene** Client tracks pet sit/stand - force new pets to stand rather than use client (#1155)

**Paul Coene** Fix calls to GetSafePoints to not pass null_ptr as zonename (#1336)

**Paul Coene** Prevent client update while on boat if boat turning (#1343)

**Paul Coene** Remove the extra erroneous message (DoT landing message) at mob death if mob dies of DoT. (#1138)

**Paul Coene** Remove unneeded calls to DoAnim() for spells/bardsong (#1290)

**Paul Coene** [Boats] Fix x/y offsets from client to reflect EQ x/y instead of boat heading… (#1296)

**Paul Coene** [Bug Fix] Add debugging and fix edge case where no target for aggro mob (#1344)

**Paul Coene** [Bug] Fix ignore_primary_assist. (#1323)

**Paul Coene** [Feature] Allow any spawn2 spawned mob to path while zone is idle if new flag is set. (#1339)

**Peter Rigby** [Fix] Moved assigning of AISpellVar variables before AI_Start() so that any values that override the rule values will not be ignored (#1321)

**RoTPvP** Added a check to stop Bard song for Mezz/Stun (#1319)

**Thalic** Minor ortographic corrections of ruletypes.h (#1147)

**Thalix** Minor ruletypes.h cleanup (#1306)

**Thalix** Update command.cpp (#1289)

**Thalix** [Crash] Bugfix for zone crash caused by #flymode -1 (#1291)

**TurmoilToad** Add category tags for Object methods. (#1232)

**TurmoilToad** Add category tags for corpse methods (#1234)

**TurmoilToad** Add category tags to new client methods. (#1233)

**TurmoilToad** Update perl_questitem.cpp (#1227)

**TurmoilToad** [Quest API] Perl Client Annotations (#1224)

**TurmoilToad** [Quest API] Perl Door Annotations (#1241)

**TurmoilToad** [Quest API] Perl Entity List Annotations (#1243)

**TurmoilToad** [Quest API] Perl Group Annotations (#1261)

**TurmoilToad** [Quest API] Perl Hate Entry Annotations (#1244)

**TurmoilToad** [Quest API] Perl Mob Annotations (#1258)

**TurmoilToad** [Quest API] Perl NPC Annotations (#1245)

**TurmoilToad** [Quest API] Perl Raid Annotations (#1226)

**hg** Add missing includes to fix windows compile (#1314)

**hg** Throttle auto expedition leader changes (#1293)

**hg** [Dynamic Zones] Rename dynamic zone structs (#1327)

**hg** [Expeditions] Cleanup client dz safe return methods (#1300)

**hg** [Expeditions] Create common dz abstract class (#1312)

**hg** [Expeditions] Decouple dz updates from expeditions (#1303)

**hg** [Expeditions] Let dz process its expired state (#1310)

**hg** [Expeditions] Refactor expedition caching (#1315)

**hg** [Expeditions] Refactor expedition requests (#1301)

**hg** [Expeditions] Store description and leader name on dz (#1294)

**hg** [Expeditions] Track DZ member status in world (#1341)

**hg** [Expeditions] [Quest API] Add expedition IsLocked to Quest API (#1292)

**neckkola** Added new Perl/LUA GetSpellIDByBookSlot (#1151)

**splose** [Rules] Add rule 'GM:MinStatusToBypassLockedServer' (#1330)

**splose** add quest::get_spell_level(uint16 spell_id, uint8 class_id) (#1295)

**splose** setting spawn2.version to -1 will now properly spawn mobs in all zone versions (#1299)

## 1/25/2021¶

**Kinglykrab**

- Add quest::message(color, message) to Perl.

- Add quest::whisper(message) to Perl.

- Add $client->HasDisciplineLearned(spell_id) to Perl.

- Add eq.message(color, message) to Lua.

- Add eq.whisper(message) to Lua.

- Add client:HasDisciplineLearned(spell_id) to Lua.

- Add 4 new special attacks to Perl and Lua.

- IMMUNE_DAMAGE_CLIENT (47)

Immune to all damage except NPC damage.

- IMMUNE_DAMAGE_NPC (48)

Immune to all damage except Client damage.

- IMMUNE_AGGRO_CLIENT (49)

Immune to aggro by a Client.

- IMMUNE_AGGRO_NPC (50)

Immune to aggro by an NPC, clients must attack directly to gain aggro, allows pet only boss mechanics and stuff.

## ⅓/2021¶

#### Kinglykrab¶

- Added $client->Fling() to Perl.

- Added $client->SetEbonCrystals() to Perl.

- Added $client->SetRadiantCrystals() to Perl.

- Added client:GetTargetRingX() to Lua.

- Added client:GetTargetRingY() to Lua.

- Added client:GetTargetRingZ() to Lua.

- Added client:Fling() to Lua.

- Added client:SetEbonCrystals() to Lua.

- Added client:SetRadiantCrystals() to Lua.

---

## 2022

*Source: changelog/server/2022/index.html*

# 2022¶

## Februrary - October¶

**Akkadius** [Crash] Fix reload crashes 2022-09-29

**Michael Cook (mackal)** eqlaunch wasn't loading paths (#2461) 2022-09-29

**Akkadius** [Hotfix] Fix lua mod load path 2022-09-29

**Akkadius** [Logging] Remove loginserver unhandled error (#2458) 2022-09-28

**Kinglykrab** [Tasks] Use zone currencies instead of hard-coded enum. (#2459) 2022-09-28

**Akkadius** [Crash] Websocket Crash fix race when fetching log categories (#2456) 2022-09-28

**Aeadoin** [Feature] Change Lifetap Emotes to be filterable. (#2454) 2022-09-28

**Akkadius** [Crash] Fix spawn race condition shown by #repop (#2455) 2022-09-28

**Akkadius** [Database] Add fallback migration for logsys columns (#2457) 2022-09-28

**Akkadius** [Hotfix] Force collation on conversion script 2022-09-28

**Akkadius** [Logging] Add stack trace in code paths that shouldn't occur (#2453) 2022-09-28

**Akkadius** [File Paths] Implement Path Manager (#2440) 2022-09-28

**Akkadius** [Logging] Netcode Logging Unify (#2443) 2022-09-28

**Akkadius** [World CLI] Refactor world CLI to be easier to reason about (#2441) 2022-09-28

**Akkadius** [Library] Bump httplib to 0.11.2 (#2442) 2022-09-28

**Kinglykrab** [Quest API] Add GetGMStatus() to Perl/Lua. (#2448) 2022-09-28

**Kinglykrab** [Quest API] Add Merchant Events to Perl/Lua. (#2452) 2022-09-28

**hg** [Tasks] Schema simplification (#2449) 2022-09-28

**JJ** [Database Updates] Typo in manifest 9207 (#2451) 2022-09-27

**Aeadoin** [Bug Fix] Fix Swarm Pet Flurry/Rampages Messages (#2444) 2022-09-25

**Akkadius** [eqemu_server.pl] Remove non-working fetch_latest_windows_binaries() (#2445) 2022-09-25

**Akkadius** [Command] Fix #copycharacter command crash (#2446) 2022-09-25

**Aeadoin** [Feature] Allow Focus Effects to be Filtered out. (#2447) 2022-09-25

**Michael Cook (mackal)** Define is _WINDOWS not WINDOWS (#2439) 2022-09-21

**hg** [Quest API] Let HasQuestSub check encounters (#2435) 2022-09-20

**Aeadoin** [Feature] Add Type 49545 to Spell Resistrictions (#2436) 2022-09-20

**Aeadoin** [Bug Fix] Fix Spellinfo Command to work with SpellIDs above int16 (#2437) 2022-09-20

**hg** [Tasks] Let task reward find free bag slots (#2431) 2022-09-18

**Akkadius** [Pathing] Fix pathing z-correctness for certain models (#2430) 2022-09-11

**Aeadoin** [Feature] Update HateMod used by SPA 114 to Int32. (#2428) 2022-09-08

**hg** [Tasks] Add rule to update multiple task elements (#2427) 2022-09-06

**hg** (github-desktop-hgtw/master) [Commands] Make #damage require a target (#2426) 2022-09-05

**Michael Cook (mackal)** I guess we'll go plural (#2425) 2022-09-05

**Akkadius** [Hotfix] Add Bazaar portal discs to SQL 2022-09-05

**Akkadius** [Zone Points] Fix zone point heading data (#2415) 2022-09-05

**Akkadius** [Doors] Fix door target zone heading data (#2414) 2022-09-05

**Akkadius** [Character Starting Points] Fix headings data (#2413) 2022-09-05

**Akkadius** [Hotfix] Faction associations file naming / lock consistency 2022-09-05

**Michael Cook (mackal)** Clang was complaining about these (#2421) 2022-09-03

**hg** [Tasks] Only allow shared task completion once (#2422) 2022-09-03

**hg** [Tasks] Make Task Selector Cooldown Optional (#2420) 2022-09-03

**Michael Cook (mackal)** [Bug Fix] Shared Memory Faction Association Typo (#2419) 2022-09-03

**Michael Cook (mackal)** [Cleanup] Rework Lua QuestReward to not use try/catch blocks (#2417) 2022-09-03

**Kinglykrab** [NPC Scaling] Recalculate Skills and Reload Spells on Level Change (#2416) 2022-09-03

**Michael Cook (mackal)** Unsure how this seding messed up (#2418) 2022-09-03

**Michael Cook (mackal)** [Feature] Faction Association (#2408) 2022-09-03

**hg** [Tasks] Change zone task data container (#2410) 2022-09-03

**Akkadius** (akkadius/heading-fix-doors-data) [Zoning] Fix zoning logic issues (#2412) 2022-09-03

**hg** [Bug Fix] Avoid erase in discord queue range loop (#2411) 2022-09-02

**hg** [Bug Fix] Fix memory leak in ucs (#2409) 2022-09-02

**hg** [Tasks] Tweak task update messages (#2406) 2022-09-02

**hg** [Tasks] Remove delivered task items from trades (#2405) 2022-09-02

**hg** [Zone] Add missing safe_heading assignment (#2407) 2022-09-02

**hg** [Tasks] Replace task goals with explicit fields (#2402) 2022-09-01

**Michael Cook (mackal)** [Bug Fix] Resolve logic error in Raid::QueueClients (#2404) 2022-09-01

**Akkadius** [Code Cleanup] Zone Data Loading Refactor (#2388) 2022-09-01

**Michael Cook (mackal)** Fix issues with Client::SetHideMe (#2403) 2022-09-01

**Michael Cook (mackal)** [Repositories] Add more precise types to repository generator (#2391) 2022-08-31

**Kinglykrab** [Commands] Add #findrecipe and #viewrecipe Commands. (#2401) 2022-08-31

**Michael** [Bug] Loot Drop Randomization adjustment (#2368) 2022-08-31

**Aeadoin** [Feature] Implement Heroic Strikethrough to NPCs (#2395) 2022-08-31

**Michael Cook (mackal)** [Utility] Add std::string_view overloads for std::from_chars (#2392) 2022-08-31

**Akkadius** [Zone] Fix and simplify zone shutdown logic (#2390) 2022-08-30

**Michael Cook (mackal)** Use macro to generate correct format specifier (#2400) 2022-08-28

**hg** [Bug Fix] Fix loading world shared task state (#2398) 2022-08-28

**Kinglykrab** [Quest API] Allow CreateInstance to be used without a Client initiator. (#2399) 2022-08-28

**Kinglykrab** [Quest API] Add Recipe Methods (#2393) 2022-08-23

**Michael Cook (mackal)** [Manifest] Its not_empty not notempty (#2394) 2022-08-22

**Kinglykrab** [Bug Fix] Fix Silent Saylinks Sending Message to Others. (#2389) 2022-08-21

**Akkadius** [Expansions] Zone expansion consistency changes (#2380) 2022-08-21

**Kinglykrab** [Feature] Add Guild Chat to Console. (#2387) 2022-08-21

**hg** [Tasks] Implement task activity prerequisites (#2374) 2022-08-21

**Kinglykrab** [Bug Fix] Fix Duplicate Silent Saylink Messages (#2386) 2022-08-21

**Akkadius** [Repository] Modernize character recipe list (#2385) 2022-08-21

**Akkadius** [Tasks] Data validation for zone_version (#2381) 2022-08-21

**Aeadoin** [Feature] Change Mana Costs to use Signed Int (#2384) 2022-08-21

**Kinglykrab** [Bug Fix] Fix Strings::Money Missing Conditions. (#2383) 2022-08-21

**Michael Cook (mackal)** Update CURRENT_BINARY_DATABASE_VERSION (#2382) 2022-08-20

**Kinglykrab** [Quest API] Add Goto Player Teleport Methods. (#2379) 2022-08-20

**Kinglykrab** [Commands] Command Status Reload and Helper Method (#2377) 2022-08-20

**Kinglykrab** [Feature] Instance Version Specific Experience Modifiers (#2376) 2022-08-20

**Akkadius** [Loot] Add #lootsim (Loot Simulator) command (#2375) 2022-08-20

**Kinglykrab** [Bug Fix] Fix Bot Group Loading (#2366) 2022-08-20

**Michael Cook (mackal)** Fix issue with trap auras casting on caster (#2378) 2022-08-18

**Kinglykrab** [Saylinks] Convert all GM Command Saylinks to Silent Saylinks. (#2373) 2022-08-13

**Akkadius** [Saylinks] Add Silent helper (#2372) 2022-08-13

**Michael** [Bug] UINT32 EmoteID (#2369) 2022-08-13

**Akkadius** [Repositories] Add GetMaxId, Count (#2371) 2022-08-13

**Akkadius** [Doors] Improvements to door manipulation (#2370) 2022-08-13

**Kinglykrab** [Quest API] Add GetSkillDmgAmt() to Perl. (#2365) 2022-08-10

**Aeadoin** [Feature] Change GetSkillDmgAmt to int32 (#2364) 2022-08-09

**Kinglykrab** [Rules] Add Rule to Enable Tells with #hideme (#2358) 2022-08-04

**Akkadius** [Hotfix] Remove expansion field from account for those who have it (#2357) 2022-08-01

**hg** [Tasks] Add task accept packet validation (#2354) 2022-07-31

**hg** [Quest API] Fix lua task selector count when over max (#2353) 2022-07-31

**Kinglykrab** [Typo] Remove CanTradeFVNoDropItem() Duplicate (#2352) 2022-07-31

**hg** [Tasks] Make #task reloadall not quit shared tasks (#2351) 2022-07-31

**Kinglykrab** [Quest API] Add GetBotItem() and GetBotItemIDBySlot() to Perl/Lua. (#2350) 2022-07-31

**Michael Cook (mackal)** [Code Cleanup] Resolve some warnings in loginserver/world_server.cpp (#2347) 2022-07-31

**hg** [Shared Tasks] Fix shared task message target (#2349) 2022-07-31

**hg** [Shared Tasks] Avoid erasing shared tasks while iterating (#2348) 2022-07-31

**Akkadius** [Hotfix] Fix potential race for crash dumps (Linux) 2022-07-31

**Akkadius** [Hotfix] SQL Update 2022-07-31

**Michael Cook (mackal)** [Bug Fix] Limit merchant temp item list to zone and instance (#2346) 2022-07-30

**hg** [Dynamic Zones] Implement dz templates (#2345) 2022-07-30

**hg** [Tasks] Use dz switch id for task touch events (#2344) 2022-07-30

**hg** [Dynamic Zones] Implement dz switch id (#2343) 2022-07-30

**hg** [Shared Tasks] Enforce task reqs on player removal (#2342) 2022-07-30

**hg** [Shared Tasks] Cleanup shared task request and remove (#2341) 2022-07-30

**hg** [Shared Tasks] Implement task timer groups (#2340) 2022-07-30

**hg** [Shared Tasks] Implement Activity Locking (#2339) 2022-07-30

**Michael** [Feature] GM State Change Persistance (#2328) 2022-07-30

**hg** [Quest API] Use Floating Point for CameraEffect Intensity (#2337) 2022-07-30

**hg** [Tasks] Send Client Message for All Solo Task Updates (#2336) 2022-07-30

**hg** [Saylinks] Inject Saylinks in MessageClose API (#2335) 2022-07-30

**Kinglykrab** [Quest API] Add IsRareSpawn() to Perl/Lua. (#2338) 2022-07-30

**Paul Coene** [Roambox] Improve Path Finding (#2324) 2022-07-30

**Michael Cook (mackal)** [Feature] NPCs with bows and arrows do ranged attacks (#2322) 2022-07-30

**Michael** [Rules] Add adjustment for zone forage. (#2330) 2022-07-30

**Aeadoin** [Feature] Change mana_used to int32 (#2321) 2022-07-30

**hg** [Tasks] Support Raw NPC Names in Task Goal List (#2333) 2022-07-30

**hg** [Tasks] Use CashReward for Tasks (#2332) 2022-07-30

**Trent** [Rules] Add Keep Level on Death (#2319) 2022-07-30

**hg** [Tasks] Add Task Reward Points Field (#2317) 2022-07-30

**Quintinon** [Rules] Update logic checks everywhere for FVNoDropFlag. (#2179) 2022-07-30

**Kinglykrab** [Rules] Add Rule to allow Assassinate on non-Humanoid body types. (#2331) 2022-07-29

**Kinglykrab** [Rules] Add Rule to allow Headshots on non-Humanoid body types. (#2329) 2022-07-29

**Akkadius** [Hotfix] Shared Memory Protection Fixes 2022-07-27

**Michael Cook (mackal)** [CPP] Update C++ standard to C++17 (#2308) 2022-07-27

**Quintinon** [Memory Leak] This mem leak was missed due to merge issues in the previous PRs. (#2314) 2022-07-27

**hg** [Quest API] Allow scripts to prevent door click (#2327) 2022-07-27

**hg** [Netcode] Adjust first packet for compress flag (#2326) 2022-07-27

**Akkadius** [Client] Fix IsMoving for Client (#2318) 2022-07-27

**hg** [Saylinks] Refactor saylink injection (#2315) 2022-07-27

**Akkadius** [CI] Hook tests back up (#2316) 2022-07-27

**Akkadius** [Content Filter] Fix Runtime Filtering When Set to -1 (All) (#2313) 2022-07-27

**Paul Coene** Fix bestz to work on client or target. (#2323) 2022-07-23

**hg** [Tasks] Reward clients on shared task completion sync (#2306) 2022-07-16

**Akkadius** [Hotfix] fix manifest 2022-07-16

**Michael Cook (mackal)** [Feature] Implement OP_CashReward (#2307) 2022-07-14

**KimLS** Fix windows build for strings.cpp 2022-07-14

**Michael Cook (mackal)** [Bug Fix] Remove StringUtilTest::EscapeStringMemoryTest (#2310) 2022-07-14

**Akkadius** [Tasks] Zone Version Matching (#2303) 2022-07-14

**Akkadius** [Zone] Deprecate Zone `expansion` Field (#2297) 2022-07-14

**Akkadius** [World] World Bootup Consolidation (#2294) 2022-07-14

**Akkadius** [Hotfix] Fix merge issue 2022-07-14

**Paul Coene** [DoT Messages] Add DoT messages for mob->PC casts, fixed others to use correct str. (#2289) 2022-07-14

**neckkola** [Login] Added OP_ExpansionPacketData for RoF2 and update payload for Titanium (#2186) 2022-07-14

**hg** [Tasks] Apply full duration mission replay timers (#2299) 2022-07-14

**Akkadius** [Logs] #logs list Improvements (#2302) 2022-07-14

**Akkadius** [Code Cleanup] Remove Unused EQEMU_DEPOP_INVALIDATES_CACHE (#2292) 2022-07-14

**Akkadius** [World] Add more descriptive LS auth erroring (#2293) 2022-07-14

**Akkadius** [Crash] Linux Crash Dump Improvements (#2296) 2022-07-14

**hg** [Tasks] Place task item rewards in free slots (#2300) 2022-07-14

**hg** [Tasks] Fix #task command crash on bad input (#2301) 2022-07-14

**Akkadius** [Code Cleanup] Remove use of bzero since it is deprecated for memset (#2295) 2022-07-14

**Akkadius** [Logs] Fix GMSay Log Regression (#2298) 2022-07-14

**Kinglykrab** [Validation] Add Size Validation to #hotfix. (#2304) 2022-07-14

**Akkadius** [Strings] Refactor Strings Usage (#2305) 2022-07-14

**hg** [Quest API] Fix missing arg in perl set_proximity (#2291) 2022-07-08

**Michael Cook (mackal)** Fix string comparison issues in Client::SendZoneFlagInfo (#2290) 2022-07-08

**Akkadius** [Hotfix] Windows compile fix take 3 (final) 2022-07-06

**Akkadius** [Hotfix] Possible windows compile fix take 2 2022-07-06

**Akkadius** [Hotfix] Possible windows compile fix 2022-07-06

**Akkadius** [Server Maintenance Script] Improvements to Downloading - Empty File Detection (#2282) 2022-07-06

**Akkadius** [Backups] Use World CLI for Database Backups (#2286) 2022-07-06

**Akkadius** [Server] Configuration Issues Checker (LAN Detection) (#2283) 2022-07-06

**Akkadius** [Logging] Table Injection - Member Variable Cleanup (#2281) 2022-07-06

**Paul Coene** [Bug Fix] NPCs were getting weapon proc added twice (#2277) 2022-07-06

**Kinglykrab** [Quest API] Perl Doors Fix. (#2288) 2022-07-05

**Kinglykrab** [Quest API] Add missing methods/package.adds to Perl API. (#2287) 2022-07-05

**Kinglykrab** [Bug Fix] Fix Spell Bucket and Spell Global Logic Checks. (#2285) 2022-07-04

**hg** [Quest API] Use binding library for perl apis (#2216) 2022-07-03

**Michael** [Cleanup] Update to EQEmu #2253 to clean up message strings (#2279) 2022-07-03

**Akkadius** [Hotfix] Move discord_webhooks to state tables because we don't want webhooks being exported 2022-07-03

**Akkadius** [Hotfix] Add discord_webhooks to server tables 2022-07-03

**Quintinon** [Bug Fix] Fix miscellaneous memory leaks related to EQApplicationPacket and it's pBuffer (#2262) 2022-07-02

**Paul Coene** [Feature] Add humanoid and non-wielded restrictions to pick pocket (#2276) 2022-07-02

**Quintinon** [Bug Fix] Handle memory leaks from return value of Client::GetTraderItems() (#2266) 2022-07-02

**Quintinon** [Cleanup] Fix unintended copies in zone/zonedb.cpp by changing auto to auto& (#2271) 2022-07-02

**Michael** [Feature] Bind Wound and Forage while mounted. (#2257) 2022-07-02

**Michael** [Bug Fix] Add required distance to CoTH before aggro wipe (#2253) 2022-07-02

**Kinglykrab** [Telnet] Add guildsay to console commands and Guild Channel to QueueMessage. (#2263) 2022-07-02

**Quintinon** [Cleanup] Cleanup code smells and compiler warnings in common/shareddb (#2270) 2022-07-02

**Kinglykrab** [Bots] Cleanup ^inventoryremove, ^inventorylist, and ^list Commands and bot groups. (#2273) 2022-07-02

**Paul Coene** [Fix] Boats should never get FixZ'd (#2246) 2022-07-02

**Kinglykrab** [Quest API] Add TrackNPC to Perl/Lua. (#2272) 2022-06-29

**hg** [Bug Fix] Fix empty spawned merchants (#2275) 2022-06-28

**Kinglykrab** [Spells] Target's Target Combat Range Rule (#2274) 2022-06-24

**Quintinon** [Bug Fix] Delete NpcType Struct returned by Bot::CreateDefaultNPCTypeStructForBot() when unused (#2267) 2022-06-18

**Quintinon** [Bug Fix] Free return value of ZoneDatabase::LoadTraderItemWithCharges() (#2264) 2022-06-18

**Quintinon** [Bug Fix] Correct type signed/unsigned int when reading item from database in shareddb (#2269) 2022-06-15

**Kinglykrab** [Loot] Remove unnecessary loot error messages. (#2261) 2022-06-12

**Akkadius** [Hotfix] Correct database call to point to the content_db connection 2022-06-12

**Michael** [Bug Fix] Tradeskill Item 0 Error (#2256) 2022-06-10

**Michael** [Bug Fix] Tradeskill Autocombine MinSkill (#2260) 2022-06-10

**Michael** [Quest API] Expand SaveGuardSpot (#2258) 2022-06-10

**Kinglykrab** [Bug Fix] Stop skill ups on Charmed NPCs. (#2249) 2022-06-09

**Akkadius** [Discord Integration] Native Discord Integration (#2140) 2022-06-09

**hg** [Bug Fix] Fix stack leaks in Lua events #2254 2022-06-09

**Akkadius** [Hotfix] Flipped positive / negative values for legacy_combat.lua 2022-06-09

**Kinglykrab** [Messages] Convert messages from Spells to FocusEffect where necessary. (#2243) 2022-06-08

**Michael Cook (mackal)** Fix memory leaks found by Quint (#2248) 2022-06-07

**Michael** [Bug Fix] Bazaar Search MYSQL Error (#2252) 2022-06-07

**Michael** [Bug Fix] Hacker_Str was causing sql errors - Non Escaped (#2251) 2022-06-07

**Kinglykrab** [Rules] Add Frontal Stun Immunity Rules. (#2217) 2022-06-06

**Quintinon** [Bug Fix] Fix two invalid data accesses in zone/client.cpp (#2238) 2022-06-06

**Kinglykrab** [Bug Fix] Fix issue where #advnpcspawn addspawn does not add spawn sometimes. (#2247) 2022-06-06

**Michael Cook (mackal)** [Memory Leak] Fix leak of CommandRecords in commandlist (#2244) 2022-06-06

**Kinglykrab** [Commands] Add BestZ and Region Data to #loc (#2245) 2022-06-05

**Kinglykrab** [Rules] Add Rule to Disable NPC Last Names. (#2227) 2022-06-04

**Kinglykrab** [Cleanup] Cleanup Haste references and Lua API calls for unsigned to signed. (#2240) 2022-06-04

**Kinglykrab** [Cleanup] Add Validation to varchar number item fields. (#2241) 2022-06-04

**Kinglykrab** [Commands] Cleanup #spawneditmass Command. (#2229) 2022-06-04

**Quintinon** [Bug Fix] Correct (probably) unintended bitwise AND instead of logical AND (#2239) 2022-06-01

**Quintinon** [Combat] Fix shield calculation (#2234) 2022-06-01

**Quintinon** [Code Cleanup] Resharper Warnings (#2235) 2022-06-01

**Kinglykrab** [Rules] Add Rules to disable various item functionalities and cleanup data types. (#2225) 2022-06-01

**Kinglykrab** [Bug Fix] Fix MovePC in #zone and #zoneinstance Commands. (#2236) 2022-06-01

**Kinglykrab** [Commands] Cleanup #date Command. (#2228) 2022-06-01

**Akkadius** [Loading] Zone Version Loading Fixes (#2233) 2022-05-31

**Akkadius** [Bug Fix] Adjustment for nullptr crash (#2232) 2022-05-31

**Akkadius** [Bug Fix] Fix null pointer crash on zones that have not booted a zone yet with #reload commands or anything that calls GetZoneDescription (#2231) 2022-05-31

**Akkadius** [Tasks] Fix validation loading (#2230) 2022-05-31

**titanium-forever** [Database Backup] Enable database dump of bot data (#2221) 2022-06-01

**Kinglykrab** [Quest API] Fix parameters in some Perl worldwide methods. (#2224) 2022-05-31

**Kinglykrab** [Bug Fix] Fix Legacy Combat Lua Script (#2226) 2022-05-30

**Kinglykrab** [Hot Fix] Fix Linux compile due to missing include. (#2223) 2022-05-30

**Kinglykrab** [INT64] Further int64 cleanup in Perl SetHP() and GetSpellHPBonuses() in Perl/Lua. (#2222) 2022-05-29

**Kinglykrab** [Commands] Cleanup #nudge Command. (#2220) 2022-05-29

**Kinglykrab** [Commands] Cleanup #emptyinventory Command. (#2219) 2022-05-29

**Kinglykrab** [INT64] Fix int64 for OOC Regen and GetHP(), GetMaxHP(), GetItemHPBonuses() in Perl/Lua. (#2218) 2022-05-29

**Kinglykrab** [Money Messages] Cleanup quest::givecash(), split, and task reward messages. (#2205) 2022-05-29

**Kinglykrab** [Cleanup] Cleanup spell and max level bucket logic. (#2181) 2022-05-28

**Kinglykrab** [Commands] Cleanup #npcedit, #lastname, #title, and #titlesuffix Commands. (#2215) 2022-05-28

**Kinglykrab** [Bug Fix] Fix IP Exemptions. (#2189) 2022-05-27

**Paul Coene** [Bug Fix] IsDamage test for lifetap was not complete. (#2213) 2022-05-27

**Kinglykrab** [Commands] Cleanup #findaliases and #help Commands. (#2204) 2022-05-27

**Kinglykrab** [Commands] Cleanup #zone and #zoneinstance Commands. (#2202) 2022-05-27

**Kinglykrab** [Rules] Add Spells:BuffsFadeOnDeath. (#2200) 2022-05-27

**Kinglykrab** [Commands] Cleanup #findclass and #findrace Commands. (#2211) 2022-05-27

**Kinglykrab** [Commands] Cleanup #corpsefix Command. (#2197) 2022-05-27

**Kinglykrab** [Commands] Cleanup #level Command. (#2203) 2022-05-27

**Kinglykrab** [Rules] Add Spells:IllusionsAlwaysPersist. (#2199) 2022-05-27

**Kinglykrab** [Regen] Fix possible overflow in CalcHPRegenCap(). (#2185) 2022-05-27

**Kinglykrab** [Commands] Cleanup #oocmute Command. (#2191) 2022-05-27

**Michael Cook (mackal)** Revert "[Aggro] Rooted mobs will add other hated targets to Hate list (#2180)" (#2214) 2022-05-27

**Paul Coene** [Aggro] Rooted mobs will add other hated targets to Hate list (#2180) 2022-05-27

**titanium-forever** Create user directory during account creation to ensure default files are copied to profile from /etc/skel (#2176) 2022-05-27

**Kinglykrab** [Bug Fix] Fix bot compile locking client on server enter. (#2210) 2022-05-26

**Kinglykrab** [Commands] Fix typos in #ban and #ipban Commands. (#2209) 2022-05-25

**Chris** [Bug Fix] Blocked spells max spell id increased (#2207) 2022-05-25

**Kinglykrab** [Bug Fix] Fix HP Regen Per Second. (#2206) 2022-05-25

**Kinglykrab** [Bot Commands] Use Account Status Constants. (#2201) 2022-05-23

**Kinglykrab** [Commands] Remove unused/broken #deletegraveyard and #setgraveyard Commands. (#2198) 2022-05-23

**Kinglykrab** [Commands] Cleanup #motd Command. (#2190) 2022-05-23

**Kinglykrab** [Rules] Cleanup all unused rules. (#2184) 2022-05-23

**Kinglykrab** [Commands] #bind Typo. (#2196) 2022-05-22

**Kinglykrab** [Commands] Cleanup #kill Command. (#2195) 2022-05-22

**Kinglykrab** [Bug Fix] Fix bot guild removal. (#2194) 2022-05-22

**Kinglykrab** [Commands] Consolidate #lock and #unlock Commands into #serverlock. (#2193) 2022-05-22

**Akkadius** Schema consistency fixes (#2192) 2022-05-21

**Kinglykrab** [Cleanup] Move Client::Undye() to client.cpp from #path Command. (#2188) 2022-05-21

**Paul Coene** [Bug Fix] Fix duplicate and missing messages due to innate in spells (#2170) 2022-05-20

**Kinglykrab** [Titles] Cleanup titles, title suffix, and last name methods. (#2174) 2022-05-19

**Kinglykrab** [Quest API] Add CheckNameFilter to Perl/Lua. (#2175) 2022-05-19

**Kinglykrab** [Cleanup] Quest API push methods using invalid types. (#2172) 2022-05-15

**Kinglykrab** [Cleanup] Remove unused methods. (#2171) 2022-05-15

**hg** Save eyes in #npcedit featuresave (#2178) 2022-05-15

**Kinglykrab** [Quest API] Add TaskSelector to Perl/Lua. (#2177) 2022-05-15

**hg** [Opcode] Implement SetFace opcode (#2167) 2022-05-11

**Kinglykrab** [Quest API] Add GetHealAmount() and GetSpellDamage() to Perl/Lua. (#2165) 2022-05-11

**Kinglykrab** [Cleanup] Cleanup #kick message. (#2164) 2022-05-10

**Kinglykrab** [Hot Fix] Off by on in Merchant Loading. (#2166) 2022-05-10

**Kinglykrab** [Commands] #reload Command Overhaul. (#2162) 2022-05-10

**Akkadius** [int64] Hate Fixes (#2163) 2022-05-09

**Kinglykrab** [Merchants] Add Merchant Data Bucket capability. (#2160) 2022-05-09

**Kinglykrab** [Cleanup] Possible issues with variable/parameter name equality. (#2161) 2022-05-09

**Akkadius** [Hotfix] Fix regression caused by #2129 2022-05-09

**Michael Cook (mackal)** Fix out of bounds issues with SPA 288 (#2157) 2022-05-08

**Kinglykrab** [Bug FIx] Fix #repop Command. (#2159) 2022-05-08

**Kinglykrab** [Bug Fix] Make Perl TakeMoneyFromPP int64 (#2158) 2022-05-08

**Kinglykrab** [Bug Fix] Fix possible issue where variables have the same name. (#2156) 2022-05-08

**Akkadius** [int64] Windows Compile Fixes (#2155) 2022-05-07

**Kinglykrab** [Commands] Cleanup #cvs Command. (#2153) 2022-05-07

**Akkadius** [int64] Support for HP / Mana / End / Damage / Hate (#2091) 2022-05-07

**Kinglykrab** [Commands] Cleanup #ban, #ipban, #flag, #kick, #setlsinfo, and #setpass Commands. (#2104) 2022-05-07

**Akkadius** [UCS] Auto Client Reconnection (#2154) 2022-05-07

**Akkadius** [Hotfix] Fix DB version merge 2022-05-07

**Akkadius** [Tasks] Implement Task Goal Match List (#2097) 2022-05-07

**Kinglykrab** [Commands] Cleanup #time and #timezone Command. (#2147) 2022-05-07

**Kinglykrab** [Bug Fix] NPC::GetNPCStat has no default return. (#2150) 2022-05-07

**Kinglykrab** [Bug Fix] Lua GetBlockNextSpell() no return. (#2151) 2022-05-07

**Kinglykrab** [Commands] Cleanup #reloadzps Command. (#2129) 2022-05-07

**Kinglykrab** [Commands] Cleanup #reloadtraps Command. (#2126) 2022-05-06

**Kinglykrab** [Commands] Cleanup #reloadlevelmods Command. (#2122) 2022-05-06

**Kinglykrab** [Commands] Cleanup #npctype_cache Command. (#2109) 2022-05-06

**Kinglykrab** [Commands] Cleanup #npcspecialattk Command. (#2108) 2022-05-06

**Kinglykrab** [Commands] Cleanup #ucs Command. (#2149) 2022-05-06

**Kinglykrab** [Commands] Cleanup #reloadaa Command. (#2120) 2022-05-06

**Kinglykrab** [Commands] Cleanup #profanity Command. (#2113) 2022-05-06

**Kinglykrab** [Commands] Remove unused #bestz and #pf Commands. (#2112) 2022-05-06

**Kinglykrab** [Commands] Cleanup #makepet Command. (#2105) 2022-05-06

**Kinglykrab** [Commands] Cleanup #npcemote Command. (#2106) 2022-05-06

**Kinglykrab** [Commands] Cleanup #npcsay and #npcshout Commands. (#2107) 2022-05-06

**Kinglykrab** [Commands] Cleanup #npctypespawn Command. (#2110) 2022-05-06

**Kinglykrab** [Commands] Cleanup #reloadmerchants Command. (#2123) 2022-05-06

**Kinglykrab** [Commmands] Cleanup #questerrors Command. (#2116) 2022-05-06

**Kinglykrab** [Commands] Cleanup #randomizefeatures Command. (#2118) 2022-05-06

**Kinglykrab** [Commands] Cleanup #refreshgroup Command. (#2119) 2022-05-06

**Kinglykrab** [Commands] Cleanup #push Command. (#2114) 2022-05-06

**Kinglykrab** [Commands] Cleanup #qglobal Command. (#2115) 2022-05-06

**Kinglykrab** [Bug Fix] Resolve subroutine redefinition due to bot methods. (#2117) 2022-05-06

**Kinglykrab** [Commands] Cleanup #resetaa_timer Command. (#2131) 2022-05-06

**Kinglykrab** [Commands] Cleanup #revoke Command. (#2134) 2022-05-06

**Kinglykrab** [Commands] Cleanup #reloadallrules Command. (#2121) 2022-05-06

**Kinglykrab** [Commands] Cleanup #reloadperlexportsettings Command. (#2124) 2022-05-06

**Kinglykrab** [Commands] Cleanup #reloadtitles Command. (#2125) 2022-05-06

**Kinglykrab** [Commands] Cleanup #reloadworld and #repop Command. (#2127) 2022-05-06

**Kinglykrab** [Commands] Cleanup #summonburiedplayercorpse Command. (#2146) 2022-05-06

**Kinglykrab** [Commands] Cleanup #trapinfo Command. (#2148) 2022-05-06

**Kinglykrab** [Commands] Cleanup #reloadrulesworld Command. (#2128) 2022-05-06

**Kinglykrab** [Commands] Cleanup #reloadstatic Command. (#2130) 2022-05-06

**Kinglykrab** [Commands] Cleanup #resetaa Command. (#2132) 2022-05-06

**Kinglykrab** [Commands] Cleanup #sensetrap Command. (#2137) 2022-05-06

**Kinglykrab** [Commands] Cleanup #serverinfo Command. (#2138) 2022-05-06

**Kinglykrab** [Commands] Cleanup #resetdisc_timer Command. (#2133) 2022-05-06

**Kinglykrab** [Commands] Cleanup #roambox Command. (#2135) 2022-05-06

**Kinglykrab** [Commands] Cleanup #save Command. (#2136) 2022-05-06

**Kinglykrab** [Commands] Cleanup #serverrules Command. (#2139) 2022-05-06

**Kinglykrab** [Commands] Cleanup #shownpcgloballoot and #showzonegloballoot Command. (#2141) 2022-05-06

**Kinglykrab** [Commands] Add #feature Command. (#2142) 2022-05-06

**Kinglykrab** [Commands] Cleanup #spawnfix Command. (#2143) 2022-05-06

**Kinglykrab** [Commands] Cleanup #summon Command. (#2145) 2022-05-06

**Kinglykrab** [Commands] Cleanup #gassign Command. (#2101) 2022-05-06

**Kinglykrab** [Commands] Cleanup #spawnstatus Command. (#2144) 2022-05-06

**Kinglykrab** [Commands] Cleanup #attack Command. (#2103) 2022-05-03

**Kinglykrab** [Commands] Cleanup #freeze and #unfreeze Commands. (#2102) 2022-05-03

**Kinglykrab** [Commands] Cleanup #getvariable Command. (#2100) 2022-05-03

**Kinglykrab** [Quest API] Expand Bot quest API functionality. (#2096) 2022-05-03

**Kinglykrab** [Quest API] Perl Money Fixes. (#2098) 2022-05-03

**Kinglykrab** [Quest API] Add commify to Perl/Lua. (#2099) 2022-05-03

**Paul Coene** [Combat] Fix Frenzy vs opponents immune to non-magic (#2095) 2022-05-02

**hg** [Repository] Cast floats to avoid grid repository warnings (#2094) 2022-05-01

**Akkadius** [Drone] Speed up drone builds (#2092) 2022-05-01

**hg** Remove already defined method (#2093) 2022-05-01

**Kinglykrab** [Commands] Add additional #peqzone functionality. (#2085) 2022-05-01

**Akkadius** [Combat] Basic Combat Recording (#2090) 2022-05-01

**Kinglykrab** [Bots] Bot::PerformTradeWithClient Cleanup. (#2084) 2022-05-01

**Akkadius** [Refactor] Simplify NPC Loading (#2087) 2022-05-01

**Akkadius** [Compile] Decrease build times using unity build strategy (#2089) 2022-05-01

**KayenEQ** [Spells] Update to target types Beam and Cone to ignore invalid targets. (#2080) 2022-05-01

**Akkadius** [Logging] Update BUILD_LOGGING=false Blank Aliases (#2083) 2022-05-01

**Akkadius** [Regen] Implement Per Second HP Regen for NPCs (#2086) 2022-05-01

**Akkadius** [Code Cleanup] Remove this-> in code where its implied (#2088) 2022-05-01

**Kinglykrab** [Bots] Remove unused methods. (#2082) 2022-04-30

**Kinglykrab** [Quest API] Add multiple inventory method short hands to client. (#2078) 2022-04-30

**Kinglykrab** [Bots] Fix ^dyearmor command math. (#2081) 2022-04-30

**Kinglykrab** [Quest API] Add AddPlatinum(), GetCarriedPlatinum() and TakePlatinum() to Perl/Lua. (#2079) 2022-04-30

**nytmyr** [Quest API] Add EVENT_SKILL_UP & EVENT_LANGUAGE_SKILL_UP to Perl/Lua (#2076) 2022-04-25

**cybernine186** Bug Fix for WorldServer::HandleMessage, CZUpdateType_NPC (#2074) 2022-04-21

**Paul Coene** [Bug Fix] Restore missing messages for lifetap and dmg spells. (#2057) 2022-04-13

**Kinglykrab** [Commands] Cleanup #task Command. (#2071) 2022-04-13

**KayenEQ** [Bug Fix] Blocked spells max spell id increased (#2073) 2022-04-13

**KayenEQ** [API] Methods for getting more information on quest timers. (#2060) 2022-04-13

**KayenEQ** [Bug Fix] Instrument Mods should not affect spells that change model size. (#2072) 2022-04-13

**Kinglykrab** [Quest API] Add GetBotListByCharacterID() to Perl/Lua. (#2069) 2022-04-02

**Paul Coene** [Bug Fix] Fix recipient sound (vtell) on non-player races (#2066) 2022-04-02

**Kinglykrab** [Bug Fix] Clear title/suffix bug fix. (#2068) 2022-04-02

**KayenEQ** [Bug Fix] Bard Invisible causing display issues. (#2067) 2022-04-01

**Kinglykrab** [Quest API] Add GetBotListByClientName(client_name) to Perl/Lua. (#2064) 2022-03-23

**Natedog2012** [Bug Fix] #peqzone no longer bypass Handle_OP_ZoneChange (#2063) 2022-03-19

**Paul Coene** [Bug Fix] Fix for being able to skill up on corspe. (#2058) 2022-03-19

**Paul Coene** [Bug Fix] manifest for db version 9176 had incorrect field name(#2062) 2022-03-19

**Natedog2012** [Bug Fix] Force NPCs to respect special ability 24 and 50 when set on player pets (#2059) 2022-03-15

**Paul Coene** [Logging] Fix log messages to final damage values (#2056) 2022-03-14

**Kinglykrab** [Bug Fix] Fix possible crash with zone name methods. (#2055) 2022-03-13

**Kinglykrab** [Quest API] Add AddItem() to Perl/Lua. (#2054) 2022-03-13

**KayenEQ** [API] GetNPCStat default better naming (#2053) 2022-03-12

**Kinglykrab** [Quest API] Allow EVENT_ZONE to be parsed as non-zero to prevent zoning. (#2052) 2022-03-12

**Kinglykrab** [Quest API] Add EVENT_CAST_ON exports to EVENT_CAST and EVENT_CAST_BEGIN. (#2051) 2022-03-12

**Kinglykrab** [Quest API] Export killed XYZH to EVENT_DEATH_ZONE in Perl. (#2050) 2022-03-12

**catapultam-habeo** [Bots] Update Bot Heal & Damage methods to more closely match Clients + Bugfixes (#2045) 2022-03-11

**Akkadius** [Repositories] Update repositories (#2040) 2022-03-11

**Akkadius** [Bug FIx] Saylink Collation Database Edge Case (#2039) 2022-03-11

**KayenEQ** [Bug Fix] #tune command various fixes (#2046) 2022-03-11

**KayenEQ** [API] GetNPCStat can now return default stat values. (#2048) 2022-03-11

**Kinglykrab** [Quest API] Add caster_id and caster_level export to EVENT_CAST_ON in Perl/Lua. (#2049) 2022-03-10

**Kinglykrab** [Bug Fix] Spell Buckets/Globals did not allow string-based values. (#2043) 2022-03-09

**KayenEQ** [API] Perl functions to set invulnerable to and modify environmental damage. (#2044) 2022-03-08

**KayenEQ** [Bug Fix] Invisible will display as dropped now on air pets when they attack. (#2042) 2022-03-07

**JJ** [Database] Update 2022_01_10_checksum_verification.sql (#2041) 2022-03-07

**KayenEQ** [Bug Fix] PR 2032 would lock client on casting fail as written (#2038) 2022-03-06

**Akkadius** [Command] Fix #killallnpcs from crashing (#2037) 2022-03-06

**Randy Girard** [Content Filtering] Updates contents flags to be checked at runtime. (#1940) 2022-03-06

**Akkadius** [Database] Add Primary ID Keys to Tables (#2036) 2022-03-06

**Paul Coene** [Feature] Client Checksum Verification (Resubmit old 1678) (#1922) 2022-03-06

**catapultam-habeo** [Feature] EQ2-style implied targeting for spells. (#2032) 2022-03-06

**Paul Coene** [AI] Spell Type (1024) InCombatBuff were spam casting (#2030) 2022-03-06

**catapultam-habeo** [Feature] Allow pets to zone with permanent (buffdurationformula 50) buffs to maintain them through zone transitions (#2035) 2022-03-06

**Paul Coene** [Bug Fix] Bandolier didn't recognize source weapon on cursor (#2026) 2022-03-06

**Paul Coene** [Bug Fix] Fixed several instances of incorrect comparision - & executes after == (#2025) 2022-03-06

**neckkola** [Bots] Fix bot spawn when bot id = char_id (#1984) 2022-03-06

**catapultam-habeo** [Bots] Apply Spells:IgnoreSpellDmgLvlRestriction to bots (#2024) 2022-03-06

**KayenEQ** [Bug Fix] Missing break (#2031) 2022-03-04

**Michael Cook (mackal)** Fix order of operations issues in worldshutdown command (#2029) 2022-03-04

**Kinglykrab** [Bug Fix] Objects::GetTiltX() and Objects::GetTiltY() Perl Croak Typos. (#2028) 2022-03-03

**Kinglykrab** [Bug Fix] Doors::GetSize() Perl Croak Typo. (#2027) 2022-03-03

**KayenEQ** [Spells] Fixes for numhits type 7 counter incrementing incorrectly. (#2022) 2022-03-01

**Kinglykrab** [Commands] Cleanup #worldwide command. (#2021) 2022-02-28

**catapultam-habeo** Rule to apply Spell Dmg and Heal Amount stats as a percentage instead of flat value. (#2017) 2022-02-28

**Kinglykrab** [Bug Fix] quest::MovePCInstance() Arguments Fix. (#2020) 2022-02-27

**Kinglykrab** [Bug Fix] Spell Buckets/Globals SQL Escape. (#2019) 2022-02-26

**KayenEQ** [Spells] SPA 79 SE_CurrentHPOnce now will check for focus, critical and partial resist checks, except for buffs. (#2018) 2022-02-24

**Kinglykrab** [Quest API] Add EVENT_EQUIP_ITEM_CLIENT and EVENT_UNEQUIP_ITEM_CLIENT to Perl/Lua. (#2015) 2022-02-22

**Akkadius** [GM Command] Fix Crash Issue and Validation with #zclip (#2014) 2022-02-21

**Kinglykrab** [Bug Fix] Alleviate some lag with crosszone/worldwide spell casting. (#2016) 2022-02-20

**KayenEQ** [Bug Fix] checking casting_spell_slot before its defined is bad (#2013) 2022-02-20

**KayenEQ** [API] perl added GetNPCStat(identifier) (#2012) 2022-02-20

**KayenEQ** [Spells] Bard songs from item clickies should not require components (#2011) 2022-02-18

**KayenEQ** [Bug Fix] Fix for castspell command (#2010) 2022-02-17

**Kinglykrab** [Commands] Bug fix for #logs command. (#2008) 2022-02-17

**KayenEQ** [API] Fix for SetBuffDuration function to check bard slots. (#2009) 2022-02-17

**Kinglykrab** [Quest API] Add GetRandomMob() and GetRandomNPC() to Perl/Lua. (#2006) 2022-02-17

**cybernine186** [Bug] Fixed trade items record log (#2003) 2022-02-16

**KayenEQ** [Spells] AE Duration effect (Rains) will now work with Target Ring and PBAE spells. (#2000) 2022-02-16

**Kinglykrab** [Commands] Cleanup #unscribespell Command. (#1998) 2022-02-16

**Kinglykrab** [Commands] Cleanup #untraindisc Command. (#1996) 2022-02-16

**KayenEQ** fix for meloday cast bar issue (#2005) 2022-02-15

**KayenEQ** invis updates (#2004) 2022-02-15

**KayenEQ** [API] Apply spells with custom buff durations and adjust existing spell buff durations. (#1997) 2022-02-15

**KayenEQ** Update bonuses.cpp (#2002) 2022-02-15

**KayenEQ** [Spells] Invisibility updates and rework (#1991) 2022-02-15

**KayenEQ** bug fix (#2001) 2022-02-15

**Kinglykrab** [Commands] Cleanup #showskills Command. (#1994) 2022-02-14

**Kinglykrab** [Commands] Cleanup #setskillall Command. (#1992) 2022-02-14

**KayenEQ** [Combat] /shield command "too far away message" (#1999) 2022-02-14

**KayenEQ** [Bug Fix] Edge case AA reset timer issue fixes (#1995) 2022-02-13

**KayenEQ** bot crash fix (#1993) 2022-02-13

**KimLS** Small change to order of a couple of files in zone cmakefile, added the gm commands to their own source group so they are cleanly separated in any IDEs cmake supports 2022-02-12

**KimLS** Extra extern c warning squash, XS macro expands to XS_EXTERNAL which under c++ expands to extern c 2022-02-11

**KimLS** What is this random semicoloned if, removed to silence warning 2022-02-11

**KimLS** Handle default case of GetDynamicZoneTypeName to silence warning 2022-02-11

**KimLS** Remove obsolete register spec on int to silence warning 2022-02-11

**KayenEQ** [Bug Fix] Fix for Bot command casting (#1990) 2022-02-12

**Kinglykrab** [Commands] Cleanup #ai Command. (#1980) 2022-02-11

**KayenEQ** [Spells] Fix for AA recast timers not resetting properly (#1989) 2022-02-11

**KayenEQ** revert completed (#1988) 2022-02-11

**KimLS** Fix for passing std::string to vsprintf 2022-02-11

**KayenEQ** group message (#1987) 2022-02-10

**Kinglykrab** [Commands] Cleanup #npcloot Command. (#1974) 2022-02-10

**Kinglykrab** [Commands] Cleanup #logs Command. (#1969) 2022-02-10

**Kinglykrab** [Commands] Cleanup #flagedit Command. (#1968) 2022-02-10

**Kinglykrab** [Commands] Cleanup #name Command. (#1977) 2022-02-10

**Kinglykrab** [Commands] Cleanup #hatelist Command. (#1976) 2022-02-10

**Kinglykrab** [Commands] Cleanup #netstats Command. (#1970) 2022-02-10

**Kinglykrab** [Commands] Cleanup #version Command. (#1967) 2022-02-10

**Kinglykrab** [Commands] Cleanup #undye and #undyeme Commands. (#1966) 2022-02-10

**Kinglykrab** [Commands] Cleanup #timers Command. (#1965) 2022-02-10

**Kinglykrab** [Quest API] Add GetEnvironmentalDamageName() to Perl/Lua. (#1964) 2022-02-10

**KayenEQ** [Bug Fix] Fix for PR1954 target restriction with npcpc_only_flag from groupbuffs (#1986) 2022-02-10

**KayenEQ** [Bug Fix] PR 1982 (#1985) 2022-02-09

**KayenEQ** fixed (#1983) 2022-02-09

**KayenEQ** [Spells] Support for SPA 194 SE_FadingMemories to use max level checks on aggroed mobs (#1979) 2022-02-09

**KayenEQ** [Bug Fix] Bard update fixes 1 (#1982) 2022-02-09

**Kinglykrab** [Quest API] Add AddAISpellEffect(spell_effect_id, base_value, limit_value, max_value) and RemoveAISpellEffect(spell_effect_id) to Lua. (#1981) 2022-02-08

**KayenEQ** (origin/release) [API] Perl functions added to apply spell effects directly to NPCs without requiring buffs. (#1975) 2022-02-08

**KayenEQ** [Spells] Allow damage spells to heal if quest based spell mitigation is over 100 pct. (#1978) 2022-02-08

**KayenEQ** procs silence (#1973) 2022-02-08

**KayenEQ** [Bug Fix] Summon Companion causing pets to warps away. (#1972) 2022-02-08

**KayenEQ** [Spells] Fix for AA and Discipline recast timers being set on spell casting failure. (#1971) 2022-02-08

**KayenEQ** [Spells] Major update to Bard song pulsing, Bard item clicks while singing, and spell casting restriction logic. (#1954) 2022-02-07

**Kinglykrab** (tag: Automated-Release-(Windows-x64)) [Quest API] Add inventory->CountItemEquippedByID(item_id) and inventory->HasItemEquippedByID(item_id) to Perl/Lua. (#1963) 2022-02-06

**Akkadius** [Maintenance Script] Pull from different maps mirror for now 2022-02-05

**KayenEQ** escape fix for different target types (#1962) 2022-02-04

**KayenEQ** [Spells] SPA 311 SE_LimitCombatSkills should prevent focusing of procs even if proc is a 'casted' spell. (#1961) 2022-02-04

**KayenEQ** [Spells] Illusions will now persist onto the corpse when mob is killed. (#1960) 2022-02-04

**Kinglykrab** [Bug Fix] NPC::CountItem and Corpse::CountItem 0 Charge Item Fix. (#1959) 2022-02-04

**KayenEQ** [Bug Fix] Illusions will now properly display armor to other clients when they zone in. (#1958) 2022-02-03

**KayenEQ** [Spells] Swarm pet aggro logic fix (#1956) 2022-02-03

**Kinglykrab** [Commands] #ginfo Cleanup. (#1955) 2022-02-03

**Kinglykrab** [Commands] Cleanup #npceditmass command. (#1957) 2022-02-03

**KayenEQ** [Spells] Support for 'HateAdded' spell field to apply negative values to reduce hate. (#1953) 2022-02-02

## 1/01/2022¶

**Akkadius** [Doors] Ignore Doors that Have Non-Zero Trigger or Door Param (#1899)

**j883376** [Spells] Allow GMs to remove buffs from any target (#1907)

**JJ** [Cleanup] holdzones not used. (#1852)

**KayenEQ** [API] mob->AppearanceEffects improved functionality. (#1821)

**KayenEQ** [API] mob->SpellEffect small perl fix (#1820)

**KayenEQ** [Bug Fix] Bind Sight will now function properly (#1825)

**KayenEQ** [Bug Fix] Hero Forge armor graphics not displaying properly to other clients in zone. (#1883)

**KayenEQ** [Bug Fix] Numhits now display instantly on cast. (#1826)

**KayenEQ** [Spells] Update to dispel to use SPA 272 SE_CastingLevel2 (#1886)

**KayenEQ** [Spells] Minor update to SPA 502 Fearstuns max calculation. (#1889)

**KayenEQ** [Features] Appearance Effects will now be sent to clients upon zone in. GM commands. (#1874)

**KayenEQ** [Spells] Update to SPA 205 SE_Rampage (#1882)

**KayenEQ** [Rule] Added rule to disable SPA 173 from making player immune to enrage. (#1897)

**KayenEQ** [Spells] Bard AA clicks should not receive song modifiers. (#1824)

**KayenEQ** [Spells] Eye of Zomm will now despawn and stack properly (#1849)

**KayenEQ** [Spells] Fixed issue with permanent Illusions not being consistent when zoning. (#1876)

**KayenEQ** [Spells] Implemented SPA 245 SE_TrapCircumvention (#1885)

**KayenEQ** [Spells] Implemented SPA 281 SE_PetFeignMinion (#1900)

**KayenEQ** [Spells] Rework of SPA 288 SE_SkillAttackProc (#1893)

**KayenEQ** [Spells] SPA 310 SE_ReduceReuseTimer will now work on spell recast time (#1856)

**KayenEQ** [Spells] Throwing procs fixed and other proc updates (#1871)

**KayenEQ** [Spells] Updates and fixes to targeted focus effects (#1870)

**KayenEQ** [Spells] Update SPA 238 SE_IllusionPersistence allow illusions to persist through deaths at higher AA ranks. (#1884)

**KayenEQ** [Spells] Update to SPA 296 and 483 item and AA support (#1857)

**KayenEQ** [Spells] Update to SPA 297 and 484 to support focus from AA and items. (#1858)

**KayenEQ** [Spells] Update to SPA 440 SE_FinishingBlowMaxLevel limit value sets HP ratio for FB (#1890)

**KayenEQ** [Spells] Update to SPA 58 SE_Levitate to support limit value (#1875)

**KayenEQ** [Bug Fix] Root code error passing wrong variable into IsDetrimental check (#1892)

**KayenEQ** [Bug Fix] Bard instrument modifiers applying to effects when it shouldn't under certain conditions. (#1822)

**KayenEQ** [Spells] Update to SPA 89 SE_ChangeSize to support directly limit value that sets model size (#1877)

**KayenEQ** [Bug Fix] validspell check to fix reported crash bug. (#1895)

**Kinglykrab** [Bug Fix] Charm Break Invisibility Fix. (#1855)

**Kinglykrab** [Bug Fix] Fix #guild rename, #killallnpcs, and #worldwide message errors. (#1904)

**Kinglykrab** [Bug Fix] Fix Perl Croak for GetEnt() (#1898)

**Kinglykrab** [Bug Fix] Fix possible crash in #givemoney. (#1828)

**Kinglykrab** [Bug Fix] Fix possible crash with #killallnpcs. (#1846)

**Kinglykrab** [Commands] Add #countitem Command. (#1842)

**Kinglykrab** [Commands] Add #petitems Command. (#1823)

**Kinglykrab** [Commands] Add #removeitem Command. (#1847)

**Kinglykrab** [Commands] Add #setaltcurrency Command. (#1850)

**Kinglykrab** [Commands] Add #setendurance Command. (#1841)

**Kinglykrab** [Commands] Add #sethp Command. (#1840)

**Kinglykrab** [Commands] Add #setmana Command. (#1839)

**Kinglykrab** [Commands] Add #unmemspell and #unmemspells Commands. (#1867)

**Kinglykrab** [Commands] Add #viewcurrencies Command. (#1844)

**Kinglykrab** [Commands] Cleanup #bind Command. (#1829)

**Kinglykrab** [Commands] Cleanup #disablerecipe Command. (#1816)

**Kinglykrab** [Commands] Cleanup #enablerecipe Command. (#1817)

**Kinglykrab** [Commands] Cleanup #flymode Command. (#1845)

**Kinglykrab** [Commands] Cleanup #gender Command. (#1832)

**Kinglykrab** [Commands] Cleanup #getplayerburiedcorpsecount Command. (#1818)

**Kinglykrab** [Commands] Cleanup #gm Command. (#1830)

**Kinglykrab** [Commands] Cleanup #gmspeed Command. (#1831)

**Kinglykrab** [Commands] Cleanup #gmzone Command. (#1836)

**Kinglykrab** [Commands] Cleanup #guild Command. (#1880)

**Kinglykrab** [Commands] Cleanup #movechar Command. (#1838)

**Kinglykrab** [Commands] Cleanup #mysql Command. (#1837)

**Kinglykrab** [Commands] Cleanup #setadventurepoints Command. (#1901)

**Kinglykrab** [Commands] Cleanup #setstartzone Command. (#1853)

**Kinglykrab** [Commands] Cleanup #texture Command. (#1835)

**Kinglykrab** [Commands] Cleanup #title Command. (#1833)

**Kinglykrab** [Commands] Cleanup #titlesuffix Command. (#1834)

**Kinglykrab** [Commands] Cleanup #wpinfo Command. (#1866)

**Kinglykrab** (origin/master, master) [Bug Fix] Cleanup Perl croaks for Spire parser. (#1908)

**Kinglykrab** [Quest API] Add GetBodyTypeName() to Perl/Lua. (#1863)

**Kinglykrab** [Quest API] Add GetFactionName() to Perl/Lua. (#1859)

**Kinglykrab** [Quest API] Add GetLanguageName() to Perl/Lua. (#1860)

**Kinglykrab** [Quest API] Add GetLDoNThemeName() to Perl/Lua. (#1861)

**Michael Cook (mackal)** Switch server to use new style ManaChange_Struct (#1843)

**mmcgarvey** [Database] Escape reserved mysql keyword rank w/ backticks (#1862)

**mmcgarvey** [Shared Tasks] Cross Zone Remove Fix (#1740)

**mmcgarvey** [Skills] Make Tracking Skill Configurable (#1784)

**mmcgarvey** [Spells] Instant Heals honor IgnoreSpellDmgLvlRestriction (#1888)

**Natedog2012** [Bug Fix] SendSpellBarEnable sends correct slotid to fix spellbar on RoF2 (#1848)

**Natedog2012** Client will give 1 second window to start casting at the end of DA effect but we interrupt it and need to allow spellbar active after (#1894)

**Natedog2012** Do not set teleport doors to Open (#1786)

**Natedog2012** [Quest API] Add ResetCastbarCooldownBySlot / ResetCastbarCooldownBySpellID / ResetAllCastbarCooldowns (#1873)

**Natedog2012** Re-enable spellbar and reset Discipline timer when stopping casts in EVENT_CAST_BEGIN (#1891)

**Natedog2012** RemoveAllAppearanceEffects sends all relevant data so NPC appearance doesn't get altered. (#1864)

**Natedog2012** SetPetID after we assign the new NPC an ID (#1851)

**Natedog2012** [Skills] RoF+ allows other classes to have feign death if set in skill_caps (#1902)

**Paul Coene** [Bug Fix] Pick Lock was allowing skillups on doors above player skill (#1815)

**Paul Coene** [Combat] Allow npcs/pets to kick vs opponents requiring magic weapons if wearing magic booties. (#1868)

**Paul Coene** [Doors] Add new rule enabling classic "key on cursor" for pre keyring keys (#1869)

---

## 2023

*Source: changelog/server/2023/index.html*

# 2023

In 2023 the EverQuest Emulator Server development team transitioned to using a new release pipeline 

Releases themselves can be found here

Changelog that powers the release notes for each release can be found here

Release pipeline documentation can be found here 

Release analytics can be found here

---

## Changelog Contributions

*Source: changelog/server/changelog-contributions/index.html*

# Changelog Contributions

Info

This page outlines notes regarding maintaining the changelog

### Guidelines¶

Your changelog should describe the end user functionality and why it is important. Similar thing goes for submitting pull requests.

While listing PR titles in the changelog is not preferred; sometimes our community gets so busy that it's all that we have time to put up in the changelog.

If you can, try to put more detailed notes in the server changelog. The purpose of the changelog is to inform users of the EverQuest Emulator Server software of what is new, what has changed, what's better, what's fixed and that is not always surfaced with obscure PR messages.

### Git Log Message Generate¶

Akkadius

This is what I typically do when I'm doing bulk changelogs. If someone else ever wants to do it.

If you do choose to generate the changelog using at least the PR merges use the following command in a bash shell (git bash on windows) or otherwise. Adjust your days back for how far back you want to go

```
`git log --no-merges --first-parent --since=40.days --pretty=format:'**%an**%Creset%C(yellow)%d%Creset %s' --abbrev-commit | sort
`
```

Take that output and bring it into a Github new issue under EQEmu/Server; we're doing this simply to generate the pull request links

Once you have the content inserted, go to the preview pane, open up inspect element in the browser and we're going to copy the HTML. 

From the HTML we need convert back to markdown. Use something like https://www.browserling.com/tools/html-to-markdown

There you go, paste the markdown into a header section containing the date and the entries below.

---

## Server Optimizations (Blog)

*Source: developer/server-optimizations-blog/index.html*

# Developer Blog - Server Optimizations¶

Info

**Author(s)** Akkadius

Several times the topic of server size optimizations and the problems we had in the past have come up.

I wanted to take a moment to write about some of the optimizations we've made to the server codebase to reduce CPU overhead, network send, database calls and improve performance.

It may not be exhaustive, but it's a good start to understanding some of the notable optimizations we've made over time so we have something to link and reference.

## Optimization - Close Mob Lists¶

Info

**Year** 2019

Initial PR - https://github.com/EQEmu/Server/pull/940

Many PR's and iterations later, we had quite a few edge cases and bugs to work out. It's been rock solid for a few years now.

| 

Before 
| After 

| 
| 

| 
| 

Whenever the system was fully rolled out, it dropped CPU utilization roughly 80% and network send dropped dramatically
as well. I'll break it down in the sections below.

EQEmu had a bit of a scaling issue when it came to number of entities in a zone. Everything every entity does used to
get sent to every single entity regardless of distance. Core functions would calculate against every entity regardless
of distance. Resulting in a tremendous amount of wasted CPU cycles, overhead and computation.

This adds up tremendously as many parts of the code are looping over the entity list sometimes many hundreds or
thousands of times a second performing expensive checks over (N) NPC's when all you care about is potentially 1-10
entities closest to you.

Imagine you have a zone with 500-1000 entities between clients and NPCs. Here's what's happening against all of those
entities as we loop through the entire entity list. The below list are examples and does not contain everything.

Info

- **NPC to NPC Aggro Scanning** - NPC aggro scanning would hit all entities and check multiple times per second per entity. This
goes for client aggro scanning and NPC aggro scanning.

- **Client to NPC Aggro Scanning** - Clients would multiple times per second, per client loop through the entire entity list to determine whether or not they should aggro an NPC.

- **Auras** - When auras are being processed, they loop all entities, performing distance checks before determining

- **Animations** - We would send animation packets to every client in the zone. When all that matters are clients closest to us.

- **AE Spells** - When AE spells of any sort are processed, rains, waves, the entire entity list is being looped (600
 NPCs) versus maybe the 4 relevant entities around you and distance checks done for every entity.

- **AE Taunt** - Lots of special ability checks, distance checks, LOS

- **Rampage** - Checking aggro, NPC, entity type.

- **Say** - When an NPC says anything, it would otherwise loop the entire entity list to calculate distance.

- **NPC Guard Assist** - Every NPC scans every single NPC for assisting during combat, performing expensive LOS checks,
 faction, distance checks before determining if an NPC should assist.

- **NPC Yell for Help** - (AIYellForHelp) Similar to assist, NPC scans list for distance, checking assist range to
 determine if NPC can help another NPC. These checks can be intensely made many times a second.

- **NPC Beneficial Cast Checks** - (AICheckCloseBeneficialSpells) When NPC's are checking to cast beneficial spells on
 other NPC's, buffs, heals, etc. They are looping through the entire entity list, performing distance checks, LOS,
 reverse faction, spell checks before ultimately determining if the NPC should cast the spell. This happens multiple
 times per second per entity.

- **QueueCloseClients** - Packet sending function used almost everywhere, would otherwise loop through the entire entity
 list and calculate distance before sending the packet. For example this is used in the following packets - damage
 update, death, client update, emote, yell for help, say, open door, send level appearance, spell effect, anim, spell
 anim, spell interrupt, begin cast and more.

- **Position Updates** - Position updates are sent zone wide to every client regardless of distance as NPC's move across
 the map, as players move across the map. These can be sent far more conservatively - only sending position updates zone wide when we really need to.

After thinking through all of this, it can be easy to see where all of this adds up, you can start to see where all of these interactions add up tremendously in overhead and wasted CPU cycles.

### Close Mob Lists¶

**Why don't we just act against the closest relevant mobs?**

Instead of always looping through the entity list excessively and tens of thousands of times a second in some cases, how
can we reduce that cost by upwards of 100x?

We keep a list of close mobs relevant to each mob (client, npc, bot etc.) and that's achieved through dynamic scanning.

Below is a visual representation of what used to happen in the codebase relative to each entity versus how things behave today. Almost everything in the code that involved checking nearby NPC's would loop through all entities and perform expensive calculations. Today we just use the close mob list which reduces a ton of computational overhead.

| 

Before 
| After 

| 
| 

### Scanning¶

Let's dive into how the mechanics work.

Each mob has a list called `m_close_mobs` and utilize the following method in the source to scan.

```
`void EntityList::ScanCloseMobs(Mob *scanning_mob) 
`
```

The way scanning works is say you have 1000 entities in a zone and a client is building its close mobs list. The default
scanning range is defined by `Range:MobCloseScanDistance` and it is 600 units. Anything within that scan range gets put
within the `close_mobs` mob variable list.

The mob will also add itself to other mobs close lists as it becomes in range of another mob, this is to ensure accuracy
of the close list of every mob. Most of the time, entities have less than ~10-50 on their close list relevant to them.

Checks are made to ensure we don't add the same mob twice in any scenario.

### Relevant Code¶

Here are the relevant mob member variables

```
`std::unordered_map<uint16, Mob *> m_close_mobs;
Timer m_scan_close_mobs_timer;
Timer m_mob_check_moving_timer;
`
```

Relevant methods

```
`Mob::CheckScanCloseMobsMovingTimer();
Mob::ScanCloseMobProcess();
Mob::GetCloseMobList(float distance = 0);
EntityList::GetCloseMobList(Mob *mob, float distance);
`
```

**GetCloseMobList** usages

Info

Here is the reformatted list showing just the file and the function:

- **attack.cpp**

Attack

- **effects.cpp**

AEAttack

- AESpell

- AETaunt

- MassGroupBuff

- **entity.cpp**

GetTargetsForVirusEffect

- QuestJournalledSayClose

- QueueCloseClients

- **mob.cpp**

Say

- **npc.cpp**

AICheckCloseBeneficialSpells

- AIYellForHelp

- **spells.cpp**

SpellFinished

- **aura.cpp**

ProcessEnterTrap

- ProcessExitTrap

- ProcessOnAllFriendlies

- ProcessOnAllGroupMembers

- ProcessOnGroupMembersPets

- ProcessSpawns

- ProcessTotem

- **client.cpp**

ClientToNpcAggroProcess

- **mob.cpp**

IsCloseToBanker

- SetBottomRampageList

- SetTopRampageList

- **npc.cpp**

DoNpcToNpcAggroScan

### Initial Scan¶

When an entity is created, we need to call the function - initial scan is invoked differently depending on the entity.

| 

**Entity Type** 
| **Where** 

| Client 
| Client::CompleteConnect 

| NPC 
| EntityList::AddNPC 

### Ongoing Scan¶

During the duration of an entities life, there is an ongoing scan based on a dynamic timer. This timer is also different
depending on whether an NPC is idle or moving.

| 

**Entity Type** 
| **Where** 

| Client 
| Client::Process 

| NPC 
| NPC::Process 

```
`Mob::ScanCloseMobProcess()
`
```

For both client / npc the code is called in each entities respective Mob/Client::Process() branches.

### Scanning Dynamic Interval Timer¶

Scanning frequency changes depending on whether an entity is moving or idle. This is to keep computational expenses very
low.

This is determined by `Mob::mob_close_scan_timer` and calculted during invocation of `Mob::CheckScanCloseMobsMovingTimer`

| 

**Entity Type** 
| **Idle** 
| **Moving** 

| Mob 
| 1 minute 
| 6 seconds (tic) 

For NPC's we have a `Mob::m_mob_check_moving_timer` which is throttled to once a second to keep computational checks light
to check if an NPC is moving or not to change the scan timer.

### Book Keeping¶

In order to ensure we don't have dangling pointers, crashes we have to clean this close mob list up when entities die.

In the mob destructor we cleanup

```
`Mob::~Mob() {
 // ... destructor code
 entity_list.RemoveMobFromCloseLists(this);
 m_close_mobs.clear();
`
```

### **What if an NPC is beyond the scan range?**¶

Simple. Every time `Mob::GetCloseMobList()` is called, by default it will return the close mob list if you pass in a distance less than the specified rule value `Range:MobCloseScanDistance`. If your code passes in a distance greater than this scan range, it will default to using the entire entity list. This solves for edge cases where you have a zone wide spell, zone wide AOE, aggro, taunt or otherwise.

## Optimization - Zone Wide Position Updates¶

Info

**Year** 2022

Our server code used to send position updates for all NPC's and clients to the player zone wide. This resulted in excess of packet sending and waste of CPU overhead.

We now only send position updates to entities close to clients and do full zone updates under certain circumstances.

### Only Send Position Updates to Close Mobs¶

While the simple answer is to only send position updates to close mobs, there's a few things we have to do to ensure we don't fall out of sync under certain edge cases.

### Bulk Send Position Updates¶

When we enter a zone we get a full send of the entity list of spawn locations, appearance etc.

After that initial send we only get sent zone wide updates under specific circumstances.

This is handled by `Client::CheckSendBulkClientPositionUpdate()` after a client has traveled enough distance to warrant a full zone sync all mobs (Clients and NPCs).

For clients, the client requires a position update roughly every 10 seconds, so if a client is out of range we just send one every 10 seconds.

**Client::Process**

```
`if (!IsMoving() && m_position_update_timer.Check()) {
 SentPositionPacket(0.0f, 0.0f, 0.0f, 0.0f, 0);
}
`
```

Here are the ranges specified in our movement updates

Here is the reformatted list, including the range mentioned in the function signature:

Info

- **client.cpp**

- CheckSendBulkClientPositionUpdate - `ClientRangeAny`

- **client_packet.cpp**

Handle_OP_ClientUpdate - (Not specified in the usage snippet)

- **mob.cpp**

GMMove (1st usage) - `ClientRangeAny`

- GMMove (2nd usage) - `ClientRangeAny`

- **mob_movement_manager.cpp**

StopMovingCommand - `ClientRangeCloseMedium`

- MoveToCommand (1st usage) - `ClientRangeCloseMedium`

- MoveToCommand (2nd usage) - `ClientRangeCloseMedium`

- MoveToCommand (3rd usage) - `ClientRangeCloseMedium`

- EvadeCombatCommand - `ClientRangeCloseMedium`

- TeleportToCommand - `ClientRangeAny`

- SwimToCommand (1st usage) - `ClientRangeCloseMedium`

- SwimToCommand (2nd usage) - `ClientRangeCloseMedium`

- SwimToCommand (3rd usage) - `ClientRangeCloseMedium`

- FlyToCommand (1st usage) - `ClientRangeCloseMedium`

- FlyToCommand (2nd usage) - `ClientRangeCloseMedium`

- FlyToCommand (3rd usage) - `ClientRangeCloseMedium`

- RotateToCommand (1st usage) - `ClientRangeCloseMedium`

- RotateToCommand (2nd usage) - `ClientRangeCloseMedium`

- **spells.cpp**

Spin - `ClientRangeAny`

- **movement.cpp**

command_movement - `ClientRangeAny`

- **mob_movement_manager.h**

SendCommandToClients (Declaration) - (Range not specified in this snippet)

## Optimization - Sending Packet Messages to Relevant Distances¶

Info

**Year** 2017

Relevant commit - https://github.com/EQEmu/Server/commit/14d09485eb1fda95982eba7ebf48207729b394a2

This one was done long before close mob lists, but we went in and implemented sending updates by range and implemented them as configurable rules in the source.

This made cost savings but not as dramatic as the close mob list optimizations themselves. They compliment the close mob changes because the packet send functions can utilize the same list instead of looping the whole entity list.

```
`RULE_INT(Range, Say, 15, "The range that is required before /say or hail messages will work to an NPC");
RULE_INT(Range, Emote, 135, "The packet range in which emote messages are sent'");
RULE_INT(Range, BeginCast, 200, "The packet range in which begin cast messages are sent");
RULE_INT(Range, Anims, 135, "The packet range in which begin cast messages are sent");
RULE_INT(Range, SpellParticles, 135, "The packet range in which spell particles are sent");
RULE_INT(Range, DamageMessages, 50, "The packet range in which damage messages are sent (non-crit)");
RULE_INT(Range, SpellMessages, 75, "The packet range in which spell damage messages are sent");
RULE_INT(Range, SongMessages, 75, "The packet range in which song messages are sent");
RULE_INT(Range, StunMessages, 75, "The packet range in which stun messages are sent");
RULE_INT(Range, ClientPositionUpdates, 300, "Distance in which the own changed position is communicated to other clients");
RULE_INT(Range, CriticalDamage, 80, "The packet range in which critical hit messages are sent");
RULE_INT(Range, MobCloseScanDistance, 600, "Close scan distance");
RULE_INT(Range, MaxDistanceToClickDoors, 100, "Max distance that a client can click a door from (Client says 'You can't reach that' at roughly ;25-50 for most doors)");
`
```

## Optimization - Send Animation Packets Less¶

Info

**Year** 2017

Related commit https://github.com/EQEmu/Server/commit/127f51e7587b0d354f0f326f8661a640baf313e2

Notes from original commit

Quote

- HP Updates now only send to others when HP percentage changes (0-100%)

HP Updates were sending excessively even during idle zones when HP wasn't changing at all

- Attack animations now only send once per second versus up to a hundred times a second per Mob/Client

- 17,000 OP_ClientUpdate packets per second have been observed in combat scenarios, some of the major culprits have been
 throttled without affecting what the client should see

- Before and After packet differences under similar load/tests (Packets per second)

7,000 - 8,000 OP_Animation pps After: 600-800 pps

- 13,0000 - 17,000 OP_MobHealth pps After: 1-10 pps

- 15,0000 - 20,000 OP_ClientUpdate pps After: 500-1,000 pps

- Packet reports from a 46 client test here:
 https://gist.github.com/Akkadius/28b7ad2fdd82bdd15ea737c68f404346

- Servers who use Marquee HP updates will also recieve far less packet spam as they will only be sent when HP changes

Info

We've made changes around this code since so you will need to look at the source to see the latest record of how these changes are implemented.

## Optimization - Perl Heavy Exports¶

Info

**Year** 2015

Related commit - https://github.com/EQEmu/Server/commit/e8d18cb014fc2123518056fe5dbf9d8f17360da6

Commit notes

Quote

- Added Rate limit the rate in which signals are processed for NPC's (.5 seconds instead of .01 seconds)
 Added Perl Export Settings which should heavily reduce the Perl footprint

- Normally when any sub EVENT_ gets triggered, all kinds of variables have to get exported every single time an event is triggered and
 this can make Perl very slow when events are triggered constantly

- The two most taxing variable exports are the item variables ($itemcount{} $hasitem{} \(oncursor{}) and qglobals (\)qglobals{})

- qglobals can pose to be an issue quickly when global qglobals build up, it is highly recommend to use the GetGlobal() and SetGlobal()
 methods instead as they don't reference the hashmap $qglobals{} that is rebuilt every single time a sub event is triggered

- A stress test conducted with 10,000 samples shows an excess of time taken to export variables: http://i.imgur.com/NEpW1tS.png

- After the Perl Export Settings table is implemented, and all exports are shut off you see the following test result:
 http://i.imgur.com/Du5hth9.png

- The difference of eliminating uneeded exports brings the overhead and footprint of 10,000 triggers from 54 seconds to 2 seconds

- In a 10,000 sample test (10,000 sub event triggers), exporting item variables adds 12 seconds alone, when item variables are only needed in
 EVENT_ITEM and EVENT_SAY a majority of the time if at all

- In a 10,000 sample test (10,000 sub event triggers), exporting qglobals with approximately 1,000 global qglobals in the database creates
 about 11-20 seconds of delay on its own (Depending on hardware of course)

- I've written a parser that has determined which of these exports are needed in which sub routines and have turned off all of the unneeded
 exports in sub routines that do not need them and used it to create the default table that will be installed in the database.

- The export table is called 'perl_event_export_settings' and it resembles the following structure and contains all current 81 EVENTS

- If an entry doesn't exist in this table and a new subroutine is added to the source, all exports will be on by default for that routine

```
`+----------+-----------------------------------------+-----------------+------------+-------------+-------------+--------------+
| event_id | event_description | export_qglobals | export_mob | export_zone | export_item | export_event |
+----------+-----------------------------------------+-----------------+------------+-------------+-------------+--------------+
| 0 | EVENT_SAY | 1 | 1 | 1 | 1 | 1 |
| 1 | EVENT_ITEM | 1 | 1 | 1 | 0 | 1 |
| 2 | EVENT_DEATH | 1 | 1 | 1 | 0 | 1 |
| 3 | EVENT_SPAWN | 1 | 1 | 1 | 0 | 1 |
| 4 | EVENT_ATTACK | 0 | 1 | 1 | 0 | 1 |
| 5 | EVENT_COMBAT | 1 | 1 | 1 | 0 | 1 |
+----------+-----------------------------------------+-----------------+------------+-------------+-------------+--------------+
`
```

- If a change is made to this table while the server is live and running, you can hot reload all zone process settings via:
 #reloadperlexportsettings

- For those who wonder what "exports" are, they are reference to variables that are made available at runtime of the sub event, such as:
 (export_qglobals) (Heavy) : $qglobals https://github.com/EQEmu/Server/blob/master/zone/embparser.cpp#L916
 (export_item) (Heavy) : $itemcount{} $hasitem{} $oncursor{} https://github.com/EQEmu/Server/blob/master/zone/embparser.cpp#L1103
 (export_zone) : $zoneid, $instanceid, $zoneln etc. https://github.com/EQEmu/Server/blob/master/zone/embparser.cpp#L1083
 (export_mob) : $x, $y, $z, $h, \(hpratio etc. https://github.com/EQEmu/Server/blob/master/zone/embparser.cpp#L1032
 (export_event) : (event specific) IE: EVENT_SAY (\)text) https://github.com/EQEmu/Server/blob/master/zone/embparser.cpp#L1141

## Optimization - Logging Functions moved to Macros¶

Info

**Year** 2017

Related commit - https://github.com/EQEmu/Server/commit/7aa1d243b0483ad9041537aada44f923bf923390

Original notes

Quote

Reworked how all log calls are made in the source

- Before we used Log.Out, we will now use a macro Log(

- Before: Log.Out(Logs::General, Logs::Status, "Importing Spells...");

- After: Log(Logs::General, Logs::Status, "Importing Spells...");

- The difference is
 1) It's 200-300x faster especially when log statements are inside very hot code paths. We already
 had most hot paths checked before we logged them, but this blankets all existing logging calls now and not just the
 select few we had picked out in the source.
 2) Strings don't get copied to the stack, popped and pushed constantly even when we hit a log statement that
 actually isn't going to log anything.

We do an 'if (LogSys.log_settings[log_category].is_category_enabled == 1)' before we call a log function
 in the log macro so the log function doesn't get called at all if we're not logging the category

- This has increased binary executables roughly 15KB

- The old extern for EQEmuLogSys is now named LogSys appropriately instead of Log (Ex: LogSys.StartFileLogs())

- The result keeps logging footprint non-existent for when we're not logging that category

## All Other Performance Changes¶

For anything not explicitly mentioned in the blog. Search "Performance" or "Optimization" in https://github.com/EQEmu/Server/blob/master/CHANGELOG.md for more

---

## client_server_faction_map

*Source: schema/factions/client_server_faction_map/index.html*

# client_server_faction_map¶

## Schema¶

| 

Column 
| Data Type 
| Description 

| clientid 
| int 
| Client Faction Identifier 

| serverid 
| int 
| Server Faction Identifier

---

## login_accounts

*Source: schema/loginserver/login_accounts/index.html*

# login_accounts¶

## Relationships¶

```
erDiagram
 login_accounts {
 varchar account_name
 varchar last_ip_address
 }
 account {
 int id
 varchar name
 }
 account_ip {
 int accid
 varchar ip
 }
 login_accounts ||--o{ account : "One-to-One"
 login_accounts ||--o{ account_ip : "Has-Many"

```

| 

Relationship Type 
| Local Key 
| Relates to Table 
| Foreign Key 

| One-to-One 
| account_name 
| account 
| name 

| Has-Many 
| last_ip_address 
| account_ip 
| ip 

## Schema¶

| 

Column 
| Data Type 
| Description 

| id 
| int 
| Unique Account Identifier 

| account_name 
| varchar 
| Account Name 

| account_password 
| text 
| Account Password 

| account_email 
| varchar 
| Account Email 

| source_loginserver 
| varchar 
| Source Loginserver 

| last_ip_address 
| varchar 
| Last IP Address 

| last_login_date 
| datetime 
| Last Login Date 

| created_at 
| datetime 
| Created At Date 

| updated_at 
| datetime 
| Updated At Date

---

## login_api_tokens

*Source: schema/loginserver/login_api_tokens/index.html*

# login_api_tokens¶

## Schema¶

| 

Column 
| Data Type 
| Description 

| id 
| int 
| Unique Login API Token Identifier 

| token 
| varchar 
| Token Identifier 

| can_write 
| int 
| Can Write: 0 = False, 1 = True 

| can_read 
| int 
| Can Read: 0 = False, 1 = True 

| created_at 
| datetime 
| Created At Date 

| updated_at 
| datetime 
| Updated At Date

---

## login_server_admins

*Source: schema/loginserver/login_server_admins/index.html*

# login_server_admins¶

## Relationships¶

```
erDiagram
 login_server_admins {
 intunsigned id
 varchar account_name
 varchar registration_ip_address
 }
 login_world_servers {
 int login_server_admin_id
 int login_server_list_type_id
 varchar last_ip_address
 }
 account {
 int id
 varchar name
 }
 account_ip {
 int accid
 varchar ip
 }
 login_server_admins ||--o{ login_world_servers : "Has-Many"
 login_server_admins ||--o{ account : "One-to-One"
 login_server_admins ||--o{ account_ip : "Has-Many"

```

| 

Relationship Type 
| Local Key 
| Relates to Table 
| Foreign Key 

| Has-Many 
| id 
| login_world_servers 
| login_server_admin_id 

| One-to-One 
| account_name 
| account 
| name 

| Has-Many 
| registration_ip_address 
| account_ip 
| ip 

## Schema¶

| 

Column 
| Data Type 
| Description 

| id 
| int 
| Unique Account Identifier 

| account_name 
| varchar 
| Account Name 

| account_password 
| varchar 
| Account Password 

| first_name 
| varchar 
| First Name 

| last_name 
| varchar 
| Last Name 

| email 
| varchar 
| Email 

| registration_date 
| datetime 
| Registration Date 

| registration_ip_address 
| varchar 
| Registration IP Address

---

## login_server_list_types

*Source: schema/loginserver/login_server_list_types/index.html*

# login_server_list_types¶

## Relationships¶

```
erDiagram
 login_server_list_types {
 intunsigned id
 }
 login_world_servers {
 int login_server_admin_id
 int login_server_list_type_id
 varchar last_ip_address
 }
 login_server_list_types ||--o{ login_world_servers : "Has-Many"

```

| 

Relationship Type 
| Local Key 
| Relates to Table 
| Foreign Key 

| Has-Many 
| id 
| login_world_servers 
| login_server_list_type_id 

## Schema¶

| 

Column 
| Data Type 
| Description 

| id 
| int 
| Unique List Type Identifier 

| description 
| varchar 
| Description

---

## login_world_servers

*Source: schema/loginserver/login_world_servers/index.html*

# login_world_servers¶

## Relationships¶

```
erDiagram
 login_world_servers {
 int login_server_admin_id
 int login_server_list_type_id
 varchar last_ip_address
 }
 account_ip {
 int accid
 varchar ip
 }
 login_server_admins {
 intunsigned id
 varchar account_name
 varchar registration_ip_address
 }
 login_server_list_types {
 intunsigned id
 }
 login_world_servers ||--o{ account_ip : "Has-Many"
 login_world_servers ||--o{ login_server_admins : "One-to-One"
 login_world_servers ||--o{ login_server_list_types : "One-to-One"

```

| 

Relationship Type 
| Local Key 
| Relates to Table 
| Foreign Key 

| Has-Many 
| last_ip_address 
| account_ip 
| ip 

| One-to-One 
| login_server_admin_id 
| login_server_admins 
| id 

| One-to-One 
| login_server_list_type_id 
| login_server_list_types 
| id 

## Schema¶

| 

Column 
| Data Type 
| Description 

| id 
| int 
| Unique World Server Identifier 

| long_name 
| varchar 
| Long Name 

| short_name 
| varchar 
| Short Name 

| tag_description 
| varchar 
| Tag Description 

| login_server_list_type_id 
| int 
| List Type Identifier (1 Legends, 2 Preferred, 3 Standard) 

| last_login_date 
| datetime 
| Last Login Date 

| last_ip_address 
| varchar 
| Last IP Address 

| login_server_admin_id 
| int 
| Login Server Admin Identifier 

| is_server_trusted 
| int 
| Is Server Trusted: 0 = False, 1 = True 

| note 
| varchar 
| Note

---

## qs_merchant_transaction_record

*Source: schema/query-server/qs_merchant_transaction_record/index.html*

# qs_merchant_transaction_record¶

## Relationships¶

```
erDiagram
 qs_merchant_transaction_record {
 int char_id
 int merchant_id
 int zone_id
 }
 character_data {
 intunsigned id
 varchar name
 varchar nane
 intunsigned zone_instance
 intunsigned zone_id
 }
 merchantlist {
 varchar content_flags
 varchar content_flags_disabled
 varchar bucket_name
 int item
 varchar merchant_id
 int merchantid
 }
 zone {
 int zoneidnumber
 varchar short_name
 tinyintunsigned version
 varchar content_flags
 varchar content_flags_disabled
 }
 qs_merchant_transaction_record ||--o{ character_data : "One-to-One"
 qs_merchant_transaction_record ||--o{ merchantlist : "Has-Many"
 qs_merchant_transaction_record ||--o{ zone : "One-to-One"

```

| 

Relationship Type 
| Local Key 
| Relates to Table 
| Foreign Key 

| One-to-One 
| char_id 
| character_data 
| id 

| Has-Many 
| merchant_id 
| merchantlist 
| merchantid 

| One-to-One 
| zone_id 
| zone 
| zoneidnumber 

## Schema¶

| 

Column 
| Data Type 
| Description 

| transaction_id 
| int 
| Unique Transaction Identifier 

| time 
| timestamp 
| Timestamp 

| zone_id 
| int 
| Zone Identifier 

| merchant_id 
| int 
| Merchant Identifier 

| merchant_pp 
| int 
| Merchant Platinum 

| merchant_gp 
| int 
| Merchant Gold 

| merchant_sp 
| int 
| Merchant Silver 

| merchant_cp 
| int 
| Merchant Copper 

| merchant_items 
| mediumint 
| Merchant Items 

| char_id 
| int 
| Unique Character Identifier 

| char_pp 
| int 
| Character Platinum 

| char_gp 
| int 
| Character Gold 

| char_sp 
| int 
| Character Silver 

| char_cp 
| int 
| Character Copper 

| char_items 
| mediumint 
| Character Items

---

## qs_merchant_transaction_record_entries

*Source: schema/query-server/qs_merchant_transaction_record_entries/index.html*

# qs_merchant_transaction_record_entries¶

## Relationships¶

```
erDiagram
 qs_merchant_transaction_record_entries {
 int item_id
 int aug_1
 int aug_2
 int aug_3
 int aug_4
 int aug_5
 }
 items {
 int id
 int book
 varchar name
 int recasttype
 int icon
 mediumint bardeffect
 int clickeffect
 int focuseffect
 int proceffect
 int scrolleffect
 int worneffect
 }
 qs_merchant_transaction_record_entries ||--o{ items : "One-to-One"
 qs_merchant_transaction_record_entries ||--o{ items : "One-to-One"
 qs_merchant_transaction_record_entries ||--o{ items : "One-to-One"
 qs_merchant_transaction_record_entries ||--o{ items : "One-to-One"
 qs_merchant_transaction_record_entries ||--o{ items : "One-to-One"
 qs_merchant_transaction_record_entries ||--o{ items : "One-to-One"

```

| 

Relationship Type 
| Local Key 
| Relates to Table 
| Foreign Key 

| One-to-One 
| aug_1 
| items 
| id 

| One-to-One 
| aug_2 
| items 
| id 

| One-to-One 
| aug_3 
| items 
| id 

| One-to-One 
| aug_4 
| items 
| id 

| One-to-One 
| aug_5 
| items 
| id 

| One-to-One 
| item_id 
| items 
| id 

## Schema¶

| 

Column 
| Data Type 
| Description 

| event_id 
| int 
| Unique Event Identifier 

| char_slot 
| mediumint 
| Character Slot Identifier 

| item_id 
| int 
| Item Identifier 

| charges 
| mediumint 
| Charges 

| aug_1 
| int 
| Augment Slot 1 

| aug_2 
| int 
| Augment Slot 2 

| aug_3 
| int 
| Augment Slot 3 

| aug_4 
| int 
| Augment Slot 4 

| aug_5 
| int 
| Augment Slot 5

---

## qs_player_aa_rate_hourly

*Source: schema/query-server/qs_player_aa_rate_hourly/index.html*

# qs_player_aa_rate_hourly¶

## Relationships¶

```
erDiagram
 qs_player_aa_rate_hourly {
 int char_id
 }
 character_data {
 intunsigned id
 varchar name
 varchar nane
 intunsigned zone_instance
 intunsigned zone_id
 }
 qs_player_aa_rate_hourly ||--o{ character_data : "One-to-One"

```

| 

Relationship Type 
| Local Key 
| Relates to Table 
| Foreign Key 

| One-to-One 
| char_id 
| character_data 
| id 

## Schema¶

| 

Column 
| Data Type 
| Description 

| char_id 
| int 
| Character Identifier 

| hour_time 
| int 
| Hour Time UNIX Timestamp 

| aa_count 
| varchar 
| AA Count

---

## qs_player_delete_record

*Source: schema/query-server/qs_player_delete_record/index.html*

# qs_player_delete_record¶

## Relationships¶

```
erDiagram
 qs_player_delete_record {
 int char_id
 }
 character_data {
 intunsigned id
 varchar name
 varchar nane
 intunsigned zone_instance
 intunsigned zone_id
 }
 qs_player_delete_record ||--o{ character_data : "One-to-One"

```

| 

Relationship Type 
| Local Key 
| Relates to Table 
| Foreign Key 

| One-to-One 
| char_id 
| character_data 
| id 

## Schema¶

| 

Column 
| Data Type 
| Description 

| delete_id 
| int 
| Unique Delete Identifier 

| time 
| timestamp 
| Time Timestamp 

| char_id 
| int 
| Character Identifier 

| stack_size 
| mediumint 
| Stack Size 

| char_items 
| mediumint 
| Character Items Identifier

---

## qs_player_delete_record_entries

*Source: schema/query-server/qs_player_delete_record_entries/index.html*

# qs_player_delete_record_entries¶

## Relationships¶

```
erDiagram
 qs_player_delete_record_entries {
 int item_id
 int aug_1
 int aug_2
 int aug_3
 int aug_4
 int aug_5
 }
 items {
 int id
 int book
 varchar name
 int recasttype
 int icon
 mediumint bardeffect
 int clickeffect
 int focuseffect
 int proceffect
 int scrolleffect
 int worneffect
 }
 qs_player_delete_record_entries ||--o{ items : "One-to-One"
 qs_player_delete_record_entries ||--o{ items : "One-to-One"
 qs_player_delete_record_entries ||--o{ items : "One-to-One"
 qs_player_delete_record_entries ||--o{ items : "One-to-One"
 qs_player_delete_record_entries ||--o{ items : "One-to-One"
 qs_player_delete_record_entries ||--o{ items : "One-to-One"

```

| 

Relationship Type 
| Local Key 
| Relates to Table 
| Foreign Key 

| One-to-One 
| aug_1 
| items 
| id 

| One-to-One 
| aug_2 
| items 
| id 

| One-to-One 
| aug_3 
| items 
| id 

| One-to-One 
| aug_4 
| items 
| id 

| One-to-One 
| aug_5 
| items 
| id 

| One-to-One 
| item_id 
| items 
| id 

## Schema¶

| 

Column 
| Data Type 
| Description 

| event_id 
| int 
| Unique Event Identifier 

| char_slot 
| mediumint 
| Character Slot Identifier 

| item_id 
| int 
| Item Identifier 

| charges 
| mediumint 
| Charges 

| aug_1 
| int 
| Augment Slot 1 

| aug_2 
| int 
| Augment Slot 2 

| aug_3 
| int 
| Augment Slot 3 

| aug_4 
| int 
| Augment Slot 4 

| aug_5 
| int 
| Augment Slot 5

---

## qs_player_events

*Source: schema/query-server/qs_player_events/index.html*

# qs_player_events¶

## Relationships¶

```
erDiagram
 qs_player_events {
 int char_id
 }
 character_data {
 intunsigned id
 varchar name
 varchar nane
 intunsigned zone_instance
 intunsigned zone_id
 }
 qs_player_events ||--o{ character_data : "One-to-One"

```

| 

Relationship Type 
| Local Key 
| Relates to Table 
| Foreign Key 

| One-to-One 
| char_id 
| character_data 
| id 

## Schema¶

| 

Column 
| Data Type 
| Description 

| id 
| int 
| Unique Event Identifier 

| char_id 
| int 
| Character Identifier 

| event 
| int 
| Event 

| event_desc 
| varchar 
| Event Description 

| time 
| int 
| Time UNIX Timestamp

---

## qs_player_handin_record

*Source: schema/query-server/qs_player_handin_record/index.html*

# qs_player_handin_record¶

## Relationships¶

```
erDiagram
 qs_player_handin_record {
 int char_id
 int npc_id
 }
 character_data {
 intunsigned id
 varchar name
 varchar nane
 intunsigned zone_instance
 intunsigned zone_id
 }
 npc_types {
 intunsigned alt_currency_id
 int id
 int npc_faction_id
 text name
 intunsigned loottable_id
 intunsigned merchant_id
 intunsigned emoteid
 intunsigned adventure_template_id
 intunsigned armortint_id
 intunsigned npc_spells_id
 intunsigned npc_spells_effects_id
 intunsigned trap_template
 }
 qs_player_handin_record ||--o{ character_data : "One-to-One"
 qs_player_handin_record ||--o{ npc_types : "One-to-One"

```

| 

Relationship Type 
| Local Key 
| Relates to Table 
| Foreign Key 

| One-to-One 
| char_id 
| character_data 
| id 

| One-to-One 
| npc_id 
| npc_types 
| id 

## Schema¶

| 

Column 
| Data Type 
| Description 

| handin_id 
| int 
| Unique Handin Identifier 

| time 
| timestamp 
| Time Timestamp 

| quest_id 
| int 
| Quest Identifier 

| char_id 
| int 
| Character Identifier 

| char_pp 
| int 
| Character Platinum 

| char_gp 
| int 
| Character Gold 

| char_sp 
| int 
| Character Silver 

| char_cp 
| int 
| Character Copper 

| char_items 
| mediumint 
| Character Items Identifier 

| npc_id 
| int 
| NPC Type Identifier 

| npc_pp 
| int 
| NPC Platinum 

| npc_gp 
| int 
| NPC Gold 

| npc_sp 
| int 
| NPC Silver 

| npc_cp 
| int 
| NPC Copper 

| npc_items 
| mediumint 
| NPC Item Identifier

---

## qs_player_handin_record_entries

*Source: schema/query-server/qs_player_handin_record_entries/index.html*

# qs_player_handin_record_entries¶

## Relationships¶

```
erDiagram
 qs_player_handin_record_entries {
 int item_id
 int aug_1
 int aug_2
 int aug_3
 int aug_4
 int aug_5
 }
 items {
 int id
 int book
 varchar name
 int recasttype
 int icon
 mediumint bardeffect
 int clickeffect
 int focuseffect
 int proceffect
 int scrolleffect
 int worneffect
 }
 qs_player_handin_record_entries ||--o{ items : "One-to-One"
 qs_player_handin_record_entries ||--o{ items : "One-to-One"
 qs_player_handin_record_entries ||--o{ items : "One-to-One"
 qs_player_handin_record_entries ||--o{ items : "One-to-One"
 qs_player_handin_record_entries ||--o{ items : "One-to-One"
 qs_player_handin_record_entries ||--o{ items : "One-to-One"

```

| 

Relationship Type 
| Local Key 
| Relates to Table 
| Foreign Key 

| One-to-One 
| aug_1 
| items 
| id 

| One-to-One 
| aug_2 
| items 
| id 

| One-to-One 
| aug_3 
| items 
| id 

| One-to-One 
| aug_4 
| items 
| id 

| One-to-One 
| aug_5 
| items 
| id 

| One-to-One 
| item_id 
| items 
| id 

## Schema¶

| 

Column 
| Data Type 
| Description 

| event_id 
| int 
| Unique Event Identifier 

| action_type 
| char 
| Action Type 

| char_slot 
| mediumint 
| Character Slot Identifier 

| item_id 
| int 
| Item Identifier 

| charges 
| mediumint 
| Charges 

| aug_1 
| int 
| Augment Slot 1 

| aug_2 
| int 
| Augment Slot 2 

| aug_3 
| int 
| Augment Slot 3 

| aug_4 
| int 
| Augment Slot 4 

| aug_5 
| int 
| Augment Slot 5

---

## qs_player_move_record

*Source: schema/query-server/qs_player_move_record/index.html*

# qs_player_move_record¶

## Relationships¶

```
erDiagram
 qs_player_move_record {
 int char_id
 }
 character_data {
 intunsigned id
 varchar name
 varchar nane
 intunsigned zone_instance
 intunsigned zone_id
 }
 qs_player_move_record ||--o{ character_data : "One-to-One"

```

| 

Relationship Type 
| Local Key 
| Relates to Table 
| Foreign Key 

| One-to-One 
| char_id 
| character_data 
| id 

## Schema¶

| 

Column 
| Data Type 
| Description 

| move_id 
| int 
| Unique Move Identifier 

| time 
| timestamp 
| Time Timestamp 

| char_id 
| int 
| Character Identifier 

| from_slot 
| mediumint 
| From Slot Identifier 

| to_slot 
| mediumint 
| To Slot Identifier 

| stack_size 
| mediumint 
| Stack Size 

| char_items 
| mediumint 
| Character Item Identifier 

| postaction 
| tinyint 
| Post Action

---

## qs_player_move_record_entries

*Source: schema/query-server/qs_player_move_record_entries/index.html*

# qs_player_move_record_entries¶

## Relationships¶

```
erDiagram
 qs_player_move_record_entries {
 int item_id
 int aug_1
 int aug_2
 int aug_3
 int aug_4
 int aug_5
 }
 items {
 int id
 int book
 varchar name
 int recasttype
 int icon
 mediumint bardeffect
 int clickeffect
 int focuseffect
 int proceffect
 int scrolleffect
 int worneffect
 }
 qs_player_move_record_entries ||--o{ items : "One-to-One"
 qs_player_move_record_entries ||--o{ items : "One-to-One"
 qs_player_move_record_entries ||--o{ items : "One-to-One"
 qs_player_move_record_entries ||--o{ items : "One-to-One"
 qs_player_move_record_entries ||--o{ items : "One-to-One"
 qs_player_move_record_entries ||--o{ items : "One-to-One"

```

| 

Relationship Type 
| Local Key 
| Relates to Table 
| Foreign Key 

| One-to-One 
| aug_1 
| items 
| id 

| One-to-One 
| aug_2 
| items 
| id 

| One-to-One 
| aug_3 
| items 
| id 

| One-to-One 
| aug_4 
| items 
| id 

| One-to-One 
| aug_5 
| items 
| id 

| One-to-One 
| item_id 
| items 
| id 

## Schema¶

| 

Column 
| Data Type 
| Description 

| event_id 
| int 
| Unique Event Identifier 

| from_slot 
| mediumint 
| From Slot Identifier 

| to_slot 
| mediumint 
| To Slot Identifier 

| item_id 
| int 
| Item Identifier 

| charges 
| mediumint 
| Charges 

| aug_1 
| int 
| Augment Slot 1 

| aug_2 
| int 
| Augment Slot 2 

| aug_3 
| int 
| Augment Slot 3 

| aug_4 
| int 
| Augment Slot 4 

| aug_5 
| int 
| Augment Slot 5

---

## qs_player_npc_kill_record

*Source: schema/query-server/qs_player_npc_kill_record/index.html*

# qs_player_npc_kill_record¶

## Relationships¶

```
erDiagram
 qs_player_npc_kill_record {
 int npc_id
 int zone_id
 }
 npc_types {
 intunsigned alt_currency_id
 int id
 int npc_faction_id
 text name
 intunsigned loottable_id
 intunsigned merchant_id
 intunsigned emoteid
 intunsigned adventure_template_id
 intunsigned armortint_id
 intunsigned npc_spells_id
 intunsigned npc_spells_effects_id
 intunsigned trap_template
 }
 zone {
 int zoneidnumber
 varchar short_name
 tinyintunsigned version
 varchar content_flags
 varchar content_flags_disabled
 }
 qs_player_npc_kill_record ||--o{ npc_types : "One-to-One"
 qs_player_npc_kill_record ||--o{ zone : "One-to-One"

```

| 

Relationship Type 
| Local Key 
| Relates to Table 
| Foreign Key 

| One-to-One 
| npc_id 
| npc_types 
| id 

| One-to-One 
| zone_id 
| zone 
| zoneidnumber 

## Schema¶

| 

Column 
| Data Type 
| Description 

| fight_id 
| int 
| Unique Fight Identifier 

| npc_id 
| int 
| NPC Type Identifier 

| type 
| int 
| Type (2 - Raid, 1 - Group, 0 - Solo) 

| zone_id 
| int 
| Zone Identifier 

| time 
| timestamp 
| Time Timestamp

---

## qs_player_npc_kill_record_entries

*Source: schema/query-server/qs_player_npc_kill_record_entries/index.html*

# qs_player_npc_kill_record_entries¶

## Relationships¶

```
erDiagram
 qs_player_npc_kill_record_entries {
 int char_id
 }
 character_data {
 intunsigned id
 varchar name
 varchar nane
 intunsigned zone_instance
 intunsigned zone_id
 }
 qs_player_npc_kill_record_entries ||--o{ character_data : "One-to-One"

```

| 

Relationship Type 
| Local Key 
| Relates to Table 
| Foreign Key 

| One-to-One 
| char_id 
| character_data 
| id 

## Schema¶

| 

Column 
| Data Type 
| Description 

| event_id 
| int 
| Unique Event Identifier 

| char_id 
| int 
| Character Identifier

---

## qs_player_speech

*Source: schema/query-server/qs_player_speech/index.html*

# qs_player_speech¶

## Relationships¶

```
erDiagram
 qs_player_speech {
 varchar from
 varchar to
 int guilddbid
 }
 character_data {
 intunsigned id
 varchar name
 varchar nane
 intunsigned zone_instance
 intunsigned zone_id
 }
 guilds {
 int id
 int leader
 varchar motd_setter
 }
 qs_player_speech ||--o{ character_data : "One-to-One"
 qs_player_speech ||--o{ character_data : "One-to-One"
 qs_player_speech ||--o{ guilds : "One-to-One"

```

| 

Relationship Type 
| Local Key 
| Relates to Table 
| Foreign Key 

| One-to-One 
| from 
| character_data 
| name 

| One-to-One 
| to 
| character_data 
| name 

| One-to-One 
| guilddbid 
| guilds 
| id 

## Schema¶

| 

Column 
| Data Type 
| Description 

| id 
| int 
| Unique Speech Identifier 

| from 
| varchar 
| From Character Identifier 

| to 
| varchar 
| To Character Identifier 

| message 
| varchar 
| Message 

| minstatus 
| smallint 
| Minimum Status 

| guilddbid 
| int 
| Guild Database Identifier 

| type 
| tinyint 
| Type 

| timerecorded 
| timestamp 
| Time Recorded Timestamp

---

## qs_player_trade_record

*Source: schema/query-server/qs_player_trade_record/index.html*

# qs_player_trade_record¶

## Relationships¶

```
erDiagram
 qs_player_trade_record {
 int char1_id
 int char2_id
 }
 character_data {
 intunsigned id
 varchar name
 varchar nane
 intunsigned zone_instance
 intunsigned zone_id
 }
 qs_player_trade_record ||--o{ character_data : "One-to-One"
 qs_player_trade_record ||--o{ character_data : "One-to-One"

```

| 

Relationship Type 
| Local Key 
| Relates to Table 
| Foreign Key 

| One-to-One 
| char1_id 
| character_data 
| id 

| One-to-One 
| char2_id 
| character_data 
| id 

## Schema¶

| 

Column 
| Data Type 
| Description 

| trade_id 
| int 
| Unique Trade Identifier 

| time 
| timestamp 
| Time Timestamp 

| char1_id 
| int 
| Character 1 Identifier 

| char1_pp 
| int 
| Character 1 Platinum 

| char1_gp 
| int 
| Character 1 Gold 

| char1_sp 
| int 
| Character 1 Silver 

| char1_cp 
| int 
| Character 1 Copper 

| char1_items 
| mediumint 
| Character 1 Item Identifier 

| char2_id 
| int 
| Character 2 Identifier 

| char2_pp 
| int 
| Character 2 Platinum 

| char2_gp 
| int 
| Character 2 Gold 

| char2_sp 
| int 
| Character 2 Silver 

| char2_cp 
| int 
| Character 2 Copper 

| char2_items 
| mediumint 
| Character 2 Item Identifier

---

## qs_player_trade_record_entries

*Source: schema/query-server/qs_player_trade_record_entries/index.html*

# qs_player_trade_record_entries¶

## Relationships¶

```
erDiagram
 qs_player_trade_record_entries {
 int from_id
 int to_id
 int item_id
 int aug_1
 int aug_2
 int aug_3
 int aug_4
 int aug_5
 }
 items {
 int id
 int book
 varchar name
 int recasttype
 int icon
 mediumint bardeffect
 int clickeffect
 int focuseffect
 int proceffect
 int scrolleffect
 int worneffect
 }
 qs_player_trade_record_entries ||--o{ items : "One-to-One"
 qs_player_trade_record_entries ||--o{ items : "One-to-One"
 qs_player_trade_record_entries ||--o{ items : "One-to-One"
 qs_player_trade_record_entries ||--o{ items : "One-to-One"
 qs_player_trade_record_entries ||--o{ items : "One-to-One"
 qs_player_trade_record_entries ||--o{ items : "One-to-One"

```

| 

Relationship Type 
| Local Key 
| Relates to Table 
| Foreign Key 

| One-to-One 
| aug_1 
| items 
| id 

| One-to-One 
| aug_2 
| items 
| id 

| One-to-One 
| aug_3 
| items 
| id 

| One-to-One 
| aug_4 
| items 
| id 

| One-to-One 
| aug_5 
| items 
| id 

| One-to-One 
| item_id 
| items 
| id 

## Schema¶

| 

Column 
| Data Type 
| Description 

| event_id 
| int 
| Unique Event Identifier 

| from_id 
| int 
| From Character Identifier 

| from_slot 
| mediumint 
| From Slot Identifier 

| to_id 
| int 
| To Character Identifier 

| to_slot 
| mediumint 
| To Slot Identifier 

| item_id 
| int 
| Item Identifier 

| charges 
| mediumint 
| Charges 

| aug_1 
| int 
| Augment Slot 1 

| aug_2 
| int 
| Augment Slot 2 

| aug_3 
| int 
| Augment Slot 3 

| aug_4 
| int 
| Augment Slot 4 

| aug_5 
| int 
| Augment Slot 5

---

## server_scheduled_events

*Source: schema/scheduler/server_scheduled_events/index.html*

# server_scheduled_events¶

## Schema¶

| 

Column 
| Data Type 
| Description 

| id 
| int 
| Unique Scheduled Event Identifier 

| description 
| varchar 
| Description 

| event_type 
| varchar 
| Event Type 

| event_data 
| text 
| Event Data 

| minute_start 
| int 
| Minute Start 

| hour_start 
| int 
| Hour Start 

| day_start 
| int 
| Day Start 

| month_start 
| int 
| Month Start 

| year_start 
| int 
| Year Start 

| minute_end 
| int 
| Minute End 

| hour_end 
| int 
| Hour End 

| day_end 
| int 
| Day End 

| month_end 
| int 
| Month End 

| year_end 
| int 
| Year End 

| cron_expression 
| varchar 
| CRON Expression 

| created_at 
| datetime 
| Created At 

| deleted_at 
| datetime 
| Deleted At

---

## AA Categories

*Source: server/aas/aa-categories/index.html*

# AA Categories¶

| 

Category ID 
| Category Name 

| -1 
| None 

| 1 
| Passive 

| 2 
| Progression 

| 3 
| Shroud Passive 

| 4 
| Shroud Active 

| 5 
| Veteran Reward 

| 6 
| Tradeskill 

| 7 
| Expendable 

| 8 
| Racial Innate 

| 9 
| EverQuest

---

## AA Nonspell Actions

*Source: server/aas/aa-nonspell-actions/index.html*

# AA Nonspell Actions¶

| 

Nonspell Action ID 
| Nonspell Action Name 

| 0 
| No Action 

| 1 
| AE Taunt 

| 2 
| Mass Buff 

| 3 
| Flaming Arrows 

| 4 
| Frost Arrows 

| 5 
| Rampage 

| 6 
| Shared Health 

| 7 
| Celestial Regeneration 

| 8 
| Dire Charm 

| 9 
| Improved Familiar 

| 10 
| Act of Valor 

| 11 
| Suspended Minion 

| 12 
| Escape 

| 13 
| Bestial Alignment 

| 14 
| Leech Touch 

| 15 
| Project Illusion

---

## AA Target Types

*Source: server/aas/aa-target-types/index.html*

# AA Target Types¶

| 

Target Type ID 
| Target Type Name 

| 0 
| None 

| 1 
| Self 

| 2 
| Current Target (Single) 

| 3 
| Group 

| 4 
| Group of Current Target 

| 5 
| Pet

---

## AA Types

*Source: server/aas/aa-types/index.html*

# AA Types¶

| 

Type ID 
| Type Name 

| 0 
| Not Applicable 

| 1 
| General 

| 2 
| Archetype 

| 3 
| Class 

| 4 
| Planes of Power Advanced 

| 5 
| Planes of Power Abilities 

| 6 
| Gates of Discord 

| 7 
| Omens of War 

| 8 
| Veteran 

| 9 
| Dragons of Norrath 

| 10 
| Depths of Darkhollow

---

## Customizing AAs

*Source: server/aas/customizing-aas/index.html*

# Customizing AAs¶

## What are Alternate Advancements?¶

The Alternative Advancement system was introduced during the Luclin expansion of EverQuest. AAs were gained by contributing some portion of gained experience to the AA experience pool, diverting experience from the standard leveling experience pool.

By default, when a player reaches level 51, the player unlocks the option to dedicate experience to Alternate Advancements. AAs are accessed inside Everquest using the default "v" hotkey. 

## "Ranks" in Alternative Advancements¶

AAs often have "ranks" available that allow you to progress the ability, making the effects more powerful at each rank level purchased. These values are stored in the aa_rank table. For example, *Innate Run Speed* has many ranks to represent the levels it can be trained. 

Notice the field `first_rank_id`. This field allows us to then explore the AA ability to find out additional parameters:

Notice the two columns for previous and next rank id. At the first rank of Innate Run Speed, we know there are no earlier ranks, so the `prev_id` field reads **-1. **The next rank ID is then **63**, which then goes to **64**, and then goes to **672**. Notice that these rank IDs are not always consecutive. Obviously we can infer that Innate Run Speed has *at least* four ranks, since our next ID takes us to 672--if the AA stopped at the third rank, we would have instead seen a **-1** value.

Let's take a look at rank ID 672 and find out how far this goes...

Note again the `prev_id` and `next_id` column values. We remember from the previous step that we left off at ID **64**, and see that the next ID is **673**. We see at ID 673 that we finally reach the end, indicated by the **-1** value in the `next_id` column. 

Now we know: there are five ranks of *Innate Run Speed* in the PEQ Database as of this writing. 

In order to find out what the advantage of *Innate Run Speed 3* compared to *Innate Run Speed 2*, we will have to take a look at the effects of each rank.

## Rank Effects in Alternative Advancements¶

The effects of each rank of an AA is stored in the aptly named aa_rank_effects database table. 

Let's examine the rank effects for our *Innate Run Speed* AA:

We see that at all ranks, the spell effect in use is 271, and we see that the base1 value increases at each rank.

Info

If you haven't read up on Spells for your EQEmu Server, you might want to take a quick look at the Spells Guide before continuing.

271 is SE_BaseMovementSpeed and BV of the effect is percent. While SE 271 does not have limit or max value, it unfortunately does not stack with other movement increases. To summarize in a table, here is each rank of *Innate Run Speed*:

| 

Rank 
| Increase To Movement Speed 

| 1 
| 8% 

| 2 
| 14% 

| 3 
| 21% 

| 4 
| 28% 

| 5 
| 35% 

If you're thinking what I'm thinking, we could definitely take over the world by adding several more ranks to *Innate Run Speed*--we already know that SE 271 does not have a max! 

## Add a new Rank¶

Start by adding another AA Rank:

```
`INSERT INTO aa_ranks (`id`, `upper_hotkey_sid`, `lower_hotkey_sid`, `title_sid`, `desc_sid`, `cost`, `level_req`, `spell`, `spell_type`, `recast_time`, `expansion`, `prev_id`, `next_id`)
VALUES
 (NULL, -1, -1, 62, 62, 1, 51, -1, 0, 0, 3, 673, -1);
`
```

Using the NULL value will cause the Auto-Increment feature to work for us, and provide the next available ID for our new rank. Don't forget that we need to tell the original highest rank of *Innate Run Speed* (673) that it now has a new rank. How do we find out what ID auto-increment just chose? We can make use of SQL's `LAST_INSERT_ID()` function:

```
`SELECT LAST_INSERT_ID(); -- Returns the id INT value
`
```

Since you may have customized your server, I will leave this value set using this function through the rest of the guide. It's important that you keep track, however, as your insert ID may change! You can now run a query to change the existing "**-1**" `next_id` value to the latest ID:

```
`UPDATE aa_ranks 
SET next_id = LAST_INSERT_ID()
WHERE rank_id = "673"
`
```

That should be it--we have created a new rank! Now let's assign our rank effect to scale up *Innate Run Speed 6.*

## Add a New Rank Effect¶

We'll want to assign the next AA Rank Effect to our new rank of *Innate Run Speed*.

```
`INSERT INTO `aa_rank_effects` (`rank_id`, `slot`, `effect_id`, `base1`, `base2`)
VALUES
 (LAST_INSERT_ID(), 1, 271, 42, 0);
`
```

And now we have finished adding *Innate Run Speed 6*, which provides a movement speed increase of 42 percent! 

## Commands Related to AAs¶

| 

Command 
| Description 

| #reloadaa 
| loads changes to the DB to the world 

| #resetaa 
| Requires a player target, resets their AAs and refunds the points 

| #resetaa_timer 
| Resets your target's AA timers so that AAs can be used immediately 

| #setaapts [value] 
| Set your target's available AA points 

| #setaaxp [value] 
| Set your target's AA experience

---

## AAs

*Source: server/aas/index.html*

# AAs¶

The Alternative Advancement system was introduced during the Luclin expansion of EverQuest. AAs were gained by contributing some portion of gained experience to the AA experience pool, diverting experience from the standard leveling experience pool.

### Client Considerations¶

The behavior of most AAs is determined by spell effects. It is important that server operators who have customized AAs distribute an updated spells file to ensure proper behavior. 

Info

If you would like additional information regarding Spells, please refer to the Spells Guide. Having a thorough understanding of the spells system prior to editing AAs is recommended.

Additionally, the appearance of AAs or customized AAs in-game can be modified through the server operator's choice of AA Categories. These categories determine the tab on which the AA will appear in game.

### Server Considerations¶

A number of database tables are used to create the AA system. You can, of course, customize AAs for your world. 

Info

Customizing AAs is typically achieved through direct edits / queries to your database, as their behaviors can vary from using spell effects, to rank effects, and so on. 

Warning

Directly editing your database can have unintended consequences. Be sure to create a backup.

Understanding the interaction of the database tables will surely help, should you choose to customize:

| 

Table 
| Description 

| aa_ability 
| the name of each AA, class/race/deity restrictions, enable/disable, AA type setting 

| aa_rank_effects 
| modifies spell effects and base values for each AA as ranks increase 

| aa_rank_prereqs 
| determines any prerequisites required before an AA purchase is allowed 

| aa_ranks 
| settings for each AA cost and progression through its ranks

---

## Bot Casting Logic

*Source: server/bots/bot-casting-logic/index.html*

# Bot Casting Logic¶

## Description¶

Bot Logic is detailed below, Bots will prefer to cast spells in a specific order depending on if they have aggro, or need a heal.

Below is the current logic for each Bot Class.

### Bard¶

- Escape

- Hate Redux

- Slow

- Debuff

- Combat Buff Song

- Combat Buff

- DOT

- Nuke

### Beastlord¶

- Slow

- Heal Self

- Debuff

- Pet

- Heal Pet

- Combat Buff

- DOT

- Nuke

- Heal Others

### Berserker¶

- Escape

- Heal Self

- Debuff

- Combat Buff

- Combat Buff Song

- DOT

- Nuke

### Cleric¶

- Escape

- Heal Self

- Heal Others

- Debuff

- Combat Buff

- Nuke

### Druid¶

- Escape

- Heal Self

- Heal Others

- Debuff

- Combat Buff

- DOT

- Nuke

### Enchanter¶

- Mesmerize

- Escape

- Slow

- Debuff

- DOT

- Combat Buff

- Nuke

### Magician¶

- Pet

- Debuff

- Combat Buff

- Heal Pet

- Nuke

### Monk¶

- Escape

- Heal Self

- Debuff

- Combat Buff

- Combat Buff Song

- DOT

- Nuke

### Necromancer¶

- Escape

- Pet

- Debuff

- Lifetap

- Combat Buff

- DOT

- Heal Pet

- Nuke

### Paladin¶

- Heal Self

- Combat Buff

- Debuff

- Heal Others

- Nuke

### Ranger¶

- Escape

- Heal Self

- Combat Buff

- DOT

- Nuke

- Heal Others

### Rogue¶

- Escape

- Heal Self

- Debuff

- Combat Buff

- Combat Buff Song

- DOT

- Nuke

### Shadow Knight¶

- Lifetap

- Combat Buff

- Debuff

- DOT

- Nuke

### Shaman¶

- Escape

- Slow

- Heal Self

- Heal Others

- Debuff

- Combat Buff

- DOT

- Nuke

- Heal Pet

### Warrior¶

- Heal Self

- Combat Buff

- Debuff

- Combat Buff Song

- DOT

- Nuke

### Wizard¶

- Escape

- Debuff

- Combat Buff

- Nuke

---

## Bot Cheat Sheet

*Source: server/bots/bot-cheat-sheet/index.html*

# Bot Cheat Sheet

Info

This page lists a quick reference and highlights how to use bots. Check out bot commands for a more detailed list of commands that bots can use.

## Getting Started¶

There's a one time command to create a bot. Use `^create help`. You'll get a popup listing the options, e.g. `^create Xackery 2 6 1` creates a bot named Xackery, class cleric, race dark elf, gender female

Now, you can spawn it with `^spawn Xackery`. To make it despawn, you use `^camp` while targetting the bot, or `^camp Xackery` to have it camp without targetting it.

Once a bot is spawned, you can invite it to your group via `/inv Xackery` as if it's a normal player.

Use `^botstopmeleelevel #` to set a level to tell the bot to stop meleeing. E.g. set it to 0 so they never engage in melee.

I suggest hotkeying `^summon all` to quickly get bots unstuck and at your location. Since bots aggro, it's suggested to just spam this so you have better control. It's also a way to leash a bot who engages too aggressively.

I suggest hotkeying `^attack` as well, this is handy for having the bots engage first

Using `^invgive` while holding an item on your cursor is faster than trading with each bot individually.

Other handy commands to consider are: `^cure disease`, `^pull`, `^guard`, `^invis living`, `^waterbreathing`, `^levitation`, `^track`, `^taunt`, `^resistance`, `^resurrect`, `^rune`, `^portal`, `^picklock`, `^movementspeed`, `^lull`, `^mesmerize`, `^charm` 

### Spells¶

Spells have two types of logic. By default, all spells go to the `^spells` command. Default behavior is just to use every spell on this list. You can press the add saylinks by each spell to add them to spell settings explained below.

Spell setting is a mode to let you granularly control spells, first, you need to opt in to spell settings by typing `^enforcespellsettings`

Now that you've opted in, you can use `^spellsettings` to see the list of spells you can enable/disable, or remove. By default, spells you pressed Add on from ^spells goes to this list enabled, so you don't need to do anything, But, pressing the `Enabled` links will flip them to disabled, and `Remove` will remove them from the list so they're back in the `^spells` section.

There are many more advanced ways to use bots, including healrotations, stances, disciplines, but for a quick start this should get you started.

---

## Bot Commands

*Source: server/bots/bot-commands/index.html*

# Bot Commands

Info

This page lists the Bot commands that are available in-game, based on assigned Account Status, for your EQEmu Server.

## Description¶

The bot command system has been redesigned and is now a clone of the existing EQEmu command system.

Instead of using the old operator and command tokens #bot command, use the new operator with the new command tokens (i.e., ^command).

A redirect has also been added to the server command interpreter that will allow the use of #bot command..but, only the new command tokens may be used.

Many of the commands have been reviewed, re-coded and improved upon, where possible.

Since bots are an on-going project, some bot commands and features may be programmed into the server code..but, not enabled or fully-realized at this time.

As the actual bot code is updated, more of those commands and features can be enabled, as well as the addition of even more commands.

Please use the ^findaliases command to locate abridged versions of command names.

Using the 'help' or 'usage' argument after a command will show the proper formatting and available options for it.

## Actionable Bots¶

With specific exceptions, bot commands are designed to work using an 'actionable' argument.

Some of these actionable arguments also require the use of an 'actionable name' parameter.

The use an 'actionable' bot argument provides much greater flexibility and control over a bot or groups of bots and eliminates the overhead of programming multiple selection criteria into a command.

```
`target - selects target as single bot .. use ^command [target] or imply by empty actionable argument
byname [name] - selects single bot by name
ownergroup - selects all bots in the owner's group;
botgroup [name] - selects members of a bot-group by its name
targetgroup - selects all bots in target's group
namesgroup [name] - selects all bots in name's group
healrotation [name] - selects all member and target bots of a heal rotation where name is a member
healrotationmembers [name] - selects all member bots of a heal rotation where name is a member
healrotationtargets [name] - selects all target bots of a heal rotation where name is a member
spawned - selects all spawned bots
all - selects all spawned bots .. argument use indicates en masse database updating
`
```

Only those bots owned by the commanding player can be selected for any bot command use.

## Example¶

```
`Usage: (<friendly_target>) ^follow ([option: reset]) [actionable: byname | ownergroup | botgroup | namesgroup | healrotation | spawned] ([actionable_name])
`
```

- `^follow reset spawned` - resets all spawned bots to follow their default assignments

- `^follow byname Jojo` - Set the bot 'Jojo' to follow the selected friendly target

- `^follow botgroup Mybotgroup` - Sets all spawned members of the bot-group 'Mybotgroup' to follow the selected friendly target

- `^follow ownergroup` - Sets all bots within the owner's group to follow the selected friendly target

Target selection is optional if the argument preceding the command is enclosed in parentheses. In this case, an omitted actionable argument should default to the bot's owner.

If there is no argument preceding the command, then the selected target is not required, and hence, ignored.

Optional 'options' and 'actionable' arguments are also enclosed within parentheses.

| 

Command 
| Description 
| Status Level 

| ^actionable 
| Lists actionable command arguments and use descriptions 
| Player (0) 

| ^applypoison 
| Applies cursor-held poison to a rogue bot's weapon 
| Player (0) 

| ^attack 
| Orders bots to attack a designated target 
| Player (0) 

| ^behindmob 
| Toggles whether or not your bot tries to stay behind a mob 
| Player (0) 

| ^blockedbuffs 
| Set, view and clear blocked buffs for the selected bot(s) 
| Player (0) 

| ^blockedpetbuffs 
| Set, view and clear blocked pet buffs for the selected bot(s) 
| Player (0) 

| ^bot 
| Lists the available bot management [subcommands] 
| Player (0) 

| ^botappearance 
| Lists the available bot appearance [subcommands] 
| Player (0) 

| ^botbeardcolor 
| Changes the beard color of a bot 
| Player (0) 

| ^botbeardstyle 
| Changes the beard style of a bot 
| Player (0) 

| ^botcamp 
| Orders a bot(s) to camp 
| Player (0) 

| ^botclone 
| Creates a copy of a bot 
| GMMgmt (200) 

| ^botcreate 
| Creates a new bot 
| Player (0) 

| ^botdelete 
| Deletes all record of a bot 
| Player (0) 

| ^botdetails 
| Changes the Drakkin details of a bot 
| Player (0) 

| ^botdyearmor 
| Changes the color of a bot's (bots') armor 
| Player (0) 

| ^boteyes 
| Changes the eye colors of a bot 
| Player (0) 

| ^botface 
| Changes the facial appearance of your bot 
| Player (0) 

| ^botfollowdistance 
| Changes the follow distance(s) of a bot(s) 
| Player (0) 

| ^bothaircolor 
| Changes the hair color of a bot 
| Player (0) 

| ^bothairstyle 
| Changes the hairstyle of a bot 
| Player (0) 

| ^botheritage 
| Changes the Drakkin heritage of a bot 
| Player (0) 

| ^botinspectmessage 
| Changes the inspect message of a bot 
| Player (0) 

| ^botlist 
| Lists the bots that you own 
| Player (0) 

| ^botreport 
| Orders a bot to report its readiness 
| Player (0) 

| ^botsettings 
| Lists settings related to spell types and bot combat 
| Player (0) 

| ^botspawn 
| Spawns a created bot 
| Player (0) 

| ^botstance 
| Changes the stance of a bot 
| Player (0) 

| ^botstopmeleelevel 
| Sets the level a caster or spell-casting fighter bot will stop melee combat 
| Player (0) 

| ^botsuffix 
| Sets a bots suffix 
| Player (0) 

| ^botsummon 
| Summons bot(s) to your location 
| Player (0) 

| ^botsurname 
| Sets a bots surname (last name) 
| Player (0) 

| ^bottattoo 
| Changes the Drakkin tattoo of a bot 
| Player (0) 

| ^bottogglehelm 
| Toggles the helm visibility of a bot between shown and hidden 
| Player (0) 

| ^bottoggleranged 
| Toggles a ranged bot between melee and ranged weapon use 
| Player (0) 

| ^bottitle 
| Sets a bots title 
| Player (0) 

| ^botupdate 
| Updates a bot to reflect any level changes that you have experienced 
| Player (0) 

| ^botwoad 
| Changes the Barbarian woad of a bot 
| Player (0) 

| ^cast 
| Tells the first found specified bot to cast the given spell type 
| Player (0) 

| ^discipline 
| Uses aggressive/defensive disciplines or can specify spell ID 
| Player (0) 

| ^distanceranged 
| Controls the range casters and ranged will try to stay away from a mob 
| Player (0) 

| ^classracelist 
| Lists the classes and races and their appropriate IDs 
| Player (0) 

| ^clickitem 
| Orders your targeted bot to click the item in the provided inventory slot. 
| Player (0) 

| ^copysettings 
| Copies settings from one bot to another 
| Player (0) 

| ^defaultsettings 
| Restores a bot back to default settings 
| Player (0) 

| ^depart 
| Orders a bot to open a magical doorway to a specified destination 
| Player (0) 

| ^enforcespellsettings 
| Toggles your Bot to cast only spells in their spell settings list. 
| Player (0) 

| ^findaliases 
| Find available aliases for a bot command 
| Player (0) 

| ^follow 
| Orders bots to follow a designated target (option 'chain' auto-links eligible spawned bots) 
| Player (0) 

| ^guard 
| Orders bots to guard their current positions 
| Player (0) 

| ^healrotation 
| Lists the available bot heal rotation [subcommands] 
| Player (0) 

| ^healrotationadaptivetargeting 
| Enables or disables adaptive targeting within the heal rotation instance 
| Player (0) 

| ^healrotationaddmember 
| Adds a bot to a heal rotation instance 
| Player (0) 

| ^healrotationaddtarget 
| Adds target to a heal rotation instance 
| Player (0) 

| ^healrotationadjustcritical 
| Adjusts the critial HP limit of the heal rotation instance's Class Armor Type criteria 
| Player (0) 

| ^healrotationadjustsafe 
| Adjusts the safe HP limit of the heal rotation instance's Class Armor Type criteria 
| Player (0) 

| ^healrotationcastingoverride 
| Enables or disables casting overrides within the heal rotation instance 
| Player (0) 

| ^healrotationchangeinterval 
| Changes casting interval between members within the heal rotation instance 
| Player (0) 

| ^healrotationclearhot 
| Clears the HOT of a heal rotation instance 
| Player (0) 

| ^healrotationcleartargets 
| Removes all targets from a heal rotation instance 
| Player (0) 

| ^healrotationcreate 
| Creates a bot heal rotation instance and designates a leader 
| Player (0) 

| ^healrotationdelete 
| Deletes a bot heal rotation entry by leader 
| Player (0) 

| ^healrotationfastheals 
| Enables or disables fast heals within the heal rotation instance 
| Player (0) 

| ^healrotationlist 
| Reports heal rotation instance(s) information 
| Player (0) 

| ^healrotationremovemember 
| Removes a bot from a heal rotation instance 
| Player (0) 

| ^healrotationremovetarget 
| Removes target from a heal rotations instance 
| Player (0) 

| ^healrotationresetlimits 
| Resets all Class Armor Type HP limit criteria in a heal rotation to its default value 
| Player (0) 

| ^healrotationsave 
| Saves a bot heal rotation entry by leader 
| Player (0) 

| ^healrotationsethot 
| Sets the HOT in a heal rotation instance 
| Player (0) 

| ^healrotationstart 
| Starts a heal rotation 
| Player (0) 

| ^healrotationstop 
| Stops a heal rotation 
| Player (0) 

| ^help 
| List available commands and their description - specify partial command as argument to search 
| Player (0) 

| ^hold 
| Prevents a bot from attacking until released 
| Player (0) 

| ^illusionblock 
| Control whether or not illusion effects will land on the bot if casted by another player or bot 
| Player (0) 

| ^inventory 
| Lists the available bot inventory [subcommands] 
| Player (0) 

| ^inventorygive 
| Gives the item on your cursor to a bot 
| Player (0) 

| ^inventorylist 
| Lists all items in a bot's inventory 
| Player (0) 

| ^inventoryremove 
| Removes an item from a bot's inventory 
| Player (0) 

| ^inventorywindow 
| Displays all items in a bot's inventory in a pop-up window 
| Player (0) 

| ^itemuse 
| Elicits a report from spawned bots that can use the item on your cursor (option 'empty' yields only empty slots) 
| Player (0) 

| ^maxmeleerange 
| Toggles whether your bot is at max melee range or not. This will disable all special abilities, including taunt. 
| Player (0) 

| ^owneroption 
| Sets options available to bot owners 
| Player (0) 

| ^pet 
| Lists the available bot pet [subcommands] 
| Player (0) 

| ^petgetlost 
| Orders a bot to remove its summoned pet 
| Player (0) 

| ^petremove 
| Orders a bot to remove its charmed pet 
| Player (0) 

| ^petsettype 
| Orders a Magician bot to use a specified pet type 
| Player (0) 

| ^picklock 
| Orders a capable bot to pick the lock of the closest door 
| Player (0) 

| ^pickpocket 
| Orders a capable bot to pickpocket a NPC 
| Player (0) 

| ^precombat 
| Sets flag used to determine pre-combat behavior 
| Player (0) 

| ^pull 
| Orders a designated bot to 'pull' an enemy 
| Player (0) 

| ^release 
| Releases a suspended bot's AI processing (with hate list wipe) 
| Player (0) 

| ^setassistee 
| Sets your target to be the person your bots assist. Bots will always assist you before others 
| Player (0) 

| ^sithppercent 
| HP threshold for a bot to start sitting in combat if allowed 
| Player (0) 

| ^sitincombat 
| Toggles whether or a not a bot will attempt to med or sit to heal in combat 
| Player (0) 

| ^sitmanapercent 
| Mana threshold for a bot to start sitting in combat if allowed 
| Player (0) 

| ^spellaggrochecks 
| Toggles whether or not bots will cast a spell type if they think it will get them aggro 
| Player (0) 

| ^spellannouncecasts 
| Turn on or off cast announcements by spell type 
| Player (0) 

| ^spellengagedpriority 
| Controls the order of casts by spell type when engaged in combat 
| Player (0) 

| ^spelldelays 
| Controls the delay between casts for a specific spell type 
| Player (0) 

| ^spellholds 
| Controls whether a bot holds the specified spell type or not 
| Player (0) 

| ^spellidlepriority 
| Controls the order of casts by spell type when out of combat 
| Player (0) 

| ^spellmaxhppct 
| Controls at what HP percent a bot will start casting different spell types 
| Player (0) 

| ^spellmaxmanapct 
| Controls at what mana percent a bot will start casting different spell types 
| Player (0) 

| ^spellmaxthresholds 
| Controls the minimum target HP threshold for a spell to be cast for a specific type 
| Player (0) 

| ^spellminhppct 
| Controls at what HP percent a bot will stop casting different spell types 
| Player (0) 

| ^spellminmanapct 
| Controls at what mana percent a bot will stop casting different spell types 
| Player (0) 

| ^spellminthresholds 
| Controls the maximum target HP threshold for a spell to be cast for a specific type 
| Player (0) 

| ^spellresistlimits 
| Controls the resist limits for bots to cast spells on their target 
| Player (0) 

| ^spellpursuepriority 
| Controls the order of casts by spell type when pursuing in combat 
| Player (0) 

| ^spelltargetcount 
| Sets the required target amount for group/AE spells by spell type 
| Player (0) 

| ^spellinfo 
| Opens a dialogue window with spell info 
| Player (0) 

| ^spells 
| Lists all Spells learned by the Bot. 
| Player (0) 

| ^spellsettings 
| Lists a bot's spell setting entries 
| Player (0) 

| ^spellsettingsadd 
| Add a bot spell setting entry 
| Player (0) 

| ^spellsettingsdelete 
| Delete a bot spell setting entry 
| Player (0) 

| ^spellsettingstoggle 
| Toggle a bot spell use 
| Player (0) 

| ^spellsettingsupdate 
| Update a bot spell setting entry 
| Player (0) 

| ^spelltypeids 
| Lists spelltypes by ID 
| Player (0) 

| ^spelltypenames 
| Lists spelltypes by shortname 
| Player (0) 

| ^suspend 
| Suspends a bot's AI processing until released 
| Player (0) 

| ^taunt 
| Toggles taunt use by a bot 
| Player (0) 

| ^timer 
| Checks or clears timers of the chosen type. 
| GMMgmt (200) 

| ^track 
| Orders a capable bot to track enemies 
| Player (0) 

| ^viewcombos 
| Views bot race class combinations 
| Player (0)

---

## Bot Data Buckets

*Source: server/bots/bot-data-buckets/index.html*

# Bot Data Buckets¶

- Bot data buckets allow Server Operators to limit the spells a Bot will cast based on different data bucket comparisons and the bucket name and value provided.

## Using Bot Data Buckets¶

- To use a Bot Data Bucket you will need to set the `bucket_name`, `bucket_value`, and `bucket_comparison` fields in the `bot_spells_entries` table for your intended spell.

## How the Data Buckets are Used¶

- Data Buckets used by the Bot use a `bucket_key-bucket_name` format.

- Meaning if your Bot ID is `7` and the bucket name is `test` your Data Bucket Key will be `bot-7`.

- 
If the Data Bucket's name is `test` the Bot will attempt to find a Data Bucket called `bot-7-test`.

- 

The Bot will also use it's Owners Data Buckets to provide additional flexability.

- Meaning if your Character ID is `9` and the bucket name is `test` your Data Bucket Key will be `character-9`.

- 

If the Data Bucket's name is `test` the Bot will attempt to find a Data Bucket called `character-9-test`.

- 

The Bot grabs all of their Data Buckets, along with the owner's Data Buckets when spawned and then compares values to the field values noted above.

## Comparison Types¶

- Bot Data Buckets have 10 different comparison types.

## Standard Comparison Types¶

- There are six standard comparison types.

`0 (==)` checks your value and the Bot value for `equality`

- `1 (!=)` checks your value and the Bot value for `inequality`

- `2 (>=)` checks if your value is `greater than or equal to` the Bot value

- `3 (<=)` checks if your value is `lesser than or equal to` the Bot value

- `4 (>)` checks if your value is `greater than` the Bot value

- `5 (<)` checks if your value is `lesser than` the Bot value

## Special Comparsion Types¶

- There are four special comparison types.

- These values are pipe `|` separated.

`6 (Any)` checks if your value is `any` of the pipe-separated Bot values `(Example: 1|2|3)`

- `7 (Not Any)` checks if your value is `not any` of the pipe-separated Bot values `(Example: 4|5|6)`

- `8 (Between)` checks if your value is `between` two pipe-separated Bot values `(Example: 1|3)`

- `9 (Not Between)` checks if your value is `not between` two pipe-separated Bot values `(Example: 4|6)`

---

## Bot Heal Rotations

*Source: server/bots/bot-heal-rotations/index.html*

# Bot Heal Rotations¶

## Description¶

Heal Rotations are a **specialty group** composed of **healing bot members** and **healable target mobs**.

Once a heal rotation is made **active**, its pseudo-AI will **augment a healing member's AI** to determine when they should **perform healing tasks**.

The **original heal rotation** code was **less sophisticated** and was **incorporated** into the **bot class** itself.

The **new heal rotation** code is a stand-alone class that has **many options** and **adjustable behavior**.

As a result of the **system change**, it may have **issues** that need to be worked out..many of the features are **experimental**.

Please **post any issues** at http://www.eqemulator.org/forums/index.php.

## Heal Rotation Commands¶

```
`^healrotation - Lists the available bot heal rotation [subcommands]
^healrotationadaptivetargeting - Enables or disables adaptive targeting within the heal rotation instance
^healrotationaddmember - Adds a bot to a heal rotation instance
^healrotationaddtarget - Adds target to a heal rotation instance
^healrotationadjustcritical - Adjusts the critial HP limit of the heal rotation instance's Class Armor Type criteria
^healrotationadjustsafe - Adjusts the safe HP limit of the heal rotation instance's Class Armor Type criteria
^healrotationcastingoverride - Enables or disables casting overrides within the heal rotation instance
^healrotationchangeinterval - Changes casting interval between members within the heal rotation instance
^healrotationclearhot - Clears the HOT of a heal rotation instance
^healrotationcleartargets - Removes all targets from a heal rotation instance
^healrotationcreate - Creates a bot heal rotation instance and designates a leader
^healrotationdelete - Deletes a bot heal rotation entry by leader
^healrotationfastheals - Enables or disables fast heals within the heal rotation instance
^healrotationlist - Reports heal rotation instance(s) information
^healrotationremovemember - Removes a bot from a heal rotation instance
^healrotationremovetarget - Removes target from a heal rotations instance
^healrotationresetlimits - Resets all Class Armor Type HP limit criteria in a heal rotation to its default value
^healrotationsave - Saves a bot heal rotation entry by leader
^healrotationsethot - Sets the HOT in a heal rotation instance
^healrotationstart - Starts a heal rotation
^healrotationstop - Stops a heal rotation
`
```

All **heal rotation commands** that **require a target** for use refer to the **healing bot member** for determining **heal rotation selection**.

A **member** of one heal rotation can be a **target** in its own or different one..but, not multiple heal rotations.

## Heal Rotation Options¶

### **Interval**¶

- The time in seconds between caster promptings of healers in the member pool

- Assuming that all casters are capable of healing in a given cycle, the time for a complete healing cycle would be **#_of_hr_members** x **interval_in_seconds** (6 members, 5-second interval = 30 second cycle)

- The healing cycle is not penalized for a caster's inability to cast. In this case, the caster is simply 'skipped' and the next caster is prompted until all casters have been cleared from the cycle

- If no casters are available for a given cycle (or remainer of,) then the cycle pool remains empty for the remainder of the interval and a new cycle is started upon its elapsing

### **Fast Heals**¶

- When enabled, only spells with a casting time of less than or equal to a specified time will be selected for use

- The current time requirement is 2 seconds or less

### **Casting Override**¶

- Casting override will interrupt any AI spell, even healing, that are being cast by the healing member when it is prompted for cycle casting

- A special heal rotation casting flag is set for any member that successfully casts for the heal rotation so that it may not be interrupted

## Heal Rotation Options - Reactive¶

### **Adaptive Targeting**¶

- There are two modes of reactive healing: **Standard** and **Adaptive Targeting**

- **Standard mode** has very basic criteria for determining a 'healable' target: **Tank** (as marked by group,) then **Healer**, and finally, **Everyone**

- **Adaptive Targeting mode** uses more advanced criteria for selecting a target:

- **Heal Frequency:** Average heal recurrence rate for a given time period - good for finding hr targets that have grabbed hate away from a tank

- **Heal Count:** Highest heal count for a given time period - backup for Heal Frequency

- **Tank:** Lowest health of marked tanks

- **Healer:** Lowest health of healers

- **Critical by Armor Type:** Sorted as less or equal to 'critical' health percentage by armor type, then by ascending armor type

- **Extended Heal Frequency:** Average heal recurrence rate for a given time period, plus occurrences from the previous time period

- **Extended Heal Count:** Highest heal count for a given time period, plus the count from the previous time period

- **Wounded by Armor Type:** Sorted as less than 'safe' health percentage by armor type, then by ascending armor type

- **Lowest Health Percentage:** Sorted by lowest health percentage, no additional criteria

- Specific armor types only play a role in Adaptive Targeting as Standard is limited to 'Base'-only

## Heal Rotation Options - Proactive¶

### **HOT (Heal Override Target)**¶

- The HOT is a singular target that you can designate from the target pool for focused healing

- Once set, all reactive criteria are ignored and the target will be healed on interval timing - regardless of current health

- Clearing the HOT reverts the heal rotation back to its reactive healing state

- If saved, the heal rotation entry does not include the HOT target or state

## Creating a Heal Rotation¶

```
`usage: (<target_creator>) ^healrotationcreate ([creator_name])
 ([interval=5: 1-30(seconds)] [fastheals=off: on | off] [adaptivetargeting=off: on | off] [castingoverride=off: on | off])
`
```

- ^healrotationcreate - Creates a Heal Rotation with the selected bot as its creator using the default settings (interval of **5** seconds, fast heals **off**, adaptive targeting **off**, casting override **off**)

- ^healrotationcreate Jojo 3 off on on - Creates a Heal Rotation with 'Jojo' as its creator using the provided settings (interval of **3** seconds, fast heals **off**, adaptive targeting **on**, casting override **on**)

If you have previously used ^healrotationsave on the 'creator' bot, the settings will automatically load when this command is issued. (See **Saving a Heal Rotation**)

## Saving a Heal Rotation¶

```
`
`
```

## Deleting a Heal Rotation¶

```
`
`
```

## Adding Heal Rotation Pool Members¶

```
`usage: (<target_member>) ^healrotationaddmember [new_member_name] ([member_name])
`
```

- ^healrotationaddmember Jojo - Adds healer bot 'Jojo' to selected member bot's heal rotation

- ^healrotationaddmember Jojo Bozo - Adds healer bot 'Jojo' to heal rotation of member bot 'Bozo'

You can adjust the maximum size of the member pool by changing the rule '**Bots:HealRotationMaxMembers**' - current default is **24**.

## Removing Heal Rotation Pool Members¶

```
`usage: (<target_member>) ^healrotationremovemember ([member_name])
`
```

- ^healrotationremovemember - Removes selected healer bot from their heal rotation

- ^healrotationremovemember Jojo - Removes healer bot 'Jojo' from its heal rotation

Removing the last member from a heal rotation, (whether through command use, by camping, or any other means,) will also clear the target pool and consume the heal rotation instance.

## Adding Heal Rotation Pool Targets¶

```
`usage: (<target_member>) ^healrotationaddtarget [heal_target_name] ([member_name])
`
```

- ^healrotationaddtarget Meatshield - Adds target mob 'Meatshield' to selected member bot's heal rotation

- ^healrotationaddtarget Meatshield Bozo - Adds target mob 'Meatshield' to heal rotation of member bot 'Bozo'

You can adjust the maximum size of the target pool by changing the rule '**Bots:HealRotationMaxTargets**' - current default is **12**.

## Removing Heal Rotation Pool Targets¶

```
`usage: (<target_member>) ^healrotationremovetarget [heal_target_name] ([member_name])
`
```

- ^healrotationremovetarget Meatshield - Removes target mob 'Meatshield' from selected member bot's heal rotation

- ^healrotationremovetarget Meatshield Bozo - Removes target mob 'Meatshield' from heal rotation of member bot 'Bozo'

## Starting a Heal Rotation¶

```
`
`
```

## Stopping a Heal Rotation¶

```
`
`
```

## Setting a HOT¶

```
`
`
```

## Clearing a HOT¶

```
`
`
```

## Showing Current Stats of a Heal Rotation¶

```
`
`
```

---

## Bot Spell Settings

*Source: server/bots/bot-spell-settings/index.html*

# Bot Spell Settings¶

## Description¶

What a Bot casts, can be further defined by the player by using a set of various Bot Commands.

## Using **^spells**¶

**^spells min_level (Optional Value)** - Will provide a list of all available Bot Spells that your Targeted Bot can cast. Per the example below, you can see a List of Available Spells, along with an option to "Add" the Spell to your Spell Settings.

## Using **^spellsettings**¶

**^spellsettings** - Will provide a list of all Bot Spells that you have added to your Bots Spell Settings List, using this command you can Toggle the Enabled/Disabled State of Spells, or remove a Spell from the Bots Spell Settings List.

## Using **^enforcespellsettings**¶

**^enforcespellsettings [true or false]** - By default Enforcing the Spell Settings List is false (disabled). Setting ^enforcespellsettings to true will force your Bot to **only** cast spells that you have added to it's Spell Settings List (viewed/managed with **^spellsettings**) you can add new spells to your Spell Settings List with **^spells** and clickking on "Add"

## Using **^spellsettingsupdate**¶

**^spellsettingsupdate [Spell ID] [Priority] [Min HP] [Max HP]** - Optionally with this command you can assign a different Priority to an individual Bot Spell (Lower Priority is more likely to be cast), additionally you set a Min/Max HP for when your Bot will cast a spell **(Currently this only works for conversion spells like Canni)** but will eventually be expanded to work for all spells.

---

## Bot Spell Types

*Source: server/bots/bot-spell-types/index.html*

Info

0 (Nuke) - 21 (Pre-Combat Buff Song) are the original "Parent Types" and 22 (Fear) - 57 (Pet Resist Buffs) are "Sub Types". It is recommended for organizational purposes to place spells in the appropriate parent or sub type but is not required for proper functionality. Bot spell code will check the appropriate parent type for a spell if the sub type or commanded list is empty. Disciplines require being placed in the Discipline (200) list at minimum.

# Spell Types¶

| 

Spell Type ID 
| Spell Type Name 

| 0 
| Nuke 

| 1 
| Regular Heal 

| 2 
| Root 

| 3 
| Buff 

| 4 
| Escape 

| 5 
| Pet 

| 6 
| Lifetap 

| 7 
| Snare 

| 8 
| Damage Over Time 

| 9 
| Dispel 

| 10 
| In-Combat Buff 

| 11 
| Mesmerize 

| 12 
| Charm 

| 13 
| Slow 

| 14 
| Debuff 

| 15 
| Cure 

| 16 
| Resurrect 

| 17 
| Hate Reduction 

| 18 
| In-Combat Buff Song 

| 19 
| Out-of-Combat Buff Song 

| 20 
| Pre-Combat Buff 

| 21 
| Pre-Combat Buff Song 

| 22 
| Fear 

| 23 
| Stun 

| 24 
| Hate Line 

| 25 
| Group Cures 

| 26 
| Complete Heal 

| 27 
| Fast Heals 

| 28 
| Very Fast Heals 

| 29 
| Group Heals 

| 30 
| Group Complete Heals 

| 31 
| Group Heal Over Time Heals 

| 32 
| Heal Over Time Heals 

| 33 
| AE Nukes 

| 34 
| AE Rains 

| 35 
| AE Mesmerize 

| 36 
| AE Stun 

| 37 
| AE Debuff 

| 38 
| AE Slow 

| 39 
| AE Snare 

| 40 
| AE Fear 

| 41 
| AE Dispel 

| 42 
| AE Root 

| 43 
| AE Damage Over Time 

| 44 
| AE Lifetap 

| 45 
| AE Hate Line 

| 46 
| Point Blank AE Nuke 

| 47 
| Pet Buffs 

| 48 
| Pet Regular Heals 

| 49 
| Pet Complete Heals 

| 50 
| Pet Fast Heals 

| 51 
| Pet Very Fast Heals 

| 52 
| Pet Heal Over Time Heals 

| 53 
| Pet Cures 

| 54 
| Damage Shields 

| 55 
| Resist Buffs 

| 56 
| Pet Damage Shields 

| 57 
| Pet Resist Buffs 

# Commanded Spell Types¶

| 

Spell Type ID 
| Spell Type Name 

| 100 
| Teleport 

| 101 
| Lull 

| 102 
| Succor 

| 103 
| Bind Affinity 

| 104 
| Identify 

| 105 
| Levitate 

| 106 
| Rune 

| 107 
| Water Breathing 

| 108 
| Size 

| 109 
| Invisibility 

| 110 
| Movement Speed 

| 111 
| Send Home 

| 112 
| Summon Corpse 

| 113 
| AE Lull 

# Discipline Spell Types¶

| 

Spell Type ID 
| Spell Type Name 

| 200 
| Discipline (All Types) 

| 201 
| Discipline - Aggressive 

| 202 
| Discipline - Defensive 

| 203 
| Discipline - Utility

---

## Stance Types

*Source: server/bots/stance-types/index.html*

# Stance Types¶

| 

Stance Type ID 
| Stance Type Name 

| 0 
| Unknown 

| 1 
| Passive 

| 2 
| Balanced 

| 3 
| Efficient 

| 4 
| Reactive 

| 5 
| Aggressive 

| 6 
| Assist 

| 7 
| Burn 

| 8 
| Efficient 2 

| 9 
| Burn AE

---

## Database Backup Tool

*Source: server/database/database-backup-tool/index.html*

# Database Backup Tool¶

World has a database backup utility wrapped as a CLI (Command Line Interface) utility

It's what powers the ProjectEQ archives micro-service http://db.projecteq.net/ 

Dumper wrapper script https://github.com/EQEmu/Server/blob/master/utils/sql/peq-dump/peq-dump.sh 

## Features¶

- Selectively backup certain types of tables (content tables, player tables, login tables, state tables, system tables etc)

- Does not table lock by default; making it easy to backup a server while it is online and players are running on it

- Supports table locking (Can impact server playability)

- Supports specifying a custom dump path

- Supports piping the dump output to console instead of writing directly to a file

- Supports option for compressing the backup (only works with file output) as long as you have a supported compression utility installed

- 7Zip (Linux, Windows)

- Tar (Linux)

### CLI Options¶

```
`eqemu@e5311a8e9505:~/server$ ./bin/world database:dump

Command

database:dump

Options

 --all
 --content-tables
 --login-tables
 --player-tables
 --state-tables
 --system-tables
 --query-serv-tables
 --table-structure-only
 --table-lock
 --dump-path=
 --dump-output-to-console
 --drop-table-syntax-only
 --compress
`
```

### Schema Source¶

The schema source for the table groupings can be found in the source at https://github.com/EQEmu/Server/blob/master/common/database_schema.h#L27 

## Example Output(s)¶

The below shows a few different types of examples

### Player Tables and Compression¶

```
`eqemu@e5311a8e9505:~/server$ ./bin/world database:dump --compress --player-tables
[World] [Info] MySQL installed [mysql Ver 15.1 Distrib 10.3.22-MariaDB, for debian-linux-gnu (x86_64) using readline 5.2]
[World] [Info] Database [peq] Host [mariadb] Username [eqemu]
[World] [Info] Dumping Tables [account account_ip account_flags account_rewards adventure_details adventure_stats buyer char_recipe_list character_activities character_alt_currency character_alternate_abilities character_auras character_bandolier character_bind character_buffs character_corpse_items character_corpses character_currency character_data character_disciplines character_enabledtasks character_expedition_lockouts character_exp_modifiers character_inspect_messages character_item_recast character_languages character_leadership_abilities character_material character_memmed_spells character_pet_buffs character_pet_info character_pet_inventory character_potionbelt character_skills character_spells character_tasks character_tribute completed_tasks data_buckets discovered_items faction_values friends guild_bank guild_members guild_ranks guild_relations guilds instance_list_player inventory inventory_snapshots keyring mail petitions player_titlesets quest_globals sharedbank spell_buckets spell_globals timers titles trader trader_audit zone_flags ]
[World] [Info] Database dump created at [backups/peq-2021-05-17-player.sql]
[World] [Info] Compression requested... Compressing dump [backups/peq-2021-05-17-player.sql]
[World] [Info] Compressed dump created at [backups/peq-2021-05-17-player.tar.gz]
`
```

### Append Multiple Table Categories (System, State, Login)¶

You can specify as many or as little table groupings as possible

```
`eqemu@e5311a8e9505:~/server$ ./bin/world database:dump --compress --system-tables --state-tables --login-tables
[World] [Info] MySQL installed [mysql Ver 15.1 Distrib 10.3.22-MariaDB, for debian-linux-gnu (x86_64) using readline 5.2]
[World] [Info] Database [peq] Host [mariadb] Username [eqemu]
[World] [Info] Dumping Tables [chatchannels command_settings content_flags db_str eqtime launcher launcher_zones spawn_condition_values spawn_events level_exp_mods logsys_categories name_filter perl_event_export_settings profanity_list rule_sets rule_values variables db_version inventory_versions adventure_members banned_ips bug_reports bugs dynamic_zones eventlog expedition_lockouts expedition_members expeditions gm_ips group_id group_leaders hackers ip_exemptions instance_list item_tick lfguild merchantlist_temp object_contents raid_details raid_leaders raid_members reports respawn_times saylink server_scheduled_events login_accounts login_api_tokens login_server_admins login_world_servers ]
[World] [Info] Database dump created at [backups/peq-2021-05-17-system-state-login.sql]
[World] [Info] Compression requested... Compressing dump [backups/peq-2021-05-17-system-state-login.sql]
[World] [Info] Compressed dump created at [backups/peq-2021-05-17-system-state-login.tar.gz]
`
```

---

## Handy Queries

*Source: server/database/handy-queries/index.html*

# Handy Queries¶

The purpose of this document is to provide a list of useful queries that can be used to help with various tasks.

If you think a query could be helpful and added to this list, suggest it in EQEmu server help.

## Delete All #gmzone Instances¶

```
`DELETE from instance_list WHERE id IN (SELECT value FROM `data_buckets` WHERE `key` LIKE '%gmzone%');
DELETE from instance_list_player WHERE id IN (SELECT value FROM `data_buckets` WHERE `key` LIKE '%gmzone%');
DELETE from data_buckets WHERE `key` LIKE '%gmzone%';
`
```

## Find All Player Accounts By Player Name¶

```
`set @player_name = 'Player';

SELECT
 *
FROM
 account
WHERE
 id = (select account_id from character_data where name = @player_name);
`
```

## Find All Accounts by IP tied to Character Name¶

```
`set @player_name = 'Player';

SELECT
 account_ip.accid,
 account_ip.ip,
 account.name,
 account.charname,
 account_ip.lastused
FROM
 account_ip
 INNER JOIN account ON account_ip.accid = account.id -- Join account table to get account data
 WHERE
 account_ip.ip IN ( -- Get all IP's via accid 
 SELECT
 account_ip.ip
 FROM
 account_ip
 WHERE
 account_ip.accid = ( -- Get account_id by player name
 SELECT
 character_data.account_id
 FROM
 character_data
 WHERE
 name = @player_name))
 GROUP BY
 account.id
 ORDER BY
 account_ip.lastused DESC;
`
```

## Find All Accounts by IP tied to Character Name Concat Result¶

```
`set @player_name = 'Player';

SELECT
 DISTINCT GROUP_CONCAT(account.id)
FROM
 account_ip
 INNER JOIN account ON account_ip.accid = account.id -- Join account table to get account data
WHERE
 account_ip.ip IN ( -- Get all IP's via accid 
 SELECT
 account_ip.ip
 FROM
 account_ip
 WHERE
 account_ip.accid = ( -- Get account_id by player name
 SELECT
 character_data.account_id
 FROM
 character_data
 WHERE
 name = @player_name))
ORDER BY
 account_ip.lastused DESC;
`
```

## Find All Spells for Sale¶

The following query looks for all spells that are for sale by NPCs. This is useful for finding spells that are not currently for sale, or for finding spells that are for sale within an era.

```
`SELECT
 i.id,
 i.Name,
 m.merchantid,
 m.min_expansion as merchant_min,
 m.max_expansion as merchant_max,
 st.max_expansion as spawn2_max,
 st.min_expansion as spawn2_min,
 st.enabled as spawn2_enabled,
 st.zone,
 n.name,
 n.lastname
FROM
 items i,
 merchantlist m,
 npc_types n,
 spawnentry se,
 spawn2 st
WHERE
 m.merchantid = n.id AND
 se.npcID = n.id AND
 se.spawngroupID = st.spawngroupID AND
 m.item = i.id AND
 st.enabled = '1' AND
 se.chance > '0' AND
 st.version = '0' AND
 n.id < '347000' AND
 (m.max_expansion >= '9' or m.max_expansion = '-1') AND
 (m.min_expansion <= '9' or m.min_expansion = '-1') AND
 (st.max_expansion >= '9' or st.max_expansion = '-1') AND
 (st.min_expansion <= '9' or st.min_expansion = '-1') AND
 (i.Name LIKE 'Song:%' OR i.Name LIKE 'Tome of %' OR i.Name LIKE 'Spell: %');
`
```

## Find Spells that Teleport to Zones with x Expansion¶

Below example looks for spells that are greater than expansion 8 (Omens of War) that teleport to zones that are greater than expansion 8 (Omens of War).

```
`SELECT
 id,
 teleport_zone,
 `name`,
 (( SELECT expansion FROM zone WHERE teleport_zone = short_name LIMIT 1 ) - 1 ) AS expansion 
FROM
 spells_new 
WHERE
 teleport_zone = ( SELECT short_name FROM zone WHERE teleport_zone = short_name LIMIT 1 ) 
 AND (( SELECT expansion FROM zone WHERE teleport_zone = short_name LIMIT 1 ) - 1 ) > 8;
`
```

## Find Spells that Teleport to Zones with x Expansion (item, zone, npc assoc)¶

```
`SELECT
 merchantid,
 item,
 min_expansion,
 (select expansion - 1 from zone where short_name = (select teleport_zone from spells_new where id = (select scrolleffect from items where id = item)) limit 1) as proposed_expansion,
 (select `name` from items where id = item) as item_name,
 ( SELECT NAME FROM npc_types WHERE merchant_id = merchantid LIMIT 1 ) AS npc,
 (
 SELECT
 zone 
 FROM
 spawn2 
 WHERE
 spawngroupID = ( SELECT spawngroupID FROM spawnentry WHERE npcID = ( SELECT id FROM npc_types WHERE merchant_id = merchantid LIMIT 1 ) LIMIT 1 ) 
 ) AS zone 
FROM
 merchantlist 
WHERE
 item IN (
 SELECT
 id 
 FROM
 items 
 WHERE
 scrolleffect IN (
 SELECT
 id 
 FROM
 spells_new 
 WHERE
 teleport_zone = ( SELECT short_name FROM zone WHERE teleport_zone = short_name LIMIT 1 ) 
 AND (( SELECT expansion FROM zone WHERE teleport_zone = short_name LIMIT 1 ) - 1 ) > 8 
 ) 
 )
 ORDER BY min_expansion;
`
```

## NPC's by Zone and Version¶

```
`select
 *
from
 npc_types
where
 id IN (
 select
 spawnentry.npcID
 from
 spawnentry
 join spawn2 on spawn2.spawngroupID = spawnentry.spawngroupID
 where
 spawn2.zone = 'crushbone'
 and spawn2.version = 0
 );
`
```

## Online Characters¶

Filters by characters saved within the past 10 minutes

```
`SELECT
 character_data.account_id,
 character_data.name,
 character_data.zone_id,
 COALESCE((select zone.short_name from zone where zoneidnumber = character_data.zone_id LIMIT 1), "Not Found") as zone_name,
 character_data.zone_instance,
 character_data.x,
 character_data.y,
 character_data.z,
 character_data.heading,
 COALESCE((select guild_id from guild_members where char_id = character_data.id), 0) as guild_id,
 (select guilds.name from guilds where id = ((select guild_id from guild_members where char_id = character_data.id))) as guild_name,
 FROM_UNIXTIME(character_data.last_login) AS date_time
FROM
 character_data
WHERE
 last_login > (UNIX_TIMESTAMP() - 600)
ORDER BY character_data.name;
`
```

## Online Accounts Unique Addresses¶

Filters by characters saved within the past 10 minutes

```
`SELECT
 character_data.account_id,
 character_data.name,
 character_data.zone_id,
 character_data.zone_instance,
 character_data.x,
 character_data.y,
 character_data.z,
 character_data.heading,
 COALESCE((select guild_id from guild_members where char_id = character_data.id), 0) as guild_id,
 (select guilds.name from guilds where id = ((select guild_id from guild_members where char_id = character_data.id))) as guild_name,
 FROM_UNIXTIME(character_data.last_login) AS date_time,
 (select ip from account_ip where account_ip.accid = character_data.account_id LIMIT 1) as ip_address,
 count(*) as count
FROM
 character_data
WHERE
 last_login > (UNIX_TIMESTAMP() - 600)
 group by ip_address
ORDER BY count desc;
`
```

## Local empty id's in a table¶

Displays all empty id's in a given table

```
`SELECT
 CONCAT(z.expected, IF(z.got-1>z.expected, CONCAT(' thru ',z.got-1), '')) AS missing
FROM (
 SELECT
 @rownum:=@rownum+1 AS expected,
 IF(@rownum=id, 0, @rownum:=id) AS got
 FROM
 (SELECT @rownum:=0) AS a
 JOIN tablename
 ORDER BY id
 ) AS z
WHERE z.got!=0;
`
```

## List total number of epics by class/epic type¶

Lists total epics by class/epic type

```
`SELECT
 c.class_name AS Class,
 i.Name AS Epic_Name,
 count(c.class_name) AS Count
FROM
 character_data a,
 inventory b,
 class_list c,
 items i,
 account z
WHERE
 a.id = b.charid AND
 a.class = c.class_id AND
 b.itemid = i.id AND
 a.account_id = z.id AND
 z.`status` BETWEEN '0' AND '15' AND
 a.is_deleted = '0' AND
 i.epicitem
GROUP BY Epic_Name
ORDER BY Class;
`
```

---

## Multi Tenancy

*Source: server/database/multi-tenancy/index.html*

# Multi Tenancy¶

Warning

This feature is for advanced server operators

## What is Multi Tenancy in Software?¶

There are several types of multi-tenancy in Software, the one we're going to be talking about implemented in the server backend is described as simply being able to use different database connections for different types of data

Info

Multi-tenant architecture hosts data in multiple databases. This model is relatively complex in terms of management and maintenance, but tenants can be separated by a chosen criterion.

## How is Multi-Tenancy Used in the Server?¶

As of this writing today; you can optionally declare a separate database connection other than your main database connection that can be a source of **content data**

**Content data** includes world data such as **NPCs, Zones, Merchants, Spawns, Doors, Objects** etc.

### Configuration¶

Today you can declare your database configuration like so; everything will load out of this connection by default, using a content database connection is **entirely optional**

```
`cat eqemu_config.json | jq '.server.database'
{
 "db": "peq",
 "host": "mariadb",
 "port": "3306",
 "username": "eqemu",
 "password": "eqemu"
}
`
```

Now if you wanted to configure a content database source you would declare another database connection section that resembles the following

```
`cat eqemu_config.json | jq '.server.content_database'
{
 "db": "peq_content",
 "host": "content-cdn.projecteq.net",
 "port": "16033",
 "username": "content-user",
 "password": "content-password"
}
`
```

## Why Would I Want to Use This?¶

The notion of having a content database source is very powerful because it solves for the following use cases

- **Developing content on a local development server** which has access to a remote content database connection shared with production, allowing a developer to constantly **repop zones, refresh scripts locally** without impacting the state of the **production zone server**

- A developer can **develop scripts locally**, create database entries that are assigned an ID that will be used in production without having to reconcile data and duplicate ID's in an isolated local database up to a remote database which is very kludgy and cumbersome

- It **decouples the responsibilities of table types** in the source, content data should not be written to systemically from a server to store player state, zone state, world state and only hold mostly read only data for content

- It allows **many production servers** to use the same exact data source; **heavily **eliminating duplication of work and maintenance of keeping several different content datasets up to date. 

- It allows someone to make **different variants / flavors** of the same server using **different local rulesets**

- It enables the Project PEQ Expansions project to be able to have many **standing replicas of each Expansion / Era;** enabling PEQ developers to jump between eras and maintain era accuracy

## How Do I Know What Tables Belong to Which Category?¶

Database table schema reference is maintained in the source at **./common/database_schema.h** and all table types are defined under **DatabaseSchema::GetContentTables()**

https://github.com/EQEmu/Server/blob/master/common/database_schema.h#L165

---

## Performance Tuning

*Source: server/database/performance-tuning/index.html*

# Performance Tuning

Info

Akkadius tips and tricks

I've been asked MySQL performance related questions over the years so I decided to put together a short reference guide for those who want to properly tune their MySQL instance for performance.

You can get very complicated with all of this if you want, but for a majority EQEmu Server use cases there is no need to and I'm going to keep this very simple.

Our EverQuest Emulator server code base is very optimized to run efficient queries and a lot of work has been done to do so over the years; however - it is still a good idea to make sure you have a few knobs tweaked in your MySQL setup

What makes me qualified to give advice on this topic? I've been running MySQL servers for well over 10 years and have ran 100's of MySQL nodes in high scale environments and have seen a thing or two.

## Server Operators¶

Make sure in your MySQL config `my.cnf` you've allocated enough `innodb_buffer_pool_size` to hold your dataset in memory. There are ways to calculate this in more usage oriented ways but for literally most people just set it to 1GB

```
`innodb_buffer_pool_size=1G
`
```

Done. Move on, no need to look at any other knobs you just covered a majority of your ground and you can move on with your life.

If you want to know why you're setting this variable, it is one of the most important settings for modern InnoDB storage engines. This buffer pool is memory allocated in which table caches, table indexes are stored and keep all of your table operations fast.

## MariaDB Config Location¶

The location of your MySQL config varies on your operating system

| 

OS 
| Location 

| **Linux** 
| /etc/mysql/my.cnf 

| **Windows** 
| INSTALLDIR\data\my.cnf or my.ini 

## Hardware¶

If you're hosting a sizeable server, make sure you're not running super slow hard disk drives (5400RPM) to be holding your on-disk data for MySQL. Most modern computers and servers are using SSD or NVMe disks these days so if you are rocking this kind of disk for hardware you will have zero issues.

## EverQuest Emulator Developers¶

Now this section is no longer for server operators but for developers.

- **No Selects in for-loops** Make sure you're not firing selects off constantly or in any hot paths. 

- **Bulk Load Where Possible** Pre-load and bulk load data where necessary and loop through it later instead of doing individual selects inside of for loops. We spent many years unearthing all of the sins we had in the code, we don't need any more!

- **Bulk Load Data in Memory Where Possible** If certain datasets can be held in memory that aren't very large, make use of that instead of querying the database often for data that isn't changing

- **Bulk Insert Where Possible** If you have multiple items being saved in batch, use bulk inserts (chained insert or replace into statements) to save data

---

## Version Patching

*Source: server/database/version-patching/index.html*

# Version Patching

Version patching is the idea of taking a base PEQ database and "patching it" with changes for your custom server, in a way it can be ran multiple times, and versioned in git.

This is a discipline that lends itself to custom server changes that you want to be destructive and have an "undo button" with (reset database to base, and re-inject changes).

All links are referenced to an archive server called rebuildeq/server

## Makefile Injects¶

In this Makefile you can see how a new `make inject-custom` was added.

- 

The first line has `@cd base && make inject --no-print-directory`, this went to the base subfolder and ran the `make inject` command. Each inject was categorized by a subfolder. We'll use item as an example.

- 

Inside base/item subfolder, there is a Makefile that sourced all the sql files in this directory (salvaging-skills.sql, boxes.sql, parts.sql, etc) and any subfolder sql files.

- 

These sql files are all built to be applied multiple times with no side effects. Such as:

- 

aug.sql patched aug slots to a new simplified variant.

## card.sql¶

card.sql is a custom aug system introduced by the server,

The first line (REPLACE INTO) is what I call a "template" item, this was inserted into the items table, and was the baseline all cards derived from.

Temporary table line 6, this is a temporary table labeled `card_base_table`. What this does is it creates a temporary table that takes the first record of the template, and puts it into a temporary table, so it can be manipulated quickly, and then placed back in the normal items table once applied.

Stored Procedure `tt_start` line 9-13, this takes the temporary card_base_table and copies it to another temporary table item_table, this is where you can manipulate the template with your changes.

Stored Procedure `tt_end` [line 15-20(https://github.com/rebuildeq/server/blob/main/base/item/aug/card.sql#L15), this takes the temporary item_table and does an REPLACE INTO into the real items table, this means if the item already exists, it will be updated, if it doesn't exist, it will be inserted.

Some variables get SET on lines 24-27:

```
`SET @Chest = 131072;
SET @Legs = 262144;
SET @Finger = 98304;
SET @Weapon = 8192;
`
```

These can be used during injects so you don't have to hard code numbers and keep it a bit more human readable.

Now on to the real intent: inserting data

```
`CALL tt_start; UPDATE item_table SET id=148101, name='Dragon Card', slots=@Chest, icon=6152, manaregen=2 ; CALL tt_end;
CALL tt_start; UPDATE item_table SET id=148102, name='Insect Card', slots=@Chest, icon=6170, hp=10, ac=10; CALL tt_end;
CALL tt_start; UPDATE item_table SET id=148103, name='Animal Card', slots=@Chest, icon=6145, ac=10, aagi=5, attack=5; CALL tt_end;
`
```

This is what ultimately does the changes.
- Call tt_start, to create a copy of the template in a temporary table
- Do edits to the template unique for the item
- Call tt_end, to apply the changes to the real items table

Now a single line can do all these operations, making it easy to read, and easy to version control, and edit in the future.

---

## Item Changes

*Source: server/expansions/classic/item-changes/index.html*

# Item Changes¶

| 

Item 
| Era 
| Zone 
| Obtained 
| Nerf/Removal Info 

| Silk Lined Steel Armor 
| Classic 
| Ak'Anon 
| Rylin Coil 
| Removed items / Restricted classes (was GNM/ALL) 

| Box of Abu-Kar 
| Classic 
| ALL 
| Level 35+ Mobs 0.01% 
| Removed item 

| A Servant's Blade 
| Classic 
| Befallen 
| A Servant of T'Vyl 
| Removed mob, removed item 

| Ebon Scythe 
| Classic 
| Befallen 
| Asaka L\Rei 
| Removed item / possibly mob? 

| Enchanted Fine Steel Bastard Sword 
| Classic 
| Befallen 
| Knight V`Tal 
| Removed item (1.8% drop rate) / mob 

| Enchanted Fine Steel Great Staff 
| Classic 
| Befallen 
| Kahaptra Z`Taj 
| Removed item (4.8% drop rate) / mob 

| Enchanted Fine Steel Long Sword 
| Classic 
| Befallen 
| Knight V`Tal 
| Removed item (98% drop rate) / mob 

| Enchanted Fine Steel Morning Star 
| Classic 
| Befallen 
| Asaka L`Rei 
| Removed item (common drop) / mob 

| Enchanted Fine Steel Rapier 
| Classic 
| Befallen 
| Korven Nisere 
| Removed item (very rare drop) / mob 

| Pristine Studded Boots 
| Classic 
| Befallen 
| Guardian of T`Vyl 
| Removed item / mob 

| Pristine Studded Bracer 
| Classic 
| Befallen 
| Guardian of T`Vyl 
| Removed item / mob 

| Pristine Studded Gloves 
| Classic 
| Befallen 
| Guardian of T`Vyl 
| Removed item / mob 

| Pristine Studded Leggings 
| Classic 
| Befallen 
| Guardian of T`Vyl 
| Removed item / mob 

| Pristine Studded Sleeves 
| Classic 
| Befallen 
| Guardian of T`Vyl 
| Removed item / mob 

| Pristine Studded Tunic 
| Classic 
| Befallen 
| Guardian of T`Vyl 
| Removed item / mob 

| Shimmering Ruby Stiletto 
| Classic 
| Befallen 
| Korven Nisere 
| Removed item / mob 

| Silver Plated War Sword 
| Classic 
| Befallen 
| Baron Telyx V`Zher 
| Removed item / mob 

| Skeletal Rod 
| Classic 
| Befallen 
| Skeleton Lrodd 
| Removed item 

| Thaumaturgist's Sash 
| Classic 
| Befallen 
| Arisen Thaumaturgist 
| Removed item / mob 

| Golem Metal Wand 
| Classic 
| Befallen / Temple of Cazic Thule 
| Kahaptra Z`Taj / Stone Golem 
| Removed item / mobs 

| Heartstone Amulet 
| Classic 
| Castle Mistmoore 
| Vampire Bodyguard 
| Removed item / mob 

| Small Brass Trumpet 
| Classic 
| Castle Mistmoore 
| a deathly usher 
| Removed item 

| Werewolf Tail 
| Classic 
| Castle Mistmoore 
| Magrek 
| Removed item / mob 

| Legionnaire Torn Shoulderpads 
| Classic 
| Crushbone 
| Orc Legionnaires 
| Removed item / Quest unknown 

| Ornate Runed Dagger 
| Classic 
| Crushbone 
| Ambassador D`Vinn 
| Removed item 

| Orc Wrath Bracer 
| Classic 
| East Commonlands 
| Lord Shin Ree 
| Removed item 

| Thex Dagger 
| Classic 
| Felwithe 
| Princess Lenya 
| Changed quest reward / Quest: Silent Watch Shield 

| Scouting Dagger 
| Classic 
| High Keep 
| Bloody Shank Quest 
| Removed as quest reward / see Scout's Dagger Quest 

| Shralok Pack 
| Classic 
| Highpass Hold 
| Recfek Shralok 
| Added LORE group 

| Basilisk Bracer 
| Classic 
| Lavastorm Mountains 
| Deep Lava Basilisk 
| Removed mob 

| A Jagged Shard of Bone 
| Classic 
| Lesser Faydark 
| Undead Sprite 
| Removed Fear proc, Removed from loot tables 

| Blighted Mare Hide 
| Classic 
| Lesser Faydark 
| Blighted Mare 
| Removed item / Quest: Child of Innorruuk 

| Blighted Mare Hoof 
| Classic 
| Lesser Faydark 
| Blighted Mare 
| Removed item / Quest unknown 

| Ebon Backpack 
| Classic 
| Lesser Faydark 
| Zyrria I`Vanres 
| Removed mob / Quest: Child of Innorruuk 

| Emerald Cloak of the Faydark 
| Classic 
| Lesser Faydark 
| Talisyn 
| Removed mob / Quest: Boodboil 

| Equestrielle's Eye 
| Classic 
| Lesser Faydark 
| Equestrielle the Corrupted 
| Removed item / mob 

| Glimmer Ring 
| Classic 
| Lesser Faydark 
| Mina Glimmerwing 
| Removed item 

| Illusionists Stone 
| Classic 
| Lesser Faydark 
| Old Dimmerwing 
| Removed item 

| Lady Nidra's Wings 
| Classic 
| Lesser Faydark 
| Lady Nidra 
| Removed item / mob / Quest unknown 

| Staff of Temperate Flux 
| Classic 
| Lesser Faydark 
| Staff of Elemental Flux Quest 
| Removed item / Quest: Staff of Elemental Flux 

| Unicorn Horn 
| Classic 
| Lesser Faydark 
| Equestrielle the Corrupted 
| Removed item / mob 

| Guise of the Deceiver 
| Classic 
| Lower Guk 
| Ghoul Assassin 
| Removed item 

| Manastone 
| Classic 
| Lower Guk 
| Evil Eye 
| Removed item 

| Axe of the Slayers 
| Classic 
| Mountains of Rathe 
| Grazhak the Berzerker 
| Proc changed from lvl 1 to lvl 30 

| Cloak of Shadows 
| Classic 
| Nagafen's Lair 
| Guano Harvester 
| Removed item 

| Red Dragon Tooth 
| Classic 
| Nagafen's Lair 
| Lord Nagafen 
| Removed item 

| Bone Handed Dagger 
| Classic 
| Najena 
| Linara Parlone 
| Removed item 

| Journeyman's Boots 
| Classic 
| Najena 
| Drelzna 
| Removed item / quest from SolRo Tower 

| Writhing Lash 
| Classic 
| Najena / Unrest 
| Tentacle Terrors 
| Removed item / Changed to Tenticle Whip? 

| Priest of Innoruuk's Heart 
| Classic 
| Nektulos Forest 
| Teir`Dal Surveyor 
| Removed item / Quest unknown 

| Glowing Blade 
| Classic 
| Neriak 
| Merchants in the Neriak Zones 
| Removed item / Quest unknown 

| Enlarged Fire Beetle Eye 
| Classic 
| North Qeynos / Nagafen's Lair 
| Queen Kliknik / Queen Klaknak 
| Removed item (uncommon drop) 

| Deluxe Sewing Kit 
| Classic 
| Numerous 
| Large Sewing Kits made 8 (from 10) 
| Replaced Large Sewing kits with Deluxe 

| Denon's Disruptive Discord 
| Classic 
| Numerous 
| Bard Song Vendors 
| Nerfed to only affect stationary mobs 

| Egg Shaped Pumice 
| Classic 
| Numerous 
| Vendors in Starting Cities 
| Removed item 

| Sense Magic Spell 
| Classic 
| Numerous 
| Spell vendors 
| Replaced by True North 

| Ring of the Oceancaller 
| Classic 
| Ocean of Tears 
| Allizewsaur 
| Removed item 

| Stein of Moggok 
| Classic 
| Oggok 
| Stein of Moggok Quest 
| Effect changed to 3 Charges from Combat Proc 

| Scimitar of the Mistwalker 
| Classic 
| Permafrost 
| Lady Vox 
| Nerfed effect: lvl 45 shm frenzied spirit proc 

| Staff of Forbidden Rites 
| Classic 
| Permafrost 
| Lady Vox 
| Removed item 

| White Dragon Tooth 
| Classic 
| Permafrost 
| Lady Vox 
| Removed item 

| Glowing Black Stone 
| Classic 
| Qeynos Hills 
| Pyzjin 
| Removed Range Slot 

| Cros Treewind's Staff 
| Classic 
| Qeynos Hills 
| Cros Treewind 
| Removed item / Mob 

| Issued Footman Armor 
| Classic 
| Qeynos Hills / East Freeport 
| Sir Edwin Motte 
| Removed item / Quest for 4 ruined wolf pelts 

| Black Iron Girdle 
| Classic 
| Runnyeye Citadel 
| The Goblin King 
| Revamp of Runneye 

| Black Iron Medallion 
| Classic 
| Runnyeye Citadel 
| The Goblin King 
| Revamp of Runneye 

| Blackened Iron Armor 
| Classic 
| Runnyeye Citadel 
| The Goblin King / a pickclaw foeslicer 
| Revamp of Runneye 

| Blackened Iron Bastard Sword 
| Classic 
| Runnyeye Citadel 
| The Goblin King / a pickclaw crusader 
| Revamp of Runneye 

| Blackened Iron Coif 
| Classic 
| Runnyeye Citadel 
| The Goblin King / a pickclaw foeslicer 
| Revamp of Runneye 

| Blackened Iron Totem 
| Classic 
| Runnyeye Citadel 
| The Goblin King / Sludge Damnkmire 
| Revamp of Runneye 

| Blackened Wand 
| Classic 
| Runnyeye Citadel 
| The Goblin King / Priest Amiaz 
| Revamp of Runneye 

| Oaken Scimitar 
| Classic 
| South Karana 
| Grizzelknot 
| Removed item / Quest unknown 

| Ball of Golem Clay 
| Classic 
| Temple of Cazic Thule 
| a stone golem 
| Removed item 

| Emerald Armor Breastplate 
| Classic 
| Temple of Cazic Thule 
| Cazic Cenobite 
| Removed item / mob 

| Green Platemail Gloves 
| Classic 
| Temple of Cazic Thule 
| Cazic Cenobite 
| Removed item / Check Green Plate Gauntlets 

| Rubicite Armor 
| Classic 
| Temple of Cazic Thule 
| Thul Tae Ew Cenobite 
| Removed item / mob 

| Rubicite Breastplate 
| Classic 
| Temple of Cazic Thule 
| Avatar of Fear 
| Removed item / mob 

| Rubicite Cloak 
| Classic 
| Temple of Cazic Thule 
| Thul Tae Ew Cenobite 
| Removed item / mob 

| Rubicite Collar 
| Classic 
| Temple of Cazic Thule 
| Thul Tae Ew Cenobite 
| Removed item / mob 

| Rubicite Mask 
| Classic 
| Temple of Cazic Thule 
| Thul Tae Ew Cenobite 
| Removed item / mob 

| Rubicite Pauldron 
| Classic 
| Temple of Cazic Thule 
| Thul Tae Ew Cenobite 
| Removed item / mob 

| Rubicite Waistband 
| Classic 
| Temple of Cazic Thule 
| Thul Tae Ew Cenobite 
| Removed item / mob 

| Sorrowsong Boots 
| Classic 
| Temple of Cazic Thule 
| Gyrating Mass 
| Removed item / mob / nerfec clicklevel to 51+

---

## Zone Changes

*Source: server/expansions/classic/zone-changes/index.html*

| 

Zone Name 
| Short Name 
| Era 
| Patch Date (ISO 8601) 
| Notes 

| Plane of Fear 
| fearplane 
| Classic 
| 1999-07-26 
| Initial Release 

| The Temple of Solusek Ro 
| soltemple 
| Classic 
| 1999-10-13 
| Initial release. Available via the newly implemented optional patch system. 

| Kedge Keep 
| kedge 
| Classic 
| 1999-10-28 
| Enhanced with new items and creatures 

| Plane of Hate 
| hateplane 
| Classic 
| 1999-11-03 
| Initial release. Patch message is released on Wednesday but states actual opening occurred 4 days prior on Sunday (1999-10-31) after the Halloween event. Must be 46th level or greater to enter. 

| Plane of Sky 
| airplane 
| Classic 
| 2000-01-20 
| Initial release 

| Paineel 
| paineel 
| Classic 
| 2000-02-17 
| Initial release 

| Kerra Ridge 
| kerraridge 
| Classic 
| 2000-04-10 
| Initial release 

| The Lair of the Splitpaw 
| paw 
| Classic 
| 2000-04-10 
| 1st revamp 

# Zone Changes¶

## Ak'Anon (akanon)¶

## The Arena (arena)¶

## Befallen (befallen)¶

## Gorge of King Xorbb (beholder)¶

## Blackburrow (blackburrow)¶

## Butcherblock Mountains (butcher)¶

## Dagnor's Cauldron (cauldron)¶

## The Temple of Cazic-Thule (cazicthule)¶

## West Commonlands (commons)¶

## Crushbone (crushbone)¶

## Sunset Home (cshome)¶

## Eastern Plains of Karana (eastkarana)¶

## East Commonlands (ecommons)¶

## Erudin (erudnext)¶

## The Erudin Palace (erudnint)¶

## Erud's Crossing (erudsxing)¶

## Everfrost Peaks (everfrost)¶

## The Feerrott (feerrott)¶

## Northern Felwithe (felwithea)¶

## Southern Felwithe (felwitheb)¶

## East Freeport (freporte)¶

## North Freeport (freportn)¶

## West Freeport (freportw)¶

## The Greater Faydark (gfaydark)¶

## Grobb (grobb)¶

## The Ruins of Old Guk (gukbottom)¶

## The City of Guk (guktop)¶

## Halas (halas)¶

## High Keep (highkeep)¶

## Highpass Hold (highpass)¶

## Innothule Swamp (innothule)¶

## South Kaladim (kaladima)¶

## North Kaladim (kaladimb)¶

## Kedge Keep (kedge)¶

## Kerra Isle (kerraridge)¶

## Kithicor Forest (kithicor)¶

## Lake Rathetear (lakerathe)¶

## The Lavastorm Mountains (lavastorm)¶

## The Lesser Faydark (lfaydark)¶

## The Castle of Mistmoore (mistmoore)¶

## Misty Thicket (misty)¶

## Najena (najena)¶

## The Nektulos Forest (nektulos )¶

## Neriak - Foreign Quarter (neriaka)¶

## Neriak - Commons (neriakb)¶

## Neriak - 3rd Gate (neriakc)¶

## The Northern Plains of Karana (northkarana)¶

## Northern Desert of Ro (nro)¶

## Oasis of Marr (oasis)¶

## Oggok (oggok)¶

## Ocean of Tears (oot)¶

## The Lair of the Splitpaw (paw)¶

## The Permafrost Caverns (permafrost)¶

## The Qeynos Aqueduct System (qcat)¶

## The Western Plains of Karana (qey2hh1)¶

## South Qeynos (qeynos)¶

## North Qeynos (qeynos2)¶

## The Qeynos Hills (qeytoqrg)¶

## The Surefall Glade (qrg)¶

## The Rathe Mountains (rathemtn)¶

## Rivervale (rivervale)¶

## The Liberated Citadel of Runnyeye (runnyeye)¶

## Solusek's Eye (soldunga)¶

## Nagafen's Lair (soldungb)¶

## The Southern Plains of Karana (southkarana)¶

## Southern Desert of Ro (sro)¶

## Steamfont Mountains (steamfont)¶

## Toxxulia Forest (tox)¶

## The Estate of Unrest (unrest¶

---

## Design Considerations

*Source: server/expansions/design-considerations/index.html*

# Design Considerations¶

## Client¶

- There will be no mechanism to close off clients based on server expansion settings. 

- Server Operators are welcome to customize client requirements.

- Spells (spells_us.txt) will **not** have expansion settings:

- Various clients have spell count limitations

- spells_us.txt should be part of a standard "patch day" download when an expansion is launched

- Spell gems and spell book icons will **not **have expansion settings

- Models will **not** have expansion settings

- Feel free to customize using eqclient.ini pre-Luclin models

- Server operators can provide any models they wish

- Client Maps are enabled based on expansion settings through the client

- The actual map content will not be controlled with expansion settings

- Server operators can choose to provide any maps they wish

- Skill Caps???

- db_str???

- base_data???

## Quest Scripts¶

- An expansion setting should be exposed to the quest API

- Scripts should utilize the expansion setting to "mask" portions of the script:

```
`sub EVENT_SAY {
 if ($text=~/hail/i) {
 if (quest::is_the_ruins_of_kunark_enabled()) {
 quest::say("Something.");
 }
 elsif (quest::is_the_scars_of_velious_enabled()) {
 quest::say("Something different.");
 }
 elsif (quest::is_the_shadows_of_luclin_enabled()) {
 quest::say("Something else entirely.");
 }
 #:: Etc.
 }
}
`
```

## World¶

- Zone maps files will need to allow zone version support

- .nav, .map, .wtr should exist for each **version** of the zone

- All files should be standard on server install

- Versions to be defined in the database

- Examples: nektulos, lavastorm

- Zone table customization to be covered below

- Examples: Freeport, Highpass

## Database Tables¶

### AAs¶

Obviously AAs were added at each expansion. As AAs make use of spells, it would be incumbent upon the server operator to include any out-of-era spells in their server files.

- aa_ability

- Here we likely need a min/max expansion setting

- Don't forget HT/LoH

- aa_actions

- aa_effects

- aa_ranks

- aa_rank_effects

- aa_rank_prereqs

- aa_required_level_cost

- aa_timers

- altadv_vars

- Were AAs regrouped during our timeline? We may need an expansion setting on this expansion setting.

### Account¶

Accounts have an expansion setting on them that opens race / class combos. **This should probably be examined at part of this development cycle.**

- account

- account_flags

- account_ip

- account_rewards

- Veteran rewards will need min/max expansion settings

- sharedbank

- Does this use the account expansion setting?

### Admin¶

- banned_ips

- bot_command_settings

- bug_reports

- bugs

- chatchannels

- Chatchannels could make use of a rule setting to be turned on at the appropriate time for status < X.

- class_skill

- command_settings

- db_version

- discovered_items

- eqtime

- eventlog

- fear_hints

- gm_ips

- hackers

- ip_exemptions

- level_exp_mods

- logsys_categories

- name_filter

- perl_event_export_settings

- petitions

- profanity_list

- races

- reports

- saylink

- start_zones

- Requires min/max expansion settings

- starting_items

- Requires min/max expansion settings

- variables

- veteran_reward_templates

### Adventures¶

These tables are all related to LDON. Presumably gating would occur with either zone access or npc_types for Adventures.

- adventure_details

- adventure_members

- adventure_stats

- adventure_template

- adventure_template_entry

- adventure_template_entry_flavor

### Alternate Currency¶

The actual currencies were introduced on some timeline. Given that an item_id is assigned and that each currency is a table entry, likely no min/max expansion setting is required.

- alternate_currency

### Books¶

Text for items. Item availability would be controlled by lootdrop and merchantlist entries; likely no min/max expansion setting is required.

- books

### Bots¶

Please review, Uleat.

### Buyers¶

No action needed.

- buyer

### Characters¶

- character_activities

- character_alternate_abilities

- character_alt_currency

- character_auras

- character_bandolier

- Is access to the bandolier currently observing expansion setting?

- character_bind

- character_buffs

- character_corpses

- character_corpse_items

- character_currency

- character_data

- character_disciplines

- character_enabledtasks

- character_inspect_messages

- character_item_recast

- character_languages

- character_leadership_abilities

- character_material

- character_memmed_spells

- character_pet_buffs

- character_pet_info

- character_pet_inventory

- character_potionbelt

- Is access to the potion belt currently observing expansion setting?

- character_skills

- character_spells

- character_tasks

- character_task_lockouts

- character_tribute

- char_create_combinations

- Uses existing expansion setting.

- char_create_point_allocations

- Requires min/max expansion settings

- char_recipe_list

- friends

- keyring

- Is access to the key ring currently observing expansion setting?

- lfguild

- mail

- player_titlesets

### Client Files¶

Please note the Client section above.

- base_data

- db_str

- skill_caps

- spells_new

- NO expansion setting.

### Data Storage¶

No action needed.

- data_buckets

- quest_globals

### Doors¶

Certainly doors change throughout the various--keyitem(s) came and went, destination settings changed (IE tox vs toxxulia PoK book).

- doors

- Requires min/max expansion setting

### Factions¶

Generally factions are gated by access to mobs. Some factions were added to npc_types as time went on, so under the NPC tables we'll want to look at min/max expansion settings. Noudess should probably confirm that faction_list_mod didn't change, especially.

- client_faction_associations

- client_faction_names

- client_server_faction_map

- custom_faction_mappings

- faction_base_data

- faction_list

- faction_list_mod

- faction_values

### Graveyards¶

Graveyards were gated by access to zones. No min/max expansion setting required.

- graveyard

### Ground Spawns¶

Ground spawns, like fishing, certainly changed over time. A min/max expansion setting is required.

- ground_spawn

- Requires min/max expansion setting

### Groups¶

Player table. No min/max expansion setting required.

- group_id

- group_leaders

### Guilds¶

The guild hall was added during DoN, some guild management tools were added during LoY. 

- guilds

- guild_bank

- guild_ranks

- guild_members

- guild_relations

### Grids¶

Grids do not need expansion settings as the associated spawn2 point would gate the settings.

- grid

- grid_entries

### Horses¶

Horses were introduced and evolved over time, but likely they would be gated through quest scripts and merchantlist entries.

- horses

### Instances¶

Player table. No min/max expansion setting required.

- instance_list

- instance_list_player

### Inventory¶

Player table. No min/max expansion setting required.

- inventory

- inventory_snapshots

- inventory_versions

### Items¶

Items would be gated by lootdrop entries and merchantlists. Some consideration could be given to nerfed items, but ultimately the server operator should probably make that decision. 

- items

- item_tick

### Loginserver¶

World utility. No min/max expansion setting required.

- login_accounts

- login_api_tokens

- login_server_admins

- login_server_types

- login_world_servers

### Loot¶

Loot requires min/max expansion settings on multiple fronts:

- global_loot

- Requires min/max expansion settings

- Example: Box of Abu-Kar

- lootdrop

- Requires min/max expansion settings

- Example: Manastone

- lootdrop_entries

- loottable

- Requires min/max expansion settings

- Example: Manastone

- loottable_entries

### Mercenaries¶

Mercenaries did evolve over time, however, are gated by zone/quest access.

- mercs

- merc_armorinfo

- merc_buffs

- merc_inventory

- merc_merchantlist_entries

- merc_merchant_templates

- merc_merchant_template_entries

- merc_name_types

- merc_npc_types

- merc_spell_lists

- merc_spell_list_entries

- merc_stance_entries

- merc_stats

- merc_subtypes

- merc_templates

- merc_types

- merc_weaponinfo

### Merchants¶

Merchantlists certainly changed over time.

- merchantlist

- Requires min/max expansion settings

- Example: any spell scrolls

- merchantlist_temp

### NPCs¶

NPCs require min/max expansion settings on at least factions. 

- npc_emotes

- npc_faction

- Requires min/max expansion settings

- Example: Primordial Malice

- npc_faction_entries

- npc_scale_global_base

- npc_spells

- npc_spells_effects

- npc_spells_effects_entries

- npc_spells_entries

- npc_types

- npc_types_metadata

- npc_types_tint

- proximities

### Objects¶

Objects require min/max expansion settings--zones changed over time.

- object

- Requires min/max expansion settings

- Example: LDON camps

- object_contents

### Pets¶

Pets would be gated by spell/aa access.

- pets

- pets_equipmentset

- pets_equipmentset_entries

### Query Server¶

World utility. No min/max expansions required.

- qs_merchant_transaction_record

- qs_merchant_transaction_record_entries

- qs_player_aa_rate_hourly

- qs_player_delete_record

- qs_player_delete_record_entries

- qs_player_events

- qs_player_handin_record

- qs_player_handin_record_entries

- qs_player_move_record

- qs_player_move_record_entries

- qs_player_npc_kill_record

- qs_player_npc_kill_record_entries

- qs_player_speech

- qs_player_trade_record

- qs_player_trade_record_entries

### Raids¶

Player table. No min/max expansion settings necessary.

- raid_details

- raid_leaders

- raid_members

### Rules¶

Rules certainly changed over time--the question is whether or not this should be handled with various rule sets, or make use of a min/max expansion setting.

- rule_sets

- rule_values

### Spawns¶

Spawns certainly evolve over time.

- respawn_times

- This may require min/max expansion setting

- spawn2

- Min/Max expansion setting required.

- spawnentry

- spawngroup

- spawn_conditions

- spawn_condition_values

- spawn_events

### Spells¶

Spells evolved over time. Please see "Client" section above--spells will not get a min/max expansion setting.

- auras

- blocked_spells

- damageshieldtypes

- spell_buckets

- spell_globals

- spells_new

### Tasks¶

These would be gated by quest scripts.

- completed_tasks

- goallists

- tasks

- tasksets

- task_activities

- task_replay_groups

### Timers¶

Player table. No min/max expansion settings.

- timers

### Titles¶

Titles are gated by character AAs / Skills / Class / Gender. Due to the inclusion of skills, titles would require min/max expansion since a tradeskill can surpass the lowest threshold, even in classic.

- titles

- Requires min/max expansion setting.

### Tradeskills¶

Tradeskills evolved over time and will require min/max expansion settings.

- fishing

- Requires min/max expansion setting

- forage

- Requires min/max expansion setting

- tradeskill_recipe

- Requires min/max expansion setting

- tradeskill_recipe_entries

### Traps¶

Some traps did evolve over time.

- ldon_trap_entries

- ldon_trap_templates

- traps

- Add min/max expansion settings

### Tributes¶

Tributes were added during GoD and evolved over time. Obviously merchantlist and lootdrop expansion settings would restrict item access to be used as tribute. Is this effected by world expansion setting?

- tributes

- tribute_levels

### Zones¶

Zones evolved over time--access to zones as well as zone points. Min/Max expansion settings are required.

- launcher

- launcher_zones

- zone

- Requires min/max expansion setting (rather than using status / level)

- zoneserver_auth

- zone_flags

- zone_points

- Requires min/max expansion settings

- Example: highpass vs. highpasshold

- zone_server

## Combat¶

- https://github.com/mackal/EQMechanics/wiki

```
`if IsClient():
 softcap = 350
 if GetClass() == WARRIOR and GetLevel() > 50:
 softcap = 430
 if (GetClass() == PALADIN or GetClass() == SHADOWKNIGHT or GetClass() == BARD) and GetLevel() > 50
 softcap = 403
 if (GetClass() == RANGER or GetClass() == ROGUE or GetClass() == MONK or GetClass() == BEASTLORD) and GetLevel() > 50
 softcap = 375

 cs_mod = 0
 cs_rank = GetAA(ComabtStability)
 if cs_rank == 1:
 cs_mod = 2
 elif cs_rank == 2:
 cs_mod = 5
 elif cs_rank == 3:
 cs_mod = 10

 softcap = softcap + (softcap * cs_mod / 100)

 if GetAA(PhysicalEnhancement):
 softcap = softcap + (2 * softcap / 100)

 if bonus <= softcap:
 return bonus

 if IsWarrior(): # melee, not priest/casters
 return (bonus - softcap) / 12 + softcap

 return softcap # hardcapped for everyone else
`
```

---

## Expansion and Content Filtering

*Source: server/expansions/expansion-content-filtering/index.html*

# Expansion and Content Filtering¶

The purpose of this guide is to highlight the design of the content filtering system

## Goal(s)¶

To be able to filter content based on current server expansion setting and additionally by using more granular flags for more specific use cases such as patches, or temporary events such as Fabled

## Implementation¶

First, to accomplish filtering by Expansion we need to be able to set a filterable context on any content-facing table

## Content Tables¶

The following tables are content-facing tables that have had context filters applied to them

- doors

- fishing

- forage

- global_loot

- ground_spawns

- lootdrop

- loottable

- merchantlist

- object

- spawn2

- spawnentry

- start_zones

- starting_items

- tradeskill_recipe

- traps

- zone

- zone_points

## Content Filter Columns¶

```
`+------------------------+-----------------------+------+-----+----------+----------------+
| Field | Type | Null | Key | Default | Extra |
+------------------------+-----------------------+------+-----+----------+----------------+
| min_expansion | tinyint(4) unsigned | NO | | 0 | |
| max_expansion | tinyint(4) unsigned | NO | | 0 | |
| content_flags | varchar(100) | YES | | NULL | |
| content_flags_disabled | varchar(100) | YES | | NULL | |
+------------------------+-----------------------+------+-----+----------+----------------+
`
```

## How the Filtering Works¶

There are two main categories of filtering, expansion filtering and content flag filtering

### Expansion Filtering¶

Expansion filtering is done through **min_expansion** and **max_expansion** fields.

The data filtering works by first using the current expansion context setting of the server. As of this writing today the **Expansion ID** is loaded from Rule **Expansion:CurrentExpansion** which has a value that corresponds with Expansion List Reference

### Content Flag Filtering¶

There are use cases where we need to enable or disable content table entries based on certain events, such as Fabled NPC spawns or a particular patch that was made in the past where perhaps a Merchant is no longer selling an item. Maybe the sleeper was killed and we no longer want an item to appear on a loot table, no longer want the sleeper to be able to be awakened etc.

```
`+-----------+-------------+------+-----+---------+----------------+
| Field | Type | Null | Key | Default | Extra |
+-----------+-------------+------+-----+---------+----------------+
| id | int(11) | NO | PRI | NULL | auto_increment |
| flag_name | varchar(75) | YES | | NULL | |
| enabled | tinyint(4) | YES | | NULL | |
| notes | text | YES | | NULL | |
+-----------+-------------+------+-----+---------+----------------+
`
```

### How the Filters Apply to Queries¶

The Expansion ID is set on process boot up as well as the content flags. Both of these get applied anytime a query is executed that goes through the content tables that use the **ContentFilterCriteria**

```
`ContentFilterCriteria::apply(std::string table_prefix = "")
`
```

�When any query runs through this function it has a set of criteria appended to the query that will determine how data returns back from the table

### Example Query¶

**Data** Merchants

**Current Expansion** -1 (All enabled)

**Content Flags** test_flag

```
`-- merchant query
...
AND (
 merchantlist.min_expansion <= 99
 OR merchantlist.min_expansion = 0
)
AND (
 merchantlist.max_expansion >= 99
 OR merchantlist.max_expansion = 0
)
AND (
 merchantlist.content_flags IS NULL
 OR CONCAT(',', merchantlist.content_flags, ',') REGEXP ',(test_flag),'
)
AND (
 merchantlist.content_flags_disabled IS NULL
 OR CONCAT(',', merchantlist.content_flags_disabled, ',') NOT REGEXP ',(test_flag),'
)
`
```

To explain the above filter a little bit, if our Merchant table didn't have any values set, it would load everything

If it had a flag set on a field, that field or row would ONLY load if the flag was enabled in the **content_flags** table.

If there is an expansion value different than the default 0, then the current expansion would filter against whether or not it should load

### Default Values¶

When **min_expansion** or **max_expansion** are -1; that means that they are loaded in all expansion contexts regardless of what is set at the server level

When **content_flags** or **content_flags_disabled** are **NULL;** it means that they can be loaded in all scenarios

### Multiple Content Flags¶

Multiple content flags can be set comma separated in the flags field of any content table

For example if I had a spawn table entry with **content_flags** `gm_event_2020,fabled` ****that means that if the server had **either** the GM event flag or the fabled flag, the spawn data would be loaded at the server level

The exact opposite works for **content_flags_disabled** field where if I had `gm_event_2020,fabled` as values in the disabled field, the spawn data will be disabled or not be loaded if either of the flags are enabled at the server level

### In Game Example¶

Take **Plane of Knowledge** books, they only started existing during **Planes of Power**; so we need to be able to shut them off on any expansion prior to **Planes of Power**

Our **Expansion:CurrentExpansion** value is set to **4 (Planes of Power)** as you can see in **Everfrost** we have a PoK book that we would typically expect

```
`SELECT id, zone, name, min_expansion, max_expansion FROM doors WHERE name like '%POKTELE%' and zone = 'everfrost'
+------+-----------+------------+---------------+---------------+
| id | zone | name | min_expansion | max_expansion |
+------+-----------+------------+---------------+---------------+
| 3415 | Everfrost | POKTELE500 | 4 | 0 |
+------+-----------+------------+---------------+---------------+
`
```

This is what we would expect; our minimum expansion on this door is set to 4, so since our current expansion is at that number we load as expected.

So what happens if set our expansions back a notch or two?

```
`MariaDB [peq]> update rule_values set rule_value = 2 WHERE rule_name = 'Expansion:CurrentExpansion';
Query OK, 1 row affected (0.005 sec)
Rows matched: 1 Changed: 1 Warnings: 0
`
```

We've set ourselves back to **The Scars of Velious** expansion and need to hot reload in game to see the results; I've issued a **#rules reload** to bring in the new rule value into memory and a **#reloadstatic** to set the expansion and content context from the newly set rule value

You can see now that we have no **Plane of Knowledge** book with a seamless content transition without harsh removal of actual data to achieve the affect of bringing the server into the context of an era

## Expansions Quest API¶

There are instances where extending the current expansion context into easily readable quest calls would help solve for use cases to make seamless behavioral transitions in quest scripts

### Examples¶

1) We have an NPC that existed already in for example expansion 4; **Planes of Power** but a few expansion down the line, the dialogue of this NPC has changed. We need a boolean or conditional that we can check to see what current expansion context the server is in before making behavioral changes in our script

```
`if (quest::is_current_expansion_dragons_of_norrath()) {
 # New Quest Dialogue
 if ($text=~/hail/i) {
 # Some text
 }
}
`
```

2) We a good handful of classic zones; later down the line in **Lost Dungeons of Norrath** we get these messages when entering the zones

A mysterious voice whispers to you, 'If you can feel me in your thoughts, know this -- something is changing in the world and I reckon you should be a part of it. I do not know much, but I do know that in every home city and the wilds there are agents of an organization called the Wayfarers Brotherhood. They are looking for recruits . . . If you can hear this message, you are one of the chosen. Rush to your home city, or search the West Karanas and Rathe Mountains for a contact if you have been exiled from your home for your deeds, and find out more. Adventure awaits you, my friend.''

Before these new additions there was nothing to conditionally check which expansion was enabled or disabled to determine whether or not to even display this message, which could be solved with the addition of **the following call.** If we set our server to an earlier expansion these messages would disappear

```
`eq.is_lost_dungeons_of_norrath_enabled()
`
```

What this looks like in the **global_player.lua**

global_player.lua

```
`function event_enter_zone(e)
 local qglobals = eq.get_qglobals(e.self);
 if(e.self:GetLevel() >= 15 and qglobals['Wayfarer'] == nil and eq.is_lost_dungeons_of_norrath_enabled()) then
 local zoneid = eq.get_zone_id();
 if(e.self:GetStartZone() ~= zoneid and (zoneid == 1 or zoneid == 2 or zoneid == 3 or zoneid == 8 or zoneid == 9 
 or zoneid == 10 or zoneid == 19 or zoneid == 22 or zoneid == 23 or zoneid == 24 or zoneid == 29 or zoneid == 30 
 or zoneid == 34 or zoneid == 35 or zoneid == 40 or zoneid == 41 or zoneid == 42 or zoneid == 45 or zoneid == 49 
 or zoneid == 52 or zoneid == 54 or zoneid == 55 or zoneid == 60 or zoneid == 61 or zoneid == 62 or zoneid == 67 
 or zoneid == 68 or zoneid == 75 or zoneid == 82 or zoneid == 106 or zoneid == 155 or zoneid == 202 or zoneid == 382 
 or zoneid == 383 or zoneid == 392 or zoneid == 393 or zoneid == 408)) then
 e.self:Message(15, 
 "A mysterious voice whispers to you, 'If you can feel me in your thoughts, know this -- "
 .. "something is changing in the world and I reckon you should be a part of it. I do not know much, but I do know "
 .. "that in every home city and the wilds there are agents of an organization called the Wayfarers Brotherhood. They "
 .. "are looking for recruits . . . If you can hear this message, you are one of the chosen. Rush to your home city, or "
 .. "search the West Karanas and Rathe Mountains for a contact if you have been exiled from your home for your deeds, "
 .. "and find out more. Adventure awaits you, my friend.'");
 end
 end
end
`
```

### API¶

LuaPerl

```
`eq.is_classic_enabled()
eq.is_the_ruins_of_kunark_enabled()
eq.is_the_scars_of_velious_enabled()
eq.is_the_shadows_of_luclin_enabled()
eq.is_the_planes_of_power_enabled()
eq.is_the_legacy_of_ykesha_enabled()
eq.is_lost_dungeons_of_norrath_enabled()
eq.is_gates_of_discord_enabled()
eq.is_omens_of_war_enabled()
eq.is_dragons_of_norrath_enabled()
eq.is_depths_of_darkhollow_enabled()
eq.is_prophecy_of_ro_enabled()
eq.is_the_serpents_spine_enabled()
eq.is_the_buried_sea_enabled()
eq.is_secrets_of_faydwer_enabled()
eq.is_seeds_of_destruction_enabled()
eq.is_underfoot_enabled()
eq.is_house_of_thule_enabled()
eq.is_veil_of_alaris_enabled()
eq.is_rain_of_fear_enabled()
eq.is_call_of_the_forsaken_enabled()
eq.is_the_darkend_sea_enabled()
eq.is_the_broken_mirror_enabled()
eq.is_empires_of_kunark_enabled()
eq.is_ring_of_scale_enabled()
eq.is_the_burning_lands_enabled()
eq.is_torment_of_velious_enabled()
eq.is_current_expansion_classic()
eq.is_current_expansion_the_ruins_of_kunark()
eq.is_current_expansion_the_scars_of_velious()
eq.is_current_expansion_the_shadows_of_luclin()
eq.is_current_expansion_the_planes_of_power()
eq.is_current_expansion_the_legacy_of_ykesha()
eq.is_current_expansion_lost_dungeons_of_norrath()
eq.is_current_expansion_gates_of_discord()
eq.is_current_expansion_omens_of_war()
eq.is_current_expansion_dragons_of_norrath()
eq.is_current_expansion_depths_of_darkhollow()
eq.is_current_expansion_prophecy_of_ro()
eq.is_current_expansion_the_serpents_spine()
eq.is_current_expansion_the_buried_sea()
eq.is_current_expansion_secrets_of_faydwer()
eq.is_current_expansion_seeds_of_destruction()
eq.is_current_expansion_underfoot()
eq.is_current_expansion_house_of_thule()
eq.is_current_expansion_veil_of_alaris()
eq.is_current_expansion_rain_of_fear()
eq.is_current_expansion_call_of_the_forsaken()
eq.is_current_expansion_the_darkend_sea()
eq.is_current_expansion_the_broken_mirror()
eq.is_current_expansion_empires_of_kunark()
eq.is_current_expansion_ring_of_scale()
eq.is_current_expansion_the_burning_lands()
eq.is_current_expansion_torment_of_velious()
`
```

```
`quest::is_classic_enabled()
quest::is_the_ruins_of_kunark_enabled()
quest::is_the_scars_of_velious_enabled()
quest::is_the_shadows_of_luclin_enabled()
quest::is_the_planes_of_power_enabled()
quest::is_the_legacy_of_ykesha_enabled()
quest::is_lost_dungeons_of_norrath_enabled()
quest::is_gates_of_discord_enabled()
quest::is_omens_of_war_enabled()
quest::is_dragons_of_norrath_enabled()
quest::is_depths_of_darkhollow_enabled()
quest::is_prophecy_of_ro_enabled()
quest::is_the_serpents_spine_enabled()
quest::is_the_buried_sea_enabled()
quest::is_secrets_of_faydwer_enabled()
quest::is_seeds_of_destruction_enabled()
quest::is_underfoot_enabled()
quest::is_house_of_thule_enabled()
quest::is_veil_of_alaris_enabled()
quest::is_rain_of_fear_enabled()
quest::is_call_of_the_forsaken_enabled()
quest::is_the_darkend_sea_enabled()
quest::is_the_broken_mirror_enabled()
quest::is_empires_of_kunark_enabled()
quest::is_ring_of_scale_enabled()
quest::is_the_burning_lands_enabled()
quest::is_torment_of_velious_enabled()
quest::is_current_expansion_classic()
quest::is_current_expansion_the_ruins_of_kunark()
quest::is_current_expansion_the_scars_of_velious()
quest::is_current_expansion_the_shadows_of_luclin()
quest::is_current_expansion_the_planes_of_power()
quest::is_current_expansion_the_legacy_of_ykesha()
quest::is_current_expansion_lost_dungeons_of_norrath()
quest::is_current_expansion_gates_of_discord()
quest::is_current_expansion_omens_of_war()
quest::is_current_expansion_dragons_of_norrath()
quest::is_current_expansion_depths_of_darkhollow()
quest::is_current_expansion_prophecy_of_ro()
quest::is_current_expansion_the_serpents_spine()
quest::is_current_expansion_the_buried_sea()
quest::is_current_expansion_secrets_of_faydwer()
quest::is_current_expansion_seeds_of_destruction()
quest::is_current_expansion_underfoot()
quest::is_current_expansion_house_of_thule()
quest::is_current_expansion_veil_of_alaris()
quest::is_current_expansion_rain_of_fear()
quest::is_current_expansion_call_of_the_forsaken()
quest::is_current_expansion_the_darkend_sea()
quest::is_current_expansion_the_broken_mirror()
quest::is_current_expansion_empires_of_kunark()
quest::is_current_expansion_ring_of_scale()
quest::is_current_expansion_the_burning_lands()
quest::is_current_expansion_torment_of_velious()
`
```

## Content Flag Quest API¶

There are cases where you may want to check the state of current content flags in game via quest to then potentially trigger other events. For that reason there is a simple **Quest API** that has been created to expose

### Example¶

LuaPerl

```
`function event_say(e)
 local flag_name = 'some_flag';

 e.self:Message(15, "################################");
 e.self:Message(15, "# Testing Content Flags");
 e.self:Message(15, "################################");

 e.self:Message(15, "Setting flag [" .. flag_name .. "] to disabled");
 eq.set_content_flag(flag_name, false);
 e.self:Message(15, "Content flag is [" .. (eq.is_content_flag_enabled(flag_name) and "enabled" or "disabled") .. "]");
 e.self:Message(15, "Setting flag [" .. flag_name .. "] to enabled");
 eq.set_content_flag(flag_name, true);
 e.self:Message(15, "Content flag is [" .. (eq.is_content_flag_enabled(flag_name) and "enabled" or "disabled") .. "]");
end
`
```

```
`sub EVENT_SAY {
 my $flag_name = "some_flag";

 $client->Message(15, "################################");
 $client->Message(15, "# Testing Content Flags");
 $client->Message(15, "################################");

 $client->Message(15, "Setting flag [" . $flag_name . "] to disabled");
 quest::set_content_flag($flag_name, 0);
 $client->Message(15, "Content flag is [" . (quest::is_content_flag_enabled($flag_name) ? "enabled" : "disabled") . "]");
 $client->Message(15, "Setting flag [" . $flag_name . "] to enabled");
 quest::set_content_flag($flag_name, 1);
 $client->Message(15, "Content flag is [" . (quest::is_content_flag_enabled($flag_name) ? "enabled" : "disabled") . "]"); 
}
`
```

### Result¶

```
`################################
# Testing Content Flags
################################
Setting flag [some_flag] to disabled
Content flag is [disabled]
Setting flag [some_flag] to enabled
Content flag is [enabled]
`
```

### Table Example¶

```
`MariaDB [peq]> select * from content_flags where flag_name = 'some_flag';
+----+-----------+---------+-------+
| id | flag_name | enabled | notes |
+----+-----------+---------+-------+
| 9 | some_flag | 1 | |
+----+-----------+---------+-------+
`
```

### API¶

LuaPerl

```
`eq.is_content_flag_enabled(string flag_name)
eq.set_content_flag(string flag_name, bool enabled)
`
```

```
`quest::is_content_flag_enabled(string flag_name)
quest::set_content_flag(string flag_name, bool enabled)
`
```

---

## Expansion List Reference

*Source: server/expansions/expansion-list-reference/index.html*

# Expansion List Reference¶

| 

Expansion 
| Internal ID 

| Classic 
| 0 

| The Ruins of Kunark 
| 1 

| The Scars of Velious 
| 2 

| The Shadows of Luclin 
| 3 

| The Planes of Power 
| 4 

| The Legacy of Ykesha 
| 5 

| Lost Dungeons of Norrath 
| 6 

| Gates of Discord 
| 7 

| Omens of War 
| 8 

| Dragons of Norrath 
| 9 

| Depths of Darkhollow 
| 10 

| Prophecy of Ro 
| 11 

| The Serpent's Spine 
| 12 

| The Buried Sea 
| 13 

| Secrets of Faydwer 
| 14 

| Seeds of Destruction 
| 15 

| Underfoot 
| 16 

| House of Thule 
| 17 

| Veil of Alaris 
| 18 

| Rain of Fear 
| 19 

| Call of the Forsaken 
| 20 

| The Darkened Sea 
| 21 

| The Broken Mirror 
| 22 

| Empires of Kunark 
| 23 

| Ring of Scale 
| 24 

| The Burning Lands 
| 25 

| Torment of Velious 
| 26

---

## Database

*Source: server/expedition-system/database/index.html*

# Database¶

The expedition system uses the following database tables

| 

table name 
| description 

| expeditions 
| Current active expeditions 

| expedition_lockouts 
| Internal lockouts for current active expeditions 

| expedition_members 
| Characters in active expeditions 

| character_expedition_lockouts 
| Character lockouts 

| dynamic_zones 
| Extends instances with additional dz data (compass, safereturn, zone-in) 

### expeditions¶

| 

column 
| type 
| description 

| id 
| unsigned int 
| Expedition ID (auto incremented) 

| uuid 
| varchar(36) 
| Expedition UUID generated on creation used for certain lockout conflict checks 

| dynamic_zone_id 
| unsigned int 
| dynamic_zones ID used by the expedition 

| expedition_name 
| varchar(128) 
| Name of expedition 

| leader_id 
| unsigned int 
| Current leader's character ID 

| min_players 
| tinyint 
| Minimum players required to request expedition (1-255) 

| max_players 
| tinyint 
| Maximum players allowed in expedition (1-255) 

| add_replay_on_join 
| tinyint 
| (bool) If added members automatically receive `Replay Timer` lockout when joining an expedition that has it (default: 1) 

| is_locked 
| tinyint 
| (bool) Allow adding new members (0: unlocked, 1: locked) 

### expedition_lockouts¶

| 

column 
| type 
| description 

| id 
| unsigned int 
| Auto incremented ID 

| expedition_id 
| unsigned int 
| Expedition ID the lockout belongs to 

| event_name 
| varchar(256) 
| Lockout event name 

| expire_time 
| datetime 
| Time the lockout expires 

| duration 
| unsigned int 
| Original duration (seconds) the lockout was added with 

| from_expedition_uuid 
| varchar(36) 
| Original source expedition uuid the lockout was assigned in (will differ from current expedition if inherited by leader on creation) 

### expedition_members¶

| 

column 
| type 
| description 

| id 
| unsigned int 
| Auto incremented ID 

| expedition_id 
| unsigned int 
| Expedition ID the member belongs to 

| character_id 
| unsigned int 
| Member character ID 

| is_current_member 
| tinyint 
| (bool) Character is current member or past member of expedition 

### character_expedition_lockouts¶

| 

column 
| type 
| description 

| id 
| unsigned int 
| Auto incremented ID 

| character_id 
| unsigned int 
| Character ID lockout belongs to 

| expedition_name 
| varchar(128) 
| Lockout expedition name 

| event_name 
| varchar(256) 
| Lockout event name 

| expire_time 
| datetime 
| Time the lockout expires 

| duration 
| unsigned int 
| Original duration (seconds) the lockout was added with 

| from_expedition_uuid 
| varchar(36) 
| Original source expedition uuid the lockout was assigned in 

### dynamic_zones¶

| 

column 
| type 
| description 

| id 
| unsigned int 
| Dynamic Zone ID (auto incremented) 

| instance_id 
| int 
| ID for zone instance in `instance_list` table 

| type 
| tinyint 
| 0: None 1: Expedition 2: Tutorial 3: Task 4: Mission (Shared Task) 5: Quest 

| compass_zone_id 
| unsigned int 
| Zone ID the compass should be drawn in (0: no compass) 

| compass_zone_x 
| float 
| Compass x coordinate 

| compass_zone_y 
| float 
| Compass y coordinate 

| compass_zone_z 
| float 
| Compass z coordinate 

| safe_return_zone_id 
| unsigned int 
| Zone ID characters are moved to when removed from a dz (0: no safe return) 

| safe_return_x 
| float 
| Safe return x coordinate 

| safe_return_y 
| float 
| Safe return y coordinate 

| safe_return_z 
| float 
| Safe return z coordinate 

| safe_return_heading 
| float 
| Safe return heading 

| zone_in_x 
| float 
| Zone in x coordinate when character moved via MovePCDynamicZone() 

| zone_in_y 
| float 
| Zone in y coordinate when character moved via MovePCDynamicZone() 

| zone_in_z 
| float 
| Zone in z coordinate when character moved via MovePCDynamicZone() 

| zone_in_heading 
| float 
| Zone in heading when character moved via MovePCDynamicZone() 

| has_zone_in 
| tinyint 
| (bool) If zone in override coordinates are valid (zone's default zone-in location is used if not)

---

## Expedition System

*Source: server/expedition-system/index.html*

# Expedition System¶

The expedition system enables the ability to create Dynamic Zone instances managed by the client's Expedition interface window. This system allows clients to add and remove members of a Dynamic Zone while providing built-in event lockout timer support.

The system is currently quest driven and provides quest APIs to create zone instances without the burden of manually tracking and validating lockout conflicts among characters. The system should have zero impact on servers that don't make use of it.

## Expedition requests¶

When a non-solo expedition request occurs, the leader of the raid or group becomes the lockout authority. If any members of the party have a lockout for the expedition that the leader doesn't already have the expedition request is denied. Denied expedition requests message the party leader (not the member that requested it).

If the request is successful, all party members are added to the expedition and it internally inherits the leader's current lockouts. These inherited lockouts are not assigned to members of the expedition. They are used to determine if players may be added to the expedition later based on their lockouts and to allow quests to choose which expedition events should be enabled or disabled.

## Dynamic Zones¶

Dynamic Zones are a wrapper for instances that extends them with some extra data. In the future these will probably be further modified for use by other systems that make use of dynamic zones.

## Commands¶

The `#dz` command is provided for GMs and developers to perform various operations. Use the command without arguments in game to see usage (minimum 80 access level).

The `#dzkickplayers` command is provided for players so that expedition leaders using pre-RoF clients can have the `/kickplayers exp` functionality to remove all members of an expedition.

## Rules¶

The following rules are available for server customization

| 

Category 
| Rule Name 
| Type 
| Default 
| Description 

| Expedition 
| MinStatusToBypassPlayerCountRequirements 
| int 
| 80 
| Minimum GM status to bypass minimum player requirements for Expedition creation 

| Expedition 
| EmptyDzShutdownEnabled 
| bool 
| true 
| Enable early instance shutdown after last member of expedition removed 

| Expedition 
| EmptyDzShutdownDelaySeconds 
| int 
| 1500 
| Seconds to set dynamic zone instance expiration if early shutdown enabled 

| Expedition 
| WorldExpeditionProcessRateMS 
| int 
| 6000 
| Timer interval (ms) that world checks expedition states 

| Expedition 
| AlwaysNotifyNewLeaderOnChange 
| bool 
| false 
| Always notify clients when made expedition leader (such as for going offline). If false (live-like) new leaders are only notified when made leader via /dzmakeleader 

| Expedition 
| LockoutDurationMultiplier 
| float 
| 1.0 
| Multiplies lockout duration by this value when new lockouts are added 

| Expedition 
| EnableInDynamicZoneStatus 
| bool 
| false 
| Enables the 'In Dynamic Zone' member status in expedition window. If false (live-like) players inside the dz will show as 'Online' 

| DynamicZone 
| ClientRemovalDelayMS 
| int 
| 60000 
| Delay (ms) until a client is teleported out of dynamic zone after being removed as member 

Note: The `DynamicZone::ClientRemovalDelayMS` rule is in its own category for possible future systems that may make use of dynamic zones. The empty dz shutdown rules may be moved to this category in the future depending on design changes.

## Known issues¶

- Using /exit with an expedition invite window open may crash the client instead of exiting cleanly

- Invoking the dynamic zone switch list window after reloading the UI may crash clients

- client bug that still exists on live

- this window is currently unused since expeditions are the only system that use dynamic zones

---

## Lockouts

*Source: server/expedition-system/lockouts/index.html*

# Lockouts¶

There are two types of lockout replay timers that need to be distinguished

- Replay Timer - A replay timer on the expedition itself

- Event Timer - A replay timer on some event inside an expedition

## Replay Lockouts¶

`Replay Timer` lockouts use a hard-coded event name

From live December 14, 2016 patch notes

Dynamic zone replay times not associated to a particular event will now display 'Replay Timer' in the Event Name column of the expedition window rather than a blank space.

These are lockouts for requesting or joining an expedition. Any party members with this type of lockout will cause an expedition creation request to be denied. Any members invited to an expedition that has had a `Replay Timer` lockout added will receive that lockout immediately with its original duration upon joining (can be disabled via quest API).

Players with a `Replay Timer` lockout may only be re-invited to the same expedition that the timer was originally assigned from. Players that have a `Replay Timer` from another expedition can not be added.

## Event Lockouts¶

Event lockout timers are lockouts for events inside an expedition.

Event lockouts added during an expedition are assigned to:

- The expedition internally (non-inherited lockout)

- All current members of the expedition

- Any non-expedition clients currently inside the expedition's Dynamic Zone

A player that has an event lockout that the expedition doesn't already have (either inherited or not) may not be added until the expedition completes that event and receives the lockout.

New members added to an expedition do not receive these non-inherited event lockouts immediately on joining. These lockouts are only added to new players when they zone into the expedition's dynamic zone instance. Players receive a warning for any lockouts they're missing that will be added when invited.

If a player already has an event lockout from another expedition and is added to an expedition after the event is completed inside it, that player's lockout timer will be synchronized with the expedition's lockout once they zone in.

Character lockouts for the expedition will only be synchronized if the character's lockout timer is shorter than the expedition's timer

## Implementation Details¶

When an expedition creation request is made the lockouts of the requester's group/raid leader (or the requester if solo) are used for validation. If any member has an additional lockout for the expedition that the leader doesn't then the request fails.

If the request doesn't fail the expedition inherits the lockouts from the leader and makes a copy of them internally. These are the lockouts that quests can use to determine which events should be available inside the dz through initialization scripts.

Lockouts added by quests during an expedition are added internally to the expedition as well as to all current expedition members. Clients inside the dz that are not members of the expedition will also receive the lockouts to prevent exploiting. These lockouts store the UUID of the current expedition so they can be distinguished from inherited lockouts.

When a character is invited to an expedition the character's lockouts are compared with the internal expedition lockouts to determine if they may join. If the character has any lockouts that the expedition doesn't then the invite will fail.

When a character zones into an expedition's dynamic zone their lockouts are synchronized with the expedition's internal lockouts. Only lockouts added during the current expedition are synchronized. The character will receive new lockouts for any they didn't already have with the current expedition's UUID.

If the character already has an event lockout from another expedition (the character's lockout UUID differs from the current expedition's UUID) then their lockout timer for that event is updated to the expedition's current expire time but the character lockout UUID remains unchanged.

Updating character lockout timers on dz entry even when the UUID is from another expedition is live behavior as of 2020-11-08.

---

## Creating a New Faction

*Source: server/factions/add-a-new-faction/index.html*

# Creating a New Faction¶

To add a new faction on your server:

- Add the new faction to the faction_list table. Assign a value to base_value that indicates, aside from class/race/deity adjustments, how your new faction will regard everyone.

- Add an entry to faction_base_data if you want the limits on earned faction to differ from -2000 to 2000.

| 

Faction Value 
| Faction CON 

| 1100 -> ABOVE 
| ALLY 

| 750 -> 1099 
| WARMLY 

| 500 -> 749 
| KINDLY 

| 100 -> 400 
| AMIABLE 

| 0 -> 99 
| INDIFFERENT 

| -100 -> -1 
| APPREHENSIVE 

| -500 -> -101 
| DUBIOUS 

| -750 -> -501 
| THREATENLY 

| BELOW -> -751 
| SCOWLS 

- Decide if you want your faction to favor or dislike characters more of less based on their class, race or deity. If so, add entries to faction_list_mod for your newly created faction.

- Every NPC that you want to be on your new faction, will have to be on a new npc_faction that has a primary_faction set to your new faction from faction_list. But unless all the NPCS that you want will all have the same faction hits when killed, you'll need a separate npc_faction for each tier of hits. I hope we can factor this part out in a future work product.

- If you want to assign faction hits or gains for killing any npc on your newly created npc_faction, add these entries to npc_faction_entries using your new npc_faction_id.

- If you want your newly created faction members to attack or assist certain other factions, add these entries to npc_faction_entries using your new npc_faction_id.

- Assign the NPCs you want to your new npc_faction.

- Restart the server for this to take effect. We'll work on a live reloading mechanism.

---

## Customizing Factions

*Source: server/factions/customizing-factions/index.html*

# Customizing Factions¶

Every faction that exists on a server is listed in the `faction_list` table. This table includes a unique id, a name, and a starting (base) faction. This starting value is combined with any race/class/deity adjustments that apply (see `faction_list_mod` table) to create the starting faction for characters when they are born. As characters interact with the world, they can gain/lose faction through their actions, be that killing or questing. These values are continuously updated in the `faction_values` table.

Info

Note that the `faction_values` table contains *character* data, even though it does not follow the Database Schema Guidelines (it should be `character_faction_values`).

Info

As of 01 March 2019 we have imported the client faction list and we now use these renumbered factions. The client does not have a base for any of the factions, all of the offsets are realized in faction_list_mod instead. This does not mean that the base cannot be altered for custom results.

Each faction has a minimum and a maximum value, at which point no more faction can be lost or gained. This information is stored in the `faction_base_data` table. The default *base* maximum is 2000 and the *base* minimum is -2000 if there is no entry. The amount a character can earn is based on these constants **and** the faction's initial base value. For example, a faction that starts out at 0 (base value in `faction_list`) is a simple case, and would use the maximum of 2000 and minimum of -2000.

The character can earn or lose faction until his *earned* faction reaches the faction's min or max value. The base value for a faction impacts this in cases where that base is non zero. For example, if a faction starts out at -500, the character can earn 2500 points--500 to make up for initial impressions, and 2000 more to get into good graces. If a faction starts you out at a positive value--for instance, 300--you can only earn 1700 points, but you can lose 2300 points!

A character's unmodified faction value at any time is calculated by the following formula:

Current Unmodified Faction = faction_list 'base' integer + faction_values 'current_value' integer

Info

Again, note that the integer in the 'current_value' field of the `faction_values` table represents the factions gains and hits the player has received from killing NPCs or completing quests.

This faction value is then adjusted by any impact caused by the character's race/class/deity combination. These modifications are stored in the `faction_list_mod` table. These adjustments cannot be made up for by any actions or deeds: they are permanent marks on the character's record, and can therefore impact how high (or low) a character can get with the faction in question. They can be temporarily masked by things like illusions, but cannot be completely erased.

To get your final (modified) faction, add the race/class/deity modifier to the Current Unmodified Faction value:

Current Faction = [Current Unmodified Faction] + faction_list_mod 'mod' integer

### Examples of Current Faction¶

Imagine that we create a character named "Snake", who is an Ogre Berserker that worships Cazic Thule. 

#### Unmodified Case:¶

The NPCs using faction ID 368 - Dervish Cutthroats enjoy a base value of -100 (in the `faction_list` table). Since they have no faction list modifiers (based on race/class/deity), everyone, including Snake, would start off conning "Apprehensive": 

faction_list 'base' integer = -100

faction_values 'current_value' integer = 0

faction_list_mod 'mod' integer = N/A

Result: -100 Current Faction ("Apprehensive")

The maximum number of faction points possible (stored in the `faction_values`table), is +2100, and the minimum number of faction points possible, is -1900. 

Assuming that there is a faction hit of -10 for killing a Dervish Cutthroat, and our intrepid adventurer, Snake, killed a derv: Snake's faction value would be -10, to which we would add the base value of -100, and Snake would consider "Dubious" to Dervish Cutthroats.

If Snake received +1200 faction points, he would consider "Ally". If Snake received -651 points of faction hits, he would consider "Scowls, Ready to Attack". From our example above, if Snake killed 190 dervs, he would reach the minimum faction value possible. 

#### Modified Case:¶

The NPCs using faction ID 361 - Ashen Order have a base value of 0, but they DO have a modifier based on both race and class (but none on deity):

Above we see a rather cryptic list of modifiers to faction 361 - Ashen Order. Note that in the `mod_name` column, we see the Classes to be modified (c11, c5, c7, c9) as well as the Races to be modified (r10, r128, r6, r9), and their corresponding modifier values in the 'mod' column.

With no 'base' value (in the `faction_list` table), the maximum number of faction points possible (stored in the `faction_values`table), is +2000, and the minimum number of faction points possible, is -2000. 

Recall that Snake is an Ogre Berserker. The Berserker class suffers no penalty in this case, but the Ogre race (ID 10) suffers a massive -1000 penalty. Therefore, before Snake has done any killing or questing (meaning, his faction value for Ashen Order would not exist), NPCs with this faction assigned would consider him "Scowls, Ready to Attack".

faction_list 'base' integer = 0

faction_values 'current_value' integer = 0

faction_list_mod 'mod' integer = -1000

Result: -1000 Current Faction ("Scowls, Ready to Attack")

Assuming Snake took a faction hit of -10 for each NPC assigned to Ashen Order, he could kill 100 monks to reach the lowest possible Current Faction.

If instead, Snake turned over a new leaf and *raised* his faction with Ashen Order, the highest his Current Faction could reach would be 1000, and he would consider "Warmly" (he could never attain "Ally"). 

### Consider Levels from Faction Values¶

Faction values for each level are as follows. The number on the left is the TOTAL value as seen in the table above (+ or minus any effects like illusions, etc):

| 

Total Faction Value 
| Faction CON 

| 1100 -> ABOVE 
| ALLY 

| 750 -> 1099 
| WARMLY 

| 500 -> 749 
| KINDLY 

| 100 -> 499 
| AMIABLE 

| 0 -> 99 
| INDIFFERENT 

| -100 -> -1 
| APPREHENSIVE 

| -500 -> -101 
| DUBIOUS 

| -750 -> -501 
| THREATENLY 

| BELOW -> -751 
| SCOWLS

---

## Faction Values

*Source: server/factions/faction-values/index.html*

# Faction Values¶

These are the faction values exported by `$faction`, these were moved here to keep the exported variables consistent.

| 

**Value** 
| **Faction Standing** 

| 1 
| Ally 

| 2 
| Warmly 

| 3 
| Kindly 

| 4 
| Amiably 

| 5 
| Indifferent 

| 6 
| Apprehensive 

| 7 
| Dubious 

| 8 
| Threateningly 

| 9 
| Scowls 

These are the faction values used with `quest::factionvalue();`

| 

**Value** 
| **Faction Standing** 

| 1 
| Scowls 

| 2 
| Threateningly 

| 3 
| Dubious 

| 4 
| Apprehensive 

| 5 
| Indifferent 

| 6 
| Amiably 

| 7 
| Kindly 

| 8 
| Warmly 

| 9 
| Ally

---

## Factions

*Source: server/factions/index.html*

# Factions¶

The faction system is pretty simply really, but it can also be quite confusing if you don't understand the purpose of some of the tables, or you don't understand how all the tables interact. These pages should help you get a high level understanding of the faction system, the database tables related to faction functionality, and how to use the system to get the results you expect.

## NPC Aggro¶

It is important to understand that NPCs aggro Players due to faction differences. These differences can be caused by racial / class / deity mods that are inherit in the player's character choice, or they can be caused by the player losing faction standing with a particular faction.

Read more about the NPC Aggro settings in the NPC Aggro section.

## Database Tables¶

### faction_list¶

The faction_list table contains one entry for each unique faction on the server. This list was previous our own values, but now uses values directly from the client for any non-custom factions. The ID field identifies an in-game faction, but IS NOT directly associated with an NPC. This list simply lists the in game factions and the starting value that all characters start at with this faction before they begin earning or losing faction. DO NOT use these values in npc_types. See npc_faction below for details.

### faction_base_data¶

The faction_base_data was imported directly from the client. In includes the lowest a character can go in "earned" faction and the highest amount of "earned" faction they can obtain. The modifiers for race, class and deity are still applied on top of the personal faction to determine the final standing.

### faction_list_mod¶

The faction_list_mod table stores the static data that indicates what bonuses or penalties race, class and deity have on various factions. For example, a character's standing may be worse with some factions due to that faction hating your deity. Or like in the case of the Kerran race, they dislike Erudites. These adjustments, combined with the starting value for everyone taken from faction_list, make up where you start in relation to all of the factions on Norrath.

### faction_values¶

The faction_values table stores the ever-changing data in regards to each characters actions in the game. A running sum of all of the hit and gains in faction for characters is stored here, one line per char/faction pair. Lines only exist if a character has at least one hit or credit based on in game actions.

These two tables are more about assigning each NPC a primary faction, while also establishing sister factions (assist worthy), enemy factions (attack worthy), and the hit taken by any PC that were to kill the PC.

### npc_faction¶

The ID from the npc_faction table is where an NPC gets its entire faction behavior. The ID assigned here, ties an NPC to their primary faction (from faction_list) as well as determines whether not not they will assist their primary faction comrades in battle.

But more than this, it serves as a key into the npc_faction_entries table.

### npc_faction_entries¶

The npc_faction_entries table has three major roles. First, entries are placed here that indicate how much faction is gained/lost with various factions if any NPC has this npc_faction_id is killed. The second, is that you can list how these NPCS react to other NPCS of various other factions. The third, these entries can also indicate faction gain/loss via the task system. The npc_faction_id is specified in the faction_reward field in the tasks table.

This table collects too much data in one place, and really should be broken down. As it stands right now, if there are 10 different mobs that yield different faction hits when killed, there needs to be 10 different npc_factions and copies of their behavior records in new npc_faction_entries records. If we separated out the hits into a separate table, then we would only need one copy of the behavior records. We'll mark this as potential improvement. (In my work matching live faction data, it has required a ton of redundancy).

---

## Backwards Compatibility

*Source: server/guilds/compatibility/index.html*

# Backwards Compatibility

### Ranks¶

Guild ranks will translate as follows when the server sends rank to the client.

| 

Guild Rank Name 
| RoF2 
| Titanium 
| Underfoot 

| Leader 
| 1 
| 2 
| 2 

| Senior Officer 
| 2 
| 1 
| 1 

| Officer 
| 3 
| 1 
| 1 

| Senior Member 
| 4 
| 0 
| 0 

| Member 
| 5 
| 0 
| 0 

| Junior Member 
| 6 
| 0 
| 0 

| Initate 
| 7 
| 0 
| 0 

| Recruit 
| 8 
| 0 
| 0 

What does this mean?

If you are using a mixture of clients, the change of ranks will mirror the above translation.

Example:

If an RoF2 client changes the rank of Player A from Recruit to Junior Member, a Ti/UF client will show Player A as a member before and after the change. 

If a Ti/UF client changes the rank of Player A from Member to Officer, a RoF 2 client will show Player A as Officer. 

Player A will then be afforded the permissions as noted within the RoF2 client for the rank.

### Permissions¶

When creating a new guild, the following permissions are set as a default.

### Guild Bank¶

By default, the guild leader is a guild banker. This is accomplished based on the client type.

The Ti/Underfoot Client has a checkbox to identify a guild member as a banker.
The RoF2 Client uses the permission system to determine a guild members access to the guild bank.

Please note: The system will convert RoF2 bank permissions to Ti/UF banker status when the following four permissions are set.

- Bank:Deposit Items

- Bank:Promote Items

- Bank:View Items

- Bank:Withdraw Items

Therefore, if your player base uses RoF2 generally though a few use Underfoot, those Underfoot players will have banker status based on the above noted RoF2 permissions. The guild leader will not have to login with Underfoot and set their banker status.

Please note: The internal structure of eqemu uses the RoF2 rank system. Therefore if a member has the rank of Junior Member, and that rank has the 4 permissions noted above, when they log in with a UF client, they will have banker access, even though their UF guild rank will display as 'member' in the client as noted in the above translation table.

---

## Defaults

*Source: server/guilds/defaults/index.html*

# Defaults

### Ranks¶

| 

Guild Rank Name 
| Guild Rank # 

| Leader 
| 1 

| Senior Officer 
| 2 

| Officer 
| 3 

| Senior Member 
| 4 

| Member 
| 5 

| Junior Member 
| 6 

| Initate 
| 7 

| Recruit 
| 8 

### Default Invite Rank¶

| 

Client 
| Rank 

| Titanium 
| Member 

| Underfoot 
| Member 

| Rain of Fear 2 
| Recruit 

Guild Banker

By default, the guild leader is a guild banker.

### Permissions¶

When creating a new guild, the following permissions are set as a default.

---

## Guilds

*Source: server/guilds/index.html*

# Guilds¶

The internal structure of guild management is based on the Rain of Fear 2 (RoF2) client. This means that the internal structure is based on the 8 guild ranks and rank names. The server will translate these to older clients when the player is using Titanium or Underfoot.

The guild management system has not been tested with other clients. If your player base uses another client, please post an issue as it may be possible to add the appropriate opcodes.

As of February 2024, the following **features are implemented**:

- Customizable Guild Ranks (RoF2)

- Permissions (RoF2)

- Notes

- Guild Creation using Alt-G (UF/RoF2)

- Tributes

- Guild Bank

- Guild LFG. Works from the command line and the Bulletin Boards in Guild Lobby (requires queryserver to be running)

**Not Yet Implemented:**

- Guild Trophies

- Real Estate

- Banners

The system has been tested against Titanium, Underfoot and Rain of Fear 2. Functionality is limited to the client feature set.

## Server Rules for Guild Management¶

There are several rules that allow for customization of guild functionality.

| 

Category 
| Rule Name 
| Type 
| Default 
| Description 

| Guild 
| TributePlatConversionRate 
| int 
| 10 
| The conversion rate of platinum donations. Default is 10 guild favor to 1 platinum 

| Guild 
| TributeTime 
| int 
| 600000 
| Time in ms for guild tributes. Default is 10 mins. 

| Guild 
| TributeTimeRefreshInterval 
| int 
| 180000 
| Time in ms to send timer updates to all guild members. Default is 3 mins. 

| Guild 
| UseCharacterMaxLevelForGuildTributes 
| bool 
| true 
| Guild Tributes will adhere to Character:MaxLevel. Default is true. 

## Scripting¶

If you have existing quest scripts that use client:GuildRank() or $client->GuildRank(), these will need to be updated to reflect the RoF2 guild rank numbers.

## Tributes¶

As of release 22.44.5, the guild tribute data can be sourced from content_database. Prior to this release, the guild tribute must be sourced from the peq_content tributes and tribute_level tables. These are included within a new install, and can also be sourced from the peq content database

## Defaults¶

There have been many questions about the default behaviour of guild permissions. Care was taken to align with Live. If you encounter any discrepancies, please report them as an issue on github. Also, please checkout the Default section.

## Player Event Logging¶

The following player events are available.

| 

Rule Name 
| Default 
| Retention 

| Guild Tribute Donate Item 
| Enabled 
| 7 days 

| Guild Tribute Donate Platinum 
| Enabled 
| 7 days 

## Known Issues¶

There is a display issue within the Guild Management Window across all three clients (Ti/UF/RoF2). Care has been taken to alleviate the issue, however it is explained here for reference.

When a player opens the guild management window and has 'Show Offline' unchecked, they may notice that the 'Notes' and 'Tribute' tabs are missing an online client. If they toggle the 'Show Offline' checkbox, the Guild Management Window will update itself and correct the display issue. 

The guild tribute window may show a level of 0 when the tribute level is higher than the CharacterMaxLevel. This is a display bug only and will not allow the tribute to be used.

---

## Dev Container

*Source: server/installation/dev-container/index.html*

# Dev Container Linux Setup¶

Info

Check out https://github.com/Akkadius/akk-stack for ways to host your server, this instruction is more for development purposes. Akk-stack also offers dev environments.

Dev containers uses Docker and VSCode to create a development environment that is consistent across all developers. This is a great way to ensure that everyone is using the same tools and versions. You can also use this to develop on Windows, Mac, or Linux.

## Prerequisites¶

- Install Docker

- Install VSCode

## Setup 1: Inside a dev container¶

This is recommended because you get autocomplete, debugging, and other features built in once your environment is spun up.

- Start vscode

- Clone this repository

- Open the repository in VSCode

- Click on the green button in the bottom left corner of vscode and select "Reopen in Container"

- Wait for the container to build and start

- Open a terminal in VSCode (ctrl+~)

- Run `git submodule update --init --recursive` to pull in submodules

- Use the build link on the bottom status bar, then select the GCC bottom option, or:

Alternatively, run `make cmake` to configure environment.

- Follow this with `make build` command after.

- Verify in your `build/bin/` folder that zone, world, etc exist

## Setup 2: Inject the database¶

- Open a terminal in VSCode (ctrl+~) or your preferred terminal

- Ensure your path is .devcontainer, if not run `cd .devcontainer`

- Run `make inject-mariadb` to get a fresh peq snapshot from base

## Setup 3: Clone quests¶

- Start a new vscode window, and git clone the quests folder into build/bin/quests

## Setup 4: Prep the environment¶

- Open a terminal in VSCode (ctrl+~) or your preferred terminal

- Ensure your path is .devcontainer, if not run `cd .devcontainer`

- Run `make prep` to copy the required files to the build directory. This can be ran multiple times to "reset" the environment

- Inside build/bin/eqemu_config.json edit the server name to your server's name, ideally with the keyword "dev" inside it.

## Setup 5: Connect to the database¶

- Use Beekeeper or Heidi or your preferred SQL client to connect to the database

- The settings: host: 127.0.0.1:3306, username: peq, database: peq, password: peqpass. You should see all tables populated

## Setup 6: Run shared memory¶

- Open a terminal in VSCode (ctrl+~) or your preferred terminal

- Ensure your path is .devcontainer, if not run `cd .devcontainer`

- Run `make shared`. On success, it should return to the terminal at end

- Above should only need to be ran once, or if you modify items, skill caps, spells, and other expansion tweaks, it may need to be ran again while the server is fully shut down

## Setup 7: Run world¶

- Open a terminal in VSCode (ctrl+~) or your preferred terminal

- Ensure your path is .devcontainer, if not run `cd .devcontainer`

- Run `make world`. On success, it should be idle and not return to an empty prompt

## Setup 8: Run zone¶

- Open a new terminal in VSCode (ctrl+~) or your preferred terminal

- Ensure your path is .devcontainer, if not run `cd .devcontainer`

- Run `make zone`. On success, it should be idle. If you switch back to world, you should see an event about zone connecting

## Setup 9: Log in and set yourself GM¶

- Using a rof2 client where eqhost.txt is set to projecteq's login will make your debox server appear under `[D] Your Devbox Name`

- When you first log in, the world console should say like "SetOnline Online Status [foo] (1) status [Online]

- Ensure your path is .devcontainer, if not run `cd .devcontainer`

- You can run `make gm-foo` to update your status to 255, replacing foo with your name

## Setup 10: Optional, get maps¶

Maps are a big download so unless you care about navmesh, water, los testing, this can be skipped.

- Ensure your path is .devcontainer, if not run `cd .devcontainer`

- Simply run `make maps`. This will download maps to base/maps, and the make prep command you ran earlier symlinks it.

## Debugging¶

You can optionally debug by attaching via gdb to the running processes. This is only recommended if you are familiar with gdb and debugging in general

- Add breakpoints in zone or world that you want to debug

- Press CTRL+SHIFT+D or the debug icon on left pane, and select a (gdb) [processType] for what you want to debug

- When your code reaches said break point, you will get a call stack and variable dump on left

- While the break point is triggered, all code is frozen, so a connection client will slowly disconnect if you're not quick to resume the breakpoint

### Quick and Dirty Alternative Test¶

If you're looking to compile binaries and not mess with the full dev container situation, you can use in linux or a WSL environment:

- Ensure your path is .devcontainer, if not run `cd .devcontainer`

- Run `make docker-cmake` to configure environment

- Run `make docker-build` to build the project

- Verify in your `build/bin/` folder that zone, world, etc exist

---

## Manual Windows Install

*Source: server/installation/ground-up-windows-install/index.html*

# Ground Up Windows Install¶

Info

This guide is intended for advanced users who want to configure EQEmu "from the ground up" for a windows server. It is not the recommended route, we suggest using the Windows-Server install instead for most cases

This guide provides instructions for compiling 64-bit Windows server binaries and setting up a local development server

Read through this guide before starting to ensure an understanding of the process

Info

The target computer must have an active internet connection at the time of installation.

Please direct any questions to our server support channel in [discord]

*Screenshots may vary depending on options selected and program graphical user interface changes.*

## Compiler Setup¶

The current C/C++ support standard of the EQEmulator server code base mandates the use of Visual Studio 2022 or later compilers. The free Community Edition is a good option.

This setup assumes an install on a 64-bit Windows operating system with 64-bit target binaries.

## Verify System Environment Variable %Path% Length¶

Sometimes an automated server installation will fail due to the %Path% variable being full. This can happen with a manual installation as well.

Since this guide installs more programs than are required for server operation alone, verifying the length of %Path% is critical before we start

### Finding Your Current Path¶

- Click on your `Start` button

- Type "environment variable" into your `Search programs and files` text box

- Click on `Edit system environment variables`

- Click the `Environment Variables` button on the window that pops up

- Ensure the variable `Path` is selected in the system variables section (bottom text box)

- Click the `Edit` button

You may check the length of your %Path% variable by copying the `Variable value` contents and pasting them into a text editor that supports "selection" count.

Registry values are only allocated 1024 bytes of storage. However, environmental variables may contain up to 2048 bytes through the use of an alias.

If your selection count is greater than 768 characters, you may need to setup an alias to prevent corruption of the %Path% variable.

## Required Programs¶

Some of the pre-requisites for compiling binaries are the same as running a server.

If you have already installed any of the following, the download and installation requirement should be omitted:

```
`_Note: Microsoft now requires a user account to download Visual Studio. Clicking the Visual Studio link above will take you to the "older versions" page. Clicking the_ `Download` _button on that page will prompt you to log in or create an account._
`
```

- 

Visual Studio 2022 Community Edition [alternative download]

*Note: Only install one version of Visual Studio*

- 

Perl v5.24.4.1 (64-bit) [download]

- CMake (64-bit) [download]

- Git (64-bit) [download]

- 

TortoiseGit (64-bit - Optional) [download]

*Note: TortoiseGit is a menu-driven, add-on gui interface for Git. Though optional, this instructional provides for its use.*

Some programs may be able to use newer versions, or even their latest releases, without issue. But, this is not the case with Perl and (later) dependencies.

The above list of programs is known to work for compiling working server binaries.

### Install Visual Studio¶

During the install process, ensure the option for `Desktop development with C++` is checked.

Info

This package is required by Visual Studio to compile c/c++ code and by CMake to determine available compiler options. It will also cause CMake file generation to fail, if not enabled

### Install Perl¶

This installation is self-explanatory.

*Note: It is recommended that you install in the root folder (*`c:*) to avoid possible issues.*

### Install CMake¶

This installation is self-explanatory.

### Install Git¶

This installation is self-explanatory.

### Install TortoiseGit¶

This installation is self-explanatory.

### Restart Computer¶

You will need to restart your computer to ensure that all of the %Path% additions are loaded into memory.

### Acquiring the Code¶

At this point, you will need to make a decision on how you want to manage your code.

There are two options:

- Create a local repository from the parent EQEmulator project that can be updated, managed and maintained (recommended)

- 

Create a local repository from a fork of the EQEmulator project that you manage (optional - select only if you want to contribute back to the parent project)

*Note: If you choose to create a fork of the EQEmulator repository, you will need to create a _[github.com] _account.*

If you chose option 1, create a sub-folder called `git-eqemulator` in the root folder of c: drive.

If you chose option 2, create a sub-folder called `git-<git-username>` in the root folder of c: drive. (example: git username is `Pavlov`, folder name would be `git-pavlov`)

The purpose of this folder is to facilitate code management. We'll refer to this as the `account`folder..

Go to the EQEmulator server code repository web page at https://github.com/EQEmu/Server..

If you chose option 2 and are creating a fork, click on the fork button to add the repository to your github account. You should be redirected to your fork's main repository page.

Finally, click the `Clone or download` button, then `Open in Desktop` button to create a local code repository on your computer. Select `TortoiseGit` for the program to use. When prompted for where to create it, select the `account` folder created above.

You should now have a managed local code repository on your computer.

*Note: It is helpful to create a shortcut to the* `account` *folder and place it on your desktop.*.

### Install Submodules¶

To install the required submodules:

- Open your server folder in a Git CLI of your choice.

- Run `git submodule init`.

- Run `git submodule update`.

Submodules are now installed.

Info

If you are using CMake 3.15 or higher, you should modify Line 1 of your submodules/recastnavigation/CMakeLists.txt file to reflect 3.5 instead of 3.0.

### Installing Dependencies/VCPkg¶

To install the required dependencies and VCPkg, simply run CMake and they will be automatically installed.

## Running CMake¶

CMake's default options are adequate to configure and generate the files needed for Visual Studio.

There are two folder locations that you will need to provide:

- `Where is the source code:`

- `Where to build the binaries:`

For the source code, type-in or navigate to your `c:/<account>/Server` folder.

The easiest way to define the build folder is to copy the source path and paste it in. Then, add `/build` to the end of the path so that you have `c:/<account>/Server/build`.

Once CMake knows where to look, click the `Configure` button. You will get a pop-up window stating that the `build` folder does not exist. Click `OK` to create it.

The next window will be for compiler selection. Ensure that the version of Visual Studio that you installed is selected (`Visual Studio 15 2017` or `Visual Studio 16 2019`). Leave the `Use default native compilers` option as-is. If you are using a newer version of CMake that has the `Optional platform for generator` drop-down box, ensure that `x64` is selected. Finally, click `Finish` to proceed.

*Note: CMake will download the appropriate vcpkg and install its contents. User intervention is no longer required.*

You should now have a list of unconfigured options (in red) displayed in the main window of CMake:

The following list contains the most common options of interest to the majority of users:

- `EQEMU_BUILD_CLIENT_FILES` [*enabled*] Builds binaries used to import/export client support files

- `EQEMU_BUILD_LOGIN` [*disabled*] Builds the login server (this guide makes use of the login server - change this option to ***enabled***)

- `EQEMU_BUILD_LUA` [*enabled*] Compiles server code with Lua support

- `EQEMU_BUILD_PERL` [*enabled*] Compiles server code with Perl support

- `EQEMU_DEBUG_LEVEL` [*5*] Determines what additional messaging and debugging code is enabled/disabled (*12* is max)

- `EQEMU_ENABLE_BOTS` [*disabled*] Compiles server code with Bot support (user choice)

Info

Ensure that you set `EQEMU_BUILD_LOGIN` to **enabled**

Once you have set the options that you would like for your server, click `Configure` again.

Since we set an option (login server) that requires additional settings, more unconfigured options have appeared. In this case, the open ssl library:

These new options are only file path definitions. No additional changes need to be made. Click `Configure` one last time.

Info

Regardless of option settings, anytime that you have red (unconfigured) entries in your options list, you will need to click `Configure` to ensure that the settings are applied to the current CMake file generation template.

You can now click the `Generate` button.

If file generation was successful, you should see "Generating done" at the bottom of the CMake window.

You are now ready to open Visual Studio and compile your code!

## Compiling Code¶

To open the CMake-generated solution file:

- Navigate through the desktop `account` folder shortcut to `c:\<account>\Server\build`

- Right-click the `EQEmu.sln` file

- Select `Open with` >> (`Microsoft Visual Studio 2017` or `Microsoft Visual Studio 2019`)

Upon loading, Intellisense will begin mapping out the entire project. Allow a few seconds for this process to finish. The lower left-hand corner will display "Ready" when this process has completed

Visual Studio does not honor CMake's `CMAKE_BUILD_TYPE` variable. You will need to manually set this to the desired build type before compiling your code.

There are 4 options:

- `Debug` - not recommended for production servers unless conditions warrant its use (i.e., load testing, trouble-shooting, etc...)

- `RelWithDebugInfo` - standard compile for production servers (provides debug symbols without the added overhead of extra code, memory buffers and stl assertions)

- `Release` - similar to `RelWithDebugInfo`..but, without access to debug symbols (not recommended)

- `MinSizeRel` - Same as `Release` with the exception of trading off faster code for smaller size (not recommended)

Info

**Debug** *is _preferred* for a local test server_

To compile your server code, you have two choices:

- Use the menu path under the top menu (`Build` >> `Build`)

- Use the menu path by right-clicking under `Solution Explorer` (`Solution 'EQEmu'` >> `Build`)

Info

Both paths result in the same action. Use whichever you are more comfortable with

The compiled code will be located in the `c:\<account>\Server\build\bin\<build_type>`folder.

### Code Maintenance¶

- Working Tree Changes

- Master Branch Code Updates

- Dependencies and Submodules Updates

- Branches and Stashes

- Reverting Changes

- Resetting to Previous Commits

## Acquiring Quests¶

- 

Quests can be downloaded here: https://github.com/ProjectEQ/projecteqquests

- 

Place these in your server folder.

## Acquiring Database¶

- The PEQ database can be acquired here: http://db.projecteq.net/

## Acquiring Assets/Maps¶

This section needs to be updated. The current method was deprecated (eqemu_server.pl)

---

## Server Installation

*Source: server/installation/index.html*

# Server Installation¶

### So you want to be a server operator?¶

Welcome to the world of EQEmulator. Chances are that you're wondering what it would be like to craft your own world. Perhaps you don't like how someone runs the world they have created, perhaps you would like to customize a world because nothing like [insert your idea] exists. Maybe you just want to run around a world like some kind of god and slay all of those nasty beasties that had the upper hand when you played EverQuest in 1999. There's really no right or wrong reason to create a world--but certainly there are ways that it can go horribly wrong, and your decisions will likely be the cause.

This guide is nothing more than the beginning of the journey to creating your own world. This guide is an attempt to impart some wisdom on those willing to receive it, and is written in the hope that you will read it carefully, thoroughly, and consider things carefully before charging into the unknown and wasting hours of your time by making a bad decision.

### What is a World Server?¶

It's probably a good idea to take a step back and make a few observations before we get into some deeper concepts. A world server, in the simplest terms, is an application that runs on a computer, and communicates with a database of information. 

When Neo joins Morpheus in the Construct Program in the movie *The Matrix*, their conversation parallels much of what you're hoping to create: you have a program (EQEmu server) and you can load anything you want (from the database). To extend the analogy, the world server, like The Matrix, has "rules" that determine how everything works. To paraphrase Morpheus, some rules on your World Server can be bent, and some rules can be broken.

- Installing using scripted installation: 

- Basic Server Install - Linux

- Basic Server Install - Windows

### About the Server Application.¶

All of the code that you see for EQEmu Server Github is the what makes the world work--it's The Matrix. When you run the installer, you get a copy of all of that code, and the installation script makes sure it's all compiled for you. If you want to break some rules, there's a really good chance that you're going to have to learn how to change the code, and then you can compile your changes, and create your own custom application with your changes.

- For Linux Users who want to break rules: check out the Ground Up Linux Install guide.

- For Windows Users who want to break rules: check out the Ground Up Windows Install guide.

### About the Database.¶

If you want shelves full of weapons to storm the government building where they're holding Morpheus captive, you'll need a database that contains that information. When you run the installer, you get a copy of the PEQ database. The PEQ database is the database created, modified and maintained by the folks at ProjectEQ.net. Thousands and thousands of hours have likely been spent on the PEQ Database, and the people that run the project were incredibly generous and made their database open source so that anyone could make use of it. 

Info

Daily database dumps of the PEQ Database are available here

The PEQ database may not provide the exact data that makes **your world** exactly the way **YOU** want it, but they have saved you countless hours of creating zones, NPCs, pathing grids, and more. This is something to keep in mind before you spend your time complaining about the database content--they give freely, and at least to some degree, you have benefitted from their hard work. If you want to customize your world, you'll have to do some hard work too; and once you've done this work, please consider sharing it with the community, as so many others have done--someone **just like you** will benefit.

### Making the World Server talk to the Database¶

Consider this your first step in customizing your world once you've run the installer script. You will need to configure your eqemu_config.json file to set your world's name, the name of your database, and more. Follow the instructions carefully so that your decisions do not become the cause of something going horribly wrong.

Warning

Be sure to back up any files before you start to modify them! 

### Where we go from there, is a choice I leave to you¶

| 

Choice 
| Description 

| Operation 
| Learn the ins-and-outs of operating your new world 

| PEQ DB Editor 
| How to install the PEQ DB editor (so you can customize your world). 

| Scripting 
| Learn to customize NPC interactions through scripts 

| Client Config 
| You'll have to configure your client to connect to your world 

| Custom NPCs 
| Learn to create a custom NPC 

| Help! 
| Join the discussion on Discord--look for **#support server**

---

## Linux Server Installer

*Source: server/installation/server-installation-linux/index.html*

# Linux Server Installer¶

Warning

The Linux Installer is currently not working, it is suggested to use https://github.com/Akkadius/akk-stack as a much better alternative for now until the installer is addressed.

---

## Windows Server Installer

*Source: server/installation/server-installation-windows/index.html*

# Windows Server Installer¶

### Requirements¶

This installer assumes you have a **clean** install of Windows and an Internet Connection

- Windows 10 - x64

- Windows 11 - x64

**Runtime** - 2-10 minute(s) install depending on your connection

### What's in the Installer¶

- **Perl 5.24.4 x64** (Quests)

- **Lua Server Runtime** (Quests)

- **MariaDB x64 10.x**

- **Latest PEQ Database**

- **Latest PEQ Quests**

- **V2 Server Side Maps**

- **Optimized and latest server binaries (Stable)**

- **Spire Web Admin / Content Editor**

Info

More installer info found in the installation details

## Download¶

First you will need to download the install script. The install script is a thin batch script that downloads the installer and kicks the install process off.

Your browser may warn you that the file is not commonly downloaded, this is because the file is new and has not been downloaded many times yet. You can safely ignore this warning and download the file.

## Run the Installer¶

You can start the installer anywhere. Assume you run it right out of your downloads folder.

Right click **eqemu-install.bat** and **Run as Administrator** and you will be presented with the following screen.

Info

The installer only needs administrator privileges to install Perl, MariaDB and configure firewall rules. Everything else should be ran as a normal user.

You will be presented with a series of prompts to configure your server installation. For most users, you will not need to change anything and you can accept the defaults.

## Installation Details¶

### Standard Directories¶

| 

Directory 
| Details 

| C:\Program Files\MariaDB 10.11 
| Where MariaDB is installed to. You usually don't need to do anything here. 

| C:\Strawberry\perl 
| Where Perl is installed to. You usually don't need to do anything here. 

| C:\Users\<user>\code 
| Where EQEmu Server source code is located if you wish to compile yourself (not required) 

| C:\Users\<user>\server 
| Where the main server folder is located 

| C:\Users\<user>\server\maps 
| Where server side maps are located 

| C:\Users\<user>\server\quests 
| Where server side quests are located 

| C:\Users\<user>\server\shared 
| Where server side shared memory mapped files are located 

| C:\Users\<user>\server\logs 
| Where server logs are located 

| C:\Users\<user>\server\plugins 
| Where server quest perl plugins are located 

| C:\Users\<user>\server\lua_modules 
| Where server quest lua plugins are located 

| C:\Users\<user>\server\assets 
| Where server client patches, opcodes, misc are located 

| C:\Users\<user>\server\bin 
| Where server executables are located 

### Shortcut Scripts¶

| 

Script 
| Purpose 

| server_start.bat 
| Starts the server using Spire launcher 

| server_stop.bat 
| Stops the server using Spire launcher 

| server_restart.bat 
| Restarts the server using Spire launcher 

| spire_start.bat 
| Starts the Spire web service 

| spire_stop.bat 
| Stops the Spire web service 

| spire_web.bat 
| Opens the Spire web service in your default browser 

| spire_web_admin.bat 
| Opens the Spire web service in your default browser and navigates to the server admin panel /admin 

### Ports Forwarded¶

| 

Port 
| Purpose 

| 9000-9001 
| World process 

| 7000-7500 
| Zone processes 

| 7778 
| UCS 

| 5998 
| Loginserver (Titanium) 

| 5999 
| Loginserver (SoD+) 

### Install Finished¶

When the installation process is done running, you will see **"press any key to continue"** when everything should be installed and ready to go.

The installer will do a few things for you at the end

- Open up your **install_config.yml** this is all the inputs you provided to the installer or randomly generated passwords created during the install process. You can use this file to reference your passwords and other information.

- Opens up Spire web service in your default browser. This is a web service that allows you to manage your server. You can use this to start/stop/restart your server, edit content, manage accounts, manage zones, and more. Spire is continually ever evolving and is the recommended way to manage your server.

- Opens up the server folder in your file explorer. This is where all of your server files are located. You can use this to edit configuration files, add custom content, and more.

## Post-Installation¶

### Change Server Name¶

Info

Change your server name in **eqemu_config.json** under **shortname** and **longname**

### Set a GM Account (Optional)¶

To set your account as a GM, you will need to edit the **account** table in your database and set your account status to 255 once you've logged in for the first time. You can use a tool like HeidiSQL to connect to your database and edit the table. Navicat is also a great tool for this.

### Login Server¶

The windows installer comes pre-configured with a **Local Login Server**

Info

The server installer is configured to connect to the both the **EQEmu Public Login Server** and the **Local Login Server**

You can use **both** methods of logging into your server

**Login Methods**

- EQEmu Public Login Server

- Local Login Server (Private LAN Play)

Many server operators choose to keep things simple by only using the public login server

Info

For information regarding the configuration and operation of a **Local Login Server; **please refer to the documentation in the login server configuration documentation

### Connecting Clients to a Login Server¶

Info

Remember that all **EverQuest Clients** on the local network will need to have a modified **eqhost.txt** (Client file) file that points at your Local Login Server

```
`[LoginServer]
Host=192.168.0.1:5999
`
```

Be sure to adjust the IP address to the IP address of your login server on your local network.

Info

**Port 5998** is required when using the **Titanium** or **Secrets of Faydwer** clients
 **Port 5999** is required when using the **Seeds of Destruction, Underfoot** or **Rain of Fear** client and above

### Starting Server with Login Server (Optional)¶

You will need to go into Spire admin and click the "Power" button and ensure you have the login server checked. This will start the login server.

### Connecting to Local Login Server¶

Info

For more Local Login Server configuration options; see login server configuration documentation

Connect using your game client and you should see the server select screen

By default; the **login.json** used in the installer is set to **auto_create_accounts** when an account does not exist locally; making it very easy to get up and started. Resetting local login server accounts can be done through the login server command line also referenced in the login server cli documentation

```
` "account": {
 // ideal for local LAN setups, if you want a login attempt to automatically create an account
 // this will automatically create the account using the username and password if it doesn't exist
 "auto_create_accounts": true
 },
`
```

---

## Bag Sizes

*Source: server/inventory/bag-sizes/index.html*

# Bag Sizes¶

| 

Bag Size ID 
| Bag Size 

| 1 
| Small 

| 2 
| Medium 

| 3 
| Large 

| 4 
| Giant

---

## Bag Types

*Source: server/inventory/bag-types/index.html*

# Bag Types¶

| 

**Bag Type ID** 
| **Bag Type** 

| 2 
| Quiver 

| 9 
| Alchemy Container 

| 10 
| Toolbox 

| 11 
| Books 

| 12 
| Mortar and Pestle 

| 13 
| Quest Related? 

| 14 
| Mixing Bowl 

| 15 
| Spit 

| 16 
| Sewing Kit 

| 17 
| Forge 

| 18 
| Fletching Kit 

| 19 
| Brewing 

| 20 
| Jeweler's Kit 

| 22 
| New Tanaan Kiln 

| 29 
| Concordance of Research 

| 30 
| Quest Combine container 

| 46 
| Tackle Box 

| 51 
| Trader's Satchel 

| 53 
| Augmentation Sealer 

| 54 
| Cooking

---

## Inventory Slots

*Source: server/inventory/inventory-slots/index.html*

# Inventory Slots¶

### Equipment Slots (Worn)¶

Example

Slots

| 

Slot 
| # 

| Charm 
| 0 

| Ear1 
| 1 

| Head 
| 2 

| Face 
| 3 

| Ear2 
| 4 

| Neck 
| 5 

| Shoulders 
| 6 

| Arms 
| 7 

| Back 
| 8 

| Wrist1 
| 9 

| Wrist2 
| 10 

| Range 
| 11 

| Hands 
| 12 

| Primary 
| 13 

| Secondary 
| 14 

| Finger1 
| 15 

| Finger2 
| 16 

| Chest 
| 17 

| Legs 
| 18 

| Feet 
| 19 

| Waist 
| 20 

| PowerSource 
| 21 

| Ammo 
| 22 

### General Slots (Personal)¶

Example

```
`!!! Slots inline

 Bag slots in general inventory are

 | Slot | # |
 | ----------- | ----------- |
 | General1 | 23 |
 | General2 | 24 |
 | General3 | 25 |
 | General4 | 26 |
 | General5 | 27 |
 | General6 | 28 |
 | General7 | 29 |
 | General8 | 30 |
 | General9 | 31 |
 | General10 | 32 |
`
```

### Cursor Slot(s)¶

| 

Slot 
| # 

| Cursor 
| 33 

| Cursor Bag Slots 
| 6010 -> 6209 

### Tribute¶

| 

Slot 
| # 

| Cursor Bag Slots 
| 400 -> 404 

Tribute items are slots 400 -> 404, these items are not visible, but are counted for stats/effects.

### Bank¶

Bank slots are 2000 -> 2023

Bags in the bank are

| 

Base Slot 
| Range 

| 2000 
| 6210 -> 6409 

| 2001 
| 6410 -> 6609 

| 2002 
| 6610 -> 6809 

| 2003 
| 6810 -> 7009 

| 2004 
| 7010 -> 7209 

| 2005 
| 7210 -> 7409 

| 2006 
| 7410 -> 7609 

| 2007 
| 7610 -> 7809 

| 2008 
| 7810 -> 8009 

| 2009 
| 8010 -> 8209 

| 2010 
| 8210 -> 8409 

| 2011 
| 8410 -> 8609 

| 2012 
| 8610 -> 8809 

| 2013 
| 8810 -> 9009 

| 2014 
| 9010 -> 9209 

| 2015 
| 9210 -> 9409 

| 2016 
| 9410 -> 9609 

| 2017 
| 9610 -> 9809 

| 2018 
| 9810 -> 10009 

| 2019 
| 10010 -> 10209 

| 2020 
| 10210 -> 10409 

| 2021 
| 10410 -> 10609 

| 2022 
| 10610 -> 10809 

| 2023 
| 10810 -> 11009 

#### Shared Bank¶

Shared bank slots are 2500 and 2501

Note

These are stored in the sharedbank table, not the inventory table.

Bags in the shared bank are

| 

Base Slot 
| Range 

| 2500 
| 11010 -> 11209 

| 2501 
| 11210 -> 11409 

Note

Not all clients support all of the server-recognized slots. Care should be taken when attempting to hard-code slot values over the use of server-based free slot requests. For example, 200-slot bags are only supported on RoF2 at this time.

#### Quest-Use Reference¶

Info

Perl

### Examples¶

```
`quest::getinventoryslotid("cursor"); # returns current cursor slot definition
quest::getinventoryslotid("general.begin"); # returns current general slot beginning definition
quest::getinventoryslotid("augsocket.end"); # returns current augment socket end definition
`
```

### Identifier tokens ¶

```
`"charm"
"ear1"
"head"
"face"
"ear2"
"neck"
"shoulders"
"arms"
"back"
"wrist1"
"wrist2"
"range"
"hands"
"primary"
"secondary"
"finger1"
"finger2"
"chest"
"legs"
"feet"
"waist"
"powersource"
"ammo"
"general1"
"general2"
"general3"
"general4"
"general5"
"general6"
"general7"
"general8"
"general9"
"general10"
"cursor"
"possessions.begin"
"possessions.end"
"equipment.begin"
"equipment.end"
"general.begin"
"general.end"
"generalbags.begin"
"generalbags.end"
"cursorbag.begin"
"cursorbag.end"
~"tradeskill" (not implemented in perl)
~"augment" (not implemented in perl)
"bank.begin"
"bank.end"
"bankbags.begin"
"bankbags.end"
"sharedbank.begin"
"sharedbank.end"
"sharedbankbags.begin"
"sharedbankbags.end"
"bagslot.begin"
"bagslot.end"
"augsocket.begin"
"augsocket.end"
"invalid"
`
```

## Developer Information on Client-Specific Slot Support¶

### SoF Slots Equipped slots¶

| 

Slot 
| # 

| SLOT_CHARM 
| 0 

| SLOT_EAR01 
| 1 

| SLOT_HEAD 
| 2 

| SLOT_FACE 
| 3 

| SLOT_EAR02 
| 4 

| SLOT_NECK 
| 5 

| SLOT_SHOULDER 
| 6 

| SLOT_ARMS 
| 7 

| SLOT_BACK 
| 8 

| SLOT_BRACER01 
| 9 

| SLOT_BRACER02 
| 10 

| SLOT_RANGE 
| 11 

| SLOT_HANDS 
| 12 

| SLOT_PRIMARY 
| 13 

| SLOT_SECONDARY 
| 14 

| SLOT_RING01 
| 15 

| SLOT_RING02 
| 16 

| SLOT_CHEST 
| 17 

| SLOT_LEGS 
| 18 

| SLOT_FEET 
| 19 

| SLOT_WAIST 
| 20 

| SLOT_POWERSOURCE 
| 21 

| SLOT_AMMO 
| 22 

## Inventory Slots¶

NOTE: Numbering for personal inventory goes top to bottom, then left to right

It's the opposite for inside bags: left to right, then top to bottom

Example:

inventory:containers:

- 1 51 2

- 2 63 4

- 3 75 6

- 4 87 8

- 9 10

#### Personal Inventory¶

Personal inventory slots 23 through 30.

Bags in personal inventory are:

- 23: 262->271

- 24: 272->281

- 25: 282->291

- 26: 292->301

- 27: 302->311

- 28: 312->321

- 29: 322->331

- 30: 332->341

#### Cursor¶

Cursor is slot 31, and the bag slots for the cursor are 342->351 (haven't confirmed slots inside bag on cursor for SoF yet).

#### SoF Bank¶

Bank slots in SoF are 2000->2023

Bags in the bank are:

- 2000 2004 2008 2012 2016 2020

- 2001 2005 2009 2013 2017 2021

- 2002 2006 2010 2014 2018 2022

- 2003 2007 2011 2015 2019 2023

Slots inside those bags are:

Note: Other than the addition of the 8 new slots, the main bank slots are the same as Titanium, but slots inside bags are +1 to what Titanium uses.

- 2000 = 2032 - 2041

- 2001 = 2042 - 2051

- 2002 = 2052 - 2061

- 2003 = 2062 - 2071

- 2004 = 2072 - 2061

- 2005 = 2082 - 2091

- 2006 = 2092 - 2101

- 2007 = 2102 - 2111

- 2008 = 2112 - 2121

- 2009 = 2122 - 2131

- 2010 = 2132 - 2141

- 2011 = 2142 - 2151

- 2012 = 2152 - 2161

- 2013 = 2162 - 2171

- 2014 = 2172 - 2181

- 2015 = 2182 - 2191

- 8 New Bank Slots:

- 2016 = 2192 - 2201

- 2017 = 2202 - 2211

- 2018 = 2212 - 2221

- 2019 = 2222 - 2231

- 2020 = 2232 - 2241

- 2021 = 2242 - 2251

- 2022 = 2252 - 2261

- 2023 = 2262 - 2271

#### SoF Shared Bank¶

Shared bank slots in SoF are 2500 and 2501

Note: These are the same as in Titanium, but the slots for inside bags are +1 to the ones in Titanium

Bags in the shared bank are:

- 2500 = 2532 - 2541

- 2501 = 2542 - 2551

---

## Item Slots

*Source: server/inventory/item-slots/index.html*

# Item Slots¶

| 

Item Slot ID 
| Item Slot Bitmask 
| Item Slot Name 

| 0 
| 1 
| Charm 

| 1 
| 2 
| Ear 1 

| 2 
| 4 
| Head 

| 3 
| 8 
| Face 

| 4 
| 16 
| Ear 2 

| 5 
| 32 
| Neck 

| 6 
| 64 
| Shoulder 

| 7 
| 128 
| Arms 

| 8 
| 256 
| Back 

| 9 
| 512 
| Bracer 1 

| 10 
| 1024 
| Bracer 2 

| 11 
| 2048 
| Range 

| 12 
| 4096 
| Hands 

| 13 
| 8192 
| Primary 

| 14 
| 16384 
| Secondary 

| 15 
| 32768 
| Ring 1 

| 16 
| 65536 
| Ring 2 

| 17 
| 131072 
| Chest 

| 18 
| 262144 
| Legs 

| 19 
| 524288 
| Feet 

| 20 
| 1048576 
| Waist 

| 21 
| 2097152 
| Powersource 

| 22 
| 4194304 
| Ammo

---

## Alternate Currencies

*Source: server/items/alternate-currencies/index.html*

# Alternate Currencies¶

| 

Currency ID 
| Item ID 
| Item Name 

| 10 
| 79910 
| Doubloon 

| 11 
| 79911 
| Orum 

| 12 
| 79912 
| Phosphene 

| 13 
| 79913 
| Phosphite 

| 14 
| 100941 
| Faycetum 

| 15 
| 103000 
| Chronobine 

| 16 
| 43942 
| Silver Token 

| 18 
| 41408 
| McKenzie's Special Brew 

| 19 
| 46779 
| Bayle Mark 

| 20 
| 47698 
| Token of Reclamation 

| 21 
| 47900 
| Brellium Token 

| 22 
| 52149 
| Dream Mote

---

## Augment Restrictions

*Source: server/items/augment-restrictions/index.html*

# Augment Restrictions¶

| 

**ID** 
| **Aug Restriction** 

| 0 
| No Restrictions 

| 1 
| Armor Only 

| 2 
| Weapons Only 

| 3 
| One-Handed Weapons Only 

| 4 
| Two-Handed Weapons Only 

| 5 
| One-Handed Slashing Weapons Only 

| 6 
| One-Handed Blunt Weapons Only 

| 7 
| Piercing Only 

| 8 
| Hand-to-Hand Weapons Only 

| 9 
| Two-Handed Slashing Weapons Only 

| 10 
| Two-Handed Blunt Weapons Only 

| 11 
| Two-Handed Piercing Weapons Only 

| 12 
| Ranged Weapons Only 

| 13 
| Shields Only 

| 14 
| One-Handed Slashing Weapons, One-Handed Blunt Weapons, or Hand-to-Hand Weapons Only 

| 15 
| One-Handed Blunt Weapons, or Hand-to-Hand Weapons Only

---

## Augment Types

*Source: server/items/augment-types/index.html*

# Augment Types¶

| 

**Augment Type** 
| **Augment Type Value** 
| **Description** 

| 1 
| 1 
| LDoN Armor :: LDoN Augs 

| 2 
| 2 
| LDoN Armor :: LDoN Augs 

| 3 
| 4 
| LDoN and SoF+ Armors :: LDoN Augs, SoF+ Purchased Foci Augs 

| 4 
| 8 
| General Group Weapons :: General Group level Weapon Augs 

| 5 
| 16 
| LDoN Weapons :: LDoN Augs 

| 6 
| 32 
| LDoN Weapons :: LDoN Augs 

| 7 
| 64 
| General Group Armor / Weapons :: General Group level Augs 

| 8 
| 128 
| General Raid Armor / Weapons :: General Raid level Augs 

| 9 
| 256 
| DoN Purchased Armors :: DoN Purcahsed Augs 

| 10 
| 512 
| New Crafted Jewelry Items :: New JC Augs 

| 11 
| 1024 
| DoN Cultural Armors / SoD+ Crafted Weapons :: DoN+ Crafted Group Symbols / New JC Augs / SoD+ Crafted Weapon Augs 

| 12 
| 2048 
| DoN Cultural Armors :: DoN+ Crafted Raid Foci Symbols 

| 13 
| 4096 
| TBS+ Armors :: Group level Purity Augs 

| 14 
| 8192 
| SoF+ Armors :: Raid level Purity Augs 

| 15 
| 16384 
| SoF+ Armors :: Purchased Emblem Augs that increase with amount of Chest slot armor type worn 

| 16 
| 32768 
| UF+ Crafted Armors :: UF+ Crafted Symbol augs 

| 17 
| 65536 
| UF+ Crafted Armors :: UF+ Crafted Foci augs 

| 18 
| 131072 
| 

| 19 
| 262144 
| 

| 20 
| 524288 
| Standard Ornaments 

| 21 
| 1048576 
| Hero's Forge Ornaments, maybe others 

| 22 
| 2097152 
| 

| 23 
| 4194304 
| 

| 24 
| 8388608 
| 

| 25 
| 16777216 
| 

| 26 
| 33554432 
| 

| 27 
| 67108864 
| 

| 28 
| 134217728 
| 

| 29 
| 268435456 
| 

| 30 
| 536870912 
|

---

## Bard Types

*Source: server/items/bard-types/index.html*

# Bard Types¶

| 

Bard Type ID 
| Bard Type Name 

| 23 
| Wind Instruments 

| 24 
| Stringed Instruments 

| 25 
| Brass Instruments 

| 26 
| Percussion Instruments 

| 50 
| Singing 

| 51 
| All

---

## Click Types

*Source: server/items/click-types/index.html*

# Click Types¶

| 

**ID** 
| **Click Type** 

| 0 
| None 

| 1 
| Click from Inventory with Level requirement 

| 3 
| Expendable 

| 4 
| Must equip to click 

| 5 
| Click from inventory with Level / Class / Race requirements

---

## Evolving Items

*Source: server/items/evolving/index.html*

# Evolving Items¶

The evolving items system is only available on the Rain of Fear 2 (RoF2) Client. It requires Server Release 22.62.0+

- Allows for evolving item support for RoF2 only.

- Has a 30 sec timer after equipping an evolving item before it can start to evolve. Time is configurable with a Rule.
XP gain is Rule configurable for raid, solo, and group xp.

- Enables the Evolving XP Transfer in Corathus Creep. This is limited at present as I have little information. It currently allows for xp transfer between items that have the same type, and subtype. I can and will update this as feedback comes in.

- PlayerEvent logging is enabled for various functions, namely progression of an item and xp transfer between items.

- Evolving item status remains with the item, and will transfer if an tradeable item is traded. 

- There are two gm commands to monitor statis. #evolve target and #evolve item

The system is controlled using the following server rules:

| 

Category 
| Rule Name 
| Default 
| Description 

| EvolvingItems 
| PercentOfSoloExperience 
| 0.1 
| Percentage of solo experience allocated to evolving items that require experience. Default is 0.1% 

| EvolvingItems 
| PercentOfGroupExperience 
| 0.1 
| Percentage of group experience allocated to evolving items that require experience. Default is 0.1% 

| EvolvingItems 
| PercentOfRaidExperience 
| 0.1 
| Percentage of solo experience allocated to evolving items that require experience. Default is 0.1% 

| EvolvingItems 
| DelayUponEquipping 
| 30000 
| Delay in ms before an evolving item will earn rewards after equipping. Default is 30000ms or 30s. 

| EvolvingItems 
| DestroyAugmentsOnEvolve 
| false 
| If this is enabled, any augments in an item will be destroyed when the item evolves. Otherwise, send augments to the player via the parcel system (requires that the Parcel System be enabled). 

## Installation¶

This update requires that your opcodes be updated. If you are using Spire, this can be done from within that tool, otherwise the opcodes are located at within the source at /utils/patches/patches_RoF2.conf. 

The opcode in question is: OP_EvolveItem=0x7cfb

Opcodes need to be reloaded, or a server restart to take effect.

There are two tables utilized in the functionality.

# character_evolving_items¶

This table contains character specific data surrounding the evolving items in the characters possession. If a character trades, deletes, sells, etc an evolving item the deleted_at column is updated. This allows for a history of items that the character has had. Rows are not deleted.

# items_evolving_details¶

This table is sourced from the content database and contains the generic evolution data regarding an item. There are several generic columns, though there are three that should be understood:

These two tables are the most important to enable actual items.

**type**
References the how the item evolves. Types are sourced in the namespace EvolvingItems::Types and are listed below. This list will be expanded as more is known about evolving items.

| 

Type 
| Description 

| 1 
| Experience based evolution 

| 2 
| Number of Kills (implemented as of 22.62.xx) 

| 3 
| Specific Mob Race 

| 4 
| Specific Zone ID 

- Type 99 is a placeholder and identifies items not yet configured.

| 

SubType 
| Description 
| Multi-Value 

| 0 
| When type = 1, use all experience 
| No 

| 1 
| When type = 1, use only solo experience 
| No 

| 2 
| When type = 1, use only group experience 
| No 

| 3 
| When type = 1, use only raid experience 
| No 

| x 
| When type = 2, the minimum level of the mob required. 0 no requirement (implemented as of 22.62.xx) 
| No 

| x 
| When type = 3, the Mob Race ID of the kill 
| Yes 

| x 
| When type = 4, the Zone ID where the kill must occur 
| Yes 

| 

required_amount 
| Description 

| x 
| The amount required of the type/subtype combination to evolve that level of the item 

Please note:

- The mobs must produce xp otherwise the evolving logic will not trigger. That is, if you are killing mobs that do not provide xp to the player, the evolving item will not evolve.
- As of release 22.62.xx, the subtype is delimited by a '.' to allow for multiple values. Not all subtypes allow for this. Please see above table for details. Therefore, with type = 3 subtype can be '273.274' to allow for race ids of 273 an 274 to trigger the evolution.

There are two items with presets to demonstrate

**Evolution ID 1211**
Level 1 is item id 85612 requiring 100,000 of experience from any source
Level 2 is item id 85613 requiring 200,000 of experience from any source
Level 3 is item id 85614 requiring 300,000 of experience from any source

**Evolving ID 1066**
Level 1 is item id 89550 requring 500 kills of race id 274
Level 2 is item id 89551 requring 1000 kills of race id 274
Level 3 is item id 89552 requring 2000 kills of race id 274

## XP Transfer¶

There is a witch in Corathus Creep who will preform basic transfer of evolving item experience. The current implementation allows for the following:

- If sub_types are the same, the conversion rate is 100% otherwise it is 30%

- The current amount is the total of all the levels currently obtained

If there are any suggests, please create an issue and I can work to add more functionality.

## Admin Commands¶

There are several admin commands to assist GMs.

- 

#evolve item item_id

 This allows the GM to query the details of an item.
 Example: #evolve item 85613

- 

#evolve target

 Please ensure to have a player targeted.
 This is used to display the evolving details for all items that the player has in their possession.

## Player Event Logging¶

The following player events are available.

| 

Rule Name 
| Default 
| Retention 

| Evolve Item 
| Enabled 
| 7 days 

The playerevent has a status field which captures a more detailed explanation.

Status messages such as:

- Evolved Item due to obtaining progression - Old Evolve Item removed from inventory.

- Evolved Item due to obtaining progression - New Evolve Item placed in inventory.

- Transfer XP - Original FROM Evolve Item removed from inventory.

- Transfer XP - Updated FROM item placed in inventory.

- Transfer XP - Original TO Evolve Item removed from inventory.

- Transfer XP - Updated TO Evolve item placed in inventory. 

## Creating new items¶

If you would like to create a new item, not part of the exisiting evolving items already established, please follow these steps.

- Create a new 'item' in the items tables. This is found in your content database.

- There are 4 fields that play a role for evolving items. 

| 

Field 
| Description 

| evoitem 
| 1 = evolving item, 0 = not an evolving item 

| evoid 
| a unique id within all evolving items, and shared between all items of the same evolving group 

| evolvinglevel 
| the evolving level of this item within the evolving group id (1, 2, 3, etc) 

| evomax 
| the max evolving level of the evolving group id 

For example, for the items with evoid = 1066

| 

item_id 
| evoitem 
| evoid 
| evolvinglevel 
| evomax 

| 89550 
| 1 
| 1066 
| 1 
| 3 

| 89551 
| 1 
| 1066 
| 2 
| 3 

| 89552 
| 1 
| 1066 
| 3 
| 3 

- To enable the new item(s) just created, you need to rerun shared_memory and restart your server.

- Create the records in items_evolving_details as noted above.

That should be it.

If you have ideas about other ways to evolve an item, please post an issue at https://github.com/EQEmu/Server/issues

## Known Issues¶

There are currently no known issues.

---

## Food and Drink

*Source: server/items/food-and-drink/index.html*

# Food and Drink¶

These values are set in the "casttime_" field of the items table

## Food¶

| 

Value 
| Description 

| 0-5 
| This is a snack. 

| 6-20 
| This is a meal. 

| 21-30 
| This is a hearty meal. 

| 31-40 
| This is a banquet size meal. 

| 41-50 
| This meal is a feast! 

| 51-60 
| This is an enduring meal! 

| 61-X 
| This is a miraculous meal! 

## Drink¶

| 

Value 
| Description 

| 0-5 
| This is a whistle wetter. 

| 6-20 
| This is a drink. 

| 21-30 
| This is a refreshing drink. 

| 31-40 
| This is a lasting drink. 

| 41-50 
| This is a flowing drink! 

| 51-60 
| This is an enduring drink! 

| 61-X 
| This is a miraculous drink!

---

## GetItemStat Identifiers

*Source: server/items/getitemstat-identifiers/index.html*

# GetItemStat Identifiers¶

| 

Identifier 

| itemclass 

| id 

| weight 

| norent 

| nodrop 

| size 

| slots 

| price 

| icon 

| loregroup 

| loreflag 

| pendingloreflag 

| artifactflag 

| summonedflag 

| fvnodrop 

| favor 

| guildfavor 

| pointtype 

| bagtype 

| bagslots 

| bagsize 

| bagwr 

| benefitflag 

| tradeskills 

| cr 

| dr 

| pr 

| mr 

| fr 

| astr 

| asta 

| aagi 

| adex 

| acha 

| aint 

| awis 

| hp 

| mana 

| ac 

| deity 

| skillmodvalue 

| skillmodtype 

| banedmgrace 

| banedmgamt 

| banedmgbody 

| magic 

| casttime_ 

| reqlevel 

| bardtype 

| bardvalue 

| light 

| delay 

| reclevel 

| recskill 

| elemdmgtype 

| elemdmgamt 

| range 

| damage 

| color 

| classes 

| races 

| maxcharges 

| itemtype 

| material 

| casttime 

| elitematerial 

| procrate 

| combateffects 

| shielding 

| stunresist 

| strikethrough 

| extradmgskill 

| extradmgamt 

| spellshield 

| avoidance 

| accuracy 

| charmfileid 

| factionmod1 

| factionmod2 

| factionmod3 

| factionmod4 

| factionamt1 

| factionamt2 

| factionamt3 

| factionamt4 

| augtype 

| ldontheme 

| ldonprice 

| ldonsold 

| banedmgraceamt 

| augrestrict 

| endur 

| dotshielding 

| attack 

| regen 

| manaregen 

| enduranceregen 

| haste 

| damageshield 

| recastdelay 

| recasttype 

| augdistiller 

| attuneable 

| nopet 

| potionbelt 

| stackable 

| notransfer 

| questitemflag 

| stacksize 

| potionbeltslots 

| book 

| booktype 

| svcorruption 

| purity 

| backstabdmg 

| dsmitigation 

| heroicstr 

| heroicint 

| heroicwis 

| heroicagi 

| heroicdex 

| heroicsta 

| heroiccha 

| heroicmr 

| heroicfr 

| heroiccr 

| heroicdr 

| heroicpr 

| heroicsvcorrup 

| healamt 

| spelldmg 

| ldonsellbackrate 

| scriptfileid 

| expendablearrow 

| clairvoyance 

| clickeffect 

| clicktype 

| clicklevel 

| clicklevel2 

| proceffect 

| proctype 

| proclevel 

| proclevel2 

| worneffect 

| worntype 

| wornlevel 

| wornlevel2 

| focuseffect 

| focustype 

| focuslevel 

| focuslevel2 

| scrolleffect 

| scrolltype 

| scrolllevel 

| scrolllevel2

---

## Item Class

*Source: server/items/item-class/index.html*

# Item Class¶

| 

Item Class ID 
| Item Class 

| 0 
| Common item 

| 1 
| Container 

| 2 
| Book

---

## Item Click Types

*Source: server/items/item-click-types/index.html*

# Item Click Types¶

| 

Click Type ID 
| Click Type 

| 1 
| Item can be cast from any slot. 

| 3 
| Item can be cast from any slot. 

| 4 
| Item must be equipped to cast effect. 

| 5 
| Seems to involve poisoning a weapon.

---

## Item Element Types

*Source: server/items/item-element-types/index.html*

# Item Element Types¶

| 

Element Type ID 
| Element Type 

| 1 
| Magic 

| 2 
| Fire 

| 3 
| Cold 

| 4 
| Poison 

| 5 
| Disease

---

## Item Lore Groups

*Source: server/items/item-lore-groups/index.html*

# Item Lore Groups¶

| 

Lore Group ID 
| Lore Group 

| -1 
| Standard Lore Item. 

| 0 
| Not a Lore Item. 

| >0 
| A member of a lore group.

---

## Item Sizes

*Source: server/items/item-sizes/index.html*

# Item Sizes¶

| 

**ID** 
| **Size** 

| 0 
| TINY 

| 1 
| SMALL 

| 2 
| MEDIUM 

| 3 
| LARGE 

| 4 
| GIANT 

| 5 
| GIGANTIC

---

## Item Types

*Source: server/items/item-types/index.html*

# Item Types¶

| 

**ID** 
| **Type** 

| 0 
| 1H Slashing 

| 1 
| 2H Slashing 

| 2 
| Piercing 

| 3 
| 1H Blunt 

| 4 
| 2H Blunt 

| 5 
| Archery 

| 6 
| Crossbow 

| 7 
| Throwing v1 

| 8 
| Shield 

| 9 
| Spell 

| 10 
| Armor 

| 11 
| Misc 

| 12 
| Lockpicks 

| 13 
| Fist 

| 14 
| Food 

| 15 
| Drink 

| 16 
| Light 

| 17 
| Combinable 

| 18 
| Bandages 

| 19 
| Throwing v2 

| 20 
| Scroll 

| 21 
| Potion 

| 22 
| Fletched Arrow 

| 23 
| Wind Instrument 

| 24 
| Stringed Instrument 

| 25 
| Brass Instrument 

| 26 
| Percussion Instrument 

| 27 
| Arrow 

| 28 
| Bolt 

| 29 
| Jewelry 

| 30 
| Skull 

| 31 
| Book 

| 32 
| Note 

| 33 
| Key v1 

| 34 
| Coin 

| 35 
| 2H Piercing 

| 36 
| Fishing Pole 

| 37 
| Fishing Bait 

| 38 
| Alcohol 

| 39 
| Key v2 

| 40 
| Compass 

| 41 
| Metal Key 

| 42 
| Poison 

| 43 
| Magic Arrow 

| 44 
| Magic Bolt 

| 45 
| Hand to Hand 

| 46 
| Item Has Effect 

| 47 
| Haste Item 

| 48 
| Item Has FT 

| 49 
| Item Has Focus 

| 50 
| Singing Instrument 

| 51 
| All Instruments 

| 52 
| Charm 

| 53 
| Armor Dye 

| 54 
| Augment 

| 55 
| Augment Solvent 

| 56 
| Augment Distiller 

| 57 
| Alternate Ability 

| 58 
| Guild Banner Kit 

| 59 
| Guild Banner Modify Token 

| 60 
| Cultural Armor Recipe Book 

| 61 
| Cultural Weapon Recipe Book 

| 62 
| Book with Spell Effect 

| 63 
| Alternate Currency 

| 64 
| Perfected Augment Distiller 

| 65 
| Placeable 

| 66 
| Collectible 

| 67 
| Container 

| 68 
| Mount 

| 69 
| Illusion 

| 70 
| Familiar 

| 71 
| Unknown71 

| 72 
| Unknown72 

| 255 
| None

---

## Ornament Types

*Source: server/items/ornament-types/index.html*

# Ornament Types¶

### Preview¶

- To preview: #heromodel id

| 

**ID** 
| **Full Name** 
| **Image** 

| 60 
| Noble Plate 
| 

| 61 
| Bloodforged Plate 
| 

| 62 
| Eternal Grove Plate 
| 

| 63 
| Valiant Plate 
| 

| 64 
| Insidious Plate 
| 

| 65 
| Eternal Grove Plate 
| 

| 70 
| Noble Plate 
| 

### Using¶

- To create a Hero's Forge Ornamentation you have to set the Hero's Forge Model column in the items table to a value greater than 0.

- You must also make sure that the augment is the proper type, check the Augment Types reference for more information.

| 

Description 
| Hero's Forge Model 

| Basic Plate Helmet 
| 2000 

| Basic Plate Vambraces 
| 2002 

| Basic Plate Bracer 
| 2003 

| Basic Plate Gauntlets 
| 2004 

| Basic Breastplate 
| 2001 

| Basic Plate Greaves 
| 2005 

| Basic Plate Sabatons 
| 2006 

| Basic Leather Helmet 
| 3000 

| Basic Leather Vambraces 
| 3002 

| Basic Leather Bracer 
| 3003 

| Basic Leather Gauntlets 
| 3004 

| Basic Leather Chestpiece 
| 3001 

| Basic Leather Pants 
| 3005 

| Basic Leather Boots 
| 3006 

| Basic Chain Cowl 
| 4000 

| Basic Chain Vambraces 
| 4002 

| Basic Chain Bracer 
| 4003 

| Basic Chain Gauntlets 
| 4004 

| Basic Chain Chestpiece 
| 4001 

| Basic Chain Pants 
| 4005 

| Basic Chain Boots 
| 4006 

| Basic Cloth Cowl 
| 5000 

| Basic Cloth Shoulders 
| 5002 

| Basic Cloth Bracer 
| 5003 

| Basic Cloth Gloves 
| 5004 

| Basic Cloth Shirt 
| 5001 

| Basic Cloth Pants 
| 5005 

| Basic Cloth Sandals 
| 5006 

| Blue Plate Helmet I 
| 6000 

| Blue Plate Vambraces I 
| 6002 

| Blue Plate Bracer I 
| 6003 

| Blue Plate Gauntlets I 
| 6004 

| Blue Breastplate I 
| 6001 

| Blue Plate Greaves I 
| 6005 

| Blue Plate Sabatons I 
| 6006 

| Red Plate Helmet I 
| 6100 

| Red Plate Vambraces I 
| 6102 

| Red Plate Bracer I 
| 6103 

| Red Plate Gauntlets I 
| 6104 

| Red Breastplate I 
| 6101 

| Red Plate Greaves I 
| 6105 

| Red Plate Sabatons I 
| 6106 

| Green Plate Helmet I 
| 6200 

| Green Plate Vambraces I 
| 6202 

| Green Plate Bracer I 
| 6203 

| Green Plate Gauntlets I 
| 6204 

| Green Breastplate I 
| 6201 

| Green Plate Greaves I 
| 6205 

| Green Plate Sabatons I 
| 6206 

| Blue Plate Helmet II 
| 6300 

| Blue Plate Vambraces II 
| 6302 

| Blue Plate Bracer II 
| 6303 

| Blue Plate Gauntlets II 
| 6304 

| Blue Breastplate II 
| 6301 

| Blue Plate Greaves II 
| 6305 

| Blue Plate Sabatons II 
| 6306 

| Red Plate Helmet II 
| 6400 

| Red Plate Vambraces II 
| 6402 

| Red Plate Bracer II 
| 6403 

| Red Plate Gauntlets II 
| 6404 

| Red Breastplate II 
| 6401 

| Red Plate Greaves II 
| 6405 

| Red Plate Sabatons II 
| 6406 

| Green Plate Helmet II 
| 6500 

| Green Plate Vambraces II 
| 6502 

| Green Plate Bracer II 
| 6503 

| Green Plate Gauntlets II 
| 6504 

| Green Breastplate II 
| 6501 

| Green Plate Greaves II 
| 6505 

| Green Plate Sabatons II 
| 6506 

| Blue Plate Helmet III 
| 7000 

| Blue Plate Vambraces III 
| 7002 

| Blue Plate Bracer III 
| 7003 

| Blue Plate Gauntlets III 
| 7004 

| Blue Breastplate III 
| 7001 

| Blue Plate Greaves III 
| 7005 

| Blue Plate Sabatons III 
| 7006 

| Red Plate Helmet III 
| 7100 

| Red Plate Vambraces III 
| 7102 

| Red Plate Bracer III 
| 7103 

| Red Plate Gauntlets III 
| 7104 

| Red Breastplate III 
| 7101 

| Red Plate Greaves III 
| 7105 

| Red Plate Sabatons III 
| 7106 

| Green Plate Helmet III 
| 7200 

| Green Plate Vambraces III 
| 7202 

| Green Plate Bracer III 
| 7203 

| Green Plate Gauntlets III 
| 7204 

| Green Breastplate III 
| 7201 

| Green Plate Greaves III 
| 7205 

| Green Plate Sabatons III 
| 7206 

| Blue Plate Helmet IV 
| 7300 

| Blue Plate Vambraces IV 
| 7302 

| Blue Plate Bracer IV 
| 7303 

| Blue Plate Gauntlets IV 
| 7304 

| Blue Breastplate IV 
| 7301 

| Blue Plate Greaves IV 
| 7305 

| Blue Plate Sabatons IV 
| 7306 

| Red Plate Helmet IV 
| 7400 

| Red Plate Vambraces IV 
| 7402 

| Red Plate Bracer IV 
| 7403 

| Red Plate Gauntlets IV 
| 7404 

| Red Breastplate IV 
| 7401 

| Red Plate Greaves IV 
| 7405 

| Red Plate Sabatons IV 
| 7406 

| Green Plate Helmet IV 
| 7500 

| Green Plate Vambraces IV 
| 7502 

| Green Plate Bracer IV 
| 7503 

| Green Plate Gauntlets IV 
| 7504 

| Green Breastplate IV 
| 7501 

| Green Plate Greaves IV 
| 7505 

| Green Plate Sabatons IV 
| 7506 

| Blue Plate Helmet V 
| 8000 

| Blue Plate Vambraces V 
| 8002 

| Blue Plate Bracer V 
| 8003 

| Blue Plate Gauntlets V 
| 8004 

| Blue Breastplate V 
| 8001 

| Blue Plate Greaves V 
| 8005 

| Blue Plate Sabatons V 
| 8006 

| Red Plate Helmet V 
| 8100 

| Red Plate Vambraces V 
| 8102 

| Red Plate Bracer V 
| 8103 

| Red Plate Gauntlets V 
| 8104 

| Red Breastplate V 
| 8101 

| Red Plate Greaves V 
| 8105 

| Red Plate Sabatons V 
| 8106 

| Green Plate Helmet V 
| 8200 

| Green Plate Vambraces V 
| 8202 

| Green Plate Bracer V 
| 8203 

| Green Plate Gauntlets V 
| 8204 

| Green Breastplate V 
| 8201 

| Green Plate Greaves V 
| 8205 

| Green Plate Sabatons V 
| 8206 

| Blue Plate Helmet VI 
| 8300 

| Blue Plate Vambraces VI 
| 8302 

| Blue Plate Bracer VI 
| 8303 

| Blue Plate Gauntlets VI 
| 8304 

| Blue Breastplate VI 
| 8301 

| Blue Plate Greaves VI 
| 8305 

| Blue Plate Sabatons VI 
| 8306 

| Red Plate Helmet VI 
| 8400 

| Red Plate Vambraces VI 
| 8402 

| Red Plate Bracer VI 
| 8403 

| Red Plate Gauntlets VI 
| 8404 

| Red Breastplate VI 
| 8401 

| Red Plate Greaves VI 
| 8405 

| Red Plate Sabatons VI 
| 8406 

| Green Plate Helmet VI 
| 8500 

| Green Plate Vambraces VI 
| 8502 

| Green Plate Bracer VI 
| 8503 

| Green Plate Gauntlets VI 
| 8504 

| Green Breastplate VI 
| 8501 

| Green Plate Greaves VI 
| 8505 

| Green Plate Sabatons VI 
| 8506 

| Blue Plate Helmet VII 
| 9000 

| Blue Plate Vambraces VII 
| 9002 

| Blue Plate Bracer VII 
| 9003 

| Blue Plate Gauntlets VII 
| 9004 

| Blue Breastplate VII 
| 9001 

| Blue Plate Greaves VII 
| 9005 

| Blue Plate Sabatons V 
| 9006 

| Red Plate Helmet VII 
| 9100 

| Red Plate Vambraces VII 
| 9102 

| Red Plate Bracer VII 
| 9103 

| Red Plate Gauntlets VII 
| 9104 

| Red Breastplate VII 
| 9101 

| Red Plate Greaves VII 
| 9105 

| Red Plate Sabatons VII 
| 9106 

| Green Plate Helmet VII 
| 9200 

| Green Plate Vambraces VII 
| 9202 

| Green Plate Bracer VII 
| 9203 

| Green Plate Gauntlets VII 
| 9204 

| Green Breastplate VII 
| 9201 

| Green Plate Greaves VII 
| 9205 

| Green Plate Sabatons VII 
| 9206 

| Blue Plate Helmet VIII 
| 9300 

| Blue Plate Vambraces VIII 
| 9302 

| Blue Plate Bracer VIII 
| 9303 

| Blue Plate Gauntlets VIII 
| 9304 

| Blue Breastplate VIII 
| 9301 

| Blue Plate Greaves VIII 
| 9305 

| Blue Plate Sabatons VIII 
| 9306 

| Red Plate Helmet VIII 
| 9400 

| Red Plate Vambraces VIII 
| 9402 

| Red Plate Bracer VIII 
| 9403 

| Red Plate Gauntlets VIII 
| 9404 

| Red Breastplate VIII 
| 9401 

| Red Plate Greaves VIII 
| 9405 

| Red Plate Sabatons VIII 
| 9406 

| Green Plate Helmet VIII 
| 9500 

| Green Plate Vambraces VIII 
| 9502 

| Green Plate Bracer VIII 
| 9503 

| Green Plate Gauntlets VIII 
| 9504 

| Green Breastplate VIII 
| 9501 

| Green Plate Greaves VIII 
| 9505 

| Green Plate Sabatons VIII 
| 9506 

| Green Knight Helmet 
| 10000 

| Green Knight Vambraces 
| 10002 

| Green Knight Bracer 
| 10003 

| Green Knight Gauntlets 
| 10004 

| Green Knight Breastplate 
| 10001 

| Green Knight Greaves 
| 10005 

| Green Knight Sabatons 
| 10006 

| Purple Knight Helmet 
| 10400 

| Purple Knight Vambraces 
| 10402 

| Purple Knight Bracer 
| 10403 

| Purple Knight Gauntlets 
| 10404 

| Purple Knight Breastplate 
| 10401 

| Purple Knight Greaves 
| 10405 

| Purple Knight Sabatons 
| 10406 

| Blue Knight Helmet 
| 10800 

| Blue Knight Vambraces 
| 10802 

| Blue Knight Bracer 
| 10803 

| Blue Knight Gauntlets 
| 10804 

| Blue Knight Breastplate 
| 10801 

| Blue Knight Greaves 
| 10805 

| Blue Knight Sabatons 
| 10806 

| Red Knight Helmet 
| 11200 

| Red Knight Vambraces 
| 11202 

| Red Knight Bracer 
| 11203 

| Red Knight Gauntlets 
| 11204 

| Red Knight Breastplate 
| 11201 

| Red Knight Greaves 
| 11205 

| Red Knight Sabatons 
| 11206 

| Pumpkin Head 
| 11700 

| Part of a Pumpkin Head 
| 11800 

| Skull Head 
| 11900 

| Mummy Head 
| 12000 

| Purple Wizard Hat I 
| 12100 

| Blue Wizard Hat I 
| 12200 

| Red Santa Hat 
| 12300 

| Elf Hat I 
| 12400 

| Reindeer Nose 
| 12500 

| Top Hat 
| 12600 

| Snowman Head 
| 12700 

| Reindeer Ears 
| 12800 

| Elf Hat II 
| 12900 

| Green Santa Hat 
| 13000 

| Beholder Head 
| 13100 

| Iron Mask 
| 13200 

| Flaming Wizard Hat 
| 13300 

| Skull and Crossbones Wizard Hat 
| 13400 

| Purple Wizard Hat II 
| 13500 

| Green Wizard Hat I 
| 13600 

| White Wizard Hat I 
| 13700 

| Skull Wizard Hat 
| 13800 

| Purple Wizard Hat III 
| 13900 

| Black Wizard Hat 
| 14000 

| Blue Wizard Hat II 
| 14100 

| Purple Wizard Hat IV 
| 14200 

| Green Wizard Hat II 
| 14300 

| Orange Wizard Hat 
| 14400 

| Brown Bear Head 
| 14500 

| Polar Bear Head 
| 14600 

| Black Bear Head 
| 14700 

| Panda Bear Head 
| 14800 

| White Wizard Hat II 
| 14900 

| Fox Head 
| 15100 

| Wolf Head 
| 15200 

| Rabbit Head 
| 15300 

| Lucky Hat I 
| 15400 

| Lucky Hat II 
| 15500 

| Heart Bandana 
| 15800 

| Arrow Head I 
| 15900 

| Heart Tophat 
| 16000 

| Arrow Head II 
| 16100

---

## Powersources

*Source: server/items/powersources/index.html*

# Powersources¶

## Description¶

- Powersources add invisible augments to infusible gear.

- These augs are scaled by the purity stat of the item.

- This does not send a scaling value in the item header.

- Each infusible item has 2 reserved slots for powersource augments of type 1 and type 2, generally just weapons actually use both.

- The stat aug goes in type 1 slot and proc aug goes into type 2.

- The augslot#unk2 values seem to be 1 for the powersource slots, unsure if this actually has to do with powersources or just that they make sue of whatever it is.

## Dull Orbs¶

| 

**Name** 
| **Gear Aug** 
| **1-Hander Augs** 
| **2-Hander Augs** 
| **Bow Augs** 

| Dull Energeian Air Orb 
| Air 
| Air Procs 
| Air Procs 
| Air Procs 

| Dull Energeian Earth Orb 
| Earth 
| Earth Procs 
| Earth Procs 
| Earth Procs 

| Dull Energeian Fire Orb 
| Fire 
| Fire Procs 
| Fire Procs 
| Fire Procs 

| Dull Energeian Ice Orb 
| Ice 
| Ice Procs 
| Ice Procs 
| Ice Procs 

## Murky Orbs¶

| 

**Name** 
| **Gear Aug** 
| **1-Hander Augs** 
| **2-Hander Augs** 
| **Bow Augs** 

| Murky Energeian Earth Orb 
| Earth (?) 
| Earth Procs (?) 
| Earth Procs (?) 
| Earth Procs (?) 

| Murky Energeian Air Orb 
| Air 
| Air Procs 
| Air Procs 
| Air Procs 

| Murky Energeian Decay Orb 
| Decay 
| Decay Procs 
| Decay Procs 
| Decay Procs 

| Murky Energeian Fire Orb 
| Fire 
| Fire Procs 
| Fire Procs 
| Fire Procs 

| Murky Energeian Growth Orb 
| Growth 
| Growth Procs 
| Growth Procs 
| Growth Procs 

| Murky Energeian Ice Orb 
| Ice 
| Ice Procs 
| Ice Procs 
| Ice Procs 

## Foggy Orbs¶

| 

**Name** 
| **Gear Augs** 
| **1-Hander Augs** 
| **2-Hander Augs** 
| **Bow Augs** 

| Foggy Energeian Air Orb 
| Air 
| Air Procs 
| Air Procs 
| Air Procs 

| Foggy Energeian Decay Orb 
| Decay 
| Decay Procs 
| Decay Procs 
| Decay Procs 

| Foggy Energeian Disease Orb 
| Disease 
| Disease Procs 
| Disease Procs 
| Disease Procs 

| Foggy Energeian Earth Orb 
| Earth 
| Earth Procs 
| Earth Procs 
| Earth Procs 

| Foggy Energeian Fire Orb 
| Fire 
| Fire Procs 
| Fire Procs 
| Fire Procs 

| Foggy Energeian Growth Orb 
| Growth 
| Growth Procs 
| Growth Procs 
| Growth Procs 

| Foggy Energeian Ice Orb 
| Ice 
| Ice Procs 
| Ice Procs 
| Ice Procs 

| Foggy Energeian Poison Orb 
| Poison 
| Poison Procs 
| Poison Procs 
| Poison Procs 

## Cloudy Orbs¶

| 

**Name** 
| **Gear Augs** 
| **1-Hander Augs** 
| **2-Hander Augs** 
| **Bow Augs** 

| Cloudy Energeian Air Orb 
| Air 
| Air Procs 
| Air Procs 
| Air Procs 

| Cloudy Energeian Decay Orb 
| Decay 
| Decay Procs 
| Decay Procs 
| Decay Procs 

| Cloudy Energeian Disease Orb 
| Disease 
| Disease Procs 
| Disease Procs 
| Disease Procs 

| Cloudy Energeian Earth Orb 
| Earth 
| Earth Procs 
| Earth Procs 
| Earth Procs 

| Cloudy Energeian Fire Orb 
| Fire 
| Fire Procs 
| Fire Procs 
| Fire Procs 

| Cloudy Energeian Growth Orb 
| Growth 
| Growth Procs 
| Growth Procs 
| Growth Procs 

| Cloudy Energeian Ice Orb 
| Ice 
| Ice Procs 
| Ice Procs 
| Ice Procs 

| Cloudy Energeian Light Orb 
| Light 
| Light Procs 
| Light Procs 
| Light Procs 

| Cloudy Energeian Poison Orb 
| Poison 
| Poison Procs 
| Poison Procs 
| Poison Procs 

| Cloudy Energeian Shadow Orb 
| Shadow 
| Shadow Procs 
| Shadow Procs 
| Shadow Procs 

| Cloudy Energeian Water Orb 
| Water 
| Water Procs 
| Water Procs 
| Water Procs 

## Misty Orbs¶

| 

**Name** 
| **Gear Augs** 
| **1-Hander Augs** 
| **2-Hander Augs** 
| **Bow Augs** 

| Misty Energeian Air Orb 
| Air 
| Air Procs 
| Air Procs 
| Air Procs 

| Misty Energeian Decay Orb 
| Decay 
| Decay Procs 
| Decay Procs 
| Decay Procs 

| Misty Energeian Disease Orb 
| Disease 
| Disease Procs 
| Disease Procs 
| Disease Procs 

| Misty Energeian Earth Orb 
| Earth 
| Earth Procs 
| Earth Procs 
| Earth Procs 

| Misty Energeian Fire Orb 
| Fire 
| Fire Procs 
| Fire Procs 
| Fire Procs 

| Misty Energeian Growth Orb 
| Growth 
| Growth Procs 
| Growth Procs 
| Growth Procs 

| Misty Energeian Ice Orb 
| Ice 
| Ice Procs 
| Ice Procs 
| Ice Procs 

| Misty Energeian Light Orb 
| Light 
| Light Procs 
| Light Procs 
| Light Procs 

| Misty Energeian Shadow Orb 
| Shadow 
| Shadow Procs 
| Shadow Procs 
| Shadow Procs 

| Misty Energeian Steam Orb 
| Steam 
| Steam Procs 
| Steam Procs 
| Steam Procs 

| Misty Energeian Stone Orb 
| Stone 
| Stone Procs 
| Stone Procs 
| Stone Procs 

| Misty Energeian Water Orb 
| Water 
| Water Procs 
| Water Procs 
| Water Procs 

## Translucent Orbs¶

| 

**Name** 
| **Gear Aug** 
| **1-Hander Augs** 
| **2-Hander Augs** 
| **Bow Augs** 

| Translucent Energeian Air Orb 
| Air (?) 
| Air Procs 
| Air Procs 
| Air Procs 

| Translucent Energeian Decay Orb 
| Decay (?) 
| Decay Procs 
| Decay Procs 
| Decay Procs 

| Translucent Energeian Disease Orb 
| Disease (?) 
| Disease Procs 
| Disease Procs 
| Disease Procs 

| Translucent Energeian Earth Orb 
| Earth (?) 
| Earth Procs 
| Earth Procs 
| Earth Procs 

| Translucent Energeian Elemental Orb 
| Elemental 
| Elemental Procs 
| Elemental Procs 
| Elemental Procs 

| Translucent Energeian Ethereal Orb 
| Ethereal (?) 
| Ethereal Procs 
| Ethereal Procs 
| Ethereal Procs 

| Translucent Energeian Fire Orb 
| Fire (?) 
| Fire Procs 
| Fire Procs 
| Fire Procs 

| Translucent Energeian Growth Orb 
| Growth (?) 
| Growth Procs 
| Growth Procs 
| Growth Procs 

| Translucent Energeian Ice Orb 
| Ice (?) 
| Ice Procs 
| Ice Procs 
| Ice Procs 

| Translucent Energeian Light Orb 
| Light (?) 
| Light Procs 
| Light Procs 
| Light Procs 

| Translucent Energeian Poison Orb 
| Poison (?) 
| Poison Procs 
| Poison Procs 
| Poison Procs 

| Translucent Energeian Shadow Orb 
| Shadow (?) 
| Shadow Procs 
| Shadow Procs 
| Shadow Procs 

| Translucent Energeian Steam Orb 
| Steam (?) 
| Steam Procs 
| Steam Procs 
| Steam Procs 

| Translucent Energeian Stone Orb 
| Stone (?) 
| Stone Procs 
| Stone Procs 
| Stone Procs 

| Translucent Energeian Water Orb 
| Water (?) 
| Water Procs 
| Water Procs 
| Water Procs 

## Pure Orbs¶

| 

**Name** 
| **Gear Augs** 
| **1-Hander Augs** 
| **2-Hander Augs** 
| **Bow Augs** 

| Pure Energeian Air Orb 
| Air (?) 
| Air Procs 
| Air Procs 
| Air Procs 

| Pure Energeian Death Orb 
| Death (?) 
| Death Procs 
| Death Procs 
| Death Procs 

| Pure Energeian Decay Orb 
| Decay (?) 
| Deacy Procs 
| Decay Procs 
| Decay Procs 

| Pure Energeian Disease Orb 
| Disease (?) 
| Disease Procs 
| Disease Procs 
| Disease Procs 

| Pure Energeian Earth Orb 
| Earth (?) 
| Earth Procs 
| Earth Procs 
| Earth Procs 

| Pure Energeian Elemental Orb 
| Elemental (?) 
| Elemental Procs 
| Elemental Procs 
| Elemental Procs 

| Pure Energeian Ethereal Orb 
| Ethereal (?) 
| Ethereal Procs 
| Ethereal Procs 
| Ethereal Procs 

| Pure Energeian Fire Orb 
| Fire (?) 
| Fire Procs 
| Fire Procs 
| Fire Procs 

| Pure Energeian Growth Orb 
| Growth (?) 
| Growth Procs 
| Growth Procs 
| Growth Procs 

| Pure Energeian Ice Orb 
| Ice (?) 
| Ice Procs 
| Ice Procs 
| Ice Procs 

| Pure Energeian Light Orb 
| Light (??) 
| Light Procs 
| Light Procs 
| Light Procs 

| Pure Energeian Light Orb 
| Light (??) 
| Light Procs 
| Light Procs 
| Light Procs 

| Pure Energeian Metal Orb 
| Metal (??) 
| Metal Procs 
| Metal Procs 
| Metal Procs 

| Pure Energeian Metal Orb 
| Metal (??) 
| Metal Procs 
| Metal Procs 
| Metal Procs 

| Pure Energeian Poison Orb 
| Poison (?) 
| Poison Procs 
| Poison Procs 
| Poison Procs 

| Pure Energeian Shadow Orb 
| Shadow (?) 
| Shadow Procs 
| Shadow Procs 
| Shadow Procs 

| Pure Energeian Steam Orb 
| Steam (?) 
| Steam Procs 
| Steam Procs 
| Steam Procs 

| Pure Energeian Stone Orb 
| Stone (?) 
| Stone Procs 
| Stone Procs 
| Stone Procs 

| Pure Energeian Water Orb 
| Water (?) 
| Water Procs 
| Water Procs 
| Water Procs 

## Dropped¶

| 

**Name** 
| **Gear Aug** 
| **1-Hander Augs** 
| **2-Hander Augs** 
| **Bow Augs** 

| Xorbb's Caged Hatred 
| Hatred 
| Hatred Procs 
| Hatred Procs 
| Hatred Procs 

| Combine Power Shard 
| Combine Power 
| Combine Power Procs 
| Combine Power Procs 
| Combine Power Procs 

| Geomantic Steelstone 
| Steelstone 
| Steelstone Procs 
| Steelstone Procs 
| Steelstone Procs 

| Ocean Purification Stone 
| Ocean 
| Ocean Procs 
| Ocean Procs 
| Ocean Procs 

| Thaell Ew Totem 
| Thaell Ew 
| Thaell Ew Procs 
| Thaell Ew Procs 
| Thaell Ew Procs

---

## Wearable Models

*Source: server/items/wearable-models/index.html*

# Armor Models¶

This is a scan result for meshes with an IT prefix found inside s3d and eqg files.

Since it causes eqemu docs to lag up, it was shuffled to a gist instead here

---

## Discord Logging

*Source: server/logging-system/discord-logging/index.html*

# Discord Logging Integration¶

This is meant to be purely a one-way, highly performing implementation of publishing data to Discord.

- Strictly one-way

- Highly performing

- Extends the EQEmu Logging system to include another category called

- Messages get batched in multiples of the same type to prevent from sending many individual messages

- Runs through UCS. If you do not use UCS; this integration will not send messages to Discord

- Runs a queue listener in its own thread on UCS so even there is rate limiting congestion, it will sleep and retry on its own thread not to interrupt the main UCS thread or networking threads

- Has new Quest API methods to leverage this functionality for logging events to player facing channels or administrative facing channels. For example maybe you want to have the hackers logging category be send to an admin channel and you want an in game world wide emote to broadcast to a player announcement channel when a certain event happens

- Optimizations to EQEmu Core Logging system

### New Table (discord_webhooks)¶

This table pertains to webhook mappings that will correspond to `discord_webhook_id` in the `logsys_categories` table

```
`MariaDB [peq]> describe discord_webhooks;
+--------------+--------------+------+-----+---------+----------------+
| Field | Type | Null | Key | Default | Extra |
+--------------+--------------+------+-----+---------+----------------+
| id | int(11) | NO | PRI | NULL | auto_increment |
| webhook_name | varchar(100) | YES | | NULL | |
| webhook_url | varchar(255) | YES | | NULL | |
| created_at | datetime | YES | | NULL | |
| deleted_at | datetime | YES | | NULL | |
+--------------+--------------+------+-----+---------+----------------+
`
```

### New Fields (logsys_categories)¶

```
`MariaDB [peq]> describe logsys_categories;
+--------------------------+--------------+------+-----+---------+-------+
| Field | Type | Null | Key | Default | Extra |
+--------------------------+--------------+------+-----+---------+-------+
| log_category_id | int(11) | NO | PRI | NULL | |
| log_category_description | varchar(150) | YES | | NULL | |
| log_to_console | smallint(11) | YES | | 0 | |
| log_to_file | smallint(11) | YES | | 0 | |
| log_to_gmsay | smallint(11) | YES | | 0 | |
| log_to_discord | smallint(11) | YES | | 0 | |
| discord_webhook_id | int(11) | YES | | 0 | |
+--------------------------+--------------+------+-----+---------+-------+
7 rows in set (0.003 sec)
`
```

### Quest API¶

**Lua**

```
`eq.discord_send(std::string webhook_name, std::string message);
`
```

**Perl**

```
`quest::discordsend(string webhook_name, string message);
`
```

### How to Use¶

You first need will need a webhook to send messages to your Discord Channel. Assuming you are an admin of a Discord and/or ability to make Webhook integrations. You can follow this Discord guide https://support.discord.com/hc/en-us/articles/228383668-Intro-to-Webhooks

Once you have the webhook you can install it in your `discord_webhooks` table like so. You will want to give you webhook a name if you want to later call it by the quest api

```
`MariaDB [peq]> select * from discord_webhooks;
+----+--------------+--------------------------------------------------------------------------------------------------------------------------+------------+------------+
| id | webhook_name | webhook_url | created_at | deleted_at |
+----+--------------+--------------------------------------------------------------------------------------------------------------------------+------------+------------+
| 1 | test | https://discord.com/api/webhooks/971964565959114793/xxx-xxx | NULL | NULL |
| 2 | quest_api | https://discord.com/api/webhooks/971964720372396062/xxx-xxx | NULL | NULL |
+----+--------------+--------------------------------------------------------------------------------------------------------------------------+------------+------------+
2 rows in set (0.001 sec)
`
```

Once you have a webhook created, you can use it in either a Quest API method or hook it into any of your logging categories per normal.

For example, you can see I have logging categories setup just to test the integration

```
`MariaDB [peq]> select log_category_id, log_category_description, log_to_discord, discord_webhook_id from logsys_categories where discord_webhook_id > 0;
+-----------------+--------------------------+----------------+--------------------+
| log_category_id | log_category_description | log_to_discord | discord_webhook_id |
+-----------------+--------------------------+----------------+--------------------+
| 36 | MySQL Query | 1 | 1 |
| 53 | Info | 1 | 1 |
+-----------------+--------------------------+----------------+--------------------+
2 rows in set (0.002 sec)
`
```

And then in my test channel you can see both Info and MySQL messages being broadcasted

---

## Logging Categories

*Source: server/logging-system/logging-categories/index.html*

# Logging Categories¶

Logging categories have their settings stored in the logsys_categories table, but the categories are defined in common/eqemu_logsys.h

Info

The default settings for the "log-to" categories (Console, File, GM Say) are listed below. You can modify these values for your own server in your `logsys_categories` table.
 The last column in this table (`discord_webhook_id`) will output to that webhook `id` in the `discord_webhooks` table.

| 

ID 
| Description 
| Console 
| File 
| GMSay 
| WebhookID 
| Notes 

| 1 
| AA 
| 0 
| 0 
| 0 
| 0 
| Use of AA actions (IE activated, cast) 

| 2 
| AI 
| 0 
| 0 
| 0 
| 0 
| Mob aggro, prox and range 

| 3 
| Aggro 
| 0 
| 0 
| 0 
| 0 
| Mob aggro, prox and range 

| 4 
| Attack 
| 0 
| 0 
| 0 
| 0 
| Currently only shows aggro count on mob death 

| 6 
| Combat 
| 0 
| 0 
| 0 
| 0 
| Combat attacks/misses/damage (IE weapon, base, thrown) 

| 7 
| Commands 
| 0 
| 0 
| 0 
| 0 
| GM and Bot Command loading and usage details 

| 8 
| Crash 
| 1 
| 1 
| 0 
| 0 
| Stacktrace, exceptions, timestamp 

| 9 
| Debug 
| 0 
| 0 
| 0 
| 0 
| Logs failures and errors (IE loading assets, login) and other miscellaneous details 

| 10 
| Doors 
| 0 
| 0 
| 0 
| 0 
| Use of doors (IE click, open, trigger) 

| 11 
| Error 
| 1 
| 0 
| 0 
| 0 
| Logs failures and errors (IE loading assets, DB connection) 

| 12 
| Guilds 
| 0 
| 0 
| 0 
| 0 
| Guild activities (IE update MOTD, DB queries) 

| 13 
| Inventory 
| 0 
| 0 
| 0 
| 0 
| Activities with inventory (IE items, slots, shared inventory) 

| 14 
| Launcher 
| 0 
| 0 
| 0 
| 0 
| World / Zone launch requests 

| 15 
| Netcode 
| 0 
| 0 
| 0 
| 0 
| Logs opcode issues (IE login, world connection) 

| 17 
| Object 
| 0 
| 0 
| 0 
| 0 
| Logs opcode details and issues (IE login, world connection) 

| 18 
| Pathing 
| 0 
| 0 
| 0 
| 0 
| Pathing waypoint logging (IE arrive, pause) 

| 20 
| Quests 
| 0 
| 0 
| 0 
| 0 
| Outputs quest errors to log 

| 21 
| Rules 
| 0 
| 0 
| 0 
| 0 
| Logs the rule system (IE load rules) 

| 22 
| Skills 
| 0 
| 0 
| 0 
| 0 
| Logs skill messages (IE failed combine) 

| 23 
| Spawns 
| 0 
| 0 
| 0 
| 0 
| All about spawns (IE ground, spawn2, conditions) 

| 24 
| Spells 
| 0 
| 0 
| 0 
| 0 
| All about spells (IE stacking checks, spell lands, failures, etc) 

| 27 
| Tasks 
| 0 
| 0 
| 0 
| 0 
| Task information 

| 28 
| Tradeskills 
| 0 
| 0 
| 0 
| 0 
| Tradeskill information (success, failure, modifiers) 

| 29 
| Trading 
| 0 
| 0 
| 0 
| 0 
| Trader info (bazaar, barter) 

| 30 
| Tribute 
| 0 
| 0 
| 0 
| 0 
| Tribute logging 

| 35 
| QueryErr 
| 1 
| 0 
| 0 
| 0 
| MySQL query errors 

| 36 
| Query 
| 0 
| 0 
| 0 
| 0 
| MySQL query details 

| 37 
| Mercenaries 
| 0 
| 0 
| 0 
| 0 
| unused 

| 38 
| Quest Debug 
| 0 
| 0 
| 0 
| 0 
| unused 

| 44 
| Client Login 
| 0 
| 0 
| 0 
| 0 
| Client login/disconnect/kick 

| 46 
| HP Update 
| 0 
| 0 
| 0 
| 0 
| Hitpoint changes 

| 47 
| FixZ 
| 0 
| 0 
| 0 
| 0 
| Z-axis failures and fixes 

| 48 
| Food 
| 0 
| 0 
| 0 
| 0 
| Food/Drink logging 

| 49 
| Traps 
| 0 
| 0 
| 0 
| 0 
| Trap details 

| 50 
| NPC Roam Box 
| 0 
| 0 
| 0 
| 0 
| Roambox info and failures for NPCs 

| 51 
| NPC Scaling 
| 0 
| 0 
| 1 
| 0 
| Scaling info for NPCs 

| 52 
| MobAppearance 
| 0 
| 0 
| 0 
| 0 
| Appearance changes for NPCs 

| 53 
| Info 
| 1 
| 0 
| 0 
| 0 
| Miscellanenous info (data loading, logging info, reloads, connection info) 

| 54 
| Warning 
| 1 
| 0 
| 0 
| 0 
| Warning messages (bootup info, connection conflicts and details) 

| 59 
| AI Scan 
| 0 
| 0 
| 0 
| 0 
| Close Mob entity list scanning 

| 60 
| AI Yell 
| 0 
| 0 
| 0 
| 0 
| Mob yell for help details (social aggro) 

| 61 
| AI CastBeneficial 
| 0 
| 0 
| 0 
| 0 
| NPC buffing of friends 

| 62 
| AOE Cast 
| 0 
| 0 
| 0 
| 0 
| AOE spell details via closemob list 

| 63 
| Entity Management 
| 0 
| 0 
| 0 
| 0 
| Entity List adds/removes 

| 64 
| Flee 
| 0 
| 0 
| 0 
| 0 
| Mob flee details 

| 65 
| Aura 
| 0 
| 0 
| 0 
| 0 
| Aura add/remove info 

| 66 
| HotReload 
| 1 
| 0 
| 1 
| 0 
| Quest hot reload info (reload on the fly) 

| 67 
| Merchants 
| 0 
| 0 
| 0 
| 0 
| Merchant loading / pricing info 

| 68 
| ZonePoints 
| 0 
| 0 
| 0 
| 0 
| Loading details for zone points and virtual zone points 

| 69 
| Loot 
| 0 
| 0 
| 1 
| 0 
| Lootdrop/loottable loading details and errors 

| 70 
| Expeditions 
| 0 
| 0 
| 0 
| 0 
| Expedition details (invite, add, remove, create, accept) 

| 71 
| DynamicZones 
| 0 
| 0 
| 0 
| 0 
| Dynamic Zone details (errors, create, load, saves, updates, etc) 

| 72 
| Scheduler 
| 1 
| 0 
| 0 
| 0 
| Scheduled event scans, loading, unloads (via Server Events Scheduler) 

| 73 
| Cheat 
| 1 
| 0 
| 0 
| 0 
| Anticheat logging 

| 74 
| ClientList 
| 0 
| 0 
| 0 
| 0 
| Clientlist updates 

| 75 
| DialogueWindow 
| 0 
| 0 
| 0 
| 0 
| DiaWind popup info 

| 76 
| HTTP 
| 1 
| 0 
| 1 
| 0 
| Sidecar and SQL sourcing info 

| 77 
| Saylink 
| 0 
| 0 
| 0 
| 0 
| Saylink loading and caching 

| 78 
| ChecksumVer 
| 1 
| 0 
| 1 
| 0 
| Checksum validation checks 

| 79 
| CombatRecord 
| 0 
| 0 
| 1 
| 0 
| Combat info (engage, attacks, damage, duration, etc.) 

| 80 
| Hate 
| 0 
| 0 
| 0 
| 0 
| Hatelist scanning and updates 

| 81 
| Discord 
| 1 
| 0 
| 0 
| 0 
| Discord webhook logging 

| 82 
| Faction 
| 0 
| 0 
| 0 
| 0 
| Faction loading, reloading and errors 

| 83 
| Packet S->C 
| 0 
| 0 
| 0 
| 0 
| Packet logging from server to client 

| 84 
| Packet C->S 
| 0 
| 0 
| 0 
| 0 
| Packet logging from client to server 

| 85 
| Packet S->S 
| 0 
| 0 
| 0 
| 0 
| Packet logging between the server 

| 86 
| Bugs 
| 0 
| 0 
| 0 
| 0 
| Bug report create logging 

| 87 
| QuestErrors 
| 1 
| 0 
| 1 
| 0 
| Quest error logging (Lua/Perl) 

| 88 
| PlayerEvents 
| 0 
| 0 
| 0 
| 0 
| Player Event logging (loot, kills, death, merchant, speech, etc) 

| 89 
| DataBuckets 
| 0 
| 0 
| 0 
| 0 
| DataBucket info (deletes, creates, loading, reloading, errors, updates) 

| 90 
| Zoning 
| 0 
| 0 
| 0 
| 0 
| Player zoning info 

| 91 
| EqTime 
| 1 
| 0 
| 1 
| 0 
| In-game time updates and failures 

| 92 
| Corpses 
| 0 
| 0 
| 0 
| 0 
| Corpse logging (buries, rezzes, moves, loading, failures) 

| 93 
| XTargets 
| 0 
| 0 
| 0 
| 0 
| Add/Remove updates for Extended Targets 

| 94 
| EvolveItem 
| 0 
| 0 
| 0 
| 0 
| Evolving Item logging 

| 95 
| PositionUpdate 
| 0 
| 0 
| 0 
| 0 
| NPC position updates sent to clients 

| 96 
| KSM 
| 0 
| 0 
| 0 
| 0 
| KSM info for Linux (memory sharing) 

| 97 
| Bot Settings 
| 0 
| 0 
| 0 
| 0 
| Saving/Loading of bot settings 

| 98 
| Bot Spell Checks 
| 0 
| 0 
| 0 
| 0 
| Spell checks for bots (casting checks, failures, etc) 

| 99 
| Bot Spell Type Checks 
| 0 
| 0 
| 0 
| 0 
| Spell type checks for bots (spell list verification) 

| 100 
| NpcHandin 
| 1 
| 0 
| 1 
| 0 
| NPC Hand-In logging (NPC trading/quest hand-ins) 

| 101 
| ZoneState 
| 0 
| 0 
| 0 
| 0 
| Zone State logging (saving and restoring of the state of a zone on shutdown) 

| 102 
| Net Server <-> Client 
| 0 
| 0 
| 0 
| 0 
| Packet logging between the server and client 

| 103 
| Net TCP 
| 0 
| 0 
| 0 
| 0 
| Server packet logging

---

## Logging System

*Source: server/logging-system/logging-system/index.html*

# Logging System¶

Info

EQEmu used to have many different logging systems in its past. 

They all were configured differently, all had different configuration formats. 

In 2015 - a much needed massive overhaul to our logging was made and it has been one of the most valuable things to our project to date.

## Features¶

- Logging levels (General, Moderate, Detail)

- Hot-Reload of log settings

- In game, real time server logs

- Categories (Spells, Merchants, Loot etc.)

## Output Formats¶

- Console

- File

- In game (gmsay)

Can easily be extended to be implemented with other output sinks

## Debug Levels¶

| 

**Level** 
| 
| **Description** 

| General 
| 1 
| Low-Level general debugging, useful info on single line 

| Moderate 
| 2 
| Informational based - used in functions 

| Detail 
| 3 
| Use this for extreme detail in logging, usually in extreme debugging in the stack or interprocess communication 

Debug levels are PER category, so if you wanted to set for example, level 3 debugging enabled to gmsay (In Game) but only 1 to your console, you put respectively 1 in your console field and 3 in gmsay for whatever category it is your enable

## Settings¶

All settings are managed in **logsys_categories** database table

When a process boots up, such as **zone/world/ucs/queryserv/etc**. These settings will load and whatever applies to the server category wise is what it will use as **rules** to understand where to send output, as well as what level of information (high or low) to display

Info

Please note that **log_to_gmsay** is only available for zone-level debugging

As of 2021 it is available in world as well if you have rule **WorldGMSayLogging** enabled (enabled by default)

## In-Game Commands¶

| 

**Command** 
| **Description** 

| #logs 
| Displays usage menu 

| #logs reload 
| Reload all settings in world and all zone processes with what is defined in the database 

| #logs list 
| Shows current log settings and categories loaded into the current process' memory 

| #logs set [console 
| file 

```
`#logs set [gmsay|file|console] [category_id] [log_level]
`
```

## File Logs¶

- All **zone logs** go underneath a respective **logs/zone/**

- All zones, once booted up, will have a name that actually means something to a server administrator:

nexus_version_0_inst_id_0_port_7000_20084.log

- nexus_version_0_inst_id_0_port_7000_24356.log

- zone_20084.log - A zone that has been booted up as a dynamic, but not assigned to any logical zone yet

- Crash Logs will make their way underneath `logs/crash`

- All other process logs go to the top level of logs, this may change

- Naming Convention:

- Unless a zone is using zone properties for the file name, most processes will look like the following convention

process_name_process_id.log

## Logging Output Examples¶

### In Game Messages (gmsay)¶

### Windows Console of Zone¶

### Linux Console¶

---

## Player Event Logging

*Source: server/logging-system/player-event-logging/index.html*

# Player Event Logging¶

For the longest time, player audit logging or event logging of any type has been sub-par. It is difficult to triage when a player lost an item because we have no adequate out of the box logging. It is difficult to know get visibility into player activity to understand how things are being used or misused

## Goals¶

- As a server operator, be able to see a lineage of events of a player

- As a server operator, be able to see events by type

- As a server operator, be able to see events by zone

- As a server operator, be able to see record event specific data in a non-structured way but be able to query it in a flexible semi-structured way

- Have player events be recorded in a highly robust, high performing, low overhead way

- Have player events be turned on and off by type

- Have player events automatically truncate by type so data retention can be tweaked and tuned to the server operators unique needs

- Have the player event creation pipeline be easy to extend and adapt from a server operator perspective

- Be able to process events within World or within Queryserv as a dedicated events processor on a dedicated server if the operator so chooses

## Features¶

- Roughly 40 implemented player events

- One single event table, which heavily simplifies creating events and querying events in a lineage along with other events. Querying the JSON event data can get interesting when running reporting but it is all flexible enough.

- Highly robust event pipeline where World (Default) or QueryServ can process events in batch. This allows zone processes to very minimally and lightly process event creation and the event processor can flush events at a configurable interval (Default 5s) Rule "Logging:BatchPlayerEventProcessIntervalSeconds". The event processor runs in its own dedicated thread and uses a mutex lock to interact with the queue that gets mutated between the main thread and the processing thread

- Highly performant event creation. Events do not incur overhead at the Zone level if they are not enabled

- Highly readable code. All player events are represented as `structs` which are serialized into JSON when the event reaches the database

- Discord Webhook messages unique to each event are supported and can be turned on per-event and routed to Channels of your choosing, player facing or admin facing. Consider that some events could be too noisy. Discord webhook messages are routed by Universal Chat Service (Server)

- New player events are automatically injected when they are added by server developers

- Deprecated player events are automatically removed when marked as deprecated or unimplemented

- Data retention policies. Every event is trimmed hourly at given data retention intervals based on the age of the event. Most events defaults are to be stored for a week. Configurable by the server operator.

## Deprecates¶

- The old `hackers` table is now deprecated. These are now their own `POSSIBLE_HACK` events since all of this was player contextual logging to begin with

- The old `eventlog` table is now deprecated. All events covered in here are also covered in the player event logging system and far more

## Table Schema(s)¶

player_event_logs

#### Indexes¶

```
`KEY `event_created_at` (`event_type_id`,`created_at`),
KEY `zone_id` (`zone_id`),
KEY `character_id` (`character_id`,`zone_id`) USING BTREE,
KEY `created_at` (`created_at`)
`
```

### player_event_log_settings¶

player_event_log_settings

## Currently Handled Events¶

These are the events currently supported at the time of this writing. It's very likely more will be added later on and you can find the most recent events in https://github.com/EQEmu/Server/blob/master/common/events/player_events.h

```
`1 GM Command
2 Zoning
3 AA Gain
4 AA Purchase
5 Forage Success
6 Forage Failure
7 Fish Success
8 Fish Failure
9 Item Destroy
10 Went Online
11 Went Offline
12 Level Gain
13 Level Loss
14 Loot Item
15 Merchant Purchase
16 Merchant Sell
21 Groundspawn Pickup
22 NPC Handin
23 Skill Up
24 Task Accept
25 Task Update
26 Task Complete
27 Trade
29 Say
30 Rez Accepted
31 Death
32 Combine Failure
33 Combine Success
34 Dropped Item
35 Split Money
38 Trader Purchase
39 Trader Sell
42 Discover Item
43 Possible Hack
44 Killed NPC
45 Killed Named NPC
46 Killed Raid NPC
`
```

## Credits¶

The system was designed by Akkadius and co-designed by Kinglykrab. Aead and Kinglykrab also helped with the implementation of several events and many Discord formatters. Thank you both for your help <3

## Quest Hand-In Events¶

In order to capture player hand-ins, you will need special plugin capture code that is included in PEQ Quest PR https://github.com/ProjectEQ/projecteqquests/pull/1372/files

Hand-ins may need further work to capture other code paths

## Player Event Log Explorer (Spire)¶

A system like this is best served when it can be seen as to what you can do with it with the right tooling. Here is examples of key explorer features. The release of this will likely shortly trail when the server feature is released.

### Rich Data Viewing¶

Spire translates event data into viewable NPC, Item, Spell etc. cards to have contextual insight into the events and what they contain.

### Event Raw¶

Any event you can see the richly formatted event or you can inspect the raw event data

### Flexible Filtering¶

You can filter by event type, zone_id, character_id which are top level filters always available and indexed regardless of event type

### Advanced Event Data Filtering¶

You can filter by JSON event data

You can even filter by deeply nested data. For example if you're trying to search for a certain item that was traded by doing a nested wildcard search

## Discord Webhooks¶

To use Discord webhooks, you will need to make sure the event is handled to begin with in https://github.com/EQEmu/Server/blob/master/common/events/player_event_logs.cpp#L269

You will need to add a webhook to your discord_webhooks table. See Discord Logging for more information

Once you have a webhook added to your table, you can use the webhook id in the player_event_log_settings table to enable the event to be sent to Discord.

## Developer Docs¶

### Where's the Code?¶

Most of the code managing player events is located @

```
`./common/events
├── player_event_discord_formatter.cpp
├── player_event_discord_formatter.h
├── player_event_logs.cpp
├── player_event_logs.h
└── player_events.h
`
```

### How Do I Add a New Event?¶

First you need an event defined. You do that in **player_events.h** in both `EventType` and `EventName`

You'll also need a struct representing the event data that you want to exist in the database, that is also defined in **player_events.h**

It is important to implement the cereal serialization fields because that is what is used to automatically handle transporting the data from zone to world and ultimately into JSON format in the database. Much of this is handled automatically for the developer.

```
`struct SayEvent {
 std::string message;
 std::string target;

 // cereal
 template<class Archive>
 void serialize(Archive &ar)
 {
 ar(
 CEREAL_NVP(message),
 CEREAL_NVP(target)
 );
 }
};
`
```

You will also need to find the place in the code that you would like to record the event. There are two convenient macros that wrap a lot of other logic to keep things performant

```
`RecordPlayerEventLog(event_type, event_data) // if client object is implied
RecordPlayerEventLogWithClient(c, event_type, event_data) // if you need to pass in the client object
`
```

For the message to properly show up in Discord, it will need a proper formatter to format the event data in a visually pleasing way.

Implement a formatter in **./common/player_event_discord_formatter.cpp** that looks similar to

```
`std::string PlayerEventDiscordFormatter::FormatDiscoverItemEvent( 
 const PlayerEvent::PlayerEventContainer &c, 
 const PlayerEvent::DiscoverItemEvent &e 
)
`
```

You can copy other formatter signatures fairly easy to understand what is happening. This will need to be hooked up in the formatter switch in `PlayerEventLogs::GetDiscordPayloadFromEvent` in **common/events/player_event_logs.cpp**

#### Example Diff¶

Below are two example of an event being implemented / added. These only contain what is required to add events, not format Discord messages

##### More Complex¶

```
`diff --git a/common/events/player_events.h b/common/events/player_events.h 
index af0198ab9..6c988bb41 100644 
--- a/common/events/player_events.h 
+++ b/common/events/player_events.h 
@@ -42,7 +42,7 @@ namespace PlayerEvent { 
 COMBINE_FAILURE, 
 COMBINE_SUCCESS, 
 DROPPED_ITEM, 
- SPLIT_MONEY, // unimplemented 
+ SPLIT_MONEY, 
 DZ_JOIN, // unimplemented 
 DZ_LEAVE, // unimplemented 
 TRADER_PURCHASE, // unimplemented 
@@ -574,6 +574,27 @@ namespace PlayerEvent { 
 ); 
 } 
 }; 
+ 
+ struct SplitMoneyEvent { 
+ uint32 copper; 
+ uint32 silver; 
+ uint32 gold; 
+ uint32 platinum; 
+ uint64 player_money_balance; 
+ 
+ // cereal 
+ template<class Archive> 
+ void serialize(Archive &ar) 
+ { 
+ ar( 
+ CEREAL_NVP(copper), 
+ CEREAL_NVP(silver), 
+ CEREAL_NVP(gold), 
+ CEREAL_NVP(platinum), 
+ CEREAL_NVP(player_money_balance) 
+ ); 
+ } 
+ }; 
 } 

 #endif //EQEMU_PLAYER_EVENTS_H 
diff --git a/zone/groups.cpp b/zone/groups.cpp 
index 910d5b21c..01d7c58bb 100644 
--- a/zone/groups.cpp 
+++ b/zone/groups.cpp 
@@ -26,6 +26,7 @@ 
 #include "../common/strings.h" 
 #include "worldserver.h" 
 #include "string_ids.h" 
+#include "../common/events/player_event_logs.h" 

 extern EntityList entity_list; 
 extern WorldServer worldserver; 
@@ -177,6 +178,18 @@ void Group::SplitMoney(uint32 copper, uint32 silver, uint32 gold, uint32 platinu 
 true 
 ); 

+ if (player_event_logs.IsEventEnabled(PlayerEvent::SPLIT_MONEY)) { 
+ auto e = PlayerEvent::SplitMoneyEvent{ 
+ .copper = copper_split, 
+ .silver = silver_split, 
+ .gold = gold_split, 
+ .platinum = platinum_split, 
+ .player_money_balance = members[i]->CastToClient()->GetCarriedMoney(), 
+ }; 
+ 
+ RecordPlayerEventLogWithClient(members[i]->CastToClient(), PlayerEvent::SPLIT_MONEY, e); 
+ } 
+ 
 members[i]->CastToClient()->MessageString( 
 Chat::MoneySplit, 
 YOU_RECEIVE_AS_SPLIT, 
diff --git a/zone/raids.cpp b/zone/raids.cpp 
index b27cae0e0..5fbc543c1 100644 
--- a/zone/raids.cpp 
+++ b/zone/raids.cpp 
@@ -17,6 +17,7 @@ 
 */ 

 #include "../common/strings.h" 
+#include "../common/events/player_event_logs.h" 

 #include "client.h" 
 #include "entity.h" 
@@ -814,6 +815,19 @@ void Raid::SplitMoney(uint32 gid, uint32 copper, uint32 silver, uint32 gold, uin 
 true 
 ); 

+ if (player_event_logs.IsEventEnabled(PlayerEvent::SPLIT_MONEY)) { 
+ auto e = PlayerEvent::SplitMoneyEvent{ 
+ .copper = copper_split, 
+ .silver = silver_split, 
+ .gold = gold_split, 
+ .platinum = platinum_split, 
+ .player_money_balance = members[i].member->GetCarriedMoney(), 
+ }; 
+ 
+ RecordPlayerEventLogWithClient(members[i].member, PlayerEvent::SPLIT_MONEY, e); 
+ } 
+ 
+ 
 members[i].member->MessageString( 
 Chat::MoneySplit, 
 YOU_RECEIVE_AS_SPLIT,
`
```

#### Simpler¶

```
`diff --git a/common/events/player_events.h b/common/events/player_events.h 
index d9c3a98d4..07ee5aee5 100644 
--- a/common/events/player_events.h 
+++ b/common/events/player_events.h 
@@ -17,8 +17,8 @@ namespace PlayerEvent { 
 FISH_SUCCESS, 
 FISH_FAILURE, 
 ITEM_DESTROY, 
- WENT_ONLINE, // unimplemented 
- WENT_OFFLINE, // unimplemented 
+ WENT_ONLINE, 
+ WENT_OFFLINE, 
 LEVEL_GAIN, // unimplemented 
 LEVEL_LOSS, // unimplemented 
 LOOT_ITEM, // unimplemented 
diff --git a/zone/client_packet.cpp b/zone/client_packet.cpp 
index ae75922c5..fbf7eca3b 100644 
--- a/zone/client_packet.cpp 
+++ b/zone/client_packet.cpp 
@@ -784,6 +784,7 @@ void Client::CompleteConnect() 
 /* This sub event is for if a player logs in for the first time since entering world. */ 
 if (firstlogon == 1) { 
 parse->EventPlayer(EVENT_CONNECT, this, "", 0); 
+ RecordPlayerEventLog(PlayerEvent::WENT_ONLINE, PlayerEvent::EmptyEvent{}); 
 /* QS: PlayerLogConnectDisconnect */ 
 if (RuleB(QueryServ, PlayerLogConnectDisconnect)) { 
 std::string event_desc = StringFormat("Connect :: Logged into zoneid:%i instid:%i", GetZoneID(), GetInstanceID()); 
diff --git a/zone/client_process.cpp b/zone/client_process.cpp 
index c6ff4e02f..2c5df69e8 100644 
--- a/zone/client_process.cpp 
+++ b/zone/client_process.cpp 
@@ -55,6 +55,7 @@ 
 #include "zone.h" 
 #include "zonedb.h" 
 #include "../common/zone_store.h" 
+#include "../common/events/player_event_logs.h" 

 extern QueryServ* QServ; 
 extern Zone* zone; 
@@ -184,6 +185,7 @@ bool Client::Process() { 
 SetDynamicZoneMemberStatus(DynamicZoneMemberStatus::Offline); 

 parse->EventPlayer(EVENT_DISCONNECT, this, "", 0); 
+ RecordPlayerEventLog(PlayerEvent::WENT_OFFLINE, PlayerEvent::EmptyEvent{}); 

 return false; //delete client 
 } 
@@ -693,6 +695,7 @@ void Client::OnDisconnect(bool hard_disconnect) { 
 MyRaid->MemberZoned(this); 

 parse->EventPlayer(EVENT_DISCONNECT, this, "", 0); 
+ RecordPlayerEventLog(PlayerEvent::WENT_OFFLINE, PlayerEvent::EmptyEvent{}); 

 /* QS: PlayerLogConnectDisconnect */ 
 if (RuleB(QueryServ, PlayerLogConnectDisconnect)){
`
```

### Default Event Settings¶

Default event settings are defined in `PlayerEventLogs::SetSettingsDefaults`

```
`void PlayerEventLogs::SetSettingsDefaults() 
{ 
 m_settings[PlayerEvent::GM_COMMAND].event_enabled = 1; 
 m_settings[PlayerEvent::ZONING].event_enabled = 1; 
 m_settings[PlayerEvent::AA_GAIN].event_enabled = 1; 
 m_settings[PlayerEvent::AA_PURCHASE].event_enabled = 1;
 // ...truncated
`
```

This determines if the event is enabled by default and sets the defaults before it gets injected into the operators database automatically on next code update.

---

## Auto Create Login Accounts

*Source: server/login-server/auto-create-login-accounts/index.html*

# Auto Create Login Accounts¶

**Ideal for local LAN setups**, you can enable this setting. If any login request comes in from a game client, if the account doesn't already exist, it will **auto create the account on first attempt**. Every subsequent attempt will use the **created username and password combination **

login.json snippet

```
`{
 "account": {
 // ideal for local LAN setups, if you want a login attempt to automatically create an account
 // this will automatically create the account using the username and password if it doesn't exist
 "auto_create_accounts": true
 },
}
`
```

## Resetting Account Passwords¶

When using this configuration, it's easy for friends to forget their password or even your own after a long period. For this situation you can use the CLI interface to bail yourself out of this situation

```
`./loginserver login-user:update-credentials test mynewpassword

> Executing CLI Command

[LoginServer] [Info] ChangeLoginserverUserCredentials account [test] source_loginserver [local] credentials updated!
`
```

---

## Commonly Asked Questions

*Source: server/login-server/commonly-asked-questions/index.html*

# Commonly Asked Questions¶

Question

### Can I run my own Login server with myself and my friends?¶

The answer is yes, and its fairly straightforward, you can run a local Login server or you can run a Login server publicly that acts as a **local** Login server

Question

### Is a Loginserver hard to setup?¶

No, its actually quite simple, and you found yourself in the best place for how to do so!

Question

### I had a login server setup before a long time ago? Can I migrate to the newer login server?¶

Yes you can, any login server installed prior to September 2019 is considered legacy and should use the Migrating from a Legacy Login Server Database guide to do so

Question

### Are the passwords secure? I know we used weak algorithms like MD5 and SHA1¶

Yes, we support 15+ encryption algorithms and most specifically use Scrypt, if you want to learn more you can read this link

Question

### I was using the old login.ini - is there a way to convert my old config?¶

Simply, no there is not. But setting up a new config is very simple, you can find it at Configuration

---

## Database Schema

*Source: server/login-server/database-schema/index.html*

# Database Schema¶

If you are setting up the database from scratch, you can find the latest full table dump at the below link

https://github.com/EQEmu/Server/blob/master/loginserver/login_util/login_schema.sql

If you have setup your server through an installer, chances are these tables were automatically installed and taken care of for you

## Tables¶

| 

Table 
| Description 

| login_accounts 
| Where Loginserver accounts are stored 

| login_api_tokens 
| (Optional) If using the API, where tokens are stored 

| login_server_admins 
| Where Loginserver World server admins are stored 

| login_world_servers 
| Where Worldservers are added when either registered manually or added automatically

---

## CLI Management Interface

*Source: server/login-server/login-server-cli-management-interface/index.html*

# CLI Management Interface¶

In the latest overhaul of the login server, an enhanced command-line management interface was introduced to easily interface with basic management functionality needs. If you want to do more enhanced functionality such as integrating with the HTTP API, you can reference API Endpoints

### Help Menu¶

The login server command line help menu can be accessed by simply running the server binary from the command line with the option `--help`

```
`eqemu@dc25a75287d7:~/server$ ./loginserver --help

> EQEmulator [LoginServer] CLI Menu

login-user
 login-user:check-credentials Check user login credentials
 login-user:check-external-credentials Check user external login credentials
 login-user:create Creates Local Loginserver Account
 login-user:update-credentials Change user login credentials
web-api-token
 web-api-token:create Creates Loginserver API Token
 web-api-token:list Lists Loginserver API Tokens
world-admin
 world-admin:create Creates Loginserver World Administrator Account
`
```

### Command Example(s)¶

To see the required options and/or arguments for a command, simply type out the command to get the required context

```
`loginserver login-user:create

Command

login-user:create {username} {password}

Options
 --email=*
`
```

---

## Configuration

*Source: server/login-server/login-server-configuration/index.html*

# Configuration¶

The login server configuration file is stored in the server root and is named `login.json` below is the most recent configuration per **September 17, 2019**

Warning

**Warning** Be careful with how you configure your Login server as it some settings may not be ideal for your needs

```
`{
 "database": {
 "host": "127.0.0.1", // database host
 "port": "3306", // database port
 "db": "peq", // database name
 "user": "eqemu", // database user
 "password": "eqemu" // database password
 },
 "account": {
 // ideal for local LAN setups, if you want a login attempt to automatically create an account
 // this will automatically create the account using the username and password if it doesn't exist
 "auto_create_accounts": true
 },
 "worldservers": {
 "unregistered_allowed": true, // allows worldservers to connect to your loginserver without server admin authentication
 "reject_duplicate_servers": false // if enabled, rejects duplicate worldservers
 },
 "web_api": {
 "enabled": true, // enable/disable embedded webserver api
 "port": 6000 // the port you want the web api to serve on (recommended not to change)
 },
 "security": {
 "mode": 14, // encryption mode (dont touch) (14=scrypt)
 "allow_password_login": true, // allows users to login via password, most cases, leave this on
 "allow_token_login": true // allows token based login directly from launching game
 },
 "logging": {
 "trace": false, // For debugging general packet messaging
 "world_trace": false, // For debugging world to loginserver messaging
 "dump_packets_in": false, // for debugging inbound packets
 "dump_packets_out": false // for debugging outbound packets
 },
 "client_configuration": {
 "titanium_port": 5998, // don't change
 "titanium_opcodes": "login_opcodes.conf", // opcodes for the titanium era clients
 "sod_port": 5999, // don't change
 "sod_opcodes": "login_opcodes_sod.conf" // opcodes for sod and higher era clients
 }
}
`
```

---

## REST API

*Source: server/login-server/login-server-rest-api/index.html*

# REST API¶

The login server has an embedded web server that servers an API on port 6000 unless otherwise specified in the config.

The API is very basic in its current form but serves very simple use cases.

Warning

For security reasons, its recommended that this port is exposed behind a secure HTTP proxy as the API surface itself is not encrypted and credentials are sent over the wire. Use responsibily.

login.json

```
`{
 "web_api": {
 "enabled": true, // enable/disable embedded webserver api
 "port": 6000 // the port you want the web api to serve on (recommended not to change)
 },
}
`
```

You have the option to disable it, or change the port altogether

## API Tokens¶

The login server requires API tokens to interact with the API, they can be generated via the CLI

## Using the CLI Interface¶

```
`eqemu@dc25a75287d7:~/server$ ./loginserver web-api-token:create --write --read
`
```

The token will persist to the `login_api_tokens` table

```
`MariaDB [peq]> select * from login_api_tokens;
+----+--------------------------------------+-----------+----------+---------------------+---------------------+
| id | token | can_write | can_read | created_at | updated_at |
+----+--------------------------------------+-----------+----------+---------------------+---------------------+
| 1 | b1bb9eb7-416c-487a-bb91-aedc59e0c57d | 1 | 1 | 2019-09-17 04:23:30 | 2019-09-17 04:23:30 |
+----+--------------------------------------+-----------+----------+---------------------+---------------------+
`
```

Warning

To create read only users, simply specify **only** the --read flag when creating users

Info

As a general rule, API calls that are GET are going to require --read while **POST** HTTP calls will require **--write**

## API Endpoints¶

The login server has a small handful of endpoints which have been created, it is easy to add more as needed

## PHP Client¶

There is an example of a PHP client that interacts with this API located here

https://github.com/Akkadius/eqemu-loginserver-php-api-client

## Accounts¶

Example

BaseURL http://loginserver:6000

Header **Authorization**: Bearer <token>

POST /v1/account/createPOST /v1/accounts/credentials/validate/localPOST /v1/account/credentials/update/local

Create local loginserver account

**Request Body**

```
`{
 "username": "test",
 "password": "test",
 "email": "<optional>"
}
`
```

Responses

200400

```
`{
 "data": {
 "account_id": 1,
 },
 "message": "Account created successfully!"
}
`
```

```
`{
 "error": "Account failed to create!"
}
`
```

Validate local Loginserver account credentials

**Request Body**

```
`{
 "username": "test",
 "password": "test",
 "email": "<optional>"
}
`
```

Responses

200400

```
`{
 "data": {
 "account_id": 3,
 },
 "message": "Credentials valid!"
}
`
```

```
`{
 "error": "Credentials invalid!"
}
`
```

Update local Loginserver account credentials

**Request Body**

```
`{
 "username": "test",
 "password": "test",
}
`
```

Responses

200400

```
`{
 "message": "Loginserver account credentials updated!"
}
`
```

```
`{
 "error": "Failed to find associated loginserver account!"
}
`
```

```
`{
 "error": "Failed to update loginserver account credentials!"
}
`
```

## World Servers¶

Example

BaseURL http://loginserver:6000

Header **Authorization**: Bearer <token>

GET /v1/servers/list

Lists connected worldservers (memory)

**Result**

```
`[
 {
 "local_ip" : "127.0.0.1",
 "players_online" : 0,
 "remote_ip" : "",
 "server_list_id" : 3,
 "server_long_name" : "Akkas Docker PEQ Installer (L)",
 "server_short_name" : "Akkas Docker PEQ Installer (L)",
 "server_status" : -2,
 "zones_booted" : 0
 }
]
`
```

---

## Migrating from Legacy Login Server

*Source: server/login-server/migrating-from-legacy-login-server/index.html*

# Migrating from Legacy Login Server¶

## Migrating the Config¶

There is no straight migration path for the configuration file, you will simply have to reference the values you had in your `login.ini` and look at any that applies to the options in the new `login.json` format that is show in Configuration

## Migrating the Database¶

To migrate from a Legacy Login server database, you can use the provided `.sql` that you may find also available in the source at 

```
`loginserver/login_util/login_old_to_new_schema_convert.sql
`
```

Info

Take note of the old table names in the script, if you used different table names (Because they were previously configurable) you will need to change the table names to reflect

### Migration SQL¶

login_old_to_new_schema_convert.sql

```
`-- Because the old / legacy schema was mostly inconsistent with naming and overall data structure, we have
-- migrated to a schema that follows our modern conventions and meanwhile fixes quite a few bugs that
-- were present as well

-- Login Accounts

INSERT INTO
 login_accounts (
 id,
 account_name,
 account_password,
 account_email,
 source_loginserver,
 last_ip_address,
 last_login_date,
 created_at
 )
SELECT
 LoginServerID,
 AccountName,
 AccountPassword,
 AccountEmail,
 'local',
 LastIPAddress,
 LastLoginDate,
 AccountCreateDate
FROM
 tblLoginServerAccounts;

-- Server Admins

INSERT INTO
 login_server_admins (
 id,
 account_name,
 account_password,
 first_name,
 last_name,
 email,
 registration_date,
 registration_ip_address
 )
SELECT
 ServerAdminID,
 AccountName,
 AccountPassword,
 FirstName,
 LastName,
 Email,
 RegistrationDate,
 RegistrationIPAddr
FROM
 tblServerAdminRegistration;

-- World Servers

INSERT INTO
 login_world_servers (
 id,
 long_name,
 short_name,
 tag_description,
 login_server_list_type_id,
 last_login_date,
 last_ip_address,
 login_server_admin_id,
 is_server_trusted,
 note
 )
SELECT
 `ServerID`,
 `ServerLongName`,
 `ServerShortName`,
 `ServerTagDescription`,
 `ServerListTypeID`,
 `ServerLastLoginDate`,
 `ServerLastIPAddr`,
 `ServerAdminID`,
 `ServerTrusted`,
 `Note`
FROM
 tblWorldServerRegistration;
`
```

---

## World Registration

*Source: server/login-server/world-registration/index.html*

# World Registration¶

One of the options in the configuration is to be able to set whether or not world server registration is required. Here were are going to explain the differences in requirements

## Main Referenced Configuration Options¶

The below snippet is part of the current options that drive registration functionality

```
` { 
 "worldservers": {
 "unregistered_allowed": true, // allows worldservers to connect to your loginserver without server admin authentication
 "reject_duplicate_servers": false // if enabled, rejects duplicate worldservers
 }
}
`
```

## Unregistered World Servers¶

Most world servers that blindly target a login server are considered **unregistered world servers **these servers are just fine and can operate simply; but whether or not you want to **register** a server to an admin depends upon your needs. Most people in LAN environments will not care about registration and just want to get into the game as quick as possible!

## Registered World Servers¶

Whether or not you require servers to be registered is up to you and configurable in your config file. However, **most** servers allow **unregistered servers** but allow servers to be **registered** so that those servers have an **authentic owner** and can be promoted to a higher **status**

If a server is registered, the login sever will expect that the world server entry has an associated world admin in the `login_world_servers` table.** If you don't have a server admin account created, you can do so using the CLI**

```
`./loginserver world-admin:create serveradmin serverpassword [email protected]

> Executing CLI Command

[LoginServer] [Info] Attempting to create world admin account | username [serveradmin] encryption algorithm [SCrypt] (14)
[LoginServer] [Info] Account creation success for user [serveradmin] encryption algorithm [SCrypt] (14) new admin id [1]
`
```

#### Result¶

```
`MariaDB [peq]> select * from login_server_admins limit 10;
+----+--------------+-------------------------------------------------------------------------------------------------------+------------+-----------+---------------+---------------------+-------------------------+
| id | account_name | account_password | first_name | last_name | email | registration_date | registration_ip_address |
+----+--------------+-------------------------------------------------------------------------------------------------------+------------+-----------+---------------+---------------------+-------------------------+
| 1 | serveradmin | $7$C6..../....1dvF3Cx9hdtzT2T6kBsAr4sq.53rWo1zjNr2BXDxUx.$fBFmF0JiiHya2f0chj17hJFuzTNLzcrTkVxKpeTmgo3 | | | [email protected] | 2019-09-17 07:19:21 | |
+----+--------------+-------------------------------------------------------------------------------------------------------+------------+-----------+---------------+---------------------+-------------------------+
1 row in set (0.00 sec)
`
```

Now we have server admin **1** 

If you have had a server try to login already, it should create a world server entry that is unregistered

```
`[LoginServer] [Info] Server [Akkas Docker PEQ Installer (L)] [peqtest] did not login but unregistered servers are allowed
`
```

We would see an entry as follows

```
`MariaDB [peq]> select * from login_world_servers;
+----+--------------------------------+------------+-----------------+---------------------------+---------------------+-----------------+-----------------------+-------------------+------+
| id | long_name | short_name | tag_description | login_server_list_type_id | last_login_date | last_ip_address | login_server_admin_id | is_server_trusted | note |
+----+--------------------------------+------------+-----------------+---------------------------+---------------------+-----------------+-----------------------+-------------------+------+
| 1 | Akkas Docker PEQ Installer (L) | peqtest | | 3 | 2019-09-17 07:09:18 | | 0 | 0 | NULL |
+----+--------------------------------+------------+-----------------+---------------------------+---------------------+-----------------+-----------------------+-------------------+------+
1 row in set (0.00 sec)
`
```

The main thing here is that we need to make sure the `login_server_admin_id` column is set to the `id` of the server owner. As of this writing there is no CLI call or API call to perform these actions and sounds like a great PR for someone to make in the future

Once the `login_server_admin_id` is set to an appropriate server admin owner, as long as the respective authenticating world server tries to connect the next time with a configured `account` and `password` in their `loginserver` block of their `eqemu_config.json` they should authenticate against this table properly and will be authenticated as a registered server

---

## World Servers with Same Names

*Source: server/login-server/world-servers-with-same-names/index.html*

# World Servers with Same Names¶

There may be a case where you have servers with the same exact short name, long name may be slightly different. These servers are often split between **Production** and **Staging (Testing)** servers. Before this was not a possible configuration.

Currently as of this writing, you CAN have both servers live in harmony as long as one of the servers is **registered** and the other is **unregistered**. You can not have servers both attempt to use the same name otherwise you'll be fighting for listings

---

## Editing Maps

*Source: server/maps/editing-maps/index.html*

# Editing Maps¶

**Tool Download**

Included in the git repository which is downloaded with all standard installs. Check your maps/tools/Map_Edit folder

**Source**

https://github.com/EQEmu/zone-utilities

#### What is Navmesh?¶

From Maps Introduction

- Navmesh is modern navigation mesh technology, we use it server side to determine shortest path to a target in NPC AI decision making processes, it's what the server uses to determine what NPC's can walk on and they will strictly adhere to this mesh when making pathing decisions. The end result is a very smooth path-making decisions

- Another explanation of Navmesh on Stack Overflow

## Example Used In Game¶

## File Structure¶

| 

File 
| Description 

| maps/base/zoneshortname.map 
| Represents the zones geometry, used to determine line of sight, out of bounds and other assets such as navmesh are built on top 

| maps/nav/zoneshortname.nav 
| Navmesh file. Navigation mesh is painted on top of the map geometry and is responsible for AI pathfinding. See this video for an explanation of navmesh in unity 

| maps/water/zoneshortname.wtr 
| Water file, contains information around water types, lava etc. 

| maps/project/zoneshortname.navprj 
| A project file for the navigation editor for loading / saving manual edits made to meshes 

## Creation Example¶

Lets walk through the process of creating a .nav file for Najena.

When you start map_edit you will be presented with this screen

You will notice that no zone is loaded and the navigation module is not yet activated.

- Navigate to the file menu and select Open(CTRL + O) and type the zone you would like to open.

In this case we open **Najena**

From here you can view the collidable geometry of the zone in grey, the non-collidable geometry of the zone in light blue and surrounded by a red wire box that represents the bounding box of the zone.

## Options Menu¶

- Quickly lets cover the options menu, navigate to File -> Options(ALT + O)

From here you see various options:

- **Render Collidable Mesh** A checkbox that controls whether the grey geometry is drawn.

- **Render Non-Collidable Mesh** A checkbox that controls whether the light blue geometry is drawn.

- **Render Bounding Box** A checkbox that controls whether the bounding box is drawn.

- **Enable Backface Culling** A checkbox that controls whether polygons facing away from the camera are drawn. (See example below)

- **Bounding Box** Six sliders that let you control the bounding box used by this zone, you can CTRL+Click on the values to be able to manually type in a value.

- **Render Volumes** A checkbox that controls whether EQG volumes (watermaps) are rendered (s3d volumes/watermaps are never rendered).

This is a visual example of backface culling enabled which proves useful for being able to see in zone detail for some indoor zones.

- Next we need to enable the Navigation module. Navigate to the Modules menu and select Navigation.

- Now that navigation is enabled you will see Navigation and NavMesh properties windows.

## Modes¶

The tools let you switch between three different modes of operation

- NavMesh Generation

- Connections

- Testing

Lets generate an initial NavMesh, scroll to the bottom of NavMesh Properties window and click on Build All NavMesh Tiles.

After a time a mesh will be generated and will show as blue overlay on the geometry. This is a small graph of walkable polygons and works quite well in most places.

## Options¶

| 

Option 
| Description 

| **Cell Size** 
| The size of voxels on the xz plane for this nav mesh. The smaller this is the more detail and longer a map will take to generate. Some zones do not play nicely with very large or very small values of this and you may need to play with this if you're having trouble or seeing artifacts. Smaller values generally lead to meshes with more nodes as well. 

| **Cell Height** 
| Generally recommended that this is ½ of Cell Size but not required otherwise the same as cell size just on the y axis. 

| **Radius** 
| The agent's radius, same basic idea as height but this is how fat the agent is. 

| **Max Climb** 
| The max height the agent will be allowed to climb in one step. If the agent has to climb something larger than this then a gap will be generated. 

| **Max Slope** 
| The max slope the agent will be allowed to climb in one step. If the agent has to climb something steeper than this then a gap will be generated. 

| **Min Region Size** 
| The min size a region can be to be segmented off into its own polygon. 

| **Merged Region Size** 
| The minimum size a region needs to be before the algorithm attempt to merge a region into another. 

| **Partitioning Type** 
| The algorithm used for partitioning internally. Have never found much reason to change this from default but it causes the algorithm to generate slightly different meshes. 

| **Max Edge Length** 
| Maximum length an edge can be in the basic polygon mesh output. The bigger this is the larger polygons can be. For flat surfaces that are very large (eg ocean bottoms) this can dramatically reduce polygon count. 

| **Max Edge Error** 
| The maximum deviation an edge can have in the basic polygon mesh output. 

| **Verts per Poly** 
| Maximum verts any poly can have. Do not set above 6. Setting this to something really low would probably needlessly complicate the mesh. 

| **Sample Distance** 
| When creating the detail mesh it samples from points nearby. This is the distance to sample around a point. Generally going the smaller the number the more accurate the mesh is but also the more nodes that need to be generated. 

| **Max Sample Error** 
| Maximum error, like distance this is the maximum the error can be before the detail mesh discards a sample point. Smaller leads to more accurate but slower meshes. 

| **Tile Size** 
| The tile size of the map, the larger the tile the fewer of them that need to be generated but also the longer they need to be generated. 

- Generally you wont have to change this but something to keep note of is there is a maximum amount of nodes a tile can contain and connections (covered below) can only connect a tile either to itself or to one of its potential 8 adjacent tiles.

- So you may need to up this if you have a large portal or decrease it if you find it having difficulty creating a tile at all..|

## Fixing Navmesh Gaps¶

What we see here is a pool of water, these are common places to find gaps in older zones.

By turning off the non-collidable mesh and using the test tool we can confirm that indeed this pool cannot be pathed into because of a gap in the navmesh.

## Connections Mode¶

- You'll see a few options, what we want in this case is a bi-directional connection as these can move in either direction. We also want the area type to be "Water" as it is going into and out of a pool of water.

- Place the connection by clicking on the mesh once (for start pos) and again (for end pos)

We now have a connection that connects these two meshes together but if we try to retest it we find they still are not connected. That is because connections are only made on navmesh tile creation.

## Generation Mode¶

- Switch back to NavMesh Generation mode and Shift+Click the area around that connection we just made.

The tile for that area has just been removed from the overall mesh.

#### Re-Adding the Tile¶

- Re-add the tile by Clicking the area around the connection.

The tile has returned and if we retest it we notice that the connection now works.

#### Another Gap¶

We come to a spot where the floor is not solid because the player is intended to fall into this "trap" if they're inexperienced.

## Bi-Directional Connection Spanning¶

- Lets add a normal bi-directional connection spanning the gap so npcs at least just hop over it and don't get stuck

This would work but a player that had a npc chasing them and fell down this hole would create a massive train through a long part of the zone. Wouldn't it be nice if the npc could also jump down this hole instantly?

## Portal One-Way¶

- Lets create a set of portal one-way connections from the top sides of the mesh down into the trap

Now that the connections are created don't forget to regenerate any nav mesh tiles that the connections have landed on.

## Test the Created Jumps¶

Instead of going all through the zone instead green jumps down into the trap to chase red.

## Create Preferred Path¶

- There are some cases where pathing may be too close to world objects and you would like to setup a preferred path. The process is the same as creating connectors except you will select "Bi-Directional Prefer" area type.

We will add the connection to force pathing around the edge of the doorway.

Regenerate the navmesh and the test should now yield the desired results.

## Create Disable Volume¶

- If you want to disable pathing for a specific region, you can achieve this via volumes.

Start by opening up the volumes menu.

Shift left click to place a basic volume where you would like the general region to be.

Select the area type of "Disable NavigationMesh" then use the various sliders to adjust the size and orientation of the volume.

That is basically it, make sure to save before you exit otherwise you will lose all your work.

---

## Maps

*Source: server/maps/index.html*

# Maps¶

Maps in EQEmu are used to do many things, we have different files that are responsible for different functions. Note that these are not the maps utilized inside your client to display your location--these are the maps for the zones themselves.

## File Structure¶

- maps/base/zoneshortname.map

- maps/nav/zoneshortname.nav

- maps/water/zoneshortname.wtr

- maps/path/zoneshortname.path (Deprecated)

## Base Maps (.map)¶

- Base map files are responsible for a few core critical things

- **Line of Sight (LOS)** eg: Can this spell be casted if there is a wall or object between me and the target?

- **Calculating Best Z** The server is constantly doing Z calculations to keep NPC's on level plane, to prevent from dipping into the ground which was a much larger issue in the past

- Maps are generated via Azone

## Water Maps (.wtr)¶

- Water maps are responsible for one if not obvious, determining whether or not a client is inside water. Server side we determine different combat logic and pathing logic when a mob and/or client is in the water

- Water maps takes a point (x, y, z) and determines what type of region said point is marked as eg water, lava, normal

- Water maps are generated via Awater

## Navigation Mesh (.nav)¶

Navmesh is modern navigation mesh technology, we use it server side to determine shortest path to a target in NPC AI decision making processes, it's what the server uses to determine what NPC's can walk on and they will strictly adhere to this mesh when making pathing decisions. The end result is a very smooth path-making decisions

#### Example of this in game¶

Another explanation of Navmesh on Stack Overflow

---

## Animations

*Source: server/npc/animations/index.html*

# Animations¶

These animations are different and vary depending on the race model with which the animation packet is sent.

Can be played in game with `#doanim #`

| 

**ID** 
| **Animation** 
| **CODE** 

| 1 
| Kick 
| C01 

| 2 
| Primary Jab 
| C02 

| 3 
| 2H Swipe 
| C03 

| 4 
| 2H Jab 
| C04 

| 5 
| Primary Swipe 
| C05 

| 6 
| Secondary Swipe 
| C06 

| 7 
| Secondary Bash 
| C07 

| 8 
| Primary Upper Jab 
| C08 

| 9 
| Shoot Arrow 
| C09 

| 10 
| Swim - Primary Swipe 
| C10 

| 11 
| Round Kick 
| C11 

| 12 
| Being Hit 
| D01 

| 13 
| Bend Down - Being Hit / Chest: Take Damage 
| D02 

| 14 
| Swim - Being Hit 
| D03 

| 15 
| Swim - Drowning / Chest: Open Lid 
| D04 

| 16 
| Fall Down / Death / Chest: Crumble 
| D05 

| 17 
| Walk 
| L01 

| 18 
| Run 
| L02 

| 19 
| Jump Across 
| L03 

| 20 
| Jump 
| L04 

| 21 
| Free Falling 
| L05 

| 22 
| Crouch Walk 
| L06 

| 23 
| Climb 
| L07 

| 24 
| Crouch 
| L08 

| 25 
| Swim - Idle 
| L09 

| 26 
| Stand - Idle 01 
| O01 

| 27 
| /cheer 
| S01 

| 28 
| /cry 
| S02 

| 29 
| /wave 
| S03 

| 30 
| /rude 
| S04 

| 31 
| /yawn 
| S05 

| 32 
| Stand Still 
| P01 

| 33 
| Sit 
| P02 

| 34 
| Turn Right 
| P03 

| 35 
| Ice Strafe 
| P04 

| 36 
| Kneel 
| P05 

| 37 
| Swim - Forward 
| P06 

| 38 
| ? 
| P07 

| 39 
| Instrument - Percussion 
| T01 

| 40 
| Instrument - Strings 
| T02 

| 41 
| Instrument - Brass 
| T03 

| 42 
| Spell - Defense 
| T04 

| 43 
| Spell - General 
| T05 

| 44 
| Spell - Offense 
| T06 

| 45 
| Flying Kick 
| T07 

| 46 
| Primary/Secondary Combo Swipes 
| T08 

| 47 
| Kung Fu Jab 
| T09 

| 48 
| /nod 
| S06 

| 49 
| /amaze 
| S07 

| 50 
| /plead 
| S08 

| 51 
| /clap 
| S09 

| 52 
| /hungry 
| S10 

| 53 
| /blush 
| S11 

| 54 
| /chuckle 
| S12 

| 55 
| /cough 
| S13 

| 56 
| /duck 
| S14 

| 57 
| /puzzle 
| S15 

| 58 
| /dance 
| S16 

| 59 
| /blink 
| S17 

| 60 
| /glare 
| S18 

| 61 
| /drool 
| S19 

| 62 
| /kneel 
| S20 

| 63 
| /laugh 
| S21 

| 64 
| /point 
| S22 

| 65 
| /shrug 
| S23 

| 66 
| /ready 
| S24 

| 67 
| /salute 
| S25 

| 68 
| /shiver 
| S26 

| 69 
| /tap 
| S27 

| 70 
| /bow 
| S28 

| 71 
| Stand - Idle 02 
| P08 

| 72 
| Stand - Idle 03 
| O02 

| 73 
| Sit - Idle 01 
| O03 

| 74 
| Default 
| POS 

| 75 
| Pose 
| DRF 

| 77 
| Smile 
| 

| 84 
| Secondary Swipe 2 
| 

| 85 
| Secondary Jab 
| 

| 87 
| 2H Slit Down 
| 

| 112 
| Combat Stance 
| 

| 129 
| Head Down Shame Quick 
| 

| 136 
| Combat Stance Extra aggressive 
|

---

## Body Types

*Source: server/npc/body-types/index.html*

# Body Types¶

| 

**Body Type ID** 
| **Body Type** 

| 1 
| Normal 

| 2 
| Lycanthrope 

| 3 
| Undead 

| 4 
| Giant 

| 5 
| Construct 

| 6 
| Extra Planar 

| 7 
| Monster 

| 8 
| Undead Pet 

| 9 
| Raid Giant 

| 10 
| Raid Coldain 

| 11 
| Untargetable 

| 12 
| Vampire 

| 13 
| Atenha Ra 

| 14 
| Greater Akheva 

| 15 
| Khati Sha 

| 16 
| Seru 

| 17 
| Grieg Veneficus 

| 18 
| Draz Nurakk 

| 19 
| God 

| 20 
| Luggald 

| 21 
| Animal 

| 22 
| Insect 

| 23 
| Fire Creature 

| 24 
| Construct, Elemental, or Gargoyle 

| 25 
| Plant 

| 26 
| Dragon 

| 27 
| Summoned Creature 

| 28 
| Summoned Creature 2 

| 29 
| Dragon 2 

| 30 
| Velious Dragon 

| 31 
| Familiar 

| 32 
| Dragon 3 

| 33 
| Boxes 

| 34 
| Muramite 

| 60 
| Untargetable 2 

| 63 
| Swarm Pet 

| 64 
| Monster Summoning 

| 66 
| Inivisible Man 

| 67 
| Special

---

## Client Race Inventory

*Source: server/npc/client-race-inventory/index.html*

# Client Race Inventory¶

This work has been completed by Shendare, who has endeavored to create a
complete EverQuest Client Race Inventory (external links). It is included (and
plagiarized!) here as a reference and to provide the ability for Server Operators to explore models to customize their
server.

## Download¶

You can download the program from the link below:

eqri.zip Compiled binary - EQRI.exe

## Source¶

You can download the source files from the link below:

ezri_source.zipSource Code

## How to use the program¶

!!! info Note: Only Titanium, SoF, and RoF2 (Rain of Fear, Steam Release #2) are currently supported!

Unzip EQRI.exe into your EQ directory, or create a new folder inside your EQ directory called "EQRI", and unzip the
program into that. Technically, it can be unzipped to and run from anywhere, with the following caveats:

If you decided to unzip it outside of your EQ directory, you'll need to create a EQRI.ini file in the folder EQRI.exe is
in, telling it where to find your EQ installation, as follows:

As a **relative path**, such as from the EQRI folder inside your EverQuest directory:

`EQPath=..`

Or as a **full path** to your EQ installation, such as:

`EQPath=C:\Program Files\Sony\EverQuest`

Then the program will know where to look for the EQ files if it can't find them in its current directory.

Either way, it's just a matter of running EQRI.exe, either with a double-click or from the command line.

After less than a minute, you'll have a fresh set of references in the EQRI folder detailing the race/model availability
as currently configured in your EQ installation (Version_EQRaces.htm and Version_EQZones.htm).

Press any key once the program is finished to exit.

You'll see the important info echoed to the console, while a very detailed log file is generated in the EQRI folder
along with the references.

The references are built completely from the EQ source files. If you make a change to a ZoneName_chr.txt file or
Resources\GlobalLoad.txt, the changes will be reflected in the results!

NOTE: The program must have write permission in the EQ directory to create the output files in the EQRI folder. In some
Windows versions and configurations, this may require you to run the program as an Administrator. Alternatively, you can
specify a different write-enabled output folder path in the EQRI.ini file as follows:

`OutPath=C:\OutputFolder`

## How it works¶

### **Preparation**¶

- Reads textual information from eqstr_us.txt and dbstr_us.txt for reference later

- Reads eqgame.exe's hard-coded list of race/gender model codes by parsing the appropriate block of its machine code

- Reads eqgame.exe's hard-coded list of zones and their associated information fields (nick, name, expansion, minimum
 level, etc.) similarly

### **Model Availability Loading**¶

- Uses a hard-coded list of Luclin-enabled models (global5_chr[2], frog_mount_chr, and globalXXX_chr[2] for playable
 races)

- Parses Resources\GlobalLoad.txt for remaining global model sources

- Using the Zone list, parses all ZoneNick_chr[2].s3d files for zone-local models

- Using the Zone list, parses all ZoneNick_chr.txt files for zone models imported from EQGs, S3Ds, and other zones

- Looks for any race/gender models that aren't being referenced in a .S3D or ZoneNick_chr.txt file ("orphan models"),
 and looks for a ModelCode_chr.s3d or ModelCode.eqg file for it

### **Model Information Loading**¶

For every race/gender model it comes across:

- Logs the source file it came from and the zone it's available in

- Parses an S3D file's inner .WLD file to log each model's Texture and Head (AKA HelmTexture) variations

Note: S3D/WLD parsing is monumentally more complicated than it sounds. The WLD format is cryptic, clunky,
 ambiguous, and difficult to load consistent, reliable information from. Most of the development time on this
 program was devoted to figuring out how to interpret the WLD data. Mad props to Windcatcher for his wlddoc.pdf
 and Pascal source code, which made this possible!

- Parses EQG files and interprets Textures, Heads, and other variations based on texture filenames used

Note: I didn't find file format information for the .MOD and .MDS files that make up EQG race models.
 Fortunately, the devs were decently consistent with the filename convention for textures used in models, and I
 was able to extrapolate everything needed for Texture and Head variations from those, with a little interpreting.

### **Reporting**¶

- Races: Builds a reference HTML file of all races the client can render, listing model codes, variations, sources, and
 the zones configured to load each model

- Zones: Builds a reference HTML file of all zones the client can handle, listing names, expansion requirements, bit
 flags, minimum level to enter, and what race models are available for rendering

- Zones: Also lists all global models and sources, along with their variations and what makes them global (Luclin
 models loaded, Resources\GlobalLoad.txt, etc.)

## Example Output¶

The output from running the program is too long for GitBook to render in a reasonable time. You can view sample output
at EverQuest Race Inventory.

### Race Output¶

The example below demonstrates the output for Race 1 - Human.

# Titanium¶

## Race # 1 - Human, Plural 'Humans' (Playable)¶

**Model Codes**

- Male = **HUM**

- Female = **HUF**

- Neutral = N/A

**Model availability:**

- Via Source: globalhum_chr.s3d (Loaded with Luclin models)\

- 

Model **HUM** - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**, Hair: **00-03**, Beards: **00-05**\

**All Zones** (**Global**)

- Via Source: globalhuf_chr.s3d (Loaded with Luclin models)\

- 

Model **HUF** - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**, Hair: **00-03**\

- 

**All Zones** (**Global**)

- Via Source: global_chr.s3d (Loaded via GlobalLoad.txt)\

- Model **HUM** - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**\

- 

Model **HUF** - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**\

- 

**All Zones** (**Global**)

# SOF¶

## Race # 1 - Human, Plural 'Humans' (Playable)¶

**Character Creation Description:**

The strength of the Human race lies in its diversity of tought, belief, and profession; though they tend be weaker than
many other races. They have no particular specialty with the sword or arcane magic. While that is true, Humans are
cunning and possess great ingenuity, which gives them an advantage. The Human mind is sharp enough to adapt to nearly
all forms of study and this gives them a great range of options when choosing a profession.

**Model Codes:**

- Male = **HUM**

- Female = **HUF**

- Neutral = N/A

**Model availability:**

- Via Source: globalhum_chr.s3d (Loaded with Luclin models)\

- 

Model **HUM** - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**, Hair: **00-03**, Beards: **00-05**\

**All Zones** (**Global**)

- Via Source: globalhuf_chr.s3d (Loaded with Luclin models)\

- 

Model **HUF** - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**, Hair: **00-03**\

- 

**All Zones** (**Global**)

- Via Source: global_chr.s3d (Loaded via GlobalLoad.txt)\

- Model **HUM** - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**\

- 

Model **HUF** - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**\

- 

**All Zones** (**Global**)

# RoF2¶

## Race # 1 - Human, Plural 'Humans' (Playable)¶

**Character Creation Description:**

The strength of the Human race lies in its diversity of thought, belief, and profession; though they tend be weaker than
many other races. They have no particular specialty with the sword or arcane magic. While that is true, Humans are
cunning and possess great ingenuity, which gives them an advantage. The Human mind is sharp enough to adapt to nearly
all forms of study and this gives them a great range of options when choosing a profession.

**Model Codes:**

- Male = **HUM**

- Female = **HUF**

- Neutral = N/A

**Model availability:**

- Via Source: globalhum_chr.s3d (Loaded with Luclin models)\

- 

Model **HUM** - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**, Hair: **00-03**, Beards: **00-05**\

**All Zones** (**Global**)

- Via Source: globalhuf_chr.s3d (Loaded with Luclin models)\

- 

Model **HUF** - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**, Hair: **00-03**\

- 

**All Zones** (**Global**)

- Via Source: global_chr.s3d (Loaded via GlobalLoad.txt)\

- Model **HUM** - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**\

- 

Model **HUF** - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**\

- 

**All Zones** (**Global**)

### Zone Output¶

The example below demonstrates the output for zone 0 - Globals:

# Titanium¶

## Globally Available Race Models¶

- **Source:** global7_chr.s3d (Loaded when Luclin models disabled)

**KEF** - Vah Shir Female (Race 130, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **KEM** - Vah Shir Male (Race 130, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **Source:** globalhum_chr.s3d (Loaded with Luclin models)

**HUM** - Human Male (Race 1, Gender 0) - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**, Beards: **00-05**

- **Source:** globalhuf_chr.s3d (Loaded with Luclin models)

**HUF** - Human Female (Race 1, Gender 1) - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**,
 Hair: **00-03**

- **Source:** globalbam_chr.s3d (Loaded with Luclin models)

**BAM** - Barbarian Male (Race 2, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**, Beards: **00-05**, Tattoo: **00-08**

- **Source:** globalbaf_chr.s3d (Loaded with Luclin models)

**BAF** - Barbarian Female (Race 2, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**, Tattoo: **00-08**

- **Source:** globalerm_chr.s3d (Loaded with Luclin models)

**ERM** - Erudite Male (Race 3, Gender 0) - Textures: **00-03, 10-16**, Heads: **00-04**, Faces: **00-07**,
 Hair: **00-05**, Beards: **00-05**

- **Source:** globalerf_chr.s3d (Loaded with Luclin models)

**ERF** - Erudite Female (Race 3, Gender 1) - Textures: **00-03, 10-16**, Heads: **00-04**, Faces: **00-07**,
 Hair: **00-08**

- **Source:** globalelm_chr.s3d (Loaded with Luclin models)

**ELM** - Wood Elf Male (Race 4, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**

- **Source:** globalelf_chr.s3d (Loaded with Luclin models)

**ELF** - Wood Elf Female (Race 4, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**

- **Source:** globalhim_chr.s3d (Loaded with Luclin models)

**HIM** - High Elf Male (Race 5, Gender 0) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-07**,
 Hair: **00-03**, Beards: **00-03**

- **Source:** globalhif_chr.s3d (Loaded with Luclin models)

**HIF** - High Elf Female (Race 5, Gender 1) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-07**,
 Hair: **00-03**

- **Source:** globaldam_chr.s3d (Loaded with Luclin models)

**DAM** - Dark Elf Male (Race 6, Gender 0) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-07**,
 Hair: **00-03**, Beards: **00-03**

- **Source:** globaldaf_chr.s3d (Loaded with Luclin models)

**DAF** - Dark Elf Female (Race 6, Gender 1) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-07**,
 Hair: **00-03**

- **Source:** globalham_chr.s3d (Loaded with Luclin models)

**HAM** - Half Elf Male (Race 7, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**, Beards: **00-03**

- **Source:** globalhaf_chr.s3d (Loaded with Luclin models)

**HAF** - Half Elf Female (Race 7, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**

- **Source:** globaldwm_chr.s3d (Loaded with Luclin models)

**DWM** - Dwarf Male (Race 8, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **00-03**
 , Beards: **00-05**

- **Source:** globaldwf_chr.s3d (Loaded with Luclin models)

**DWF** - Dwarf Female (Race 8, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**, Beards: **00 01**

- **Source:** globaltrm_chr.s3d (Loaded with Luclin models)

**TRM** - Troll Male (Race 9, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **Source:** globaltrf_chr.s3d (Loaded with Luclin models)

**TRF** - Troll Female (Race 9, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**

- **Source:** globalogm_chr.s3d (Loaded with Luclin models)

**OGM** - Ogre Male (Race 10, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **Source:** globalogf_chr.s3d (Loaded with Luclin models)

**OGF** - Ogre Female (Race 10, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**

- **Source:** globalhom_chr.s3d (Loaded with Luclin models)

**HOM** - Halfling Male (Race 11, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**, Beards: **00-05**

- **Source:** globalhof_chr.s3d (Loaded with Luclin models)

**HOF** - Halfling Female (Race 11, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**

- **Source:** globalgnm_chr.s3d (Loaded with Luclin models)

**GNM** - Gnome Male (Race 12, Gender 0) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-07**,
 Hair: **00-03**, Beards: **00-05**

- **Source:** globalgnf_chr.s3d (Loaded with Luclin models)

**GNF** - Gnome Female (Race 12, Gender 1) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-07**,
 Hair: **00-03**

- **Source:** globalikm_chr.s3d (Loaded with Luclin models)

**IKM** - Iksar Male (Race 128, Gender 0) - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**

- **Source:** globalikf_chr.s3d (Loaded with Luclin models)

**IKF** - Iksar Female (Race 128, Gender 1) - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**

- **Source:** globalkem_chr.s3d (Loaded with Luclin models)

**KEM** - Vah Shir Male (Race 130, Gender 0) - Textures: **00-03, 50**, Heads: **00-03**, Faces: **00-07**

- **Source:** globalkef_chr.s3d (Loaded with Luclin models)

**KEF** - Vah Shir Female (Race 130, Gender 1) - Textures: **00-03, 50**, Heads: **00-03**, Faces: **00-07**

- **Source:** global5_chr.s3d (Loaded with Luclin models)

**AEL** - Air Elemental (Race 210, Gender 2)

- **EEL** - Earth Elemental (Race 209, Gender 2)

- **FEL** - Fire Elemental (Race 212, Gender 2)

- **HSM** - Horse Male (Race 216, Gender 0) - Textures: **00-03**

- **WEL** - Water Elemental (Race 211, Gender 2)

- **Source:** frog_mount_chr.s3d (Loaded with Luclin models)

**HSF** - Horse Female (Race 216, Gender 1) - Textures: **00-03**

- **FMT** - Drogmore (Race 348, Gender 2) - Textures: **00-03**

- **Source:** globalfroglok_chr.s3d (Loaded via GlobalLoad.txt)

**FRO** - Froglok (Race 26, Gender 2)

- **FRG** - Froglok (Race 27, Gender 2) - Textures: **00 01**

- **Source:** globalpcfroglok_chr.s3d (Loaded via GlobalLoad.txt)

**FRF** - Froglok Female (Race 330, Gender 1) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-09**

- **FRM** - Froglok Male (Race 330, Gender 0) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-09**

- **Source:** gbn.eqg (Loaded via GlobalLoad.txt)

**GBN** - Goblin (Race 433, Gender 2) - Textures: **00-04**

- **Source:** wwf.eqg (Loaded via GlobalLoad.txt)

**WWF** - Werewolf (Race 454, Gender 2) - Textures: **00-04**

- **Source:** kbd.eqg (Loaded via GlobalLoad.txt)

**KBD** - Kobold (Race 455, Gender 2) - Textures: **00-05**, Heads: **00-05**

- **Source:** fng.eqg (Loaded via GlobalLoad.txt)

**FNG** - Sporali (Race 456, Gender 2) - Textures: **00 02 04 06 08 10**, Heads: **00 01, 03**

- **Source:** ork.eqg (Loaded via GlobalLoad.txt)

**ORK** - Orc (Race 458, Gender 2) - Textures: **00-09**, Heads: **00-09**

- **Source:** ggy.eqg (Loaded via GlobalLoad.txt)

**GGY** - Gargoyle (Race 464, Gender 2) - Textures: **00-03**

- **Source:** eve.eqg (Loaded via GlobalLoad.txt)

**EVE** - Evil Eye (Race 469, Gender 2) - Textures: **00-02**

- **Source:** mnr.eqg (Loaded via GlobalLoad.txt)

**MNR** - Minotaur (Race 470, Gender 2)

- **Source:** zmm.eqg (Loaded via GlobalLoad.txt)

**ZMM** - Zombie Male (Race 471, Gender 0)

- **Source:** fry.eqg (Loaded via GlobalLoad.txt)

**FRY** - Fairy (Race 473, Gender 2)

- **Source:** cwr.eqg (Loaded via GlobalLoad.txt)

**CWR** - Clockwork Boar (Race 472, Gender 2)

- **Source:** bas.eqg (Loaded via GlobalLoad.txt)

**BAS** - Basilisk (Race 436, Gender 2) - Textures: **00 01**

- **Source:** rap_chr.s3d (Loaded via GlobalLoad.txt)

**RAP** - Raptor (Race 163, Gender 2) - Textures: **00 01**

- **Source:** skt_chr.s3d (Loaded via GlobalLoad.txt)

**SKT** - Skeleton (Race 367, Gender 2) - Textures: **00-04**

- **Source:** global6_chr.s3d (Loaded via GlobalLoad.txt)

**ALL** - Alligator (Race 91, Gender 2) - Textures: **00 01**, Heads: **00 01**

- **DRK** - Drake (Race 89, Gender 2) - Textures: **00-03**

- **WOF** - Chokadai (Race 356, Gender 2) - Textures: **00 01**

- **SKE** - Skeleton (Race 60, Gender 2)

- **TPN** - Teleport Man (Race 240, Gender 2)

- **TIG** - Tiger (Race 63, Gender 2)

- **WOL** - Wolf (Race 42, Gender 2) - Textures: **00-03**

- **WOE** - Wolf (Race 120, Gender 2) - Textures: **00-03**

- **Source:** global4_chr.s3d (Loaded via GlobalLoad.txt)

**IKS** - Undead Iksar (Race 161, Gender 2) - Heads: **00 01**

- **SPE** - Spectre (Race 85, Gender 2)

- **BAF** - Barbarian Female (Race 2, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **BAM** - Barbarian Male (Race 2, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **IKF** - Iksar Female (Race 128, Gender 1) - Textures: **00-04, 10**, Heads: **00-03**, Faces: **00-07**

- **IKM** - Iksar Male (Race 128, Gender 0) - Textures: **00-04, 10**, Heads: **00-03**, Faces: **00-07**

- **Source:** global_chr.s3d (Loaded via GlobalLoad.txt)

**ELE** - Elemental (Race 75, Gender 2) - Textures: **00-03**, Heads: **00 01**

- **EYE** - Eye (Race 108, Gender 2) - Textures: **00-03**

- **IVM** - Invisible Man Male (Race 127, Gender 0)

- **SKE** - Skeleton (Race 60, Gender 2) - Textures: **00 01**

- **WER** - Werewolf (Race 14, Gender 2)

- **WOE** - Wolf (Race 120, Gender 2) - Textures: **00 01**

- **BOAT** - Boat (Race 141, Gender 2)

- **BAF** - Barbarian Female (Race 2, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **BAM** - Barbarian Male (Race 2, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **DAF** - Dark Elf Female (Race 6, Gender 1) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-07**

- **DAM** - Dark Elf Male (Race 6, Gender 0) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-07**

- **DWF** - Dwarf Female (Race 8, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **DWM** - Dwarf Male (Race 8, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **ERF** - Erudite Female (Race 3, Gender 1) - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**

- **ERM** - Erudite Male (Race 3, Gender 0) - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**

- **GNF** - Gnome Female (Race 12, Gender 1) - Textures: **00-03, 10-16**, Heads: **00-04**, Faces: **00-07**

- **GNM** - Gnome Male (Race 12, Gender 0) - Textures: **00-03, 10-16**, Heads: **00-04**, Faces: **00-07**

- **HAF** - Half Elf Female (Race 7, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **HAM** - Half Elf Male (Race 7, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **HOF** - Halfling Female (Race 11, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **HOM** - Halfling Male (Race 11, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **HIF** - High Elf Female (Race 5, Gender 1) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-07**

- **HIM** - High Elf Male (Race 5, Gender 0) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-07**

- **HUF** - Human Female (Race 1, Gender 1) - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**

- **HUM** - Human Male (Race 1, Gender 0) - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**

- **OGF** - Ogre Female (Race 10, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **OGM** - Ogre Male (Race 10, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **TRF** - Troll Female (Race 9, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **TRM** - Troll Male (Race 9, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **ELF** - Wood Elf Female (Race 4, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **ELM** - Wood Elf Male (Race 4, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **Source:** global2_chr.s3d (Loaded via GlobalLoad.txt)

**BEA** - Bear (Race 43, Gender 2) - Textures: **00-02**, Heads: **00-02**

- **BRI** - Bristlebane (Race 153, Gender 2)

- **CAZ** - Cazic Thule (Race 95, Gender 2) - Heads: **00 01**

- **ERO** - Erollisi (Race 150, Gender 2)

- **IMP** - Imp (Race 46, Gender 2)

- **INN** - Innoruuk (Race 123, Gender 2)

- **RAL** - Rallos Zek (Race 66, Gender 2) - Textures: **00 01**

- **SCA** - Scarecrow (Race 82, Gender 2)

- **SOL** - Solusek Ro (Race 58, Gender 2)

- **TRI** - Tribunal (Race 151, Gender 2)

- **TUN** - Tunare (Race 62, Gender 2)

# SoF¶

## Globally Available Race Models¶

- **Source:** global7_chr.s3d (Loaded when Luclin models disabled)

**KEF** - Vah Shir Female (Race 130, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **KEM** - Vah Shir Male (Race 130, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **Source:** globalhum_chr.s3d (Loaded with Luclin models)

**HUM** - Human Male (Race 1, Gender 0) - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**, Beards: **00-05**

- **Source:** globalhuf_chr.s3d (Loaded with Luclin models)

**HUF** - Human Female (Race 1, Gender 1) - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**,
 Hair: **00-03**

- **Source:** globalbam_chr.s3d (Loaded with Luclin models)

**BAM** - Barbarian Male (Race 2, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**, Beards: **00-05**, Tattoo: **00-08**

- **Source:** globalbaf_chr.s3d (Loaded with Luclin models)

**BAF** - Barbarian Female (Race 2, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**, Tattoo: **00-08**

- **Source:** globalerm_chr.s3d (Loaded with Luclin models)

**ERM** - Erudite Male (Race 3, Gender 0) - Textures: **00-03, 10-16**, Heads: **00-04**, Faces: **00-07**,
 Hair: **00-05**, Beards: **00-05**

- **Source:** globalerf_chr.s3d (Loaded with Luclin models)

**ERF** - Erudite Female (Race 3, Gender 1) - Textures: **00-03, 10-16**, Heads: **00-04**, Faces: **00-07**,
 Hair: **00-08**

- **Source:** globalelm_chr.s3d (Loaded with Luclin models)

**ELM** - Wood Elf Male (Race 4, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**

- **Source:** globalelf_chr.s3d (Loaded with Luclin models)

**ELF** - Wood Elf Female (Race 4, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**

- **Source:** globalhim_chr.s3d (Loaded with Luclin models)

**HIM** - High Elf Male (Race 5, Gender 0) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-07**,
 Hair: **00-03**, Beards: **00-03**

- **Source:** globalhif_chr.s3d (Loaded with Luclin models)

**HIF** - High Elf Female (Race 5, Gender 1) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-07**,
 Hair: **00-03**

- **Source:** globaldam_chr.s3d (Loaded with Luclin models)

**DAM** - Dark Elf Male (Race 6, Gender 0) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-07**,
 Hair: **00-03**, Beards: **00-03**

- **Source:** globaldaf_chr.s3d (Loaded with Luclin models)

**DAF** - Dark Elf Female (Race 6, Gender 1) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-07**,
 Hair: **00-03**

- **Source:** globalham_chr.s3d (Loaded with Luclin models)

**HAM** - Half Elf Male (Race 7, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**, Beards: **00-03**

- **Source:** globalhaf_chr.s3d (Loaded with Luclin models)

**HAF** - Half Elf Female (Race 7, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**

- **Source:** globaldwm_chr.s3d (Loaded with Luclin models)

**DWM** - Dwarf Male (Race 8, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **00-03**
 , Beards: **00-05**

- **Source:** globaldwf_chr.s3d (Loaded with Luclin models)

**DWF** - Dwarf Female (Race 8, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**, Beards: **00 01**

- **Source:** globaltrm_chr.s3d (Loaded with Luclin models)

**TRM** - Troll Male (Race 9, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **Source:** globaltrf_chr.s3d (Loaded with Luclin models)

**TRF** - Troll Female (Race 9, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**

- **Source:** globalogm_chr.s3d (Loaded with Luclin models)

**OGM** - Ogre Male (Race 10, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **Source:** globalogf_chr.s3d (Loaded with Luclin models)

**OGF** - Ogre Female (Race 10, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**

- **Source:** globalhom_chr.s3d (Loaded with Luclin models)

**HOM** - Halfling Male (Race 11, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**, Beards: **00-05**

- **Source:** globalhof_chr.s3d (Loaded with Luclin models)

**HOF** - Halfling Female (Race 11, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**

- **Source:** globalgnm_chr.s3d (Loaded with Luclin models)

**GNM** - Gnome Male (Race 12, Gender 0) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-07**,
 Hair: **00-03**, Beards: **00-05**

- **Source:** globalgnf_chr.s3d (Loaded with Luclin models)

**GNF** - Gnome Female (Race 12, Gender 1) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-07**,
 Hair: **00-03**

- **Source:** globalikm_chr.s3d (Loaded with Luclin models)

**IKM** - Iksar Male (Race 128, Gender 0) - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**

- **Source:** globalikf_chr.s3d (Loaded with Luclin models)

**IKF** - Iksar Female (Race 128, Gender 1) - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**

- **Source:** globalkem_chr.s3d (Loaded with Luclin models)

**KEM** - Vah Shir Male (Race 130, Gender 0) - Textures: **00-03, 50**, Heads: **00-03**, Faces: **00-07**

- **Source:** globalkef_chr.s3d (Loaded with Luclin models)

**KEF** - Vah Shir Female (Race 130, Gender 1) - Textures: **00-03, 50**, Heads: **00-03**, Faces: **00-07**

- **Source:** global5_chr.s3d (Loaded with Luclin models)

**AEL** - Air Elemental (Race 210, Gender 2)

- **EEL** - Earth Elemental (Race 209, Gender 2)

- **FEL** - Fire Elemental (Race 212, Gender 2)

- **HSM** - Horse Male (Race 216, Gender 0) - Textures: **00-03**

- **WEL** - Water Elemental (Race 211, Gender 2)

- **Source:** frog_mount_chr.s3d (Loaded with Luclin models)

**HSF** - Horse Female (Race 216, Gender 1) - Textures: **00-03**

- **FMT** - Drogmore (Race 348, Gender 2) - Textures: **00-03**

- **Source:** globalfroglok_chr.s3d (Loaded via GlobalLoad.txt)

**FRO** - Froglok (Race 26, Gender 2)

- **FRG** - Froglok (Race 27, Gender 2) - Textures: **00 01**

- **Source:** globalpcfroglok_chr.s3d (Loaded via GlobalLoad.txt)

**FRF** - Froglok Female (Race 330, Gender 1) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-09**

- **FRM** - Froglok Male (Race 330, Gender 0) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-09**

- **Source:** gbn.eqg (Loaded via GlobalLoad.txt)

**GBN** - Goblin (Race 433, Gender 2) - Textures: **00-08**, Heads: **00 06-08**

- **Source:** wwf.eqg (Loaded via GlobalLoad.txt)

**WWF** - Werewolf (Race 454, Gender 2) - Textures: **00-04**

- **Source:** kbd.eqg (Loaded via GlobalLoad.txt)

**KBD** - Kobold (Race 455, Gender 2) - Textures: **00-05**, Heads: **00-05**

- **Source:** fng.eqg (Loaded via GlobalLoad.txt)

**FNG** - Sporali (Race 456, Gender 2) - Textures: **00 02 04 06 08 10 12**, Heads: **00 01, 03**

- **Source:** ork.eqg (Loaded via GlobalLoad.txt)

**ORK** - Orc (Race 458, Gender 2) - Textures: **00-09**, Heads: **00-09**

- **Source:** ggy.eqg (Loaded via GlobalLoad.txt)

**GGY** - Gargoyle (Race 464, Gender 2) - Textures: **00-03**

- **Source:** eve.eqg (Loaded via GlobalLoad.txt)

**EVE** - Evil Eye (Race 469, Gender 2) - Textures: **00-02**

- **Source:** mnr.eqg (Loaded via GlobalLoad.txt)

**MNR** - Minotaur (Race 470, Gender 2)

- **Source:** zmf.eqg (Loaded via GlobalLoad.txt)

**ZMF** - Zombie Female (Race 471, Gender 1)

- **Source:** zmm.eqg (Loaded via GlobalLoad.txt)

**ZMM** - Zombie Male (Race 471, Gender 0)

- **Source:** fry.eqg (Loaded via GlobalLoad.txt)

**FRY** - Fairy (Race 473, Gender 2) - Textures: **00 01**, Heads: **00 01**

- **Source:** cwr.eqg (Loaded via GlobalLoad.txt)

**CWR** - Clockwork Boar (Race 472, Gender 2)

- **Source:** bas.eqg (Loaded via GlobalLoad.txt)

**BAS** - Basilisk (Race 436, Gender 2) - Textures: **00 01**

- **Source:** rap_chr.s3d (Loaded via GlobalLoad.txt)

**RAP** - Raptor (Race 163, Gender 2) - Textures: **00 01**

- **Source:** t00.eqg (Loaded via GlobalLoad.txt)

**T00** - Bear Trap (Race 503, Gender 2)

- **Source:** t05.eqg (Loaded via GlobalLoad.txt)

**T05** - Stone Ring (Race 508, Gender 2)

- **Source:** t07.eqg (Loaded via GlobalLoad.txt)

**T07** - Runic Symbol (Race 510, Gender 2)

- **Source:** t09.eqg (Loaded via GlobalLoad.txt)

**T09** - Floating Skull (Race 512, Gender 2)

- **Source:** t10.eqg (Loaded via GlobalLoad.txt)

**T10** - Spike Trap (Race 513, Gender 2)

- **Source:** t11.eqg (Loaded via GlobalLoad.txt)

**T11** - Totem (Race 514, Gender 2)

- **Source:** spt.eqg (Loaded via GlobalLoad.txt)

**SPT** - Spectre (Race 485, Gender 2)

- **Source:** dpm_chr.s3d (Loaded via GlobalLoad.txt)

**DPM** - Pirate Male (Race 339, Gender 0)

- **Source:** dpf_chr.s3d (Loaded via GlobalLoad.txt)

**DPF** - Pirate Female (Race 339, Gender 1)

- **Source:** epm_chr.s3d (Loaded via GlobalLoad.txt)

**EPM** - Pirate Male (Race 342, Gender 0)

- **Source:** epf_chr.s3d (Loaded via GlobalLoad.txt)

**EPF** - Pirate Female (Race 342, Gender 1)

- **Source:** gpm_chr.s3d (Loaded via GlobalLoad.txt)

**GPM** - Pirate Male (Race 338, Gender 0)

- **Source:** gpf_chr.s3d (Loaded via GlobalLoad.txt)

**GPF** - Pirate Female (Race 338, Gender 1)

- **Source:** hpf_chr.s3d (Loaded via GlobalLoad.txt)

**HPF** - Pirate Female (Race 341, Gender 1)

- **Source:** hpm_chr.s3d (Loaded via GlobalLoad.txt)

**HPM** - Pirate Male (Race 341, Gender 0)

- **Source:** opf_chr.s3d (Loaded via GlobalLoad.txt)

**OPF** - Pirate Female (Race 340, Gender 1)

- **Source:** opm_chr.s3d (Loaded via GlobalLoad.txt)

**OPM** - Pirate Male (Race 340, Gender 0)

- **Source:** tbm_chr.s3d (Loaded via GlobalLoad.txt)

**TBM** - Troll Male (Race 331, Gender 0)

- **Source:** tbf_chr.s3d (Loaded via GlobalLoad.txt)

**TBF** - Troll Female (Race 331, Gender 1)

- **Source:** wor.eqg (Loaded via GlobalLoad.txt)

**WOR** - Worg (Race 580, Gender 2) - Heads: **00-02**

- **Source:** skt_chr.s3d (Loaded via GlobalLoad.txt)

**SKT** - Skeleton (Race 367, Gender 2) - Textures: **00-04**

- **Source:** global6_chr.s3d (Loaded via GlobalLoad.txt)

**ALL** - Alligator (Race 91, Gender 2) - Textures: **00 01**, Heads: **00 01**

- **DRK** - Drake (Race 89, Gender 2) - Textures: **00-03**

- **WOF** - Chokadai (Race 356, Gender 2) - Textures: **00 01**

- **SKE** - Skeleton (Race 60, Gender 2)

- **TPN** - Teleport Man (Race 240, Gender 2)

- **TIG** - Tiger (Race 63, Gender 2)

- **WOL** - Wolf (Race 42, Gender 2) - Textures: **00-03**

- **WOE** - Wolf (Race 120, Gender 2) - Textures: **00-03**

- **Source:** global4_chr.s3d (Loaded via GlobalLoad.txt)

**IKS** - Undead Iksar (Race 161, Gender 2) - Heads: **00 01**

- **SPE** - Spectre (Race 85, Gender 2)

- **BAF** - Barbarian Female (Race 2, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **BAM** - Barbarian Male (Race 2, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **IKF** - Iksar Female (Race 128, Gender 1) - Textures: **00-04, 10**, Heads: **00-03**, Faces: **00-07**

- **IKM** - Iksar Male (Race 128, Gender 0) - Textures: **00-04, 10**, Heads: **00-03**, Faces: **00-07**

- **Source:** global_chr.s3d (Loaded via GlobalLoad.txt)

**ELE** - Elemental (Race 75, Gender 2) - Textures: **00-03**, Heads: **00 01**

- **EYE** - Eye (Race 108, Gender 2) - Textures: **00-03**

- **IVM** - Invisible Man Male (Race 127, Gender 0)

- **SKE** - Skeleton (Race 60, Gender 2) - Textures: **00 01**

- **WER** - Werewolf (Race 14, Gender 2)

- **WOE** - Wolf (Race 120, Gender 2) - Textures: **00 01**

- **BOAT** - Boat (Race 141, Gender 2)

- **BAF** - Barbarian Female (Race 2, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **BAM** - Barbarian Male (Race 2, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **DAF** - Dark Elf Female (Race 6, Gender 1) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-07**

- **DAM** - Dark Elf Male (Race 6, Gender 0) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-07**

- **DWF** - Dwarf Female (Race 8, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **DWM** - Dwarf Male (Race 8, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **ERF** - Erudite Female (Race 3, Gender 1) - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**

- **ERM** - Erudite Male (Race 3, Gender 0) - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**

- **GNF** - Gnome Female (Race 12, Gender 1) - Textures: **00-03, 10-16**, Heads: **00-04**, Faces: **00-07**

- **GNM** - Gnome Male (Race 12, Gender 0) - Textures: **00-03, 10-16**, Heads: **00-04**, Faces: **00-07**

- **HAF** - Half Elf Female (Race 7, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **HAM** - Half Elf Male (Race 7, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **HOF** - Halfling Female (Race 11, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **HOM** - Halfling Male (Race 11, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **HIF** - High Elf Female (Race 5, Gender 1) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-07**

- **HIM** - High Elf Male (Race 5, Gender 0) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-07**

- **HUF** - Human Female (Race 1, Gender 1) - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**

- **HUM** - Human Male (Race 1, Gender 0) - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**

- **OGF** - Ogre Female (Race 10, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **OGM** - Ogre Male (Race 10, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **TRF** - Troll Female (Race 9, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **TRM** - Troll Male (Race 9, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **ELF** - Wood Elf Female (Race 4, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **ELM** - Wood Elf Male (Race 4, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **Source:** dkm.eqg (Loaded via GlobalLoad.txt)

**DKM** - Drakkin Male (Race 522, Gender 0) - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-06**,
 Hair: **00-08**, Beards: **00-11**, Detail: **00-07**, Tattoo: **00-07**, Heritage: **00-07**

- **Source:** dkf.eqg (Loaded via GlobalLoad.txt)

**DKF** - Drakkin Female (Race 522, Gender 1) - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-06**,
 Hair: **00-07**, Beards: **00-03**, Detail: **00-07**, Tattoo: **00-07**, Heritage: **00-07**

- **Source:** unm.eqg (Loaded via GlobalLoad.txt)

**UNM** - Nightmare/Unicorn (Race 519, Gender 2) - Textures: **00 01**, Heads: **00 01**

- **Source:** hrs.eqg (Loaded via GlobalLoad.txt)

**HRS** - Horse (Race 518, Gender 2) - Textures: **00-02**, Heads: **00 03 06**

- **Source:** globalgdb.eqg (Loaded via GlobalLoad.txt)

**G00** - Banner (Race 553, Gender 2)

- **G01** - Banner (Race 554, Gender 2)

- **G02** - Banner (Race 555, Gender 2)

- **G03** - Banner (Race 556, Gender 2)

- **G04** - Banner (Race 557, Gender 2)

- **Source:** glm.eqg (Loaded via GlobalLoad.txt)

**GLM** - Golem (Race 374, Gender 2) - Textures: **00-04**

- **Source:** mur.eqg (Loaded via GlobalLoad.txt)

**MUR** - Lightning Warrior (Race 407, Gender 2)

- **Source:** dsg.eqg (Loaded via GlobalLoad.txt)

**DSG** - Bazu (Race 409, Gender 2)

- **Source:** scu.eqg (Loaded via GlobalLoad.txt)

**SCU** - Pyrilen (Race 411, Gender 2)

- **Source:** frd.eqg (Loaded via GlobalLoad.txt)

**FRD** - Gelidran (Race 417, Gender 2)

- **Source:** ddv.eqg (Loaded via GlobalLoad.txt)

**DDV** - Girplan (Race 419, Gender 2) - Textures: **00-03**

- **Source:** shl.eqg (Loaded via GlobalLoad.txt)

**SHL** - Shiliskin (Race 467, Gender 2) - Textures: **00-03**, Heads: **00-03**

- **Source:** bsg.eqg (Loaded via GlobalLoad.txt)

**BSG** - Banshee Female (Race 488, Gender 1)

- **Source:** srn.eqg (Loaded via GlobalLoad.txt)

**SRN** - Scrykin (Race 495, Gender 2) - Textures: **00-03**, Heads: **00-03**

- **Source:** bxi.eqg (Loaded via GlobalLoad.txt)

**BXI** - Bixie (Race 520, Gender 2) - Textures: **00-02**, Heads: **00-02**

- **Source:** drg.eqg (Loaded via GlobalLoad.txt)

**DRG** - Dragon (Race 530, Gender 2) - Textures: **00-05**, Heads: **00-05**

- **Source:** mch.eqg (Loaded via GlobalLoad.txt)

**MCH** - Chimera (Race 582, Gender 2)

- **Source:** mki.eqg (Loaded via GlobalLoad.txt)

**MKI** - Kirin (Race 583, Gender 2)

- **Source:** mpu.eqg (Loaded via GlobalLoad.txt)

**MPU** - Puma (Race 584, Gender 2) - Textures: **00 01**

- **Source:** g05.eqg (Loaded via GlobalLoad.txt)

**G05** - Banner (Race 586, Gender 2)

- **Source:** i10.eqg (Loaded via GlobalLoad.txt)

**I10** - Campfire (Race 567, Gender 2)

- **Source:** global2_chr.s3d (Loaded via GlobalLoad.txt)

**BEA** - Bear (Race 43, Gender 2) - Textures: **00-02**, Heads: **00-02**

- **BRI** - Bristlebane (Race 153, Gender 2)

- **CAZ** - Cazic Thule (Race 95, Gender 2) - Heads: **00 01**

- **ERO** - Erollisi (Race 150, Gender 2)

- **IMP** - Imp (Race 46, Gender 2)

- **INN** - Innoruuk (Race 123, Gender 2)

- **RAL** - Rallos Zek (Race 66, Gender 2) - Textures: **00 01**

- **SCA** - Scarecrow (Race 82, Gender 2)

- **SOL** - Solusek Ro (Race 58, Gender 2)

- **TRI** - Tribunal (Race 151, Gender 2)

- **TUN** - Tunare (Race 62, Gender 2)

# RoF2¶

## Globally Available Race Models¶

- **Source:** global7_chr.s3d (Loaded when Luclin models disabled)

**KEF** - Vah Shir Female (Race 130, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **KEM** - Vah Shir Male (Race 130, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **Source:** globalhum_chr.s3d (Loaded with Luclin models)

**HUM** - Human Male (Race 1, Gender 0) - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**, Beards: **00-05**

- **Source:** globalhuf_chr.s3d (Loaded with Luclin models)

**HUF** - Human Female (Race 1, Gender 1) - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**,
 Hair: **00-03**

- **Source:** globalbam_chr.s3d (Loaded with Luclin models)

**BAM** - Barbarian Male (Race 2, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**, Beards: **00-05**, Tattoo: **00-08**

- **Source:** globalbaf_chr.s3d (Loaded with Luclin models)

**BAF** - Barbarian Female (Race 2, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**, Tattoo: **00-08**

- **Source:** globalerm_chr.s3d (Loaded with Luclin models)

**ERM** - Erudite Male (Race 3, Gender 0) - Textures: **00-03, 10-16**, Heads: **00-04**, Faces: **00-07**,
 Hair: **00-05**, Beards: **00-05**

- **Source:** globalerf_chr.s3d (Loaded with Luclin models)

**ERF** - Erudite Female (Race 3, Gender 1) - Textures: **00-03, 10-16**, Heads: **00-04**, Faces: **00-07**,
 Hair: **00-08**

- **Source:** globalelm_chr.s3d (Loaded with Luclin models)

**ELM** - Wood Elf Male (Race 4, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**

- **Source:** globalelf_chr.s3d (Loaded with Luclin models)

**ELF** - Wood Elf Female (Race 4, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**

- **Source:** globalhim_chr.s3d (Loaded with Luclin models)

**HIM** - High Elf Male (Race 5, Gender 0) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-07**,
 Hair: **00-03**, Beards: **00-03**

- **Source:** globalhif_chr.s3d (Loaded with Luclin models)

**HIF** - High Elf Female (Race 5, Gender 1) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-07**,
 Hair: **00-03**

- **Source:** globaldam_chr.s3d (Loaded with Luclin models)

**DAM** - Dark Elf Male (Race 6, Gender 0) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-07**,
 Hair: **00-03**, Beards: **00-03**

- **Source:** globaldaf_chr.s3d (Loaded with Luclin models)

**DAF** - Dark Elf Female (Race 6, Gender 1) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-07**,
 Hair: **00-03**

- **Source:** globalham_chr.s3d (Loaded with Luclin models)

**HAM** - Half Elf Male (Race 7, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**, Beards: **00-03**

- **Source:** globalhaf_chr.s3d (Loaded with Luclin models)

**HAF** - Half Elf Female (Race 7, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**

- **Source:** globaldwm_chr.s3d (Loaded with Luclin models)

**DWM** - Dwarf Male (Race 8, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **00-03**
 , Beards: **00-05**

- **Source:** globaldwf_chr.s3d (Loaded with Luclin models)

**DWF** - Dwarf Female (Race 8, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**, Beards: **00 01**

- **Source:** globaltrm_chr.s3d (Loaded with Luclin models)

**TRM** - Troll Male (Race 9, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **Source:** globaltrf_chr.s3d (Loaded with Luclin models)

**TRF** - Troll Female (Race 9, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**

- **Source:** globalogm_chr.s3d (Loaded with Luclin models)

**OGM** - Ogre Male (Race 10, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **Source:** globalogf_chr.s3d (Loaded with Luclin models)

**OGF** - Ogre Female (Race 10, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**

- **Source:** globalhom_chr.s3d (Loaded with Luclin models)

**HOM** - Halfling Male (Race 11, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**, Beards: **00-05**

- **Source:** globalhof_chr.s3d (Loaded with Luclin models)

**HOF** - Halfling Female (Race 11, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**, Hair: **
 00-03**

- **Source:** globalgnm_chr.s3d (Loaded with Luclin models)

**GNM** - Gnome Male (Race 12, Gender 0) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-07**,
 Hair: **00-03**, Beards: **00-05**

- **Source:** globalgnf_chr.s3d (Loaded with Luclin models)

**GNF** - Gnome Female (Race 12, Gender 1) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-07**,
 Hair: **00-03**

- **Source:** globalikm_chr.s3d (Loaded with Luclin models)

**IKM** - Iksar Male (Race 128, Gender 0) - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**

- **Source:** globalikf_chr.s3d (Loaded with Luclin models)

**IKF** - Iksar Female (Race 128, Gender 1) - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**

- **Source:** globalkem_chr.s3d (Loaded with Luclin models)

**KEM** - Vah Shir Male (Race 130, Gender 0) - Textures: **00-03, 50**, Heads: **00-03**, Faces: **00-07**

- **Source:** globalkef_chr.s3d (Loaded with Luclin models)

**KEF** - Vah Shir Female (Race 130, Gender 1) - Textures: **00-03, 50**, Heads: **00-03**, Faces: **00-07**

- **Source:** global5_chr.s3d (Loaded with Luclin models)

**AEL** - Air Elemental (Race 210, Gender 2)

- **EEL** - Earth Elemental (Race 209, Gender 2)

- **FEL** - Fire Elemental (Race 212, Gender 2)

- **HSM** - Horse Male (Race 216, Gender 0) - Textures: **00-03**

- **WEL** - Water Elemental (Race 211, Gender 2)

- **Source:** frog_mount_chr.s3d (Loaded with Luclin models)

**HSF** - Horse Female (Race 216, Gender 1) - Textures: **00-03**

- **FMT** - Drogmore (Race 348, Gender 2) - Textures: **00-03**

- **Source:** globalfroglok_chr.s3d (Loaded via GlobalLoad.txt)

**FRO** - Froglok (Race 26, Gender 2)

- **FRG** - Froglok (Race 27, Gender 2) - Textures: **00 01**

- **Source:** globalpcfroglok_chr.s3d (Loaded via GlobalLoad.txt)

**FRF** - Froglok Female (Race 330, Gender 1) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-09**

- **FRM** - Froglok Male (Race 330, Gender 0) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-09**

- **Source:** frogequip.s3d (Loaded via GlobalLoad.txt)

**IT4840** - Unrecognized Race Model

- **IT4841** - Unrecognized Race Model

- **IT4842** - Unrecognized Race Model

- **IT4843** - Unrecognized Race Model

- **IT4844** - Unrecognized Race Model

- **IT4845** - Unrecognized Race Model

- **IT4846** - Unrecognized Race Model

- **IT4870** - Unrecognized Race Model

- **IT4871** - Unrecognized Race Model

- **IT4872** - Unrecognized Race Model

- **IT4873** - Unrecognized Race Model

- **IT4874** - Unrecognized Race Model

- **IT4875** - Unrecognized Race Model

- **IT4876** - Unrecognized Race Model

- **IT5841** - Unrecognized Race Model

- **IT5842** - Unrecognized Race Model

- **IT5843** - Unrecognized Race Model

- **IT5871** - Unrecognized Race Model

- **IT5872** - Unrecognized Race Model

- **IT5873** - Unrecognized Race Model

- **IT7843** - Unrecognized Race Model

- **IT7845** - Unrecognized Race Model

- **IT7847** - Unrecognized Race Model

- **IT7873** - Unrecognized Race Model

- **IT7875** - Unrecognized Race Model

- **IT7877** - Unrecognized Race Model

- **IT8846** - Unrecognized Race Model

- **IT8847** - Unrecognized Race Model

- **IT8876** - Unrecognized Race Model

- **IT8877** - Unrecognized Race Model

- **Source:** global_obj.s3d (Loaded via GlobalLoad.txt)

**POKTELE500** - Unrecognized Race Model

- **Source:** gequip.s3d (Loaded via GlobalLoad.txt)

**BBBOARD** - Unrecognized Race Model

- **GENA00** - Unrecognized Race Model

- **GENA10** - Unrecognized Race Model

- **GENA20** - Unrecognized Race Model

- **GENA30** - Unrecognized Race Model

- **GENA40** - Unrecognized Race Model

- **GENB00** - Unrecognized Race Model

- **GENB10** - Unrecognized Race Model

- **GENB20** - Unrecognized Race Model

- **GENB30** - Unrecognized Race Model

- **GENB40** - Unrecognized Race Model

- **GENC00** - Unrecognized Race Model

- **GENC10** - Unrecognized Race Model

- **GENC20** - Unrecognized Race Model

- **GENC30** - Unrecognized Race Model

- **GENC40** - Unrecognized Race Model

- **GEND00** - Unrecognized Race Model

- **GEND10** - Unrecognized Race Model

- **GEND20** - Unrecognized Race Model

- **GEND30** - Unrecognized Race Model

- **GEND40** - Unrecognized Race Model

- **GENE01** - Unrecognized Race Model

- **GENF00** - Unrecognized Race Model

- **GENG00** - Unrecognized Race Model

- **GENH00** - Unrecognized Race Model

- **GENI00** - Unrecognized Race Model

- **GENJ00** - Unrecognized Race Model

- **GENJ10** - Unrecognized Race Model

- **GENK00** - Unrecognized Race Model

- **GENK10** - Unrecognized Race Model

- **GENL00** - Unrecognized Race Model

- **GENM00** - Unrecognized Race Model

- **GENN00** - Unrecognized Race Model

- **GENO00** - Unrecognized Race Model

- **GENP00** - Unrecognized Race Model

- **GENQ00** - Unrecognized Race Model

- **GENR00** - Unrecognized Race Model

- **GENR10** - Unrecognized Race Model

- **GENS00** - Unrecognized Race Model

- **GENS10** - Unrecognized Race Model

- **GENT00** - Unrecognized Race Model

- **GENU00** - Unrecognized Race Model

- **GENU10** - Unrecognized Race Model

- **GENV00** - Unrecognized Race Model

- **GENW00** - Unrecognized Race Model

- **GENW10** - Unrecognized Race Model

- **GENX00** - Unrecognized Race Model

- **GENY10** - Unrecognized Race Model

- **GENY20** - Unrecognized Race Model

- **GENY30** - Unrecognized Race Model

- **GENY40** - Unrecognized Race Model

- **GENZ00** - Unrecognized Race Model

- **GENZ01** - Unrecognized Race Model

- **IT1** - Unrecognized Race Model

- **IT2** - Unrecognized Race Model

- **IT3** - Unrecognized Race Model

- **IT4** - Unrecognized Race Model

- **IT5** - Unrecognized Race Model

- **IT6** - Unrecognized Race Model

- **IT7** - Unrecognized Race Model

- **IT8** - Unrecognized Race Model

- **IT9** - Unrecognized Race Model

- **IT10** - Unrecognized Race Model

- **IT13** - Unrecognized Race Model

- **IT14** - Unrecognized Race Model

- **IT15** - Unrecognized Race Model

- **IT16** - Unrecognized Race Model

- **IT17** - Unrecognized Race Model

- **IT18** - Unrecognized Race Model

- **IT19** - Unrecognized Race Model

- **IT20** - Unrecognized Race Model

- **IT21** - Unrecognized Race Model

- **IT22** - Unrecognized Race Model

- **IT23** - Unrecognized Race Model

- **IT24** - Unrecognized Race Model

- **IT25** - Unrecognized Race Model

- **IT26** - Unrecognized Race Model

- **IT27** - Unrecognized Race Model

- **IT28** - Unrecognized Race Model

- **IT29** - Unrecognized Race Model

- **IT30** - Unrecognized Race Model

- **IT31** - Unrecognized Race Model

- **IT32** - Unrecognized Race Model

- **IT33** - Unrecognized Race Model

- **IT34** - Unrecognized Race Model

- **IT35** - Unrecognized Race Model

- **IT36** - Unrecognized Race Model

- **IT37** - Unrecognized Race Model

- **IT38** - Unrecognized Race Model

- **IT39** - Unrecognized Race Model

- **IT40** - Unrecognized Race Model

- **IT41** - Unrecognized Race Model

- **IT42** - Unrecognized Race Model

- **IT43** - Unrecognized Race Model

- **IT44** - Unrecognized Race Model

- **IT45** - Unrecognized Race Model

- **IT46** - Unrecognized Race Model

- **IT47** - Unrecognized Race Model

- **IT48** - Unrecognized Race Model

- **IT49** - Unrecognized Race Model

- **IT50** - Unrecognized Race Model

- **IT51** - Unrecognized Race Model

- **IT52** - Unrecognized Race Model

- **IT53** - Unrecognized Race Model

- **IT54** - Unrecognized Race Model

- **IT55** - Unrecognized Race Model

- **IT56** - Unrecognized Race Model

- **IT57** - Unrecognized Race Model

- **IT58** - Unrecognized Race Model

- **IT59** - Unrecognized Race Model

- **IT60** - Unrecognized Race Model

- **IT61** - Unrecognized Race Model

- **IT62** - Unrecognized Race Model

- **IT63** - Unrecognized Race Model

- **IT64** - Unrecognized Race Model

- **IT65** - Unrecognized Race Model

- **IT66** - Unrecognized Race Model

- **IT67** - Unrecognized Race Model

- **IT68** - Unrecognized Race Model

- **IT69** - Unrecognized Race Model

- **IT70** - Unrecognized Race Model

- **IT71** - Unrecognized Race Model

- **IT72** - Unrecognized Race Model

- **IT73** - Unrecognized Race Model

- **IT74** - Unrecognized Race Model

- **IT75** - Unrecognized Race Model

- **IT76** - Unrecognized Race Model

- **IT78** - Unrecognized Race Model

- **IT79** - Unrecognized Race Model

- **IT80** - Unrecognized Race Model

- **IT81** - Unrecognized Race Model

- **IT82** - Unrecognized Race Model

- **IT83** - Unrecognized Race Model

- **IT84** - Unrecognized Race Model

- **IT85** - Unrecognized Race Model

- **IT86** - Unrecognized Race Model

- **IT87** - Unrecognized Race Model

- **IT88** - Unrecognized Race Model

- **IT89** - Unrecognized Race Model

- **IT90** - Unrecognized Race Model

- **IT91** - Unrecognized Race Model

- **IT92** - Unrecognized Race Model

- **IT93** - Unrecognized Race Model

- **IT94** - Unrecognized Race Model

- **IT95** - Unrecognized Race Model

- **IT96** - Unrecognized Race Model

- **IT97** - Unrecognized Race Model

- **IT98** - Unrecognized Race Model

- **IT99** - Unrecognized Race Model

- **IT100** - Unrecognized Race Model

- **IT101** - Unrecognized Race Model

- **IT102** - Unrecognized Race Model

- **IT103** - Unrecognized Race Model

- **IT104** - Unrecognized Race Model

- **IT105** - Unrecognized Race Model

- **IT106** - Unrecognized Race Model

- **IT107** - Unrecognized Race Model

- **IT108** - Unrecognized Race Model

- **IT109** - Unrecognized Race Model

- **IT110** - Unrecognized Race Model

- **IT111** - Unrecognized Race Model

- **IT112** - Unrecognized Race Model

- **IT113** - Unrecognized Race Model

- **IT115** - Unrecognized Race Model

- **IT117** - Unrecognized Race Model

- **IT118** - Unrecognized Race Model

- **IT119** - Unrecognized Race Model

- **IT120** - Unrecognized Race Model

- **IT121** - Unrecognized Race Model

- **IT122** - Unrecognized Race Model

- **IT123** - Unrecognized Race Model

- **IT124** - Unrecognized Race Model

- **IT125** - Unrecognized Race Model

- **IT126** - Unrecognized Race Model

- **IT127** - Unrecognized Race Model

- **IT128** - Unrecognized Race Model

- **IT129** - Unrecognized Race Model

- **IT130** - Unrecognized Race Model

- **IT131** - Unrecognized Race Model

- **IT132** - Unrecognized Race Model

- **IT133** - Unrecognized Race Model

- **IT134** - Unrecognized Race Model

- **IT135** - Unrecognized Race Model

- **IT136** - Unrecognized Race Model

- **IT137** - Unrecognized Race Model

- **IT138** - Unrecognized Race Model

- **IT139** - Unrecognized Race Model

- **IT140** - Unrecognized Race Model

- **IT141** - Unrecognized Race Model

- **IT142** - Unrecognized Race Model

- **IT145** - Unrecognized Race Model

- **IT146** - Unrecognized Race Model

- **IT148** - Unrecognized Race Model

- **IT149** - Unrecognized Race Model

- **IT150** - Unrecognized Race Model

- **IT151** - Unrecognized Race Model

- **IT153** - Unrecognized Race Model

- **IT154** - Unrecognized Race Model

- **IT155** - Unrecognized Race Model

- **IT156** - Unrecognized Race Model

- **Source:** gequip8.s3d (Loaded via GlobalLoad.txt)

**IT10524** - Unrecognized Race Model

- **IT10733** - Unrecognized Race Model

- **Source:** gequip2.s3d (Loaded via GlobalLoad.txt)

**IT11** - Unrecognized Race Model

- **IT12** - Unrecognized Race Model

- **IT161** - Unrecognized Race Model

- **IT162** - Unrecognized Race Model

- **IT163** - Unrecognized Race Model

- **IT164** - Unrecognized Race Model

- **IT165** - Unrecognized Race Model

- **IT166** - Unrecognized Race Model

- **IT167** - Unrecognized Race Model

- **IT168** - Unrecognized Race Model

- **IT169** - Unrecognized Race Model

- **IT170** - Unrecognized Race Model

- **IT171** - Unrecognized Race Model

- **IT172** - Unrecognized Race Model

- **IT173** - Unrecognized Race Model

- **IT174** - Unrecognized Race Model

- **IT175** - Unrecognized Race Model

- **IT176** - Unrecognized Race Model

- **IT177** - Unrecognized Race Model

- **IT178** - Unrecognized Race Model

- **IT179** - Unrecognized Race Model

- **IT180** - Unrecognized Race Model

- **IT181** - Unrecognized Race Model

- **IT182** - Unrecognized Race Model

- **IT183** - Unrecognized Race Model

- **IT184** - Unrecognized Race Model

- **IT185** - Unrecognized Race Model

- **IT186** - Unrecognized Race Model

- **IT187** - Unrecognized Race Model

- **IT188** - Unrecognized Race Model

- **IT189** - Unrecognized Race Model

- **IT190** - Unrecognized Race Model

- **IT191** - Unrecognized Race Model

- **IT192** - Unrecognized Race Model

- **IT193** - Unrecognized Race Model

- **IT194** - Unrecognized Race Model

- **IT195** - Unrecognized Race Model

- **IT196** - Unrecognized Race Model

- **IT197** - Unrecognized Race Model

- **IT198** - Unrecognized Race Model

- **IT228** - Unrecognized Race Model

- **IT250** - Unrecognized Race Model

- **IT300** - Unrecognized Race Model

- **IT301** - Unrecognized Race Model

- **IT308** - Unrecognized Race Model

- **IT530** - Unrecognized Race Model

- **IT535** - Unrecognized Race Model

- **IT536** - Unrecognized Race Model

- **IT537** - Unrecognized Race Model

- **IT540** - Unrecognized Race Model

- **IT545** - Unrecognized Race Model

- **IT550** - Unrecognized Race Model

- **IT555** - Unrecognized Race Model

- **IT556** - Unrecognized Race Model

- **IT557** - Unrecognized Race Model

- **IT560** - Unrecognized Race Model

- **IT561** - Unrecognized Race Model

- **IT565** - Unrecognized Race Model

- **IT566** - Unrecognized Race Model

- **IT570** - Unrecognized Race Model

- **IT575** - Unrecognized Race Model

- **IT580** - Unrecognized Race Model

- **IT585** - Unrecognized Race Model

- **IT590** - Unrecognized Race Model

- **IT595** - Unrecognized Race Model

- **IT600** - Unrecognized Race Model

- **IT605** - Unrecognized Race Model

- **IT610** - Unrecognized Race Model

- **IT615** - Unrecognized Race Model

- **IT620** - Unrecognized Race Model

- **IT625** - Unrecognized Race Model

- **IT626** - Unrecognized Race Model

- **IT627** - Unrecognized Race Model

- **IT628** - Unrecognized Race Model

- **IT629** - Unrecognized Race Model

- **IT630** - Unrecognized Race Model

- **IT635** - Unrecognized Race Model

- **IT640** - Unrecognized Race Model

- **IT641** - Unrecognized Race Model

- **IT645** - Unrecognized Race Model

- **IT646** - Unrecognized Race Model

- **IT650** - Unrecognized Race Model

- **IT655** - Unrecognized Race Model

- **IT656** - Unrecognized Race Model

- **Source:** gequip5.s3d (Loaded via GlobalLoad.txt)

**IT10400** - Unrecognized Race Model

- **IT10401** - Unrecognized Race Model

- **IT10402** - Unrecognized Race Model

- **IT10403** - Unrecognized Race Model

- **IT10404** - Unrecognized Race Model

- **IT10405** - Unrecognized Race Model

- **IT10406** - Unrecognized Race Model

- **IT10407** - Unrecognized Race Model

- **IT10408** - Unrecognized Race Model

- **IT10409** - Unrecognized Race Model

- **IT10410** - Unrecognized Race Model

- **IT10411** - Unrecognized Race Model

- **IT10412** - Unrecognized Race Model

- **IT10413** - Unrecognized Race Model

- **IT10501** - Unrecognized Race Model

- **IT10502** - Unrecognized Race Model

- **IT10503** - Unrecognized Race Model

- **IT10504** - Unrecognized Race Model

- **IT10505** - Unrecognized Race Model

- **IT10506** - Unrecognized Race Model

- **IT10507** - Unrecognized Race Model

- **IT10508** - Unrecognized Race Model

- **IT10509** - Unrecognized Race Model

- **IT10510** - Unrecognized Race Model

- **IT10511** - Unrecognized Race Model

- **IT10512** - Unrecognized Race Model

- **IT10513** - Unrecognized Race Model

- **IT10514** - Unrecognized Race Model

- **IT10515** - Unrecognized Race Model

- **IT10516** - Unrecognized Race Model

- **IT10517** - Unrecognized Race Model

- **IT10518** - Unrecognized Race Model

- **IT10519** - Unrecognized Race Model

- **IT10520** - Unrecognized Race Model

- **IT10521** - Unrecognized Race Model

- **IT10522** - Unrecognized Race Model

- **IT10523** - Unrecognized Race Model

- **IT10524** - Unrecognized Race Model

- **IT10525** - Unrecognized Race Model

- **IT10526** - Unrecognized Race Model

- **IT10527** - Unrecognized Race Model

- **IT10528** - Unrecognized Race Model

- **IT10530** - Unrecognized Race Model

- **IT10531** - Unrecognized Race Model

- **IT10532** - Unrecognized Race Model

- **IT10533** - Unrecognized Race Model

- **IT10534** - Unrecognized Race Model

- **IT10535** - Unrecognized Race Model

- **IT10536** - Unrecognized Race Model

- **IT10537** - Unrecognized Race Model

- **IT10538** - Unrecognized Race Model

- **IT10539** - Unrecognized Race Model

- **IT10540** - Unrecognized Race Model

- **IT10541** - Unrecognized Race Model

- **IT10542** - Unrecognized Race Model

- **IT10543** - Unrecognized Race Model

- **IT10544** - Unrecognized Race Model

- **IT10545** - Unrecognized Race Model

- **IT10600** - Unrecognized Race Model

- **IT10601** - Unrecognized Race Model

- **IT10602** - Unrecognized Race Model

- **IT10603** - Unrecognized Race Model

- **IT10604** - Unrecognized Race Model

- **IT10605** - Unrecognized Race Model

- **IT10606** - Unrecognized Race Model

- **IT10607** - Unrecognized Race Model

- **IT10608** - Unrecognized Race Model

- **IT10609** - Unrecognized Race Model

- **IT10610** - Unrecognized Race Model

- **IT10611** - Unrecognized Race Model

- **IT10612** - Unrecognized Race Model

- **IT10613** - Unrecognized Race Model

- **IT10614** - Unrecognized Race Model

- **IT10615** - Unrecognized Race Model

- **IT10616** - Unrecognized Race Model

- **IT10617** - Unrecognized Race Model

- **IT10618** - Unrecognized Race Model

- **IT10619** - Unrecognized Race Model

- **IT10620** - Unrecognized Race Model

- **IT10621** - Unrecognized Race Model

- **IT10622** - Unrecognized Race Model

- **IT10623** - Unrecognized Race Model

- **IT10624** - Unrecognized Race Model

- **IT10625** - Unrecognized Race Model

- **IT10626** - Unrecognized Race Model

- **IT10627** - Unrecognized Race Model

- **IT10628** - Unrecognized Race Model

- **IT10629** - Unrecognized Race Model

- **IT10630** - Unrecognized Race Model

- **IT10631** - Unrecognized Race Model

- **IT10632** - Unrecognized Race Model

- **IT10633** - Unrecognized Race Model

- **IT10634** - Unrecognized Race Model

- **IT10635** - Unrecognized Race Model

- **IT10636** - Unrecognized Race Model

- **IT10637** - Unrecognized Race Model

- **IT10638** - Unrecognized Race Model

- **IT10639** - Unrecognized Race Model

- **IT10640** - Unrecognized Race Model

- **IT10641** - Unrecognized Race Model

- **IT10642** - Unrecognized Race Model

- **IT10643** - Unrecognized Race Model

- **IT10644** - Unrecognized Race Model

- **IT10645** - Unrecognized Race Model

- **IT10646** - Unrecognized Race Model

- **IT10647** - Unrecognized Race Model

- **IT10648** - Unrecognized Race Model

- **IT10649** - Unrecognized Race Model

- **IT10650** - Unrecognized Race Model

- **IT10651** - Unrecognized Race Model

- **IT10652** - Unrecognized Race Model

- **IT10653** - Unrecognized Race Model

- **IT10654** - Unrecognized Race Model

- **IT10655** - Unrecognized Race Model

- **IT10656** - Unrecognized Race Model

- **IT10657** - Unrecognized Race Model

- **IT10658** - Unrecognized Race Model

- **IT10659** - Unrecognized Race Model

- **IT10660** - Unrecognized Race Model

- **IT10661** - Unrecognized Race Model

- **IT10662** - Unrecognized Race Model

- **IT10663** - Unrecognized Race Model

- **IT10664** - Unrecognized Race Model

- **IT10665** - Unrecognized Race Model

- **IT10666** - Unrecognized Race Model

- **IT10667** - Unrecognized Race Model

- **IT10668** - Unrecognized Race Model

- **IT10669** - Unrecognized Race Model

- **IT10670** - Unrecognized Race Model

- **IT10671** - Unrecognized Race Model

- **Source:** gequip4.s3d (Loaded via GlobalLoad.txt)

**IT10015** - Unrecognized Race Model

- **IT10026** - Unrecognized Race Model

- **IT10027** - Unrecognized Race Model

- **IT10028** - Unrecognized Race Model

- **IT10029** - Unrecognized Race Model

- **IT10203** - Unrecognized Race Model

- **IT11013** - Unrecognized Race Model

- **IT11017** - Unrecognized Race Model

- **IT11018** - Unrecognized Race Model

- **IT11019** - Unrecognized Race Model

- **IT11020** - Unrecognized Race Model

- **IT11502** - Unrecognized Race Model

- **IT67367** - Unrecognized Race Model

- **Source:** gequip3.s3d (Loaded via GlobalLoad.txt)

**IT10000** - Unrecognized Race Model

- **IT10001** - Unrecognized Race Model

- **IT10002** - Unrecognized Race Model

- **IT10003** - Unrecognized Race Model

- **IT10004** - Unrecognized Race Model

- **IT10005** - Unrecognized Race Model

- **IT10006** - Unrecognized Race Model

- **IT10007** - Unrecognized Race Model

- **IT10008** - Unrecognized Race Model

- **IT10009** - Unrecognized Race Model

- **IT10010** - Unrecognized Race Model

- **IT10011** - Unrecognized Race Model

- **IT10012** - Unrecognized Race Model

- **IT10013** - Unrecognized Race Model

- **IT10014** - Unrecognized Race Model

- **IT10016** - Unrecognized Race Model

- **IT10017** - Unrecognized Race Model

- **IT10018** - Unrecognized Race Model

- **IT10019** - Unrecognized Race Model

- **IT10020** - Unrecognized Race Model

- **IT10021** - Unrecognized Race Model

- **IT10022** - Unrecognized Race Model

- **IT10023** - Unrecognized Race Model

- **IT10024** - Unrecognized Race Model

- **IT10025** - Unrecognized Race Model

- **IT10100** - Unrecognized Race Model

- **IT10101** - Unrecognized Race Model

- **IT10103** - Unrecognized Race Model

- **IT10104** - Unrecognized Race Model

- **IT10105** - Unrecognized Race Model

- **IT10106** - Unrecognized Race Model

- **IT10107** - Unrecognized Race Model

- **IT10108** - Unrecognized Race Model

- **IT10109** - Unrecognized Race Model

- **IT10200** - Unrecognized Race Model

- **IT10201** - Unrecognized Race Model

- **IT10202** - Unrecognized Race Model

- **IT10300** - Unrecognized Race Model

- **IT10301** - Unrecognized Race Model

- **IT11001** - Unrecognized Race Model

- **IT11002** - Unrecognized Race Model

- **IT11003** - Unrecognized Race Model

- **IT11017** - Unrecognized Race Model

- **IT11500** - Unrecognized Race Model

- **IT11501** - Unrecognized Race Model

- **MINIPOM200** - Mini POM (Race 252, Gender 2)

- **Source:** loyequip.s3d (Loaded via GlobalLoad.txt)

**IT10672** - Unrecognized Race Model

- **IT10673** - Unrecognized Race Model

- **IT10674** - Unrecognized Race Model

- **IT10675** - Unrecognized Race Model

- **IT10676** - Unrecognized Race Model

- **IT10677** - Unrecognized Race Model

- **IT10678** - Unrecognized Race Model

- **IT10679** - Unrecognized Race Model

- **IT10680** - Unrecognized Race Model

- **IT10681** - Unrecognized Race Model

- **IT10682** - Unrecognized Race Model

- **IT10683** - Unrecognized Race Model

- **IT10685** - Unrecognized Race Model

- **IT10686** - Unrecognized Race Model

- **IT10687** - Unrecognized Race Model

- **IT10688** - Unrecognized Race Model

- **IT10689** - Unrecognized Race Model

- **IT10690** - Unrecognized Race Model

- **IT10691** - Unrecognized Race Model

- **IT10692** - Unrecognized Race Model

- **IT10693** - Unrecognized Race Model

- **IT10694** - Unrecognized Race Model

- **IT10695** - Unrecognized Race Model

- **IT10696** - Unrecognized Race Model

- **IT10697** - Unrecognized Race Model

- **Source:** ldonequip.s3d (Loaded via GlobalLoad.txt)

**IT10700** - Unrecognized Race Model

- **IT10701** - Unrecognized Race Model

- **IT10702** - Unrecognized Race Model

- **IT10703** - Unrecognized Race Model

- **IT10704** - Unrecognized Race Model

- **IT10705** - Unrecognized Race Model

- **IT10706** - Unrecognized Race Model

- **IT10707** - Unrecognized Race Model

- **IT10708** - Unrecognized Race Model

- **IT10709** - Unrecognized Race Model

- **IT10710** - Unrecognized Race Model

- **IT10711** - Unrecognized Race Model

- **IT10712** - Unrecognized Race Model

- **IT10713** - Unrecognized Race Model

- **IT10714** - Unrecognized Race Model

- **Source:** gatesequip.s3d (Loaded via GlobalLoad.txt)

**IT10715** - Unrecognized Race Model

- **IT10716** - Unrecognized Race Model

- **IT10717** - Unrecognized Race Model

- **IT10718** - Unrecognized Race Model

- **IT10719** - Unrecognized Race Model

- **IT10720** - Unrecognized Race Model

- **IT10722** - Unrecognized Race Model

- **IT10723** - Unrecognized Race Model

- **IT10724** - Unrecognized Race Model

- **IT10725** - Unrecognized Race Model

- **IT10726** - Unrecognized Race Model

- **IT10727** - Unrecognized Race Model

- **IT10728** - Unrecognized Race Model

- **IT10729** - Unrecognized Race Model

- **IT10730** - Unrecognized Race Model

- **IT10731** - Unrecognized Race Model

- **IT10732** - Unrecognized Race Model

- **Source:** rap_chr.s3d (Loaded via GlobalLoad.txt)

**RAP** - Raptor (Race 163, Gender 2) - Textures: **00 01**

- **Source:** dpm_chr.s3d (Loaded via GlobalLoad.txt)

**DPM** - Pirate Male (Race 339, Gender 0)

- **Source:** dpf_chr.s3d (Loaded via GlobalLoad.txt)

**DPF** - Pirate Female (Race 339, Gender 1)

- **Source:** epm_chr.s3d (Loaded via GlobalLoad.txt)

**EPM** - Pirate Male (Race 342, Gender 0)

- **Source:** epf_chr.s3d (Loaded via GlobalLoad.txt)

**EPF** - Pirate Female (Race 342, Gender 1)

- **Source:** gpm_chr.s3d (Loaded via GlobalLoad.txt)

**GPM** - Pirate Male (Race 338, Gender 0)

- **Source:** gpf_chr.s3d (Loaded via GlobalLoad.txt)

**GPF** - Pirate Female (Race 338, Gender 1)

- **Source:** hpf_chr.s3d (Loaded via GlobalLoad.txt)

**HPF** - Pirate Female (Race 341, Gender 1)

- **Source:** hpm_chr.s3d (Loaded via GlobalLoad.txt)

**HPM** - Pirate Male (Race 341, Gender 0)

- **Source:** opf_chr.s3d (Loaded via GlobalLoad.txt)

**OPF** - Pirate Female (Race 340, Gender 1)

- **Source:** opm_chr.s3d (Loaded via GlobalLoad.txt)

**OPM** - Pirate Male (Race 340, Gender 0)

- **Source:** tbm_chr.s3d (Loaded via GlobalLoad.txt)

**TBM** - Troll Male (Race 331, Gender 0)

- **Source:** tbf_chr.s3d (Loaded via GlobalLoad.txt)

**TBF** - Troll Female (Race 331, Gender 1)

- **Source:** mmm_chr.s3d (Loaded via GlobalLoad.txt)

**MMM** - Vampire Male (Race 360, Gender 0) - Textures: **00 01**, Heads: **00 01**

- **Source:** mmf_chr.s3d (Loaded via GlobalLoad.txt)

**MMF** - Vampire Female (Race 360, Gender 1) - Textures: **00 01**, Heads: **00 01**

- **Source:** tnf_chr.s3d (Loaded via GlobalLoad.txt)

**TNF** - Nihil Female (Race 385, Gender 1) - Textures: **00-04**

- **Source:** tnm_chr.s3d (Loaded via GlobalLoad.txt)

**TNM** - Nihil Male (Race 385, Gender 0) - Textures: **00-04**

- **Source:** skt_chr.s3d (Loaded via GlobalLoad.txt)

**SKT** - Skeleton (Race 367, Gender 2) - Textures: **00-04**

- **Source:** global6_chr.s3d (Loaded via GlobalLoad.txt)

**ALL** - Alligator (Race 91, Gender 2) - Textures: **00 01**, Heads: **00 01**

- **DRK** - Drake (Race 89, Gender 2) - Textures: **00-03**

- **WOF** - Chokidai (Race 356, Gender 2) - Textures: **00 01**

- **SKE** - Skeleton (Race 60, Gender 2)

- **TPN** - Teleport Man (Race 240, Gender 2)

- **TIG** - Tiger (Race 63, Gender 2)

- **WOL** - Wolf (Race 42, Gender 2) - Textures: **00-03**

- **WOE** - Wolf (Race 120, Gender 2) - Textures: **00-03**

- **Source:** global4_chr.s3d (Loaded via GlobalLoad.txt)

**IKS** - Undead Iksar (Race 161, Gender 2) - Heads: **00 01**

- **SPE** - Spectre (Race 85, Gender 2)

- **BAF** - Barbarian Female (Race 2, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **BAM** - Barbarian Male (Race 2, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **IKF** - Iksar Female (Race 128, Gender 1) - Textures: **00-04, 10**, Heads: **00-03**, Faces: **00-07**

- **IKM** - Iksar Male (Race 128, Gender 0) - Textures: **00-04, 10**, Heads: **00-03**, Faces: **00-07**

- **Source:** global_chr.s3d (Loaded via GlobalLoad.txt)

**ELE** - Elemental (Race 75, Gender 2) - Textures: **00-03**, Heads: **00 01**

- **EYE** - Eye (Race 108, Gender 2)

- **IVM** - Invisible Man of Zomm Male (Race 600, Gender 0)

- **SKE** - Skeleton (Race 60, Gender 2) - Textures: **00 01**

- **WER** - Werewolf (Race 14, Gender 2)

- **WOE** - Wolf (Race 120, Gender 2) - Textures: **00 01**

- **BOAT** - Boat (Race 141, Gender 2)

- **BAF** - Barbarian Female (Race 2, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **BAM** - Barbarian Male (Race 2, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **DAF** - Dark Elf Female (Race 6, Gender 1) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-07**

- **DAM** - Dark Elf Male (Race 6, Gender 0) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-07**

- **DWF** - Dwarf Female (Race 8, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **DWM** - Dwarf Male (Race 8, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **ERF** - Erudite Female (Race 3, Gender 1) - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**

- **ERM** - Erudite Male (Race 3, Gender 0) - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**

- **GNF** - Gnome Female (Race 12, Gender 1) - Textures: **00-03, 10-16**, Heads: **00-04**, Faces: **00-07**

- **GNM** - Gnome Male (Race 12, Gender 0) - Textures: **00-03, 10-16**, Heads: **00-04**, Faces: **00-07**

- **HAF** - Half Elf Female (Race 7, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **HAM** - Half Elf Male (Race 7, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **HOF** - Halfling Female (Race 11, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **HOM** - Halfling Male (Race 11, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **HIF** - High Elf Female (Race 5, Gender 1) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-07**

- **HIM** - High Elf Male (Race 5, Gender 0) - Textures: **00-03, 10-16**, Heads: **00-03**, Faces: **00-07**

- **HUF** - Human Female (Race 1, Gender 1) - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**

- **HUM** - Human Male (Race 1, Gender 0) - Textures: **00-04, 10-16**, Heads: **00-03**, Faces: **00-07**

- **OGF** - Ogre Female (Race 10, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **OGM** - Ogre Male (Race 10, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **TRF** - Troll Female (Race 9, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **TRM** - Troll Male (Race 9, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **ELF** - Wood Elf Female (Race 4, Gender 1) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **ELM** - Wood Elf Male (Race 4, Gender 0) - Textures: **00-03**, Heads: **00-03**, Faces: **00-07**

- **Source:** fgh_chr.s3d (Loaded via GlobalLoad.txt)

**FGH** - Froglok Ghost (Race 371, Gender 2)

- **Source:** ila_chr.s3d (Loaded via GlobalLoad.txt)

**ILA** - Ikaav (Race 394, Gender 2)

- **Source:** rpt.eqg (Loaded via GlobalLoad.txt)

**RPT** - Raptor (Race 609, Gender 2) - Textures: **00-02**

- **Source:** jkr_chr.s3d (Loaded via GlobalLoad.txt)

**JKR** - Jokester (Race 384, Gender 2) - Textures: **00-02**

- **Source:** mmy_chr.s3d (Loaded via GlobalLoad.txt)

**MMY** - Mummy (Race 368, Gender 2)

- **Source:** global2_chr.s3d (Loaded via GlobalLoad.txt)

**BEA** - Bear (Race 43, Gender 2) - Textures: **00-02**, Heads: **00-02**

- **BRI** - Bristlebane (Race 153, Gender 2)

- **CAZ** - Cazic Thule (Race 95, Gender 2) - Heads: **00 01**

- **ERO** - Erollisi (Race 150, Gender 2)

- **IMP** - Imp (Race 46, Gender 2)

- **INN** - Innoruuk (Race 123, Gender 2)

- **RAL** - Rallos Zek (Race 66, Gender 2) - Textures: **00 01**

- **SCA** - Scarecrow (Race 82, Gender 2)

- **SOL** - Solusek Ro (Race 58, Gender 2)

- **TRI** - Tribunal (Race 151, Gender 2)

- **TUN** - Tunare (Race 62, Gender 2)

---

## Consider Colors

*Source: server/npc/consider-colors/index.html*

# Consider Colors¶

| 

Consider Color ID 
| Consider Color Name 

| 2 
| Green 

| 4 
| Blue 

| 6 
| Gray 

| 10 
| White 

| 13 
| Red 

| 15 
| Yellow 

| 18 
| Light Blue 

| 20 
| White (Titanium)

---

## Consider Levels

*Source: server/npc/consider-levels/index.html*

# Consider Levels¶

| 

Consider Level ID 
| Consider Level Name 

| 1 
| Ally 

| 2 
| Warmly 

| 3 
| Kindly 

| 4 
| Amiably 

| 5 
| Indifferently 

| 6 
| Apprehensively 

| 7 
| Dubiously 

| 8 
| Threateningly 

| 9 
| Scowls

---

## Customizing NPCs

*Source: server/npc/customizing-npcs/index.html*

# Customizing NPCs¶

## Getting Started¶

So you want to create your own NPC? This is the first step in learning to customize your EQEmu Server. There are a few different resources that can help, which we will explore in detail in this guide. Please note that there are many different ways to achieve the goal of adding custom content, and that there are also advanced techniques for NPC Scaling and Scripting that will be covered in later guides.

- How to add a NPC via PEQ

- How to add a custom race (Advanced)

---

## Making a Custom Race

*Source: server/npc/customizing-npcs/making-a-custom-race/index.html*

Info

This is an advanced guide. You should be familiar with the basics of EQEmu before attempting this guide.

Here are the blockers you need to overcome to create a custom race:

- Create a custom race model

- Inject a new model name to eqgame

- Increase max race ID server side

- Add the new Race to either global or zone loading

- Spawn the new race in game

# Create a custom race model¶

There are currently a number of ways to do this, and each one has it's pros and cons. 

- Quail: This route is potentially easiest, but as of this doc writing is still buggy.

- EQGZI: This route is made for zones, and can be used with a convuluted process to get a .mod file out of the generated content and prepare to the final steps noted on this section. This is not recommended.

- EQModelImporter: This process is not documented yet

## Create model via Quail¶

- Download Blender

- Download Quail-Addon zip

- Install Blender

- Open Blender

- Go to Edit -> Preferences -> Addons -> Install

- Select the quail-addon zip file

- Enable the Quail addon

- Press `n` to open the right side panel

- A fast export menu should appear. Type in the field wtf.eqg

- Create a cube by pressing shift+a -> mesh -> cube

- Click the EverQuest tab

- Click File -> Save As, and place the blend file in your EQ directory, call it e.g. wtf.blend

- Press the fast export button. A pop up should appear with success:

## Create model via EQGZI¶

Not yet documented

# Inject a new model name to eqgame¶

Adding new model names is not easily exposed. You need to do a client side edit to inject it, unfortunately. Some ways to achieve this include:

- Edit the eqgame.exe directly (not documented yet)

- Add a dll hook to inject the new Races via dinput8.dll (recommended)

To inject the new Races via dinput8.dll, one of the easier routes is to use eq-core-dll. The setup process for this is on the README of the link, follow the steps, contact the discord on eqemu if any help, a number of folks are familiar with the process.

From now on, we're going to continue the wiki with the shortname of `WTF` and race ID of `733`, which is the next unused ID for RoF2 by default.

Once set up, inside `_options.h` you want to add the new `race shortname` and new `unique ID`, similar to this:

```
`// areCustomRacesEnabled if set to true will allow the Races defined in Races[] to be injected in game
bool areCustomRacesEnabled = false;

// Race Entry:
// raceID is the index. If it's a new Race, start at 733. You'll need to update the rule Race:MaxRaceID
// GenderID ranges from 0 to 2 usually
// modelName is the race's shortname tag
// raceMask is a range of flags, typically using 8 is safe for most Races, but e.g. 1 = drivable boat, 2 = ridable boat, etc
// dbStrID if left to 1 reverts to raceID as it's ID, otherwise you can custom set one, and it'll look up dbStr for info
static RaceEntry Races[] = {
 // raceID, genderID, modelName, raceMask, dbStrID
 RaceEntry(733, 2, "WTF", 3, 1),
};
`
```

Change `areCustomRacesEnabled` to `true`, and add your new race entry to the list. You can add as many as you want, but you'll need to update the `MaxRaceID` rule later to match the highest raceID you use.

If you're curious what existing NPCs use for race flags, this gist covers them

Once you build the solution, copy the generated `dinput8.dll`` to your EQ directory and you've now injected a new model name to eqgame.

# Increase max race ID server side¶

This step requires you to edit the rules table. You can do this via spire, peq editor, database, or via the server console. I'll assume you've played enough with eqemu to know how to edit rules already, so the changes are:

- Edit Race:MaxRaceID from 732 to your new value, 733, or higher if you added more than one Race

- Reload rules in game via #reload rule

# Add the new Race to either global or zone loading¶

Races aren't loaded by default until a txt file informs EQ to do so. The easiest routes to add a custom NPC are either via global race and zone race entries. Both are covered below.

## Global Race¶

- Inside your eq directory, go to the Resources subfolder and look for GlobalLoad_chr.txt

- On the first line, you'll see a number such as 13 by default. This is a count of how many elements follow to load. Since we're adding 1 Race, change this to 14 (or increase based on the number you have already)

- On the last line, add your new Race. It should look like this: `wtf, wtf`

## Zone Race¶

- Inside your eq directory, go to the root folder and look for a your zonename.eqg. There should be also a zonename_chr.txt. Edit it, and on top line will be the number of elements to load, increase it by one. On the last line, add your new Race. It should look like this: `wtf, wtf`

# Spawn the new race in game¶

The easiest way to spawn to test is go to a zone it loads in (or any zone if you used a global race) and type `#spawn WTF 733 1 0 10 2`. This will spawn an Race named WTF with race ID 733, level 1, and gender 2 (neutral).

# Troubleshooting¶

If you generated your .mod file in a unique way, here's a screenshot of the contents of my wtf.mod:

---

## Using the PEQ Database Editing Interface

*Source: server/npc/customizing-npcs/using-the-peq-database-editing-interface/index.html*

# Using the PEQ Database Editing Interface¶

## The NPC Tab¶

Once you have logged into your PEQ Editor, click on the NPCs tab. Here you will have the opportunity to select the desired zone, interrogate the data for existing NPCs, or explore NPC-related information, such as emotes and auras.

### Select A Zone¶

Your NPC will be create under a particular zone. Note that while you can spawn your NPC in other zones, you should pay careful attention to the available models, as an NPC will appear as a Human Male if the client does not support a particular model in a particular zone (client customization for model support is a different topic).

We will work on creating an NPC in the Tutorial (tutorialb). Select the tutorialb from the zone list pull-down:

### Choose the "Add an NPC to tutorialb" option¶

When you click the *Add an NPC to tutorialb* option, you will first have to assign a level to the NPC. Assigning a level sets default parameters for Hitpoints, mana, AC, etc.

For the purposes of this guide, we are creating a server greeter NPC. Let's assign level 1 and continue.

### Select the NPC attributes¶

A dazzling array of NPC attributes are displayed on the page. These attributes all correspond to the fields in the database where your NPC is stored. Note that many fields have been populated based on your choice of level, as well as the NPC ID--which is the next available ID in your database. Note that your values may be slightly different than the screenshot.

Explanations for each of these fields can be found on the npc_types page (opens new window) in the Database Schema documentation. 

For our Server Greeter Bot, we are going to input the NPC Name as "***Salutation_Model_XIV***", select the **457 - Gnomework** *race*, with a **5 - Construct** *bodytype* setting, *gender* **Neuter**. These options will cause the NPC to display correctly to the client. Be sure to also place a checkmark in the following boxes: **Will Not Aggro (24)**, **Immune to Aggro (25)**, and **Has Quest File**. The rest of the settings are entirely up to you. You can choose to match the settings below for the purposes of this guide. We do want our Greeter Bot to be noticeable, so we have increased the *size* to **10**. We also don't want our Greeter Bot to be accidentally killed, so we have made the NPC quite resilient by granting ridiculous HP and resist. 

### Review your NPC¶

Once you submit your selections, you can review the settings of your NPC. Note the "Is Quest NPC" indicator below the NPC Name. This indicates that this NPC will have an associated quest script, and was caused by our selection of the **Has Quest File** checkbox in the previous step. Clicking this link allows you to view (not edit) the quest script for the NPC.

You will also notice that on this screen you have the option to set NPC Faction. This step will be covered elsewhere, but is an important concept to master as you continue customizing your server. For the time being, let's leave this area alone.

Congratulations! You have completed creating your first NPC. The next step is to make the NPC appear in the world.

## Create the Spawn¶

NPCs must be assigned additional information to allow them to spawn in the world. Click on the Spawns tab to create these attributes for your NPC:

A *Spawngroup* is a grouping of one or more NPCs. A Spawngroup can have one member, which will be the case for our Greeter Bot, or it can have many members; a Spawngroup with many members can create a more random feel for your world, since the same NPC may not always appear. You can review the fields in database table on the spawngroup page (opens new window) in the Database Schema documentation.

Click on the *Click here to create a new spawngroup* link.

As with the Add an NPC step above, many values are pre-populated in the PEQ Editor to help you out. Leave the default values and click the _Submit _button.

### Review your Spawngroup¶

After you click Submit, you will be redirected to a page that allows you to review your Spawngroup. From this page, you can assign additional NPCs to the Spawngroup, delete or rename the Spawngroup, or edit the various settings for the Spawngroup itself, or the settings for the members of the Spawngroup.

Choose the link in yellow text that says *View Spawnpoints (0) for this Spawngroup.*

### Create a Spawnpoint¶

A Spawnpoint is the database entry that determines the location and behavior when the NPC spawns in the world. These values are stored in the spawn2 table in your database. You can review the fields of this table on the spawn2 page (opens new window) of the Database Schema documentation.

Since there are no Spawnpoints associated with this Spawngroup, this area is empty.

Click the *Add Spawnpoint to this Spawngroup* link.

Note that as before, some information has been pre-populated in the Spawnpoint Editor. Enter in the following values: *X:* **-162.35**, *Y:* **-152.14**, *Z:* **16.78**, *Pathgrid*: **12**. Leave the rest of the values set to their default values, and click the *Add Spawnpoint* button.

### Review your Spawnpoint¶

Once you click the *Add Spawnpoint* button, you are redirected to a page that allows you to review the settings of the Spawnpoint. Notice that the *Pathgrid* field is hypertext. If you follow this link, you are able to manipulate the pathing grid information for this Spawnpoint.

### Create a Pathgrid¶

A Pathing Grid is the mechanism that allows an NPC to appear as though it is traveling around inside of your world. This mechanism is separate from Pathing Nodes (which your NPC would follow when chasing a player after losing Line of Sight), and separate from scripted Wandering. 

The Pathing Grid has Wander types, Pause types, and a listing of Waypoints that your NPC will follow. To review the Grid fields in your database, reference the grid page (opens new window) in the Database Schema documentation. For information regarding the Waypoint entry fields in your database, reference the grid_entries page (opens new window).

Since we have not defined any information about this particular Pathing Grid, we will do so now.

### Edit the Grid¶

Begin by clicking the *edit* hyperlink in your PEQ Editor next to the word *Grid*. This screen allows you to set the Wander and Pause types. Choose *Wander Type* 0 - **Circular**, and *Pause Type* 1 - **Full**. Once you have made the selections, click the *Submit Changes* button.

### Add Grid Entries¶

Click the yellow + icon in the *Grid Entries* area on the PEQ Editor page. This will allow you to add a Waypoint. We are going to repeat this process several times to establish a nice loop for our NPC to travel.

The first Waypoint (waypoint number 0) will be our Spawnpoint, always. Enter in the values and click the *Submit Changes* button. You will be redirected to the Grid Editor review screen.

We will enter in a number of Grid Entry Waypoints. Here is a table of the values for each (note that 0 is repeated in the table, but does not have to be added a second time!). Keep clicking the yellow + sign to add each Waypoint, input the values below, and submit your changes.

| 

Number 
| X 
| Y 
| Z 
| Heading 
| Pause 

| 0 
| -162.35 
| -152.14 
| 16.78 
| -1 
| 30 

| 1 
| -132.503 
| -153.421 
| 15.9178 
| -1 
| 30 

| 2 
| -94.1068 
| -148.684 
| 14.2662 
| -1 
| 30 

| 3 
| -34.0962 
| -141.684 
| 14.7164 
| -1 
| 30 

| 4 
| 23.1549 
| -111.449 
| 13.9895 
| -1 
| 30 

| 5 
| 38.2853 
| -40.2572 
| 16.5154 
| -1 
| 30 

| 6 
| -57.144 
| -53.4567 
| 19.0392 
| -1 
| 30 

| 7 
| -94.8163 
| -2.66101 
| 20.0491 
| -1 
| 30 

| 8 
| -143.811 
| -35.4007 
| 18.8172 
| -1 
| 30 

| 9 
| -177.327 
| -82.1346 
| 19.5479 
| -1 
| 30 

Once you have completed entering all of the Grid Entry Waypoints, your screen should look like this:

Congratulations! You have created your first Pathing Grid. If you want to experiment with different locations, feel free to run around in game and make use of the #loc command to interrogate your current position. Update the Grid Entries to your desired location. The next step is to assign a quest script so that we can interact.

## Add a Quest Script¶

Unfortunately, you cannot add or edit a quest script in the PEQ Editor. There are many ways to get this information onto your server, including through your own GitHub repository. For the sake of simplicity, we will simply copy and paste a script in using Terminal in this example.

### Go to your Quests directory¶

Start by going to the TutorialB directory in your Quest Directory: `cd /home/eqemu/server/quests/tutorialb/`

### Create the File¶

Create a new file with your favorite editor: `nano Salutation_Model_XIV.pl`

### Add the Code¶

Paste in the following code (fill in the blanks!) and save:

Salutation_Model_XIV.pl

```
`#:: Zone: The Mines of Gloomingdeep (tutorialb) >> Salutation_Model_XIV (189490)

sub EVENT_SPAWN {
 quest::emote("whirs to life.");
}

sub EVENT_SAY {
 if ($text=~/hail/i) {
 quest::say("Hello $name, and welcome to the ______ server! I'm here to make your life easy, so let me know if you have any [" . quest::saylink("questions") . "], or if you'd like to [" . quest::saylink("leave") . "] the tutorial.");
 }
 elsif ($text=~/questions/i) {
 quest::say("A lot of people wonder about [" . quest::saylink("max level") . "], [" . quest::saylink("expansions") . "], [" . quest::saylink("customizations") . "], [" . quest::saylink("community") . "], [" . quest::saylink("raiding") . "], [" . quest::saylink("server difficulty") . "], [" . quest::saylink("bots") . "], [" . quest::saylink("mercs") . "], [" . quest::saylink("macroquest") . "], and [" . quest::saylink("hot zones") . "].");
 }
 elsif ($text=~/max level/i) {
 quest::say("The maximum level for the server is level ______.");
 }
 elsif ($text=~/expansions/i) {
 quest::say("All zones through the ______ expansion are available. If a zone requires a key, flag, or reagent to access it, you will have to obtain those on your own.");
 }
 elsif ($text=~/customizations/i) {
 quest::say("We have added a custom item vendor in the Planes of Knowledge--he will sell items for Chronobines to community members who [" . quest::saylink("support the server") . "]. We have included quality of life features such as autocombine for tradeskills, Guild Hall for easy travel, Shadowrest and Guild Lobby for easy corpse recovery, suspended buff timers in non-combat zones, and more!");
 }
 elsif ($text=~/support the server/i) {
 quest::say("Please take a look at our forums and our wiki for more information on contributing to the community. We reward players with Chronobines for their contributions on bug reports, wiki pages, helping others, and having a great attitude. We're also happy to accept donations to help offset the cost of server hosting.");
 }
 elsif ($text=~/community/) {
 quest::say("______ has a great community--many people here will help you to adventure, provide you with buffs, give you items, or even just take the time to give you help if you have a question. OOC is a global channel, so please feel free to use /ooc if you have a question.");
 }
 elsif ($text=~/raiding/i) {
 quest::say("Raid content is 'legit' and will require raid forces to defeat. We promote a healthy and competitive raid environment and will instance content as needed so that everyone can enjoy the end-game content equally.");
 }
 elsif ($text=~/server difficulty/i) {
 quest::say("There is a server xp bonus to make leveling easier. We often offer periods of double-loot and/or double-xp. Please check our forums for the most up to date information. You can also adventure in [" . quest::saylink("hot zones") . "] if you'd like to progress at even faster rates!");
 }
 elsif ($text=~/hot zones/i) {
 quest::say("Each month (or so) our hot zones rotate. Please pay a visit to my friend, Franklin Teek, in the Plane of Knowledge for the most up to date information. You'll find him by the port in area.");
 }
 elsif ($text=~/bots/i) {
 quest::say("We do not use bots on this server. You are allowed to box three characters at the same time.");
 }
 elsif ($text=~/mercs/i) {
 quest::say("We do not use mercs on this server. You are allowed to box three characters at the same time.");
 }
 elsif ($text=~/macroquest/i) {
 quest::say("We do not allow the use of MacroQuest on this server. Please do not make us ask you to stop using it! We ask that one input from you leads to one output from your character. There are many EQEmu servers that encourage and allow the use of MacroQuest, so please explore them if you find that you cannot play without it.");
 }
 elsif ($text=~/leave/i) {
 quest::say("I have been programmed to help you leave if you wish to [" . quest::saylink("exit the tutorial") . "]. I will transport you to the Plane of Knowledge. Please note that you will not be able to re-enter the tutorial once you have reached level 16. Also, there are some custom items that can be found here--don't rush to leave!");
 }
 elsif ($text=~/exit the tutorial/i) {
 #:: Teleport player to the succor point in the Plane of Knowledge (202 - poknowledge)
 quest::movepc(202,-285,-148,-159);
 }
}

sub EVENT_WAYPOINT_ARRIVE {
 if ($wp == 2) {
 quest::emote("clicks and whirs");
 }
 elsif ($wp == 5) {
 quest::say("Initiate buff and heal program XI.");
 quest::emote("begins to glow.");
 #:: Cast 2087 - Greater Infusion, 189490 == self
 $npc->CastSpell(2087, 189490);
 }
 elsif ($wp == 10) {
 quest::emote("whirs and clicks");
 }
}

#:: Zone: The Mines of Gloomingdeep (tutorialb) >> Salutation_Model_XIV (189490)
`
```

Congratulations! You have added your first quest script to your first NPC! The next step is to get into the world and see this bot in action.

## In Game Steps¶

If you're hanging out in The Mines of Gloomingdeep, you can issue three commands to get your bot to spawn. Be sure to review the In Game Command Reference (opens new window) if you're not sure what all of these do.

```
`#hotfix
#reloadquest
#repop
`
```

This will bring over all of your NPC settings, reload your quest files and repop the zone. At this point your should see your new NPC!

Your NPC should begin to path around and will respond to your messages as indicated in the quest script.

---

## Emote Event Types

*Source: server/npc/emote-event-types/index.html*

# Emote Event Types¶

| 

Emote Event Type ID 
| Emote Event Type Name 

| 0 
| Leave Combat 

| 1 
| Enter Combat 

| 2 
| On Death 

| 3 
| After Death 

| 4 
| Hailed 

| 5 
| Killed PC 

| 6 
| Killed NPC 

| 7 
| On Spawn 

| 8 
| On Despawn

---

## Emote Types

*Source: server/npc/emote-types/index.html*

# Emote Types¶

| 

Emote Type ID 
| Emote Type Name 

| 1 
| Emote 

| 2 
| Shout 

| 3 
| Proximity Emote, Other - Say

---

## Facial Features

*Source: server/npc/facial-features/index.html*

# Facial Features¶

Some Feature Settings on certain races are based on multiples of 10 from the face setting. Here is the list of which races use which settings from face:

## **Barbarian**¶

Tattoo/Woad is based on multiples of 10 from the face setting. Since there are 8 faces and 9 Tattoo variations, faces range from 0 to 87 (9th tattoo and 8th face).

## Erudite¶

Hair Style is based on multiples of 10 from the face setting. Both Male and Female have 8 faces, but Males have only 6 hair styles while Females have 9.** **Male max face is 57 (6th hair style and 8th face), while Female is 87 (9th hair style and 8th face).

## High Elf, Dark Elf, Half Elf¶

Beard (Male Only) is based on multiples of 10 from the face setting. Each Elf race only has 4 beard styles and they all have 8 faces, so the max face setting is 37 (4th beard and 8th face).

## Female Dwarf¶

Beard is based on multiples of 10 from the face setting. Female Dwarf has 8 faces, but only 2 beard styles so the max face setting is 17 (2nd beard and 8th face).

| 

Race 
| Sex 
| Face 
| Hair 
| Hair Color 
| Eyes 
| Beard 
| Beard Color 
| Tattoo 
| Details 
| Heritage 

| Drakkin 
| M 
| 7 
| 9 
| 4 
| 12 
| 12 
| 4 
| 8 
| 8 
| 7 

| Drakkin 
| F 
| 7 
| 8 
| 4 
| 12 
| 4 
| 4 
| 8 
| 8 
| 7 

| Froglok 
| M 
| 10 
| 
| 
| 10 
| 
| 
| 
| 
| 

| Froglok 
| F 
| 10 
| 
| 
| 10 
| 
| 
| 
| 
| 

| Woodelf 
| M 
| 8 
| 4 
| 20 
| 10 
| 
| 
| 
| 
| 

| Woodelf 
| F 
| 8 
| 3 
| 20 
| 10 
| 
| 
| 
| 
| 

| Vah Shir 
| M 
| 8 
| 
| 
| 10 
| 
| 
| 
| 
| 

| Vah Shir 
| F 
| 8 
| 
| 
| 10 
| 
| 
| 
| 
| 

| Troll 
| M 
| 8 
| 
| 
| 11 
| 
| 
| 
| 
| 

| Troll 
| F 
| 8 
| 4 
| 24 
| 11 
| 
| 
| 
| 
| 

| Ogre 
| M 
| 8 
| 
| 
| 10 
| 
| 
| 
| 
| 

| Ogre 
| F 
| 8 
| 4 
| 24 
| 10 
| 
| 
| 
| 
| 

| Iksar 
| M 
| 8 
| 
| 
| 10 
| 
| 
| 
| 
| 

| Iksar 
| F 
| 8 
| 
| 
| 10 
| 
| 
| 
| 
| 

| Human 
| M 
| 8 
| 4 
| 20 
| 10 
| 6 
| 20 
| 
| 
| 

| Human 
| F 
| 8 
| 3 
| 20 
| 10 
| 
| 
| 
| 
| 

| High Elf 
| M 
| 8 
| 4 
| 15 
| 10 
| 4 
| 15 
| 
| 
| 

| High Elf 
| F 
| 8 
| 3 
| 15 
| 10 
| 
| 
| 
| 
| 

| Halfling 
| M 
| 8 
| 4 
| 20 
| 10 
| 6 
| 20 
| 
| 
| 

| Halfling 
| F 
| 8 
| 3 
| 20 
| 10 
| 
| 
| 
| 
| 

| Half Elf 
| M 
| 8 
| 4 
| 20 
| 10 
| 4 
| 20 
| 
| 
| 

| Half Elf 
| F 
| 8 
| 3 
| 20 
| 10 
| 
| 
| 
| 
| 

| Gnome 
| M 
| 8 
| 4 
| 24 
| 10 
| 6 
| 24 
| 
| 
| 

| Gnome 
| F 
| 8 
| 3 
| 24 
| 10 
| 
| 
| 
| 
| 

| Erudite 
| M 
| 8 
| 6 
| 
| 10 
| 6 
| 20 
| 
| 
| 

| Erudite 
| F 
| 8 
| 9 
| 
| 10 
| 
| 
| 
| 
| 

| Dwarf 
| M 
| 8 
| 4 
| 20 
| 10 
| 6 
| 20 
| 
| 
| 

| Dwarf 
| F 
| 8 
| 3 
| 20 
| 10 
| 2 
| 20 
| 
| 
| 

| Dark Elf 
| M 
| 8 
| 4 
| 10 
| 10 
| 4 
| 10 
| 
| 
| 

| Dark Elf 
| F 
| 8 
| 3 
| 10 
| 10 
| 
| 
| 
| 
| 

| Barbarian 
| M 
| 8 
| 4 
| 20 
| 10 
| 6 
| 20 
| 9 
| 
| 

| Barbarian 
| F 
| 8 
| 3 
| 20 
| 10 
| 
| 
| 9 
| 
|

---

## Fly Modes

*Source: server/npc/fly-modes/index.html*

# Fly Modes¶

| 

Fly Mode ID 
| Fly Mode Name 

| 0 
| Ground 

| 1 
| Flying 

| 2 
| Levitating 

| 3 
| Water 

| 4 
| Floating 

| 5 
| Levitate While Running

---

## Mob Version List

*Source: server/npc/mob-version-list/index.html*

# Mob Version List¶

This list is fluid and may not reflect final implementation.

| 

Mob 
| Value 

| Unknown 
| 0 

| Client62* 
| 1 

| Titanium 
| 2 

| SoF 
| 3 

| SoD 
| 4 

| UF 
| 5 

| RoF 
| 6 

| RoF2 
| 7 

| NPC 
| 8 

| NPCMerchant 
| 9 

| Merc 
| 10 

| Bot 
| 11 

| ClientPet 
| 12 

| NPCPet 
| 13 

| MercPet 
| 14 

| BotPet 
| 15 

| OfflineTitanium 
| 16 

| OfflineSoF 
| 17 

| OfflineSoD 
| 18 

| OfflineUF 
| 19 

| OfflineRoF 
| 20 

| OfflineRoF2 
| 21 

`*` Client is no longer supported. Value is kept as a placeholder.

---

## ModifyNPCStat Identifiers

*Source: server/npc/modifynpcstat-identifiers/index.html*

# ModifyNPCStat Identifiers¶

| 

NPC Stats 

| ac 

| str 

| sta 

| agi 

| dex 

| wis 

| _int 

| cha 

| max_hp 

| max_mana 

| mr 

| fr 

| cr 

| pr 

| dr 

| runspeed 

| special_attacks 

| special_abilities 

| attack_speed 

| attack_delay 

| atk 

| accuracy 

| avoidance 

| trackable 

| min_hit 

| max_hit 

| attack_count 

| see_invis 

| see_invis_undead 

| see_hide 

| see_improved_hide 

| hp_regen 

| mana_regen 

| level 

| aggro 

| assist 

| slow_mitigation 

| loottable_id 

| healscale 

| spellscale 

| npc_spells_id 

| npc_spells_effects_id

---

## NPC Aggro

*Source: server/npc/npc-aggro/index.html*

# NPC Aggro¶

Let's create a new faction. For this example, the NPCs on this faction will be KOS to all PCs except Erudites, whom they will con amiable. These NPCs will also attack other NPCs whom primary faction is Heretic. If anyone kills these NPCs, we will have them lose 10 points of faction with their faction (the new one we're creating) and gain 5 points with Heretic.

### Create the new base faction to faction_list.¶

Create a new entry in faction_list. Since we want them to start out KOS to everyone except Erudites, set their base value to -1000. This is barely KOS, so if you want to force more faction work to get above KOS, set is that much lower. 

See table below:

| 

Faction Value 
| Faction CON 

| 1100 -> ABOVE 
| ALLY 

| 750 -> 1099 
| WARMLY 

| 500 -> 749 
| KINDLY 

| 100 -> 400 
| AMIABLE 

| 0 -> 99 
| INDIFFERENT 

| -100 -> -1 
| APPREHENSIVE 

| -500 -> -101 
| DUBIOUS 

| -750 -> -501 
| THREATENLY 

| BELOW -> -751 
| SCOWLS 

### Create the new npc_faction.¶

Create the new entry in npc_faction. This will be an umbrella for NPC behavior entries. Remember, this is different from the entry in faction_list. faction_list only identifies a core faction. npc_faction identifies a subset of NPCs on a faction in faction_list that have a prescribed behavior. There can be many npc_faction entries providing different behavior for NPCs, even though all those NPCs have the same code faction_list assignment. The key fields in npc_faction are primary_faction (which you will assign to the new faction you created in step 1) and ingnore_primary_assist which you will set to 1 or 0 depending on whether you want NPCs under this umbrella to assist other NPCs on the same faction_list allegiance.

### Create new faction_list_mod entries to account for the Erudite loving aspect.¶

So we wanted our new NPCs to like Erudites. We do this by adding an entry to faction_list_mod. This applies to any and all NPCs that refer back to the new faction_list entry. So we add an entry, using the faction_list value we created in step 1, a mod_name ([rcd]#) and a value. We want Erudites to be amiable to start. So we need to get them from -1000 up to at least 101. Depending on where you want them in the amiable range, the mod would be something like 1101+. So the new entry would be (id, (step 1 id), 1101, r3). Erudites are race 3.

### Create how the new npc_faction reacts to other NPCS and PCs via npc_faction_entries.¶

So we decided we want the NPCs under the new npc_faction umbrella to attack other NPCs whose primary faction_list faction is Heretic (143). To do this, we add an npc_faction_entries entry. For us, this would be (step 2 id, 143, 5, -1, 0). This indicates that all NPCs under the umbrella we created in step 2, will attack NPCs that are under any umbrella that has a primary_faction of 143. The -1 indicates attack. If we changed that to 1 it would mean assist. A 0 in that field would mean ignore. The faction_hit is set to +5 so that if a PC kills one of our mobs, their faction with Heretic will go up. We also need to add a line for our own faction, so that PCs killing our NPCs will lose faction for that. That entry would look like (step 2 id, step 1 id, 10, 1, 0).

As the npc_faction_entries documentation mentions, these table entries serve dual purpose and might be better served as separate tables.

### Assign NPCs to the new npc_faction in the npc_types table.¶

Simply change the npc_faction_id field for your NPCs to the new id from the second step.

### Making them fight.¶

Since we want these NPCs to attack other NPCs, change the npc_types entry for any NPC assigned to this faction so npc_aggro is set to 1. This field must be set to enable these NPCs to agro other NPCs.

---

## NPC Animation Types

*Source: server/npc/npc-animation-types/index.html*

# NPC Animation Types¶

| 

NPC Animation Type ID 
| NPC Animation Type Name 

| 0 
| Standing 

| 1 
| Sitting 

| 2 
| Crouching 

| 3 
| Laying 

| 4 
| Looting

---

## NPC Models

*Source: server/npc/npc-models/index.html*

# NPC Models¶

Below is a list of NPC Race Models that are used in the _chr text files in the client

For a more comprehensive client-side modding list, check out Race Files

| 

**Race ID** 
| **Model Code** 
| **File Loaded From** 
| **Race** 

| 8 
| dwm 
| 
| Dwarf 

| 13 
| avi 
| southkarana_chr 
| Aviak 

| 14 
| wer 
| 
| Werewolf 

| 15 
| brm 
| lfaydark_chr 
| Brownie 

| 16 
| cem 
| 
| Centaur 

| 17 
| gom 
| velketor_chr 
| Golem 

| 18 
| gia 
| commons_chr 
| Giant 

| 19 
| trk 
| hateplane_chr 
| Trakanon 

| 20 
| vst 
| karnor_chr 
| Venril Sathir 

| 21 
| beh 
| fearplane_chr 
| Evil Eye 

| 22 
| bet 
| ecommons_chr 
| Beetle 

| 23 
| cpm 
| warrens_chr 
| Kerran 

| 24 
| fis 
| tox_chr 
| Fish 

| 25 
| fam 
| 
| Fairy 

| 26 
| fro 
| gukbottom_chr 
| Froglok 

| 27 
| frg 
| gukbottom_chr 
| Froglok 

| 28 
| fun 
| unrest_chr 
| Fungusman 

| 29 
| gam 
| velketor_chr 
| Gargoyle 

| 30 
| beh 
| fearplane_chr 
| Gasbag 

| 31 
| cub 
| fearplane_chr 
| Gelatinous Cube 

| 32 
| ghm 
| 
| Ghost 

| 33 
| ghu 
| commons_chr 
| Ghoul 

| 34 
| bat 
| bat 
| Bat 

| 36 
| rat 
| butcher_chr 
| Rat 

| 37 
| sna 
| ecommons_chr 
| Snake 

| 38 
| spi 
| ecommons_chr 
| Spider 

| 39 
| gnn 
| blackburrow_chr 
| Gnoll 

| 40 
| gob 
| commons_chr 
| Goblin 

| 41 
| gor 
| cazicthule_chr 
| Gorilla 

| 42 
| wom 
| 
| Wolf 

| 43 
| bea 
| rivervale_chr 
| Bear 

| 44 
| fpm 
| freporte_chr 
| Guard 

| 45 
| dml 
| charasis_chr 
| Demi Lich 

| 46 
| imp 
| soldungb_chr 
| Imp 

| 47 
| gri 
| commons_chr 
| Griffin 

| 48 
| kob 
| warrens_chr 
| Kobold 

| 49 
| dra 
| dra_chr 
| Dragon 

| 50 
| lim 
| eastkarana_chr 
| Lion 

| 51 
| liz 
| oot_chr 
| Lizard Man 

| 52 
| mim 
| mim_chr 
| Mimic 

| 53 
| min 
| steamfont_chr 
| Minotaur 

| 54 
| orc 
| sro_chr 
| Orc 

| 55 
| bgm 
| oasis_chr 
| Beggar 

| 56 
| pim 
| 
| Pixie 

| 57 
| drm 
| pojustice_chr 
| Drachnid 

| 58 
| sol 
| soltemple_chr 
| Solusek Ro 

| 59 
| bgg 
| lakeofillomen_chr 
| Goblin 

| 60 
| ske 
| povalor_chr 
| Skeleton 

| 61 
| sha 
| oot_chr 
| Shark 

| 62 
| tun 
| 
| Tunare 

| 63 
| tig 
| tox_chr 
| Tiger 

| 64 
| tre 
| southkarana_chr 
| Treant 

| 65 
| dvm 
| mistmoore_chr 
| Vampire 

| 66 
| ral 
| potactics_chr 
| Rallos Zek 

| 67 
| hhm 
| highkeep_chr 
| Human 

| 68 
| tem 
| tem_cht 
| Tentacle Terror 

| 69 
| wil 
| ecommons_chr 
| Will-O-Wisp 

| 70 
| zom 
| innothule_chr 
| Zombie 

| 71 
| qcm 
| qeynos_chr 
| Human 

| 73 
| launch 
| 
| Launch 

| 74 
| pir 
| tox_chr 
| Piranha 

| 75 
| ele 
| poair_chr 
| Elemental 

| 76 
| pum 
| pum_chr 
| Puma 

| 77 
| ngm 
| neriaka_chr 
| Dark Elf 

| 78 
| egm 
| erudnint_chr 
| Erudite 

| 79 
| bix 
| kithicor_chr 
| Bixie 

| 80 
| rea 
| karnor_chr 
| Reanimated Hand 

| 81 
| rim 
| misty_chr 
| Halfling 

| 82 
| sca 
| eastkarana_chr 
| Scarecrow 

| 83 
| sku 
| butcher_chr 
| Skunk 

| 84 
| sne 
| 
| Snake Elemental 

| 85 
| spe 
| unrest_chr 
| Spectre 

| 86 
| sph 
| rathemtn_chr 
| Sphinx 

| 87 
| arm 
| oggok_chr 
| Armadillo 

| 88 
| clm 
| steamfont_chr 
| Clockwork Gnome 

| 89 
| drk 
| westwastes_chr 
| Drake 

| 90 
| hlm 
| halas_chr 
| Barbarian 

| 91 
| all 
| timorous_chr 
| Alligator 

| 92 
| grm 
| oggok_chr 
| Troll 

| 93 
| okm 
| oggok_chr 
| Ogre 

| 94 
| kam 
| kaladimb_chr 
| Dwarf 

| 95 
| caz 
| unrest_chr 
| Cazic Thule 

| 96 
| coc 
| dreadlands_chr 
| Cockatrice 

| 97 
| dia 
| 
| Daisy Man 

| 98 
| vsm 
| potimeb_chr 
| Vampire 

| 99 
| den 
| potimeb_chr 
| Amygdalan 

| 100 
| der 
| unrest_chr 
| Dervish 

| 101 
| efr 
| soltemple_chr 
| Efreeti 

| 102 
| frt 
| innothule_chr 
| Tadpole 

| 103 
| ked 
| kedge_chr 
| Kedge 

| 104 
| lee 
| westwastes_chr 
| Leech 

| 105 
| swo 
| kedge_chr 
| Swordfish 

| 106 
| fem 
| gfaydark_chr 
| Guard 

| 107 
| mam 
| southkarana_chr 
| Mammoth 

| 108 
| eye 
| qeynos_chr 
| Eye 

| 109 
| was 
| gfaydark_chr 
| Wasp 

| 110 
| mer 
| oot_chr 
| Mermaid 

| 111 
| har 
| steamfont_chr 
| Harpy 

| 112 
| gfm 
| gfaydark_chr 
| Guard 

| 113 
| dri 
| firiona_chr 
| Drixie 

| 114 
| gsp 
| 
| Ghost Ship 

| 115 
| cla 
| 
| Clam 

| 116 
| sea 
| twilight_chr 
| Seahorse 

| 117 
| gdm 
| unrest_chr 
| Ghost 

| 118 
| gem 
| paineel_chr 
| Ghost 

| 119 
| stc 
| trakanon_chr 
| Sabertooth 

| 120 
| woe 
| 
| Wolf 

| 121 
| grg 
| fearplane_chr 
| Gorgon 

| 122 
| dru 
| hateplane_chr 
| Dragon 

| 123 
| inn 
| unrest_chr 
| Innoruuk 

| 124 
| uni 
| lfaydark_chr 
| Unicorn 

| 125 
| peg 
| southkarana_chr 
| Pegasus 

| 126 
| dji 
| dji_chr 
| Djinn 

| 127 
| ivm 
| qeynos_chr 
| Invisible Man 

| 129 
| scr 
| scr_chr 
| Scorpion 

| 131 
| srw 
| lakeofillomen_chr 
| Sarnak 

| 132 
| dlk 
| 
| Draglock 

| 133 
| lyc 
| dreadlands_chr 
| Drolvarg 

| 134 
| mos 
| cazicthule_chr2 
| Mosquito 

| 135 
| rhi 
| overthere_chr 
| Rhinoceros 

| 136 
| xal 
| karnor_chr 
| Xalgoz 

| 137 
| kgo 
| lakeofillomen_chr 
| Goblin 

| 138 
| yet 
| warslikswood_chr 
| Yeti 

| 139 
| icm 
| warslikswood_chr 
| Iksar 

| 140 
| fgi 
| dreadlands_chr 
| Giant 

| 144 
| brn 
| nurga_chr 
| Burynai 

| 145 
| goo 
| goo_chr 
| Goo 

| 146 
| ssn 
| karnor_chr 
| Sarnak Spirit 

| 147 
| sim 
| karnor_chr 
| Iksar Spirit 

| 148 
| bac 
| kedge_chr 
| Fish 

| 149 
| isc 
| overthere_chr 
| Scorpion 

| 150 
| ero 
| 
| Erollisi 

| 151 
| tri 
| 
| Tribunal 

| 152 
| ber 
| 
| Bertoxxulous 

| 153 
| bri 
| bri 
| Bristlebane 

| 154 
| fdr 
| fdr_chr 
| Fay Drake 

| 155 
| ssk 
| lakeofillomen_chr 
| Undead Sarnak 

| 156 
| vrm 
| pojustice_chr 
| Ratman 

| 157 
| wyv 
| wyv_chr 
| Wyvern 

| 158 
| wur 
| wur 
| Wurm 

| 159 
| dev 
| swampofnohope_chr 
| Devourer 

| 160 
| ikg 
| karnor_chr 
| Iksar Golem 

| 161 
| iks 
| lakeofillomen_chr 
| Undead Iksar 

| 162 
| mep 
| trakanon_chr 
| Man-Eating Plant 

| 163 
| rap 
| wakening_chr 
| Raptor 

| 164 
| sgo 
| lakeofillomen_chr 
| Sarnak Golem 

| 165 
| sed 
| sed_chr 
| Dragon 

| 166 
| ikh 
| karnor_chr 
| Animated Hand 

| 167 
| suc 
| overthere_chr 
| Succulent 

| 168 
| fmo 
| fmo_chr 
| Holgresh 

| 169 
| btm 
| westwastes_chr 
| Brontotherium 

| 170 
| sde 
| 
| Snow Dervish 

| 171 
| diw 
| diw 
| Dire Wolf 

| 172 
| mtc 
| mtc_chr 
| Manticore 

| 173 
| tot 
| postorms_chr 
| Totem 

| 174 
| spc 
| frozenshadow_chr 
| Ice Spectre 

| 175 
| ena 
| frozenshadow_chr 
| Enchanted Armor 

| 176 
| sbu 
| eastwastes_chr 
| Snow Rabbit 

| 177 
| wal 
| sirens_chr 
| Walrus 

| 178 
| rgm 
| rgm_chr 
| Geonid 

| 181 
| yak 
| wakening_chr 
| Yakkar 

| 182 
| fan 
| 
| Faun 

| 183 
| com 
| thurgadina_chr 
| Coldain 

| 184 
| dr2 
| dr2_chr 
| Dragon 

| 185 
| hag 
| frozenshadow_chr 
| Hag 

| 186 
| hip 
| 
| Hippogriff 

| 187 
| sir 
| sirens_chr 
| Siren 

| 188 
| fsg 
| westwastes_chr 
| Giant 

| 189 
| stg 
| westwastes_chr 
| Giant 

| 190 
| otm 
| thurgadina_chr 
| Othmir 

| 191 
| wlm 
| warrens_chr 
| Ulthork 

| 192 
| ccd 
| ccd_chr 
| Dragon 

| 193 
| abh 
| abh 
| Abhorrent 

| 194 
| stu 
| stu_chr 
| Sea Turtle 

| 195 
| bwd 
| bwd_chr 
| Dragon 

| 196 
| gdr 
| gdr_chr 
| Dragon 

| 197 
| ron 
| 
| Ronnie Test 

| 198 
| pri 
| pri_chr 
| Dragon 

| 199 
| skn 
| skn_chr 
| Shik'Nar 

| 200 
| rhp 
| sharvahl_chr 
| Rockhopper 

| 201 
| unb 
| unb_chr 
| Underbulk 

| 202 
| gmm 
| tenebrous_chr 
| Grimling 

| 203 
| vac 
| vac_chr 
| Worm 

| 204 
| ecs 
| 
| Evan Test 

| 205 
| kha 
| ssratemple_chr 
| Shadel 

| 206 
| owb 
| paludal_chr 
| Owlbear 

| 207 
| rnb 
| shadeweaver_chr 
| Rhino Beetle 

| 208 
| vpm 
| tenebrous_chr 
| Vampire 

| 209 
| eel 
| eel_chr 
| Earth Elemental 

| 210 
| ael 
| 
| Air Elemental 

| 211 
| wel 
| torgiran_chr 
| Water Elemental 

| 212 
| fel 
| solrotower_chr 
| Fire Elemental 

| 213 
| wet 
| twilight_chr 
| Wetfang Minnow 

| 214 
| tho 
| thedeep_chr 
| Thought Horror 

| 215 
| teg 
| umbral_chr 
| Tegi 

| 216 
| hsm 
| 
| Horse 

| 217 
| shm 
| ssratemple_chr 
| Shissar 

| 218 
| fug 
| povalor_chr 
| Fungal Fiend 

| 219 
| vol 
| tenebrous_chr 
| Vampire 

| 220 
| sgr 
| sgr_chr 
| Stonegrabber 

| 221 
| sch 
| scarlet_chr 
| Scarlet Cheetah 

| 222 
| zel 
| umbral_chr 
| Zelniak 

| 223 
| lcr 
| podisease_chr 
| Lightcrawler 

| 224 
| sdm 
| griegsend_chr 
| Shade 

| 225 
| snn 
| snn_chr 
| Sunfbelow 

| 226 
| srv 
| acrylia_chr 
| Sun Revenant 

| 227 
| shr 
| fungusgrove_chr 
| Shrieker 

| 228 
| gal 
| umbral_chr 
| Galorian 

| 229 
| net 
| umbral_chr 
| Netherbian 

| 230 
| akm 
| vexthal_chr 
| Akheva 

| 231 
| spr 
| spr 
| Grieg Veneficus 

| 232 
| sow 
| tenebrous_chr 
| Sonic Wolf 

| 233 
| gsm 
| 
| Ground Shaker 

| 234 
| kes 
| umbral_chr 
| Vah Shir Skeleton 

| 235 
| muh 
| muh_chr 
| Wretch 

| 236 
| ser 
| 
| Seru 

| 237 
| rem 
| rem_chr 
| Recuso 

| 238 
| vsk 
| 
| Vah Shir 

| 239 
| vsg 
| 
| Guard 

| 240 
| tpm 
| 
| Teleport Man 

| 241 
| luj 
| luj_chr 
| Werewolf 

| 242 
| nyd 
| nyd_chr 
| Nymph 

| 243 
| nym 
| nym_chr 
| Dryad 

| 244 
| trn 
| trn_chr 
| Treant 

| 245 
| wrf 
| wrf_chr 
| Fly 

| 246 
| tmr 
| powater_chr 
| Tarew Marr 

| 247 
| sro 
| sro_chr 
| Solusek Ro 

| 248 
| clg 
| clg 
| Clockwork Golem 

| 249 
| clb 
| clb_chr 
| Clockwork Brain 

| 250 
| skb 
| ponightmare_chr 
| Banshee 

| 251 
| goj 
| pojustice_chr 
| Guard of Justice 

| 253 
| dsb 
| potimeb_chr 
| Diseased Fiend 

| 254 
| srg 
| solrotower_chr 
| Solusek Ro Guard 

| 255 
| btx 
| codecay_chr 
| Bertoxxulous 

| 256 
| tbu 
| pojustice_chr 
| The Tribunal 

| 257 
| trt 
| nightmareb_chr 
| Terris Thule 

| 258 
| veg 
| veg_chr 
| Vegerog 

| 259 
| cro 
| ponightmare_chr 
| Crocodile 

| 260 
| nbt 
| ponightmare_chr 
| Bat 

| 261 
| slg 
| powater_chr 
| Hraquis 

| 262 
| trq 
| 
| Tranquilion 

| 263 
| tin 
| poinnovation_chr 
| Tin Soldier 

| 264 
| nmw 
| ponightmare_chr 
| Nightmare Wraith 

| 265 
| mal 
| mal_chr 
| Malarian 

| 266 
| kop 
| potimeb_chr 
| Knight of Pestilence 

| 267 
| lep 
| podisease_chr 
| Lepertoloth 

| 268 
| bub 
| podisease_chr 
| Bubonian 

| 269 
| buu 
| podisease_chr 
| Bubonian Underling 

| 270 
| pus 
| pus_chr 
| Pusling 

| 271 
| wmp 
| wmp_chr 
| Water Mephit 

| 272 
| str 
| str_chr 
| Stormrider 

| 273 
| jub 
| poinnovation_chr 
| Junk Beast 

| 274 
| brc 
| brc 
| Broken Clockwork 

| 275 
| glc 
| poinnovation_chr 
| Giant Clockwork 

| 276 
| cwb 
| poinnovation_chr 
| Clockwork Beetle 

| 277 
| nmg 
| ponightmare_chr 
| Nightmare Goblin 

| 278 
| kar 
| postorms_chr 
| Karana 

| 279 
| brv 
| brv_chr 
| Blood Raven 

| 280 
| ggl 
| ggl_chr 
| Nightmare Gargoyle 

| 281 
| moi 
| potorment_chr 
| Mouth of Insanity 

| 282 
| hss 
| 
| Skeletal Horse 

| 283 
| sar 
| potorment_chr 
| Saryrn 

| 284 
| fen 
| pofire_chr 
| Fennin Ro 

| 285 
| trw 
| trw_chr 
| Tormentor 

| 286 
| npt 
| ponightmare_chr 
| Soul Devourer 

| 287 
| nmh 
| solrotower_chr 
| Nightmare 

| 288 
| raz 
| powar_chr 
| Rallos Zek 

| 289 
| vaz 
| powar_chr 
| Vallon Zek 

| 290 
| taz 
| powar_chr 
| Tallon Zek 

| 291 
| amp 
| poair_chr 
| Air Mephit 

| 292 
| emp 
| emp_chr 
| Earth Mephit 

| 293 
| fmp 
| fmp_chr 
| Fire Mephit 

| 294 
| nmp 
| ponightmare_chr 
| Nightmare Mephit 

| 295 
| zeb 
| potimeb_chr 
| Zebuxoruk 

| 296 
| mar 
| hohonorb_chr 
| Mithaniel Marr 

| 297 
| udk 
| udk_chr 
| Undead Knight 

| 298 
| rth 
| poearthb_chr 
| The Rathe 

| 299 
| xeg 
| poair_chr 
| Xegony 

| 300 
| gtd 
| gtd_chr 
| Fiend 

| 301 
| ont 
| 
| Test Object 

| 302 
| crb 
| crb_chr 
| Crab 

| 303 
| phx 
| solrotower_chr 
| Phoenix 

| 304 
| tmt 
| tmt_chr 
| Dragon 

| 305 
| pbr 
| pbr_chr 
| Bear 

| 306 
| sta 
| sta 
| Giant 

| 307 
| ssa 
| postorms_chr 
| Giant 

| 308 
| skr 
| postorms_chr 
| Giant 

| 309 
| svo 
| postorms_chr 
| Giant 

| 310 
| sma 
| postorms_chr 
| Giant 

| 311 
| stf 
| stf_chr 
| Giant 

| 312 
| sce 
| postorms_chr 
| Giant 

| 313 
| wrw 
| potactics_chr 
| War Wraith 

| 314 
| wru 
| hohonora_chr 
| Wrulon 

| 315 
| krk 
| krk_chr 
| Kraken 

| 316 
| paf 
| paf_chr 
| Poison Frog 

| 317 
| qzt 
| 
| Nilborien 

| 318 
| val 
| potactics_chr 
| Valorian 

| 319 
| wrb 
| powar_chr 
| War Boar 

| 320 
| efe 
| efe_chr 
| Efreeti 

| 321 
| wbu 
| wbu_chr 
| War Boar 

| 322 
| bkn 
| povalor_chr 
| Valorian 

| 323 
| aam 
| aam 
| Animated Armor 

| 324 
| udf 
| 
| Undead Footman 

| 325 
| rzm 
| powar_chr 
| Rallos Zek Minion 

| 326 
| spd 
| spd_chr 
| Arachnid 

| 327 
| spl 
| povalor_chr 
| Crystal Spider 

| 328 
| zbc 
| 
| Zebuxoruk's Cage 

| 329 
| btp 
| 
| BoT Portal 

| 331 
| tbm 
| tbm_chr 
| Troll 

| 332 
| fbm 
| fbm_chr 
| Troll 

| 333 
| tsm 
| tsm_chr 
| Troll 

| 334 
| spb 
| spb 
| Ghost 

| 335 
| tpb 
| tpb_chr 
| Pirate 

| 336 
| tvp 
| tvp_chr 
| Pirate 

| 337 
| tpo 
| tpo_chr 
| Pirate 

| 338 
| gpm 
| gpm_chr 
| Pirate 

| 339 
| dpm 
| dpm_chr 
| Pirate 

| 340 
| opm 
| opm_chr 
| Pirate 

| 341 
| hpm 
| hpm_chr 
| Pirate 

| 342 
| epm 
| epm_chr 
| Pirate 

| 343 
| rpf 
| 
| Frog 

| 344 
| tzm 
| tzm_chr 
| Troll Zombie 

| 345 
| lug 
| lug_chr 
| Luggald 

| 346 
| lga 
| lga_chr 
| Luggald 

| 347 
| lgr 
| lgr_chr 
| Luggalds 

| 348 
| fmt 
| 
| Drogmore 

| 349 
| fsk 
| fsk_chr 
| Froglok Skeleton 

| 350 
| fud 
| fud 
| Undead Froglok 

| 351 
| iwm 
| iwm_chr 
| Knight of Hate 

| 352 
| izm 
| izm_chr 
| Arcanist of Hate 

| 353 
| vek 
| vek_chr 
| Veksar 

| 354 
| gvk 
| gvk_chr 
| Veksar 

| 355 
| bvk 
| bvk_chr 
| Veksar 

| 356 
| wof 
| wof_chr 
| Chokidai 

| 357 
| wuf 
| wuf_chr 
| Undead Chokidai 

| 358 
| uvk 
| 
| Undead Veksar 

| 359 
| lmm 
| lmm_chr 
| Vampire 

| 360 
| mmm 
| mmm_chr 
| Vampire 

| 361 
| rom 
| rom_chr 
| Rujarkian Orc 

| 362 
| bgb 
| bgb_chr 
| Bone Golem 

| 363 
| syn 
| syn_chr 
| Synarcana 

| 364 
| sem 
| sem_chr 
| Sand Elf 

| 365 
| mmv 
| mmv_chr 
| Vampire 

| 366 
| roe 
| roe_chr 
| Rujarkian Orc 

| 367 
| skt 
| skt 
| Skeleton 

| 368 
| mmy 
| mmy_chr 
| Mummy 

| 369 
| gbl 
| gbl_chr 
| Goblin 

| 370 
| nin 
| nin_chr 
| Insect 

| 371 
| fgh 
| fgh_chr 
| Froglok Ghost 

| 372 
| drv 
| drv_chr 
| Dervish 

| 373 
| sdc 
| sdc 
| Shade 

| 374 
| glm 
| glm 
| Golem 

| 375 
| eey 
| eey_chr 
| Evil Eye 

| 376 
| box 
| box_chr 
| Box 

| 377 
| brl 
| brl_chr 
| Barrel 

| 378 
| cst 
| cst 
| Chest 

| 379 
| vas 
| vas_chr 
| Vase 

| 380 
| tbl 
| tbl_chr 
| Table 

| 381 
| rak 
| rak_chr 
| Weapon Rack 

| 382 
| cpt 
| cpt_chr 
| Coffin 

| 383 
| bon 
| bon_chr 
| Bones 

| 384 
| jkr 
| jkr_chr 
| Jokester 

| 385 
| tnm 
| tnm_chr 
| Nihil 

| 386 
| tem 
| tem_cht 
| Trusik 

| 387 
| tgl 
| tgl_chr 
| Stone Worker 

| 388 
| twf 
| twf_chr 
| Hynid 

| 389 
| tac 
| tac_chr 
| Turepta 

| 390 
| tmb 
| tmb_chr 
| Cragbeast 

| 391 
| ttb 
| ttb_chr 
| Stonemite 

| 392 
| iwh 
| iwh_chr 
| Ukun 

| 393 
| iec 
| iec_chr 
| Ixt 

| 394 
| ila 
| ila_chr 
| Ikaav 

| 395 
| icy 
| icy_chr 
| Aneuk 

| 396 
| ihu 
| ihu_chr 
| Kyv 

| 397 
| isb 
| isb_chr 
| Noc 

| 398 
| ibr 
| ibr_chr 
| Ratuk 

| 399 
| ifc 
| ifc_chr 
| Taneth 

| 400 
| ilb 
| ilb_chr 
| Huvul 

| 401 
| iwb 
| 
| Mutna 

| 402 
| ise 
| ise_chr 
| Mastruq 

| 403 
| tln 
| tln 
| Taelosian 

| 404 
| shp 
| shp_chr 
| Discord Ship 

| 405 
| tgo 
| tgo 
| Stone Worker 

| 406 
| clv 
| clv 
| Mata Muram 

| 407 
| mur 
| mur 
| Lightning Warrior 

| 408 
| scu 
| scu 
| Succubus 

| 409 
| dsg 
| dsg 
| Bazu 

| 410 
| fra 
| fra 
| Feran 

| 411 
| scu 
| scu 
| Pyrilen 

| 412 
| chm 
| chm 
| Chimera 

| 413 
| ddm 
| ddm 
| Dragorn 

| 414 
| dma 
| dma 
| Murkglider 

| 415 
| rtn 
| rtn 
| Rat 

| 416 
| btn 
| btn 
| Bat 

| 417 
| frd 
| frd 
| Gelidran 

| 418 
| dsf 
| dsf 
| Discordling 

| 419 
| ddv 
| ddv 
| Girplan 

| 420 
| mnt 
| mnt 
| Minotaur 

| 421 
| dbx 
| dbx 
| Dragorn Box 

| 422 
| rob 
| rob 
| Runed Orb 

| 423 
| dbp 
| dbp 
| Dragon Bones 

| 424 
| map 
| map 
| Muramite Armor Pile 

| 425 
| crs 
| crs 
| Crystal Shard 

| 426 
| prt 
| prt 
| Portal 

| 427 
| cnp 
| cnp 
| Coin Purse 

| 428 
| rkp 
| rkp 
| Rock Pile 

| 429 
| mes 
| mes 
| Murkglider Egg Sack 

| 430 
| cdr 
| cdr 
| Drake 

| 431 
| dvs 
| dvs 
| Dervish 

| 432 
| dke 
| dke 
| Drake 

| 433 
| gbn 
| gbn 
| Goblin 

| 434 
| krn 
| krn 
| Kirin 

| 435 
| ldr 
| ldr 
| Dragon 

| 436 
| bas 
| bas 
| Basilisk 

| 437 
| mdr 
| mdr 
| Dragon 

| 438 
| sdr 
| sdr 
| Dragon 

| 439 
| pma 
| pma 
| Puma 

| 440 
| tar 
| tar 
| Spider 

| 441 
| spq 
| spq 
| Spider Queen 

| 442 
| ans 
| ans 
| Animated Statue 

| 445 
| dre 
| dre 
| Dragon Egg 

| 446 
| drs 
| drs 
| Dragon Statue 

| 447 
| lvr 
| lvr 
| Lava Rock 

| 448 
| asm 
| 
| Animated Statue 

| 449 
| seg 
| seg 
| Spider Egg Sack 

| 450 
| lsp 
| lsp 
| Lava Spider 

| 451 
| lsq 
| lsq 
| Lava Spider Queen 

| 452 
| shd 
| shd 
| Dragon 

| 453 
| fgt 
| fgt 
| Giant 

| 454 
| wwf 
| wwf 
| Werewolf 

| 455 
| kbd 
| kbd 
| Kobold 

| 456 
| fng 
| fng 
| Sporali 

| 457 
| cwg 
| cwg 
| Gnomework 

| 458 
| ork 
| ork 
| Orc 

| 459 
| crh 
| crh 
| Corathus 

| 460 
| crl 
| crl 
| Coral 

| 461 
| dcf 
| dcf 
| Drachnid 

| 462 
| drc 
| drc 
| Drachnid Cocoon 

| 463 
| fgp 
| fgp 
| Fungus Patch 

| 464 
| ggy 
| ggy 
| Gargoyle 

| 465 
| kor 
| kor 
| Witheran 

| 466 
| myg 
| myg 
| Dark Lord 

| 467 
| shl 
| shl 
| Shiliskin 

| 468 
| snk 
| snk 
| Snake 

| 469 
| eve 
| eve 
| Evil Eye 

| 470 
| mnr 
| 
| Minotaur 

| 471 
| zmf 
| zmf 
| Zombie 

| 472 
| cwr 
| cwr 
| Clockwork Boar 

| 473 
| fry 
| fry 
| Fairy 

| 474 
| krb 
| krb 
| Witheran 

| 475 
| aie 
| aie 
| Air Elemental 

| 476 
| eae 
| eae 
| Earth Elemental 

| 477 
| fie 
| fie 
| Fire Elemental 

| 478 
| wae 
| wae 
| Water Elemental 

| 479 
| alr 
| 
| Alligator 

| 480 
| bar 
| bar 
| Bear 

| 481 
| scw 
| scw 
| Scaled Wolf 

| 482 
| wlf 
| wlf 
| Wolf 

| 483 
| spw 
| 
| Spirit Wolf 

| 484 
| skl 
| skl 
| Skeleton 

| 485 
| spt 
| spt 
| Spectre 

| 486 
| blv 
| blv 
| Bolvirk 

| 487 
| bse 
| bse 
| Banshee 

| 488 
| bsg 
| bsg 
| Banshee 

| 489 
| eef 
| eef 
| Elddar 

| 490 
| gfo 
| gfo 
| Forest Giant 

| 491 
| glb 
| glb 
| Bone Golem 

| 492 
| hrs 
| hrs 
| Horse 

| 493 
| pgs 
| pgs 
| Pegasus 

| 494 
| smd 
| smd 
| Shambling Mound 

| 495 
| srn 
| srn 
| Scrykin 

| 496 
| tra 
| tra 
| Treant 

| 497 
| vaf 
| vaf 
| Vampire 

| 498 
| aro 
| aro 
| Ayonae Ro 

| 499 
| szk 
| szk 
| Sullon Zek 

| 500 
| bnr 
| bnr 
| Banner 

| 501 
| flg 
| flg 
| Flag 

| 502 
| row 
| row 
| Rowboat 

| 503 
| t00 
| t00 
| Bear Trap 

| 504 
| t01 
| t01 
| Clockwork Bomb 

| 505 
| t02 
| t02 
| Dynamite Keg 

| 506 
| t03 
| t03 
| Pressure Plate 

| 507 
| t04 
| 
| Puffer Spore 

| 508 
| t05 
| t05 
| Stone Ring 

| 509 
| t06 
| t06 
| Root Tentacle 

| 510 
| t07 
| t07 
| Runic Symbol 

| 511 
| t08 
| t08 
| Saltpetter Bomb 

| 512 
| t09 
| t09 
| Floating Skull 

| 513 
| t10 
| 
| Spike Trap 

| 514 
| t11 
| t11 
| Totem 

| 515 
| t12 
| t12 
| Web 

| 516 
| t13 
| 
| Wicker Basket 

| 517 
| unm 
| unm 
| Nightmare/Unicorn 

| 518 
| hrs 
| hrs 
| Horse 

| 519 
| unm 
| unm 
| Nightmare/Unicorn 

| 520 
| bxi 
| bxi 
| Bixie 

| 521 
| cnt 
| cnt 
| Centaur 

| 522 
| dkf 
| 
| Drakkin 

| 523 
| gfr 
| gfr 
| Giant 

| 524 
| gnl 
| gnl 
| Gnoll 

| 525 
| grn 
| grn 
| Griffin 

| 526 
| gfs 
| gfs 
| Giant Shade 

| 527 
| hrp 
| hrp 
| Harpy 

| 528 
| mth 
| mth 
| Mammoth 

| 529 
| sat 
| sat 
| Satyr 

| 530 
| drg 
| drg 
| Dragon 

| 531 
| drn 
| 
| Dragon 

| 532 
| dyn 
| dyn 
| Dyn'Leth 

| 533 
| shi 
| shi 
| Boat 

| 534 
| i00 
| i00 
| Weapon Rack 

| 535 
| i01 
| 
| Armor Rack 

| 536 
| i02 
| i02 
| Honey Pot 

| 537 
| i03 
| 
| Jum Jum Bucket 

| 538 
| i04 
| 
| Toolbox 

| 539 
| i05 
| i05 
| Stone Jug 

| 540 
| i06 
| i06 
| Small Plant 

| 541 
| i07 
| i07 
| Medium Plant 

| 542 
| i08 
| i08 
| Tall Plant 

| 543 
| i09 
| i09 
| Wine Cask 

| 544 
| b01 
| 
| Elven Boat 

| 545 
| b02 
| 
| Gnomish Boat 

| 546 
| b03 
| 
| Barrel Barge Ship 

| 547 
| gul 
| gul 
| Goo 

| 548 
| gum 
| gum 
| Goo 

| 549 
| gus 
| gus 
| Goo 

| 550 
| b04 
| b04 
| Merchant Ship 

| 551 
| b05 
| b05 
| Pirate Ship 

| 552 
| b06 
| b06 
| Ghost Ship 

| 553 
| g00 
| 
| Banner 

| 554 
| g01 
| 
| Banner 

| 555 
| g02 
| 
| Banner 

| 556 
| g03 
| 
| Banner 

| 557 
| g04 
| 
| Banner 

| 558 
| avk 
| avk 
| Aviak 

| 559 
| btl 
| btl 
| Beetle 

| 560 
| grl 
| grl 
| Gorilla 

| 561 
| kdg 
| kdg 
| Kedge 

| 562 
| krm 
| krm 
| Kerran 

| 563 
| shs 
| shs 
| Shissar 

| 564 
| sin 
| sin 
| Siren 

| 565 
| spx 
| spx 
| Sphinx 

| 566 
| hnm 
| hnm 
| Human 

| 567 
| i10 
| 
| Campfire 

| 568 
| bnm 
| bnm 
| Brownie 

| 569 
| drp 
| drp 
| Dragon 

| 570 
| exo 
| exo 
| Exoskeleton 

| 571 
| gho 
| gho 
| Ghoul 

| 572 
| gua 
| gua 
| Clockwork Guardian 

| 573 
| mtp 
| 
| Mantrap 

| 574 
| mtr 
| mtr 
| Minotaur 

| 575 
| scc 
| scc 
| Scarecrow 

| 576 
| she 
| she 
| Shade 

| 577 
| swc 
| swc 
| Rotocopter 

| 578 
| tnt 
| tnt 
| Tentacle Terror 

| 579 
| wok 
| wok 
| Wereorc 

| 580 
| wor 
| wor 
| Worg 

| 581 
| wyr 
| wyr 
| Wyvern 

| 582 
| mch 
| 
| Chimera 

| 583 
| mki 
| 
| Kirin 

| 584 
| mpu 
| 
| Puma 

| 585 
| i11 
| i11 
| Boulder 

| 586 
| g05 
| 
| Banner 

| 587 
| xem 
| xem 
| Elven Ghost 

| 588 
| xhm 
| xhm 
| Human Ghost 

| 589 
| i12 
| i12 
| Chest 

| 590 
| i13 
| 
| Chest 

| 591 
| i14 
| i14 
| Crystal 

| 592 
| i15 
| 
| Coffin 

| 593 
| i16 
| 
| Guardian CPU 

| 594 
| mwo 
| 
| Worg 

| 595 
| obj_blimp 
| 
| Mansion 

| 596 
| obp_meldrath 
| 
| Floating Island 

| 597 
| mcs 
| 
| Cragslither 

| 598 
| mwr 
| 
| Wrulon 

| 599 
| s01 
| 
| 

| 600 
| ivm 
| qeynos_chr 
| Invisible Man of Zomm 

| 601 
| swc 
| swc 
| Robocopter of Zomm 

| 602 
| bur 
| bur 
| Burynai 

| 603 
| fgg 
| 
| Frog 

| 604 
| drl 
| drl 
| Dracolich 

| 605 
| xim 
| xim 
| Iksar Ghost 

| 606 
| ski 
| ski 
| Iksar Skeleton 

| 607 
| mph 
| mph 
| Mephit 

| 608 
| mud 
| mud 
| Muddite 

| 609 
| rpt 
| rpt 
| Raptor 

| 610 
| srk 
| srk 
| Sarnak 

| 611 
| sco 
| sco 
| Scorpion 

| 612 
| tse 
| tse 
| Tsetsian 

| 613 
| wrm 
| wrm 
| Wurm 

| 614 
| bal 
| bal 
| Nekhon 

| 615 
| hyc 
| hyc 
| Hydra Crystal 

| 616 
| cry 
| cry 
| Crystal Sphere 

| 617 
| gnd 
| gnd 
| Gnoll 

| 618 
| sok 
| sok 
| Sokokar 

| 619 
| pys 
| 
| Stone Pylon 

| 620 
| dvl 
| dvl 
| Demon Vulture 

| 621 
| i17 
| 
| Wagon 

| 622 
| god 
| god 
| God of Discord 

| 623 
| mfr 
| 
| Feran Mount 

| 624 
| onf 
| 
| Ogre NPC - Male 

| 625 
| mso 
| 
| Sokokar Mount 

| 626 
| gra 
| gra 
| Giant 

| 627 
| mso 
| 
| Sokokar 

| 628 
| bnx 
| 
| 10th Anniversary Banner 

| 629 
| cak 
| 
| 10th Anniversary Cake 

| 630 
| i18 
| 
| Wine Cask 

| 631 
| mhy 
| 
| Hydra Mount 

| 632 
| hyd 
| 
| Hydra NPC 

| 633 
| i19 
| i19 
| Wedding Fbelows 

| 634 
| i20 
| i20 
| Wedding Arbor 

| 635 
| i21 
| i21 
| Wedding Altar 

| 636 
| i22 
| i22 
| Powder Keg 

| 637 
| apx 
| apx 
| Apexus 

| 638 
| bel 
| bel 
| Bellikos 

| 639 
| bfc 
| bfc 
| Brell's First Creation 

| 640 
| bre 
| bre 
| Brell 

| 642 
| clq 
| clq 
| Cliknar Queen 

| 643 
| cls 
| cls 
| Cliknar Soldier 

| 644 
| clw 
| clw 
| Cliknar Worker 

| 645 
| cdm 
| cdm 
| Coldain 

| 647 
| cse 
| cse 
| Crystalskin Sessiloid 

| 648 
| gen 
| gen 
| Genari 

| 649 
| gig 
| gig 
| Gigyn 

| 650 
| gya 
| gya 
| Greken - Young Adult 

| 651 
| gyo 
| gyo 
| Greken - Young 

| 652 
| mcl 
| 
| Cliknar Mount 

| 653 
| tel 
| tel 
| Telmira 

| 654 
| mta 
| 
| Spider Mount 

| 655 
| mbr 
| 
| Bear Mount 

| 656 
| mcr 
| 
| Rat Mount - Mystery Race 

| 657 
| msd 
| 
| Sessiloid Mount 

| 658 
| lth 
| lth 
| Morell Thule 

| 659 
| mrt 
| mrt 
| Marionette 

| 660 
| bkd 
| bkd 
| Book Dervish 

| 661 
| tpe 
| 
| Topiary Lion 

| 662 
| rdg 
| rdg 
| Rotdog 

| 663 
| amy 
| amy 
| Amygdalan 

| 664 
| snd 
| snd 
| Sandman 

| 665 
| gfc 
| gfc 
| Grandfather Clock 

| 666 
| gbm 
| gbm 
| Gingerbread Man 

| 667 
| bfr 
| bfr 
| Royal Guard 

| 668 
| bny 
| bny 
| Rabbit 

| 669 
| bdr 
| bdr 
| Blind Dreamer

---

## NPC Scaling

*Source: server/npc/npc-scaling/index.html*

# NPC Scaling¶

One of the first introductions of a native scaling system includes **Global Base NPC Scaling**, profile based is planned for a later release but for now we will be covering the global system.

## Global Base NPC Scaling¶

- Traditionally when scaling an entire zone whether it is for custom content or for PEQ's purposes, we start with a blank slate of the zone or NPCs that have been transplanted. Every individual NPC needs to be tweaked by hand to handle stat / combat scaling for content unless you are using custom scripted solutions. We needed an easier way to at least handle the **base** scaling

### Introduction and Data Structure¶

- Take a look at the table below, imagine that this data drives all of the stats for every NPC that you'd like to scale. In order to understand this a bit more we need to break a few things down.

### Type¶

| 

Type 
| Description 
| Determination 

| 0 
| Trash 
| No special flags set 

| 1 
| Named 
| Has flag **rare_spawn** set in **npc_types** to **1** - or - name has **#** in the beginning - or - first character in name is capitalized 

| 2 
| Raid 
| Has flag **raid_target** set in **npc_types** to **1** 

- This data is simply an example of Levels 50-52, but has data from every **Type**

```
`select * from npc_scale_global_base where level >= 50 and level <= 52 order by type;
`
```

### How Attributes are Loaded¶

- The stats in the table will apply to an NPC when their original stat or attribute is 0 in the database, so to let an NPC be completely handled by this table you would set all the following stats to 0 in the `npc_types` table

- As alluded to before, each NPC is keyed off of **type** and **level**, so if an NPC is flagged as a named and is level 52, it will inherit the values from the row of **type 1** and **level 52** which has an **hp** value of 16080, this happens immediately upon spawn / repop

| 

*type 
| *level 
| ac 
| hp 
| accuracy 
| slow_mitigation 
| attack 
| strength 
| stamina 
| dexterity 
| agility 
| intelligence 
| wisdom 
| charisma 
| magic_resist 
| cold_resist 
| fire_resist 
| poison_resist 
| disease_resist 
| corruption_resist 
| physical_resist 
| min_dmg 
| max_dmg 
| hp_regen_rate 
| attack_delay 
| spell_scale 
| heal_scale 
| special_abilities 

| 0 
| 50 
| 245 
| 10000 
| 50 
| 0 
| 50 
| 194 
| 194 
| 194 
| 194 
| 194 
| 194 
| 194 
| 26 
| 26 
| 26 
| 26 
| 26 
| 41 
| 10 
| 74 
| 204 
| 50 
| 21 
| 100 
| 100 
| 

| 0 
| 51 
| 249 
| 11700 
| 53 
| 0 
| 53 
| 197 
| 197 
| 197 
| 197 
| 197 
| 197 
| 197 
| 27 
| 27 
| 27 
| 27 
| 27 
| 42 
| 11 
| 78 
| 231 
| 51 
| 20 
| 100 
| 100 
| 

| 0 
| 52 
| 253 
| 13400 
| 56 
| 0 
| 56 
| 200 
| 200 
| 200 
| 200 
| 200 
| 200 
| 200 
| 27 
| 27 
| 27 
| 27 
| 27 
| 43 
| 12 
| 81 
| 258 
| 52 
| 20 
| 100 
| 100 
| 

| 1 
| 50 
| 294 
| 12000 
| 60 
| 0 
| 60 
| 233 
| 233 
| 233 
| 233 
| 233 
| 233 
| 233 
| 31 
| 31 
| 31 
| 31 
| 31 
| 49 
| 12 
| 89 
| 245 
| 60 
| 21 
| 100 
| 100 
| 13,114,121,1 

| 1 
| 51 
| 299 
| 14040 
| 64 
| 0 
| 64 
| 236 
| 236 
| 236 
| 236 
| 236 
| 236 
| 236 
| 32 
| 32 
| 32 
| 32 
| 32 
| 50 
| 13 
| 94 
| 277 
| 61 
| 20 
| 100 
| 100 
| 13,114,121,1 

| 1 
| 52 
| 304 
| 16080 
| 67 
| 0 
| 67 
| 240 
| 240 
| 240 
| 240 
| 240 
| 240 
| 240 
| 32 
| 32 
| 32 
| 32 
| 32 
| 52 
| 14 
| 97 
| 310 
| 62 
| 20 
| 100 
| 100 
| 13,114,121,1 

| 2 
| 50 
| 368 
| 100000 
| 75 
| 0 
| 75 
| 291 
| 291 
| 291 
| 291 
| 291 
| 291 
| 291 
| 100 
| 100 
| 100 
| 100 
| 100 
| 100 
| 15 
| 111 
| 306 
| 75 
| 21 
| 100 
| 100 
| 1,12,18,113,114,115,116,117,121,1^31,1 

| 2 
| 51 
| 374 
| 130000 
| 80 
| 0 
| 80 
| 296 
| 296 
| 296 
| 296 
| 296 
| 296 
| 296 
| 102 
| 102 
| 102 
| 102 
| 102 
| 102 
| 17 
| 117 
| 347 
| 77 
| 20 
| 100 
| 100 
| 1,12,18,113,114,115,116,117,121,1^31,1 

| 2 
| 52 
| 380 
| 140000 
| 84 
| 0 
| 84 
| 300 
| 300 
| 300 
| 300 
| 300 
| 300 
| 300 
| 104 
| 104 
| 104 
| 104 
| 104 
| 104 
| 18 
| 122 
| 387 
| 78 
| 20 
| 100 
| 100 
| 1,12,18,113,114,115,116,117,121,1^31,1 

### Special Abilities¶

- For special abilities we load things slightly differently, we don't just look for having "no special abilities" on the NPC before we apply the template to them. In this implementation, we check to see if all of the base stats are actually zero value before we consider this NPC an **auto scaled** npc before deciding to apply **Special Abilities** from the database table template

```
`bool NpcScaleManager::IsAutoScaled(NPC *npc)
{
 return
 (npc->GetHP() == 0 &&
 npc->GetMaxDMG() == 0 &&
 npc->GetMinDMG() == 0 &&
 npc->GetSTR() == 0 &&
 npc->GetSTA() == 0 &&
 npc->GetDEX() == 0 &&
 npc->GetAGI() == 0 &&
 npc->GetINT() == 0 &&
 npc->GetWIS() == 0 &&
 npc->GetCHA() == 0 &&
 npc->GetMR() == 0 &&
 npc->GetFR() == 0 &&
 npc->GetCR() == 0 &&
 npc->GetPR() == 0 &&
 npc->GetDR() == 0);
}
`
```

### Scaling Commands¶

- **scale [static/dynamic] (With targeted NPC)**

- **scale [npc_name_search] [static/dynamic] (To make zone-wide changes)**

- **scale all [static/dynamic]**

With the above commands, static essentially going to take the scaling profile from the table above and applied it directory to the `npc_types` data on the NPC itself

### Example: #scale static¶

### Example: #scale dynamic¶

### Name Search¶

Similarly, the static and dynamic commands work based on a name search filter

You must click before actually pushing the changes to make sure it is the change you want to make

### Zonewide¶

To simply change everything in the zone you can use **#scale all [static/dynamic]** - just like name search it will ask for confirmation before applying

### Logging¶

To see stats being loaded on NPC's during a repop or spawn, under the **NPC Scaling** logging category you can see attributes that are being applied to the NPC. The below is a snippet from a #repop in **Griegs End**

```
`[NPC Scaling] (a shrouded willsapper) level: 54 type: 0 Auto: true Setting: ac: 261 max_hp: 16800 accuracy: 62 slow_mitigation: 10 atk: 62 str: 206 sta: 206 dex: 206 agi: 206 int: 206 wis: 206 cha: 206 mr: 28 cr: 44 fr: 28 pr: 14 dr: 28 cr: 44 pr: 14 min_hit: 48 max_hit: 169 hp_regen: 54 attack_delay: 20 spell_scale: 100 heal_scale: 100 special_abilities:
[NPC Scaling] (a shrouded willsapper) level: 53 type: 0 Auto: true Setting: ac: 257 max_hp: 15100 accuracy: 59 slow_mitigation: 0 atk: 59 str: 203 sta: 203 dex: 203 agi: 203 int: 203 wis: 203 cha: 203 mr: 28 cr: 43 fr: 28 pr: 13 dr: 28 cr: 43 pr: 13 min_hit: 46 max_hit: 154 hp_regen: 53 attack_delay: 20 spell_scale: 100 heal_scale: 100 special_abilities:
[NPC Scaling] (a shrouded willsapper) level: 53 type: 0 Auto: true Setting: ac: 257 max_hp: 15100 accuracy: 59 slow_mitigation: 0 atk: 59 str: 203 sta: 203 dex: 203 agi: 203 int: 203 wis: 203 cha: 203 mr: 28 cr: 43 fr: 28 pr: 13 dr: 28 cr: 43 pr: 13 min_hit: 46 max_hit: 154 hp_regen: 53 attack_delay: 20 spell_scale: 100 heal_scale: 100 special_abilities:
[NPC Scaling] (a shrouded willsapper) level: 54 type: 0 Auto: true Setting: ac: 261 max_hp: 16800 accuracy: 62 slow_mitigation: 10 atk: 62 str: 206 sta: 206 dex: 206 agi: 206 int: 206 wis: 206 cha: 206 mr: 28 cr: 44 fr: 28 pr: 14 dr: 28 cr: 44 pr: 14 min_hit: 48 max_hit: 169 hp_regen: 54 attack_delay: 20 spell_scale: 100 heal_scale: 100 special_abilities:
[NPC Scaling] (a shrouded willsapper) level: 55 type: 0 Auto: true Setting: ac: 266 max_hp: 18500 accuracy: 65 slow_mitigation: 10 atk: 65 str: 210 sta: 210 dex: 210 agi: 210 int: 210 wis: 210 cha: 210 mr: 29 cr: 45 fr: 29 pr: 15 dr: 29 cr: 45 pr: 15 min_hit: 50 max_hit: 184 hp_regen: 55 attack_delay: 20 spell_scale: 100 heal_scale: 100 special_abilities:
[NPC Scaling] (a shrouded willsapper) level: 53 type: 0 Auto: true Setting: ac: 257 max_hp: 15100 accuracy: 59 slow_mitigation: 0 atk: 59 str: 203 sta: 203 dex: 203 agi: 203 int: 203 wis: 203 cha: 203 mr: 28 cr: 43 fr: 28 pr: 13 dr: 28 cr: 43 pr: 13 min_hit: 46 max_hit: 154 hp_regen: 53 attack_delay: 20 spell_scale: 100 heal_scale: 100 special_abilities:
[NPC Scaling] (a defiled dreamweaver) level: 54 type: 0 Auto: true Setting: ac: 261 max_hp: 16800 accuracy: 62 slow_mitigation: 10 atk: 62 str: 206 sta: 206 dex: 206 agi: 206 int: 206 wis: 206 cha: 206 mr: 28 cr: 44 fr: 28 pr: 14 dr: 28 cr: 44 pr: 14 min_hit: 60 max_hit: 212 hp_regen: 54 attack_delay: 20 spell_scale: 100 heal_scale: 100 special_abilities:
[NPC Scaling] (a deadly dreamweaver) level: 54 type: 0 Auto: true Setting: ac: 261 max_hp: 16800 accuracy: 62 slow_mitigation: 10 atk: 62 str: 206 sta: 206 dex: 206 agi: 206 int: 206 wis: 206 cha: 206 mr: 28 cr: 44 fr: 28 pr: 14 dr: 28 cr: 44 pr: 14 min_hit: 48 max_hit: 169 hp_regen: 54 attack_delay: 20 spell_scale: 100 heal_scale: 100 special_abilities:
[NPC Scaling] (a shadowy figure) level: 58 type: 0 Auto: true Setting: ac: 278 max_hp: 23600 accuracy: 74 slow_mitigation: 10 atk: 74 str: 219 sta: 219 dex: 219 agi: 219 int: 219 wis: 219 cha: 219 mr: 30 cr: 47 fr: 30 pr: 18 dr: 30 cr: 47 pr: 18 min_hit: 137 max_hit: 551 hp_regen: 58 attack_delay: 19 spell_scale: 100 heal_scale: 100 special_abilities: 8,1
[NPC Scaling] (a tormented pugilist) level: 55 type: 0 Auto: true Setting: ac: 266 max_hp: 18500 accuracy: 65 slow_mitigation: 10 atk: 65 str: 210 sta: 210 dex: 210 agi: 210 int: 210 wis: 210 cha: 210 mr: 29 cr: 45 fr: 29 pr: 15 dr: 29 cr: 45 pr: 15 min_hit: 118 max_hit: 430 hp_regen: 55 attack_delay: 20 spell_scale: 100 heal_scale: 100 special_abilities:
[NPC Scaling] (a tormented pugilist) level: 55 type: 0 Auto: true Setting: ac: 266 max_hp: 18500 accuracy: 65 slow_mitigation: 10 atk: 65 str: 210 sta: 210 dex: 210 agi: 210 int: 210 wis: 210 cha: 210 mr: 29 cr: 45 fr: 29 pr: 15 dr: 29 cr: 45 pr: 15 min_hit: 118 max_hit: 430 hp_regen: 55 attack_delay: 20 spell_scale: 100 heal_scale: 100 special_abilities:
[NPC Scaling] (a shrouded minion) level: 75 type: 2 Auto: true Setting: ac: 572 max_hp: 1850000 accuracy: 330 slow_mitigation: 75 atk: 310 str: 342 sta: 342 dex: 342 agi: 342 int: 342 wis: 342 cha: 342 mr: 150 cr: 150 fr: 150 pr: 80 dr: 150 cr: 150 pr: 80 min_hit: 1024 max_hit: 3816 hp_regen: 1500 attack_delay: 13 spell_scale: 100 heal_scale: 100 special_abilities: 1,1^2,1^8,1^13,1^14,1^15,1^16,1^17,1^21,1^31,1
[NPC Scaling] (a shrouded minion) level: 75 type: 2 Auto: true Setting: ac: 572 max_hp: 1850000 accuracy: 330 slow_mitigation: 75 atk: 310 str: 342 sta: 342 dex: 342 agi: 342 int: 342 wis: 342 cha: 342 mr: 150 cr: 150 fr: 150 pr: 80 dr: 150 cr: 150 pr: 80 min_hit: 1024 max_hit: 3816 hp_regen: 1500 attack_delay: 13 spell_scale: 100 heal_scale: 100 special_abilities: 1,1^2,1^8,1^13,1^14,1^15,1^16,1^17,1^21,1^31,1
[NPC Scaling] (an ancient necromantic shade) level: 80 type: 2 Auto: true Setting: ac: 608 max_hp: 2100000 accuracy: 380 slow_mitigation: 85 atk: 360 str: 362 sta: 362 dex: 362 agi: 362 int: 362 wis: 362 cha: 362 mr: 160 cr: 160 fr: 160 pr: 100 dr: 160 cr: 160 pr: 100 min_hit: 490 max_hit: 1905 hp_regen: 2000 attack_delay: 13 spell_scale: 100 heal_scale: 100 special_abilities: 1,1^2,1^8,1^13,1^14,1^15,1^16,1^17,1^21,1^31,1
[NPC Scaling] (a shrouded minion) level: 75 type: 2 Auto: true Setting: ac: 572 max_hp: 1850000 accuracy: 330 slow_mitigation: 75 atk: 310 str: 342 sta: 342 dex: 342 agi: 342 int: 342 wis: 342 cha: 342 mr: 150 cr: 150 fr: 150 pr: 80 dr: 150 cr: 150 pr: 80 min_hit: 1024 max_hit: 3816 hp_regen: 1500 attack_delay: 13 spell_scale: 100 heal_scale: 100 special_abilities: 1,1^2,1^8,1^13,1^14,1^15,1^16,1^17,1^21,1^31,1
[NPC Scaling] (a shrouded minion) level: 75 type: 2 Auto: true Setting: ac: 572 max_hp: 1850000 accuracy: 330 slow_mitigation: 75 atk: 310 str: 342 sta: 342 dex: 342 agi: 342 int: 342 wis: 342 cha: 342 mr: 150 cr: 150 fr: 150 pr: 80 dr: 150 cr: 150 pr: 80 min_hit: 1024 max_hit: 3816 hp_regen: 1500 attack_delay: 13 spell_scale: 100 heal_scale: 100 special_abilities: 1,1^2,1^8,1^13,1^14,1^15,1^16,1^17,1^21,1^31,1
[NPC Scaling] (a tormented pugilist) level: 54 type: 0 Auto: true Setting: ac: 261 max_hp: 16800 accuracy: 62 slow_mitigation: 10 atk: 62 str: 206 sta: 206 dex: 206 agi: 206 int: 206 wis: 206 cha: 206 mr: 28 cr: 44 fr: 28 pr: 14 dr: 28 cr: 44 pr: 14 min_hit: 113 max_hit: 395 hp_regen: 54 attack_delay: 20 spell_scale: 100 heal_scale: 100 special_abilities:
[NPC Scaling] (a tormented mercenary) level: 54 type: 0 Auto: true Setting: ac: 261 max_hp: 16800 accuracy: 62 slow_mitigation: 10 atk: 62 str: 206 sta: 206 dex: 206 agi: 206 int: 206 wis: 206 cha: 206 mr: 28 cr: 44 fr: 28 pr: 14 dr: 28 cr: 44 pr: 14 min_hit: 113 max_hit: 395 hp_regen: 54 attack_delay: 20 spell_scale: 100 heal_scale: 100 special_abilities:
[NPC Scaling] (a mangled clairvoyant) level: 55 type: 0 Auto: true Setting: ac: 266 max_hp: 18500 accuracy: 65 slow_mitigation: 10 atk: 65 str: 210 sta: 210 dex: 210 agi: 210 int: 210 wis: 210 cha: 210 mr: 29 cr: 45 fr: 29 pr: 15 dr: 29 cr: 45 pr: 15 min_hit: 50 max_hit: 184 hp_regen: 55 attack_delay: 20 spell_scale: 100 heal_scale: 100 special_abilities:
`
```

### DevTools¶

You can also see which attributes are applied to an NPC using the DevTools mob info display window (Targeting an NPC). Any stat that has been loaded from the global scale system has an asterisk next to it

---

## Race List

*Source: server/npc/race-list/index.html*

# Race List¶

This list contains all Race IDs and bitmasks.

For a more comprehensive client-side modding list, check out Race Files

## Player Races¶

| 

ID 
| Bitmask 
| Name 

| 1 
| 1 
| Human 

| 2 
| 2 
| Barbarian 

| 3 
| 4 
| Erudite 

| 4 
| 8 
| Wood Elf 

| 5 
| 16 
| High Elf 

| 6 
| 32 
| Dark Elf 

| 7 
| 64 
| Half Elf 

| 8 
| 128 
| Dwarf 

| 9 
| 256 
| Troll 

| 10 
| 512 
| Ogre 

| 11 
| 1024 
| Halfling 

| 12 
| 2048 
| Gnome 

| 128 
| 4096 
| Iksar 

| 130 
| 8192 
| Vah Shir 

| 330 
| 16384 
| Froglok 

| 522 
| 32768 
| Drakkin 

## All Races¶

| 

ID 
| Name 

| 1 
| Human 

| 2 
| Barbarian 

| 3 
| Erudite 

| 4 
| Wood Elf 

| 5 
| High Elf 

| 6 
| Dark Elf 

| 7 
| Half Elf 

| 8 
| Dwarf 

| 9 
| Troll 

| 10 
| Ogre 

| 11 
| Halfling 

| 12 
| Gnome 

| 13 
| Aviak 

| 14 
| Werewolf 

| 15 
| Brownie 

| 16 
| Centaur 

| 17 
| Golem 

| 18 
| Giant 

| 19 
| Trakanon 

| 20 
| Venril Sathir 

| 21 
| Evil Eye 

| 22 
| Beetle 

| 23 
| Kerran 

| 24 
| Fish 

| 25 
| Fairy 

| 26 
| Froglok 

| 27 
| Froglok 

| 28 
| Fungusman 

| 29 
| Gargoyle 

| 30 
| Gasbag 

| 31 
| Gelatinous Cube 

| 32 
| Ghost 

| 33 
| Ghoul 

| 34 
| Bat 

| 35 
| Eel 

| 36 
| Rat 

| 37 
| Snake 

| 38 
| Spider 

| 39 
| Gnoll 

| 40 
| Goblin 

| 41 
| Gorilla 

| 42 
| Wolf 

| 43 
| Bear 

| 44 
| Guard 

| 45 
| Demi Lich 

| 46 
| Imp 

| 47 
| Griffin 

| 48 
| Kobold 

| 49 
| Dragon 

| 50 
| Lion 

| 51 
| Lizard Man 

| 52 
| Mimic 

| 53 
| Minotaur 

| 54 
| Orc 

| 55 
| Beggar 

| 56 
| Pixie 

| 57 
| Drachnid 

| 58 
| Solusek Ro 

| 59 
| Goblin 

| 60 
| Skeleton 

| 61 
| Shark 

| 62 
| Tunare 

| 63 
| Tiger 

| 64 
| Treant 

| 65 
| Vampire 

| 66 
| Rallos Zek 

| 67 
| Human 

| 68 
| Tentacle Terror 

| 69 
| Will-O-Wisp 

| 70 
| Zombie 

| 71 
| Human 

| 72 
| Ship 

| 73 
| Launch 

| 74 
| Piranha 

| 75 
| Elemental 

| 76 
| Puma 

| 77 
| Dark Elf 

| 78 
| Erudite 

| 79 
| Bixie 

| 80 
| Reanimated Hand 

| 81 
| Halfling 

| 82 
| Scarecrow 

| 83 
| Skunk 

| 84 
| Snake Elemental 

| 85 
| Spectre 

| 86 
| Sphinx 

| 87 
| Armadillo 

| 88 
| Clockwork Gnome 

| 89 
| Drake 

| 90 
| Barbarian 

| 91 
| Alligator 

| 92 
| Troll 

| 93 
| Ogre 

| 94 
| Dwarf 

| 95 
| Cazic Thule 

| 96 
| Cockatrice 

| 97 
| Daisy Man 

| 98 
| Vampire 

| 99 
| Amygdalan 

| 100 
| Dervish 

| 101 
| Efreeti 

| 102 
| Tadpole 

| 103 
| Kedge 

| 104 
| Leech 

| 105 
| Swordfish 

| 106 
| Guard 

| 107 
| Mammoth 

| 108 
| Eye 

| 109 
| Wasp 

| 110 
| Mermaid 

| 111 
| Harpy 

| 112 
| Guard 

| 113 
| Drixie 

| 114 
| Ghost Ship 

| 115 
| Clam 

| 116 
| Seahorse 

| 117 
| Ghost 

| 118 
| Ghost 

| 119 
| Sabertooth 

| 120 
| Wolf 

| 121 
| Gorgon 

| 122 
| Dragon 

| 123 
| Innoruuk 

| 124 
| Unicorn 

| 125 
| Pegasus 

| 126 
| Djinn 

| 127 
| Invisible Man 

| 128 
| Iksar 

| 129 
| Scorpion 

| 130 
| Vah Shir 

| 131 
| Sarnak 

| 132 
| Draglock 

| 133 
| Drolvarg 

| 134 
| Mosquito 

| 135 
| Rhinoceros 

| 136 
| Xalgoz 

| 137 
| Goblin 

| 138 
| Yeti 

| 139 
| Iksar 

| 140 
| Giant 

| 141 
| Boat 

| 144 
| Burynai 

| 145 
| Goo 

| 146 
| Sarnak Spirit 

| 147 
| Iksar Spirit 

| 148 
| Fish 

| 149 
| Scorpion 

| 150 
| Erollisi 

| 151 
| Tribunal 

| 152 
| Bertoxxulous 

| 153 
| Bristlebane 

| 154 
| Fay Drake 

| 155 
| Undead Sarnak 

| 156 
| Ratman 

| 157 
| Wyvern 

| 158 
| Wurm 

| 159 
| Devourer 

| 160 
| Iksar Golem 

| 161 
| Undead Iksar 

| 162 
| Man-Eating Plant 

| 163 
| Raptor 

| 164 
| Sarnak Golem 

| 165 
| Dragon 

| 166 
| Animated Hand 

| 167 
| Succulent 

| 168 
| Holgresh 

| 169 
| Brontotherium 

| 170 
| Snow Dervish 

| 171 
| Dire Wolf 

| 172 
| Manticore 

| 173 
| Totem 

| 174 
| Ice Spectre 

| 175 
| Enchanted Armor 

| 176 
| Snow Rabbit 

| 177 
| Walrus 

| 178 
| Geonid 

| 181 
| Yakkar 

| 182 
| Faun 

| 183 
| Coldain 

| 184 
| Dragon 

| 185 
| Hag 

| 186 
| Hippogriff 

| 187 
| Siren 

| 188 
| Giant 

| 189 
| Giant 

| 190 
| Othmir 

| 191 
| Ulthork 

| 192 
| Dragon 

| 193 
| Abhorrent 

| 194 
| Sea Turtle 

| 195 
| Dragon 

| 196 
| Dragon 

| 197 
| Ronnie Test 

| 198 
| Dragon 

| 199 
| Shik'Nar 

| 200 
| Rockhopper 

| 201 
| Underbulk 

| 202 
| Grimling 

| 203 
| Worm 

| 204 
| Evan Test 

| 205 
| Shadel 

| 206 
| Owlbear 

| 207 
| Rhino Beetle 

| 208 
| Vampire 

| 209 
| Earth Elemental 

| 210 
| Air Elemental 

| 211 
| Water Elemental 

| 212 
| Fire Elemental 

| 213 
| Wetfang Minnow 

| 214 
| Thought Horror 

| 215 
| Tegi 

| 216 
| Horse 

| 217 
| Shissar 

| 218 
| Fungal Fiend 

| 219 
| Vampire 

| 220 
| Stonegrabber 

| 221 
| Scarlet Cheetah 

| 222 
| Zelniak 

| 223 
| Lightcrawler 

| 224 
| Shade 

| 225 
| Sunfbelow 

| 226 
| Sun Revenant 

| 227 
| Shrieker 

| 228 
| Galorian 

| 229 
| Netherbian 

| 230 
| Akheva 

| 231 
| Grieg Veneficus 

| 232 
| Sonic Wolf 

| 233 
| Ground Shaker 

| 234 
| Vah Shir Skeleton 

| 235 
| Wretch 

| 236 
| Seru 

| 237 
| Recuso 

| 238 
| Vah Shir 

| 239 
| Guard 

| 240 
| Teleport Man 

| 241 
| Werewolf 

| 242 
| Nymph 

| 243 
| Dryad 

| 244 
| Treant 

| 245 
| Fly 

| 246 
| Tarew Marr 

| 247 
| Solusek Ro 

| 248 
| Clockwork Golem 

| 249 
| Clockwork Brain 

| 250 
| Banshee 

| 251 
| Guard of Justice 

| 252 
| Mini POM 

| 253 
| Diseased Fiend 

| 254 
| Solusek Ro Guard 

| 255 
| Bertoxxulous 

| 256 
| The Tribunal 

| 257 
| Terris Thule 

| 258 
| Vegerog 

| 259 
| Crocodile 

| 260 
| Bat 

| 261 
| Hraquis 

| 262 
| Tranquilion 

| 263 
| Tin Soldier 

| 264 
| Nightmare Wraith 

| 265 
| Malarian 

| 266 
| Knight of Pestilence 

| 267 
| Lepertoloth 

| 268 
| Bubonian 

| 269 
| Bubonian Underling 

| 270 
| Pusling 

| 271 
| Water Mephit 

| 272 
| Stormrider 

| 273 
| Junk Beast 

| 274 
| Broken Clockwork 

| 275 
| Giant Clockwork 

| 276 
| Clockwork Beetle 

| 277 
| Nightmare Goblin 

| 278 
| Karana 

| 279 
| Blood Raven 

| 280 
| Nightmare Gargoyle 

| 281 
| Mouth of Insanity 

| 282 
| Skeletal Horse 

| 283 
| Saryrn 

| 284 
| Fennin Ro 

| 285 
| Tormentor 

| 286 
| Soul Devourer 

| 287 
| Nightmare 

| 288 
| Rallos Zek 

| 289 
| Vallon Zek 

| 290 
| Tallon Zek 

| 291 
| Air Mephit 

| 292 
| Earth Mephit 

| 293 
| Fire Mephit 

| 294 
| Nightmare Mephit 

| 295 
| Zebuxoruk 

| 296 
| Mithaniel Marr 

| 297 
| Undead Knight 

| 298 
| The Rathe 

| 299 
| Xegony 

| 300 
| Fiend 

| 301 
| Test Object 

| 302 
| Crab 

| 303 
| Phoenix 

| 304 
| Dragon 

| 305 
| Bear 

| 306 
| Giant 

| 307 
| Giant 

| 308 
| Giant 

| 309 
| Giant 

| 310 
| Giant 

| 311 
| Giant 

| 312 
| Giant 

| 313 
| War Wraith 

| 314 
| Wrulon 

| 315 
| Kraken 

| 316 
| Poison Frog 

| 317 
| Nilborien 

| 318 
| Valorian 

| 319 
| War Boar 

| 320 
| Efreeti 

| 321 
| War Boar 

| 322 
| Valorian 

| 323 
| Animated Armor 

| 324 
| Undead Footman 

| 325 
| Rallos Zek Minion 

| 326 
| Arachnid 

| 327 
| Crystal Spider 

| 328 
| Zebuxoruk's Cage 

| 329 
| BoT Portal 

| 330 
| Froglok 

| 331 
| Troll 

| 332 
| Troll 

| 333 
| Troll 

| 334 
| Ghost 

| 335 
| Pirate 

| 336 
| Pirate 

| 337 
| Pirate 

| 338 
| Pirate 

| 339 
| Pirate 

| 340 
| Pirate 

| 341 
| Pirate 

| 342 
| Pirate 

| 343 
| Frog 

| 344 
| Troll Zombie 

| 345 
| Luggald 

| 346 
| Luggald 

| 347 
| Luggalds 

| 348 
| Drogmore 

| 349 
| Froglok Skeleton 

| 350 
| Undead Froglok 

| 351 
| Knight of Hate 

| 352 
| Arcanist of Hate 

| 353 
| Veksar 

| 354 
| Veksar 

| 355 
| Veksar 

| 356 
| Chokidai 

| 357 
| Undead Chokidai 

| 358 
| Undead Veksar 

| 359 
| Vampire 

| 360 
| Vampire 

| 361 
| Rujarkian Orc 

| 362 
| Bone Golem 

| 363 
| Synarcana 

| 364 
| Sand Elf 

| 365 
| Vampire 

| 366 
| Rujarkian Orc 

| 367 
| Skeleton 

| 368 
| Mummy 

| 369 
| Goblin 

| 370 
| Insect 

| 371 
| Froglok Ghost 

| 372 
| Dervish 

| 373 
| Shade 

| 374 
| Golem 

| 375 
| Evil Eye 

| 376 
| Box 

| 377 
| Barrel 

| 378 
| Chest 

| 379 
| Vase 

| 380 
| Table 

| 381 
| Weapon Rack 

| 382 
| Coffin 

| 383 
| Bones 

| 384 
| Jokester 

| 385 
| Nihil 

| 386 
| Trusik 

| 387 
| Stone Worker 

| 388 
| Hynid 

| 389 
| Turepta 

| 390 
| Cragbeast 

| 391 
| Stonemite 

| 392 
| Ukun 

| 393 
| Ixt 

| 394 
| Ikaav 

| 395 
| Aneuk 

| 396 
| Kyv 

| 397 
| Noc 

| 398 
| Ratuk 

| 399 
| Taneth 

| 400 
| Huvul 

| 401 
| Mutna 

| 402 
| Mastruq 

| 403 
| Taelosian 

| 404 
| Discord Ship 

| 405 
| Stone Worker 

| 406 
| Mata Muram 

| 407 
| Lightning Warrior 

| 408 
| Succubus 

| 409 
| Bazu 

| 410 
| Feran 

| 411 
| Pyrilen 

| 412 
| Chimera 

| 413 
| Dragorn 

| 414 
| Murkglider 

| 415 
| Rat 

| 416 
| Bat 

| 417 
| Gelidran 

| 418 
| Discordling 

| 419 
| Girplan 

| 420 
| Minotaur 

| 421 
| Dragorn Box 

| 422 
| Runed Orb 

| 423 
| Dragon Bones 

| 424 
| Muramite Armor Pile 

| 425 
| Crystal Shard 

| 426 
| Portal 

| 427 
| Coin Purse 

| 428 
| Rock Pile 

| 429 
| Murkglider Egg Sack 

| 430 
| Drake 

| 431 
| Dervish 

| 432 
| Drake 

| 433 
| Goblin 

| 434 
| Kirin 

| 435 
| Dragon 

| 436 
| Basilisk 

| 437 
| Dragon 

| 438 
| Dragon 

| 439 
| Puma 

| 440 
| Spider 

| 441 
| Spider Queen 

| 442 
| Animated Statue 

| 445 
| Dragon Egg 

| 446 
| Dragon Statue 

| 447 
| Lava Rock 

| 448 
| Animated Statue 

| 449 
| Spider Egg Sack 

| 450 
| Lava Spider 

| 451 
| Lava Spider Queen 

| 452 
| Dragon 

| 453 
| Giant 

| 454 
| Werewolf 

| 455 
| Kobold 

| 456 
| Sporali 

| 457 
| Gnomework 

| 458 
| Orc 

| 459 
| Corathus 

| 460 
| Coral 

| 461 
| Drachnid 

| 462 
| Drachnid Cocoon 

| 463 
| Fungus Patch 

| 464 
| Gargoyle 

| 465 
| Witheran 

| 466 
| Dark Lord 

| 467 
| Shiliskin 

| 468 
| Snake 

| 469 
| Evil Eye 

| 470 
| Minotaur 

| 471 
| Zombie 

| 472 
| Clockwork Boar 

| 473 
| Fairy 

| 474 
| Witheran 

| 475 
| Air Elemental 

| 476 
| Earth Elemental 

| 477 
| Fire Elemental 

| 478 
| Water Elemental 

| 479 
| Alligator 

| 480 
| Bear 

| 481 
| Scaled Wolf 

| 482 
| Wolf 

| 483 
| Spirit Wolf 

| 484 
| Skeleton 

| 485 
| Spectre 

| 486 
| Bolvirk 

| 487 
| Banshee 

| 488 
| Banshee 

| 489 
| Elddar 

| 490 
| Forest Giant 

| 491 
| Bone Golem 

| 492 
| Horse 

| 493 
| Pegasus 

| 494 
| Shambling Mound 

| 495 
| Scrykin 

| 496 
| Treant 

| 497 
| Vampire 

| 498 
| Ayonae Ro 

| 499 
| Sullon Zek 

| 500 
| Banner 

| 501 
| Flag 

| 502 
| Rowboat 

| 503 
| Bear Trap 

| 504 
| Clockwork Bomb 

| 505 
| Dynamite Keg 

| 506 
| Pressure Plate 

| 507 
| Puffer Spore 

| 508 
| Stone Ring 

| 509 
| Root Tentacle 

| 510 
| Runic Symbol 

| 511 
| Saltpetter Bomb 

| 512 
| Floating Skull 

| 513 
| Spike Trap 

| 514 
| Totem 

| 515 
| Web 

| 516 
| Wicker Basket 

| 517 
| Nightmare/Unicorn 

| 518 
| Horse 

| 519 
| Nightmare/Unicorn 

| 520 
| Bixie 

| 521 
| Centaur 

| 522 
| Drakkin 

| 523 
| Giant 

| 524 
| Gnoll 

| 525 
| Griffin 

| 526 
| Giant Shade 

| 527 
| Harpy 

| 528 
| Mammoth 

| 529 
| Satyr 

| 530 
| Dragon 

| 531 
| Dragon 

| 532 
| Dyn'Leth 

| 533 
| Boat 

| 534 
| Weapon Rack 

| 535 
| Armor Rack 

| 536 
| Honey Pot 

| 537 
| Jum Jum Bucket 

| 538 
| Toolbox 

| 539 
| Stone Jug 

| 540 
| Small Plant 

| 541 
| Medium Plant 

| 542 
| Tall Plant 

| 543 
| Wine Cask 

| 544 
| Elven Boat 

| 545 
| Gnomish Boat 

| 546 
| Barrel Barge Ship 

| 547 
| Goo 

| 548 
| Goo 

| 549 
| Goo 

| 550 
| Merchant Ship 

| 551 
| Pirate Ship 

| 552 
| Ghost Ship 

| 553 
| Banner 

| 554 
| Banner 

| 555 
| Banner 

| 556 
| Banner 

| 557 
| Banner 

| 558 
| Aviak 

| 559 
| Beetle 

| 560 
| Gorilla 

| 561 
| Kedge 

| 562 
| Kerran 

| 563 
| Shissar 

| 564 
| Siren 

| 565 
| Sphinx 

| 566 
| Human 

| 567 
| Campfire 

| 568 
| Brownie 

| 569 
| Dragon 

| 570 
| Exoskeleton 

| 571 
| Ghoul 

| 572 
| Clockwork Guardian 

| 573 
| Mantrap 

| 574 
| Minotaur 

| 575 
| Scarecrow 

| 576 
| Shade 

| 577 
| Rotocopter 

| 578 
| Tentacle Terror 

| 579 
| Wereorc 

| 580 
| Worg 

| 581 
| Wyvern 

| 582 
| Chimera 

| 583 
| Kirin 

| 584 
| Puma 

| 585 
| Boulder 

| 586 
| Banner 

| 587 
| Elven Ghost 

| 588 
| Human Ghost 

| 589 
| Chest 

| 590 
| Chest 

| 591 
| Crystal 

| 592 
| Coffin 

| 593 
| Guardian CPU 

| 594 
| Worg 

| 595 
| Mansion 

| 596 
| Floating Island 

| 597 
| Cragslither 

| 598 
| Wrulon 

| 600 
| Invisible Man of Zomm 

| 601 
| Robocopter of Zomm 

| 602 
| Burynai 

| 603 
| Frog 

| 604 
| Dracolich 

| 605 
| Iksar Ghost 

| 606 
| Iksar Skeleton 

| 607 
| Mephit 

| 608 
| Muddite 

| 609 
| Raptor 

| 610 
| Sarnak 

| 611 
| Scorpion 

| 612 
| Tsetsian 

| 613 
| Wurm 

| 614 
| Nekhon 

| 615 
| Hydra Crystal 

| 616 
| Crystal Sphere 

| 617 
| Gnoll 

| 618 
| Sokokar 

| 619 
| Stone Pylon 

| 620 
| Demon Vulture 

| 621 
| Wagon 

| 622 
| God of Discord 

| 623 
| Feran Mount 

| 624 
| Ogre NPC 

| 625 
| Sokokar Mount 

| 626 
| Giant 

| 627 
| Sokokar 

| 628 
| 10th Anniversary Banner 

| 629 
| 10th Anniversary Cake 

| 630 
| Wine Cask 

| 631 
| Hydra Mount 

| 632 
| Hydra NPC 

| 633 
| Wedding Fbelows 

| 634 
| Wedding Arbor 

| 635 
| Wedding Altar 

| 636 
| Powder Keg 

| 637 
| Apexus 

| 638 
| Bellikos 

| 639 
| Brell's First Creation 

| 640 
| Brell 

| 641 
| Crystalskin Ambuloid 

| 642 
| Cliknar Queen 

| 643 
| Cliknar Soldier 

| 644 
| Cliknar Worker 

| 645 
| Coldain 

| 646 
| Coldain 

| 647 
| Crystalskin Sessiloid 

| 648 
| Genari 

| 649 
| Gigyn 

| 650 
| Greken 

| 651 
| Greken 

| 652 
| Cliknar Mount 

| 653 
| Telmira 

| 654 
| Spider Mount 

| 655 
| Bear Mount 

| 656 
| Rat Mount 

| 657 
| Sessiloid Mount 

| 658 
| Morell Thule 

| 659 
| Marionette 

| 660 
| Book Dervish 

| 661 
| Topiary Lion 

| 662 
| Rotdog 

| 663 
| Amygdalan 

| 664 
| Sandman 

| 665 
| Grandfather Clock 

| 666 
| Gingerbread Man 

| 667 
| Royal Guard 

| 668 
| Rabbit 

| 669 
| Blind Dreamer 

| 670 
| Cazic Thule 

| 671 
| Topiary Lion Mount 

| 672 
| Rot Dog Mount 

| 673 
| Goral Mount 

| 674 
| Selyrah Mount 

| 675 
| Sclera Mount 

| 676 
| Braxi Mount 

| 677 
| Kangon Mount 

| 678 
| Erudite 

| 679 
| Wurm Mount 

| 680 
| Raptor Mount 

| 681 
| Invisible Man 

| 682 
| Whirligig 

| 683 
| Gnomish Balloon 

| 684 
| Gnomish Rocket Pack 

| 685 
| Gnomish Hovering Transport 

| 686 
| Selyrah 

| 687 
| Goral 

| 688 
| Braxi 

| 689 
| Kangon 

| 690 
| Invisible Man 

| 691 
| Floating Tower 

| 692 
| Explosive Cart 

| 693 
| Blimp Ship 

| 694 
| Tumbleweed 

| 695 
| Alaran 

| 696 
| Swinetor 

| 697 
| Triumvirate 

| 698 
| Hadal 

| 699 
| Hovering Platform 

| 700 
| Parasitic Scavenger 

| 701 
| Grendlaen 

| 702 
| Ship in a Bottle 

| 703 
| Alaran Sentry Stone 

| 704 
| Dervish 

| 705 
| Regeneration Pool 

| 706 
| Teleportation Stand 

| 707 
| Relic Case 

| 708 
| Alaran Ghost 

| 709 
| Skystrider 

| 710 
| Water Spout 

| 711 
| Aviak Pull Along 

| 712 
| Gelatinous Cube 

| 713 
| Cat 

| 714 
| Elk Head 

| 715 
| Holgresh 

| 716 
| Beetle 

| 717 
| Vine Maw 

| 718 
| Ratman 

| 719 
| Fallen Knight 

| 720 
| Flying Carpet 

| 721 
| Carrier Hand 

| 722 
| Akheva 

| 723 
| Servant of Shadow 

| 724 
| Luclin 

| 725 
| Xaric 

| 726 
| Dervish 

| 727 
| Dervish 

| 728 
| Luclin 

| 729 
| Luclin 

| 730 
| Orb 

| 731 
| Luclin 

| 732 
| Pegasus 

| 2250 
| Interactive Object 

| 2254 
| Node

---

## Action Types

*Source: server/npc/spawns/action-types/index.html*

# Action Types¶

| 

Action Type ID 
| Action Type Name 

| 0 
| Set Condition 

| 1 
| Add to Condition 

| 2 
| Subtract from Condition 

| 3 
| Multiply Condition 

| 4 
| Divide Condition

---

## Grids

*Source: server/npc/spawns/grids/index.html*

# Grids¶

- **#wpinfo** - Target an NPC and use this to retrieve WP information assigned to it.

- **#grid** add/delete grid_num wandertype pausetype - Adds grid grid_num with the wandertype/pausetype, or deletes grid number grid_num.

- **#wp** add/delete grid_num pause wp_num -h - Adds waypoint number wp_num to grid grid_num with a pause of pause on the location you're standing at, or deletes waypoint number wp_num in grid number grid_num. Use the -h switch to use your current heading as the heading for that waypoint.

- **#wpadd** [pause] [-h] - Adds a waypoint to a targeted NPC. If no grid is assigned, a new one will be created. Pause (default 0) and the heading switch are optional. As with #wp add, the heading switch will use your current heading.

## Wander Type:¶

- 0: Circular. NPC will cycle waypoints in order, then head back to the first waypoint.

- 1: Random 10. NPC will pick a random of the nearest 10 waypoints and go to it.

- 2: Random. NPCwill pick a random waypoint in the grid and go to it.

- 3: Patrol. NPC will walk the waypoints to the end, then turn and backtrack.

- 4: One Way. NPC will walk the waypoints to the end, then repop.

- 5: Random 5 LoS. NPC will pick a random of the nearest 5 waypoints within line of sight.

- 6: One Way. NPC will walk the waypoints to the end, then Depop.

- 7: Center Point. NPC will treat wp0 as center and move between it and a random wp.

- 8: Random Center Point. NPC will alternate between a random waypoint and a random waypoint that is marked as center point.

- 9: Random Path. Pick random waypoints, but follow path instead of heading there directly.

## Pause Type:¶

- 0: Random half. NPC pauses for half of it's pause time + random of half it's pause time.

- 1: Full. NPC pauses for full pause time.

- 2: Random. NPC pauses for random of it's pause time.

## Note:¶

- To setup an NPC to a grid, simply #gassign an NPC spawned by a certain spawn2 point, and all NPC's spawned by that point will adhere to the selected grid. An NPC assigned to a grid will simply start wandering it after spawning.

---

## NPC Despawn Types

*Source: server/npc/spawns/npc-despawn-types/index.html*

# NPC Despawn Types¶

| 

NPC Despawn Type ID 
| NPC Despawn Type Name 

| 0 
| None 

| 1 
| Repop 

| 2 
| Repop on Timer 

| 3 
| Depop 

| 4 
| Depop on Timer

---

## On Change Types

*Source: server/npc/spawns/on-change-types/index.html*

# On Change Types¶

| 

On Change Type ID 
| On Change Type Name 

| 0 
| Do Nothing 

| 1 
| Depop 

| 2 
| Repop 

| 3 
| Repop If Ready 

| 10 
| Signal

---

## Pause Types

*Source: server/npc/spawns/pause-types/index.html*

# Pause Types¶

| 

**Pause Type ID** 
| **Pause Type Name** 

| 0 
| Random Half 

| 1 
| Full 

| 2 
| Random Full

---

## Wander Types

*Source: server/npc/spawns/wander-types/index.html*

# Wander Types¶

Info

These Wander Types are assigned to a Grid to cause the behavior listed below as the NPC wanders through Grid Waypoint Entries.

 | 
 
 **ID**
 
 | Wander Type Name 
 | **Wander Type Description**

 | 0 
 | GridCircular 
 | Circle the points in order (IE 1 through 10); start back at first. 

 | 1 
 | GridRandom10 
 | Pick 10 random points from the grid set and cycle through. 

 | 2 
 | GridRandom 
 | Random; every point is randomly selected from the entire grid set. 

 | 3 
 | GridPatrol 
 | Patrol; walk way points in order (i.e. 1 through 10) and then reverse
 order (i.e. 10 through 1). 

 | 4 
 | GridOneWayRepop 
 | Go to the end and depop with spawn timer; walk waypoints in order (i.e.
 1 through 10), depop at final point, and repop at initial point after spawn
 timer. 

 | 5 
 | GridRand5LoS 
 | Pick random closest 5 and pick one that's in line of sight. 

 | 6 
 | GridOneWayDepop 
 | Go the end and depop without spawn timer; walk waypoints in order (i.e.
 1 through 10) and then depop. 

 | 7 
 | GridCenterPoint 
 | Initial point as the center, fan out to each grid point creating a "star
 burst" like pattern (1 - 2 - 1 - 4 - 1 - 3 - 1 - 5, etc.). 

 | 8 
 | GridRandomCenterPoint 
 | 
 
Initial point as the center, fan out to a random grid point.

Causes an NPC to alternate between a random waypoint in grid_entries and
 a random waypoint marked with the center point column set to true. If no
 waypoints are marked as a center point, this wander type will not work.
 There is no numbering requirement or limit for center points--you can have
 as many as you need.

 | 9 
 | GridRandomPath 
 | Randomly select a waypoint but follow path to it instead of walk directly
 to it ignoring walls.

---

## Special Attacks

*Source: server/npc/special-attacks/index.html*

# Special Attacks¶

## Summon (1)¶

Info

Summon, denoted by special attack 1 or "S" (old code), allows you to teleport the player to the NPC, or the NPC to the player.

| 

Setting 
| Description 
| Default 

| Level 
| 1 = Summon Target to NPC, 2 = Summon NPC to Target 
| No Default, Setting is Required 

| Parameter 0 
| Cooldown in Milliseconds 
| 6000 

| Parameter 1 
| HP ratio required to summon 
| 97 

### **Example:**¶

```
`1,1,2,10000,90
`
```

| 

Setting 
| Description 

| 1 
| Special Attack "Summon" 

| 1 
| Special Attack "Summon" enabled 

| 2 
| Summon npc to target enabled 

| 10000 
| 10 second cooldown 

| 90 
| Requires 90 percent or less HP 

## Enrage (2)¶

Info

Enrage, denoted by special attack 2 or "E" (old code), allows the NPC to riposte incoming melee attacks.

| 

Setting 
| Description 
| Default 

| Parameter 0 
| HP percent required to enrage 
| Rule: NPC:StartEnrageValue 

| Parameter 1 
| Duration of Special Attack in Milliseconds 
| 10000 

| Parameter 2 
| Cooldown of Special Attack in Milliseconds 
| 360000 

### **Example:**¶

```
`2,1,25,8000,60000
`
```

| 

Setting 
| Description 

| 2 
| Special Attack "Enrage" 

| 1 
| Special Attack "Enrage" enabled 

| 25 
| Begin Special Attack when HP reaches 25 percent 

| 8000 
| Special Attack will last 8 seconds 

| 60000 
| Special Attack will cooldown in 1 minute 

## Rampage (3)¶

Info

Rampage, denoted by special attack 3 or "R" (old code), allows the NPC to attack additional players.

| 

Setting 
| Description 
| Default 

| Parameter 0 
| Percent chance of Special Attack Proc 
| 20 percent 

| Parameter 1 
| Special Attack Target Count 
| Rule: Combat:MaxRampageTargets 

| Parameter 2 
| Percent of a normal attack damage to deal 
| 100 

| Parameter 3 
| Flat damage bonus to add to the Special Attack 
| 0 

| Parameter 4 
| Percent of AC ignored for the Special Attack 
| 0 

| Parameter 5 
| Flat amount of AC ignored for the Special Attack 
| 0 

| Parameter 6 
| Percent of natural crit used by this Special Attack 
| 100 

| Parameter 7 
| Flat crit bonus to add to base crit for the Special Attack 
| 0 

### **Example:**¶

```
`3,1,15,1,75
`
```

| 

Setting 
| Description 

| 3 
| Special Attack "Rampage" 

| 1 
| Special Attack "Rampage" enabled 

| 15 
| 15 percent chance to proc 

| 1 
| 1 target 

| 75 
| 75 percent of normal damage 

## Area Rampage (4)¶

Info

Area Rampage, denoted by special attack 4 or "r" (old code), allows the NPC to attack additional players.

| 

Setting 
| Description 
| Default 

| Parameter 0 
| Percent chance of Special Attack Proc 
| 20 percent 

| Parameter 1 
| Special Attack Target Count 
| -1 (all in range) 

| Parameter 2 
| Percent of a normal attack damage to deal 
| 100 

| Parameter 3 
| Flat damage bonus to add to the Special Attack 
| 0 

| Parameter 4 
| Percent of AC ignored for the Special Attack 
| 0 

| Parameter 5 
| Flat amount of AC ignored for the Special Attack 
| 0 

| Parameter 6 
| Percent of natural crit used by this Special Attack 
| 100 

| Parameter 7 
| Flat crit bonus to add to base crit for the Special Attack 
| 0 

### **Example:**¶

```
`4,1,15,-1,75
`
```

| 

Setting 
| Description 

| 4 
| Special Attack "Area Rampage" 

| 1 
| Special Attack "Area Rampage" enabled 

| 15 
| 15 percent chance to proc 

| -1 
| All targets within range 

| 75 
| 75 percent of normal damage 

## Flurry (5)¶

Info

Flurry, denoted by special attack 5 or "F" (old code), allows the NPC to have additional melee attacks against a player.

| 

Setting 
| Description 
| Default 

| Parameter 0 
| Percent chance of Special Attack Proc 
| Rule: Combat:NPCFlurryChance 

| Parameter 1 
| Special Attack count 
| Rule: Combat:MaxFlurryHits 

| Parameter 2 
| Percent of a normal attack damage to deal 
| 100 

| Parameter 3 
| Flat damage bonus to add to the Special Attack 
| 0 

| Parameter 4 
| Percent of AC ignored for the Special Attack 
| 0 

| Parameter 5 
| Flat amount of AC ignored for the Special Attack 
| 0 

| Parameter 6 
| Percent of natural crit used by this Special Attack 
| 100 

| Parameter 7 
| Flat crit bonus to add to base crit for the Special Attack 
| 0 

### **Example:**¶

```
`5,1,25,5,50
`
```

| 

Setting 
| Description 

| 5 
| Special Attack "Flurry" 

| 1 
| Special Attack "Flurry" enabled 

| 25 
| 25 percent chance to proc 

| 5 
| 5 added attacks 

| 50 
| 50 percent of normal damage 

## Triple Attack (6)¶

Info

Triple Attack, denoted by special attack 6 or "T" (old code), allows the NPC to have three melee attacks against a player.

| 

Setting 
| Description 
| Default 

| Toggle 
| 0 = Disabled, 1 = Enabled 
| 0 

### **Example:**¶

```
`6,1
`
```

| 

Setting 
| Description 

| 6 
| Special Attack "Triple Attack" 

| 1 
| Special Attack "Triple Attack" enabled 

## Quad Attack (7)¶

Info

Quad Attack, denoted by special attack 7 or "Q" (old code), allows the NPC to have four melee attacks against a player.

| 

Setting 
| Description 
| Default 

| Toggle 
| 0 = Disabled, 1 = Enabled 
| 0 

### **Example:**¶

```
`7,1
`
```

| 

Setting 
| Description 

| 7 
| Special Attack "Quad Attack" 

| 1 
| Special Attack "Quad Attack" enabled 

## Dual Wield (8)¶

Info

Dual Wield, denoted by special attack 8 or "L" (old code), allows the NPC to utilize two weapons.

| 

Setting 
| Description 
| Default 

| Toggle 
| 0 = Disabled, 1 = Enabled 
| 0 

### **Example:**¶

```
`8,1
`
```

| 

Setting 
| Description 

| 8 
| Special Attack "Dual Wield" 

| 1 
| Special Attack "Dual Wield" enabled 

## Bane Attack (9)¶

Info

Bane Attack, denoted by special attack 9 or "b" (old code), gives the NPC the ability to hit NPCs that require bane weapons to damage.

| 

Setting 
| Description 
| Default 

| Toggle 
| 0 = Disabled, 1 = Enabled 
| 0 

### **Example:**¶

```
`9,1
`
```

| 

Setting 
| Description 

| 9 
| Special Attack "Bane Attack" 

| 1 
| Special Attack "Bane Attack" enabled 

## Magical Attack (10)¶

Info

Magical Attack, denoted by special attack 10 or "m" (old code), gives the NPC the ability to hit NPCs that require magical weapons to damage.

| 

Setting 
| Description 
| Default 

| Toggle 
| 0 = Disabled, 1 = Enabled 
| 0 

### **Example:**¶

```
`10,1
`
```

| 

Setting 
| Description 

| 10 
| Special Attack "Magical Attack" 

| 1 
| Special Attack "Magical Attack" enabled 

## Ranged Attack (11)¶

Info

Ranged Attack, denoted by special attack 11 or "Y" (old code), gives the NPC the ability to perform ranged attacks if their target is out of melee range.

| 

Setting 
| Description 
| Default 

| Parameter 0 
| Minimum ranged distance 
| 25 

| Parameter 1 
| Maximum ranged distance 
| 250 

| Parameter 2 
| Percent hit chance modifier 
| 0 

| Parameter 3 
| Percent damage modifier 
| 0 

### **Example:**¶

```
`11,1,50
`
```

| 

Setting 
| Description 

| 11 
| Special Attack "Ranged Attack" 

| 1 
| Special Attack "Ranged Attack" enabled 

| 50 
| Minimum distance 50 units 

## Unslowable (12)¶

Info

Unslowable, denoted by special attack 12 or "U" (old code), makes the NPC immune to slow effects.

| 

Setting 
| Description 
| Default 

| Toggle 
| 0 = Disabled, 1 = Enabled 
| 0 

### **Example:**¶

```
`12,1
`
```

| 

Setting 
| Description 

| 12 
| Special Attack "Unslowable" 

| 1 
| Special Attack "Unslowable" enabled 

## Unmezable (13)¶

Info

Unmezable, denoted by special attack 13 or "M" (old code), makes the NPC immune to mesmerization effects.

| 

Setting 
| Description 
| Default 

| Toggle 
| 0 = Disabled, 1 = Enabled 
| 0 

### **Example:**¶

```
`13,1
`
```

| 

Setting 
| Description 

| 13 
| Special Attack "Unmezable" 

| 1 
| Special Attack "Unmezable" enabled 

## Uncharmable (14)¶

Info

Uncharmable, denoted by special attack 14 or "C" (old code), makes the NPC immune to charm effects.

| 

Setting 
| Description 
| Default 

| Toggle 
| 0 = Disabled, 1 = Enabled 
| 0 

### **Example:**¶

```
`14,1
`
```

| 

Setting 
| Description 

| 14 
| Special Attack "Uncharmable" 

| 1 
| Special Attack "Uncharmable" enabled 

## Unstunable (15)¶

Info

Unstunable, denoted by special attack 15 or "N" (old code), makes the NPC immune to stun effects.

| 

Setting 
| Description 
| Default 

| Toggle 
| 0 = Disabled, 1 = Enabled 
| 0 

### **Example:**¶

```
`15,1
`
```

| 

Setting 
| Description 

| 15 
| Special Attack "Unstunable" 

| 1 
| Special Attack "Unstunable" enabled 

## Unsnareable (16)¶

Info

Unsnareable, denoted by special attack 16 or "I" (old code), makes the NPC immune to snare effects.

| 

Setting 
| Description 
| Default 

| Toggle 
| 0 = Disabled, 1 = Enabled 
| 0 

### **Example:**¶

```
`16,1
`
```

| 

Setting 
| Description 

| 16 
| Special Attack "Unsnareable" 

| 1 
| Special Attack "Unsnareable" enabled 

## Unfearable (17)¶

Info

Unfearable, denoted by special attack 17 or "D" (old code), makes the NPC immune to fear effects.

| 

Setting 
| Description 
| Default 

| Toggle 
| 0 = Disabled, 1 = Enabled 
| 0 

### **Example:**¶

```
`17,1
`
```

| 

Setting 
| Description 

| 17 
| Special Attack "Unfearable" 

| 1 
| Special Attack "Unfearable" enabled 

## Immune to Dispell (18)¶

Info

Immune to Dispell, denoted by special attack 18 or "K" (old code), makes the NPC immune to dispelling spells.

| 

Setting 
| Description 
| Default 

| Toggle 
| 0 = Disabled, 1 = Enabled 
| 0 

### **Example:**¶

```
`18,1
`
```

| 

Setting 
| Description 

| 18 
| Special Attack "Immune to Dispell" 

| 1 
| Special Attack "Immune to Dispell" enabled 

## Immune to Melee (19)¶

Info

Immune to Melee, denoted by special attack 19 or "A" (old code), makes the NPC immune to all melee damage.

| 

Setting 
| Description 
| Default 

| Toggle 
| 0 = Disabled, 1 = Enabled 
| 0 

### **Example:**¶

```
`19,1
`
```

| 

Setting 
| Description 

| 19 
| Special Attack "Immune to Melee" 

| 1 
| Special Attack "Immune to Melee" enabled 

## Immune to Magic (20)¶

Info

Immune to Magic, denoted by special attack 20 or "B" (old code), makes the NPC immune to all magic spells.

| 

Setting 
| Description 
| Default 

| Toggle 
| 0 = Disabled, 1 = Enabled 
| 0 

### **Example:**¶

```
`20,1
`
```

| 

Setting 
| Description 

| 20 
| Special Attack "Immune to Magic" 

| 1 
| Special Attack "Immune to Magic" enabled 

## Immune to Fleeing (21)¶

Info

Immune to Fleeing, denoted by special attack 21 or "f" (old code), prevents the NPC from fleeing under any circumstances.

| 

Setting 
| Description 
| Default 

| Toggle 
| 0 = Disabled, 1 = Enabled 
| 0 

### **Example:**¶

```
`21,1
`
```

| 

Setting 
| Description 

| 21 
| Special Attack "Immune to Fleeing" 

| 1 
| Special Attack "Immune to Fleeing" enabled 

## Immune to Non-Bane Damage (22)¶

Info

Immune to Non-Bane Damage, denoted by special attack 22 or "O" (old code), prevents the NPC from being damaged by weapons that don't have the bane type matching its bodytype.

| 

Setting 
| Description 
| Default 

| Toggle 
| 0 = Disabled, 1 = Enabled 
| 0 

### **Example:**¶

```
`22,1
`
```

| 

Setting 
| Description 

| 22 
| Special Attack "Immune to Non-Bane Damage" 

| 1 
| Special Attack "Immune to Non-Bane Damage" enabled 

## Immune to Non-Magical Damage (23)¶

Info

Immune to Non-Magical Damage, denoted by special attack 23 or "W" (old code), prevents the NPC from being damaged by weapons that are not magical.

| 

Setting 
| Description 
| Default 

| Toggle 
| 0 = Disabled, 1 = Enabled 
| 0 

### **Example:**¶

```
`23,1
`
```

| 

Setting 
| Description 

| 23 
| Special Attack "Immune to Non-Bane Damage" 

| 1 
| Special Attack "Immune to Non-Bane Damage" enabled 

## Will Not Aggro (24)¶

Info

Will Not Aggro, denoted by special attack 24 or "H" (old code), prevents a player from getting on an NPC's hate list.

| 

Setting 
| Description 
| Default 

| Toggle 
| 0 = Disabled, 1 = Enabled 
| 0 

### **Example:**¶

```
`24,1
`
```

| 

Setting 
| Description 

| 24 
| Special Attack "Will Not Aggro" 

| 1 
| Special Attack "Will Not Aggro" enabled 

## Immune to Aggro (25)¶

Info

Immune to Aggro, denoted by special attack 25 or "G" (old code), prevents the NPC from getting on an NPC's hate list.

| 

Setting 
| Description 
| Default 

| Toggle 
| 0 = Disabled, 1 = Enabled 
| 0 

### **Example:**¶

```
`25,1
`
```

| 

Setting 
| Description 

| 25 
| Special Attack "Immune to Aggro" 

| 1 
| Special Attack "Immune to Aggro" enabled 

## Resist Ranged Spells (26)¶

Info

Resist Ranged Spells, denoted by special attack 26 or "g" (old code), prevents the NPC from being damaged from spells cast outside of melee range ("belly caster" mob).

| 

Setting 
| Description 
| Default 

| Toggle 
| 0 = Disabled, 1 = Enabled 
| 0 

### **Example:**¶

```
`26,1
`
```

| 

Setting 
| Description 

| 26 
| Special Attack "Resist Ranged Spells" 

| 1 
| Special Attack "Resist Ranged Spells" enabled 

## See through Feign Death (27)¶

| 

Setting 
| Description 
| Default 

| Toggle 
| 0 = Disabled, 1 = Enabled 
| 0 

### **Example:**¶

```
`27,1
`
```

| 

Setting 
| Description 

| 27 
| Special Attack "See through Feign Death" 

| 1 
| Special Attack "See through Feign Death" enabled 

## Immune to Taunt (28)¶

Info

Immune to Taunt, denoted by special attack 28 or "i" (old code), prevents the NPC from taunted by players.

| 

Setting 
| Description 
| Default 

| Toggle 
| 0 = Disabled, 1 = Enabled 
| 0 

### **Example:**¶

```
`28,1
`
```

| 

Setting 
| Description 

| 28 
| Special Attack "Immune to Taunt" 

| 1 
| Special Attack "Immune to Taunt" enabled 

## Tunnel Vision (29)¶

Info

Tunnel Vision, denoted by special attack 29 or "t" (old code), makes anyone not on the top of the hate list generate a different amount of hate.

| 

Setting 
| Description 
| Default 

| Parameter 0 
| aggro modifier 
| Rule: Aggro:TunnelVisionAggroMod 

### **Example:**¶

```
`29,1,0
`
```

| 

Setting 
| Description 

| 29 
| Special Attack "Tunnel Vision" 

| 1 
| Special Attack "Tunnel Vision" enabled 

| 0 
| aggro modifier 0 

## Does NOT buff/heal friends (30)¶

Info

Does NOT buff/heal friends, denoted by special attack 30 or "n" (old code), makes the NPC NOT buff or heal members of the same faction.

| 

Setting 
| Description 
| Default 

| Toggle 
| 0 = Disabled, 1 = Enabled 
| 0 

### **Example:**¶

```
`30,1
`
```

| 

Setting 
| Description 

| 30 
| Special Attack "Does NOT buff/heal friends" 

| 1 
| Special Attack "Does NOT buff/heal friends" enabled 

## Unpacifiable (31)¶

Info

Unpacifiable, denoted by special attack 31 or "p" (old code), makes the NPC immune to lull effects.

| 

Setting 
| Description 
| Default 

| Toggle 
| 0 = Disabled, 1 = Enabled 
| 0 

### **Example:**¶

```
`31,1
`
```

| 

Setting 
| Description 

| 31 
| Special Attack "Unpacifiable" 

| 1 
| Special Attack "Unpacifiable" enabled 

## Leashed (32)¶

Info

Leashed, denoted by special attack 32 or "J" (old code), makes the NPC return to their aggro point, fully heal, and wipes their hate list if the NPC is pulled out of a particular range.

| 

Setting 
| Description 
| Default 

| Parameter 0 
| range 
| aggro range * aggro range 

### **Example:**¶

```
`32,1,150
`
```

| 

Setting 
| Description 

| 32 
| Special Attack "Leashed" 

| 1 
| Special Attack "Leashed" enabled 

| 150 
| Leash at 150 units 

## Tethered (33)¶

Info

Tethered, denoted by special attack 33 or "j" (old code), is used to leashe the mob to their aggro range.

| 

Setting 
| Description 
| Default 

| Parameter 0 
| range 
| aggro range * aggro range 

### **Example:**¶

```
`33,1,100
`
```

| 

Setting 
| Description 

| 33 
| Special Attack "Tethered" 

| 1 
| Special Attack "Tethered" enabled 

| 100 
| Leash at 100 units 

## Destructible Object (34)¶

Info

Destructible Object, denoted by special attack 34 or "o" (old code), is used on destructing NPCs. (Deprecated?)

| 

Setting 
| Description 
| Default 

| Toggle 
| 0 = Disabled, 1 = Enabled 
| 0 

### **Example:**¶

```
`34,1
`
```

| 

Setting 
| Description 

| 34 
| Special Attack "Destructible Object" 

| 1 
| Special Attack "Destructible Object" enabled 

## No Harm from Players (35)¶

Info

No Harm from Players, denoted by special attack 35 or "Z" (old code), prevents players from being able to harm the NPC in any way.

| 

Setting 
| Description 
| Default 

| Toggle 
| 0 = Disabled, 1 = Enabled 
| 0 

### **Example:**¶

```
`35,1
`
```

| 

Setting 
| Description 

| 35 
| Special Attack "No Harm from Players" 

| 1 
| Special Attack "No Harm from Players" enabled 

## Always Flee (36)¶

Info

Always Flee, denoted by special attack 36, makes the NPC flee at low health even if faction allies are near.

| 

Setting 
| Description 
| Default 

| Toggle 
| 0 = Disabled, 1 = Enabled 
| 0 

### **Example:**¶

```
`36,1
`
```

| 

Setting 
| Description 

| 36 
| Special Attack "Always Flee" 

| 1 
| Special Attack "Always Flee" enabled 

## Flee Percentage (37)¶

Info

Flee Percentage, denoted by special attack 37, makes the NPC flee at low health even if faction allies are near, at a given percent.

| 

Setting 
| Description 
| Default 

| Parameter 0 
| Percent NPC will flee at 
| No Default, Setting is Required 

### **Example:**¶

```
`37,10
`
```

| 

Setting 
| Description 

| 37 
| Special Attack "Flee Percentage" 

| 10 
| Flee when health reaches 10 percent 

## Allow Beneficial (38)¶

Info

Allow Beneficial, denoted by special attack 38, allows players to cast beneficial spells on the NPC.

| 

Setting 
| Description 
| Default 

| Toggle 
| 0 = Disabled, 1 = Enabled 
| 0 

### **Example:**¶

```
`38,1
`
```

| 

Setting 
| Description 

| 38 
| Special Attack "Allow Beneficial" 

| 1 
| Special Attack "Allow Beneficial" enabled 

## Disable Melee (39)¶

Info

Disable Melee, denoted by special attack 39, makes the NPC unable to melee, but does allow the NPC to aggro.

| 

Setting 
| Description 
| Default 

| Toggle 
| 0 = Disabled, 1 = Enabled 
| 0 

### **Example:**¶

```
`39,1
`
```

| 

Setting 
| Description 

| 39 
| Special Attack "Disable Melee" 

| 1 
| Special Attack "Disable Melee" enabled 

## Chase Distance (40)¶

Info

Chase Distance, denoted by special attack 40, establishes the minimum and maximum distances between the NPC and an aggro player.

| 

Setting 
| Description 
| Default 

| Parameter 0 
| Maximum chase distance 
| No Default, Setting is Required 

| Parameter 1 
| Minimum chase distance 
| No Default, Setting is Required 

| Parameter 2 
| Ignore line of sight 
| false 

### **Example:**¶

```
`40,1,200,20
`
```

| 

Setting 
| Description 

| 40 
| Special Attack "Chase Distance" 

| 1 
| Special Attack "Chase Distance" enabled 

| 200 
| NPC will chase you if you're greater than 200 units away 

| 20 
| NPC will chase you if you're less than 20 units away 

## Allow Tank (41)¶

Info

Allow Tank, denoted by special attack 41, sets the NPC to allow other NPCs to take aggro from players.

| 

Setting 
| Description 
| Default 

| Toggle 
| 0 = Disabled, 1 = Enabled 
| 0 

### **Example:**¶

```
`41,1
`
```

| 

Setting 
| Description 

| 41 
| Special Attack "Allow Tank" 

| 1 
| Special Attack "Allow Tank" enabled 

## Ignore Root Aggro (42)¶

Info

Ignore Root Aggro, denoted by special attack 42, sets the NPC to ignore the rules of root aggro--the NPC will not attack the closest player, but rather the player on top of the hate list.

| 

Setting 
| Description 
| Default 

| Toggle 
| 0 = Disabled, 1 = Enabled 
| 0 

### **Example:**¶

```
`42,1
`
```

| 

Setting 
| Description 

| 42 
| Special Attack "Ignore Root Aggro" 

| 1 
| Special Attack "Ignore Root Aggro" enabled 

## Casting Resist Diff (43)¶

Info

Casting Resist Diff, denoted by special attack 43, makes the NPC's spells cast at a different resist level.

| 

Setting 
| Description 
| Default 

| Parameter 0 
| Flat modifier to the resist diff of the spell 
| 0 

### **Example:**¶

```
`43,1,-200
`
```

| 

Setting 
| Description 

| 43 
| Special Attack "Casting Resist Diff" 

| 1 
| Special Attack "Casting Resist Diff" enabled 

| -200 
| Add -200 to the resist modifier for the spell cast 

## Counter Avoid Damage (44)¶

Info

Counter Avoid Damage, denoted by special attack 44, makes the NPC more likely to hit a player, decreasing their chance for at avoiding melee through dodge/parry/riposte/etc.

| 

Setting 
| Description 
| Default 

| Parameter 0 
| Flat negative percent modifier to ALL avoidance skills 
| 0 

| Parameter 1 
| Flat negative percent modifier to Riposte skill 
| 0 

| Parameter 2 
| Flat negative percent modifier to Block skill 
| 0 

| Parameter 3 
| Flat negative percent modifier to Parry skill 
| 0 

| Parameter 4 
| Flat negative percent modifier to Dodge skill 
| 0 

### **Examples:**¶

```
`44,1,50
`
```

| 

Setting 
| Description 

| 44 
| Special Attack "Counter Avoid Damage" 

| 1 
| Special Attack "Counter Avoid Damage" enabled 

| 50 
| 50 percent reduction to ALL avoidance skills 

```
`44,1,0,0,0,0,50
`
```

| 

Setting 
| Description 

| 44 
| Special Attack "Counter Avoid Damage" 

| 1 
| Special Attack "Counter Avoid Damage" enabled 

| 0 
| 0 percent reduction to ALL avoidance skills 

| 0 
| 0 percent reduction to Riposte skill 

| 0 
| 0 percent reduction to Block skill 

| 0 
| 0 percent reduction to Parry skill 

| 50 
| 50 percent reduction to Dodge skill 

## Proximity Aggro (45)¶

Info

Proximity Aggro, denoted by special attack 45, allows the NPC to engage new clients while in combat if the client is within their proximity.

### **Example:**¶

```
`45,1
`
```

| 

Setting 
| Description 

| 45 
| Special Attack "Proximity Aggro" 

| 1 
| Special Attack "Proximity Aggro" enabled 

## Immune Ranged Attacks (46)¶

Info

Immune Ranged Attacks, denoted by special attack 46, makes the NPC immune to ranged attacks.

### **Example:**¶

```
`46,1
`
```

| 

Setting 
| Description 

| 46 
| Special Attack "Immune Ranged Attacks" 

| 1 
| Special Attack "Immune Ranged Attacks" enabled 

## Immune Client Damage (47)¶

Info

Immune Client Damage, denoted by special attack 47, makes the NPC immune to damage by clients.

### **Example:**¶

```
`47,1
`
```

| 

Setting 
| Description 

| 47 
| Special Attack "Immune Client Damage" 

| 1 
| Special Attack "Immune Client Damage" enabled 

## Immune NPC Damage (48)¶

Info

Immune NPC Damage, denoted by special attack 48, makes the NPC immune to damage by NPCs.

### **Example:**¶

```
`48,1
`
```

| 

Setting 
| Description 

| 48 
| Special Attack "Immune NPC Damage" 

| 1 
| Special Attack "Immune NPC Damage" enabled 

## Immune Client Aggro (49)¶

Info

Immune Client Aggro, denoted by special attack 49, makes the NPC immune to aggro by clients.

### **Example:**¶

```
`49,1
`
```

| 

Setting 
| Description 

| 49 
| Special Attack "Immune Client Aggro" 

| 1 
| Special Attack "Immune Client Aggro" enabled 

## Immune NPC Aggro (50)¶

Info

Immune NPC Aggro, denoted by special attack 50, makes the NPC immune to aggro by NPCs.

### **Example:**¶

```
`50,1
`
```

| 

Setting 
| Description 

| 50 
| Special Attack "Immune NPC Aggro" 

| 1 
| Special Attack "Immune NPC Aggro" enabled 

## Modify Avoid Damage (51)¶

Info

Modify Avoid Damage, denoted by special attack 51, allows you to modify specific avoidances for an NPC.

| 

Setting 
| Description 
| Default 

| Parameter 0 
| Flat percent modifier to ALL avoidance skills 
| 0 

| Parameter 1 
| Flat percent modifier to Riposte skill 
| 0 

| Parameter 2 
| Flat percent modifier to Block skill 
| 0 

| Parameter 3 
| Flat percent modifier to Parry skill 
| 0 

| Parameter 4 
| Flat percent modifier to Dodge skill 
| 0 

### **Examples:**¶

```
`51,1,50
`
```

| 

Setting 
| Description 

| 51 
| Special Attack "Modify Avoid Damage" 

| 1 
| Special Attack "Modify Avoid Damage" enabled 

| 50 
| 50 percent increase to ALL avoidance skills 

```
`51,1,0,0,0,0,50
`
```

| 

Setting 
| Description 

| 51 
| Special Attack "Modify Avoid Damage" 

| 1 
| Special Attack "Modify Avoid Damage" enabled 

| 0 
| 0 percent increase to ALL avoidance skills 

| 0 
| 0 percent increase to Riposte avoidance skill 

| 0 
| 0 percent increase to Block avoidance skill 

| 0 
| 0 percent increase to Parry avoidance skill 

| 50 
| 50 percent increase to Dodge avoidance skill 

## Immune Fading Memories (52)¶

Info

Immune Fading Memories, denoted by special attack 52, makes the NPC immune to memory fades.

### **Example:**¶

```
`52,1
`
```

| 

Setting 
| Description 

| 52 
| Special Attack "Immune Fading Memories" 

| 1 
| Special Attack "Immune Fading Memories" enabled 

## Immune to Open (53)¶

Info

Immune to Open, denoted by special attack 53, makes the NPC immune to /open.

### **Example:**¶

```
`53,1
`
```

| 

Setting 
| Description 

| 53 
| Special Attack "Immune to Open" 

| 1 
| Special Attack "Immune to Open" enabled 

## Immune to Assassinate (54)¶

Info

Immune to Assassinate, denoted by special attack 54, makes the NPC immune to being Assassinated.

### **Example:**¶

```
`54,1
`
```

| 

Setting 
| Description 

| 54 
| Special Attack "Immune to Assassinate" 

| 1 
| Special Attack "Immune to Assassinate" enabled 

## Immune to Headshot (55)¶

Info

Immune to Headshot, denoted by special attack 55, makes the NPC immune to being Headshotted.

### **Example:**¶

```
`55,1
`
```

| 

Setting 
| Description 

| 55 
| Special Attack "Immune to Headshot" 

| 1 
| Special Attack "Immune to Headshot" enabled 

## Immune to Bot Aggro (56)¶

Info

Immune to Bot Aggro, denoted by special attack 56, makes the NPC immune to Bot Aggro.

### **Example:**¶

```
`56,1
`
```

| 

Setting 
| Description 

| 56 
| Special Attack "Immune to Bot Aggro" 

| 1 
| Special Attack "Immune to Bot Aggro" enabled 

## Immune to Bot Damage (57)¶

Info

Immune to Bot Damage, denoted by special attack 57, makes the NPC immune to Bot Damage.

### **Example:**¶

```
`57,1
`
```

| 

Setting 
| Description 

| 57 
| Special Attack "Immune to Bot Damage" 

| 1 
| Special Attack "Immune to Bot Damage" enabled

---

## Stuck Behavior

*Source: server/npc/stuck-behavior/index.html*

# Stuck Behavior¶

| 

Behavior 
| Desc 

| 0 
| RunToTarget 

| 1 
| WarpToTarget 

| 2 
| TakeNoAction 

| 3 
| EvadeCombat 

| 4 
| MaxStuckBehavior

---

## Textures

*Source: server/npc/textures/index.html*

# Textures¶

| 

Texture ID 
| Texture Name 

| 0 
| Naked for Player Races 

| 1 
| Cloth for Player Races 

| 2 
| Chain for Player Races 

| 3 
| Plate for Player Races 

| 4 
| Leather for Player Races 

| 5 
| NPC Race Only 

| 6 
| NPC Race Only 

| 7 
| NPC Race Only 

| 8 
| NPC Race Only 

| 9 
| NPC Race Only 

| 10 
| NPC Race Only 

| 11 
| Robe 1 for Player Races 

| 12 
| Robe 2 for Player Races 

| 13 
| Robe 3 for Player Races 

| 14 
| Robe 4 for Player Races 

| 15 
| Robe 5 for Player Races 

| 16 
| Robe 6 for Player Races 

| 17 
| Velious Leather 1 

| 18 
| Velious Chain 1 

| 19 
| Velious Plate 1 

| 20 
| Velious Leather 2 

| 21 
| Velious Chain 2 

| 22 
| Velious Plate 2 

| 23 
| Velious Monk 

| 240 
| Velious Helmets 

## Velious Textures¶

The following lines must exist in your client file "eqclient.ini" in order for Velious textures to load properly on the client:

```
`LoadArmor17=TRUE
LoadArmor18=TRUE
LoadArmor19=TRUE
LoadArmor20=TRUE
LoadArmor21=TRUE
LoadArmor22=TRUE
LoadArmor23=TRUE
LoadArmor240=TRUE
`
```

In order to use Velious helmet textures on an item the **idfile** field should be "IT240" and the **material** field should be 240. The client determines which helmet model to load based on the race and gender of the player that equips it.

---

## Adjust Maximum Level

*Source: server/operation/adjust-maximum-level/index.html*

# Adjust Maximum Level¶

So you want to take your server to the next level? There are a lot of old posts about this, and the ones Google likes to show are all missing a crucial detail. There are four variables that contain this data. They are all in the rule_values table. I don't see a page for this, so here it goes.

*In this example I'm setting the Max Level to 100; change this value as needed.*

**1)** Open a MySQL Admin tool (Heidi, OmniDB, MySQL Workbench, etc.) and connect to the eqemu database for your server.

**2)** Run the following SQL Statements:

`UPDATE eqemu.rule_values SET rule_value = 100 WHERE rule_name = "Character:MaxLevel"`

`UPDATE eqemu.rule_values SET value = 100 WHERE rule_name = "Character:MaxExpLevel"`

**3)** Verify

`SELECT * FROM rule_values WHERE rule_name = "Character:MaxLevel" OR rule_name = "Character:MaxExpLevel"`

You should have 4 records returned. If everything looks correct, proceed to step 4.

**4)** Restart your server.

*Thanks to Akkadius for the clue on multiple variables.*

---

## Adjust World Date / Time

*Source: server/operation/adjust-world-date-time/index.html*

# Adjust World Date / Time¶

The **eqtime.cfg** file is used to establish the current World date and time and synchronize your conditions, spawn timers, etc. It is a text file located in your server root folder.

The file contains the following:

```
`EQ Time Version (Default: 1000)
Day
Hour
Minute
Month
Year
Real Time
`
```

Sample file contents (PEQ 2013-12-21):

```
`1000
8
1
0
1
3513
1387620078
`
```

---

## Changing Start Zones

*Source: server/operation/changing-start-zones/index.html*

# Changing Start Zones¶

## Description¶

You can change the starting zone for characters on a per race/class and deity basis, as well as for Titanium or SOF+ clients. This is separate from the Tutorial zone- this can be enabled/disabled as required. Note: the tutorial may teleport players to POK regardless of what you set.

Warning

**NB:** The variable "startzone" in the variables table is no longer used. Any references to this are deprecated.

You might wish to have a different starting zone for Titanium clients than SOF+ in case you wish to use a zone that is not available in the Titanium install. If you go wrong somewhere in the process, SOF+ clients will put players in Crescent Reach. Titanium clients will end up in the old default city (Gnomes in Ak'anon, Wood Elves in Kelethin etc)

## Method¶

The method is relatively simple: First, insert a row into the rule_values table called World:TitaniumStartZoneID (for Titanium clients) and one for World:SofStartZoneID (for all other clients) with a value that matches the corresponding zoneidnumber of the zone you wish them to start in (you will also need to provide x,y,z values too. Ensure that the ruleset_id field for the rule is is set to 1, or if you have specified as default ruleset in the variables table, that the ruleset _id matches that. The slight trick here is that the variables table uses the ruleset name, but the rule_values table uses its number,

Secondly, insert a row in start_zones for each class/deity/race combination for each of the zones you specify. If the start zone is the same for both types of client, you only need one row per combination, but if you have two different start zones depending on client then there will need to be two . e.g. I want a different start zone for Titanium and SOF clients. For a dwarf warrior of Brell Serilis, I would need to have two entries: one with a zone id of the Titanium zone, and one with the SOF+ zone. I would need to repeat this for all combinations.

## Example¶

I wish all Titanium players to start in Plane of Knowledge, and all SOF+ clients to start in Goru.kar Mesa. On my server I have defined a rule_set with a ruleset_id of **3** and a name of MyDefault. In my variables table I would insert (or update) a row whose varname is RuleSet and has a value of MyDefault.

Then I would create a row in rule_values with a ruleset_id of **3**, a rule_name of World:SofStartZoneID and a rule_value of 397 (Goru.kar Mesa)

Then I would create a row in rule_values with a ruleset_id of **3**, a rule_name of World:TitmniumStartZoneID and a rule_value of 20 (Plane of Knowledge).

I would then create (or more likely update) rows in start_zones for each class/deity/race combination, one for zone 202, one for zone 397.

---

## Chat Channel Types

*Source: server/operation/chat-channel-types/index.html*

# Chat Channel Types¶

Also see emote colors

| 

**ID** 
| **Code** 
| **Notes** 

| 0 
| CC_WhiteSmoke 
| F0F0F0 

| 1 
| CC_DimGray 
| 606060 

| 2 
| CC_Green 
| 008000 

| 3 
| CC_BrightBlue 
| 0040FF 

| 5 
| CC_Magenta 
| F000F0 

| 6 
| CC_Gray 
| 808080 

| 7 
| CC_LightGray 
| E0E0E0 

| 10 
| //CC_WhiteSmoke2 
| F0F0F0 

| 12 
| CC_DarkGray 
| A0A0A0 

| 13 
| CC_Red 
| F00000 

| 14 
| CC_Lime 
| 00F000 

| 15 
| CC_Yellow 
| F0F000 

| 16 
| CC_Blue 
| 0000F0 

| 17 
| CC_LightNavy 
| 0000AF 

| 18 
| CC_Cyan 
| 00F0F0 

| 20 
| CC_Black 
| 000000 

| 256 
| MT_Say 
| Say 

| 257 
| MT_Tell 
| Tell 

| 258 
| MT_Group 
| Group 

| 259 
| MT_Guild 
| Guild 

| 260 
| MT_OOC 
| OOC 

| 261 
| MT_Auction 
| Auction 

| 262 
| MT_Shout 
| Shout 

| 263 
| MT_Emote 
| Emote 

| 264 
| MT_Spells 
| Spells 

| 265 
| MT_YouHitOther 
| YouHitOther 

| 266 
| MT_OtherHitsYou 
| OtherHitsYou 

| 267 
| MT_YouMissOther 
| YouMissOther 

| 268 
| MT_OtherMissesYou 
| OtherMissesYou 

| 269 
| MT_Broadcasts 
| Broadcasts 

| 270 
| MT_Skills 
| Skills 

| 271 
| MT_Disciplines 
| Disciplines 

| 272 
| MT_Unused1 
| Unused1 

| 273 
| MT_DefaultText 
| DefaultText 

| 274 
| MT_Unused2 
| Unused2 

| 275 
| MT_MerchantOffer 
| MerchantOffer 

| 276 
| MT_MerchantBuySell 
| MerchantBuySell 

| 277 
| MT_YourDeath 
| YourDeath 

| 278 
| MT_OtherDeath 
| OtherDeath 

| 279 
| MT_OtherHits 
| OtherHits 

| 280 
| MT_OtherMisses 
| OtherMisses 

| 281 
| MT_Who 
| Who 

| 282 
| MT_YellForHelp 
| YellForHelp 

| 283 
| MT_NonMelee 
| NonMelee 

| 284 
| MT_WornOff 
| WornOff 

| 285 
| MT_MoneySplit 
| MoneySplit 

| 286 
| MT_LootMessages 
| LootMessages 

| 287 
| MT_DiceRoll 
| DiceRoll 

| 288 
| MT_OtherSpells 
| OtherSpells 

| 289 
| MT_SpellFailure 
| SpellFailure 

| 290 
| MT_Chat 
| Chat 

| 291 
| MT_Channel1 
| Channel1 

| 292 
| MT_Channel2 
| Channel2 

| 293 
| MT_Channel3 
| Channel3 

| 294 
| MT_Channel4 
| Channel4 

| 295 
| MT_Channel5 
| Channel5 

| 296 
| MT_Channel6 
| Channel6 

| 297 
| MT_Channel7 
| Channel7 

| 298 
| MT_Channel8 
| Channel8 

| 299 
| MT_Channel9 
| Channel9 

| 300 
| MT_Channel10 
| Channel10 

| 301 
| MT_CritMelee 
| CritMelee 

| 302 
| MT_SpellCrits 
| SpellCrits 

| 303 
| MT_TooFarAway 
| TooFarAway 

| 304 
| MT_NPCRampage 
| NPCRampage 

| 305 
| MT_NPCFlurry 
| NPCFlurry 

| 306 
| MT_NPCEnrage 
| NPCEnrage 

| 307 
| MT_SayEcho 
| SayEcho 

| 308 
| MT_TellEcho 
| TellEcho 

| 309 
| MT_GroupEcho 
| GroupEcho 

| 310 
| MT_GuildEcho 
| GuildEcho 

| 311 
| MT_OOCEcho 
| OOCEcho 

| 312 
| MT_AuctionEcho 
| AuctionEcho 

| 313 
| MT_ShoutECho 
| ShoutECho 

| 314 
| MT_EmoteEcho 
| EmoteEcho 

| 315 
| MT_Chat1Echo 
| Chat1Echo 

| 316 
| MT_Chat2Echo 
| Chat2Echo 

| 317 
| MT_Chat3Echo 
| Chat3Echo 

| 318 
| MT_Chat4Echo 
| Chat4Echo 

| 319 
| MT_Chat5Echo 
| Chat5Echo 

| 320 
| MT_Chat6Echo 
| Chat6Echo 

| 321 
| MT_Chat7Echo 
| Chat7Echo 

| 322 
| MT_Chat8Echo 
| Chat8Echo 

| 323 
| MT_Chat9Echo 
| Chat9Echo 

| 324 
| MT_Chat10Echo 
| Chat10Echo 

| 325 
| MT_DoTDamage 
| DoTDamage 

| 326 
| MT_ItemLink 
| ItemLink 

| 327 
| MT_RaidSay 
| RaidSay 

| 328 
| MT_MyPet 
| MyPet 

| 329 
| MT_DS 
| DS 

| 330 
| MT_Leadership 
| Leadership 

| 331 
| MT_PetFlurry 
| PetFlurry 

| 332 
| MT_PetCrit 
| PetCrit 

| 333 
| MT_FocusEffect 
| FocusEffect 

| 334 
| MT_Experience 
| Experience 

| 335 
| MT_System 
| System 

| 336 
| MT_PetSpell 
| PetSpell 

| 337 
| MT_PetResponse 
| PetResponse 

| 338 
| MT_ItemSpeech 
| ItemSpeech 

| 339 
| MT_StrikeThrough 
| StrikeThrough 

| 340 
| MT_Stun 
| Stun

---

## DBStr Types

*Source: server/operation/dbstr-types/index.html*

# DBStr Types¶

## Types¶

| 

**ID** 
| **Description** 

| 0 
| Descriptions for all of the banners added in The Buried Sea expansion. 

| 1 
| AA title. 

| 2 
| First line of a 2-line spell name. Also applicable to AA hotkeys. 

| 3 
| Second line of a 2-line spell name. Also applicable to AA hotkeys. 

| 4 
| AA description. 

| 5 
| Corresponds to the typedescnum and effectdescnum columns in spells_new . 

| 6 
| Spells. 

| 7 
| Lore Group. 

| 8 
| Race descriptions shown at character creation. 

| 9 
| Class descriptions shown at character creation. 

| 10 
| Stat's description shown at character creation. 

| 11 
| Races. 

| 12 
| Plural form of Races. 

| 13 
| Classes. 

| 14 
| Deity description shown at character creation. 

| 15 
| Starting City descriptions, ID is the Zone ID. 

| 16 
| Augment Type descriptions, ID is the Augment Type. 

| 17 
| Names of currencies for The Buried Sea. 

| 18 
| Plural names of currencies for The Buried Sea. 

| 19 
| Names of special AA categories. 

| 20 
| Names of the Expansions. 

## Rain of Fear Types¶

| 

**ID** 
| **Description** 

| 0 
| Descriptions for all of the banners added in The Buried Sea expansion. 

| 1 
| AA title. 

| 2 
| First line of a 2-line spell name. Also applicable to AA hotkeys. 

| 3 
| Second line of a 2-line spell name. Also applicable to AA hotkeys. 

| 4 
| AA description. 

| 5 
| Corresponds to the typedescnum and effectdescnum columns in spells_new . 

| 6 
| Spells. 

| 7 
| Lore Group. 

| 8 
| Race descriptions shown at character creation. 

| 9 
| Class descriptions shown at character creation. 

| 10 
| Stat's description shown at character creation. 

| 11 
| Races. 

| 12 
| Plural form of Races. 

| 13 
| Classes. 

| 14 
| Deity description shown at character creation. 

| 15 
| Starting city descriptions, ID is the Zone ID. 

| 16 
| Aug type descriptions, ID is the Augment Type. 

| 17 
| Names of currencies for The Buried Sea. 

| 18 
| Plural names of currencies for The Buried Sea. 

| 19 
| Names of special AA categories. 

| 20 
| Names of the Expansions. 

| 21 
| Mercenary type/race. 

| 22 
| Mercenary tier text. 

| 23 
| Extended mercenary race/type descriptions. 

| 24 
| Mercenary stance names. 

| 25 
| Extended mercenary stance text. 

| 26 
| Mercenary stance text. 

| 71 
| Brellium Token. 

 | 

 Symbols used in spell descriptions that pull data from spells_new

# effect_base_value# [ie #1 for effect1]

$ effect_limit_value#

@ max#

%z buffduration

---

## Disabling Lootdrop Entries

*Source: server/operation/disabling-lootdrops/index.html*

# Disabling Lootdrop Entries¶

Did you know that you can disable lootdrop entries in a way that allows you to restore them later? This overlooked feature will allow you to turn off certain lootdrop entries--perhaps those that are out of era for your server, and easily turn them back on later.

Info

A "disabled" loot drop entry simply means that the item will no longer have the possibility of dropping when the NPC is killed.

### Using PEQ Database Editor¶

In the PEQ Database editor, you'll notice that there is a button with two red arrows pointing downward. This button allows you to disable a lootdrop entry.

Once you click the button, the lootdrop entry is then disabled, and the icon changes to two blue arrows pointing upwards. Clicking the arrow again toggles the state and the item is once again enabled for dropping. 

Info

Note that the chance goes to '0' when disabled, and returns to its previous value once re-enabled. We used this functionality to **preserve the original value** in case we want to **retrieve it later**.

How does this work? Is it magic? The function becomes apparent if you utilize an sql query to achieve the same results. 

### Using an SQL Query¶

If you wanted to globally disable an item from dropping, you can also use an sql query. This may be quite a bit more efficient than visiting each and every lootdrop table utilizing the PEQ Database editor.

For this example, we will disable all lootdrop entries for item ID 5015 - Rusty Scythe, using an sql query. The purpose of this query is to make use of a field in the lootdrop_entries table called 'disabled_chance', which will store the original drop chance value until we choose to enable it again.

First, let's take a look at our database to see the item listed in its corresponding lootdrop_entries. Notice the "chance" column, which is used to set the probability of the item dropping when the NPC is killed.

As of this writing, there are 161 lootdrop_entries containing a 5015 - Rusty Scythe. If we want to turn off drops of this item, but do so in a manner that allows us to restore them later, we can run the following query:

```
`UPDATE lootdrop_entries
SET disabled_chance = chance, chance = 0
WHERE item_id = 5015
`
```

The result is that the normal drop chance is moved into the disabled chance field, allowing us to retrieve it later, should we decide to re-enable drops. Notice that all the values simply move to the adjacent field.

Since the "chance" of the Rusty Scythe dropping has been reduced to 0, we will no longer have to endure those bothersome drops. The Disabled Chance field does nothing--it is simply a placeholder for the old drop chance value.

If we would like to enable Rusty Scythes to drop again, we would have to reverse the order of our query:

```
`UPDATE lootdrop_entries
SET chance = disabled_chance, disabled_chance = 0
WHERE item_id = 5015
`
```

And we can then see that we have restored the values we moved to our disabled_chance field, once again allowing the Rusty Scythe to drop in our world:

That's all there is to it! Enjoy a world free from those unwanted loots, and a clever method to disable loots in a non-destructive manner.

## Advanced Topic¶

It's possible that you may find yourself in a situation where you would like to disable lootdrop entries from individual NPCs and move them to a global loottable. For instance, if you do not want to have hundreds of loottables containing trade skill items, you could easily disable the lootdrop entries using the method above and then add those items to a global loottable.

But what if you had already added items to a global loottable and you wanted to disable all of the individual lootdrops entries? It can be done:

```
`-- Disable all lootdrop entries EXCEPT global loot entries
UPDATE lootdrop_entries AS lde
INNER JOIN loottable_entries AS le
 ON lde.lootdrop_id = le.lootdrop_id
INNER JOIN global_loot AS gl
 ON le.loottable_id = gl.loottable_id
SET lde.disabled_chance = lde.chance, lde.chance = 0
 WHERE lde.item_id = 1234567
 AND gl.enabled != 1
`
```

Since the `global_loot` table has a field `loottable_id`, we make a join with the `loottable_entries` table on the matching `loottable_id` field, and join the `loottable_entries` table with the `lootdrop_entries` table on the `lootdrop_id` field.

As before, we simply specify our item id (listed as "1234567" in the example above) in the `WHERE` clause, and presume that the global loot entry is enabled to make our match. 

If you're considering moving items like tradeskill items to a global loottable, it is probably best to disable their lootdrop entries first, and keep track of your changes, and then add them to a global loottable.

---

## Disabling Merchantlist Entries

*Source: server/operation/disabling-merchantlist-entries/index.html*

# Disabling Merchantlist Entries¶

Did you know that you can disable merchantlist entries in a way that allows you to restore them later? Most merchantlist entries have a probability of 100--meaning that the merchant will always have the item (there are very few exceptions). 

If you would like to disable any particular item from the merchant's inventory, perhaps those that are out of era for your server, and easily turn them back on later, follow the steps below.

### Using PEQ Database Editor¶

Navigate to the Loot tab in PEQ Database Editor, select the Zone and the Merchant in which you are interested. You will see a listing of the merchant's wares:

Note the field that shows Probability Req--this is the probability that the merchant will have the item. To Edit this field, select the "Edit this Merchant" button, which looks like a stack of papers:

Once you're in edit mode, you can change the probability to '0' to indicate that there's NO chance this merchant will stock the item.

Once you've made your changes, scroll down and click the "Submit Changes" button. There is now no chance that the merchant will stock the item. You can easily re-enable the item at a later time by returning the probability required field to 100 percent.

The advantage of this method of disabling items available on a merchant is that you can turn them off and on without deleting the record permanently. If you delete the item altogether, if you choose to add it again later, you will have to input the ID, buy price, sell price, faction, etc. so that the merchant can once again sell the item.

Info

If you want to see this change in-game immediately, you can use the command **#reloadmerchants**, which is documented on the Loading Server Data page.

### Using an SQL Query¶

You can also easily disable merchantlist entries globally by using an sql query. Since the probability that a merchant will have an item is typically 100 percent, you can utilize a query for any item ID to set the probability to 0--disabling the item from being sold.

If we want to see how many merchantlist entries contain item ID 15323 - Spell: Eye of Zomm, we can simply filter (query) the merchanlist entries for this item by ID.

To disable this item so that merchants no longer keep it in stock, while preserving the entry in the merchantlist, we issue a simple query:

```
`UPDATE `merchantlist`
SET probability = 0
WHERE item = 15323
`
```

The result is that the probability of the item being in stock is now 0, and players will no longer find this item for sale in our world:

Info

If you want to see this change in-game immediately, you can use the command **#reloadmerchants**, which is documented on the Loading Server Data page.

To re-enable the item, a simple query can be used to reverse our change:

```
`UPDATE `merchantlist`
SET probability = 100
WHERE item = 15323
`
```

That's all there is to it! Enjoy a world free from those unwanted merchantlist entries, and a clever method to disable them in a non-destructive manner.

---

## Expansion Bitmasks

*Source: server/operation/expansion-bitmasks/index.html*

# Expansion Bitmasks¶

| 

ID 
| Token 
| Value (int) 
| Value (hex) 

| 0 
| bitEverQuest 
| 0 
| 0x00000000 

| 1 
| bitRoK 
| 1 
| 0x00000001 

| 2 
| bitSoV 
| 2 
| 0x00000002 

| 3 
| bitSoL 
| 4 
| 0x00000004 

| 4 
| bitPoP 
| 8 
| 0x00000008 

| 5 
| bitLoY 
| 16 
| 0x00000010 

| 6 
| bitLDoN 
| 32 
| 0x00000020 

| 7 
| bitGoD 
| 64 
| 0x00000040 

| 8 
| bitOoW 
| 128 
| 0x00000080 

| 9 
| bitDoN 
| 256 
| 0x00000100 

| 10 
| bitDoD 
| 512 
| 0x00000200 

| 11 
| bitPoR 
| 1024 
| 0x00000400 

| 12 
| bitTSS 
| 2048 
| 0x00000800 

| 13 
| bitTBS 
| 4096 
| 0x00001000 

| 14 
| bitSoF 
| 8192 
| 0x00002000 

| 15 
| bitSoD 
| 16384 
| 0x00004000 

| 16 
| bitUF 
| 32768 
| 0x00008000 

| 17 
| bitHoT 
| 65536 
| 0x00010000 

| 18 
| bitVoA 
| 131072 
| 0x00020000 

| 19 
| bitRoF 
| 262144 
| 0x00040000 

| 

ID 
| Token 
| Value (int) 
| Value (hex) 

| 0 
| maskEverQuest 
| 0 
| 0x00000000 

| 1 
| maskRoK 
| 1 
| 0x00000001 

| 2 
| maskSoV 
| 3 
| 0x00000003 

| 3 
| maskSoL 
| 7 
| 0x00000007 

| 4 
| maskPoP 
| 15 
| 0x0000000F 

| 5 
| maskLoY 
| 31 
| 0x0000001F 

| 6 
| maskLDoN 
| 63 
| 0x0000003F 

| 7 
| maskGoD 
| 127 
| 0x0000007F 

| 8 
| maskOoW 
| 255 
| 0x000000FF 

| 9 
| maskDoN 
| 511 
| 0x000001FF 

| 10 
| maskDoD 
| 1023 
| 0x000003FF 

| 11 
| maskPoR 
| 2047 
| 0x000007FF 

| 12 
| maskTSS 
| 4095 
| 0x00000FFF 

| 13 
| maskTBS 
| 8191 
| 0x00001FFF 

| 14 
| maskSoF 
| 16383 
| 0x00003FFF 

| 15 
| maskSoD 
| 32767 
| 0x00007FFF 

| 16 
| maskUF 
| 65535 
| 0x0000FFFF 

| 17 
| maskHoT 
| 131071 
| 0x0001FFFF 

| 18 
| maskVoA 
| 262143 
| 0x0003FFFF 

| 19 
| maskRoF 
| 524287 
| 0x0007FFFF

---

## Expansion List

*Source: server/operation/expansion-list/index.html*

# Expansion List¶

| 

ID 
| Token 
| Name 

| 0 
| EverQuest 
| Default: No Expansions Enabled 

| 1 
| RoK 
| The Ruins of Kunark 

| 2 
| SoV 
| The Scars of Velious 

| 3 
| SoL 
| The Shadows of Luclin 

| 4 
| PoP 
| The Planes of Power 

| 5 
| LoY 
| The Legacy of Ykesha 

| 6 
| LDoN 
| Lost Dungeons of Norrath 

| 7 
| GoD 
| Gates of Discord 

| 8 
| OoW 
| Omens of War 

| 9 
| DoN 
| Dragons of Norrath 

| 10 
| DoD 
| Depths of Darkhollow 

| 11 
| PoR 
| Prophecy of Ro 

| 12 
| TSS 
| The Serpent's Spine 

| 13 
| TBS 
| The Buried Sea 

| 14 
| SoF 
| Secrets of Faydwer 

| 15 
| SoD 
| Seeds of Destruction 

| 16 
| UF 
| Underfoot 

| 17 
| HoT 
| House of Thule 

| 18 
| VoA 
| Veil of Alaris 

| 19 
| RoF 
| Rain of Fear 

| 20 
| CotF 
| Call of the Forsaken 

| 21 
| TDS 
| The Darkened Sea 

| 22 
| TBM 
| The Broken Mirror 

| 23 
| EoK 
| Empires of Kunark 

| 24 
| RoS 
| Ring of Scale 

| 25 
| TBL 
| The Burning Lands 

| 26 
| ToV 
| Torment of Velious

---

## Exporting Client Files

*Source: server/operation/exporting-client-files/index.html*

# Exporting Client Files¶

Your EQEmu Server comes with a built in script to automatically generate a number of key files. Using this guide will help you get set up to output those files so that you can share them with your players.

Warning

As always, make backups of your files before replacing or updating them!

## Client Files¶

When we're discussion "Client Files", we are specifically referring to some key files that keep your client and server in sync:

| 

File Name 
| Content 

| BaseData.txt 
| An ASCII export of your base_data table, which contains information regarding class "base" stats, such as HP, Mana and Endurance by level. 

| dbstr_us.txt 
| An ASCII export of your db_str table, which contains the text that is displayed to a player character from various sources, such as spells or trades. 

| SkillCaps.txt 
| An ASCII export of your skill_caps table, which contains information about skills (1HS, 1HB, Abjuration, etc.) by class and level. 

| spells_us.txt 
| An ASCII export of your spells_new table, which contains information about all of the spells in use in your world. 

Info

Be sure to read out Client Spell Limitations before exporting your client files!

### Exporting for the First Time Requires an Extra Step¶

Since it's your first time, be sure to go slow and use lots of ...care. You probably do not have a folder that the export script will look for; this folder is where the resultant files will be placed after the export script is run. You will need to create this folder in the root directory of your EQEmu Server Install.

Info

You only need to do this the first time--afterwards, you can skip to the section below and Run the Export Script.

**First, navigate to your root server folder:**

```
`cd /home/eqemu/server
`
```

This example uses the default install directory; obviously you would navigate to your server directory if you chose to install the server in a different location.

**Then, create the necessary directory:**

```
`mkdir export
`
```

### Run the Export Script¶

In your main server folder, you will see a symlink to the client file exporter script. Run this script to create your files. 

Warning

When you run this script, it will happily overwrite the contents of your server/export directory. If you want to keep old copies of your Client Files, you should back them up before executing.

```
`./export_client_files
`
```

If you receive an error that the folder doesn't exist, please go back to the "Exporting for the First Time..." step above.

If you were successful, navigate to your *export* folder and you should see four files listed:

```
`[root@localhost server]# cd export
[root@localhost export]# ls
BaseData.txt dbstr_us.txt SkillCaps.txt spells_us.txt
`
```

You can now distribute these files to your players so that their client will match your EQEmu World Server settings.

---

## First Time Running A Server

*Source: server/operation/first-time-running-a-server/index.html*

# First Time Running A Server¶

### How to set a character to GM Status¶

- Log in to your server with the character you wish to make a GM

- Log out to the character selection screen.

- Go into your SQL editor of choice (or command line) and change account.status to 255.

- Log in and enjoy GM commands (typing #help will give you a list of commands)

For example, in Linux step three would look something like this:

```
`$ mysql -u my_db_username -p
mysql> use eqemu;
mysql> UPDATE account SET status = 255 WHERE charname = 'my_character_name';
mysql> quit;
`
```

In this example, `my_db_username` is the username that you set for the MySQL database during server installation and `my_character_name` is the name of the character you setting to GM status.

You may find the account table schema a useful reference as well.

### What can I do once I'm a GM?¶

For a list of commands you can use once you've elevated an account to GM status, see In Game Command Reference. This reference can also be found in the table of contents on the right under Reference Lists.

---

## Implement PvP

*Source: server/operation/implement-pvp/index.html*

# Implement PvP¶

Note: PVP Is currently a work in progress.

To emulate the original Everquest PVP servers, the only rule you have to adjust is the PVPSettings one.

### World:PVPSettings¶

| 

Value 
| Name 
| Desc 

| 0 
| Disabled 
| Default, No PVP Enabled 

| 1 
| Rallos Zek 
| Not yet supported 

| 2 
| TZ/VZ 
| Partial Support 

| 4 
| Sullon Zek 
| Partial support 

| 6 
| Discord 
| Partial Support 

| 7+ 
| Discord+ (Any value above 6) 
| Discord without the no-drop restrictions removed 

Rules from this point onward are optional, and allow you the ability to customize your PVP server beyond the classic PVP rules. If you enable PVPSettings then adjust the below, most values will override defaults. Some exceptions include PVPLootCoin (once true by above PVPSettings, it cannot be turned off without setting PVPSettings to 0).

### World:PVPMinLevel¶

minimum level pvp is enabled

| 

Default 
| RZ 
| TV/VZ 
| SZ 

| 0 
| 1 
| ? 
| 6 

### World:PVPUseDeityBasedPVP¶

use deity based pvp alignment (agnostic is neutral)

| 

Default 
| RZ 
| TV/VZ 
| SZ 

| false 
| false 
| false 
| true 

### World:PVPUseTeamsBySizeBasedPVP¶

use racial size based pvp alignment (drakkin is human group)

| 

Default 
| RZ 
| TV/VZ 
| SZ 

| false 
| false 
| true 
| false 

The teams are as follows:

- Team 1: Human, Barbarian, Erudite, Drakkin

- Team 2: Gnome, Halfling, Dwarf, Froglok

- Team 3: High Elf, Wood Elf, Half Elf, Vahshir

- Team 4: Dark Elf, Ogre, Troll, Iksar

- **Note: The above teams may be inaccurate. If you can source a reference to correct this, please let Shin know**

### World:PVPLevelDifference¶

Players with a difference greater than value will not be attackable

| 

Default 
| RZ 
| TV/VZ 
| SZ 

| 0 
| 4 
| ? 
| 6 

### World:PVPLoseExperienceLevelDifference¶

Players lose experience if killed by a player within level difference

| 

Default 
| RZ 
| TV/VZ 
| SZ 

| 0 
| 0 
| ? 
| 5 

### World:PVPPetDamageMitigation¶

Pet damage is mitigated by this amount

| 

Default 
| RZ 
| TV/VZ 
| SZ 

| 50 
| 100 
| ? 
| ? 

### World:PVPMeleeMitigation¶

Melee is mitigated by this amount

| 

Default 
| RZ 
| TV/VZ 
| SZ 

| 67 
| 100 
| ? 
| ? 

### World:PVPSpellMitigation¶

Spells are mitigated by this amount

| 

Default 
| RZ 
| TV/VZ 
| SZ 

| 67 
| 67 
| ? 
| ? 

### World:PVPRangedMitigation¶

Ranged attacks are mitigated by this amount

| 

Default 
| RZ 
| TV/VZ 
| SZ 

| 80 
| 100 
| ? 
| ? 

### World:PVPCanLootCoin¶

Can players loot coin from player corpses?

| 

Default 
| RZ 
| TV/VZ 
| SZ 

| false 
| true 
| true 
| true 

### Spells:PVPRootBreakFromSpells¶

Chance for root to break when cast on by a client (20% more than native root)

| 

Default 
| RZ 
| TV/VZ 
| SZ 

| 75 
| 75 
| 75 
| 75 

### Character:PVPRespawnManaPercent¶

Percent of mana to respawn with

| 

Default 
| RZ 
| TV/VZ 
| SZ 

| 100 
| 0 
| 0 
| 0 

### Inventory:PVPCanLootNoTrade¶

Can players loot no trade items from player corpses?

| 

Default 
| RZ 
| TV/VZ 
| SZ 

| false 
| false 
| false 
| false 

### Inventory:PVPCanLootContainer¶

Can players loot bags/containers from player corpses?

| 

Default 
| RZ 
| TV/VZ 
| SZ 

| false 
| false 
| false 
| false 

### Inventory:PVPLootableEquipSlots¶

When looting a player's corpse, equipped items in slots listed here are lootable. 0 means all slots are lootable

| 

Default 
| RZ 
| TV/VZ 
| SZ 

| 0 
| 0 
| 0 
| 0

---

## Commands Reference

*Source: server/operation/in-game-command-reference/index.html*

# Commands Reference

Info

This page lists the commands that are available in-game, based on assigned Account Status, for your EQEmu Server.

| 

Command 
| Description 
| Status Level 

| #acceptrules 
| [acceptrules] - Accept the EQEmu Agreement 
| Player (0) 

| #advnpcspawn 
| [maketype|makegroup|addgroupentry|addgroupspawn][removegroupspawn|movespawn|editgroupbox|cleargroupbox] 
| GMLeadAdmin (150) 

| #aggrozone 
| [aggro] - Aggro every mob in the zone with X aggro. Default is 0. Not recommend if you're not invulnerable. 
| GMAdmin (100) 

| #ai 
| [factionid/spellslist/con/guard/roambox/stop/start] - Modify AI on NPC target 
| GMAdmin (100) 

| #appearance 
| [type] [value] - Send an appearance packet for you or your target 
| GMLeadAdmin (150) 

| #appearanceeffects 
| [Help|Remove|Set|View] - Modify appearance effects on yourself or your target. 
| GMAdmin (100) 

| #apply_shared_memory 
| [shared_memory_name] - Tells every zone and world to apply a specific shared memory segment by name. 
| GMImpossible (250) 

| #attack 
| [Entity Name] - Make your NPC target attack an entity by name 
| GMLeadAdmin (150) 

| #augmentitem 
| Force augments an item. Must have the augment item window open. 
| GMImpossible (250) 

| #ban 
| [Character Name] [Reason] - Ban by character name 
| GMLeadAdmin (150) 

| #bugs 
| [Close|Delete|Review|Search|View] - Handles player bug reports 
| QuestTroupe (80) 

| #bot 
| Type #bot help or ^help to the see the list of available commands for bots. 
| Player (0) 

| #camerashake 
| [Duration (Milliseconds)] [Intensity (1-10)] - Shakes the camera on everyone's screen globally. 
| QuestTroupe (80) 

| #castspell 
| [Spell ID] [Instant (0 = False, 1 = True, Default is 1 if Unused)] - Cast a spell 
| Guide (50) 

| #chat 
| [Channel ID] [Message] - Send a channel message to all zones 
| GMMgmt (200) 

| #clearxtargets 
| Clears XTargets 
| Player (0) 

| #copycharacter 
| [source_char_name] [dest_char_name] [dest_account_name] - Copies character to destination account 
| GMImpossible (250) 

| #corpse 
| Manipulate corpses, use with no arguments for help 
| Guide (50) 

| #corpsefix 
| Attempts to bring corpses from underneath the ground within close proximity of the player 
| Player (0) 

| #countitem 
| [Item ID] - Counts the specified Item ID in your or your target's inventory 
| GMLeadAdmin (150) 

| #damage 
| [Amount] - Damage yourself or your target 
| GMAdmin (100) 

| #databuckets 
| View|Delete [key] [limit]- View data buckets, limit 50 default or Delete databucket by key 
| QuestTroupe (80) 

| #dbspawn2 
| [Spawngroup ID] [Respawn] [Variance] [Condition ID] [Condition Minimum] - Spawn an NPC from a predefined row in the spawn2 table, Respawn and Variance are in Seconds (condition is optional) 
| GMAdmin (100) 

| #delacct 
| [Account ID|Account Name] - Delete an account by ID or Name 
| GMLeadAdmin (150) 

| #delpetition 
| [petition number] - Delete a petition 
| ApprenticeGuide (20) 

| #depop 
| [Start Spawn Timer] - Depop your NPC target and optionally start their spawn timer (false by default) 
| Guide (50) 

| #depopzone 
| [Start Spawn Timers] - Depop the zone and optionally start spawn timers (false by default) 
| GMAdmin (100) 

| #devtools 
| [menu|window] [enable|disable] - Manages Developer Tools (send no parameter for menu) 
| GMMgmt (200) 

| #disablerecipe 
| [Recipe ID] - Disables a Recipe 
| QuestTroupe (80) 

| #disarmtrap 
| Analog for ldon disarm trap for the newer clients since we still don't have it working. 
| QuestTroupe (80) 

| #door 
| Door editing command 
| QuestTroupe (80) 

| #doanim 
| [Animation ID|Animation Name] [Speed] - Send an animation by ID or name at the specified speed to you or your target (Speed is optional) 
| Guide (50) 

| #dye 
| [slot|'help'] [red] [green] [blue] [use_tint] - Dyes the specified armor slot to Red, Green, and Blue provided, allows you to bypass darkness limits. 
| ApprenticeGuide (20) 

| #dz 
| Manage expeditions and dynamic zone instances 
| QuestTroupe (80) 

| #dzkickplayers 
| Removes all players from current expedition. (/kickplayers alternative for pre-RoF clients) 
| Player (0) 

| #editmassrespawn 
| [name-search] [second-value] - Mass (Zone wide) NPC respawn timer editing command 
| GMAdmin (100) 

| #emote 
| [Name|World|Zone] [type] [message] - Send an emote message by name, to the world, or to your zone (^ separator allows multiple messages to be sent at once) 
| QuestTroupe (80) 

| #emptyinventory 
| Clears your or your target's entire inventory (Equipment, General, Bank, and Shared Bank) 
| GMImpossible (250) 

| #enablerecipe 
| [Recipe ID] - Enables a Recipe 
| QuestTroupe (80) 

| #entityvariable 
| [clear|delete|set|view] - Modify entity variables for yourself or your target 
| GMAdmin (100) 

| #exptoggle 
| [Toggle] - Toggle your or your target's experience gain. 
| QuestTroupe (80) 

| #faction 
| [Find (criteria | all ) | Review (criteria | all) | Reset (id)] - Resets Player's Faction 
| QuestTroupe (80) 

| #factionassociation 
| [factionid] [amount] - triggers a faction hits via association 
| GMLeadAdmin (150) 

| #feature 
| Change your or your target's feature's temporarily 
| QuestTroupe (80) 

| #size 
| Change your targets size (alias of #feature size) 
| QuestTroupe (80) 

| #find 
| Search command used to find various things 
| Guide (50) 

| #fish 
| Fish for an item 
| QuestTroupe (80) 

| #fixmob 
| [race|gender|texture|helm|face|hair|haircolor|beard|beardcolor|heritage|tattoo|detail] [next|prev] - Manipulate appearance of your target 
| QuestTroupe (80) 

| #flagedit 
| Edit zone flags on your target. Use #flagedit help for more info. 
| GMAdmin (100) 

| #fleeinfo 
| - Gives info about whether a NPC will flee or not, using the command issuer as top hate. 
| QuestTroupe (80) 

| #forage 
| Forage an item 
| QuestTroupe (80) 

| #gearup 
| Developer tool to quickly equip yourself or your target 
| GMMgmt (200) 

| #giveitem 
| [itemid] [charges] - Summon an item onto your target's cursor. Charges are optional. 
| GMMgmt (200) 

| #givemoney 
| [Platinum] [Gold] [Silver] [Copper] - Gives specified amount of money to you or your player target 
| GMMgmt (200) 

| #gmzone 
| [Zone ID|Zone Short Name] [Version] [Instance Identifier] - Zones to a private GM instance (Version defaults to 0 and Instance Identifier defaults to 'gmzone' if not used) 
| GMAdmin (100) 

| #goto 
| [playername] or [x y z] [h] - Teleport to the provided coordinates or to your target 
| Steward (10) 

| #grantaa 
| [level] - Grants a player all available AA points up the specified level, all AAs are granted if no level is specified. 
| GMMgmt (200) 

| #grid 
| [add/delete] [grid_num] [wandertype] [pausetype] - Create/delete a wandering grid 
| GMAreas (170) 

| #guild 
| Guild manipulation commands. Use argument help for more info. 
| Steward (10) 

| #help 
| [Search Criteria] - List available commands and their description, specify partial command as argument to search 
| Player (0) 

| #hotfix 
| [hotfix_name] - Reloads shared memory into a hotfix, equiv to load_shared_memory followed by apply_shared_memory 
| GMImpossible (250) 

| #hp 
| Refresh your HP bar from the server. 
| Player (0) 

| #instance 
| Modify Instances 
| GMMgmt (200) 

| #interrogateinv 
| use [help] argument for available options 
| Player (0) 

| #interrupt 
| [Message ID] [Color] - Interrupt your casting. Arguments are optional. 
| Guide (50) 

| #invsnapshot 
| Manipulates inventory snapshots for your current target 
| QuestTroupe (80) 

| #ipban 
| [IP] - Ban IP 
| GMMgmt (200) 

| #kick 
| [Character Name] - Disconnect a player by name 
| GMLeadAdmin (150) 

| #kill 
| Kill your target 
| GMAdmin (100) 

| #killallnpcs 
| [npc_name] - Kills all npcs by search name, leave blank for all attackable NPC's 
| GMMgmt (200) 

| #list 
| [npcs|players|corpses|doors|objects] [search] - Search entities 
| ApprenticeGuide (20) 

| #lootsim 
| [npc_type_id] [loottable_id] [iterations] - Runs benchmark simulations using real loot logic to report numbers and data 
| GMImpossible (250) 

| #load_shared_memory 
| [shared_memory_name] - Reloads shared memory and uses the input as output 
| GMImpossible (250) 

| #loc 
| Print out your or your target's current location and heading 
| Player (0) 

| #logs 
| Manage anything to do with logs 
| GMImpossible (250) 

| #makepet 
| [Pet Name] - Make a pet 
| Guide (50) 

| #memspell 
| [Spell ID] [Spell Gem] - Memorize a Spell by ID to the specified Spell Gem for you or your target 
| Guide (50) 

| #merchantshop 
| Closes or opens your target merchant's shop 
| GMAdmin (100) 

| #modifynpcstat 
| [Stat] [Value] - Modifies an NPC's stats temporarily. 
| GMLeadAdmin (150) 

| #movechar 
| [Character ID|Character Name] [Zone ID|Zone Short Name] - Move an offline character to the specified zone 
| Guide (50) 

| #movement 
| Various movement commands 
| GMMgmt (200) 

| #myskills 
| Show details about your current skill levels 
| Player (0) 

| #mysql 
| [Help|Query] [SQL Query] - Mysql CLI, see 'Help' for options. 
| GMImpossible (250) 

| #mystats 
| Show details about you or your pet 
| Guide (50) 

| #npccast 
| [targetname/entityid] [spellid] - Causes NPC target to cast spellid on targetname/entityid 
| QuestTroupe (80) 

| #npcedit 
| [column] [value] - Mega NPC editing command 
| GMAdmin (100) 

| #npceditmass 
| [name-search] [column] [value] - Mass (Zone wide) NPC data editing command 
| GMAdmin (100) 

| #npcemote 
| [Message] - Make your NPC target emote a message. 
| GMLeadAdmin (150) 

| #npcloot 
| Manipulate the loot an NPC is carrying. Use #npcloot help for more information. 
| QuestTroupe (80) 

| #npcsay 
| [Message] - Make your NPC target say a message. 
| GMLeadAdmin (150) 

| #npcshout 
| [Message] - Make your NPC target shout a message. 
| GMLeadAdmin (150) 

| #npcspawn 
| [create/add/update/remove/delete] - Manipulate spawn DB 
| GMAreas (170) 

| #npctypespawn 
| [NPC ID] [Faction ID] - Spawn an NPC by ID from the database with an option of setting its Faction ID 
| Steward (10) 

| #nudge 
| Nudge your target's current position by specific values 
| QuestTroupe (80) 

| #nukebuffs 
| [Beneficial|Detrimental|Help] - Strip all buffs by type on you or your target (no argument to remove all buffs) 
| Guide (50) 

| #nukeitem 
| [Item ID] - Removes the specified Item ID from you or your player target's inventory 
| GMLeadAdmin (150) 

| #object 
| List|Add|Edit|Move|Rotate|Copy|Save|Undo|Delete - Manipulate static and tradeskill objects within the zone 
| GMAdmin (100) 

| #opcode 
| Reloads all opcodes from server patch files 
| GMMgmt (200) 

| #parcels 
| View and edit the parcel system. Requires parcels to be enabled in rules. 
| GMMgmt (200) 

| #path 
| view and edit pathing 
| GMMgmt (200) 

| #peqzone 
| [Zone ID|Zone Short Name] - Teleports you to the specified zone if you meet the requirements. 
| Player (0) 

| #petitems 
| View your pet's items if you have one 
| ApprenticeGuide (20) 

| #picklock 
| Analog for ldon pick lock for the newer clients since we still don't have it working. 
| Player (0) 

| #profanity 
| Manage censored language. 
| GMLeadAdmin (150) 

| #push 
| [Back Push] [Up Push] - Lets you do spell push on an NPC 
| GMLeadAdmin (150) 

| #raidloot 
| [All|GroupLeader|RaidLeader|Selected] - Sets your Raid Loot Type if you have permission to do so. 
| Player (0) 

| #randomfeatures 
| Temporarily randomizes the Facial Features of your target 
| QuestTroupe (80) 

| #refreshgroup 
| Refreshes Group for you or your player target. 
| Player (0) 

| #reload 
| Reloads different types of server data globally, use no argument for help menu. 
| GMMgmt (200) 

| #rq 
| Reloads quests (alias of #reload quests). 
| GMMgmt (200) 

| #rl 
| Reloads logs (alias of #reload logs). 
| GMMgmt (200) 

| #removeitem 
| [Item ID] [Amount] - Removes the specified Item ID by Amount from you or your player target's inventory (Amount defaults to 1 if not used) 
| GMAdmin (100) 

| #repop 
| [Force] - Repop the zone with optional force repop 
| GMAdmin (100) 

| #resetaa 
| [aa|leadership] - Resets a player's AAs or Leadership AAs and refunds spent AAs (not Leadership AAs) to unspent, may disconnect player. 
| GMMgmt (200) 

| #resetaa_timer 
| [All|Timer ID] - Command to reset AA cooldown timers for you or your player target. 
| GMMgmt (200) 

| #resetdisc_timer 
| [All|Timer ID] - Command to reset discipline timers. 
| GMMgmt (200) 

| #revoke 
| [Character Name] [0|1] - Revokes or unrevokes a player's ability to talk in OOC by name (0 = Unrevoke, 1 = Revoke) 
| GMMgmt (200) 

| #roambox 
| [Remove|Set] [Box Size] [Delay (Milliseconds)] - Remove or set an NPC's roambox size and delay 
| GMMgmt (200) 

| #rules 
| (subcommand) - Manage server rules 
| GMImpossible (250) 

| #save 
| Force your player or player corpse target to be saved to the database 
| Guide (50) 

| #scale 
| Handles NPC scaling 
| GMLeadAdmin (150) 

| #scribespell 
| [Spell ID] - Scribe a spell by ID to your or your target's spell book. 
| GMCoder (180) 

| #scribespells 
| [Max level] [Min level] - Scribe all spells for you or your player target that are usable by them, up to level specified. (may freeze client for a few seconds) 
| GMLeadAdmin (150) 

| #sendzonespawns 
| Refresh spawn list for all clients in zone 
| GMLeadAdmin (150) 

| #sensetrap 
| Analog for ldon sense trap for the newer clients since we still don't have it working. 
| Player (0) 

| #serverrules 
| Show server rules 
| Player (0) 

| #set 
| Set command used to set various things 
| Guide (50) 

| #show 
| Show command used to show various things 
| Guide (50) 

| #shutdown 
| Shut this zone process down 
| GMLeadAdmin (150) 

| #spawn 
| [name] [race] [level] [material] [hp] [gender] [class] [priweapon] [secweapon] [merchantid] - Spawn an NPC 
| Steward (10) 

| #spawneditmass 
| [Search Criteria] [Edit Option] [Edit Value] [Apply] Mass editing spawn command (Apply is optional, 0 = False, 1 = True, default is False) 
| GMLeadAdmin (150) 

| #spawnfix 
| Find targeted NPC in database based on its X/Y/heading and update the database to make it spawn at your current location/heading. 
| GMAreas (170) 

| #stun 
| [duration] - Stuns you or your target for duration 
| GMAdmin (100) 

| #summon 
| [Character Name] - Summons your corpse, NPC, or player target, or by character name if specified 
| QuestTroupe (80) 

| #summonburiedplayercorpse 
| Summons the target's oldest buried corpse, if any exist. 
| GMAdmin (100) 

| #summonitem 
| [itemid] [charges] - Summon an item onto your cursor. Charges are optional. 
| GMMgmt (200) 

| #suspend 
| [name] [days] [reason] - Suspend by character name and for specificed number of days 
| GMLeadAdmin (150) 

| #suspendmulti 
| [Character Name One|Character Name Two|etc] [Days] [Reason] - Suspend multiple characters by name for specified number of days 
| GMLeadAdmin (150) 

| #takeplatinum 
| [Platinum] - Takes specified amount of platinum from you or your player target 
| GMMgmt (200) 

| #task 
| (subcommand) - Task system commands 
| GMLeadAdmin (150) 

| #petname 
| [newname] - Temporarily renames your pet. Leave name blank to restore the original name. 
| GMAdmin (100) 

| #traindisc 
| [level] - Trains all the disciplines usable by the target, up to level specified. (may freeze client for a few seconds) 
| GMLeadAdmin (150) 

| #tune 
| Calculate statistical values related to combat. 
| GMAdmin (100) 

| #undye 
| Remove dye from all of your or your target's armor slots 
| GMAdmin (100) 

| #unmemspell 
| [Spell ID] - Unmemorize a Spell by ID for you or your target 
| Guide (50) 

| #unmemspells 
| Unmemorize all spells for you or your target 
| Guide (50) 

| #unscribespell 
| [Spell ID] - Unscribe a spell from your or your target's spell book by Spell ID 
| GMCoder (180) 

| #unscribespells 
| Clear out your or your player target's spell book. 
| GMCoder (180) 

| #untraindisc 
| [Spell ID] - Untrain your or your target's discipline by Spell ID 
| GMCoder (180) 

| #untraindiscs 
| Untrains all disciplines from your target. 
| GMCoder (180) 

| #wc 
| [Slot ID] [Material] [Hero Forge Model] [Elite Material] - Sets the specified slot for you or your target to a material, Hero Forge Model and Elite Material are optional 
| GMMgmt (200) 

| #worldshutdown 
| Shut down world and all zones 
| GMMgmt (200) 

| #wp 
| [add|delete] [grid_id] [pause] [waypoint_id] [-h] - Add or delete a waypoint by grid ID. (-h to use current heading) 
| GMAreas (170) 

| #wpadd 
| [pause] [-h] - Add your current location as a waypoint to your NPC target's AI path. (-h to use current heading) 
| GMAreas (170) 

| #worldwide 
| Performs world-wide GM functions such as cast (can be extended for other commands). Use caution 
| GMImpossible (250) 

| #zone 
| [Zone ID|Zone Short Name] [X] [Y] [Z] - Teleport to specified Zone by ID or Short Name (coordinates are optional) 
| Guide (50) 

| #zonebootup 
| [ZoneServerID] [shortname] - Make a zone server boot a specific zone 
| GMLeadAdmin (150) 

| #zoneinstance 
| [Instance ID] [X] [Y] [Z] - Teleport to specified Instance by ID (coordinates are optional) 
| Guide (50) 

| #zoneshutdown 
| [shortname] - Shut down a zone server 
| GMLeadAdmin (150) 

| #zsave 
| Saves zheader to the database 
| QuestTroupe (80) 

| 

Command 
| Subcommand 
| Usage 

| #find 
| aa 
| #find aa [Search Criteria] 

| #find 
| body_type 
| #find body_type [Search Criteria] 

| #find 
| bug_category 
| #find bug_category [Search Criteria] 

| #find 
| character 
| #find character [Search Criteria] 

| #find 
| class 
| #find class [Search Criteria] 

| #find 
| comparison_type 
| #find comparison_type [Search Criteria] 

| #find 
| currency 
| #find currency [Search Criteria] 

| #find 
| deity 
| #find deity [Search Criteria] 

| #find 
| emote 
| #find emote [Search Criteria] 

| #find 
| faction 
| #find faction [Search Criteria] 

| #find 
| item 
| #find item [Search Criteria] 

| #find 
| language 
| #find language [Search Criteria] 

| #find 
| ldon_theme 
| #find ldon_theme [Search Criteria] 

| #find 
| object_type 
| #find object_type [Search Criteria] 

| #find 
| race 
| #find race [Search Criteria] 

| #find 
| recipe 
| #find recipe [Search Criteria] 

| #find 
| skill 
| #find skill [Search Criteria] 

| #find 
| special_ability 
| #find special_ability [Search Criteria] 

| #find 
| stance 
| #find stance [Search Criteria] 

| #find 
| spell 
| #find spell [Search Criteria] 

| #find 
| task 
| #find task [Search Criteria] 

| #find 
| zone 
| #find zone [Search Criteria] 

| #find 
| bot 
| #find bot [Search Criteria] 

| #set 
| aa_exp 
| #set aa_exp [aa|group|raid] [Amount] 

| #set 
| aa_points 
| #set aa_points [aa|group|raid] [Amount] 

| #set 
| adventure_points 
| #set adventure_points [Theme ID] [Amount] 

| #set 
| alternate_currency 
| #set alternate_currency [Currency ID] [Amount] 

| #set 
| animation 
| #set animation [Animation ID] 

| #set 
| anon 
| #set anon [Character ID] [Anonymous Flag] or #set anon [Anonymous Flag] 

| #set 
| auto_login 
| #set auto_login [0|1] 

| #set 
| bind_point 
| #set bind_point 

| #set 
| checksum 
| #set checksum 

| #set 
| class_permanent 
| #set class_permanent [Class ID] 

| #set 
| crystals 
| #set crystals [ebon|radiant] [Amount] 

| #set 
| date 
| #set date [Year] [Month] [Day] [Hour] [Minute] (Hour and Minute are optional) 

| #set 
| endurance 
| #set endurance [Amount] 

| #set 
| endurance_full 
| #set endurance_full 

| #set 
| exp 
| #set exp [aa|exp] [Amount] 

| #set 
| flymode 
| #set flymode [Flymode ID] 

| #set 
| frozen 
| #set frozen [on|off] 

| #set 
| gender 
| #set gender [Gender ID] 

| #set 
| gender_permanent 
| #set gender_permanent [Gender ID] 

| #set 
| gm 
| #set gm [on|off] 

| #set 
| gm_speed 
| #set gm_speed [on|off] 

| #set 
| gm_status 
| #set gm_status [GM Status] [Account] 

| #set 
| god_mode 
| #set god_mode [on|off] 

| #set 
| haste 
| #set haste [Percentage] 

| #set 
| hide_me 
| #set hide_me [on|off] 

| #set 
| hero_model 
| #set hero_model [Hero Model] [Slot] (Slot is optional) 

| #set 
| hp 
| #set hp [Amount] 

| #set 
| hp_full 
| #set hp_full 

| #set 
| invulnerable 
| #set invulnerable 

| #set 
| language 
| #set language [Language ID] [Language Level] 

| #set 
| last_name 
| #set last_name [Last Name] 

| #set 
| level 
| #set level [Level] 

| #set 
| loginserver_info 
| #set loginserver_info [Email] [Password] 

| #set 
| mana 
| #set mana [Amount] 

| #set 
| mana_full 
| #set mana_full 

| #set 
| motd 
| #set motd 

| #set 
| name 
| #set name 

| #set 
| ooc_mute 
| #set ooc_mute 

| #set 
| password 
| #set password [Account Name] [Password] (account table password) 

| #set 
| pvp 
| #set pvp [on|off] 

| #set 
| pvp_points 
| #set pvp_points [Amount] 

| #set 
| race 
| #set race [Race ID] 

| #set 
| race_permanent 
| #set race_permanent [Race ID] 

| #set 
| server_locked 
| #set server_locked [on|off] 

| #set 
| skill 
| #set skill [Skill ID] [Skill Level] 

| #set 
| skill_all 
| #set skill_all [Skill Level] 

| #set 
| skill_all_max 
| #set skill_all_max 

| #set 
| start_zone 
| #set endurance [Amount] 

| #set 
| temporary_name 
| #set temporary_name [Name] 

| #set 
| texture 
| #set texture [Texture ID] 

| #set 
| time 
| #set time [Hour] [Minute] 

| #set 
| time_zone 
| #set time_zone [Hour] [Minute] 

| #set 
| title 
| #set title [Title] 

| #set 
| title_suffix 
| #set title_suffix [Title Suffix] 

| #set 
| temporary_name 
| #set temporary_name [Name] 

| #set 
| weather 
| #set weather [0|1|2|3] 

| #set 
| zone 
| #set zone [option] 

| #show 
| aas 
| #show aas 

| #show 
| aa_points 
| #show aa_points 

| #show 
| aggro 
| #show aggro [Distance] [-v] (-v is verbose Faction Information) 

| #show 
| auto_login 
| #show auto_login 

| #show 
| buffs 
| #show buffs 

| #show 
| buried_corpse_count 
| #show buried_corpse_count 

| #show 
| client_version_summary 
| #show client_version_summary 

| #show 
| content_flags 
| #show content_flags 

| #show 
| currencies 
| #show currencies 

| #show 
| distance 
| #show distance 

| #show 
| emotes 
| #show emotes 

| #show 
| field_of_view 
| #show field_of_view 

| #show 
| flags 
| #show flags 

| #show 
| group_info 
| #show group_info 

| #show 
| hatelist 
| #show hatelist 

| #show 
| inventory 
| #show inventory 

| #show 
| ip_lookup 
| #show ip_lookup 

| #show 
| line_of_sight 
| #show line_of_sight 

| #show 
| network 
| #show network 

| #show 
| network_stats 
| #show network_stats 

| #show 
| npc_global_loot 
| #show npc_global_loot 

| #show 
| npc_stats 
| #show npc_stats 

| #show 
| npc_type 
| #show npc_type [NPC ID] 

| #show 
| peqzone_flags 
| #show peqzone_flags 

| #show 
| petition 
| #show petition 

| #show 
| petition_info 
| #show petition_info 

| #show 
| proximity 
| #show proximity 

| #show 
| quest_errors 
| #show quest_errors 

| #show 
| quest_globals 
| #show quest_globals 

| #show 
| recipe 
| #show recipe [Recipe ID] 

| #show 
| server_info 
| #show server_info 

| #show 
| skills 
| #show skills 

| #show 
| spawn_status 
| #show spawn_status [all|disabled|enabled|Spawn ID] 

| #show 
| special_abilities 
| #show special_abilities 

| #show 
| spells 
| #show spells [disciplines|spells] 

| #show 
| spells_list 
| #show spells_list 

| #show 
| stats 
| #show stats 

| #show 
| timers 
| #show timers 

| #show 
| traps 
| #show traps 

| #show 
| uptime 
| #show uptime [Zone Server ID] (Zone Server ID is optional) 

| #show 
| variable 
| #show variable [Variable Name] 

| #show 
| version 
| #show version 

| #show 
| waypoints 
| #show waypoints 

| #show 
| who 
| #show who [Search Criteria] (Search criteria is optional) 

| #show 
| xtargets 
| #show xtargets [Amount] (Amount is optional) 

| #show 
| zone_data 
| #show zone_data 

| #show 
| zone_global_loot 
| #show zone_global_loot 

| #show 
| zone_loot 
| #show zone_loot 

| #show 
| zone_points 
| #show zone_points 

| #show 
| zone_status 
| #show zone_status

---

## Loading Server Data

*Source: server/operation/loading-server-data/index.html*

# Loading Server Data¶

This page explains how different assets on the server are loaded and by what methods can they be refreshed and/or reloaded

## AA Data¶

- **#reload aa** will reload Alternate Advancement data from the `aa_ability` table globally

## Alternate Currency Data¶

- **#reload static** will reload Alternate Currency data from the `alternate_currency` table globally

- **#reload alt_currencies** will also reload Alternate Currency data from the `alternate_currency` table globally without reloading everything else that **#reload static** does

## Base Data¶

- Base Data uses shared memory - you most likely aren't editing this

- Base Data is recommended to be ran from server boot-up for drastic changes, however editing existing data can be reloaded server-wide using **#hotfix**

## Blocked Spells¶

- **#reload blocked_spells** will reload Blocked Spells data from the `blocked_spells` table globally

## Commands¶

- **#reload commands** will reload Commands data from the `command_settings` table globally

## Content Flags¶

- **#reload content_flags** will reload Content Flags data from the `content_flags` table globally

## Doors¶

- **#reload static** will reload Doors data from the `doors` table globally

- **#reload doors** will also reload Doors data from the `doors` table globally without reloading everything else that **#reload static** does

## Factions¶

- Factions uses shared memory

- Factions can be hot reloaded in game using **#hotfix** - keep in mind that this uses shared memory files produced from **shared_memory** binary located in the **./shared** folder

- New factions need a server reboot, existing factions can use **#hotfix**, you can use placeholder data to add new factions and safely reload like other shared memory data

## Fishing and Foraging¶

- Fishing and Foraging data are live once entered into the database, no reloading is required

## Grids and Pathing Data¶

- All grid data is loaded at zone boot-up and any new data is simply reloaded during a **#repop**

## Ground Spawns¶

- **#reload static** will reload Ground Spawns data from the `ground_spawns` table globally

- **#reload ground_spawns** will also reload Ground Spawns data from the `ground_spawns` table globally without reloading everything else that **#reload static** does

## Horses¶

- Horse data is queried directly from the `horses` table on request of creating horse from Spell cast

## Items¶

- Items uses shared memory

- Items can be hot reloaded in game using **#hotfix** - keep in mind that this uses shared memory files produced from **shared_memory** binary located in the **./shared** folder

- Items in earlier clients such as Titanium show the change immediately, if you have inspected an item on a later client, then issued a **#hotfix**, the client caches these results so you will need to camp or zone to see the stat changes however any affects should take affect immediately

- Note: If you are going to build new items on your server on the fly, I recommend creating a big bank of blank or placeholder ID's in your table that you can use in the future. You can't hot reload the server with new items without creating issues after creating a new row entry

- Existing items can be safely edited without a server reload and using the **#hotfix** command. This takes affect for all zones immediately

## Level EXP Mods¶

- **#reload level_mods** will reload Level Based Experience Modifiers data from the `level_exp_mods` table globally

- Note: Must be enabled with the `Zone:LevelBasedEXPMods` rule to be used.

## Logging¶

- **#reload logs** will reload Log Settings data from the `logsys_categories` table globally

- **#logs reload** will also reload Log Settings data from the `logsys_categories` table globally

## Loot¶

- Loot uses shared memory

- Loot can be hot reloaded in game using **#hotfix** - keep in mind that this uses shared memory files produced from **shared_memory** binary located in the **./shared** folder

- Note: Loot assigned in a script/quest does not rely on the database system or to be reloaded from shared memory

## Merchants¶

- **#reload merchants** will reload Merchants data from the `merchantlist` table globally.

- Merchant data is loaded and cached the first time the request is made to a merchant if it wasn't already loaded on zone bootup

## NPC Data¶

- **#repop** will reload NPC data from the `npc_types` table for your current zone

## NPC Emotes¶

- **#reload npc_emotes** will reload NPC Emotes from the `npc_emotes` table globally.

- While emotes don't HAVE to be database driven (most custom servers will just use scripts) - there is an option to reload the database driven emotes

## Objects¶

- **#reload static** will reload Objects data from the `object` table globally

- **#reload objects** will also reload Objects data from the `object` table globally without reloading everything else that **#reload static** does

Info

Note that you will likely have to zone for your client to update.

## Pets¶

- Pet data is live and usable the moment it is in the `pets` table and an `npc_types` entry is made.

- Otherwise a **#repop** will be require to reload the NPC data from the `npc_types` table

## Perl Event Exports¶

- **#reload perl_export** will reload Perl Event Export Settings data from the `perl_event_export_settings` table globally

## Quests¶

- **#reload quest** or **#reload quest 0** will reload all quest scripts for the zone you are in.

**#reload quest 1** will reload all quests for the zone you're in and stop quest timers.

- **#reload world** or **#reload world 0** will reload Quests globally.

**#reload world 1** will reload Quests and repop globally

- **#reload world 2** will reload Quests and forcefully repop globally

## Reload Static Command¶

- **#reload static** reloads the following globally.

Alternate Currencies

- Doors

- Objects

- Ground Spawns

- NPC Emotes

- Traps

- Veteran Rewards

- Zone Configurations

- Zone Points

## Rules¶

- **#reload rules** will reload Rules data from the `rule_values` table globally

## Skill Caps¶

- Skill Caps uses shared memory (Class skills, caps etc.)

- Skill caps is recommended to be ran from server boot-up for drastic changes, however editing existing data can be reloaded server-wide using **#hotfix**

## Spells¶

- Spells uses shared memory

- Spells can be hot reloaded in game using **#hotfix** - keep in mind that this uses shared memory files produced from **shared_memory** binary located in the **./shared** folder

- Note: If you are going to build new spells on your server on the fly, I recommend creating a big bank of blank or placeholder ID's in your table that you can use in the future. You can't hot reload the server with new spells without creating issues after creating a new row entry.

- Existing spells can be safely edited without a server reload and using the **#hotfix** command. This takes affect for all zones immediately

## Tasks¶

- **#task reloadall** or **#reload tasks** will reload Tasks data from the `tasks` table and the `activities` table globally

- Note: If a character has a task that you are testing/building and you add new steps, the server will remove it from your task window

## Titles¶

- **#reload titles** will reload Titles data from `titles` table globally

## Tradeskills¶

- Tradeskills query the database directly and do not require reload to take affect

## Traps¶

- **#reload static** will reload Traps data from the `traps` table globally

- **#reload traps 1** will also reload Traps globally without reloading everything else that **#reload static** does

## Variables¶

- **#reload variables** will reload Variables data from the `variables` table globally

## Veteran Rewards¶

- **#reload static** will reload Veteran Rewards data from the `veteran_reward_templates` table globally

- **#reload veteran_rewards** will also reload Veteran Rewards data from the `veteran_reward_templates` table globally without reloading everything else that **#reload static** does

## Zone Data¶

- **#reload zone [Zone ID|Zone Short Name]** will reload the Zone data from the `zone` table for your current zone.

- **#zheader [Zone Short Name]** will also reload the Zone data from the `zone` table for your current zone.

## Zone Points¶

- **#reload static** will reload Zone Points data from the `zone_points` table globally

- **#reload zone_points** will also reload Zone Points data globally without reloading everything else that **#reload static** does

---

## NATS Channels

*Source: server/operation/nats-channels/index.html*

# NATS Channels¶

**Note that NATS is currently on an experimental branch**

IN and OUT are from the perspective of a eqemu. So, if IN is yes, that means it is expected that a third party client will request messages to this channel, If OUT is yes, that means you can subscribe as a third party and get a feed of data.

#### Global Scoped¶

- **global.admin_message.out** - eqproto::AdminMessage - Admin related communication. This is called from both zone and world, and may contain sensitive information, designed to be sent to an administrator-only channel. (hacker, zone bootup, new account creations, etc)

#### World Scoped¶

- **world.command_message.in** - eqproto::CommandMessage - Send a command. Commands are as follows:

- who - Who is currently online

- **world.channel_message.out** - eqproto::ChannelMessage - Any world-wide messages are broadcasted

#### Zone Scoped¶

- **zone.ecommons.channel_message.in** - eqproto::ChannelMessage - Send a channel message to zone

- **zone.ecommons.channel_message.in** - eqproto::CommandMessage - Send a command message to zone

- zone.ecommons.entity.event.#.|No.|Yes.|EntityEvent.|Subscribe to events from entity #

- zone.ecommons.entity.list.|Yes.|No.|Entities.|Request reply of a list of all entities

- zone.ecommons.channel_message.|Yes.|No.|ChannelMessage.|Send a channel message to all provided zone

---

## Server Events Scheduler

*Source: server/operation/server-events-scheduler/index.html*

# Server Events Scheduler

## Schedulers¶

The server currently has two process driven schedulers.

### World¶

- Broadcast Messages (broadcast) (Stateless)

- Reload World (reload_world) (Stateless)

### Zone¶

- Rule Value Change (rule_change) (Stateful)

- Content Flag Change (content_flag_change) (Stateful)

- Hotzone Activate (hot_zone_activate) (Stateful)

### Notes¶

Zone maintains state, world does not in the current implementation. For every current zone event activation, there is an event deactivation event which undoes the state change.

World does not maintain state, it is used for single event triggers and supports cron expressions since the events can be kicked off on a routine basis

## Event Loading¶

When world or zone boots, you will see the initial load of events. Zone will also reload if World has detected any changes to any of the scheduled events in the database once a minute

```
`[Zone] [Scheduler] Loaded Event (1) [Hotzone Rotation Day 1-10] type [hot_zone_activate] start [2/3/2021 3:1:00] end [2/16/2021 4:40:00] cron [] created []
[Zone] [Scheduler] Loaded Event (2) [Hotzone Rotation Day 11-20] type [hot_zone_activate] start [2/3/2021 15:1:00] end [2/15/2021 19:7:00] cron [] created []
[Zone] [Scheduler] Loaded Event (3) [Hotzone Rotation Day 21-33] type [hot_zone_activate] start [2/3/2021 3:1:00] end [2/16/2021 4:40:00] cron [] created []
[Zone] [Scheduler] Loaded Event (4) [Broadcast Test] type [broadcast] start [2/16/2021 22:56:00] end [2/16/2021 22:56:00] cron [] created []
[Zone] [Scheduler] Loaded Event (15) [Broadcast Test Cron] type [broadcast] start [2/16/2021 22:56:00] end [2/16/2021 22:56:00] cron [* * * * * *] created []
[Zone] [Scheduler] Loaded Event (16) [Experience Multiplier] type [rule_change] start [2/16/2021 22:56:00] end [2/16/2021 22:56:00] cron [] created []
[Zone] [Scheduler] Loaded Event (18) [Loot Multiplier] type [rule_change] start [2/16/2021 22:56:00] end [2/16/2021 22:56:00] cron [] created []
[Zone] [Scheduler] Loaded Event (19) [Enable Halloween] type [content_flag_change] start [2/15/2021 22:51:00] end [2/15/2021 22:53:00] cron [] created []
[Zone] [Scheduler] Loaded Event (20) [Reload World After Halloween] type [reload_world] start [2/15/2021 22:53:00] end [2/15/2021 22:54:00] cron [] created []
[Zone] [Scheduler] Loaded scheduled events [9]
`
```

## Event Changes¶

If new changes are made to the `server_scheduled_events` state table, world will pick it up every minute. If world detects that there are any data changes made to the table, it will notify all zone processes to reload their scheduled events. This makes it easy for server operators to add / modify events live while the server is online

## Server Scheduled Events Model¶

The database table model is represented as follows

```
`struct ServerScheduledEvents {
 int id;
 std::string description;
 std::string event_type;
 std::string event_data;
 int minute_start;
 int hour_start;
 int day_start;
 int month_start;
 int year_start;
 int minute_end;
 int hour_end;
 int day_end;
 int month_end;
 int year_end;
 std::string cron_expression;
 std::string created_at;
 std::string deleted_at;
};
`
```

## Scheduling Methods¶

The way the scheduling schema works is by start end end times and vary slightly in triggering functionality depending on whether the event is stateless or stateful

### Repeat Events (Stateless)¶

Stateless events can be triggered repeatedly such as a broadcast event by using a `cron_expression`. You can also schedule a one time event by setting the start time and end time one minute apart

### Repeat Events (Stateful)¶

Events can start and end on intervals but you need to only use the unit of time (for example days) and let everything else be `0` for columns. A `0` value will imply the current time when the scheduler tics

Let's take a hotzone rotation for example as shown in the table below. If I want to rotate 3 sets of hotzones within the month every month I can do it like this

Hotzone Group #1 starts on day 1 and ends on day 10
Hotzone Group #2 starts on day 10 and ends on day 20
Hotzone Group #3 starts on day 20 and ends on day 33 (Yes day 33 never happens but its an outer bounds)

This rotation will continue perpetually because of the wildcard mask-type declaration of the time data. Same thing could be achieved using different time formats, or different months

```
`select * from server_scheduled_events where event_type = 'hot_zone_activate';
+----+----------------------------+-------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+------------+-----------+-------------+------------+------------+----------+---------+-----------+----------+-----------------+------------+------------+
| id | description | event_type | event_data | minute_start | hour_start | day_start | month_start | year_start | minute_end | hour_end | day_end | month_end | year_end | cron_expression | created_at | deleted_at |
+----+----------------------------+-------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+------------+-----------+-------------+------------+------------+----------+---------+-----------+----------+-----------------+------------+------------+
| 1 | Hotzone Rotation Day 1-10 | hot_zone_activate | befallen,charasis,dalnir,frontiermtns,gukbottom,iceclad,lakeofillomen,northkarana,qey2hh1,soldunga,southro,wakening,podisease,velketor,akheva,riwwi,bothunder,poair | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 10 | 0 | 0 | NULL | NULL | NULL |
| 2 | Hotzone Rotation Day 10-20 | hot_zone_activate | beholder,commons,eastkarana,frozenshadow,guktop,kaesora,lakerathe,oasis,runnyeye,soldungb,stonebrunt,warrens,chardok,ponightmare,thedeep,veksar,paw,kodtaz | 0 | 0 | 10 | 0 | 0 | 0 | 0 | 20 | 0 | 0 | NULL | NULL | NULL |
| 3 | Hotzone Rotation Day 20-33 | hot_zone_activate | burningwood,crystal,erudsxing,greatdivide,hole,kerraridge,najena,permafrost,sirens,southkarana,timorous,warslikswood,sebilis,nadox,griegsend,barindu,hohonora,powater | 0 | 0 | 20 | 0 | 0 | 0 | 0 | 33 | 0 | 0 | NULL | NULL | NULL |
+----+----------------------------+-------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+------------+-----------+-------------+------------+------------+----------+---------+-----------+----------+-----------------+------------+------------+
`
```

## Example Schedule Data¶

```
`select * from server_scheduled_events;
+----+------------------------------+---------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+------------+-----------+-------------+------------+------------+----------+---------+-----------+----------+-----------------+------------+------------+
| id | description | event_type | event_data | minute_start | hour_start | day_start | month_start | year_start | minute_end | hour_end | day_end | month_end | year_end | cron_expression | created_at | deleted_at |
+----+------------------------------+---------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+------------+-----------+-------------+------------+------------+----------+---------+-----------+----------+-----------------+------------+------------+
| 1 | Hotzone Rotation Day 1-10 | hot_zone_activate | befallen,charasis,dalnir,frontiermtns,gukbottom,iceclad,lakeofillomen,northkarana,qey2hh1,soldunga,southro,wakening,podisease,velketor,akheva,riwwi,bothunder,poair | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 10 | 0 | 0 | NULL | NULL | NULL |
| 2 | Hotzone Rotation Day 10-20 | hot_zone_activate | beholder,commons,eastkarana,frozenshadow,guktop,kaesora,lakerathe,oasis,runnyeye,soldungb,stonebrunt,warrens,chardok,ponightmare,thedeep,veksar,paw,kodtaz | 0 | 0 | 10 | 0 | 0 | 0 | 0 | 20 | 0 | 0 | NULL | NULL | NULL |
| 3 | Hotzone Rotation Day 20-33 | hot_zone_activate | burningwood,crystal,erudsxing,greatdivide,hole,kerraridge,najena,permafrost,sirens,southkarana,timorous,warslikswood,sebilis,nadox,griegsend,barindu,hohonora,powater | 0 | 0 | 20 | 0 | 0 | 0 | 0 | 33 | 0 | 0 | NULL | NULL | NULL |
| 4 | Broadcast Test | broadcast | This is a system test | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | NULL | NULL | NULL |
| 15 | Broadcast Test Cron | broadcast | This is a system cron test 2 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | * * * * * * | NULL | NULL |
| 16 | Experience Multiplier | rule_change | Character:FinalExpMultiplier=10 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | NULL | NULL | NULL |
| 18 | Loot Multiplier | rule_change | Zone:GlobalLootMultiplier=10 | 0 | 0 | 0 | 0 | 0 | 7 | 19 | 15 | 2 | 2021 | NULL | NULL | NULL |
| 19 | Enable Halloween | content_flag_change | peq_halloween | 51 | 22 | 15 | 2 | 2021 | 53 | 22 | 15 | 2 | 2021 | NULL | NULL | NULL |
| 20 | Reload World After Halloween | reload_world | NULL | 53 | 22 | 15 | 2 | 2021 | 54 | 22 | 15 | 2 | 2021 | NULL | NULL | NULL |
+----+------------------------------+---------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+------------+-----------+-------------+------------+------------+----------+---------+-----------+----------+-----------------+------------+------------+
`
```

### Example of Content Flags being set for Halloween¶

### Example of Rule Event Activation (Detail Logs)¶

```
`[Zone] [Scheduler] Activating Event [Experience Multiplier] scheduled rule change, setting rule [Character:FinalExpMultiplier] to [10]
[Zone] [Rules] Set rule [Character:FinalExpMultiplier] to value [10]
[Zone] [Scheduler] [ValidateEventReadyToActivate] now_time [1613537959] start_time [1613537940] doesnt_end [true] end_time [94614463305936]
[Zone] [Scheduler] Activating Event [Loot Multiplier] scheduled rule change, setting rule [Zone:GlobalLootMultiplier] to [10]
`
```

When event deactivates

```
`[Zone] [Scheduler] Deactivating event [Loot Multiplier] resetting rules to normal
`
```

### Example of Broadcasts Being sent from World¶

Both the cron expression event and regular event from the table above shown in the image below

---

## Server Management

*Source: server/operation/server-management/index.html*

# Server Management¶

### Content from ProjectEQ and EQEmu¶

ProjectEQ is a team dedicated to the improvement of the Everquest Emulation community by providing era-accurate databases and quests.

EQEmulator is a team dedicated to the EQEmu Server used by nearly all EverQuest private servers.

Under most servers, these two team's efforts are considered the "Official" private server bundles to baseline a new server from.

Other alternatives exist, but are not maintained as much.

## Content Types¶

### Server Content¶

Inside an EQEmu server, a binary folder exists that houses the binaries (or executables) ran to make a server ran. This includes files such as zone.exe (to run zones), world.exe (to connect to a login server and manage zones, and also do character select for a player), ucs.exe (Universal Chat Service, optional and used for the chat channels in game), queryserv.exe (Used for storing additional data in logs such as trade logging)

### Quest Content¶

Quests are what bring life to NPCs in EverQuest. These quests utilize the Quest API to handle trading, /say interactions with an NPC, movement, and virtually everything else that may be unique to an NPC.

### Database Content¶

A Database stores the information about anything modifiable inside EverQuest. EQEMu currently only supports MySQL (or MariaDB) based databases.

### Map Content¶

Maps are used on server side to give routing and mapping information for NPCs to smartly figure out the path it should take to get to a destination, especially when chasing NPCs. Watermaps also exist, that give additional details about how water should be handled in a zone.

## Configuration Inside eqemu_config.json¶

Inside your server directory, a file exists called eqemu_config.json. This file holds key information needed to run your EverQuest server, such as database connection info, what path to find various content noted above, as well as how to identify the server.

### Long Name¶

This is how your server is identified when on the Server Select screen inside EverQuest. If your server is not registered, it will have a |T| or |U| prefix on it.

### Short Name¶

This is how your server's character profiles are stored, it is recommend to keep these short and relevant to your long name.

## Server Management¶

When managing an EverQuest private server, the following sections are areas worth noting.

### SQL¶

SQL stands for Server Query Language, and represents a Database. A SQL Database is where all data is stored about EverQuest.

### Shared Memory¶

Shared Memory creates file hashes that get loaded by World and Zone during bootup and are responsible for data such as items, faction, and base data. Shared Memory typically only needs to be ran once during initial setup, or when a major update occurs.

---

## Server Rules

*Source: server/operation/server-rules/index.html*

# Server Rules¶

### Editing rules¶

To edit rules, you can use the `#rules set [Name] [Value]` command to set a rule.

You can then use `#reload rules` to force all zones to reload the new rules.

Warning

The `notes` field in the database is set by the server software. If you adjust the values in the field, they will be overwritten and restored to default values when you update your server binaries.

Info

If you would like to improve upon the descriptions or notes in the Server Rules table, please submit a pull request on the ruletypes header file.

## AA Rules¶

| 

Rule Name 
| Default Value 
| Description 

| AA:ExpPerPoint 
| 23976503 
| Amount of experience per AA. Is the same as the amount of experience to go from level 51 to level 52 

| AA:NormalizedAAEnabled 
| false 
| TSS+ change to AA that normalizes AA experience to a fixed # of white con kills independent of level 

| AA:NormalizedAANumberOfWhiteConPerAA 
| 25 
| The number of white con kills per AA point 

| AA:ModernAAScalingEnabled 
| false 
| Are we linearly scaling AA experience based on total # of earned AA? 

| AA:ModernAAScalingStartPercent 
| 1000 
| 1000% or 10x AA experience at the start of the scaling range 

| AA:ModernAAScalingAAMinimum 
| 0 
| The minimum number of earned AA before AA experience scaling begins 

| AA:ModernAAScalingAALimit 
| 4000 
| The number of earned AA when AA experience scaling ends 

| AA:SoundForAAEarned 
| false 
| Play sound when AA point earned 

| AA:UnusedAAPointCap 
| -1 
| Cap for Unused AA Points. Default: -1. NOTE: DO NOT LOWER THIS WITHOUT KNOWING WHAT YOU ARE DOING. MAY RESULT IN PLAYERS LOSING AAs. 

| AA:MaxAAEXPPerKill 
| -1 
| Maximum AA EXP per Kill (3425214 is about 7%) - Default: -1 will disable the check 

## Adventure Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Adventure:MinNumberForGroup 
| 2 
| Minimum members for adventure group 

| Adventure:MaxNumberForGroup 
| 6 
| Maximum members for adventure group 

| Adventure:MaxLevelRange 
| 9 
| Maximum level range for adventure 

| Adventure:NumberKillsForBossSpawn 
| 45 
| Number of adventure kills to make the boss spawn 

| Adventure:DistanceForRescueAccept 
| 10000.0 
| Distance for adventure rescue accept 

| Adventure:DistanceForRescueComplete 
| 2500.0 
| Distance for adventure rescue complete 

| Adventure:ItemIDToEnablePorts 
| 41000 
| ItemID to enable adventure ports. 0 to disable, otherwise using a LDoN portal will require the user to have this item 

| Adventure:LDoNTrapDistanceUse 
| 625 
| LDoN trap distance use 

| Adventure:LDoNBaseTrapDifficulty 
| 15.0 
| LDoN base trap difficulty 

| Adventure:LDoNCriticalFailTrapThreshold 
| 10.0 
| LDoN critical fail trap threshold 

| Adventure:LDoNLootCountModifier 
| 10 
| LDoN Loot Count Modifier, lower is better (default is 10) 

## Aggro Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Aggro:SmartAggroList 
| true 
| Smart aggro list attempts to choose targets in a much smarter fashion, prefering players to pets, sitting and critically injured players to normal players, and players in melee range to players not 

| Aggro:SittingAggroMod 
| 35 
| Aggro increase against sitting targets. 35=35% 

| Aggro:MeleeRangeAggroMod 
| 10 
| Aggro increase against targets in melee range. 10=10% 

| Aggro:CurrentTargetAggroMod 
| 0 
| Aggro increase against current target. 0% = prefer the current target to any other. Makes it harder for our NPC to switch targets 

| Aggro:CriticallyWoundedAggroMod 
| 100 
| Aggro increase against critical wounded targets 

| Aggro:SpellAggroMod 
| 100 
| Aggro increase for spells 

| Aggro:PetSpellAggroMod 
| 10 
| Aggro increase for pet spells 

| Aggro:TunnelVisionAggroMod 
| 0.75 
| People not currently the top hate generate this much hate on a Tunnel Vision mob 

| Aggro:MaxScalingProcAggro 
| 400 
| Set to -1 for no limit. Maximum amount of aggro that HP scaling SPA effect in a proc will add 

| Aggro:IntAggroThreshold 
| 75 
| Int lesser or equal the value will aggro regardless of level difference 

| Aggro:AllowTickPulling 
| false 
| tick pulling is an exploit in an NPC's call for help fixed sometime in 2006 on live 

| Aggro:MinAggroLevel 
| 18 
| Minimum level for use with UseLevelAggro 

| Aggro:UseLevelAggro 
| true 
| MinAggroLevel rule value+ and Undead will aggro regardless of level difference. This will disabled Rule:IntAggroThreshold if set to true 

| Aggro:ClientAggroCheckMovingInterval 
| 1000 
| Interval in which clients actually check for aggro while moving - in milliseconds - this should be lower than ClientAggroCheckIdleInterval 

| Aggro:ClientAggroCheckIdleInterval 
| 6000 
| Interval in which clients actually check for aggro while idle - in milliseconds - this should be higher than ClientAggroCheckMovingInterval 

| Aggro:PetAttackRange 
| 40000.0 
| Maximum squared range /pet attack works at default is 200 

| Aggro:NPCAggroMaxDistanceEnabled 
| true 
| If enabled, NPC's will drop aggro beyond 600 units or what is defined at the zone level 

| Aggro:AggroPlayerPets 
| false 
| If enabled, NPCs will aggro player pets 

| Aggro:UndeadAlwaysAggro 
| true 
| should undead always aggro? 

| Aggro:BardAggroCap 
| 40 
| per song bard aggro cap. 

| Aggro:InitialAggroBonus 
| 100 
| Initial Aggro Bonus, Default: 100 

| Aggro:InitialPetAggroBonus 
| 100 
| Initial Pet Aggro Bonus, Default 100 

## Analytics Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Analytics:CrashReporting 
| true 
| Automatic crash reporting analytics for EQEmu Server developers 

## Bazaar Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Bazaar:AuditTrail 
| false 
| Setting whether a path to the trader should be displayed in the bazaar 

| Bazaar:MaxSearchResults 
| 50 
| Maximum number of search results in Bazaar 

| Bazaar:EnableWarpToTrader 
| true 
| Setting whether teleport to the selected trader should be active 

| Bazaar:MaxBarterSearchResults 
| 200 
| The maximum results returned in the /barter search 

| Bazaar:ParcelDeliveryCostMod 
| 0.20 
| Cost of parcel delivery for a bazaar purchase as a percentage of item cost. Default is 20% of item cost. RoF+ Only. 

| Bazaar:VoucherDeliveryCost 
| 200 
| Number of vouchers for direct delivery for a bazaar purchase. Default is 200 vouchers. RoF+ Only. 

| Bazaar:EnableParcelDelivery 
| true 
| Enable bazaar purchases via parcel delivery. Default is True. 

| Bazaar:MaxBuyerInventorySearchResults 
| 200 
| Maximum number of search results when a Buyer searches the global item list. Default is 200. RoF+ Only. 

## Bots Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Bots:Enabled 
| false 
| Enable of disable bot functionality, default is false 

| Bots:BotExpansionSettings 
| 16383 
| Sets the expansion settings for bot use. Defaults to all expansions enabled up to TSS 

| Bots:AllowCamelCaseNames 
| false 
| Allows the use of 'MyBot' type names 

| Bots:AllowBotEquipAnyRaceGear 
| false 
| Allows Bots to wear Equipment even if their race is not valid 

| Bots:CommandSpellRank 
| 1 
| Filters bot command spells by rank. 1, 2 and 3 are valid filters - any other number allows all ranks 

| Bots:CreationLimit 
| 150 
| Number of bots that each account can create 

| Bots:FinishBuffing 
| false 
| Allow for buffs to complete even if the bot caster is out of mana. Only affects buffing out of combat 

| Bots:GroupBuffing 
| false 
| Bots will cast single target buffs as group buffs, default is false for single. Does not make single target buffs work for MGB 

| Bots:HealRotationMaxMembers 
| 24 
| Maximum number of heal rotation members 

| Bots:HealRotationMaxTargets 
| 12 
| Maximum number of heal rotation targets 

| Bots:ManaRegen 
| 2.0 
| Adjust mana regen. Acts as a final multiplier, stacks with Rule Character:ManaRegenMultiplier. 

| Bots:PreferNoManaCommandSpells 
| true 
| Give sorting priority to newer no-mana spells (i.e., 'Bind Affinity') 

| Bots:QuestableSpawnLimit 
| false 
| Optional quest method to manage bot spawn limits using the quest_globals name bot_spawn_limit, see: /bazaar/Aediles_Thrall.pl 

| Bots:SpawnLimit 
| 71 
| Number of bots a character can have spawned at one time, You + 71 bots is a 12 group pseudo-raid 

| Bots:BotGroupXP 
| false 
| Determines whether client gets experience for bots outside their group 

| Bots:BotLevelsWithOwner 
| false 
| Auto-updates spawned bots as owner levels/de-levels (false is original behavior) 

| Bots:BotCharacterLevel 
| 0 
| If level is greater that value player can spawn bots if BotCharacterLevelEnabled is true 

| Bots:CasterStopMeleeLevel 
| 13 
| Level at which caster bots stop melee attacks 

| Bots:AllowOwnerOptionAutoDefend 
| true 
| When option is enabled, bots will defend their owner on enemy aggro 

| Bots:LeashDistance 
| 562500.0f 
| Distance a bot is allowed to travel from leash owner before being pulled back (squared value) 

| Bots:AllowApplyPoisonCommand 
| true 
| Allows the use of the bot command 'applypoison' 

| Bots:AllowApplyPotionCommand 
| true 
| Allows the use of the bot command 'applypotion' 

| Bots:RestrictApplyPotionToRogue 
| true 
| Restricts the bot command 'applypotion' to rogue-usable potions (i.e., poisons) 

| Bots:OldRaceRezEffects 
| false 
| Older clients had ID 757 for races with high starting STR, but it doesn't seem used anymore 

| Bots:ResurrectionSickness 
| true 
| Use Resurrection Sickness based on Resurrection spell cast, set to false to disable Resurrection Sickness. 

| Bots:OldResurrectionSicknessSpell 
| 757 
| 757 is Default Old Resurrection Sickness Spell 

| Bots:ResurrectionSicknessSpell 
| 756 
| 756 is Default Resurrection Sickness Spell 

| Bots:AllowPickpocketCommand 
| true 
| Allows the use of the bot command 'pickpocket' 

| Bots:BotHealOnLevel 
| false 
| Setting whether a bot should heal completely when leveling. Default FALSE. 

| Bots:AutosaveIntervalSeconds 
| 300 
| Number of seconds after which a timer is triggered which stores the bot data. The value 0 means no periodic automatic saving. 

| Bots:CazicTouchBotsOwner 
| true 
| Default True. Cazic Touch/DT will hit bot owner rather than bot. 

| Bots:BotsClickItemsMinLvl 
| 1 
| Minimum level for bots to be able to use ^clickitem. Default 1. 

| Bots:BotsCanClickItems 
| true 
| Enables the ability for bots to click items they have equipped. Default TRUE 

| Bots:CanClickMageEpicV1 
| true 
| Whether or not bots are allowed to click Mage Epic 1.0. Default TRUE 

| Bots:BotsIgnoreLevelBasedHasteCaps 
| false 
| Ignores hard coded level based haste caps. 

| Bots:BotsHasteCap 
| 100 
| Haste cap for non-v3(over haste) haste 

| Bots:BotsHastev3Cap 
| 25 
| Haste cap for v3(over haste) haste 

## Bugs Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Bugs:ReportingSystemActive 
| true 
| Activates bug reporting 

## Channels Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Channels:RequiredStatusAdmin 
| 251 
| Required status to administer chat channels 

| Channels:RequiredStatusListAll 
| 251 
| Required status to list all chat channels 

| Channels:DeleteTimer 
| 1440 
| Empty password protected channels will be deleted after this many minutes 

## Character Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Character:MaxLevel 
| 65 
| Sets the highest level for players that can be reached through experience 

| Character:PerCharacterQglobalMaxLevel 
| false 
| Check for qglobal 'CharMaxLevel' character qglobal (Type 5, \"\, if player tries to level beyond that point, it will not go beyond that level 

| Character:PerCharacterBucketMaxLevel 
| false 
| Check for data bucket 'CharMaxLevel', if player tries to level beyond that point, it will not go beyond that level 

| Character:MaxExpLevel 
| 0 
| Defines the maximum level that can be reached through experience 

| Character:DeathExpLossLevel 
| 10 
| Any level equal to or greater than this will lose experience at death 

| Character:DeathExpLossMaxLevel 
| 255 
| Every higher level will no longer lose experience at death 

| Character:DeathItemLossLevel 
| 10 
| From this level on, items are left in the corpse when LeaveCorpses is activated 

| Character:DeathExpLossMultiplier 
| 3 
| Adjust how much experience is lost. Default 3.5% (0=0.5%, 1=1.5%, 2=2.5%, 3=3.5%, 4=4.5%, 5=5.5%, 6=6.5%, 7=7.5%, 8=8.5%, 9=9.5%, 10=11%) 

| Character:DeathKeepLevel 
| false 
| Players can not drop below 0% experience from death. 

| Character:UseDeathExpLossMult 
| false 
| Setting to control whether DeathExpLossMultiplier or the code default is used: (Level x Level / 18.0) x 12000 

| Character:UseOldRaceRezEffects 
| false 
| Older clients had ID 757 for races with high starting STR, but it doesn't seem used anymore 

| Character:CorpseDecayTime 
| 604800000 
| Time after which the corpse decays (milliseconds) DEFAULT: 604800000 (7 Days) 

| Character:EmptyCorpseDecayTime 
| 10800000 
| Time after which an empty corpse decays (milliseconds) DEFAULT: 10800000 (3 Hours) 

| Character:CorpseResTime 
| 10800000 
| Time after which the corpse can no longer be resurrected (milliseconds) DEFAULT: 10800000 (3 Hours) 

| Character:DuelCorpseResTime 
| 600000 
| Time before cant res corpse after a duel (milliseconds) DEFAULT: 600000 (10 Minutes) 

| Character:CorpseOwnerOnlineTime 
| 30000 
| How often corpse will check if its owner is online DEFAULT: 30000 (30 Seconds) 

| Character:LeaveCorpses 
| true 
| Setting whether you leave a corpse behind 

| Character:LeaveNakedCorpses 
| false 
| Setting whether you leave a corpse without items 

| Character:MaxDraggedCorpses 
| 2 
| Maximum number of corpses you can drag at once 

| Character:DragCorpseDistance 
| 400 
| If a player is using /corpsedrag and moving, the corpse will not move until the player exceeds this distance 

| Character:FinalExpMultiplier 
| 1 
| Added on top of everything else, easy for setting EXP events 

| Character:ExpMultiplier 
| 0.5 
| If greater than 0, the experience gained is multiplied by this value. 

| Character:AAExpMultiplier 
| 0.5 
| If greater than 0, the AA experience gained is multiplied by this value. 

| Character:GroupExpMultiplier 
| 0.5 
| The experience in a group is multiplied by this value in addition to the group multiplier. The group multiplier is: 2 members=x 1.2, 3=x1.4, 4=x1.6, 5=x1.8, 6=x2.16 

| Character:RaidExpMultiplier 
| 0.2 
| The experience gained in raids is multiplied by (1-RaidExpMultiplier) 

| Character:FinalRaidExpMultiplier 
| 1.0 
| Multiplies all raid experience by this value. Default: 1.0 

| Character:UseXPConScaling 
| true 
| When activated, the experience is modified depending on the difference between player level and NPC level. The values from the rules GreenModifier to RedModifier are used 

| Character:ShowExpValues 
| 0 
| Show experience values. 0=normal, 1=show raw experience values, 2=show raw experience values and percent 

| Character:GreenModifier 
| 20 
| The experience obtained for green con mobs is multiplied by value/100 

| Character:LightBlueModifier 
| 40 
| The experience obtained for light-blue con mobs is multiplied by value/100 

| Character:BlueModifier 
| 90 
| The experience obtained for blue con mobs is multiplied by value/100 

| Character:WhiteModifier 
| 100 
| The experience obtained for white con mobs is multiplied by value/100 

| Character:YellowModifier 
| 125 
| The experience obtained for yellow con mobs is multiplied by value/100 

| Character:RedModifier 
| 150 
| The experience obtained for red con mobs is multiplied by value/100 

| Character:AutosaveIntervalS 
| 300 
| Number of seconds after which a timer is triggered which stores the character data. The value 0 means no periodic automatic saving. 

| Character:HPRegenMultiplier 
| 100 
| The hitpoint regeneration is multiplied by value/100 (up to the caps) 

| Character:ManaRegenMultiplier 
| 100 
| The mana regeneration is multiplied by value/100 (up to the caps) 

| Character:EnduranceRegenMultiplier 
| 100 
| The endurance regeneration is multiplied by value/100 (up to the caps) 

| Character:OldMinMana 
| false 
| This is used for servers that want to follow older skill cap formulas so they can still have some regen w/o mediate 

| Character:HealOnLevel 
| false 
| Setting whether a player should heal completely when leveling 

| Character:FeignKillsPet 
| false 
| Setting whether Feign Death kills the player pet 

| Character:ItemManaRegenCap 
| 15 
| Limit on mana regeneration granted by items 

| Character:ItemHealthRegenCap 
| 30 
| Limit on health regeneration granted by items 

| Character:ItemDamageShieldCap 
| 30 
| Limit on damage shields granted by items 

| Character:ItemAccuracyCap 
| 150 
| Limit on accuracy granted by items 

| Character:ItemAvoidanceCap 
| 100 
| Limit on avoidance granted by items 

| Character:ItemCombatEffectsCap 
| 100 
| Limit on combat effects granted by items 

| Character:ItemShieldingCap 
| 35 
| Limit on shielding granted by items 

| Character:ItemSpellShieldingCap 
| 35 
| Limit on spell shielding granted by items 

| Character:ItemDoTShieldingCap 
| 35 
| Limit on DoT shielding granted by items 

| Character:ItemStunResistCap 
| 35 
| Limit on resistance granted by items 

| Character:ItemStrikethroughCap 
| 35 
| Limit on strikethrough granted by items 

| Character:ItemATKCap 
| 250 
| Limit on ATK granted by items 

| Character:ItemHealAmtCap 
| 250 
| Limit on heal amount granted by items 

| Character:ItemSpellDmgCap 
| 250 
| Limit on spell damage granted by items 

| Character:ItemClairvoyanceCap 
| 250 
| Limit on clairvoyance granted by items 

| Character:ItemDSMitigationCap 
| 50 
| Limit on damageshield mitigation granted by items 

| Character:ItemEnduranceRegenCap 
| 15 
| Limit on endurance regeneration granted by items 

| Character:ItemExtraDmgCap 
| 150 
| Cap for bonuses to melee skills like Bash, Frenzy, etc. 

| Character:HasteCap 
| 100 
| Haste cap for non-v3(over haste) haste 

| Character:Hastev3Cap 
| 25 
| Haste cap for v3(over haste) haste 

| Character:HeroicStatsUseDataBucketsToScale 
| false 
| Allows scaling the benefits a character receives from Heroic Stats using Data Buckets. Stacks with other Heroic Stats Mulitplier Rules. 

| Character:HeroicIntelligenceIncreaseSpellDmgMultiplier 
| 0.00 
| Allows Heroic Intelligence to increase a Players Worn Spell Damage Stat from Equipment, for example, setting this rule to 1.00 will always grant 1 Spell Damage per 1 Heroic Intelligence 

| Character:HeroicWisdomIncreaseHealAmtMultiplier 
| 0.00 
| Allows Heroic Wisdom to increase a Players Worn Heal Amount Stat from Equipment, for example, setting this rule to 1.00 will always grant 1 Heal Amount per 1 Heroic Wisdom 

| Character:HeroicStrengthMultiplier 
| 1.00 
| Multplier scales benefits from Heroic Strength. Grants 25 Base Endurance, 0.05 Endurance Regen, 1 Melee Damage each Hit, and 1 Shield AC per 10 Heroic Strength. 

| Character:HeroicStaminaMultiplier 
| 1.00 
| Multplier scales benefits from Heroic Stamina. Grants 25 Base Endurance, 0.05 Endurance Regen, 100 Base HP, and 0.5 HP Regen per 10 Heroic Stamina. 

| Character:HeroicAgilityMultiplier 
| 1.00 
| Multplier scales benefits from Heroic Agility. Grants 25 Base Endurance, 0.05 Endurance Regen, and 1 Avoidance AC per 10 Heroic Agility. (Rule does not change Dodge Chance) 

| Character:HeroicDexterityMultiplier 
| 1.00 
| Multplier scales benefits from Heroic Dexterity. Grants 25 Base Endurance, 0.05 Endurance Regen, and 1 Archery/Throwing Damage each hit per 10 Heroic Dexterity. (Rule does not change Assassinate/Headshot/Block/Parry/Riposte Chances) 

| Character:HeroicWisdomMultiplier 
| 1.00 
| Multplier scales benefits from Heroic Wisdom. Grants 250 Base Mana, 1 Mana Regen per 25 Heroic Wisdom. 

| Character:HeroicIntelligenceMultiplier 
| 1.00 
| Multplier scales benefits from Heroic Intelligence. Grants 250 Base Mana, 1 Mana Regen per 25 Heroic Intelligence. 

| Character:SkillUpModifier 
| 100 
| The probability for a skill-up is multiplied by value/100 

| Character:SharedBankPlat 
| false 
| Shared bank platinum. Off by default to prevent duplication 

| Character:BindAnywhere 
| false 
| Allows players to bind their soul anywhere in the world 

| Character:RestRegenEnabled 
| true 
| Setting to activate out-of-combat regeneration 

| Character:RestRegenTimeToActivate 
| 30 
| Time in seconds for rest state regen to kick in 

| Character:RestRegenRaidTimeToActivate 
| 300 
| Time in seconds for rest state regen to kick in with a raid target 

| Character:KillsPerGroupLeadershipAA 
| 250 
| Minimum number of dark blue mobs that must be killed to get a Group Leadership AA 

| Character:KillsPerRaidLeadershipAA 
| 250 
| Minimum number of dark blue mobs that must be killed to get a Raid Leadership AAA 

| Character:MaxFearDurationForPlayerCharacter 
| 4 
| Maximum number of tics a player can be feared. 1 tic equls 6 seconds 

| Character:MaxCharmDurationForPlayerCharacter 
| 15 
| Maximum number of tics a player can be charmed. 1 tic equls 6 seconds 

| Character:BaseHPRegenBonusRaces 
| 4352 
| A bitmask of race(s) that receive the regen bonus. Iksar (4096) & Troll (256) = 4352. See common/races.h for the bitmask values 

| Character:SoDClientUseSoDHPManaEnd 
| false 
| Setting this to true will allow SoD clients to use the SoD HP/Mana/End formulas and previous clients will use the old formulas 

| Character:UseRaceClassExpBonuses 
| true 
| Setting this to true will enable Class and Racial experience rate bonuses 

| Character:UseOldRaceExpPenalties 
| false 
| Setting this to true will enable racial experience penalties for Iksar, Troll, Ogre, and Barbarian, as well as the bonus for Halflings 

| Character:UseOldClassExpPenalties 
| false 
| Setting this to true will enable old class experience penalties for Paladin, SK, Ranger, Bard, Monk, Wizard, Enchanter, Magician, and Necromancer, as well as the bonus for Rogues and Warriors 

| Character:RespawnFromHover 
| false 
| Setting whether the respawn window should be used 

| Character:RespawnFromHoverTimer 
| 300 
| Respawn Window countdown timer, in seconds 

| Character:UseNewStatsWindow 
| true 
| Setting whether the new Stats window, which displays all information, should be used 

| Character:ItemCastsUseFocus 
| false 
| If true, this allows item clickies to use focuses that have limited maximum levels on them 

| Character:MinStatusForNoDropExemptions 
| 80 
| This allows status x and higher to trade no drop items 

| Character:SkillCapMaxLevel 
| 75 
| Sets the Maximum Level used for Skill Caps (from skill_caps table). -1 makes it use MaxLevel rule value. It is set to 75 because PEQ only has skill caps up to that level, and grabbing the players' skill past 75 will return 0, breaking all skills past that level. This helps servers with obsurd level caps (75+ level cap) function without any modifications 

| Character:StatCap 
| 0 
| If StatCap > 0 then this value is used. If it is 0, the value of the following code is used: If Level < 61: 255. If Level >= 61 and the client SoF or newer: 255 + 5 x (level -60). If the client is older than SoF and the level < 71 then: 255 + x (level-60). In all other cases: 330. 

| Character:CheckCursorEmptyWhenLooting 
| true 
| If true, a player cannot loot a corpse (player or NPC) with an item on their cursor 

| Character:MaintainIntoxicationAcrossZones 
| true 
| If true, alcohol effects are maintained across zoning and logging out/in 

| Character:EnableDiscoveredItems 
| true 
| If enabled, it enables EVENT_DISCOVER_ITEM and also saves character names and timestamps for the first time an item is discovered 

| Character:EnableXTargetting 
| true 
| Enable Extended Targeting Window, for users with UF and later clients 

| Character:EnableAggroMeter 
| true 
| Enable Aggro Meter, for users with RoF and later clients 

| Character:KeepLevelOverMax 
| false 
| Don't de-level a character that has somehow gone over the level cap 

| Character:FoodLossPerUpdate 
| 32 
| How much food/water you lose per stamina update 

| Character:EnableHungerPenalties 
| false 
| Being hungry/thirsty has negative effects -- it does appear normal live servers do not have penalties 

| Character:EnableFoodRequirement 
| true 
| If disabled, food is no longer required 

| Character:BaseInstrumentSoftCap 
| 36 
| Softcap for instrument mods, 36 commonly referred to as 3.6 as well 

| Character:UseSpellFileSongCap 
| true 
| When they removed the AA that increased the cap they removed the above and just use the spell field 

| Character:BaseRunSpeedCap 
| 158 
| Base Run Speed Cap, on live it's 158% which will give you a runspeed of 1.580 hard capped to 225 

| Character:EnvironmentDamageMulipliter 
| 1 
| Multiplier for environmental damage like fall damage. 

| Character:UnmemSpellsOnDeath 
| true 
| Setting whether at death all memorized Spells are forgotten 

| Character:TradeskillUpAlchemy 
| 2.0 
| Alchemy skillup rate adjustment. Lower is faster 

| Character:TradeskillUpBaking 
| 2.0 
| Baking skillup rate adjustment. Lower is faster 

| Character:TradeskillUpBlacksmithing 
| 2.0 
| Blacksmithing skillup rate adjustment. Lower is faster 

| Character:TradeskillUpBrewing 
| 3.0 
| Brewing skillup rate adjustment. Lower is faster 

| Character:TradeskillUpFletching 
| 2.0 
| Fletching skillup rate adjustment. Lower is faster 

| Character:TradeskillUpJewelcrafting 
| 2.0 
| Jewelcrafting skillup rate adjustment. Lower is faster 

| Character:TradeskillUpMakePoison 
| 2.0 
| Make Poison skillup rate adjustment. Lower is faster 

| Character:TradeskillUpPottery 
| 4.0 
| Pottery skillup rate adjustment. Lower is faster 

| Character:TradeskillUpResearch 
| 1.0 
| Research skillup rate adjustment. Lower is faster 

| Character:TradeskillUpTinkering 
| 2.0 
| Tinkering skillup rate adjustment. Lower is faster 

| Character:TradeskillUpTailoring 
| 2.0 
| Tailoring skillup rate adjustment. Lower is faster 

| Character:MarqueeHPUpdates 
| false 
| Will show health percentage in center of screen if health lesser than 100% 

| Character:IksarCommonTongue 
| 95 
| Starting value for Common Tongue for Iksars 

| Character:OgreCommonTongue 
| 95 
| Starting value for Common Tongue for Ogres 

| Character:TrollCommonTongue 
| 95 
| Starting value for Common Tongue for Trolls 

| Character:ActiveInvSnapshots 
| false 
| Takes a periodic snapshot of inventory contents from online players 

| Character:InvSnapshotMinIntervalM 
| 180 
| Minimum time between inventory snapshots (minutes) 

| Character:InvSnapshotMinRetryM 
| 30 
| Time to re-attempt an inventory snapshot after a failure (minutes) 

| Character:InvSnapshotHistoryD 
| 30 
| Time to keep snapshot entries (days) 

| Character:RestrictSpellScribing 
| false 
| Setting whether to restrict spell scribing to allowable races/classes of spell scroll 

| Character:UseStackablePickPocketing 
| true 
| Allows stackable pickpocketed items to stack instead of only being allowed in empty inventory slots 

| Character:AllowMQTarget 
| false 
| Disables putting players in the 'hackers' list for targeting beyond the clip plane or attempting to target something untargetable 

| Character:UseOldBindWound 
| false 
| Uses the original bind wound behavior 

| Character:GrantHoTTOnCreate 
| false 
| Grant Health of Target's Target leadership AA on character creation 

| Character:UseOldConSystem 
| false 
| Setting whether the pre SoF era consider system should be used 

| Character:OPClientUpdateVisualDebug 
| false 
| Shows a pulse and forward directional particle each time the client sends its position to server 

| Character:AllowCrossClassTrainers 
| false 
| If the value is true, a player can also train with other class Guildmasters. 

| Character:PetsUseReagents 
| true 
| Conjuring pets consumes reagents 

| Character:DismountWater 
| true 
| Dismount horses when entering water 

| Character:NoSkillsOnHorse 
| false 
| Enabling this will prevent Bind Wound and Foraging while on a mount 

| Character:UseNoJunkFishing 
| false 
| Disregards junk items when fishing 

| Character:SoftDeletes 
| true 
| When characters are deleted in character select, they are only soft deleted 

| Character:DefaultGuild 
| 0 
| If not 0, new characters placed into the guild # indicated 

| Character:DefaultGuildRank 
| 8 
| Default guild rank when Character:DefaultGuild is a non-0 value, default is 8 (Recruit) 

| Character:ProcessFearedProximity 
| false 
| Processes proximity checks when feared 

| Character:EnableCharacterEXPMods 
| false 
| Enables character zone-based experience modifiers. 

| Character:PVPEnableGuardFactionAssist 
| true 
| Enables faction based assisting against the aggresor in pvp. 

| Character:SkillUpFromItems 
| true 
| Allow Skill ups from clickable items 

| Character:EnableTestBuff 
| false 
| Allow the use of /testbuff 

| Character:UseResurrectionSickness 
| true 
| Use Resurrection Sickness based on Resurrection spell cast, set to false to disable Resurrection Sickness. 

| Character:OldResurrectionSicknessSpellID 
| 757 
| 757 is Default Old Resurrection Sickness Spell ID 

| Character:ResurrectionSicknessSpellID 
| 756 
| 756 is Default Resurrection Sickness Spell ID 

| Character:EnableBardMelody 
| true 
| Enable Bard /melody by default, to disable change to false for a classic experience. 

| Character:EnableRangerAutoFire 
| true 
| Enable Ranger /autofire by default, to disable change to false for a classic experience. 

| Character:EnableTGB 
| true 
| Enable /tgb (Target Group Buff) by default, to disable change to false for a classic experience. 

| Character:SkillUpMaximumChancePercentage 
| 25 
| Maximum chance to improve a combat skill, before skill-specific modifiers. This should be greater than SkillUpMinimumChancePercentage. 

| Character:SkillUpMinimumChancePercentage 
| 2 
| Minimum chance to improve a combat skill, after skill-specific modifiers. This should be lesser than SkillUpMaximumChancePercentage. 

| Character:WarriorTrackingDistanceMultiplier 
| 0 
| If you want warriors to be able to track, increase this above 0. 0 disables tracking packets. 

| Character:ClericTrackingDistanceMultiplier 
| 0 
| If you want clerics to be able to track, increase this above 0. 0 disables tracking packets. 

| Character:PaladinTrackingDistanceMultiplier 
| 0 
| If you want paladins to be able to track, increase this above 0. 0 disables tracking packets. 

| Character:RangerTrackingDistanceMultiplier 
| 12 
| If you want rangers to be able to track, increase this above 0. 0 disables tracking packets. 

| Character:ShadowKnightTrackingDistanceMultiplier 
| 0 
| If you want shadow knights to be able to track, increase this above 0. 0 disables tracking packets. 

| Character:DruidTrackingDistanceMultiplier 
| 10 
| If you want druids to be able to track, increase this above 0. 0 disables tracking packets. 

| Character:MonkTrackingDistanceMultiplier 
| 0 
| If you want monks to be able to track, increase this above 0. 0 disables tracking packets. 

| Character:BardTrackingDistanceMultiplier 
| 7 
| If you want bards to be able to track, increase this above 0. 0 disables tracking packets. 

| Character:RogueTrackingDistanceMultiplier 
| 0 
| If you want rogues to be able to track, increase this above 0. 0 disables tracking packets. 

| Character:ShamanTrackingDistanceMultiplier 
| 0 
| If you want shaman to be able to track, increase this above 0. 0 disables tracking packets. 

| Character:NecromancerTrackingDistanceMultiplier 
| 0 
| If you want necromancers to be able to track, increase this above 0. 0 disables tracking packets. 

| Character:WizardTrackingDistanceMultiplier 
| 0 
| If you want wizards to be able to track, increase this above 0. 0 disables tracking packets. 

| Character:MagicianTrackingDistanceMultiplier 
| 0 
| If you want magicians to be able to track, increase this above 0. 0 disables tracking packets. 

| Character:EnchanterTrackingDistanceMultiplier 
| 0 
| If you want enchanters to be able to track, increase this above 0. 0 disables tracking packets. 

| Character:BeastlordTrackingDistanceMultiplier 
| 0 
| If you want beastlords to be able to track, increase this above 0. 0 disables tracking packets. 

| Character:BerserkerTrackingDistanceMultiplier 
| 0 
| If you want berserkers to be able to track, increase this above 0. 0 disables tracking packets. 

| Character:OnInviteReceiveAlreadyinGroupMessage 
| true 
| If you want clients to receive a message when trying to invite a player into a group that is currently in another group. 

| Character:PetZoneWithOwner 
| true 
| Should Pets Zone with Owner 

| Character:FullManaOnDeath 
| true 
| On death set mana to full 

| Character:FullEndurOnDeath 
| true 
| On death set endurance to full 

| Character:ExperiencePercentCapPerKill 
| -1 
| Caps the percentage of experience that can be gained per kill. -1 disables the cap; 0 blocks all (non-aa) xp. 

| Character:EnableGroupEXPModifier 
| true 
| Enable or disable the group experience modifier in group, default is true 

| Character:EnableGroupMemberEXPModifier 
| true 
| Enable or disable the group member experience modifier based on number of players in group, default is true 

| Character:GroupMemberEXPModifier 
| 0.2 
| Sets the group experience modifier per members between 2 and 5, default is 0.2 

| Character:FullGroupEXPModifier 
| 2.16 
| Sets the group experience modifier for a full group, default is 2.16 

| Character:IgnoreLevelBasedHasteCaps 
| false 
| Ignores hard coded level based haste caps. 

| Character:EnableRaidEXPModifier 
| true 
| Enable or disable the raid experience modifier, default is true 

| Character:EnableRaidMemberEXPModifier 
| true 
| Enable or disable the raid experience modifier based on members in raid, default is true 

| Character:LeaveCursorMoneyOnCorpse 
| false 
| Enable or disable leaving cursor money on player corpses 

| Character:ItemExtraSkillDamageCalcAsPercent 
| false 
| If enabled, apply Item Extra Skill Damage as Percentage-based modifiers 

| Character:UseForageCommonFood 
| true 
| If enabled, use the common foods specified in the code. 

| Character:ClearXTargetDelay 
| 10 
| Seconds between uses of the #clearxtargets command (Set to 0 to disable) 

| Character:PreventMountsFromZoning 
| false 
| Enable to prevent mounts from zoning - Prior to December 15, 2004 this is enabled. 

| Character:GroupInvitesRequireTarget 
| false 
| Enable to require players to have invitee on target (Disables /invite name) - Classic Style 

| Character:PlayerTradingLoreFeedback 
| true 
| If enabled, during a player to player trade, if lore items exist, it will output which items. 

| Character:MendAlwaysSucceedValue 
| 199 
| Value at which mend will always succeed its skill check. Default: 199 

| Character:SneakAlwaysSucceedOver100 
| false 
| When sneak skill is over 100, always succeed sneak/hide. Default: false 

| Character:BandolierSwapDelay 
| 0 
| Bandolier swap delay in milliseconds, default is 0 

## Chat Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Chat:ServerWideOOC 
| true 
| Enable server wide ooc-chat 

| Chat:ServerWideAuction 
| true 
| Enable server wide auction-chat 

| Chat:EnableVoiceMacros 
| true 
| Enable voice macros 

| Chat:EnableMailKeyIPVerification 
| true 
| Setting whether the authenticity of the client should be verified via its IP address when accessing the InGame mailbox 

| Chat:EnableAntiSpam 
| true 
| Enable anti-spam system for chat 

| Chat:SuppressCommandErrors 
| false 
| Do not suppress command errors by default 

| Chat:ChannelsIgnoreNameFilter 
| false 
| Ignore name filtering when creating new chat channels 

| Chat:MaxPermanentPlayerChannels 
| 0 
| Maximum number of permanent chat channels a player can make. Default 0. 

| Chat:MinStatusToBypassAntiSpam 
| 100 
| Minimum status to bypass the anti-spam system 

| Chat:MinimumMessagesPerInterval 
| 4 
| Minimum number of chat messages allowed per interval. The karma value is added to this value 

| Chat:MaximumMessagesPerInterval 
| 12 
| Maximum value of chat messages allowed per interval 

| Chat:MaxMessagesBeforeKick 
| 20 
| If an attempt is made to send more than the maximum allowed number of chat messages per interval, the client will be disconnected after this absolute number of messages 

| Chat:IntervalDurationMS 
| 60000 
| Interval length in milliseconds 

| Chat:KarmaUpdateIntervalMS 
| 1200000 
| Karma update interval in milliseconds 

| Chat:KarmaGlobalChatLimit 
| 72 
| Amount of karma you need to be able to talk in ooc/auction/chat below the level limit 

| Chat:GlobalChatLevelLimit 
| 8 
| Level limit you need to of reached to talk in ooc/auction/chat if your karma is too low 

| Chat:AutoInjectSaylinksToSay 
| true 
| Automatically injects saylinks into dialogue that has [brackets in them] 

| Chat:AutoInjectSaylinksToClientMessage 
| true 
| Automatically injects saylinks into dialogue that has [brackets in them] 

| Chat:QuestDialogueUsesDialogueWindow 
| false 
| Pipes all quest dialogue to dialogue window 

| Chat:DialogueWindowAnimatesNPCsIfNoneSet 
| true 
| If there is no animation specified in the dialogue window markdown then it will choose a random greet animation such as wave or salute 

## Cheat Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Cheat:MQWarpDetectionDistanceFactor 
| 9.0 
| clients move at 4.4 about if in a straight line but with movement and to acct for lag we raise it a bit 

| Cheat:MQWarpExemptStatus 
| -1 
| Required status level to exempt the MQWarpDetector. Set to -1 to disable this feature. 

| Cheat:MQZoneExemptStatus 
| -1 
| Required status level to exempt the MQZoneDetector. Set to -1 to disable this feature. 

| Cheat:MQGateExemptStatus 
| -1 
| Required status level to exempt the MQGateDetector. Set to -1 to disable this feature. 

| Cheat:MQGhostExemptStatus 
| -1 
| Required status level to exempt the MQGhostDetector. Set to -1 to disable this feature. 

| Cheat:MQFastMemExemptStatus 
| -1 
| Required status level to exempt the MQFastMemDetector. Set to -1 to disable this feature. 

| Cheat:EnableMQWarpDetector 
| true 
| Enable the MQWarp Detector. Set to False to disable this feature. 

| Cheat:EnableMQZoneDetector 
| true 
| Enable the MQZone Detector. Set to False to disable this feature. 

| Cheat:EnableMQGateDetector 
| true 
| Enable the MQGate Detector. Set to False to disable this feature. 

| Cheat:EnableMQGhostDetector 
| true 
| Enable the MQGhost Detector. Set to False to disable this feature. 

| Cheat:EnableMQFastMemDetector 
| true 
| Enable the MQFastMem Detector. Set to False to disable this feature. 

| Cheat:MarkMQWarpLT 
| false 
| Mark clients makeing smaller warps 

## Client Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Client:UseLiveFactionMessage 
| false 
| Allows players to see detailed faction adjustments as on the live servers 

| Client:UseLiveBlockedMessage 
| false 
| Setting whether detailed spell block messages should be used as on the live servers 

## Combat Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Combat:AERampageMaxDistance 
| 70 
| Max AERampage range (% of max combat distance) 

| Combat:PetBaseCritChance 
| 0 
| Pet base crit chance 

| Combat:NPCBashKickLevel 
| 6 
| The level that NPCcan KICK/BASH 

| Combat:NPCKickStunLevel 
| 1 
| The level that NPC has a chance to stun with kick. 

| Combat:PCKickStunLevel 
| 56 
| The level that PC has a chance to stun with kick. 

| Combat:MeleeCritDifficulty 
| 8900 
| Value against which is rolled to check if a melee crit is triggered. Lower is easier 

| Combat:ArcheryCritDifficulty 
| 3400 
| Value against which is rolled to check if an archery crit is triggered. Lower is easier 

| Combat:ThrowingCritDifficulty 
| 1100 
| Value against which is rolled to check if a throwing crit is triggered. Lower is easier 

| Combat:NPCCanCrit 
| false 
| Setting whether an NPC can land critical hits 

| Combat:UseIntervalAC 
| true 
| Switch whether bonuses, armour class, multipliers, classes and caps should be considered in the calculation of damage values 

| Combat:PetAttackMagicLevel 
| 10 
| Level at which pets can cause magic damage, no longer used 

| Combat:NPCAttackMagicLevel 
| 10 
| Level at which NPC and pets can cause magic damage 

| Combat:LevelDifferenceRollCheck 
| -1 
| Level Difference to enable LeverDifferenceRollBonus for MeleeMitigation - Default: -1 is disabled, 20 is common 

| Combat:LevelDifferenceRollBonus 
| 0.5 
| Roll Bonus/Detrement if using LevelDifferenceRollCheck 

| Combat:EnableFearPathing 
| true 
| Setting whether to use pathing during fear 

| Combat:FleeGray 
| true 
| If true FleeGrayHPRatio will be used 

| Combat:FleeGrayHPRatio 
| 50 
| HP percentage when a Gray NPC begins to flee 

| Combat:FleeGrayMaxLevel 
| 18 
| NPC above this level won't do gray/green con flee 

| Combat:FleeHPRatio 
| 25 
| HP percentage when a NPC begins to flee 

| Combat:FleeIfNotAlone 
| false 
| If false, mobs won't flee if other mobs are in combat with it 

| Combat:AdjustProcPerMinute 
| true 
| Adapt the average proc rate to the speed of the weapon 

| Combat:AvgProcsPerMinute 
| 2.0 
| Average proc rate per minute 

| Combat:ProcPerMinDexContrib 
| 0.075 
| Increases the probability of a proc increased by DEX by the value indicated 

| Combat:BaseProcChance 
| 0.035 
| Base chance for procs 

| Combat:ProcDexDivideBy 
| 11000 
| Divisor for the probability of a proc increased by dexterity 

| Combat:MinRangedAttackDist 
| 25 
| Minimum Distance to use Ranged Attacks 

| Combat:ArcheryBonusRequiresStationary 
| true 
| does the 2x archery bonus chance require a stationary npc 

| Combat:ArcheryBonusLevelRequirement 
| 51 
| Level requirement when the 2x archery bonus will be enabled. The default is 51. 

| Combat:ArcheryNPCMultiplier 
| 1.0 
| Value is multiplied by the regular dmg to get the archery dmg 

| Combat:AssistNoTargetSelf 
| true 
| When assisting a target that does not have a target: true = target self, false = leave target as was before assist (false = live like) 

| Combat:MaxRampageTargets 
| 3 
| Maximum number of people hit with rampage 

| Combat:DefaultRampageTargets 
| 1 
| Default number of people to hit with rampage 

| Combat:RampageHitsTarget 
| false 
| Rampage will hit the target if it still has targets left 

| Combat:MaxFlurryHits 
| 2 
| Maximum number of extra hits from flurry 

| Combat:MinHastedDelay 
| 400 
| Minimum hasted combat delay 

| Combat:AvgDefProcsPerMinute 
| 2.0 
| Average defense procs per minute 

| Combat:DefProcPerMinAgiContrib 
| 0.075 
| How much agility contributes to defensive proc rate 

| Combat:NPCFlurryChance 
| 20 
| Chance for NPC to flurry 

| Combat:TauntOverLevel 
| 1 
| Allows you to taunt NPC's over warriors level 

| Combat:TauntOverAggro 
| 0 
| + amount over hate_top it will add before any bonus hate. 

| Combat:TauntChanceBonus 
| 0 
| Bonus to taunt chance 

| Combat:ClassicTauntSystem 
| false 
| Enable to use the pre 2006 taunt system. 

| Combat:TauntSkillFalloff 
| 0.33 
| For every taunt skill point that's not maxed you lose this percentage chance to taunt 

| Combat:EXPFromDmgShield 
| false 
| Determine if damage from a damage shield counts for experience gain 

| Combat:QuiverHasteCap 
| 1000 
| Quiver haste cap 1000 on live for a while, currently 700 on live 

| Combat:BerserkerFrenzyStart 
| 35 
| Percentage Health Points below which Warrior and Berserker start frenzy 

| Combat:BerserkerFrenzyEnd 
| 45 
| Percentage Health Points above which Warrior and Berserker end frenzy 

| Combat:OneProcPerWeapon 
| true 
| If enabled, One proc per weapon per round 

| Combat:ProjectileDmgOnImpact 
| true 
| If enabled, projectiles (i.e. arrows) will hit on impact, instead of instantly 

| Combat:MeleePush 
| true 
| Enable melee push 

| Combat:MeleePushChance 
| 50 
| NPC chance the target will be pushed. Made up, 100 actually isn't that bad 

| Combat:MeleePushForceClientPercent 
| 0.00 
| Percent to add or remove from push for players 

| Combat:MeleePushForcePetPercent 
| 0.00 
| Percent to add or remove from push for pets 

| Combat:NPCtoNPCPush 
| false 
| Disabled prevents NPC to NPC pushing per the 2013+ patch. 

| Combat:UseLiveCombatRounds 
| true 
| Turn this false if you don't want to worry about fixing up combat rounds for NPCs 

| Combat:NPCAssistCap 
| 5 
| Maximum number of NPC that will assist another NPC at once 

| Combat:NPCAssistCapTimer 
| 6000 
| Time a NPC will take to clear assist aggro cap space (milliseconds) 

| Combat:UseRevampHandToHand 
| false 
| Use h2h revamped dmg/delays I believe this was implemented during SoF 

| Combat:ClassicMasterWu 
| false 
| Classic Master Wu uses a random special, modern doesn't 

| Combat:HitBoxMod 
| 1.00 
| Added to test hit boxes. 

| Combat:LevelToStopDamageCaps 
| 0 
| Level to stop damage caps. 1 will effectively disable them, 20 should give basically same results as old incorrect system 

| Combat:LevelToStopACTwinkControl 
| 50 
| Level to stop armorclass twink control. 1 will effectively disable it, 50 should give basically same results as current system 

| Combat:ClassicNPCBackstab 
| false 
| True disables NPC facestab - NPC get normal attack if not behind 

| Combat:UseNPCDamageClassLevelMods 
| true 
| Uses GetClassLevelDamageMod calc in npc_scale_manager 

| Combat:UseExtendedPoisonProcs 
| false 
| Allow old school poisons to last until characrer zones, at a lower proc rate 

| Combat:EnableSneakPull 
| false 
| Enable implementation of Sneak Pull 

| Combat:SneakPullAssistRange 
| 400 
| Modified range of assist for sneak pull 

| Combat:Classic2HBAnimation 
| false 
| 2HB will use the 2 hand piercing animation instead of the overhead slashing animation 

| Combat:ArcheryConsumesAmmo 
| true 
| Set to false to disable Archery Ammo Consumption 

| Combat:ThrowingConsumesAmmo 
| true 
| Set to false to disable Throwing Ammo Consumption 

| Combat:UseLiveRiposteMechanics 
| false 
| Set to true to disable SPA 173 SE_RiposteChance from making those with the effect on them immune to enrage, can longer riposte from a riposte. 

| Combat:FrontalStunImmunityClasses 
| 0 
| Bitmask for Classes than have frontal stun immunity, No Races (0) by default. 

| Combat:NPCsUseFrontalStunImmunityClasses 
| false 
| Enable or disable NPCs using frontal stun immunity Classes from Combat:FrontalStunImmunityClasses, false by default. 

| Combat:FrontalStunImmunityRaces 
| 512 
| Bitmask for Races than have frontal stun immunity, Ogre (512) only by default. 

| Combat:NPCsUseFrontalStunImmunityRaces 
| true 
| Enable or disable NPCs using frontal stun immunity Races from Combat:FrontalStunImmunityRaces, true by default. 

| Combat:AssassinateOnlyHumanoids 
| true 
| Enable or disable Assassinate only being allowed on Humanoids, true by default. 

| Combat:AssassinateLevelRequirement 
| 60 
| Level requirement to enable assassinate attempts on backstabs. The default is 60. 

| Combat:HeadshotOnlyHumanoids 
| true 
| Enable or disable Headshot only being allowed on Humanoids, true by default. 

| Combat:EnableWarriorShielding 
| true 
| Enable or disable Warrior Shielding Ability (/shield), true by default. 

| Combat:BackstabIgnoresElemental 
| false 
| Enable or disable Elemental weapon damage affecting backstab damage, false by default. 

| Combat:BackstabIgnoresBane 
| false 
| Enable or disable Bane weapon damage affecting backstab damage, false by default. 

| Combat:DoubleBackstabLevelRequirement 
| 55 
| Level requirement to enable double backstab attempts. The default is 55. 

| Combat:SummonMeleeRange 
| true 
| Enable or disable summoning of a player when already in melee range of the summoner. 

| Combat:ArcheryHitPenalty 
| 0 
| Archery has a hit penalty to try to help balance it with the plethora of long term +hit modifiers for it - Default: 0 

| Combat:ArcheryBaseDamageBonus 
| 1 
| Percentage modifier to base archery Damage 0.5=50% base damage, 1=100%,2=200% - Default: 1 

| Combat:WaterMatchRequiredForAutoFireLoS 
| true 
| Enable/Disable the requirement of both the attacker/victim being both in or out of water for AutoFire LoS to pass. 

| Combat:ExtraAllowedKickClassesBitmask 
| 0 
| Bitmask for allowing extra classes beyond Warrior, Ranger, Beastlord, and Berserker to kick, No Extra Classes (0) by default 

| Combat:MaxProcs 
| 4 
| Adjustable maximum number of procs per round, the hard cap is MAX_PROCS (11). Requires mob repop or client zone when changed 

| Combat:FinishingBlowOnlyWhenFleeing 
| false 
| Enable to only allow Finishing Blow when fleeing (Original Style Finishing Blow) 

| Combat:ClassicTripleAttack 
| false 
| enable to use non-skill based classic triple attack. Originally it was Warrior Only but was expanded, can use the TripleAttackChance to tune the classes out. 

| Combat:ClassicTripleAttackChanceWarrior 
| 100 
| Innate Chance for Warrior to Triple Attack after a Double Attack (125 = 12.5%). DEFAULT: 100 

| Combat:ClassicTripleAttackChanceMonk 
| 100 
| Innate Chance for Monk to Triple Attack after a Double Attack (200 = 20%). DEFAULT: 100 

| Combat:ClassicTripleAttackChanceBerserker 
| 100 
| Innate Chance for Berserker to Triple Attack after a Double Attack (200 = 20%). DEFAULT: 100 

| Combat:ClassicTripleAttackChanceRanger 
| 100 
| Innate Chance for Ranger to Triple Attack after a Double Attack (200 = 20%). DEFAULT: 100 

| Combat:StunChance 
| 12 
| Percent chance that client will be stunned when mob is behind player. DEFAULT: 12 

| Combat:StunDuration 
| 2000 
| Duration of stuns in ms. DEFAULT: 2000 

| Combat:ClientStunMessage 
| false 
| Client stunning NPC produces message. DEFAULT false 

| Combat:BashTwoHanderUseShoulderAC 
| false 
| Enable to use shoulder AC for bash calculations when two hander is equipped. Unproven if accurate DEFAULT: false 

| Combat:BashACBonusDivisor 
| 25.0 
| this divides the AC value contribution to bash damage, lower to increase damage 

| Combat:UseMobStaticOffenseSkill 
| false 
| Toggle to enabled the use of a static offense skill for Mobs. DEFAULT: false 

| Combat:UseEnhancedMobStaticWeaponSkill 
| false 
| Toggle to enabled the use of an enhanced (slightly higher hit rate) static weapon skill for Mobs. DEFAULT: false 

| Combat:PCAttackPowerScaling 
| 100 
| Applies scaling to PC Attack Power (75 = 75%). DEFAULT: 100 to not adjust existing Servers 

| Combat:PCAccuracyAvoidanceMod2Scale 
| 100 
| Scale Factor for PC Accuracy and Avoidance (Mod2, found on items). Found a value of 100 to make both too strong (75 = x0.75). DEFAULT: 100 to not adjust existing Servers 

| Combat:AllowRaidTargetBlind 
| false 
| Toggle to allow raid targets to be blinded, default is false (Live-like) 

| Combat:RogueBackstabHasteCorrection 
| false 
| Toggle to enable correction for Haste impacting Backstab DPS too much. DEFAULT: false 

| Combat:LegacyComputeDefense 
| false 
| Trim AGI Scaling of defense mostly for lower levels to help compensate for the newer agi based defense system. Default: False 

| Combat:SlayDamageMultiplier 
| 1.0 
| Slay Damage Adjustment - Multiply final slay damage by this value. Default: 1.0 

| Combat:SlayRateMultiplier 
| 1.0 
| Slay Rate Adjustments - Multiply final slay rate check by this value. Default: 1.0 

| Combat:MaximumLevelStunsCripplingBlow 
| 55 
| Maximum level that Crippling Blows will stun a npc. Default: 55 

| Combat:ArcheryBaseDamage 
| 0 
| Archery base damage, default is 0 

| Combat:BackstabBaseDamage 
| 0 
| Backstab base damage, default is 0 

| Combat:BashBaseDamage 
| 2 
| Bash base damage, default is 2 

| Combat:DragonPunchBaseDamage 
| 12 
| Dragon Punch base damage, default is 12 

| Combat:EagleStrikeBaseDamage 
| 7 
| Eagle Strike base damage, default is 7 

| Combat:FlyingKickBaseDamage 
| 25 
| Flying Kick base damage, default is 25 

| Combat:FrenzyBaseDamage 
| 10 
| Frenzy base damage, default is 10 

| Combat:KickBaseDamage 
| 3 
| Kick base damage, default is 3 

| Combat:RoundKickBaseDamage 
| 5 
| Round Kick base damage, default is 5 

| Combat:ThrowingBaseDamage 
| 0 
| Throwing base damage, default is 0 

| Combat:TigerClawBaseDamage 
| 4 
| Tiger Claw base damage, default is 4 

## Command Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Command:DyeCommandRequiresDyes 
| false 
| Enable this to require a Prismatic Dye (32557) each time someone uses #dye. 

| Command:HideMeCommandDisablesTells 
| true 
| Disable this to allow tells to be received when using #hideme. 

## Console Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Console:SessionTimeOut 
| 600000 
| Amount of time in ms for the console session to time out 

## Doors Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Doors:RequireKeyOnCursor 
| false 
| Enable this to require pre-keyring keys to be on player cursor to open doors. 

## DynamicZone Rules¶

| 

Rule Name 
| Default Value 
| Description 

| DynamicZone:ClientRemovalDelayMS 
| 60000 
| Delay (milliseconds) until a client is teleported out of dynamic zone after being removed as member 

| DynamicZone:EmptyShutdownEnabled 
| true 
| Enable early instance shutdown for dynamic zones that have no members 

| DynamicZone:EmptyShutdownDelaySeconds 
| 1500 
| Seconds to set dynamic zone instance expiration if early shutdown enabled 

| DynamicZone:EnableInDynamicZoneStatus 
| false 
| Enables the 'In Dynamic Zone' member status in dynamic zone window. If false (live-like) players inside the dynamic zone will show as 'Online' 

| DynamicZone:WorldProcessRate 
| 6000 
| Timer interval (milliseconds) that systems check their dynamic zone states 

## EventLog Rules¶

| 

Rule Name 
| Default Value 
| Description 

| EventLog:RecordSellToMerchant 
| false 
| Record sales from a player to an NPC merchant in eventlog table 

| EventLog:RecordBuyFromMerchant 
| false 
| Record purchases by a player from an NPC merchant in eventlog table 

## Expansion Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Expansion:CurrentExpansion 
| -1 
| The current expansion enabled for the server [-1 = ALL, 0 = Classic, 1 = Kunark etc.] 

| Expansion:UseCurrentExpansionAAOnly 
| false 
| When true will only load AA ranks that match CurrentExpansion rule 

| Expansion:AutoGrantAAExpansion 
| -1 
| Expansion to auto grant AAs up to, [-1 = Disabled, 0 = Classic, 1 = Kunark etc.] 

## Expedition Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Expedition:MinStatusToBypassPlayerCountRequirements 
| 80 
| Minimum GM status to bypass minimum player requirements for Expedition creation 

| Expedition:AlwaysNotifyNewLeaderOnChange 
| false 
| Always notify clients when made expedition leader. If false (live-like) new leaders are only notified when made leader via /dzmakeleader 

| Expedition:LockoutDurationMultiplier 
| 1.0 
| Multiplies lockout duration by this value when new lockouts are added 

| Expedition:ChooseLeaderCooldownTime 
| 2000 
| Cooldown time (milliseconds) between choosing a new leader for automatic leader changes 

## Faction Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Faction:AllyFactionMinimum 
| 1100 
| Minimum faction for ally 

| Faction:WarmlyFactionMinimum 
| 750 
| Minimum faction for warmly 

| Faction:KindlyFactionMinimum 
| 500 
| Minimum faction for kindly 

| Faction:AmiablyFactionMinimum 
| 100 
| Minimum faction for amiably 

| Faction:IndifferentlyFactionMinimum 
| 0 
| Minimum faction for indifferently 

| Faction:ApprehensivelyFactionMinimum 
| -100 
| Minimum faction for apprehensively 

| Faction:DubiouslyFactionMinimum 
| -500 
| Minimum faction for dubiously 

| Faction:ThreateninglyFactionMinimum 
| -750 
| Minimum faction for threateningly 

## GM Rules¶

| 

Rule Name 
| Default Value 
| Description 

| GM:MinStatusToSummonItem 
| 250 
| Minimum required status to summon items 

| GM:MinStatusToZoneAnywhere 
| 250 
| Minimum required status to zone anywhere 

| GM:MinStatusToLevelTarget 
| 100 
| Minimum required status to set the level of a player 

| GM:MinStatusToBypassLockedServer 
| 100 
| Players >= this status can log in to the server even when it is locked 

| GM:MinStatusToBypassCheckSumVerification 
| 100 
| Players >= this status can bypass the eqgame.exe and spells_us.txt checksum verification 

## Guild Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Guild:PlayerCreationAllowed 
| false 
| Allow players to create a guild using the window in Underfoot+ 

| Guild:PlayerCreationLimit 
| 1 
| Only allow use of the UF+ window if the account has < than this number of guild leaders on it 

| Guild:PlayerCreationRequiredStatus 
| 0 
| Required status to create a guild 

| Guild:PlayerCreationRequiredLevel 
| 0 
| Required level of the player attempting to create the guild 

| Guild:PlayerCreationRequiredTime 
| 0 
| Time needed online on the account to create a guild (in minutes) 

| Guild:TributeTime 
| 600000 
| Time in ms for guild tributes. Default is 10 mins. 

| Guild:TributeTimeRefreshInterval 
| 180000 
| Time in ms to send all guild members a Tribute Time refresh. Default is 3 mins. 

| Guild:TributePlatConversionRate 
| 10 
| The conversion rate of platinum donations. Default is 10 guild favor to 1 platinum. 

| Guild:UseCharacterMaxLevelForGuildTributes 
| true 
| Guild Tributes will adhere to Character:MaxLevel. Default is true. 

## HotReload Rules¶

| 

Rule Name 
| Default Value 
| Description 

| HotReload:QuestsRepopWithReload 
| true 
| When a hot reload is triggered, the zone will repop 

| HotReload:QuestsRepopWhenPlayersNotInCombat 
| true 
| When a hot reload is triggered, the zone will repop when no clients are in combat 

| HotReload:QuestsResetTimersWithReload 
| true 
| When a hot reload is triggered, quest timers will be reset 

| HotReload:QuestsAutoReloadGlobalScripts 
| false 
| When a quest, plugin, or global script changes, auto reload. 

## Instances Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Instances:ReservedInstances 
| 100 
| Number of instance IDs which are reserved for globals. This value should not be changed while a server is running 

| Instances:RecycleInstanceIds 
| true 
| Setting whether free instance IDs should be recycled to prevent them from gradually running out at 32k 

| Instances:GuildHallExpirationDays 
| 90 
| Amount of days before a Guild Hall instance expires 

## Inventory Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Inventory:EnforceAugmentRestriction 
| true 
| Forces augment slot restrictions 

| Inventory:EnforceAugmentUsability 
| true 
| Forces augmented item usability 

| Inventory:EnforceAugmentWear 
| true 
| Forces augment wear slot validation 

| Inventory:DeleteTransformationMold 
| true 
| False if you want mold to last forever 

| Inventory:AllowAnyWeaponTransformation 
| false 
| Weapons can use any weapon transformation 

| Inventory:TransformSummonedBags 
| false 
| Transforms summoned bags into disenchanted ones instead of deleting 

| Inventory:AllowMultipleOfSameAugment 
| false 
| Allows multiple of the same augment to be placed in an item via #augmentitem or MQ2, set to true to allow 

| Inventory:AlternateAugmentationSealer 
| 53 
| Allows RoF+ clients to augment items from a special container type 

| Inventory:LazyLoadBank 
| true 
| Don't load bank during zoning, only when in proximinity to a banker. May increase zone speed and stability 

## Items Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Items:DisableAttuneable 
| false 
| Enable this to disable Attuneable Items 

| Items:DisableBardFocusEffects 
| false 
| Enable this to disable Bard Focus Effects on Items 

| Items:DisableLore 
| false 
| Enable this to disable Lore Items 

| Items:DisableNoDrop 
| false 
| Enable this to disable No Drop Items 

| Items:DisableNoPet 
| false 
| Enable this to disable No Pet Items 

| Items:DisableNoRent 
| false 
| Enable this to disable No Rent Items 

| Items:DisableNoTransfer 
| false 
| Enable this to disable No Transfer Items 

| Items:DisablePotionBelt 
| false 
| Enable this to disable Potion Belt Items 

| Items:DisableSpellFocusEffects 
| false 
| Enable this to disable Spell Focus Effects on Items 

| Items:SummonItemAllowInvisibleAugments 
| false 
| Enable this to allow augments to be put in invisible augment slots of items in Client::SummonItem 

| Items:AugmentItemAllowInvisibleAugments 
| false 
| Enable this to allow augments to be put in invisible augment slots by players 

## Logging Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Logging:PrintFileFunctionAndLine 
| false 
| Ex: [World Server] [net.cpp::main:309] Loading variables... 

| Logging:WorldGMSayLogging 
| true 
| Relay worldserver logging to zone processes via GM say output 

| Logging:PlayerEventsQSProcess 
| false 
| Have query server process player events instead of world. Useful when wanting to use a dedicated server and database for processing player events on separate disk 

| Logging:BatchPlayerEventProcessIntervalSeconds 
| 5 
| This is the interval in which player events are processed in world or qs 

| Logging:BatchPlayerEventProcessChunkSize 
| 10000 
| This is the cap of events that can be inserted into the queue before a force flush. This is to keep from hitting MySQL max_allowed_packet and killing the connection 

## Mail Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Mail:EnableMailSystem 
| true 
| Setting whether the mail system is activated. If false, client won't bring up the Mail window 

| Mail:ExpireTrash 
| 0 
| Setting when the mail trash is emptied. Time in seconds. 0 will delete all messages in the trash when the mailserver starts 

| Mail:ExpireRead 
| 31536000 
| Setting when read mails expire. 31536000=1 Year. Set to -1 for never 

| Mail:ExpireUnread 
| 31536000 
| Setting when unread mails expire. 31536000=1 Year. Set to -1 for never 

## Map Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Map:FixPathingZOnSendTo 
| false 
| Try to repair Z coordinates in the SendTo routine as well 

| Map:FixZWhenPathing 
| true 
| Automatically fix NPC Z coordinates when moving/pathing/engaged (Far less CPU intensive than its predecessor) 

| Map:MobZVisualDebug 
| false 
| Displays spell effects determining whether or not NPC is hitting Best Z calcs (blue for hit, red for miss) 

| Map:MobPathingVisualDebug 
| false 
| Displays nodes in pathing points in realtime to help with visual debugging 

| Map:FixPathingZMaxDeltaSendTo 
| 20 
| At runtime in SendTo: maximum change in Z to allow the BestZ code to apply 

| Map:FindBestZHeightAdjust 
| 1 
| Adds this to the current Z before seeking the best Z position 

## Merchant Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Merchant:UsePriceMod 
| true 
| Use faction/charisma price modifiers 

| Merchant:UseClassicPriceMod 
| false 
| Must also set UsePriceMod. Negates other rules for vendor price mods. 

| Merchant:SellCostMod 
| 1.05 
| Modifier for NPC sell price 

| Merchant:BuyCostMod 
| 0.95 
| Modifier for NPC buy price 

| Merchant:PriceBonusPct 
| 4 
| Determines maximum price bonus from having good faction/CHA. Value is a percent 

| Merchant:PricePenaltyPct 
| 4 
| Determines maximum price penalty from having bad faction/CHA. Value is a percent 

| Merchant:ChaBonusMod 
| 3.45 
| Determines CHA cap, from 104 CHA. 3.45 is 132 CHA at apprehensive. 0.34 is 400 CHA at apprehensive 

| Merchant:ChaPenaltyMod 
| 1.52 
| Determines CHA bottom, up to 102 CHA. 1.52 is 37 CHA at apprehensive. 0.98 is 0 CHA at apprehensive 

| Merchant:EnableAltCurrencySell 
| true 
| Enables the ability to resell items to alternate currency merchants 

| Merchant:AllowCorpse 
| false 
| Setting whether dealers leave a corpse behind 

## Mercs Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Mercs:SuspendIntervalMS 
| 10000 
| Time interval for merc suspend (milliseconds) 

| Mercs:UpkeepIntervalMS 
| 180000 
| Time interval for merc upkeep (milliseconds) 

| Mercs:SuspendIntervalS 
| 10 
| Time interval for merc suspend command (seconds) 

| Mercs:AllowMercs 
| false 
| Allow the use of mercs 

| Mercs:ChargeMercPurchaseCost 
| false 
| Turns Mercenary purchase costs on or off 

| Mercs:ChargeMercUpkeepCost 
| false 
| Turns Mercenary upkeep costs on or off 

| Mercs:AggroRadius 
| 100 
| Determines the distance from which a merc will aggro group member's target(also used to determine the distance at which a healer merc will begin healing a group member) 

| Mercs:AggroRadiusPuller 
| 25 
| Determines the distance from which a merc will aggro group member's target, if they have the group role of puller (also used to determine the distance at which a healer merc will begin healing a group member, if they have the group role of puller) 

| Mercs:ResurrectRadius 
| 50 
| Determines the distance from which a healer merc will attempt to resurrect a group member's corpse 

| Mercs:ScaleRate 
| 100 
| Merc scale factor 

| Mercs:AllowMercSuspendInCombat 
| true 
| Allow merc suspend in combat 

| Mercs:MercsIgnoreLevelBasedHasteCaps 
| false 
| Ignores hard coded level based haste caps. 

| Mercs:MercsHasteCap 
| 100 
| Haste cap for non-v3(over haste) haste 

| Mercs:MercsHastev3Cap 
| 25 
| Haste cap for v3(over haste) haste 

## NPC Rules¶

| 

Rule Name 
| Default Value 
| Description 

| NPC:MinorNPCCorpseDecayTime 
| 450000 
| NPC corpse decay time, if NPC below level 55 (milliseconds) 

| NPC:MajorNPCCorpseDecayTime 
| 1500000 
| NPC corpse decay time, if NPC equal or greater than level 55 (milliseconds) 

| NPC:CorpseUnlockTimer 
| 150000 
| Time after which corpses are unlocked for everyone to loot (milliseconds) 

| NPC:EmptyNPCCorpseDecayTime 
| 0 
| NPC corpse decay time, if no items are left on the corpse (milliseconds) 

| NPC:UseItemBonusesForNonPets 
| true 
| Switch whether item bonuses should be used for NPCs who are not pets 

| NPC:UseBaneDamage 
| false 
| If NPCs can't inherently hit the target we don't add bane/magic dmg which isn't exactly the same as PCs 

| NPC:SayPauseTimeInSec 
| 5 
| Time span in which an NPC pauses his movement after a Say event without aggro (seconds) 

| NPC:OOCRegen 
| 0 
| Enable out-of-combat regeneration for NPC 

| NPC:BuffFriends 
| false 
| Setting whether NPC should buff other NPC 

| NPC:EnableNPCQuestJournal 
| false 
| Setting whether the NPC Quest Journal is active 

| NPC:LastFightingDelayMovingMin 
| 10000 
| Minimum time before mob goes home after all aggro loss (milliseconds) 

| NPC:LastFightingDelayMovingMax 
| 20000 
| Maximum time before mob goes home after all aggro loss (milliseconds) 

| NPC:SmartLastFightingDelayMoving 
| true 
| When true, mobs that started going home previously will do so again immediately if still on FD hate list 

| NPC:ReturnNonQuestNoDropItems 
| false 
| Returns NO DROP items on NPC that don't have an EVENT_TRADE sub in their script 

| NPC:ReturnQuestItemsFromNonQuestNPCs 
| false 
| Returns Quest items traded to NPCs that are not flagged as a Quest NPC 

| NPC:StartEnrageValue 
| 9 
| Percentage HP that an NPC will begin to enrage 

| NPC:LiveLikeEnrage 
| false 
| If set to true then only player controlled pets will enrage 

| NPC:EnableMeritBasedFaction 
| false 
| If set to true, faction will be given in the same way as experience (solo/group/raid) 

| NPC:NPCToNPCAggroTimerMin 
| 500 
| Minimum time span after which one NPC aggro another NPC (milliseconds) 

| NPC:NPCToNPCAggroTimerMax 
| 6000 
| Maximum time span after which one NPC aggro another NPC (milliseconds) 

| NPC:UseClassAsLastName 
| true 
| Uses class archetype as LastName for NPC with none 

| NPC:NewLevelScaling 
| true 
| Better level scaling, use old if new formulas would break your server 

| NPC:NPCBackstabMod 
| 1.9 
| Multiplier for NPC Backstab, Higher = Lower backstab amount 

| NPC:NPCGatePercent 
| 20 
| Percentage at which the NPC Will attempt to gate at 

| NPC:NPCGateNearBind 
| false 
| Will NPC attempt to gate when near bind location? 

| NPC:NPCGateDistanceBind 
| 75 
| Distance from bind before NPC will attempt to gate 

| NPC:NPCHealOnGate 
| true 
| Will the NPC Heal on Gate 

| NPC:UseMeditateBasedManaRegen 
| false 
| Based NPC ooc regen on Meditate skill 

| NPC:NPCHealOnGateAmount 
| 25 
| How much the NPC will heal on gate if enabled 

| NPC:AnimalsOpenDoors 
| true 
| Determines or not whether animals open doors or not when they approach them 

| NPC:MaxRaceID 
| 732 
| Maximum Race ID, RoF2 by default supports up to 732 

| NPC:DisableLastNames 
| false 
| Enable to disable NPC Last Names 

| NPC:NPCIgnoreLevelBasedHasteCaps 
| false 
| Ignores hard coded level based haste caps. 

| NPC:NPCHasteCap 
| 150 
| Haste cap for non-v3(over haste) haste 

| NPC:NPCHastev3Cap 
| 25 
| Haste cap for v3(over haste) haste 

## Network Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Network:ResendDelayBaseMS 
| 100 
| Base delay for resending data in EQStreamManager (milliseconds) 

| Network:ResendDelayFactor 
| 1.5 
| Multiplier for the base delay when resending data in EQStreamManager 

| Network:ResendDelayMinMS 
| 300 
| Minimum timespan between two send retries (milliseconds) 

| Network:ResendDelayMaxMS 
| 5000 
| Maximum timespan between two send retries (milliseconds) 

| Network:ClientDataRate 
| 0.0 
| KB / sec, 0.0 disabled 

| Network:CompressZoneStream 
| true 
| Setting whether the zone stream should be compressed for transmission 

## Parcel Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Parcel:EnableParcelMerchants 
| true 
| Enable or Disable Parcel Merchants. Requires RoF+ Clients. 

| Parcel:EnableDirectToInventoryDelivery 
| false 
| Enable or Disable RoF2 bazaar purchases to be delivered directly to the buyer's inventory. 

| Parcel:DeleteOnDuplicate 
| false 
| Delete retrieved item if it creates a lore conflict. 

| Parcel:EnablePruning 
| false 
| Enable the automatic pruning of sent parcels. Uses rule ParcelPruneDelay for prune delay. 

| Parcel:ParcelDeliveryDelay 
| 30000 
| Sets the time that a player must wait between sending parcels. 

| Parcel:ParcelMaxItems 
| 50 
| The maximum number of parcels a player is allowed to have in their mailbox. 

| Parcel:ParcelPruneDelay 
| 30 
| The number of days after which a parcel is deleted. Items are lost! 

## Pathing Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Pathing:Find 
| true 
| Enable pathing for FindPerson requests from the client 

| Pathing:Fear 
| true 
| Enable pathing for fear 

| Pathing:NavmeshStepSize 
| 100.0f 
| Step size for the movement manager 

| Pathing:ShortMovementUpdateRange 
| 130.0f 
| Range for short movement updates 

| Pathing:MaxNavmeshNodes 
| 4092 
| Maximum navmesh nodes in a traversable path 

## Pets Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Pets:AttackCommandRange 
| 150 
| Range at which a pet will respond to attack commands 

| Pets:UnTargetableSwarmPet 
| false 
| Setting whether swarm pets should be targetable 

| Pets:PetPowerLevelCap 
| 10 
| Maximum number of levels a player pet can go up with pet power 

| Pets:CanTakeNoDrop 
| false 
| Setting whether anyone can give no-drop items to pets 

| Pets:CanTakeQuestItems 
| true 
| Setting whether anyone can give quest items to pets 

| Pets:LivelikeBreakCharmOnInvis 
| true 
| Default: true will break charm on any type of invis (hide/ivu/iva/etc) false will only break if the pet can not see you (ex. you have an undead pet and cast IVU 

| Pets:ClientPetsUseOwnerNameInLastName 
| true 
| Disable this to keep client pet's last names from being owner_name's pet 

| Pets:PetTauntRange 
| 150 
| Range at which a pet will taunt targets. 

## QueryServ Rules¶

| 

Rule Name 
| Default Value 
| Description 

| QueryServ:PlayerLogChat 
| false 
| Log player chat 

| QueryServ:PlayerLogTrades 
| false 
| Log player trades 

| QueryServ:PlayerDropItems 
| false 
| Log player dropping items 

| QueryServ:PlayerLogHandins 
| false 
| Log player hand ins 

| QueryServ:PlayerLogNPCKills 
| false 
| Log player NPC kills 

| QueryServ:PlayerLogDeletes 
| false 
| Log player deletes 

| QueryServ:PlayerLogMoves 
| false 
| Log player moves 

| QueryServ:PlayerLogMerchantTransactions 
| false 
| Log merchant transactions 

| QueryServ:PlayerLogZone 
| false 
| Log player zone events 

| QueryServ:PlayerLogDeaths 
| false 
| Log player deaths 

| QueryServ:PlayerLogConnectDisconnect 
| false 
| Logs player connect/disconnect state 

| QueryServ:PlayerLogLevels 
| false 
| Log player leveling/deleveling 

| QueryServ:PlayerLogAARate 
| false 
| Log player AA experience rates 

| QueryServ:PlayerLogQGlobalUpdate 
| false 
| Log player QGlobal updates 

| QueryServ:PlayerLogTaskUpdates 
| false 
| Log player Task updates 

| QueryServ:PlayerLogAAPurchases 
| false 
| Log player AA purchases 

| QueryServ:PlayerLogTradeSkillEvents 
| false 
| Log player tradeskill transactions 

| QueryServ:PlayerLogIssuedCommandes 
| false 
| Log player issued commands 

| QueryServ:PlayerLogAlternateCurrencyTransactions 
| false 
| Log player alternate currency transactions 

## Range Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Range:Say 
| 15 
| The range that is required before /say or hail messages will work to an NPC 

| Range:Emote 
| 135 
| The packet range in which emote messages are sent' 

| Range:BeginCast 
| 200 
| The packet range in which begin cast messages are sent 

| Range:Anims 
| 135 
| The packet range in which begin cast messages are sent 

| Range:SpellParticles 
| 135 
| The packet range in which spell particles are sent 

| Range:DamageMessages 
| 50 
| The packet range in which damage messages are sent (non-crit) 

| Range:SpellMessages 
| 75 
| The packet range in which spell damage messages are sent 

| Range:SongMessages 
| 75 
| The packet range in which song messages are sent 

| Range:StunMessages 
| 75 
| The packet range in which stun messages are sent 

| Range:ClientPositionUpdates 
| 300 
| Distance in which the own changed position is communicated to other clients 

| Range:CriticalDamage 
| 80 
| The packet range in which critical hit messages are sent 

| Range:MobCloseScanDistance 
| 600 
| Close scan distance 

| Range:MaxDistanceToClickDoors 
| 100 
| Max distance that a client can click a door from (Client says 'You can't reach that' at roughly 25-50 for most doors) 

## Skills Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Skills:MaxTrainTradeskills 
| 21 
| Highest level for trade skills that can be taught by the trainer 

| Skills:MaxTrainResearch 
| 21 
| Highest level for training research from a GM. 

| Skills:UseLimitTradeskillSearchSkillDiff 
| true 
| Enables the limit for the maximum difference between trivial and skill for recipe searches and favorites 

| Skills:TrivialTradeskillCombinesNoFail 
| false 
| Enable to make all trivial tradeskill combines unable to fail 

| Skills:MaxTradeskillSearchSkillDiff 
| 50 
| The maximum difference in skill between the trivial of an item and the skill of the player if the trivial is higher than the skill. Recipes that have not been learnt or made at least once via the Experiment mode will be removed from searches based on this criteria. 

| Skills:MaxTrainSpecializations 
| 50 
| Maximum level a GM trainer will train casting specializations 

| Skills:SwimmingStartValue 
| 100 
| Start value of swimming skill 

| Skills:TrainSenseHeading 
| false 
| Switch whether SenseHeading is trained by use 

| Skills:SenseHeadingStartValue 
| 200 
| Start value of sense heading skill 

| Skills:SelfLanguageLearning 
| true 
| Enabling self-learning of languages 

| Skills:RequireTomeHandin 
| false 
| Disable click-to-learn and force hand in to Guild Master 

| Skills:TradeSkillClamp 
| 0 
| Legacy tradeskills would clamp at 252 regardless of item modifiers and skill combination. DEFAULT: 0 will bypass clamp. Legacy value 252 

| Skills:UseAltSinisterStrikeFormula 
| false 
| Enabling will utilize a formula derived from 2004 monkey business post which makes the AA actually worth something. 

| Skills:TrackingAutoRefreshSkillUps 
| true 
| Disable to prevent tracking auto-refresh from giving skill-ups. Classic Style 

| Skills:MaximumTauntDistance 
| 150 
| Maximum player taunt distance. 

## Spells Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Spells:AllowExtraDmgSkill 
| false 
| Allow ExtraDmgSkill from Items, Spells, and AAs to apply ExtraDmgAmt when the ExtraDmgSkill matches the casted Spells Skill Type. 

| Spells:BaseCritChance 
| 0 
| Base percentage chance that everyone has to crit a spell 

| Spells:BaseCritRatio 
| 100 
| Base percentage bonus to damage on a successful spell crit. 100=2xdamage 

| Spells:WizCritLevel 
| 12 
| Level wizards first get spell crits 

| Spells:WizCritChance 
| 7 
| Wizards crit chance, on top of BaseCritChance 

| Spells:WizCritRatio 
| 0 
| Wizards crit bonus, on top of BaseCritRatio (should be 0 for Live-like) 

| Spells:TranslocateTimeLimit 
| 0 
| If not zero, time in seconds to accept a Translocate 

| Spells:SacrificeMinLevel 
| 46 
| First level the spell Sacrifice will work on 

| Spells:SacrificeMaxLevel 
| 69 
| Last level the spell Sacrifice will work on 

| Spells:SacrificeItemID 
| 9963 
| Item ID of the item Sacrifice will return (defaults to an Essence Emerald) 

| Spells:EnableSpellGlobals 
| false 
| If enabled, spells check the spell_globals table and compare character data from their quest globals before allowing the spell to scribe with scribespells/traindiscs 

| Spells:EnableSpellBuckets 
| false 
| If enabled, spells check the spell_buckets table and compare character data from their data buckets before allowing the spell to scribe with scribespells/traindiscs 

| Spells:MaxBuffSlotsNPC 
| 60 
| Maximum number of NPC buff slots. The default value is the limit of the Titanium client 

| Spells:MaxSongSlotsNPC 
| 0 
| Maximum number of NPC song slots. NPC don't have songs, so it should be 0 

| Spells:MaxDiscSlotsNPC 
| 0 
| Maximum number of NPC disc slots. NPC don't have discs, so it should be 0 

| Spells:MaxTotalSlotsNPC 
| 60 
| Maximum total of NPC slots. The default value is the limit of the Titanium client 

| Spells:MaxTotalSlotsPET 
| 30 
| Maximum total of pet slots. The default value is the limit of the Titanium client 

| Spells:ReflectType 
| 4 
| Reflect type. 0=disabled, 1=single target player spells only, 2=all player spells, 3=all single target spells, 4=all spells 

| Spells:ReflectMessagesClose 
| true 
| True (Live functionality) is for Reflect messages to show to players within close proximity. False shows just player reflecting 

| Spells:LiveLikeFocusEffects 
| true 
| Determines whether specific healing, dmg and mana reduction focuses are randomized 

| Spells:BaseImmunityLevel 
| 55 
| The level that targets start to be immune to stun, fear and mez spells with a maximum level of 0 

| Spells:NPCIgnoreBaseImmunity 
| true 
| Whether or not NPC get to ignore the BaseImmunityLevel for their spells 

| Spells:AvgSpellProcsPerMinute 
| 6.0 
| Adjust rate for sympathetic spell procs 

| Spells:ResistFalloff 
| 67 
| Maximum that level that will adjust our resist chance based on level modifiers 

| Spells:CharismaEffectiveness 
| 10 
| Determines how much resist modification charisma applies to charm/pacify checks. Default 10 CHA = -1 resist mod 

| Spells:CharismaEffectivenessCap 
| 255 
| Determines how much resist modification charisma applies to charm/pacify checks. Default 10 CHA = -1 resist mod 

| Spells:CharismaCharmDuration 
| false 
| Allow CHA resist mod to extend charm duration 

| Spells:CharmBreakCheckChance 
| 25 
| Determines chance for a charm break check to occur each buff tick 

| Spells:CharmDisablesSpecialAbilities 
| false 
| When charm is cast on an NPC, strip their special abilities 

| Spells:RootBreakFromSpells 
| 55 
| Chance for root to break when cast on 

| Spells:DeathSaveCharismaMod 
| 3 
| Determines how much charisma effects chance of death save firing 

| Spells:DivineInterventionHeal 
| 8000 
| Divine intervention heal amount 

| Spells:AdditiveBonusWornType 
| 0 
| Calc worn bonuses to add together (instead of taking highest) if set to THIS worn type. (2=Will covert live items automatically) 

| Spells:UseCHAScribeHack 
| false 
| ScribeSpells and TrainDiscs quest functions will ignore entries where field 12 is CHA 

| Spells:BuffLevelRestrictions 
| true 
| Buffs will not land on low level toons like live 

| Spells:RootBreakCheckChance 
| 70 
| Determines chance for a root break check to occur each buff tick 

| Spells:FearBreakCheckChance 
| 70 
| Determines chance for a fear break check to occur each buff tick 

| Spells:SuccorFailChance 
| 2 
| Determines chance for a succor spell not to teleport an invidual player 

| Spells:FRProjectileItem_Titanium 
| 1113 
| Item id for Titanium clients for Fire 'spell projectile' 

| Spells:FRProjectileItem_SOF 
| 80684 
| Item id for SOF clients for Fire 'spell projectile' 

| Spells:FRProjectileItem_NPC 
| 80684 
| Item id for NPC Fire 'spell projectile' 

| Spells:UseLiveSpellProjectileGFX 
| false 
| Use spell projectile graphics set in the spells_new table (player_1). Server must be using UF+ spell file 

| Spells:FocusCombatProcs 
| false 
| Allow all combat procs to receive focus effects 

| Spells:PreNerfBardAEDoT 
| false 
| Allow bard AOE dots to damage targets when moving 

| Spells:AI_SpellCastFinishedFailRecast 
| 800 
| AI spell recast time when an spell is cast but fails, ie if stunned (milliseconds) 

| Spells:AI_EngagedNoSpellMinRecast 
| 500 
| AI spell recast time check when no spell is cast while engaged. Min time in random (milliseconds) 

| Spells:AI_EngagedNoSpellMaxRecast 
| 1000 
| AI spell recast time check when no spell is cast engaged. Mmaximum time in random (milliseconds) 

| Spells:AI_EngagedBeneficialSelfChance 
| 100 
| Chance during first AI Cast check to do a beneficial spell on self 

| Spells:AI_EngagedBeneficialOtherChance 
| 25 
| Chance during second AI Cast check to do a beneficial spell on others 

| Spells:AI_EngagedDetrimentalChance 
| 20 
| Chance during third AI Cast check to do a determental spell on others 

| Spells:AI_PursueNoSpellMinRecast 
| 500 
| AI spell recast time check when no spell is cast while chasing target. Mmin time in random (milliseconds) 

| Spells:AI_PursueNoSpellMaxRecast 
| 2000 
| AI spell recast time check when no spell is cast while chasing target. Maximum time in random (milliseconds) 

| Spells:AI_PursueDetrimentalChance 
| 90 
| Chance while chasing target to cast a detrimental spell 

| Spells:AI_IdleNoSpellMinRecast 
| 6000 
| AI spell recast time check when no spell is cast while idle. Mmin time in random (milliseconds) 

| Spells:AI_IdleNoSpellMaxRecast 
| 60000 
| AI spell recast time check when no spell is cast while chasing target. Maximum time in random (milliseconds) 

| Spells:AI_IdleBeneficialChance 
| 100 
| Chance while idle to do a beneficial spell on self or others 

| Spells:AI_HealHPPct 
| 50 
| Hitpoint percentage at which NPC starts healing when max_hp of the spell is not set (inside and outside combat) 

| Spells:SHDProcIDOffByOne 
| true 
| Pre June 2009 SHD spell procs were off by 1, they stopped doing this in June 2009 (UF+ spell files need this false) 

| Spells:Jun182014HundredHandsRevamp 
| false 
| This should be true for if you import a spell file newer than June 18, 2014 

| Spells:SwarmPetTargetLock 
| false 
| Use old method of swarm pets target locking till target dies then despawning 

| Spells:NPC_UseFocusFromSpells 
| true 
| Allow NPC to use most spell derived focus effects 

| Spells:NPC_UseFocusFromItems 
| false 
| Allow NPC to use most item derived focus effects 

| Spells:UseAdditiveFocusFromWornSlot 
| false 
| Allows an additive focus effect to be calculated from worn slot. Does not apply limits checks. Can only have one additive focus rule be true. 

| Spells:UseAdditiveFocusFromWornSlotWithLimits 
| false 
| Allows an additive focus effect to be calculated from worn slot. Applies normal limit checks. Can only have one additive focus rule be true. 

| Spells:AlwaysSendTargetsBuffs 
| false 
| Ignore Leadership Alternate Abilities level if true 

| Spells:FlatItemExtraSpellAmt 
| false 
| Allow SpellDmg stat to affect all spells, regardless of cast time/cooldown/etc 

| Spells:IgnoreSpellDmgLvlRestriction 
| false 
| Ignore the 5 level spread on applying SpellDmg 

| Spells:ItemExtraSpellAmtCalcAsPercent 
| false 
| Apply the Item stats Spell Dmg and Heal Amount as Percentage-based modifiers instead of flat additions 

| Spells:BreakFeignDeathWhenCastOn 
| 2.0 
| Percentage that Feign Death will break when you resist a spell 

| Spells:BreakSneakWhenCastOn 
| 2.0 
| Percentage that Sneak will break when you resist a spell 

| Spells:EnableResistSoftCap 
| false 
| Enabled resist softcap and can be adjusted by rule, SpellResistSoftCap 

| Spells:SpellResistSoftCap 
| 255 
| Softcap for spell resists. 

| Spells:AllowItemTGB 
| false 
| Target group buff (/tgb) doesn't work with items on live, custom servers want it though 

| Spells:NPCInnateProcOverride 
| true 
| NPC innate procs override the target type to single target 

| Spells:OldRainTargets 
| false 
| Use old incorrectly implemented maximum targets for rains 

| Spells:CallOfTheHeroAggroClearDist 
| 250.0 
| Distance at which CoTH will wipe aggro. To disable and always enable aggro wipe on any distance of CoTH, set to 0. 

| Spells:NPCSpellPush 
| false 
| Enable spell push on NPCs 

| Spells:July242002PetResists 
| true 
| Enable Pets using PCs resist change from July 24 2002 

| Spells:CazicTouchTargetsPetOwner 
| true 
| If True, causes Cazic Touch to swap targets from pet to pet owner if a pet is tanking. 

| Spells:PreventFactionWarOnCharmBreak 
| false 
| Enable spell interupts and dot removal on charm break to prevent faction wars. 

| Spells:AllowDoubleInvis 
| true 
| Allows you to cast invisibility spells on a player that is already invisible, live like behavior. 

| Spells:AllowSpellMemorizeFromItem 
| false 
| Allows players to memorize spells by right-clicking spell scrolls 

| Spells:InvisRequiresGroup 
| false 
| Invis requires the the target to be in group. 

| Spells:ClericInnateHealFocus 
| 5 
| Clerics on live get a 5 pct innate heal focus 

| Spells:DOTsScaleWithSpellDmg 
| false 
| Allow SpellDmg stat to affect DoT spells 

| Spells:HOTsScaleWithHealAmt 
| false 
| Allow HealAmt stat to affect HoT spells 

| Spells:CompoundLifetapHeals 
| true 
| True: Lifetap heals calculate damage bonuses and then heal bonuses. False: Lifetaps heal using the amount damaged to mob. 

| Spells:UseFadingMemoriesMaxLevel 
| false 
| Enables to limit field in spell data to set the max level that over which an NPC will ignore fading memories effect and not lose aggro. 

| Spells:FixBeaconHeading 
| false 
| Beacon spells use casters heading to fix live bug. False: Live like heading always 0. 

| Spells:UseSpellImpliedTargeting 
| false 
| Replicates EQ2-style targeting behavior for spells. Spells will 'pass through' inappropriate targets to target's target if it is appropriate. 

| Spells:BuffsFadeOnDeath 
| true 
| Disable to keep buffs from fading on death 

| Spells:IllusionsAlwaysPersist 
| false 
| Allows Illusions to persist beyond death and zoning always. 

| Spells:UseItemCastMessage 
| false 
| Enable to use the \"item begins to glow\" messages when casting from an item. 

| Spells:TargetsTargetRequiresCombatRange 
| true 
| Disable to remove combat range requirement from Target's Target Spell Target Type 

| Spells:NPCBuffLevelRestrictions 
| false 
| Impose BuffLevelRestrictions on NPCs if true 

| Spells:ResurrectionEffectBlock 
| 2 
| 0 = allow overwrites/rule disabled. If set to 1 = Block all buffs that would overwrite Resurrection Effects. If set to 2 = Will not overwrite Resurrection Effects, instead moves new buff to an empty slot if available. Default is 2. 

| Spells:WaterMatchRequiredForLoS 
| true 
| Enable/Disable the requirement of both the attacker/victim being both in or out of water for spells LoS to pass. 

| Spells:WizardCritMinimumRandomRatio 
| 20 
| The minimum value for the random range which Wizards and Caster DPS Mercs innately have for spell crit ratio. Set to 20 for vanilla values. 

| Spells:WizardCritMaximumRandomRatio 
| 70 
| The maximum value for the random range which Wizards and Caster DPS Mercs innately have for spell crit ratio. Set to 70 for vanilla values. 

| Spells:DefensiveProcPenaltyLevelGap 
| 6 
| Defensive Proc Penalty Level Gap where procs start losing their proc rate at RuleR(Spells, DefensiveProcPenaltyModifier)% per level difference 

| Spells:DefensiveProcPenaltyLevelGapModifier 
| 10.0f 
| Defensive Proc Penalty Level Gap Modifier where procs start losing their proc rate at defined % after RuleI(Spells, DefensiveProcLevelGap) level difference 

| Spells:DOTBonusDamageSplitOverDuration 
| true 
| Disable to have Damage Over Time total bonus damage added to each tick instead of divided across duration 

| Spells:HOTBonusHealingSplitOverDuration 
| true 
| Disable to have Heal Over Time total bonus healing added to each tick instead of divided across duration 

| Spells:UseLegacyFizzleCode 
| false 
| Enable will turn on the legacy fizzle code which is far stricter and more accurate to 2001/2002 testing. 

| Spells:LegacyManaburn 
| false 
| Enable to have the legacy manaburn system from 2003 and earlier. 

| Spells:LegacyManaburnCap 
| 9492 
| Adjusted the hard cap (Normal or Crit) for the Legacy Manaburn system. DEFAULT: 9492 

| Spells:EvacClearAggroInSameZone 
| false 
| Enable to clear aggro on clients when evacing in same zone. 

| Spells:CharmAggroOverLevel 
| false 
| Enabling this rule will cause Charm casts over level to show resisted and cause aggro. Early EQ style. 

| Spells:RequireMnemonicRetention 
| true 
| Enabling will require spell slots 9-12 to have the appropriate Mnemonic Retention AA learned. 

| Spells:EvacClearCharmPet 
| false 
| Enable to have evac in zone clear charm from charm pets and detach buffs. 

| Spells:ManaTapsRequireNPCMana 
| false 
| Enabling will require target to have mana to tap. Default off as many npc's are caster class with 0 mana and need fixed. 

| Spells:HarmTouchCritRatio 
| 200 
| Harmtouch crit bonus, on top of BaseCritRatio 

| Spells:UseClassicHarmTouchDamage 
| false 
| Use pre 2007 Harm Touch calculations - Default: False 

| Spells:UseClassicSpellFocus 
| false 
| Enabling will tell the server to handle random focus damage as classic spell imports lack the limit values. 

| Spells:ManaTapsOnAnyClass 
| false 
| Enabling this will allow you to cast mana taps on any class, this will bypass ManaTapsRequireNPCMana rule. 

| Spells:HealAmountMessageFilterThreshold 
| 100 
| Lifetaps below this threshold will not have a message sent to the client (Heal will still process) 0 to Disable. 

| Spells:SnareOverridesSpeedBonuses 
| false 
| Enabling will allow snares to override any speed bonuses the entity may have. Default: False 

| Spells:TargetedAOEMaxTargets 
| 4 
| Max number of targets a Targeted AOE spell can cast on. Set to 0 for no limit. 

| Spells:PointBlankAOEMaxTargets 
| 0 
| Max number of targets a Point-Blank AOE spell can cast on. Set to 0 for no limit. 

| Spells:DefaultAOEMaxTargets 
| 0 
| Max number of targets that an AOE spell which does not meet other descriptions can cast on. Set to 0 for no limit. 

| Spells:AllowFocusOnSkillDamageSpells 
| false 
| Allow focus effects 185, 459, and 482 to enhance SkillAttack spell effect 193 

## TaskSystem Rules¶

| 

Rule Name 
| Default Value 
| Description 

| TaskSystem:EnableTaskSystem 
| true 
| Globally enable or disable the Task system 

| TaskSystem:PeriodicCheckTimer 
| 5 
| Seconds between checks for failed tasks. Also used by the 'Touch' activity 

| TaskSystem:RecordCompletedTasks 
| true 
| Record completed tasks 

| TaskSystem:RecordCompletedOptionalActivities 
| false 
| Record completed optional activities 

| TaskSystem:KeepOneRecordPerCompletedTask 
| true 
| Keep only one record per completed task 

| TaskSystem:EnableTaskProximity 
| true 
| Enable task proximity system 

| TaskSystem:RequestCooldownTimerSeconds 
| 15 
| Seconds between allowing characters to request tasks (live-like default: 15 seconds) 

| TaskSystem:ExpRewardsIgnoreLevelBasedEXPMods 
| false 
| Rewarding Level Based Exp will ignore Rule LevelBasedEXPMods if true 

| TaskSystem:SharedTasksWorldProcessRate 
| 6000 
| Timer interval (milliseconds) that shared tasks are processed in world 

| TaskSystem:SharedTasksTerminateTimerMS 
| 120000 
| Delay (milliseconds) until a shared task is terminated if requirements are no longer met after member removal (default: 2 minutes) 

| TaskSystem:UpdateOneElementPerTask 
| true 
| If true (live-like) task updates only increment the first matching activity. If false all matching elements will be incremented. 

| TaskSystem:MaxUpdateMessages 
| 50 
| Maximum update messages for non-GiveCash activity types in IncrementDoneCount 

## Watermap Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Watermap:CheckForWaterOnSendTo 
| false 
| Checks if a mob has moved into/out of water on SendTo 

| Watermap:CheckForWaterWhenFishing 
| false 
| Only lets a player fish near water (if a water map exists for the zone) 

| Watermap:FishingRodLength 
| 30 
| How far in front of player water must be for fishing to work 

| Watermap:FishingLineLength 
| 100 
| If water is more than this far below the player, it is considered too far to fish 

| Watermap:FishingLineStepSize 
| 1 
| Basic step size for fishing calc, too small and it will eat cpu, too large and it will miss potential water 

## World Rules¶

| 

Rule Name 
| Default Value 
| Description 

| World:ZoneAutobootTimeoutMS 
| 60000 
| Time out for automatic booting of zones in milliseconds 

| World:UseBannedIPsTable 
| false 
| Toggle whether or not to check incoming client connections against the banned_ips table. Set this value to false to disable this feature 

| World:EnableTutorialButton 
| true 
| Setting whether the Tutorial button should be active. At least in RoF2 you can always press the button, but it loses its effect 

| World:EnableReturnHomeButton 
| true 
| Setting whether the Return Home button should be active 

| World:MaxLevelForTutorial 
| 10 
| The highest level with which you can enter the tutorial 

| World:TutorialZoneID 
| 189 
| Zone ID of the tutorial 

| World:MinOfflineTimeToReturnHome 
| 21600 
| Minimum offline time to activate the Return Home button. 21600 seconds is 6 Hours 

| World:MaxClientsPerIP 
| -1 
| Maximum number of clients allowed to connect per IP address if account status is < AddMaxClientsStatus. Default value: -1 (feature disabled) 

| World:ExemptMaxClientsStatus 
| -1 
| Exempt accounts from the MaxClientsPerIP and AddMaxClientsStatus rules, if their status is >= this value. Default value: -1 (feature disabled) 

| World:AddMaxClientsPerIP 
| -1 
| Maximum number of clients allowed to connect per IP address if account status is < ExemptMaxClientsStatus. Default value: -1 (feature disabled) 

| World:AddMaxClientsStatus 
| -1 
| Accounts with status >= this rule will be allowed to use the amount of accounts defined in the AddMaxClientsPerIP. Default value: -1 (feature disabled) 

| World:MaxClientsSetByStatus 
| false 
| If true, IP Limiting will be set to the status on the account as long as the status is > MaxClientsPerIP 

| World:EnableIPExemptions 
| false 
| If true, ip_exemptions table is used, if there is no entry for the IP it will default to RuleI(World, MaxClientsPerIP) 

| World:ClearTempMerchantlist 
| true 
| Clears temp merchant items when world boots 

| World:GMAccountIPList 
| false 
| Check IP list against GM accounts. This increases the security of GM accounts, e.g. if you only allow localhost '127.0.0.1' for GM accounts. Think carefully about what you enter! 

| World:MinGMAntiHackStatus 
| 1 
| Minimum status to check against AntiHack list 

| World:SoFStartZoneID 
| -1 
| Sets the Starting Zone for SoF Clients separate from Titanium Clients (-1 is disabled) 

| World:TitaniumStartZoneID 
| -1 
| Sets the Starting Zone for Titanium Clients (-1 is disabled). Replaces the old method 

| World:ExpansionSettings 
| 16383 
| Sets the expansion settings bitmask for the server, This is sent on login to world and affects client expansion settings. Defaults to all expansions enabled up to TSS, value is bitmask 

| World:CharacterSelectExpansionSettings 
| -1 
| Sets the expansion settings bitmask for character select if you wish to override. -1 is off 

| World:UseClientBasedExpansionSettings 
| true 
| If true it will overrule World, ExpansionSettings and set someone's expansion based on the client they're using 

| World:PVPSettings 
| 0 
| Sets the PVP settings for the server. 1=Rallos Zek RuleSet, 2=Tallon/Vallon Zek Ruleset, 4=Sullon Zek Ruleset, 6=Discord Ruleset, anything above 6 is the Discord Ruleset without the no-drop restrictions removed. NOTE: edit IsAttackAllowed in Zone-table to accomodate for these rules 

| World:PVPMinLevel 
| 0 
| Minimum level to pvp 

| World:StartZoneSameAsBindOnCreation 
| true 
| Should the start zone always be the same location as your bind? 

| World:EnforceCharacterLimitAtLogin 
| false 
| Enforce the limit for characters that are online at login 

| World:EnableDevTools 
| true 
| Enable or Disable the Developer Tools globally (Most of the time you want this enabled) 

| World:EnableChecksumVerification 
| false 
| Enable or Disable the Checksum Verification for eqgame.exe and spells_us.txt 

| World:MaximumQuestErrors 
| 30 
| Changes the maximum number of quest errors that can be displayed in #questerrors, default is 30 

| World:BootHour 
| 0 
| Sets the in-game hour world will set when it first boots. 0-24 are valid options, where 0 disables this rule 

| World:UseItemLinksForKeyRing 
| false 
| Uses item links for Key Ring Listing instead of item name 

| World:UseOldShadowKnightClassExport 
| true 
| Disable to have Shadowknight show as Shadow Knight (live-like) 

| World:EnableAutoLogin 
| false 
| Enables or disables auto login of characters, allowing people to log characters in directly from loginserver to ingame 

| World:EnablePVPRegions 
| true 
| Enables or disables PVP Regions automatically setting your PVP flag 

| World:CustomFilesAdminLevel 
| 20 
| Admin level at which custom file key is not required when CustomFilesKey is specified 

## Zone Rules¶

| 

Rule Name 
| Default Value 
| Description 

| Zone:ClientLinkdeadMS 
| 90000 
| The time a client remains link dead on the server after a sudden disconnection (milliseconds) 

| Zone:GraveyardTimeMS 
| 1200000 
| Time until a player corpse is moved to a zone's graveyard, if one is specified for the zone (milliseconds) 

| Zone:EnableShadowrest 
| 1 
| Enables or disables the Shadowrest zone feature for player corpses. Default is turned on 

| Zone:AutoShutdownDelay 
| 60000 
| How long a dynamic zone stays loaded while empty (milliseconds) 

| Zone:PEQZoneReuseTime 
| 900 
| Seconds between two uses of the #peqzone command (Set to 0 to disable) 

| Zone:PEQZoneDebuff1 
| 4454 
| First debuff casted by #peqzone Default is Cursed Keeper's Blight 

| Zone:PEQZoneDebuff2 
| 2209 
| Second debuff casted by #peqzone Default is Tendrils of Apathy 

| Zone:UsePEQZoneDebuffs 
| true 
| Setting if the command #peqzone applies the defined debuffs 

| Zone:PEQZoneHPRatio 
| 75 
| Required HP Ratio to use #peqzone 

| Zone:HotZoneBonus 
| 0.75 
| Value which is added to the experience multiplier. This also applies to AA experience. 

| Zone:EbonCrystalItemID 
| 40902 
| Item ID for Ebon Crystal 

| Zone:RadiantCrystalItemID 
| 40903 
| Item ID for Radiant Crystal 

| Zone:LevelBasedEXPMods 
| false 
| Allows you to use the level_exp_mods table in consideration to your players experience hits 

| Zone:WeatherTimer 
| 600 
| Weather timer when no duration is available 

| Zone:EnableLoggedOffReplenishments 
| true 
| 'Replenish mana/hp/end if logged off for MinOfflineTimeToReplenishments 

| Zone:MinOfflineTimeToReplenishments 
| 21600 
| Minimum time a player must be offline before LoggedOffReplenishments becomes active (seconds) 

| Zone:UseZoneController 
| true 
| Enables the ability to use persistent quest based zone controllers (zone_controller.pl/lua) 

| Zone:EnableZoneControllerGlobals 
| false 
| Enables the ability to use quest globals with the zone controller NPC 

| Zone:GlobalLootMultiplier 
| 1 
| Sets Global Loot drop multiplier for database based drops, useful for double, triple loot etc 

| Zone:KillProcessOnDynamicShutdown 
| true 
| When process has booted a zone and has hit its zone shut down timer, it will hard kill the process to free memory back to the OS 

| Zone:SpawnEventMin 
| 3 
| When strict is set in spawn_events, specifies the max EQ minutes into the trigger hour a spawn_event will fire. Going below 3 may cause the spawn_event to not fire. 

| Zone:ForageChance 
| 25 
| Chance of foraging from zone table vs global table 

| Zone:FishingChance 
| 399 
| Chance of fishing from zone table vs global table 

| Zone:AllowCrossZoneSpellsOnBots 
| false 
| Set to true to allow cross zone spells (cast/remove) to affect bots 

| Zone:AllowCrossZoneSpellsOnMercs 
| false 
| Set to true to allow cross zone spells (cast/remove) to affect mercenaries 

| Zone:AllowCrossZoneSpellsOnPets 
| false 
| Set to true to allow cross zone spells (cast/remove) to affect pets

---

## Server Variables

*Source: server/operation/server-variables/index.html*

# Server Variables¶

### Editing Rules¶

To edit variables, some are tied to admin #commands that will refresh the variable cache (noted on description below), otherwise you must restart world and zone to have them take full effect.

 | 
 
 Type 
 | Name 
 | Example Value 
 | Description 

 | String 
 | hotfix_name 
 | 
 | This is used as a temporary cache for #hotfix. It is recommended to not
 touch this unless advised by a developer. 

 | Integer 
 | loglevel 
 | 7 
 | Related to Commands, Merchants, Trades, Loot. Used for setting verbosity
 of log level for above events. Special rule for >9, not recommended
 to use unless advised by a developer. 

 | String 
 | MOTD 
 | 
 | Message of the Day to display on login. Use #motd to set this while in
 game. 

 | Boolean 
 | new_faction_conversion 
 | true 
 | Script ran against quests folder to convert new faction values 

 | Integer 
 | DisableNoRent 
 | 0 
 | when set to 1, shared memory will ignore no rent flag when loading items 

 | Integer 
 | DisableNoDrop 
 | 0 
 | when set to 1, shared memory will ignore no drop flag when loading items 

 | Integer 
 | DisableLore 
 | 0 
 | when set to 1, shared memory will ignore lore flag when loading items 

 | Integer 
 | DisableNoTransfer 
 | 0 
 | when set to 1, shared memory will ignore no transfer flag when loading
 items 

 | String 
 | GuildCreation 
 | 
 | Creates a 30 minute founder guild creation system. Appears a delimited
 list of numbers needed. This is unsupported. 

 | Integer 
 | HonorLSWorldAdmin 
 | 0 
 | when set to 1, CheckAuth() will honor login server world admin. This is
 unlikely to be used in majority of cases. 

 | Integer 
 | PvPItem 
 | 0 
 | 
 
if variable ServerType is set to 1, and variable PVPReward is set to 3,
 and this value is >0 and < 200000, then..
 
if PvPItem is set to 1, one item can be looted (unconfirmed)

if PVPItem is set > 1, value is an itemid that will be created on corpse.

 | Integer 
 | PVPReward 
 | 0 
 | 
 
If set to 1, then one item can be looted (unconfirmed)

If set to 2, player can loot all items from corpse.

If set to 3, PVPItem logic is in effect

 | String 
 | Rules 
 | 
 | If rules exists as a record, the value is sent to player as white text,
 freezing player until they accept rules. #serverrules and #acceptrules
 need to be set to a level allowed by a player to enforce this system 

 | String 
 | RuleSet 
 | 
 | Sets active ruleset. By default not needed 

 | Integer 
 | ServerType 
 | 0 
 | Legacy system. If you set to 1, can enable PVP system

---

## Untitled

*Source: server/operation.html*

�      ��}kw�F��w�
������_$��,;ޕl�r��ə���$,܌�d&o��Vw$ mw�h�31E�@�Awݺ�j���gD�j�ȱ��=c4����u�a�0}2>8~�O�=����&'�Ж�h�}p��? �.>ft�+'dF�D�+�@��\�{���8�7�7u�aT�h���?��?�AB1L(�M���W,���aB��=� f��)�d64�ߝ���4.;J��ث�dIɻ_X���B�
of�g�vC!��u�kz���m��-���1g�������Z��A�b�S��z�ӆ���M��ޟN[l��hA'R�ï���v��tG���K�l3jۖZa�|.���������7s�Z�%= K��(e�`51�RV�w_�6��t*��%�&BV3����#\��",o^%����A��uu��#��m����E@�2ʝ���Z���>�q!�z=y��~�-�-�W�?A�����(��Q$�.���A�u�:�KzЫ���=�}O��փQ����]}� �Q�$m֥;��&�ҽ��ёv���$��� Ůj��n��G>������g@�ۃf�t�����?á&�9|��G��7���O���I�c7a��>�2�q~&FCb�ӐF[w�S�� �29Uڛ�x�> 6b����N�}�g��?�s\.�+�Y~
�@G�'����?7���� Y�61X���x6w��A�\�`��|��G{��ࡕ���Qq�:O�l�M�v�47� m-t�`�Dlef�ڸ����rfX7���.��u��F�� �r�9䘮]�kW��Z��Pa�_�U+� j$�H�%3pl�I����o��J��,SX�u�f�L�D���j��흄�"D7HDg�$�A89�N���q����� ��:1p�N@�m�C;1s8�XE$�ш�@�����>0��b����qy_����o �tE+��@
Y��e���o4j{��c8�i�s2/�hk����d�2{�`O�)�ö�J��$�v��>��ق0�t�2�[� �>�A;g�SI+�З-wI�R�P���u�6�\�K%���,��~,�I�Y�͏!�"�]jѺG�$J�A��|i���K��~qI�$� A��J�u�K0��7ӧo�!�ƶ�:)�RGN\;g�ձ�W�Lb�6u���r��~��k� ��У��Rg(�9��,���RTV����sٳk��Rq�N?�_A��t�u���%��_����0[.�������✴wYN��`u��z���
�p���'��[!˔0�+~*�e&�ٲA�X� ivd �Œ�������| ��9tU��'l^P��B�m���7rV����v��R��ڔ>4o�`P��@J6�c��}�!^yg�[���lu:R��Ng��N��cU�˳_�3殄[���5�:��#{�ݘ�����7����=�4���)�`�uv�k~����Q����+�f��L-;��KÒ�&�Z�,��XK\�"�y�?�TV����U��4ih�xe)\��(�/9�13|vrx��j��E����ȑ���b~$�&[���뻝��z\��Pbx`X ��n.���lT�esC���P�"�%�TyGh:�������}��7��3�> uTP2�)��ʊ1C�3��P*�9e �ۑ��SB\C��F]� ���ϒh�؈����+��B!�$eA�(��l'J�7>!� �A�K����i\'Sx$�H�7����!�#�ưrܻQ�;V�!3vn��AJ����XI@3�������| ��/lg�cۙ�`������8Hz۽�1��d�=�)?��^����Ȗ��ce��~T����GF��\}�C���i�P�4u��VON�7*JxU����)�ʩ�%b��w�%IU��N��,���;FX�� �����[�������0h��k^|悸dƳ�|o��a�Ǻ�&ɪ]m�N[�QR�9J�S�8I���9>XH��Y�[�!+^�⣜�M�2��v��`]~Ljuw���D�����#�=ێ���������-A��ٮد༳=k.��n�ۀ����$eNi�D9-��Ϙݤ }�u?L��&���D+PuE���� �460Ym\#�s�h+������� �-m�j�3��"�*���� B��n��)�qđ:,������u/HH���Ei�B�O��t�H���8Sy|y��#ʡw y�1�[0X�80��W�[J2���x&��C�{B_����P��TBU%C�]���n�8B蝗��������V���~�J��A\�J�C�i# 8C��^����[��LU�d�������r�iW���Hq $� ��3M�g��d�&�"q���9�j��ɣW�0�a&=��I�L�l�آ ��rVhx0G����_M���lo�m_R��㚅d;G��~t�W\�S�����v]�⯝�X�6�9� �v$��+t�R�ԍ�&��.cN�V�坫�r�
^ T>�C,�.m�!�e�9@��wN\}����H�Ž�$f�Cx� ��/��J�nK�"ݨ0Sn'QD�k�H_ �ډ��fW�b�Z��9���r�j���Z�?�p�Gr��u�KP���|/mD���0���rbG�%�.g�]&b��r�u3���d�r"ˡX��m�/Y����)��p "�O��(��0{�h�fL��,�4��Xe��X(ꩮ�\}ƒ�B��\FY�N��98�����°R��Iv�����'���v���0L�|q��� d�d��u��"3����Lyh� �̍��7� 8�LD̐ԩh"�v5���|�Ċ"���Rڋ�E-�BY߱�J��9���oI��N-���-�&�����Q���cޓĮ+6� �{�xqJ{/xi'�&��X�����o|�BR���ͥ�(�1��)2�1[!_;�t)n�*��K�0�:fFO>\����+�O|�U�='3�dWҧ�n��;M���ȭ$ca�ʌ�>ZA�aU$@��ն%�n�����RxX)�²��{.��t��C�@�I`���o_~|����+tڍ�'��!Ƽߡ�y�rr��j���B�*�D�ɇ�c�(��x�|�(g�A��>�m�z)�͡�7{E�k��a�7{�k������1�H0��FdqA�� ���l���f�HU�,ێyF�'g1�!��7 �DK�^rR:^�f����eM��מ�$���eA��?��Ρĉ��i���x�M�K��RS;�S;���v�� R����!O�>�������C�I�IT�G����ĈTU�G
�H��݀p (UV�Ʋ��L��1R�-+��,7���@p���0԰|�����@u���1|Z7Vd�B_cR��o��f6�.�"��"w�un5�1*p�~=������B`��@�&Z@�&@�L$��*���"���̦N��cV��zYd(+���k�������z�F]��όHx��[�MM������1m_§6�Q�'Ch�ڋ#d ���#���rV����dJŁ����  ���+A
�q�l6qg1��]� d��pfn���Į@:v� X��EM ��C�d�7&jY>��Χ�X�y��o� ]�O]���Ø��)��r�2b�E� �}�%|j���� �1���z�^[�*T0� X��F��(f��)X{�6r� l�5����qP�i`Q��nBWeh��"�\�e��*CcOy�#��]��q�%?PÈ�JR*��1�i���螲2*�\\�=@���M@�X�8�6 �a���lE�r�@���Ӗ�h�%�Tz3o�>e�hMHH�R;���S,Y���8��HdՆ��V��J�.I?zM[+�ڑ�Y;E��5�K�_��a�\M���Ь��u#�%�TY��E;�̥��H��rJ$ӧD�xf{���Qt��V��+Sut��T��)��a��L�ѕ�3r� Rie��|JW[��]�Jaqؓ){E��p��2�{��A��X�I�a.A���Q4Dg����h,����,u���R��JGlbR'�����-��\%w)���2Us�H\�j>[�ST1�1s_�b�r .UV˫�a�l9I��OVM�l�o��j�弭���TX�"q�
�KR���`h��\m��p (UVUӤɤ�89 ϰ�rv��RN��EG�3Q��74X6�!>n��o�葿�|������Z�>X(������8�
c�>T7Ď�b���s�j�fe�Y�"q7�&��6;��g���5�p���ݬ"�%�T��J�Ђ�F܂�I푥���*���L98*�/_�.H`*paH\I��X�,g�V��J��K�;)���YƳsX$�!��5�+�ܪy�(��9�-7�\�L�e!k��$G��H�H�Ptb��bRfA��Q�8������;G�壯�`�D�ǖ�"aR���3VuBW���vb.n9��,�#2� 
����8!��5�X�SM��-%���oV���mpy�п�T�ݣ"q��?s&�cd�����!.A��aވ�7��Y�J*�u��݀
����HՎ��z2ӄ��E������S55Z#IxOr���%�TY�Al3dc�x�⊴r:l MRt������6�P�� 6'��Y�t�ָ(���t*AZuh�t:�F� Qʢ.P���ͬԇ� S*�H����y`�w#����K��Rq�>F�;�|K �t��� �#]�m��v2��2Of��~�HC�E��j�c���wd˼H�mM�0�#_�m��v;��2+���E�2��]B��(Mӗ\�&o "�����s&���x��x��~����Me͵N��&���w��������U�Q=����ʑF(�HC/%'�2���c�۞����{{K��N:�1�g�+�"�Pz�!������ �/�[i�*c�[�T�q����b��Խ[mN��*��T���� �o�\w�A�[� ?m����F|�=bblr鹠��ߺ�n��q�\��Dע[ -ߵ����3�t,����d"ExK��[�V�&��}�/�T��В�� �u�ұyͨ�˜D��`�/t~�g����X.��z�I)+\�:V�E�T�7��zʡ�!� �4(�D>&�DiH�'������#4],�~9�L8\���(�v��+�F�T��S���m�@H" ��ĕ��?q/Ue�옠(��(��6�5�؍�G�,%�:N(j�C���g�(y���:�����98�kx������B8����w��ݱV�H��tNńN)�N=�iT�!$u���i�L*�3�v$A�ŀI�ƛ(�� �$�����C������5(��r��_�&X�5 �ߍ��)���}�7416_%P1� 5�m�0G+�4\��+�d�� �g_d�C������d#���C�*�)l �s`u!X� �)����A{%��&�F��x�i� �����9���r���G@���%��H����� .���Mʟ'�k ��df]��tH\� ̈́\$�k ��h���]���F��=P�@ᵅ6��H�"k]ѕ��¢@��Ƴ�����H ��&�l��[)^�ǉ�Q�P&a8T�s0�����X�r��ޗ\\��i�#9�#��6Rۻ?�}���u5��,b yQ��%xTrQ��>}+�L����nO��aD����0�b`�U�&�1ic`�V��&�#�19���PmLF����d���PmL��Ƥ��I_mL0�؎�vlÎ��m�v0�؎�vlÎ��mǶ1�ض�vlÎm�mǶ1�ض�vlÎm�mǶ1�ض�vlÎm�mǶ1�ض�v����(�&1[�+��2��v>���!W���2��\\�������a�������k�ָ���%�]��������ܩ�upK������C��-��g�8%�d�o�q�H����X{�/�=�(���$�-r|/1սCL�/�=�]������� ��h&�d�I��$
�^��|A�Χ��/�\EA�C��V�-A����hM� ��{�/]ub��~,? p��ʐL-�© ��a��+ �TB^e�X��20J�$��g�R!h�T��uXb�dd��+'����:ٟ}��g�@Z�����y��%֓����G�?%�P,�[��"��)Z�`$Mz���������H�4���I����x���8��%/zwj�>�>��وs 4U�q�g���9�[��'���A"�s��~�R�,��W,����7���p2y����Y�0�����_�9A��2��ꫮ�:�I��j��C�����e�߄X��Na���菠q����1�0�����h�dM�O��,�V�����)��}v#��% $�8�����V¦q�7��e�4����ٱ] 0�"�i�u{{ۼ�5�`�j��[pECc���������`��$�k`�\tzZ�=׻����9����i����������5����5�[O;���b&�͌=K���2<*��5,��˯��Ϧ��Nq"�i�"~����_~mFV�ke��+X�y�r/�b<��{y1���n0!B`��:��0�0������d�g������s@'/����&���p��6a�3�rAn�x����I2�B�Y��n�%�:���ru#�'�w��ֱB�Y��2��{ݜ�5�iy-�F^��%;��X�%����&�9 ��r=��-��.��)�]\��e,��� �?m��YK�����-�y���*���#�_7i�,���{��Dv%^���5K]C�� �Du��!s�j^9��x���m?���F�S�J#��z�i@��ɺ'�"wrI-�SMn]fN����C�4X�LR�H��Y�n�Z��
�@�� 3�[(���oRa�CJ���4{�f0@�Y�����Q��Hn� ;l�z�5�Vr��G�w�m:����Y0�{�1<��R@��_�[e��d�Z F���v�_9��KɅ��˒G�w�Q��ڄ��.�h�Hc�bC�'3ZvC4�1���mnq�o=�a�t�2�To�뗯��x�k3�i�Z��=�7}�����:V�&"w�Y�_�Ƌ�+���<M�!�4��0�����p��W�������4��j��M�t�!ms�I;��9�Rn9�`,D|�߶2)5�m��.�1�c�h��SA��B�vNkB ��Z7��:������;:2�d0!�i�kt��Ψ3�G��6�� �A��ܠ�������/�G�ч7m������х�=r]r��Ҿ������4������_?�itx�!W�C���{i�^}�W���o��s���q"���.�����R�����i�O�����ܰ�3��p0��^�ݝ�w4���I�S�:U�IC{����{�_fǱ������w �0�� �O�� �fu�9����y���}�]_���/����I#�;��ndJ��w������*���r�xq���������?Z.�m�� 

---

## Parcels

*Source: server/parcels/index.html*

# Parcels¶

The parcel feature is only available on the Rain of Fear 2 (RoF2) Client.

The system is activated using the following server rules:

| 

Category 
| Rule Name 
| Default 
| Description 

| Parcel 
| DeleteOnDuplicate 
| false 
| Delete retrieved item if it creates a lore conflict. 

| Parcel 
| EnableDirectToInventoryDelivery 
| false 
| Enable or Disable RoF2 bazaar purchases to be delivered directly to the buyer's inventory. 

| Parcel 
| EnableParcelMerchants 
| true 
| Enable or Disable Parcel Merchants. Requires RoF+ Clients. 

| Parcel 
| EnablePruning 
| false 
| Enable the automatic pruning of sent parcels. Uses rule ParcelPruneDelay for prune delay. 

| Parcel 
| ParcelDeliveryDelay 
| 30000 
| Sets the time that a player must wait between sending parcels in ms. 

| Parcel 
| ParcelMaxItems 
| 50 
| The maximum number of parcels a player is allowed to have in their mailbox. 

| Parcel 
| ParcelPruneDelay 
| 30 
| The number of days after which a parcel is deleted. Items are lost! 

There are Several merchants across Norrath which can be enabled for parcel management. 

## Installation¶

Parcel functionality requires:

- SQL Updates. Please run the sql file located at (https://github.com/EQEmu/Server/tree/master/utils/sql/git/optional). The file is 2024_04_20_Parcel_Merchant_Updates.sql. This will update the is_parcel_merchant flag to '1' and also update their display name. 

**Please note: The sql update uses npc ids. If you have made changes or modified your npc ids, you may need to change/update. 

- Opcode updates. Depending on your installation, opcodes may require manual updating. They are found in \assets\patches\patch_RoF2.conf within your installation. The source opcodes are found at https://github.com/EQEmu/Server/tree/master/utils/patches 

## Defaults¶

There are several defaults as noted within the rules above.

- A player can only have 50 parcels at a time.

- A player can send a parcel once every 30 seconds

- There is a pruning system to automatically delete parcels after a specified period of days. This is disabled by default.

- A player will recieve a message when a parcel is delivered, and on login.

## Admin Commands¶

There are several admin commands to assist GMs.

- 

#parcel listdb [Character Name]

 This allows the GM to query the character_parcels table to determine what parcels are available for the player identified.

- 

#parcel listmemory [Character Name]

 Similar to above, though queries the in-memory version of the player's parcels. This is used for troubleshooting primarly. Further, this command will only function if the Character is in the same zone as the GM.

- 

#parcel add [Character Name] [item id] [quantity] [note]

 Allows the GM to send an item to the Character Name. The Character does not need to be online, or in the same zone.

 Furthermore, the GM can send No Trade items. In order to send money, please use an item id of 99990 and note that money is sent as an amount of copper.

 Quantity is valid for stackable items, charges on an item, or amount of copper.

- 

#parcels details [Character Name]

 Allows for further querying of parcels assigned to a specific character.

For Example:

- 

To send 12p5g3s1c to Player1

 #parcel add Player1 99990 12531 Here is your Money!

- 

To send a Fine Steel Jutte to Player3

 #parcel add Player3 6941 1 Enjoy your Jutte

# How it works¶

A player needs to find a merchant that notes 'Parcels and General Supplies'. Right clicking on such a merchant provides a new merchant window, with a Parcels Tab.

https://youtu.be/3KB6W33BhE8

## Player Event Logging¶

The following player events are available.

| 

Rule Name 
| Default 
| Retention 

| Parcel Send 
| Enabled 
| 7 days 

| Parcel Retrieve 
| Enabled 
| 7 days 

| Parcel Delete (Pruning System) 
| Enabled 
| 7 days 

## Known Issues¶

There are currently no known issues.

---

## Class List

*Source: server/player/class-list/index.html*

# Class List¶

This list contains all Class IDs, bitmasks, and their default spell list IDs.

## Player and NPC Classes¶

If a column is blank that means it is non-applicable to that class.

| 

Number 
| Bitmask 
| Name 
| Spell List ID 

| 1 
| 1 
| Warrior 
| 

| 2 
| 2 
| Cleric 
| 1 

| 3 
| 4 
| Paladin 
| 8 

| 4 
| 8 
| Ranger 
| 10 

| 5 
| 16 
| Shadow Knight 
| 9 

| 6 
| 32 
| Druid 
| 7 

| 7 
| 64 
| Monk 
| 

| 8 
| 128 
| Bard 
| 11 

| 9 
| 256 
| Rogue 
| 

| 10 
| 512 
| Shaman 
| 6 

| 11 
| 1024 
| Necromancer 
| 3 

| 12 
| 2048 
| Wizard 
| 2 

| 13 
| 4096 
| Magician 
| 4 

| 14 
| 8192 
| Enchanter 
| 5 

| 15 
| 16384 
| Beastlord 
| 12 

| 16 
| 32768 
| Berserker 
| 

## NPC-Only Classes¶

Only NPCs may use these classes.

| 

ID 
| Name 

| 20 
| Warrior Guildmaster 

| 21 
| Cleric Guildmaster 

| 22 
| Paladin Guildmaster 

| 23 
| Ranger Guildmaster 

| 24 
| Shadow Knight Guildmaster 

| 25 
| Druid Guildmaster 

| 26 
| Monk Guildmaster 

| 27 
| Bard Guildmaster 

| 28 
| Rogue Guildmaster 

| 29 
| Shaman Guildmaster 

| 30 
| Necromancer Guildmaster 

| 31 
| Wizard Guildmaster 

| 32 
| Magician Guildmaster 

| 33 
| Enchanter Guildmaster 

| 34 
| Beastlord Guildmaster 

| 35 
| Berserker Guildmaster 

| 40 
| Banker 

| 41 
| Merchant 

| 59 
| Discord Merchant (PVP Points) 

| 60 
| Adventure Recruiter 

| 61 
| Adventure Merchant 

| 63 
| Tribute Master 

| 64 
| Guild Tribute Master 

| 66 
| Guild Banker 

| 67 
| Norrath's Keeper Merchant (Radiant Crystals) 

| 68 
| Dark Reign Merchant (Ebon Crystals) 

| 69 
| Fellowship Master 

| 70 
| Alternate Currency Merchant 

| 71 
| Mercenary Liaison

---

## Client Version Bitmasks

*Source: server/player/client-version-bitmasks/index.html*

# Client Version Bitmasks¶

| 

**Token** 
| **Value (int)** 
| **Value (hex)** 

| bitUnknown 
| 0 
| 0x00000000 

| bitClient62* 
| 1 
| 0x00000001 

| bitTitanium 
| 2 
| 0x00000002 

| bitSoF 
| 4 
| 0x00000004 

| bitSoD 
| 8 
| 0x00000008 

| bitUF 
| 16 
| 0x00000010 

| bitRoF 
| 32 
| 0x00000020 

| bitRoF2 
| 64 
| 0x00000040 

| maskUnknown 
| 0 
| 0x00000000 

| maskTitaniumAndEarlier 
| 3 
| 0x00000003 

| maskSoFAndEarlier 
| 7 
| 0x00000007 

| maskSoDAndEarlier 
| 15 
| 0x0000000F 

| maskUFAndEarlier 
| 31 
| 0x0000001F 

| maskRoFAndEarlier 
| 63 
| 0x0000003F 

| maskSoFAndLater 
| 4294967292 
| 0xFFFFFFFC 

| maskSoDAndLater 
| 4294967288 
| 0xFFFFFFF8 

| maskUFAndLater 
| 4294967280 
| 0xFFFFFFF0 

| maskRoFAndLater 
| 4294967264 
| 0xFFFFFFE0 

| maskRoF2AndLater 
| 4294967232 
| 0xFFFFFFC0 

| maskAllClients 
| 4294967295 
| 0xFFFFFFFF 

`*` Client is no longer supported. Value is kept as a placeholder.

---

## Deity List

*Source: server/player/deity-list/index.html*

# Deity List¶

This list is used in quest API calls like the following:

`quest::changedeity(201); #:: Change the character's deity to Bertoxxulous.`

| 

**Deity** 
| **Deity ID** 
| **Deity Bitmask** 

| Agnostic 
| 140 or 396 
| 1 

| Bertoxxulous 
| 201 
| 2 

| Brell Serilis 
| 202 
| 4 

| Cazic Thule 
| 203 
| 8 

| Erollsi Marr 
| 204 
| 16 

| Bristlebane 
| 205 
| 32 

| Innoruuk 
| 206 
| 64 

| Karana 
| 207 
| 128 

| Mithaniel Marr 
| 208 
| 256 

| Prexus 
| 209 
| 512 

| Quellious 
| 210 
| 1024 

| Rallos Zek 
| 211 
| 2048 

| Rodcet Nife 
| 212 
| 4096 

| Solusek Ro 
| 213 
| 8192 

| The Tribunal 
| 214 
| 16384 

| Tunare 
| 215 
| 32768 

| Veeshan 
| 216 
| 65536 

This list is used in spells_new.

#### Spells ID List¶

| 

**ID** 
| **Deity** 

| 1 
| Bertoxxulos 

| 2 
| Brell Serilis 

| 3 
| Cazic Thule 

| 4 
| Erollisi Marr 

| 5 
| Bristlebane 

| 6 
| Innoruuk 

| 7 
| Karana 

| 8 
| Mithaniel Marr 

| 9 
| Prexus 

| 10 
| Quellious 

| 11 
| Rallos Zek 

| 12 
| Rodcet Nife 

| 13 
| Solusek Ro 

| 14 
| The Tribunal 

| 15 
| Tunare 

| 16 
| Veeshan

---

## Experience by Level

*Source: server/player/experience-by-level/index.html*

# Experience by Level¶

The multiplier is hard-coded into exp.cpp and set at 3.1 for levels 61+.

The formula for the below table is:

Experience = (level-1)^3 * (multiplier * 1000)

If you look to use `quest::exp(amount)` in any of your quests, this will come in handy

| 

Level 
| EXP by end of Level 
| Exp to level up 

| 1 
| 1,000 
| 1,000 

| 2 
| 8,000 
| 7,000 

| 3 
| 27,000 
| 19,000 

| 4 
| 64,000 
| 37,000 

| 5 
| 125,000 
| 61,000 

| 6 
| 216,000 
| 91,000 

| 7 
| 343,000 
| 127,000 

| 8 
| 512,000 
| 169,000 

| 9 
| 729,000 
| 217,000 

| 10 
| 1,000,000 
| 271,000 

| 11 
| 1,331,000 
| 331,000 

| 12 
| 1,728,000 
| 397,000 

| 13 
| 2,197,000 
| 469,000 

| 14 
| 2,744,000 
| 547,000 

| 15 
| 3,375,000 
| 631,000 

| 16 
| 4,096,000 
| 721,000 

| 17 
| 4,913,000 
| 817,000 

| 18 
| 5,832,000 
| 919,000 

| 19 
| 6,859,000 
| 1,027,000 

| 20 
| 8,000,000 
| 1,141,000 

| 21 
| 9,261,000 
| 1,261,000 

| 22 
| 10,648,000 
| 1,387,000 

| 23 
| 12,167,000 
| 1,519,000 

| 24 
| 13,824,000 
| 1,657,000 

| 25 
| 15,625,000 
| 1,801,000 

| 26 
| 17,576,000 
| 1,951,000 

| 27 
| 19,683,000 
| 2,107,000 

| 28 
| 21,952,000 
| 2,269,000 

| 29 
| 24,389,000 
| 2,437,000 

| 30 
| 29,700,000 
| 5,311,000 

| 31 
| 32,770,100 
| 3,070,100 

| 32 
| 36,044,800 
| 3,274,700 

| 33 
| 39,530,700 
| 3,485,900 

| 34 
| 43,234,400 
| 3,703,700 

| 35 
| 51,450,000 
| 8,215,600 

| 36 
| 55,987,200 
| 4,537,200 

| 37 
| 60,783,600 
| 4,796,400 

| 38 
| 65,846,400 
| 5,062,800 

| 39 
| 71,182,800 
| 5,336,400 

| 40 
| 83,200,000 
| 12,017,200 

| 41 
| 89,597,296 
| 6,397,296 

| 42 
| 96,314,400 
| 6,717,104 

| 43 
| 103,359,104 
| 7,044,704 

| 44 
| 110,739,200 
| 7,380,096 

| 45 
| 127,575,000 
| 16,835,800 

| 46 
| 136,270,400 
| 8,695,400 

| 47 
| 145,352,192 
| 9,081,792 

| 48 
| 154,828,800 
| 9,476,608 

| 49 
| 164,708,608 
| 9,879,808 

| 50 
| 175,000,000 
| 10,291,392 

| 51 
| 198,976,496 
| 23,976,496 

| 52 
| 224,972,800 
| 25,996,304 

| 53 
| 253,090,896 
| 28,118,096 

| 54 
| 299,181,600 
| 46,090,704 

| 55 
| 349,387,488 
| 50,205,888 

| 56 
| 403,916,800 
| 54,529,312 

| 57 
| 462,982,496 
| 59,065,696 

| 58 
| 526,802,400 
| 63,819,904 

| 59 
| 616,137,024 
| 89,334,624 

| 60 
| 669,600,000 
| 53,462,976 

| 61 
| 703,641,088 
| 34,041,088 

| 62 
| 738,816,768 
| 35,175,680 

| 63 
| 775,145,728 
| 36,328,960 

| 64 
| 812,646,400 
| 37,500,672 

| 65 
| 851,337,472 
| 38,691,072 

| 66 
| 891,237,632 
| 39,900,160 

| 67 
| 932,365,312 
| 41,127,680 

| 68 
| 974,739,200 
| 42,373,888 

| 69 
| 1,018,377,920 
| 43,638,720 

| 70 
| 1,063,299,968 
| 44,922,048 

| 71 
| 1,109,524,096 
| 46,224,128 

| 72 
| 1,157,068,800 
| 47,544,704 

| 73 
| 1,205,952,640 
| 48,883,840 

| 74 
| 1,256,194,432 
| 50,241,792 

| 75 
| 1,307,812,480 
| 51,618,048 

| 76 
| 1,360,825,600 
| 53,013,120 

| 77 
| 1,415,252,352 
| 54,426,752 

| 78 
| 1,471,111,168 
| 55,858,816 

| 79 
| 1,528,420,864 
| 57,309,696 

| 80 
| 1,587,200,000 
| 58,779,136 

| 81 
| 1,647,467,136 
| 60,267,136 

| 82 
| 1,709,240,832 
| 61,773,696 

| 83 
| 1,772,539,648 
| 63,298,816 

| 84 
| 1,837,382,400 
| 64,842,752 

| 85 
| 1,903,787,520 
| 66,405,120 

| 86 
| 1,971,773,568 
| 67,986,048 

| 87 
| 2,041,359,360 
| 69,585,792 

| 88 
| 2,112,563,200 
| 71,203,840 

| 89 
| 2,185,403,904 
| 72,840,704 

| 90 
| 2,259,899,904 
| 74,496,000 

| 91 
| 2,336,070,144 
| 76,170,240 

| 92 
| 2,413,932,800 
| 77,862,656 

| 93 
| 2,493,506,816 
| 79,574,016 

| 94 
| 2,574,810,368 
| 81,303,552 

| 95 
| 2,657,862,400 
| 83,052,032 

| 96 
| 2,742,681,600 
| 84,819,200 

| 97 
| 2,829,286,400 
| 86,604,800 

| 98 
| 2,917,695,232 
| 88,408,832 

| 99 
| 3,007,926,784 
| 90,231,552 

| 100 
| 3,100,000,000 
| 92,073,216

---

## Guild Ranks

*Source: server/player/guild-ranks/index.html*

# Guild Ranks¶

| 

Guild Rank Name 
| ROF2 
| Titanium 
| Underfoot 

| Leader 
| 1 
| 2 
| 2 

| Senior Officer 
| 2 
| 1 
| 1 

| Officer 
| 3 
| 1 
| 1 

| Senior Member 
| 4 
| 0 
| 0 

| Member 
| 5 
| 0 
| 0 

| Junior Member 
| 6 
| 0 
| 0 

| Initate 
| 7 
| 0 
| 0 

| Recruit 
| 8 
| 0 
| 0

---

## Languages

*Source: server/player/languages/index.html*

# Languages¶

A current list can be found in server/common/languages.h

| 

ID 
| Language 

| 0 
| Common Tongue 

| 1 
| Barbarian 

| 2 
| Erudian 

| 3 
| Elvish 

| 4 
| Dark Elvish 

| 5 
| Dwarvish 

| 6 
| Troll 

| 7 
| Ogre 

| 8 
| Gnomish 

| 9 
| Halfling 

| 10 
| Thieves Cant 

| 11 
| Old Erudian 

| 12 
| Elder Elvish 

| 13 
| Froglok 

| 14 
| Goblin 

| 15 
| Gnoll 

| 16 
| Combine Tongue 

| 17 
| Elder Teir'Dal 

| 18 
| Lizardman 

| 19 
| Orcish 

| 20 
| Faerie 

| 21 
| Dragon 

| 22 
| Elder Dragon 

| 23 
| Dark Speech 

| 24 
| Vah Shir 

| 25 
| Alaran 

| 26 
| Hadal 

| 27 
| Unknown

---

## Player Housing

*Source: server/player/player-housing/index.html*

# Player Housing¶

Player Housing was introduced in the House of Thule expansion. It can be accessed from the Guild Lobby and allows for players to purchase houses and place items in their houses. Houses do require upkeep to maintain.

There is a single zone for all neighborhood instances (Sunrise Hills). House zones are separate and appear to be spread across a variety of .zon files (e.g. phinterior1a1.zon) based on the type of home purchased.

The Place button in the Real Estate Items window is enabled on a zone-by-zone basis (probably). It is likely part of one of the zoning packets. For example, if you have the window open and click on a placeable item, the button remains disabled in the Guild Lobby. Repeat the process in a neighborhood or inside a residence and the button becomes enabled.

To my knowledge, no work has been done to add player housing to EQEMU. If it has, it hasn't been made public as no emu server has this capability as far as I am aware.

This page has packet information from Live as of 12/28/2018. While it is likely that the OpCodes have changed since House of Thule was released, my hope is that the structure of each packet has remained largely unchanged.

It looks like a single opcode (0x125C) is used for multiple packet types. At first I thought this was a code that caused a specific window to appear, but I've seen the same code used for the neighborhood search window (to select a specific neighborhood) and for the street search window inside a specific neighborhood. I have yet to see this code for other neighborhood or item placement actions.

Packet captures specific to trophy data is blocked at the moment. None of my characters on live have trophies, and I think that's why I'm not seeing a response from the server. There's nothing to send back. Unless I can find someone with at least one trophy (ideally a guild and a personal one), I'll have to spend some time questing to get one.

[TODO: Add image of neighborhood search window]

### Current Issues¶

The primary issue facing Player Housing is that the placement window is disabled. I don't know if there is a missing packet on client initialization, one that appears only when entering a zone that supports placing objects, a client status (Paid or not) level, or if the copy of RoF2 used by players on the Emu simply doesn't support it (perhaps a bug that impacted that version).

This leaves the options for implementing player housing as a script-based approach. It may be possible to enable some client windows once objects are placed, but in the worst case some kind of interface can be created. It is unlikely that would be added to the official emu source, so any old RoF2 captures that include Neighborhood zones would be helpful.

Hint. Hint.

### Known / Suspected OpCodes in RoF and RoF2 client¶

The RoF2 opcodes are suspect. It could be that they didn't change across several patches, or that the opcode dumps in showeq simply didn't update those. I could only find two that directly related to player housing in the opcode files, but I suspect there are more that didn't get logged.

| 

Client 
| Name 
| Description 

| RoF 
| OP_HouseAddress 
| 0x6786 

| 
| OP_HouseContents 
| 
0x7CDA (11/28/2012)
0x49B7 (03/13/2013)
0x6419 (04/17/2013)

| RoF2 
| OP_HouseAddress 
| 0x48AE (04/17/2013) - ShowEQ updated zoneopcodes.xml 04/22/2013,06/24/2013,07/18/2013,08/30/2013,10/09/2013 

| 
| OP_HouseContents 
| 0x6419 (04/17/2013) - ShowEQ update zoneopcodes.xml 04/22/2013,06/24/2013,07/18/2013,08/30/2013,10/09/2013 

| CotF 
| OP_HouseAddress 
| 
0x4F13 (11/06/13)
0x7B0D (01/22/2014)

| 
| OP_HouseContents 
| 
0x0588 (11/06/13)
0x41B3 (01/22/2014)

### Player Housing Zones¶

| 

Short Name 
| Long Name 
| Zone ID Number 

| neighborhood 
| Sunrise Hills 
| 712 

| phinterior3a1 
| House Interior 
| 714 

| phinterior1a1 
| House Interior 
| 715 

| phinterior3a2 
| House Interior 
| 716 

| phinterior3a3 
| House Interior 
| 717 

| phinterior1a2 
| House Interior 
| 718 

| phinterior1a3 
| House Interior 
| 719 

| phinterior1b1 
| Dragon House Interior 
| 720 

| phinterior1d1 
| Dragon House Interior 
| 723 

| guildhalllrg 
| Grand Guild Hall 
| 737 

| guildhallsml 
| Greater Guild Hall 
| 738 

| plhogrinteriors1a1 
| One Bedroom House Interior 
| 739 

| plhogrinteriors1a2 
| One Bedroom House Interior 
| 740 

| plhogrinteriors3a1 
| Three Bedroom House Interior 
| 741 

| plhogrinteriors3a2 
| Three Bedroom House Interior 
| 742 

| plhogrinteriors3b1 
| Three Bedroom House Interior 
| 743 

| plhogrinteriors3b2 
| Three Bedroom House Interior 
| 744 

| plhdkeinteriors1a1 
| One Bedroom House Interior 
| 745 

| plhdkeinteriors1a2 
| One Bedroom House Interior 
| 746 

| plhdkeinteriors1a3 
| One Bedroom House Interior 
| 747 

| plhdkeinteriors3a1 
| Three Bedroom House Interior 
| 748 

| plhdkeinteriors3a2 
| Three Bedroom House Interior 
| 749 

| plhdkeinteriors3a3 
| Three Bedroom House Interior 
| 750 

| guildhall3 
| Modest Guild Hall 
| 751 

| phinteriortree 
| Evantil's Abode 
| 766 

| plhbixieint (Post RoF2) 
| Bixie Hive 
| 774 

| plhpirateshipint (Post RoF2) 
| Pirate Ship 
| 786 

### Click on door to view Neighborhood List (Client -> Server)¶

| 

Name 
| Number of Bytes 
| Description 

| Network OpCode 
| 2 
| 0x09 

| Packet Sequence Number 
| 2 
| 

| Application OpCode 
| 2 
| 
OP_ClickDoor
- Live: 0x2254
- RoF2: 0x3A8F

| Door Id 
| 1 
| 77 for the neighborhood "door" gate in Guild Lobby 

| Unknown 
| 1 
| 0 

| Unknown 
| 1 
| 0 

| Unknown 
| 1 
| 0 

| picklockskill 
| 1 
| 0 

| Unknown5 
| 3 
| 0 

| Item Id 
| 4 
| 255,255,255,255 

| Player Id 
| 2 
| 

| Unknown 
| 2 
| 

### Neighborhood List (Server -> Client)¶

**20190126 - Verified OpCode and Packet structure in RoF**

| 

Name 
| Number of Bytes 
| Description 

| Network OpCode 
| 2 
| 0x0D 

| Packet Sequence Number 
| 2 
| Identifies order of fragments 

| Total length of combined fragments 
| 3 
| Total size of all fragments. This is only present in the first fragment. 

| Application OpCode 
| 2 
| 
RoF: 0x67C9
Live (20181217): 0x5C12
Live (20190118): 0x1659

| Unknown 
| 2 
| An id? Different across servers 

| Window ID 
| 7 
| 
Always 1,0,6,0,0,0,0
This value is used to branch code paths between the Neighborhood list and Property marker windows.

| Total # of Neighborhoods 
| 2 
| 

| Unknown 
| 5 
| Always 1,1,0,0,0 

| Neighborhood ID 
| 4 
| 

| Neighborhood Name Length 
| 4 
| 

| Neighborhood Name 
| Neighborhood Name Length 
| Not null terminated 

| Guild ID 
| 4 
| 0 if no guild is associated with this neighborhood, otherwise it is the Guild ID 

| Unknown 
| 4 
| Only seen on Live. If RoF, this field is not present in the packet: If Guild ID is 0, this is also 0. If Guild ID is not 0, this is always 147,0,0,0 

| Max Player Plots 
| 4 
| Always 71 

| Used Player Plots 
| 4 
| 

| Max Guild Plots 
| 4 
| Always 4 

| Used Guild Plots 
| 4 
| 

Once the first neighborhood is parsed, the format repeats for the next Neighborhood ID -> Used Guild Plots. This continues until the last neighborhood is parsed.

### Searching for neighborhoods (or clicking on a specific one) (Client -> Server)¶

| 

Name 
| Number of Bytes 
| Description 

| Network OpCode 
| 2 
| 0x09 

| Packet Sequence Number 
| 2 
| 

| Application OpCode 
| 2 
| 
RoF: 0x67C9
Live (20181217): 0x5C12
Live (20190118): 0x1659

| Search Type 
| 4 
| 
0 when searching for a player or guild.
2 when clicking to view details of a specific neighborhood.
4 when inside a neighborhood and searching specific addresses.

| Neighborhood ID 
| 4 
| 1 if searching for a player. The Neighborhood ID if clicking on a neighborhood entry. 

| Unknown 
| 4 
| 0s 

| Neighborhood Search Criteria 
| 80 
| A neighborhood's name. 79 bytes plus 1 for the null terminator. 

| Player Search Criteria 
| 64 
| A player's name. 63 bytes plus 1 for the null terminator. 

| Guild Search Criteria 
| 64 
| A guild's name. 63 bytes plus 1 for the null terminator. 

| Unknown 
| 2 
| Always 1,1 

| Unknown 
| 2 
| Always 132,0 (Seen in RoF, but not in Live) 

### Response to click to get neighborhood details (Server -> Client)¶

| 

Name 
| Number of Bytes 
| Description 

| Network OpCode 
| 2 
| 0x09 

| Packet Sequence Number 
| 2 
| 

| Application OpCode 
| 2 
| 
RoF: 0x67C9
Live (20181217): 0x5C12
Live (20190118): 0x1659

| Unknown 
| 4 
| 173,153,9,0 

| Unknown 
| 1 
| 10 

| Unknown 
| 4 
| 2,0,0,0 

| # of Players 
| 2 
| 

| Player Name Length 
| 4 
| 

| Player Name 
| Player Name Length 
| Not null terminated 

| # of Guilds 
| 2 
| 

| Guild ID 
| 4 
| If # of guilds = 0, this field is not in the packet. 

| Guild Terminator 
| 4 
| 147,0,0,0 : If # of guilds = 0, this field is not in the packet. 

If # of Players is greater than 0, the fields Player Name Length and Player Name repeat. The same is true for # of Guilds.

### Click on a property marker (Server -> Client) (this is further along, but still has some unknowns)¶

| 

Name 
| Number of Bytes 
| Description 

| Network OpCode 
| 2 
| 0x09 

| Packet Sequence Number 
| 2 
| 

| Application OpCode 
| 2 
| 
RoF: 0x67C9
Live (20181217): 0x5C12
Live (20190118): 0x1659

| Unknown 
| 2 
| An id? Different across servers 

| Window ID 
| 7 
| 
Always 1,0,4,3,0,0,0
This value is used to branch code paths between the Neighborhood list and Property marker windows.

| Unknown 
| 6 
| 

| Neighborhood ID 
| 4 
| 

| Unknown 
| 4 
| 

| Unknown 
| 4 
| 

| Guild ID 
| 4 
| 

| Unknown 
| 4 
| 123,0,0,0 (may not be constant) 

| Unknown 
| 12 
| 

| Street Address Length 
| 4 
| 

| Street Address 
| Street Address Length 
| Not null terminated. 

| Unknown Name Length 
| 4 
| 

| Unknown Value 
| Unknown Name Length 
| 

| Owner Name Length 
| 4 
| 

| Owner Name 
| Owner Name Length 
| 

| Capacity 
| 4 
| 

| Vault 
| 4 
| 

| Pets 
| 4 
| 

| Unknown 
| 4 
| 

| Unknown 
| 1 
| 

### Real Estate Items window, Click on Trophies button (Client -> Server)¶

Possible new opcode: 0xA02F Length: 342 bytes

| 

Name 
| Number of Bytes 
| Description 

| Network OpCode 
| 2 
| 0x09 

| Packet Sequence Number 
| 2 
| 

| Application OpCode 
| 2 
| 0xA02F 

| Unknown 
| 4 
| 0 

| Unknown 
| 4 
| 1 

| Unknown 
| 328 
| 0 

### OP_NewZone - phinterior3a3 (Server -> Client)¶

Matches the RoF2 NewZone_Struct, but 20 bytes of new data that comes after the Blooming member variable in the RoF2 struct.

| 

Name 
| Number of Bytes 
| Description 

| Network OpCode 
| 2 
| 0x09 

| Packet Sequence Number 
| 2 
| 

| Application OpCode 
| 2 
| 
RoF2: 0x1795
Live: 0x2F3B

| CharName 
| 64 
| 

| Zone Short Name 
| 128 
| 

| Zone Long Name 
| 128 
| 

| Unknown326 
| 174 
| All 0s. 

| ztype 
| 1 
| 

| fog_red 
| 4 
| 

| fog_green 
| 4 
| 

| fog_blue 
| 4 
| 

| unknown507 
| 1 
| 

| fox_minclip 
| 4 
| 

| fog_maxclip 
| 4 
| 

| Gravity 
| 4 
| 

| TimeType 
| 1 
| 

| rain_chance 
| 4 
| 

| rain_duration 
| 4 
| 

| snow_chance 
| 4 
| 

| snow_duration 
| 4 
| 

| ZoneTimeZone 
| 1 
| 

| Sky 
| 1 
| 

| Unknown539 
| 1 
| See if this changes across zones. 

| WaterMidi 
| 4 
| 

| DayMidi 
| 4 
| 

| NightMidi 
| 4 
| 

| zone_exp_multiplier 
| 4 
| 

| safe_y 
| 4 
| 

| safe_x 
| 4 
| 

| safe_z 
| 4 
| 

| min_z 
| 4 
| 

| max_z 
| 4 
| 

| underworld 
| 4 
| 

| minclip 
| 4 
| 

| maxclip 
| 4 
| 

| ForageLow 
| 4 
| 

| ForageMedium 
| 4 
| 

| ForageHigh 
| 4 
| 

| FishingLow 
| 4 
| 

| FishingMedium 
| 4 
| 

| FishingHigh 
| 4 
| 

| sky_lock 
| 4 
| 

| graveyard_timer 
| 4 
| 

| scriptIDHour 
| 4 
| 

| scriptIDMinute 
| 4 
| 

| scriptIDTick 
| 4 
| 

| scriptIDOnPlayerDeath 
| 4 
| 

| scriptIDOnNPCDeath 
| 4 
| 

| scriptIDPlayerEnteringZone 
| 4 
| 

| scriptIDOnZonePop 
| 4 
| 

| scriptIDNPCLoot 
| 4 
| 

| scriptIDAdventureFailed 
| 4 
| 

| CanExploreTasks 
| 4 
| 

| UnknownFlag 
| 4 
| Appears to be 1 for neighborhood related zones, but setting this to 1 and sending to RoF2 did not enable the Place button in the client. 

| scriptIDOnFishing 
| 4 
| 

| scriptIDOnForage 
| 4 
| 

| zone_short_name2[32] 
| 32 
| name of the housing file (e.g. phinterior3a3) 

| WeatherString[32] 
| 32 
| 

| SkyString2[32] 
| 32 
| 

| SkyRelated2 
| 4 
| 

| WeatherString2[32] 
| 32 
| 

| WeatherChangeTime 
| 4 
| 

| Climate 
| 4 
| 

| NPCAggroMaxDist 
| 4 
| 

| FilterID 
| 4 
| 

| ZoneID 
| 2 
| 205,2 Housing instance? 

| ZoneInstance 
| 2 
| 

| ScriptNPCReceivedAnItem 
| 4 
| 

| bCheck 
| 4 
| 

| scriptIDSomething 
| 4 
| 

| scriptIDSomething2 
| 4 
| 

| scriptIDSOmething3 
| 4 
| 

| SuspendBuffs 
| 4 
| 

| LavaDamage 
| 4 
| 

| MinLavaDamage 
| 4 
| 

| bDisallowManaStone 
| 1 
| 

| bNoBind 
| 1 
| 

| bNoAttack 
| 1 
| 

| bNoCallOfHero 
| 1 
| 

| bNoFlux 
| 1 
| 

| bNoFear 
| 1 
| 

| fall_damage 
| 1 
| 

| unknown863 
| 1 
| 0 

| FastRegenHP 
| 4 
| 180 

| FastRegenMana 
| 4 
| 180 

| FastRegenEndurance 
| 4 
| 180 

| CanPlaceCampsite 
| 4 
| Seen 2 

| CanPlaceGuildBanner 
| 4 
| Seen 2 

| FogDensity 
| 4 
| Seen 0.33 

| bAdjustGamma 
| 4 
| 

| TimeStringID 
| 4 
| 

| bNoMercenaries 
| 4 
| 

| FishingRelated 
| 4 
| Seen -1 

| ForageRelated 
| 4 
| Seen -1 

| bNoLevitate 
| 4 
| 

| Blooming 
| 4 
| Seen 1 

| Unk916 
| 4 
| Seen 0 

| Unk920 
| 4 
| Seen 100 

| Unk924 
| 4 
| Seen 0 

| Unk928 
| 4 
| Seen 1 

| Unk932 
| 4 
| Seen 1 

TODO: In-zone clicks for the spring, purchasing a property, placing items in a property, identifying RoF opcodes, updating with additional vendors, fixing Z for existing vendors (some are floating), adding house interior zones (first attempt results in a client crash), etc.

### Objects (Houses)¶

#### plhousingexta.eqg¶

- IT20000

- IT20001

- IT20002

- IT20003

- IT20004

- IT20005

#### plhousingextb.eqg¶

- IT20006

- IT20007

- IT20008

- IT20009

#### phexterior1a.eqg¶

- IT20017

- IT20018

- IT20019

- IT20020

- IT20021

- IT20022

- IT20023

- IT20024

- IT20025

- IT20026

#### neighborhood.eqg¶

- IT20027 - Sign

---

## Skills

*Source: server/player/skills/index.html*

# Skills¶

| 

**Skill ID** 
| **Skill Name** 

| 0 
| 1H Blunt 

| 1 
| 1H Slashing 

| 2 
| 2H Blunt 

| 3 
| 2H Slashing 

| 4 
| Abjuration 

| 5 
| Alteration 

| 6 
| Apply Poison 

| 7 
| Archery 

| 8 
| Backstab 

| 9 
| Bind Wound 

| 10 
| Bash 

| 11 
| Block 

| 12 
| Brass Instruments 

| 13 
| Channeling 

| 14 
| Conjuration 

| 15 
| Defense 

| 16 
| Disarm 

| 17 
| Disarm Traps 

| 18 
| Divination 

| 19 
| Dodge 

| 20 
| Double Attack 

| 21 
| Dragon Punch 

| 22 
| Dual Wield 

| 23 
| Eagle Strike 

| 24 
| Evocation 

| 25 
| Feign Death 

| 26 
| Flying Kick 

| 27 
| Forage 

| 28 
| Hand to Hand 

| 29 
| Hide 

| 30 
| Kick 

| 31 
| Meditate 

| 32 
| Mend 

| 33 
| Offense 

| 34 
| Parry 

| 35 
| Pick Lock 

| 36 
| 1H Piercing 

| 37 
| Riposte 

| 38 
| Round Kick 

| 39 
| Safe Fall 

| 40 
| Sense Heading 

| 41 
| Singing 

| 42 
| Sneak 

| 43 
| Specialize Abjure 

| 44 
| Specialize Alteration 

| 45 
| Specialize Conjuration 

| 46 
| Specialize Divination 

| 47 
| Specialize Evocation 

| 48 
| Pick Pockets 

| 49 
| Stringed Instruments 

| 50 
| Swimming 

| 51 
| Throwing 

| 52 
| Tiger Claw 

| 53 
| Tracking 

| 54 
| Wind Instruments 

| 55 
| Fishing 

| 56 
| Make Poison 

| 57 
| Tinkering 

| 58 
| Research 

| 59 
| Alchemy 

| 60 
| Baking 

| 61 
| Tailoring 

| 62 
| Sense Traps 

| 63 
| Blacksmithing 

| 64 
| Fletching 

| 65 
| Brewing 

| 66 
| Alcohol Tolerance 

| 67 
| Begging 

| 68 
| Jewelry Making 

| 69 
| Pottery 

| 70 
| Percussion Instruments 

| 71 
| Intimidation 

| 72 
| Berserking 

| 73 
| Taunt 

| 74 
| Frenzy 

| 75 
| Remove Trap 

| 76 
| Triple Attack 

| 77 
| 2H Piercing

---

## Slash Commands

*Source: server/player/slash-commands/index.html*

# Slash Commands¶

## From RoF2 Client¶

| 

Command 
| Description 

| ' 
| 

| /1 
| 

| /10 
| 

| /2 
| 

| /3 
| 

| /4 
| 

| /5 
| 

| /6 
| 

| /7 
| 

| /8 
| 

| /9 
| 

| /achievements 
| 

| /aclearcompare 
| 

| /acompare 
| 

| /addraidlooter 
| 

| /adriver 
| 

| /adventure 
| 

| /afk 
| 

| /aggressive 
| 

| /aggrolock 
| 

| /aggrometer 
| 

| /agree 
| 

| /alarm 
| 

| /alternateadv 
| 

| /amaze 
| 

| /announce 
| 

| /anonymous 
| 

| /apologize 
| 

| /applaud 
| 

| /approval 
| 

| /assist 
| 

| /attack 
| 

| /auction 
| 

| /autofire 
| 

| /autoinventory 
| 

| /autojoin 
| 

| /autosplit 
| 

| /bandolier 
| 

| /barter 
| 

| /bazaar 
| 

| /becomenpc 
| FORMAT: /becomenpc . [sex(M, F, N, N is default)] [material#] [head#] [face#] [height] [level max] 

| /beta 
| 

| /betabuff 
| 

| /bird 
| 

| /bite 
| 

| /bleed 
| 

| /blink 
| 

| /blockspell 
| 

| /blush 
| 

| /bodytint 
| 

| /boggle 
| 

| /bonk 
| 

| /book 
| 

| /bored 
| 

| /bounce 
| 

| /bow 
| 

| /brb 
| 

| /broadcast 
| 

| /bugreport 
| 

| /burp 
| 

| /buyer 
| 

| /bye 
| 

| /cackle 
| 

| /calm 
| 

| /camp 
| 

| /cast 
| 

| /changemercname 
| 

| /changename 
| 

| /changepetname 
| 

| /channel 
| 

| /charinfo 
| 

| /chat 
| 

| /chatfontsize 
| 

| /cheer 
| 

| /chuckle 
| 

| /claim 
| 

| /clap 
| 

| /clearallchat 
| 

| /clearchat 
| 

| /clearmarks 
| 

| /clickthrough 
| 

| /combatmusic 
| 

| /comfort 
| 

| /compareexpedraid 
| 

| /comparetaskraid 
| 

| /congratulate 
| 

| /consent 
| 

| /consider 
| 

| /copylayout 
| 

| /corpse 
| 

| /corpsedrag 
| 

| /corpsedrop 
| 

| /cough 
| 

| /cringe 
| 

| /cry 
| 

| /curious 
| 

| /dance 
| 

| /decaycorpse 
| 

| /decline 
| 

| /delcorpse 
| 

| /deny 
| 

| /disband 
| 

| /discipline 
| 

| /dismount 
| 

| /doability 
| 

| /dopropertinting 
| 

| /drool 
| 

| /duck 
| 

| /duel 
| 

| /dynamiclights 
| 

| /dzaddplayer 
| 

| /dzhelp 
| 

| /dzlisttimers 
| 

| /dzmakeleader 
| 

| /dzplayerlist 
| 

| /dzquit 
| 

| /dzremoveplayer 
| 

| /dzswapplayer 
| 

| /emote 
| 

| /emoteworld 
| 

| /emotezone 
| 

| /eqplayersguildupdate 
| 

| /eqplayersupdate 
| 

| /exit 
| 

| /eye 
| 

| /facebook 
| 

| /facepick 
| 

| /fastdrop 
| 

| /fb 
| 

| /feedback 
| 

| /fidget 
| 

| /filter 
| 

| /find 
| 

| /findpc 
| 

| /finger 
| 

| /flex 
| 

| /flipoff 
| 

| /follow 
| 

| /fontface 
| 

| /friends 
| 

| /frown 
| 

| /fsay 
| 

| /fullscreen 
| 

| /gasp 
| 

| /gems 
| 

| /gesture 
| 

| /getguildmotd 
| 

| /giggle 
| 

| /glare 
| 

| /gmarknpc 
| 

| /goto 
| 

| /grin 
| 

| /groan 
| 

| /groupleader 
| 

| /grouproles 
| 

| /grovel 
| 

| /gsay 
| 

| /guidehelp 
| 

| /guildcreate 
| 

| /guilddelete 
| 

| /guilddemote 
| 

| /guildinvite 
| 

| /guildleader 
| 

| /guildmotd 
| 

| /guildpeace 
| 

| /guildpromote 
| 

| /guildremove 
| 

| /guildsay 
| 

| /guildstatus 
| 

| /guildwar 
| 

| /hail 
| 

| /happy 
| 

| /height 
| 

| /help 
| 

| /hidecorpses 
| 

| /hideme 
| 

| /hotbutton 
| 

| /hug 
| 

| /hungry 
| 

| /ignore 
| 

| /indicator 
| 

| /inquire 
| 

| /inspect 
| 

| /inspectbuffs 
| 

| /introduce 
| 

| /invite 
| 

| /invwinlabels 
| 

| /jk 
| 

| /join 
| 

| /keys 
| 

| /kick 
| 

| /kickplayers 
| /kickplayers exp

| /kill 
| 

| /kiss 
| 

| /kneel 
| 

| /language 
| 

| /lastname 
| 

| /laugh 
| 

| /leave 
| 

| /leaveall 
| 

| /leaverealestate 
| 

| /legendsofnorrath 
| 

| /lfgroup 
| 

| /lfguild 
| 

| /list 
| 

| /loadskin 
| 

| /location 
| 

| /log 
| 

| /loot 
| 

| /lootnodrop 
| 

| /lost 
| 

| /makeleader 
| 

| /makeraidleader 
| 

| /map 
| 

| /marketplace 
| 

| /marknpc 
| 

| /massage 
| 

| /mcicontrol 
| 

| /me 
| 

| /melody 
| 

| /memspellset 
| 

| /mercassist 
| 

| /merclog 
| 

| /mercswitch 
| 

| /mercwindows 
| 

| /mixahead 
| 

| /moan 
| 

| /motd 
| 

| /mourn 
| 

| /mousespeed 
| 

| /mp3 
| 

| /msg 
| 

| /netstats 
| 

| /nod 
| 

| /note 
| 

| /nudge 
| 

| /offlinemode 
| 

| /ooc 
| 

| /open 
| 

| /outputfile 
| 

| /panic 
| 

| /paperdoll 
| 

| /particledensity 
| 

| /pat 
| 

| /peer 
| 

| /pet 
| 

| /petition 
| 

| /played 
| 

| /plead 
| 

| /point 
| 

| /poke 
| 

| /ponder 
| 

| /popmail 
| 

| /potionbelt 
| 

| /praise 
| 

| /private 
| 

| /purr 
| 

| /puzzle 
| 

| /quit 
| 

| /racechange 
| 

| /raidaccept 
| 

| /raiddecline 
| 

| /raiddisband 
| 

| /raidinvite 
| 

| /raidwindow 
| 

| /raise 
| 

| /random 
| 

| /ready 
| 

| /realestate 
| 

| /removeraidlooter 
| 

| /reply 
| 

| /report 
| 

| /resetaas 
| 

| /resetCreationServer 
| 

| /resetwindows 
| 

| /reveal 
| 

| /reverb 
| 

| /reversesound 
| 

| /rewind 
| 

| /rmarknpc 
| 

| /roar 
| 

| /rofl 
| 

| /roleplay 
| 

| /rsay 
| 

| /rtarget 
| 

| /rude 
| 

| /safelock 
| 

| /salute 
| 

| /say 
| 

| /sdriver 
| 

| /searchcorpse 
| 

| /secondslog 
| 

| /selfkill 
| 

| /send 
| 

| /servers 
| 

| /servertransfer 
| 

| /setloottype 
| 

| /setstartcity 
| 

| /shadows 
| 

| /share 
| 

| /sheathe 
| 

| /shield 
| 

| /shieldgroup 
| 

| /shiver 
| 

| /shout 
| 

| /showgrass 
| 

| /shownames 
| 

| /shownpcnames 
| 

| /showspelleffects 
| 

| /shrug 
| 

| /sigh 
| 

| /sit 
| 

| /smack 
| 

| /smile 
| 

| /smirk 
| 

| /snarl 
| 

| /snicker 
| 

| /spellscribe 
| 

| /split 
| 

| /stance 
| 

| /stand 
| 

| /stare 
| 

| /stopcast 
| 

| /stopdisc 
| 

| /stopsocial 
| 

| /stopsong 
| 

| /stoptracking 
| 

| /summon 
| 

| /summoncorpse 
| 

| /surname 
| 

| /survey 
| 

| /system 
| 

| /tap 
| 

| /target 
| 

| /targetgroupbuff 
| 

| /taskaddplayer 
| 

| /taskhelp 
| 

| /taskmakeleader 
| 

| /taskplayerlist 
| 

| /taskquit 
| 

| /taskremoveplayer 
| 

| /tasktimers 
| 

| /tcg 
| 

| /tease 
| 

| /tell 
| 

| /testbuffme 
| 

| /testcopy 
| 

| /tgb 
| 

| /thank 
| 

| /thirsty 
| 

| /time 
| 

| /toggleinspect 
| 

| /toggletell 
| 

| /trackfilter 
| 

| /trackmercs 
| 

| /trackpets 
| 

| /trackplayers 
| 

| /tracksort 
| 

| /trader 
| 

| /ttell 
| 

| /tweet 
| 

| /twitter 
| 

| /uptime 
| 

| /url 
| 

| /useitem 
| 

| /usercolor 
| 

| /veteranReward 
| 

| /veto 
| 

| /vgroup 
| 

| /viewport 
| 

| /voicechat 
| 

| /vplay 
| 

| /vraid 
| 

| /vreport 
| 

| /vtell 
| 

| /warn 
| 

| /wave 
| 

| /webupdate 
| 

| /welcome 
| 

| /welcomescreen 
| 

| /whine 
| 

| /whistle 
| 

| /who 
| 

| /whotarget 
| 

| /www 
| 

| /xtarget 
| 

| /yawn 
| 

| /yell 
| 

| /zone 
|

---

## Status Levels

*Source: server/player/status-levels/index.html*

# Status Levels¶

| 

Status Level 
| Status Rank 

| -2 
| Banned 

| -1 
| Suspended 

| 0 
| Normal 

| 10 
| Steward 

| 20 
| Apprentice Guide 

| 50 
| Guide 

| 80 
| QuestTroupe 

| 81 
| Senior Guide 

| 85 
| GM-Tester 

| 90 
| EQ Support 

| 95 
| GM-Staff 

| 100 
| GM-Admin 

| 150 
| GM-Lead Amin 

| 160 
| QuestMaster 

| 170 
| GM-Areas 

| 180 
| GM-Coder 

| 200 
| GM-Mgmt 

| 250 
| GM-Impossible

---

## Converting QGlobals

*Source: server/scripting/converting-qglobals/index.html*

# Converting QGlobals¶

## Changing Quest Globals to Data Buckets¶

As many may know, Quest Globals are stored using a name, type, value, and duration. Due to this we can do a 1:1 conversion of all 8 types of globals.

### Types of Globals and their specificities:¶

| 

Type 
| NPC ID 
| Player 
| Zone 

| 0 
| Current 
| Current 
| Current 

| 1 
| All 
| Current 
| Current 

| 2 
| Current 
| All 
| Current 

| 3 
| All 
| All 
| Current 

| 4 
| Current 
| Current 
| All 

| 5 
| All 
| Current 
| All 

| 6 
| Current 
| All 
| All 

| 7 
| All 
| All 
| All 

### Shortcuts for Globals¶

This list is intended to make it easier for you to assign globals to the desired entity type. 

| 

Shortcut 
| Value 

| All NPCs 
| 1 

| All Players 
| 2 

| All NPCs and Players 
| 3 

| All Zones 
| 4 

| All NPCs and Zones 
| 5 

| All Players and Zones 
| 6 

| All NPCs, Players and Zones 
| 7 

### Conversion¶

The way we will be storing this data is by using the bucket's name. As you can see, types 0 through six have similar names, based on NPC/Player/Zone specificity. Type 7 is global, so the bucket name is just the qglobal name with no specificity.

**Conversion SQL:**

```
`-- Type 0 (NPC, Player, and Zone Specific):
INSERT INTO
 data_buckets (`key`, `value`, `expires`)
SELECT
 CONCAT(npcid, '-', charid, '-', zoneid, '-', name) AS `name`,
 `value`,
 `expdate`
FROM
 quest_globals
WHERE
 zoneid > 0 AND npcid > 0 AND charid > 0;

-- Type 1 (Player and Zone Specific):
INSERT INTO
 data_buckets (`key`, `value`, `expires`)
SELECT
 CONCAT('0-', charid, '-', zoneid, '-', name) AS `name`,
 `value`,
 `expdate`
FROM
 quest_globals
WHERE
 zoneid > 0 AND npcid = 0 AND charid > 0;

-- Type 2 (NPC and Zone Specific):
INSERT INTO
 data_buckets (`key`, `value`, `expires`)
SELECT
 CONCAT(npcid, '-0-', zoneid, '-', name) AS `name`,
 `value`,
 `expdate`
FROM
 quest_globals
WHERE
 zoneid > 0 AND npcid > 0 AND charid = 0;

-- Type 3 (Zone Specific):
INSERT INTO
 data_buckets (`key`, `value`, `expires`)
SELECT
 CONCAT('0-0-', zoneid, '-', name) AS `name`,
 `value`,
 `expdate`
FROM
 quest_globals
WHERE
 zoneid > 0 AND npcid = 0 AND charid = 0;

-- Type 4 (NPC and Player Specific):
INSERT INTO
 data_buckets (`key`, `value`, `expires`)
SELECT
 CONCAT(npcid, '-', charid, '-0-', name) AS `name`,
 `value`,
 `expdate`
FROM
 quest_globals
WHERE
 zoneid = 0 AND npcid > 0 AND charid > 0;

-- Type 5 (Character Specific):
INSERT INTO
 data_buckets (`key`, `value`, `expires`)
SELECT
 CONCAT('0-', charid, '-0-', name) AS `name`,
 `value`,
 `expdate`
FROM
 quest_globals
WHERE
 zoneid = 0 AND npcid = 0 AND charid > 0;

-- Type 6 (NPC Specific):
INSERT INTO
 data_buckets (`key`, `value`, `expires`)
SELECT
 CONCAT(npcid, '-0-0-', name) AS `name`,
 `value`,
 `expdate`
FROM
 quest_globals
WHERE
 zoneid = 0 AND npcid > 0 AND charid = 0;

-- Type 7 (Global):
INSERT INTO
 data_buckets (`key`, `value`, `expires`)
SELECT
 `name`,
 `value`,
 `expdate`
FROM
 quest_globals
WHERE
 zoneid = 0 AND npcid = 0 AND charid = 0;
`
```

### Requirements¶

#### Lua:¶

The Lua module necessary for using the Lua script (lua_modules/buckets.lua):

buckets.lua

```
`local data_buckets = {}

function data_buckets.SetData(npc, client, name, value, options, duration)
 local npcid = 0;
 local charid = 0;
 local zoneid = eq.get_zone_id();
 local bucket_name = "";
 if (options > 7) then -- If somehow you put options above 7, it defaults to type 7
 options = 7;
 end
 if (options == 0) then
 if (npc ~= nil) then
 npcid = npc:CastToNPC():GetNPCTypeID();
 end

 if (client ~= nil) then
 charid = client:CastToClient():CharacterID();
 end
 bucket_name = npcid .. "-" .. charid .. "-" .. zoneid .. "-" .. name;
 elseif (options > 0 and options < 7) then
 if (options == 1 or options == 3 or options == 5) then
 if (client ~= nil) then
 charid = client:CharacterID();
 end
 end

 if (options == 2 or options == 3 or options == 6) then
 if (npc ~= nil) then
 npcid = npc:GetNPCTypeID();
 end
 end

 if (options > 3) then
 zoneid = 0;
 end
 bucket_name = npcid .. "-" .. charid .. "-" .. zoneid .. "-" .. name;
 elseif (options == 7) then
 bucket_name = name;
 end
 if (duration ~= nil) then
 eq.set_data(bucket_name, tostring(value), tostring(duration));
 else
 eq.set_data(bucket_name, tostring(value));
 end
end

function data_buckets.GetData(npc, client, name, options)
 local npcid = 0;
 local zoneid = eq.get_zone_id();
 local charid = 0;
 local bucket_name = "";
 if (options < 0 or options > 7) then
 options = 7;
 end

 if (options == 0) then
 if (npc ~= nil) then
 npcid = npc:GetNPCTypeID();
 end

 if (client ~= nil) then
 charid = client:CharacterID();
 end
 bucket_name = npcid .. "-" .. charid .. "-" .. zoneid .. "-" .. name;
 elseif (options > 0 and options < 7) then
 if (options == 1 or options == 3 or options == 5) then
 if (client ~= nil) then
 charid = client:CharacterID();
 end
 end

 if (options == 2 or options == 3 or options == 6) then
 if (npc ~= nil) then
 npcid = npc:GetNPCTypeID();
 end
 end

 if (options > 3) then
 zoneid = 0;
 end
 bucket_name = npcid .. "-" .. charid .. "-" .. zoneid .. "-" .. name;
 elseif (options == 7) then
 bucket_name = name;
 end
 return eq.get_data(bucket_name);
end

function data_buckets.DeleteData(npc, client, name, options)
 local npcid = 0;
 local zoneid = eq.get_zone_id();
 local charid = 0;
 if (options < 0 or options > 7) then
 options = 7;
 end

 if (options == 0) then
 if (npc ~= nil) then
 npcid = npc:GetNPCTypeID();
 end

 if (client ~= nil) then
 charid = client:CharacterID();
 end
 bucket_name = npcid .. "-" .. charid .. "-" .. zoneid .. "-" .. name;
 elseif (options > 0 and options < 7) then
 if (options == 1 or options == 3 or options == 5) then
 if (client ~= nil) then
 charid = client:CharacterID();
 end
 end

 if (options == 2 or options == 3 or options == 6) then
 if (npc ~= nil) then
 npcid = npc:GetNPCTypeID();
 end
 end

 if (options > 3) then
 zoneid = 0;
 end
 bucket_name = npcid .. "-" .. charid .. "-" .. zoneid .. "-" .. name;
 elseif (options == 7) then
 bucket_name = name;
 end
 eq.delete_data(bucket_name);
end

return data_buckets;
`
```

**Example**

```
`function event_say(e)
 local data_buckets = require("data_buckets");
 if (e.message:findi("set")) then
 for options = 0, 7, 1 do
 data_buckets.SetData(e.self, e.other, "Options Test " .. options, options, options);
 end
 elseif (e.message:findi("read")) then
 for options = 0, 7, 1 do
 e.self:Say(data_buckets.GetData(e.self, e.other, "Options Test " .. options, options));
 end
 elseif (e.message:findi("delete")) then
 for options = 0, 7, 1 do
 data_buckets.DeleteData(e.self, e.other, "Options Test " .. options, options);
 end
 end
end
`
```

#### Perl¶

The Perl plugin necessary for using the Perl script (plugins/buckets.pl):

```
`#Type ID Player Zone
#0 Current Current Current
#1 All Current Current
#2 Current All Current
#3 All All Current
#4 Current Current All
#5 All Current All
#6 Current All All
#7 All All All

sub SetData {
 my @data = @_;
 my ($npcid, $charid, $zoneid) = (0, 0, plugin::val('zoneid'));
 my ($name, $value, $type, $duration) = ($data[0], $data[1], $data[2], (defined $data[3] ? $data[3] : 0));
 if ($type == 0) {
 my $npc = plugin::val('npc');
 $npcid = $npc->GetNPCTypeID();
 $charid = plugin::val('charid');
 if ($duration > 0) {
 quest::set_data("$npcid-$charid-$zoneid-$name", $value, $duration);
 } else {
 quest::set_data("$npcid-$charid-$zoneid-$name", $value);
 }
 } elsif ($type ~~ [1..6]) {
 if ($type & 1) {
 $charid = plugin::val('charid');
 }
 if ($type & 2) {
 my $npc = plugin::val('npc');
 $npcid = $npc->GetNPCTypeID();
 }
 if ($type & 4) {
 $zoneid = 0;
 }
 if ($duration > 0) {
 quest::set_data("$npcid-$charid-$zoneid-$name", $value, $duration);
 } else {
 quest::set_data("$npcid-$charid-$zoneid-$name", $value);
 }
 } elsif ($type == 7) {
 if ($duration > 0) {
 quest::set_data("$name", $value, $duration);
 } else {
 quest::set_data("$name", $value);
 }
 }
}

sub GetData {
 my ($npcid, $charid, $zoneid) = (0, 0, plugin::val('zoneid'));
 my ($name, $type) = (shift, shift);
 if ($type == 0) {
 my $npc = plugin::val('npc');
 $npcid = $npc->GetNPCTypeID();
 $charid = plugin::val('charid');
 plugin::Message("$npcid-$charid-$zoneid-$name: " . quest::get_data("$npcid-$charid-$zoneid-$name"));
 return quest::get_data("$npcid-$charid-$zoneid-$name");
 } elsif ($type ~~ [1..6]) {
 if ($type & 1) {
 $charid = plugin::val('charid');
 }
 if ($type & 2) {
 my $npc = plugin::val('npc');
 $npcid = $npc->GetNPCTypeID();
 }
 if ($type & 4) {
 $zoneid = 0;
 }
 plugin::Message("$npcid-$charid-$zoneid-$name: " . quest::get_data("$npcid-$charid-$zoneid-$name"));
 return quest::get_data("$npcid-$charid-$zoneid-$name"); 
 } elsif ($type == 7) {
 return quest::get_data("$name");
 }
}

sub DeleteData {
 my ($npcid, $charid, $zoneid) = (0, 0, plugin::val('zoneid'));
 my ($name, $type) = (shift, shift);
 if ($type == 0) {
 my $npc = plugin::val('npc');
 $npcid = $npc->GetNPCTypeID();
 $charid = plugin::val('charid');
 quest::delete_data("$npcid-$charid-$zoneid-$name");
 } elsif ($type ~~ [1..6]) {
 if ($type & 1) {
 $charid = plugin::val('charid');
 }
 if ($type & 2) {
 my $npc = plugin::val('npc');
 $npcid = $npc->GetNPCTypeID();
 }
 if ($type & 4) {
 $zoneid = 0;
 }
 quest::delete_data("$npcid-$charid-$zoneid-$name"); 
 } elsif ($type == 7) {
 quest::delete_data("$name");
 }
}
`
```

**Example:**

```
`sub EVENT_SAY {
 if ($text=~/Set/i) {
 for (my $type = 0; $type < 8; $type++) {
 plugin::SetData("Type Test $type", "Blah blah $type", $type);
 }
 } elsif ($text=~/Read/i) {
 for (my $type = 0; $type < 8; $type++) {
 plugin::GetData("Type Test $type", $type);
 }
 } elsif ($text=~/Delete/i) {
 for (my $type = 0; $type < 8; $type++) {
 plugin::DeleteData("Type Test $type", $type);
 }
 }
}
`
```

---

## Emote Colors

*Source: server/scripting/emote-colors/index.html*

# Emote Colors¶

These colors are available to the Quest API:

| 

ID 
| Color 

| 0 
| white 

| 1 
| gray 

| 2 
| dark green 

| 3 
| gray 

| 4 
| light blue 

| 5 
| light purple 

| 6 
| grey 

| 7 
| white 

| 8 
| grey 

| 9 
| grey 

| 10 
| white 

| 11 
| grey 

| 12 
| light silver 

| 13 
| red 

| 14 
| light green 

| 15 
| yellow 

| 16 
| dark blue 

| 17 
| grey 

| 18 
| cyan 

| 257 
| darkish purple 

| 258 
| lighter cyan 

| 259 
| green, light 

| 260 
| ooc green, slightly lighter 

| 261 
| ooc green, slightly lighter 

| 263 
| blue, emote/spell 

| 264 
| blue emote, filters under spells 

| 269 
| yellow, filters under broadcast 

| 270 
| blue, filters under broadcast 

| 271 
| white, filters under spells 

| 272 
| white, filters under broadcast 

| 300 
| odd blue color 

| 315 
| Maroon 

### Example Snippet for Colors¶

```
`if ($text=~/colors/i) {
 for ($i = 0; $i < 100; $i++) {
 $client->Message($i, "Emote Color ID (" . $i . ")");
 }
}
`
```

#### Results¶

---

## Encounters (Lua)

*Source: server/scripting/encounters-lua/index.html*

# Encounters (Lua)¶

#### Encounter Scripts¶

Encounter scripts are quest scripts that are only loaded after explicitly called with one of the following:

```
`eq.load_encounter("encounter_name");
eq.load_encounter_with_data("encounter_name", "some data string");
`
```

They will load one and only one from the following location. Which ever it finds first in the following order:

- ./quests/zone/encounters/name.lua

- ./quests/global/encounters/name.lua

Encounter scripts listen for specific events from other script types with the following functions:

```
`Void register_npc_event(String name, Integer evt, Integer npc_id, luafunction func);
Void register_player_event(String name, Integer evt, luafunction func);
Void register_item_event(String name, Integer evt, Integer item_id, luafunction func);
Void register_spell_event(String name, Integer evt, Integer spell_id, luafunction func);

Note: Passing a value of -1 for npc, item or spell id to watch will watch every npc, item or spell for those events.
`
```

Encounters can be unloaded with the following in the same way they are loaded:

```
`eq.unload_encounter("encounter_name");
eq.unload_encounter_with_data("encounter_name", "some data string");
`
```

Unloading the encounter will automatically unhook all functions that are currently hooked to that named encounter.

Note:

- Encounter scripts cannot properly catch EVENT_COMMAND or EVENT_TRADE unless an existing quest is already listening for them.

- Encounter scripts also run before any normal script and will catch return values.

---

## Entity Lists

*Source: server/scripting/entity-lists/index.html*

# Entity Lists¶

## Description¶

*** Manipulating entity lists is EXTREMELY powerful and if you were smart you would read this article.**

This article also assumes you have read other articles and have a relatively basic understanding of the quest/scripting engine.

To start off, an entity could be any of the following:

- **NPC** ($npc)

- **Mob** ($mob Almost the same thing as NPC, can be used interchangeably) 

- **Client** ($client)

- **Door** ($door - not implied)

- **Object** ($object - not implied)

- **Corpse** ($corpse - not implied)

In this simple example below you can always assume that the **client** is the player who **'triggered'** the script to occur, and the **NPC** who is bound to the script that has triggered:?

PerlLua

```
`sub EVENT_SAY {
 if($text=~/hail/i) {
 $client->Message(15, "This is a client message.");
 $npc->Say("Hello there $name.");
 }
}
`
```

```
`function event_say(e)
 if (e.message:findi("hail")) then
 e.other:Message(15, "This is a client message.");
 e.self:Say("Hello there " .. e.other:GetCleanName() . ".");
 end
end
`
```

Some of you may already know this as common knowledge, but in order for this to cover everyone's knowledge levels I will preamble with the basics a bit.

## What are Entity Objects?¶

Entity objects are used most commonly as a way encorporate the simple example above, I have one **\(client** that **triggered** the script and a **\)npc** that was triggered when I **hailed** the npc, but what they were really intended for is so you can flexibly 'select' any NPC in the zone when trying to perform any specific function.

We can essentially use a **Controller NPC** or any **NPC **for that matter to control any other NPC in the zone using entity objects, you just need to know how to select them and use them to your extreme advantage.

**Crushbone**

I am going to use Crushbone as a simple example here.

This zone by default has 119 NPC's approximately. Most if not all of them are Orc's and some prisoners and such.

| 

| 
| 

| 
| 
| 

- Below is a list of NPC's in the zone, we're simply using this as a reference of what kind of NPC's are in the zone. There are other ways to get this information using plugins and handy tools but for now simply for illustration purposes we want to take a quick survery of what we have in the zone and how many NPC's of certain name types we have.

- Below is simpy the spawn data, it does not mean that all of these NPC's are what is spawned at all times in the database, these are the unique entries that are in the database. Once again there are about 119 NPC's with the zone fully popped.

```
`SELECT npc_types.id, COUNT(npc_types.id) AS `npc_count`,
npc_types.`name`, npc_types.lastname, npc_types.`level` FROM(spawn2 ,npc_types)
INNER JOIN spawnentry ON npc_types.id = spawnentry.npcID
AND spawnentry.spawngroupID = spawn2.spawngroupID
WHERE spawn2.zone = 'crushbone' GROUP BY `npc_types`.`name`;
`
```

```
`+-------+-----------+-----------------------------+----------+-------+
| id | npc_count | name | lastname | level |
+-------+-----------+-----------------------------+----------+-------+
| 58059 | 1 | Ambassador_DVinn | | 20 |
| 58019 | 1 | an_elven_priest | | 5 |
| 58007 | 9 | an_elven_slave | | 3 |
| 58043 | 1 | an_orc_thaumaturgist | | 12 |
| 58020 | 9 | a_dwarven_slave | | 2 |
| 58018 | 3 | a_dwarven_smith | | 3 |
| 58032 | 1 | Emperor_Crush | | 18 |
| 58056 | 1 | Kelynn | | 9 |
| 58028 | 1 | Lord_Darish | | 14 |
| 58015 | 114 | orc_centurion | | 9 |
| 58025 | 6 | orc_emissary | | 15 |
| 58008 | 33 | orc_legionnaire | | 12 |
| 58024 | 9 | orc_oracle | | 13 |
| 58001 | 25 | orc_pawn | | 1 |
| 58042 | 1 | Orc_Scoutsman | | 12 |
| 58016 | 15 | orc_slaver | | 5 |
| 58040 | 1 | orc_taskmaster | | 14 |
| 58035 | 1 | orc_trainer | | 13 |
| 58047 | 1 | Orc_Warden | | 14 |
| 58002 | 1 | orc_warlord | | 16 |
| 58017 | 1 | Retlon_Brenclog | | 16 |
| 58010 | 1 | Rondo_Dunfire | | 9 |
| 58030 | 1 | royal_guard | | 15 |
| 58058 | 1 | The_Fabled_Ambassador_Dvinn | | 25 |
| 58057 | 1 | The_Fabled_Emperor_Crush | | 25 |
| 58031 | 1 | The_Prophet | | 17 |
+-------+-----------+-----------------------------+----------+-------+
26 rows in set
`
```

## Manipulating the Entity List¶

Now, we can start getting to the real nuts and bolts of practical application here. Let's say I'm on a mission to liven up a custom version of my zone, and whenever Emperor Crush spawns, I want all of my Orc's in the zone to howl and beat their chest or swing their arm or do something provocative as well as make an emote we would use an example such as below.

```
`sub EVENT_SPAWN {
 quest::shout("Graghhhh! Who goes there!"); #:: Ruh roh, Emperor is pissed I think!
 quest::settimer("get_zone_wriled_up", 3); #:: Use a timer so that if we #repop the zone, we give everything a little bit of time to pop before trying to manipulate the rest of the NPC's
}

sub EVENT_TIMER {
 if($timer eq "get_zone_wriled_up") { #:: Triggering timer event
 quest::shout("lol"); #:: Some test thing message I left in apparently.
 my @nlist = $entity_list->GetNPCList(); #:: Use Entity List Object to get this
 foreach my $n (@nlist){ #:: Iterate through each NPC in the @nlist array
 if($n->GetCleanName()=~/orc/i){ #:: We are doing a simple string comparison, GetCleanName should be getting the name of the NPC, we want to match if it has the name 'orc' in it $n->Say("Yargghhh"); #::: Have each NPC say 'Yargghhh' that matches the name 'orc'
 $n->Say("Yargghhh");
 $n->DoAnim(8); #:: Have each NPC do an attack aniamtion
 }
 }
 quest::stoptimer($timer); #:: Stop the timer, $timer is an exported object from the source as this event is triggered
 }
}
`
```

```
`function event_spawn(e)
 e.self:Shout("Graghhhh! Who goes there!"); --:: Ruh roh, Emperor is pissed I think!
 eq.set_timer("get_zone_wriled_up", 3); --:: Use a timer so that if we #repop the zone, we give everything a little bit of time to pop before trying to manipulate the rest of the NPC's
end

function event_timer(e)
 if (e.timer == "get_zone_wriled_up") then --:: Triggering timer event
 e.self:Shout("lol"); --:: Some test thing message I left in apparently.
 local nlist = entity_list:GetNPCList(); --:: Use Entity List Object to get this
 for i, npc in ipairs(nlist) do --:: Iterate through each NPC in the @nlist array
 if (npc:GetCleanName():findi("orc")) then --:: We are doing a simple string comparison, GetCleanName should be getting the name of the NPC, we want to match if it has the name 'orc' in it $n->Say("Yargghhh"); #::: Have each NPC say 'Yargghhh' that matches the name 'orc'
 npc:Say("Yargghhh");
 npc:DoAnim(8); --:: Have each NPC do an attack aniamtion
 end
 end
 eq.stop_timer("get_zone_wriled_up"); --:: Stop the timer
 end
end
`
```

- In this very quick example you can see that I used a timer as a delay to spawn the NPC's, and then I used a simply entity list iteration to have NPC's do what I want them to do

As you can see they Orc's are all performing animation 8 which is a simple attack animation, for animtions see the Animation Reference List.

You also see orcs nearby you are saying **'Yargghh''**

## **Iteration Example**¶

- **Now, lets say I want to use the same iteration loop to do stuff to other NPC's. Let's say I want to have the slaves shout 'HELP!' - this is getting a bit ridiculous isn't it? Who cares!**

```
`sub EVENT_SPAWN {
 quest::shout("Graghhhh! Who goes there!");
 quest::settimer("get_zone_wriled_up", 3);
}

sub EVENT_TIMER {
 if($timer eq "get_zone_wriled_up") {
 quest::shout("lol");
 my @nlist = $entity_list->GetNPCList();
 foreach my $n (@nlist){
 if($n->GetCleanName()=~/orc/i){
 $n->Say("Yargghhh");
 $n->DoAnim(8);
 }
 if($n->GetCleanName()=~/slave/i){
 $n->Shout("HELP!");
 }
 }
 quest::stoptimer($timer);
 }
}
`
```

```
`function event_spawn(e)
 e.self:Shout("Graghhhh! Who goes there!");
 eq.set_timer("get_zone_wriled_up", 3);
end

function event_timer(e)
 if (e.timer == "get_zone_wriled_up") then
 e.self:Shout("lol");
 local nlist = entity_list:GetNPCList();
 for i, npc in ipairs(nlist) do
 if (npc:GetCleanName():findi("orc")) then
 npc:Say("Yargghhh");
 npc:DoAnim(8);
 end
 if (npc:GetCleanName():findi("slave")) then
 npc:Shout("HELP!");
 end
 end
 eq.stop_timer("get_zone_wriled_up");
 end
end
`
```

- Now, I see exactly what we would expect, the slaves shouting for help, of course you could just have the elven scripts shout in their script but we're using this simply as an example

- The same exact thing applies for clients, you can use any $client object listed in the Quest API manipulate the entity list and trigger any action in any event that you want. It is a less frequent thing to want to use a full list of clients to do something, but you can use it for a variety of things depending on the cool ideas that you come up with. But for examples sake I want to use an example where maybe I want to freeze all of the clients in a zone in a boss fight with **Emperor Crushbone **for many a few seconds at a time

## Client Example¶

PerlLua

```
`sub EVENT_COMBAT {
 if($combat_state == 1) { #::: Attack state is on for NPC
 my @clist = $entity_list->GetClientList();
 foreach my $c (@clist) {
 $c->Message(15, "You are frozen!");
 $c->Freeze();
 }
 }
}
`
```

```
`function event_combat(e)
 if (e.joined) then
 local client_list = entity_list:GetClientList();
 for i, client in ipairs(client_list) do
 client:Message(15, "You are frozen!");
 client:Freeze();
 end
 end
end
`
```

- And you can see below that when I attack **Emperor Crush,** I and every single other \(client in the zone would be frozen until I did something to unfreeze the client. I literally had to force exit my game client because I lost complete control of my client and I could not do anything at this point. So it would be a good idea to set a timer for 5 seconds to also have all clients **\)client->UnFreeze();** once again to gain control.You may not want to actually use this example in your quests as there are spells that can achieve the same effect, this is simply for demonstrational purposes only.

## Using Entity Selectors¶

We've already used some selectors in previous examples, but to to give you an idea, below are some of the selectors that we can use to grab things and do stuff with them:

| 

Method 

| GetClientByAccID(accid) 

| GetClientByCharID(iCharID) 

| GetClientByID(id) 

| GetClientByName(name) 

| GetClientByWID(iWID) 

| GetClientList() 

| GetCorpseByID(id) 

| GetCorpseByName(name) 

| GetCorpseByOwner(client) 

| GetCorpseList() 

| GetDoorsByDBID(id) 

| GetDoorsByID(id) 

| GetDoorsList() 

| GetGroupByClient(client) 

| GetGroupByID(id) 

| GetGroupByLeaderName(leader) 

| GetGroupByMob(mob) 

| GetMob(name) 

| GetMobByID(id) 

| GetMobByNpcTypeID(get_id) 

| GetMobID(id) 

| GetMobList() 

| GetNPCByID(id) 

| GetNPCByNPCTypeID(npc_id) 

| GetNPCList() 

| GetObjectByDBID() 

| GetObjectByID() 

| GetObjectList() 

| GetRaidByClient(client) 

| GetRaidByID(id) 

| GetRandomClient(x, y, z, range, ClientToExclude = NULL) 

So let's say, I wanted to get something by any of these above? I use examples very similar to the one above, except for getting a single 'entity' does not require me to 'loop' through all the entries in a foreach or things of the like. If I wanted to for example just get ONE NPC, a very common method to do this is to use **$entity_list->GetNPCByNPCTypeID(YourNPCIDGoesHere);**

- **You would use this example if you are specifically trying to select a unique NPC in the zone that there is only one NPC ID of that NPC, to knock out two birds in one stone, I'm going to make this specific NPC attack a player by using a player selector.**

- **In this example I will have Emperor Crush get Lord Darnish NPCID (58028) attack the player as well just incase the player hacked his way to the tower**

PerlLua

```
`sub EVENT_COMBAT {
 if($combat_state == 1) { #::: Attack state is on for NPC
 my $lord_darnish = $entity_list->GetNPCByNPCTypeID(58028); #::: Lord Darnish
 $lord_darnish->Attack($client); #::: We use $client because it is implied in combat
 }
}
`
```

```
`function event_combat(e)
 if (e.joined) then Attack state is on for NPC
 local lord_darnish = entity_list:GetNPCByNPCTypeID(58028); -- Lord Darnish
 lord_darnish:Attack(e.self);
 end
end
`
```

- **Once again if you are trying to select similar NPC's you need to use an entity list iteration (foreach loop) and then use entity objects to filter on their data, few one line examples below:**

- **if($n->GetClass() == 1) #::: Get all NPC's that are warriors**

- **if($n->GetCleanName()=~/orc/i) #::: Check to see if entity has 'orc' in its name**

- **if($n->GetNPCTypeID() == 58000) #::: Check for NPC's that have 58000 for an NPC Type ID**

- **if($n->GetRace() == 54) #::: Would select NPC's that have race 54**

## **More on Selectors**¶

- Keep in mind, you are not limited to the examples I have illustrated, there are many ways you can define a single object and how you define them is up to you.

- To make use of the $lord_darnish selector example above, I could not even define $lord_darnish, I just did that for readability and examples

- When I do this: **$entity_list->GetNPCByNPCTypeID(58028)** (I can now use another pointer right here and go straight to my object)

So: **\(entity_list->GetNPCByNPCTypeID(58028)->Attack(\)client); - Would be equivalent to my example above**

- When using an entity_list selector, you are simply grabbing that entity object and depending on that type, \(client/\)npc/\(object/\)door/etc you can access its methods

- So For example if I use an entity selector that gets a client, all of $client is available to use off of that object

**\(entity_list->GetClientByName("Akkadius")->Duck();** - Would make me duck (\)client method)

- **$entity_list->GetNPCByNPCTypeID(58028)->WipeHateList();** - Wipes that particular NPC's hatelist

- At this point just knowing this little bit of knowledge you have all kinds of possibilities in your arsenal

---

## Entity Variables

*Source: server/scripting/entity-variables/index.html*

# Entity Variables¶

## Description¶

I would hope you read Entity Lists and understand entities and how they work before reading this. If you have, then it will help understanding what entity variables are and how powerful they can be in helping you do whatever it is you are trying to do

When you are using Perl, and in a script you define an object, you define it like so, **$object = 1; **Easy, right?** **- Yes, but there is a problem. **ANY NPC** who also has this same script loaded could overwrite this variable. When I am trying to set and read data unique to a particular NPC, using this method does not make things all that easy. Given, you COULD use a Perl array accessor unique to the NPCID but that is not quite as flexible to this system that has been developed by KLS to do.

So here I am going to show you some examples and why **entity variables are amazing.**

An entity variable can be used by most commonly \(npc/\)client. It is just like any other variable to store quickly accessible stuff.

They are stored in **memory of the zone, and persist when an entity is alive**. Meaning if you repop the variables clear, or an NPC/client dies/zones etc.

Picture it like this, these NPCs below have a '**virtual bucket**' of variables you can set. The only thing you need when setting variables is a **variable name to read and write.**

With this, you can get really really creative as to how you pass variables around.

- **$entity->SetEntityVariable("variable_name", "value") - Write**

- **$entity->GetEntityVariable("variable_name") - Read - Would return whatever the variable is set to for that NPC**

- **There are Perl Plugin Shorthands for these functions (For speed of writing scripts)**

- **plugin::SEV($entity, "variable_name", "value"); - Write**

- **plugin::REV($entity, "variable_name"); - Returns value, Read**

- See Plugins Reference

## Example¶

- In this simple example, we're looping the same timer every 3 seconds and an NPC is going to say something different every 3 seconds until it gets to the 4th passing of the timer and the NPC shuts his mouth.

```
`sub EVENT_SAY {
 if($text=~/hail/i) {
 quest::say("hi, starting timer...");
 quest::settimer("test_timer", 3);
 plugin::SEV($client, "passings", 1); #:: Just called it 'passings' because I will be using it to track passings of a timer
 }
}

sub EVENT_TIMER {
 if($timer eq "test_timer") {
 my $passings = plugin::REV($client, "passings");
 if($passings == 1) {
 quest::say("Hey how are you?");
 } elsif($passings == 2) {
 quest::say("What do you want?");
 } elsif($passings == 3) {
 quest::say("Are you going to go away?");
 } elsif($passings == 4) { #:: Since we want to stop at 4, we cut off the timer and stop counting the passes
 quest::say("Like seriously, buzz off, I'm busy...");
 quest::stoptimer($timer);
 }
 plugin::SEV($client, "passings", ($passings + 1)); #:: Increment the number so we don't loop the timer forever...
 }
}
`
```

---

## GMSay

*Source: server/scripting/gmsay/index.html*

# GMSay¶

## Examples¶

Perl

```
`quest::gmsay("Test") # Will send white text to all players in the current zone with an admin status of >= 80
quest::gmsay("Test", 13) # Will send red text to all players in the current zone with an admin status of >= 80
quest::gmsay("Test", 13, 1) # Will send red text to all players with an admin status of >= 80 in all zones
quest::gmsay("Test", 13, 1, 30) # Will send red text to all players with an admin status of >= 80 in all zones who are in the guild with an ID of 30
quest::gmsay("Test", 13, 1, 30, 0) # Will send red text to all players (minstatus == 0) in all zones who are in the guild with an ID of 30
`
```

---

## Scripting

*Source: server/scripting/index.html*

# Scripting¶

Please note that there is extensive documentation of the EQEmu Quest Api available on this site. This documentation includes sample scripts describing functions, variables, sub routines and the like. 

The information found here is intended to get someone started down the path of creating their own custom scripts on their world.

## Getting Started¶

If you are new to the EQEmu Quest API, it can easily be daunting to try to digest the vast array of methods, functions, subroutines, plugins, and varying quest-scripting languages. Quest scripts in EQEmu are written in Lua or Perl, both of which are widely accepted throughout the EQEmu community.

**If you are new to both Lua and Perl**, a good place to get started is the Quest API Introduction.

**If you are adept at either Lua or Perl**, it is best to familiarize yourself with how EQEmu loads quests scripts, followed by reviewing the various Events that can be triggered in either Perl or Lua, along with exports of those events (as well as the global exports), and then beginning to review the many methods and functions exposed in the API.

## To Perl, or to Lua?¶

The decision to utilize either Perl or Lua for your quest scripts is entirely up to you. Both offer nearly all the same functions and methods--where discrepancies exist, they are noted (for instance the Spell Methods page describes methods only available in Lua. Beginners often find Perl easier to understand. Adept Lua programmers might enjoy the ability to load encounters. Advanced Perl programmers may find the ability to create or utilize plugins very desirable.

All attempts have been made to provide corresponding examples in both languages throughout this Wiki. Many community members have a preference, and certainly there are many members of the community that can provide you guidance for either language--please look for us in the **#server-help** channel on the EQEmu Discord server.

## Some Basics to get you Started¶

We're frequently asked for certain types of scripts that server operators need to create NPCs in their world that can provide some basic services to players. 

### Player Buffing¶

The Player Buffer Scripts page gives you examples of how to automatically buff players (for instance, when a player levels up and needs new skills or spells), as well as examples of how to include NPCs that perform these duties or cast specific buffs when a player interacts with the Buffer NPC.

These scripts range from fairly straightforward to relatively complex--be sure to reference Event Subroutines to learn why these scripts fire, Quest API Functions to learn what each function does and how to properly call the function, and finally, Customizing NPCs if you would like to learn how to create your own NPC who will utilize any of these quest scripts.

### Player Teleporting¶

The Player Teleporter Scripts page gives some examples of how you can move players around in game. Don't forget that there are plenty of examples in the default scripts that were installed with your server, such as the Nexus portals. 

Often server operators would like to teleport users to a specific instance of a zone as well, which would allow you to create raid instances for competing guilds, or create custom dungeon crawls for your players. The sample script includes something called a "Data Bucket", so you may want to read Using Data Buckets to gain some understanding of this flexible, performant system.

---

## Lua Mods

*Source: server/scripting/lua-mods/index.html*

# Lua Mods¶

Inside the directory https://github.com/EQEmu/Server/tree/master/utils/mods you can find example scripts on how to override combat to a legacy eqemu formula. This page helps details the process to set up adding lua hooks, so you can customize this to your server's needs

In your eqemu server root directory (where zone, world, shared_memory etc exists) create a new folder called mods

On linux, ensure mods and scripts are chmod 755

Ensure load_order.txt exists under mods, and refers to any hooks that need to be loaded.

Most functions have a e.IgnoreDefault boolean that by default is false. If set to true, you can override all default logic and inject your own.

You can use #reload quest to reload the scripts in your zone to reflect your latest changes. Be sure to #reload world once you finalize your setup and want it to go across all zones.

# Function List¶

| 

Function 
| Description 

| **ApplyDamageTable** 
| Adjust damage based on a table, no example available. 

| **AvoidDamage** 
| Check if an attacker avoided damage, no example available 

| **CalcSpellEffectValue_formula** 
| Apply custom spell formulas to how a spell value is deduced. An example is found in utils 

| **CheckHitChance** 
| Check if an attacker hit a defender. e.hit will have hit information. legacy combat example and jamfest example 

| **CommonDamage** 
| Adjust damage done. jamfest example 

| **CommonOutgoingHitSuccess** 
| This is the final value of an outgoing hit success. Note that if any critical hits occured, if this value is modified, the crit won't match up as the text for the crit would already be displayed. legacy combat example. 

| **GetExperienceForKill** 
| Get experience earned for a kill, and modify the amount. classic wow example. Note for more granular control, you can use SetEXP and SetAAEXP. 

| **GetEXPForLevel** 
| Get raw experience normally rewarded for leveling. classic wow example 

| **GetRequiredAAExperience** 
| Get how much experience is needed for an AA gain. classic wow example 

| **HealDamage** 
| Adjust healing done. jamfest example 

| **IsImmuneToSpell** 
| Check if a target is immune to a spell, and inject custom logic and message on resist jamfest example 

| **MeleeMitigation** 
| Process melee mitigation (damage reduction). legacy combat example. 

| **RegisterBug** 
| When a /bug report occurs, this fires with info. githubeq uses this to reroute bugs to github issues. githubeq example 

| **SetAAEXP** 
| Set AA experience earned for a kill. jamfest example 

| **SetEXP** 
| Set experience earned for a kill. jamfest example 

| **TryCriticalHit** 
| Try executing a critical hit. legacy combat example. 

| **UpdatePersonalFaction** 
| Adjust faction gain. jamfest example

---

## Merchant Data Buckets

*Source: server/scripting/merchant-data-buckets/index.html*

# Merchant Data Buckets¶

- Merchant data buckets allow Server Operators to limit the items a merchant will show based on different data bucket comparisons and the bucket name and value provided.

## Using Merchant Data Buckets¶

- To use a Merchant Data Bucket you will need to set the `bucket_name`, `bucket_value`, and `bucket_comparison` fields in the `merchantlist` table for your intended item.

## How the Data Buckets are Used¶

- The Merchant grabs all of your Data Buckets when you open the Merchant window and then compares your values to the field values noted above.

## Comparison Types¶

- Merchant Data Buckets have 10 different comparison types.

## Standard Comparison Types¶

- There are six standard comparison types.

`0 (==)` checks your value and the Merchant value for `equality`

- `1 (!=)` checks your value and the Merchant value for `inequality`

- `2 (>=)` checks if your value is `greater than or equal to` the Merchant value

- `3 (<=)` checks if your value is `lesser than or equal to` the Merchant value

- `4 (>)` checks if your value is `greater than` the Merchant value

- `5 (<)` checks if your value is `lesser than` the Merchant value

## Special Comparsion Types¶

- There are four special comparison types.

- These values are pipe `|` separated.

`6 (Any)` checks if your value is `any` of the pipe-separated Merchant values `(Example: 1|2|3)`

- `7 (Not Any)` checks if your value is `not any` of the pipe-separated Merchant values `(Example: 4|5|6)`

- `8 (Between)` checks if your value is `between` two pipe-separated Merchant values `(Example: 1|3)`

- `9 (Not Between)` checks if your value is `not between` two pipe-separated Merchant values `(Example: 4|6)`

---

## Perl Plugins

*Source: server/scripting/perl-plugins/index.html*

# Perl Plugins¶

Inside the plugins directory you can find example scripts on how to create reusable methods so that you don't have to copy and paste code in between files.

The `plugins` folder can be located in the `quests` folder and can be either dragged to the base folder directory or symbollically linked to be called from within the `quests` folder.

To reload plugins for your zone you can use `#reload quest`, to reload plugins globally you'll need to use `#reload world`.

An example plugin is this:

```
`sub CustomData {
 my %custom_data = (
 0 => "A",
 1 => "B",
 2 => "C",
 3 => "D"
 );

 return %custom_data;
}

sub ListCustomData {
 my %custom_data = CustomData();

 foreach my $key (sort {$a <=> $b} keys %custom_data) {
 quest::message(315, "$key: $custom_data{$key}");
 }
}
`
```

You can call this `custom_plugin.pl`.

An example of an NPC using this would be as follows.

```
`sub EVENT_SAY {
 if ($text=~/Hail/i) {
 plugin::ListCustomData();
 }
}
`
```

Perhaps you want to use the data itself, well you can do this.

```
`sub EVENT_SAY {
 if ($text=~/Hail/i) {
 my $list_link = quest::saylink("list", 1);
 my $search_link = quest::saylink("search", 1);
 quest::whisper("Hail $name, would you like to $list_link or $search_link the custom data?");
 } elsif ($text=~/List/i) {
 plugin::ListCustomData();
 } elsif ($text=~/^Search$/i) {
 quest::whisper("Simply say \"search [value]\" to search the custom data.");
 } elsif ($text=~/^Search/i) {
 my $search_string = substr($text, 7);
 if (length($search_string) > 0) {
 my %custom_data = plugin::CustomData();
 foreach my $key (sort {$a <=> $b} keys %custom_data) {
 if (lc($search_string) eq lc($custom_data{$key})) {
 quest::message(315, "Found '$search_string' under Key '$key'!");
 }
 }
 }
 }
}
`
```

---

## Player Buffer Scripts

*Source: server/scripting/player-buffer-scripts/index.html*

# Player Buffer Scripts¶

### Discipline Trainer¶

This script will allow an NPC to train all available disciplines up to the player's current level.

Dave_The_Disciplinarian.pl

```
`sub EVENT_SAY {
 #:: Match text for "hail", case insensitive
 if ($text=~/hail/i) {
 #:: Send a message that only the client can see, in yellow (15) text
 $client->Message(15, "With just one look, I can see that you have forgotten the finer points of combat, $name. Would you like me to [" . quest::saylink("teach") . "] you how to perform the skills that require more discipline than the basics?");
 }
 #:: Match text for "teach", case insensitive
 elsif ($text=~/teach/i) {
 #:: Clear out any existing disciplines (optional)
 quest::untraindiscs();
 #:: Train all disciplines up to the user's level
 quest::traindiscs($ulevel, 0);
 #:: Send a message that only the client can see, in yellow (15) text
 $client->Message(15, "You look like a more fierce combatant already! Go out and test your new abilities!");
 #:: Play a Ding! sound
 quest::ding();
 }
}

sub EVENT_ITEM {
 #:: Return unused items since we don't expect any handins
 plugin::returnUnusedItems();
}
`
```

If you would prefer that your players do not have to interact with an NPC, it is quite simple to add all new disciplines each time a player levels using a script. You would simply add this snippet to your global quest script file.

This script will train all new disciplines when a player levels up:

global/global_player.plglobal/global_player.lua

```
`sub EVENT_LEVEL_UP {
 #:: Train all disciplines, maximum set to player's level, minimum set to the level prior
 quest::traindiscs($ulevel,$ulevel - 1);
}
`
```

```
`function event_level_up(e)
 -- Train all disciplines up to current level
 eq.train_discs(e.self:GetLevel());
end
`
```

### Spell Scriber¶

This script will scribe all available spells (or songs) up to the player's current level.

Skippy_the_Scribe.pl

```
`sub EVENT_SAY {
 #:: Match text for "hail", case insensitive
 if ($text=~/hail/i) {
 #:: Separate response for melee classes--match classes using a string comparison (eq)
 if ($class eq 'Berserker' || $class eq 'Monk' || $class eq 'Rogue' || $class eq 'Warrior') {
 #:: Send a message that only the client can see, in yellow (15) text
 $client->Message(15, "Young fighter, I am the greatest spell scribe Norrath has ever seen--I do not waste my time on brutes like you!");
 }
 #:: Separate response for bards, who are always special
 elsif ($class eq 'Bard') {
 #:: Send a message that only the client can see, in yellow (15) text
 $client->Message(15, "With just one look, I can see that your songbook is lacking, $name. Would you like me to [" . quest::saylink("scribe") . "] all of the known $class songs for you?");
 }
 #:: Separate response for casting classes
 elsif ($class eq 'Beastlord' || $class eq 'Cleric' || $class eq 'Druid' || $class eq 'Enchanter' || $class eq 'Magician' || $class eq 'Necromancer' || $class eq 'Paladin' || $class eq 'Ranger' || $class eq 'Shadowknight' || $class eq 'Shaman' || $class eq 'Wizard') {
 #:: Send a message that only the client can see, in yellow (15) text
 $client->Message(15, "With just one look, I can see that your spellbook is lacking, $name. Would you like me to [" . quest::saylink("scribe") . "] all of the known $class spells for you?");
 }
 }
 #:: Match text for "scribe", case insensitive
 elsif ($text=~/scribe/i) {
 if ($class eq 'Bard' || $class eq 'Beastlord' || $class eq 'Cleric' || $class eq 'Druid' || $class eq 'Enchanter' || $class eq 'Magician' || $class eq 'Necromancer' || $class eq 'Paladin' || $class eq 'Ranger' || $class eq 'Shadowknight' || $class eq 'Shaman' || $class eq 'Wizard') {
 #:: Clear out any existing spells
 quest::unscribespells();
 #:: Scribe all spells up to the user's level
 quest::scribespells($ulevel, 0);
 #:: Send a message that only the client can see, in yellow (15) text
 $client->Message(15, "You look like a more powerful caster already! Go out and test your new spells!");
 #:: Play a Ding! sound
 quest::ding();
 }
 elsif ($class eq 'Berserker' || $class eq 'Monk' || $class eq 'Rogue' || $class eq 'Warrior') {
 $client->Message(15, "Begone, $class--lest I turn you into froglok tad!");
 }
 }
}

sub EVENT_ITEM {
 #:: Return unused items since we don't expect any handins
 plugin::returnUnusedItems();
}
`
```

As with disciplines, if you would prefer that your players do not have to interact with an NPC, it is quite simple to add all new spells/songs each time a player levels adding a snippet to your global quest file. 

This script will scribe all new spells/songs when a player levels up.

global/global_player.plglobal/global_player.lua

```
`sub EVENT_LEVEL_UP {
 #:: Scribe all spells/songs, maximum set to player's level, minimum set to the level prior
 quest::scribespells($ulevel,$ulevel - 1);
}
`
```

```
`function event_level_up(e)
 -- Scribe all spells up to current level
 eq.scribe_spells(e.self:GetLevel());
end
`
```

### Skill Maxer¶

This script will set all available skills to their maximum amount at the player's current level.

Scotty_the_Skilled.pl

```
`sub EVENT_SAY {
 #:: Match text for "hail", case insensitive
 if ($text=~/hail/i) {
 #:: Send a message that only the client can see, in yellow (15) text
 $client->Message(15, "Hello, $name! It appears you could use some help with your [" . quest::saylink("skills") . "]. Would you like me to teach you?");
 }
 #:: Match text for "skills", case insensitive
 elsif ($text=~/skills/i) {
 #:: Set available (non-trade, non-casting specialization) skills to maximum for race/class at current level
 foreach my $skill (0..42, 48..54, 70..77) {
 next unless $client->CanHaveSkill($skill);
 #:: Create a scalar variable to store each skill's maximum skill level at the player's current level
 my $maxSkill = $client->MaxSkill($skill, $client->GetClass(), $ulevel);
 #:: Check that the player's skill does not already exceed the maximum skill based on level
 next unless $maxSkill > $client->GetRawSkill($skill);
 #:: Set the skill to the maximum
 $client->SetSkill($skill, $maxSkill);
 }
 #:: Send a message that only the client can see, in yellow (15) text
 $client->Message(15, "You look like a more capable $class already! Go out and test your new skills!");
 #:: Play a Ding! sound
 quest::ding();
 }
}

sub EVENT_ITEM {
 #:: Return unused items since we don't expect any handins
 plugin::returnUnusedItems();
}
`
```

As with spells and disciplines, if you would prefer that your players do not have to interact with an NPC, it is quite simple to max all skills each time a player levels by adding a snippet to your global quest file.

This script will max all skills when a player levels up.

global/global_player.plglobal/global_player.lua

```
`sub EVENT_LEVEL_UP {
 #:: Set available (non-trade, non-casting specialization) skills to maximum for race/class at current level
 foreach my $skill (0..42, 48..54, 70..77) {
 next unless $client->CanHaveSkill($skill);
 #:: Create a scalar variable to store each skill's maximum skill level at the player's current level
 my $maxSkill = $client->MaxSkill($skill, $client->GetClass(), $ulevel);
 #:: Check that the player's skill does not already exceed the maximum skill based on level
 next unless $maxSkill > $client->GetRawSkill($skill);
 #:: Set the skill to the maximum
 $client->SetSkill($skill, $maxSkill);
 }
}
`
```

```
`function event_level_up(e)
 local skills = { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 48, 49, 50, 51, 52, 53, 54, 56, 62, 66, 67, 70, 71, 72, 73, 74, 75, 76, 77 };
 for i, curskill in ipairs(skills) do
 local maxskill = e.self:MaxSkill(curskill);
 if (e.self:CanHaveSkill(curskill) == false) then
 --Do nothing
 elseif (maxskill <= e.self:GetRawSkill(curskill)) then
 --Do nothing
 else
 --Do Training
 e.self:SetSkill(curskill, maxskill);
 end
 end
end
`
```

### Player Buffer¶

This script will provide buffs and cures to the player and/or the player's pet, or the player's group and their pets, and will bind the player to the area. The NPC will charge the player for the good buffs.

Credit to Maze who created the original version of this script, which has been adapted for use on this wiki.

Canary_Morris.pl

```
`#:: Create a scalar vaiable to store the maximum level of buffs
$maxlevelbuffs = 70;
#:: Create a hash to define spells cast at each 10 levels, and their cost
#:: Keys are by each 10 levels, with differentiation for spells ranked as generic vs. advanced
#:: Values are each spell, by id, and the cost in platinum for each rank
%buffshash = (
 #:: Hash for Warriors
 1 => 
 {
 level10generic => [276,278,219,368,146,148,279,129],
 level10costgeneric => 0,
 level10costadvanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level10costadvanced => 100,
 level20generic => [276,278,219,368,146,148,279,129],
 level20costgeneric => 0,
 level20advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level20costadvanced => 100,
 level30generic => [276,278,219,368,146,148,279,129],
 level30costgeneric => 0,
 level30advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level30costadvanced => 100,
 level40generic => [276,278,219,368,146,148,279,129],
 level40costgeneric => 0,
 level40advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level40costadvanced => 100,
 level50generic => [276,278,219,368,146,148,279,129],
 level50costgeneric => 0,
 level50advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level50costadvanced => 100,
 level60generic => [276,278,219,368,146,148,279,129],
 level60costgeneric => 0,
 level60advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level60costadvanced => 100,
 level70generic => [276,278,219,368,146,148,279,129],
 level70costgeneric => 0,
 level70advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level70costadvanced => 100,
 },
 #:: Hash for Clerics
 2 =>
 {
 level10generic => [276,278,219,368,146,148,279,129],
 level10costgeneric => 0,
 level10advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level10costadvanced => 100,
 level20generic => [276,278,219,368,146,148,279,129],
 level20costgeneric => 0,
 level20advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level20costadvanced => 100,
 level30generic => [276,278,219,368,146,148,279,129],
 level30costgeneric => 0,
 level30advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level30costadvanced => 100,
 level40generic => [276,278,219,368,146,148,279,129],
 level40costgeneric => 0,
 level40advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level40costadvanced => 100,
 level50generic => [276,278,219,368,146,148,279,129],
 level50costgeneric => 0,
 level50advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level50costadvanced => 100,
 level60generic => [276,278,219,368,146,148,279,129],
 level60costgeneric => 0,
 level60advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level60costadvanced => 100,
 level70generic => [276,278,219,368,146,148,279,129],
 level70costgeneric => 0,
 level70advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level70costadvanced => 100,
 },
 #:: Hash for Paladins
 3 =>
 {
 level10generic => [276,278,219,368,146,148,279,129],
 level10costgeneric => 0,
 level10advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level10costadvanced => 100,
 level20generic => [276,278,219,368,146,148,279,129],
 level20costgeneric => 0,
 level20advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level20costadvanced => 100,
 level30generic => [276,278,219,368,146,148,279,129],
 level30costgeneric => 0,
 level30advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level30costadvanced => 100,
 level40generic => [276,278,219,368,146,148,279,129],
 level40costgeneric => 0,
 level40advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level40costadvanced => 100,
 level50generic => [276,278,219,368,146,148,279,129],
 level50costgeneric => 0,
 level50advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level50costadvanced => 100,
 level60generic => [276,278,219,368,146,148,279,129],
 level60costgeneric => 0,
 level60advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level60costadvanced => 100,
 level70generic => [276,278,219,368,146,148,279,129],
 level70costgeneric => 0,
 level70advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level70costadvanced => 100,
 },
 #:: Hash for Ranger
 4 =>
 {
 level10generic => [276,278,219,368,146,148,279,129],
 level10costgeneric => 0,
 level10advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level10costadvanced => 100,
 level20generic => [276,278,219,368,146,148,279,129],
 level20costgeneric => 0,
 level20advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level20costadvanced => 100,
 level30generic => [276,278,219,368,146,148,279,129],
 level30costgeneric => 0,
 level30advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level30costadvanced => 100,
 level40generic => [276,278,219,368,146,148,279,129],
 level40costgeneric => 0,
 level40advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level40costadvanced => 100,
 level50generic => [276,278,219,368,146,148,279,129],
 level50costgeneric => 0,
 level50advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level50costadvanced => 100,
 level60generic => [276,278,219,368,146,148,279,129],
 level60costgeneric => 0,
 level60advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level60costadvanced => 100,
 level70generic => [276,278,219,368,146,148,279,129],
 level70costgeneric => 0,
 level70advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level70costadvanced => 100,
 },
 #:: Hash for Shadow Knight
 5 =>
 {
 level10generic => [276,278,219,368,146,148,279,129],
 level10costgeneric => 0,
 level10advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level10costadvanced => 100,
 level20generic => [276,278,219,368,146,148,279,129],
 level20costgeneric => 0,
 level20advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level20costadvanced => 100,
 level30generic => [276,278,219,368,146,148,279,129],
 level30costgeneric => 0,
 level30advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level30costadvanced => 100,
 level40generic => [276,278,219,368,146,148,279,129],
 level40costgeneric => 0,
 level40advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level40costadvanced => 100,
 level50generic => [276,278,219,368,146,148,279,129],
 level50costgeneric => 0,
 level50advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level50costadvanced => 100,
 level60generic => [276,278,219,368,146,148,279,129],
 level60costgeneric => 0,
 level60advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level60costadvanced => 100,
 level70generic => [276,278,219,368,146,148,279,129],
 level70costgeneric => 0,
 level70advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level70costadvanced => 100,
 },
 #:: Hash for Druid
 6 =>
 {
 level10generic => [276,278,219,368,146,148,279,129],
 level10costgeneric => 0,
 level10advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level10costadvanced => 100,
 level20generic => [276,278,219,368,146,148,279,129],
 level20costgeneric => 0,
 level20advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level20costadvanced => 100,
 level30generic => [276,278,219,368,146,148,279,129],
 level30costgeneric => 0,
 level30advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level30costadvanced => 100,
 level40generic => [276,278,219,368,146,148,279,129],
 level40costgeneric => 0,
 level40advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level40costadvanced => 100,
 level50generic => [276,278,219,368,146,148,279,129],
 level50costgeneric => 0,
 level50advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level50costadvanced => 100,
 level60generic => [276,278,219,368,146,148,279,129],
 level60costgeneric => 0,
 level60advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level60costadvanced => 100,
 level70generic => [276,278,219,368,146,148,279,129],
 level70costgeneric => 0,
 level70advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level70costadvanced => 100,
 },
 #:: Hash for Monk
 7 =>
 {
 level10generic => [276,278,219,368,146,148,279,129],
 level10costgeneric => 0,
 level10advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level10costadvanced => 100,
 level20generic => [276,278,219,368,146,148,279,129],
 level20costgeneric => 0,
 level20advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level20costadvanced => 100,
 level30generic => [276,278,219,368,146,148,279,129],
 level30costgeneric => 0,
 level30advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level30costadvanced => 100,
 level40generic => [276,278,219,368,146,148,279,129],
 level40costgeneric => 0,
 level40advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level40costadvanced => 100,
 level50generic => [276,278,219,368,146,148,279,129],
 level50costgeneric => 0,
 level50advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level50costadvanced => 100,
 level60generic => [276,278,219,368,146,148,279,129],
 level60costgeneric => 0,
 level60advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level60costadvanced => 100,
 level70generic => [276,278,219,368,146,148,279,129],
 level70costgeneric => 0,
 level70advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level70costadvanced => 100,
 },
 #:: Hash for Bard
 8 =>
 {
 level10generic => [276,278,219,368,146,148,279,129],
 level10costgeneric => 0,
 level10advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level10costadvanced => 100,
 level20generic => [276,278,219,368,146,148,279,129],
 level20costgeneric => 0,
 level20advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level20costadvanced => 100,
 level30generic => [276,278,219,368,146,148,279,129],
 level30costgeneric => 0,
 level30advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level30costadvanced => 100,
 level40generic => [276,278,219,368,146,148,279,129],
 level40costgeneric => 0,
 level40advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level40costadvanced => 100,
 level50generic => [276,278,219,368,146,148,279,129],
 level50costgeneric => 0,
 level50advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level50costadvanced => 100,
 level60generic => [276,278,219,368,146,148,279,129],
 level60costgeneric => 0,
 level60advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level60costadvanced => 100,
 level70generic => [276,278,219,368,146,148,279,129],
 level70costgeneric => 0,
 level70advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level70costadvanced => 100,
 },
 #:: Hash for Rogue
 9 =>
 {
 level10generic => [276,278,219,368,146,148,279,129],
 level10costgeneric => 0,
 level10advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level10costadvanced => 100,
 level20generic => [276,278,219,368,146,148,279,129],
 level20costgeneric => 0,
 level20advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level20costadvanced => 100,
 level30generic => [276,278,219,368,146,148,279,129],
 level30costgeneric => 0,
 level30advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level30costadvanced => 100,
 level40generic => [276,278,219,368,146,148,279,129],
 level40costgeneric => 0,
 level40advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level40costadvanced => 100,
 level50generic => [276,278,219,368,146,148,279,129],
 level50costgeneric => 0,
 level50advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level50costadvanced => 100,
 level60generic => [276,278,219,368,146,148,279,129],
 level60costgeneric => 0,
 level60advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level60costadvanced => 100,
 level70generic => [276,278,219,368,146,148,279,129],
 level70costgeneric => 0,
 level70advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level70costadvanced => 100,
 },
 #:: Hash for Shaman
 10 =>
 {
 level10generic => [276,278,219,368,146,148,279,129],
 level10costgeneric => 0,
 level10advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level10costadvanced => 100,
 level20generic => [276,278,219,368,146,148,279,129],
 level20costgeneric => 0,
 level20advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level20costadvanced => 100,
 level30generic => [276,278,219,368,146,148,279,129],
 level30costgeneric => 0,
 level30advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level30costadvanced => 100,
 level40generic => [276,278,219,368,146,148,279,129],
 level40costgeneric => 0,
 level40advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level40costadvanced => 100,
 level50generic => [276,278,219,368,146,148,279,129],
 level50costgeneric => 0,
 level50advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level50costadvanced => 100,
 level60generic => [276,278,219,368,146,148,279,129],
 level60costgeneric => 0,
 level60advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level60costadvanced => 100,
 level70generic => [276,278,219,368,146,148,279,129],
 level70costgeneric => 0,
 level70advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level70costadvanced => 100,
 },
 #:: Hash for Necromancer
 11 =>
 {
 level10generic => [276,278,219,368,146,148,279,129],
 level10costgeneric => 0,
 level10advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level10costadvanced => 100,
 level20generic => [276,278,219,368,146,148,279,129],
 level20costgeneric => 0,
 level20advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level20costadvanced => 100,
 level30generic => [276,278,219,368,146,148,279,129],
 level30costgeneric => 0,
 level30advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level30costadvanced => 100,
 level40generic => [276,278,219,368,146,148,279,129],
 level40costgeneric => 0,
 level40advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level40costadvanced => 100,
 level50generic => [276,278,219,368,146,148,279,129],
 level50costgeneric => 0,
 level50advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level50costadvanced => 100,
 level60generic => [276,278,219,368,146,148,279,129],
 level60costgeneric => 0,
 level60advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level60costadvanced => 100,
 level70generic => [276,278,219,368,146,148,279,129],
 level70costgeneric => 0,
 level70advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level70costadvanced => 100,
 },
 #:: Hash for Wizard
 12 =>
 {
 level10generic => [276,278,219,368,146,148,279,129],
 level10costgeneric => 0,
 level10advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level10costadvanced => 100,
 level20generic => [276,278,219,368,146,148,279,129],
 level20costgeneric => 0,
 level20advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level20costadvanced => 100,
 level30generic => [276,278,219,368,146,148,279,129],
 level30costgeneric => 0,
 level30advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level30costadvanced => 100,
 level40generic => [276,278,219,368,146,148,279,129],
 level40costgeneric => 0,
 level40advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level40costadvanced => 100,
 level50generic => [276,278,219,368,146,148,279,129],
 level50costgeneric => 0,
 level50advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level50costadvanced => 100,
 level60generic => [276,278,219,368,146,148,279,129],
 level60costgeneric => 0,
 level60advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level60costadvanced => 100,
 level70generic => [276,278,219,368,146,148,279,129],
 level70costgeneric => 0,
 level70advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level70costadvanced => 100,
 }, 
 #:: Hash for Magician
 13 =>
 {
 level10generic => [276,278,219,368,146,148,279,129],
 level10costgeneric => 0,
 level10advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level10costadvanced => 100,
 level20generic => [276,278,219,368,146,148,279,129],
 level20costgeneric => 0,
 level20advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level20costadvanced => 100,
 level30generic => [276,278,219,368,146,148,279,129],
 level30costgeneric => 0,
 level30advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level30costadvanced => 100,
 level40generic => [276,278,219,368,146,148,279,129],
 level40costgeneric => 0,
 level40advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level40costadvanced => 100,
 level50generic => [276,278,219,368,146,148,279,129],
 level50costgeneric => 0,
 level50advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level50costadvanced => 100,
 level60generic => [276,278,219,368,146,148,279,129],
 level60costgeneric => 0,
 level60advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level60costadvanced => 100,
 level70generic => [276,278,219,368,146,148,279,129],
 level70costgeneric => 0,
 level70advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level70costadvanced => 100,
 },
 #:: Hash for Enchanter
 14 =>
 {
 level10generic => [276,278,219,368,146,148,279,129],
 level10costgeneric => 0,
 level10advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level10costadvanced => 100,
 level20generic => [276,278,219,368,146,148,279,129],
 level20costgeneric => 0,
 level20advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level20costadvanced => 100,
 level30generic => [276,278,219,368,146,148,279,129],
 level30costgeneric => 0,
 level30advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level30costadvanced => 100,
 level40generic => [276,278,219,368,146,148,279,129],
 level40costgeneric => 0,
 level40advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level40costadvanced => 100,
 level50generic => [276,278,219,368,146,148,279,129],
 level50costgeneric => 0,
 level50advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level50costadvanced => 100,
 level60generic => [276,278,219,368,146,148,279,129],
 level60costgeneric => 0,
 level60advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level60costadvanced => 100,
 level70generic => [276,278,219,368,146,148,279,129],
 level70costgeneric => 0,
 level70advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level70costadvanced => 100,
 },
 #:: Hash for Beastlord
 15 => 
 {
 level10generic => [276,278,219,368,146,148,279,129],
 level10costgeneric => 0,
 level10advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level10costadvanced => 100,
 level20generic => [276,278,219,368,146,148,279,129],
 level20costgeneric => 0,
 level20advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level20costadvanced => 100,
 level30generic => [276,278,219,368,146,148,279,129],
 level30costgeneric => 0,
 level30advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level30costadvanced => 100,
 level40generic => [276,278,219,368,146,148,279,129],
 level40costgeneric => 0,
 level40advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level40costadvanced => 100,
 level50generic => [276,278,219,368,146,148,279,129],
 level50costgeneric => 0,
 level50advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level50costadvanced => 100,
 level60generic => [276,278,219,368,146,148,279,129],
 level60costgeneric => 0,
 level60advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level60costadvanced => 100,
 level70generic => [276,278,219,368,146,148,279,129],
 level70costgeneric => 0,
 level70advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level70costadvanced => 100,
 },
 #:: Hash for Berserker
 16 => 
 {
 level10generic => [276,278,219,368,146,148,279,129],
 level10costgeneric => 0,
 level10advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level10costadvanced => 100,
 level20generic => [276,278,219,368,146,148,279,129],
 level20costgeneric => 0,
 level20advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level20costadvanced => 100,
 level30generic => [276,278,219,368,146,148,279,129],
 level30costgeneric => 0,
 level30advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level30costadvanced => 100,
 level40generic => [276,278,219,368,146,148,279,129],
 level40costgeneric => 0,
 level40advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level40costadvanced => 100,
 level50generic => [276,278,219,368,146,148,279,129],
 level50costgeneric => 0,
 level50advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level50costadvanced => 100,
 level60generic => [276,278,219,368,146,148,279,129],
 level60costgeneric => 0,
 level60advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level60costadvanced => 100,
 level70generic => [276,278,219,368,146,148,279,129],
 level70costgeneric => 0,
 level70advanced => [3692,2505,423,356,172,64,145,1693,15,60,61,46,2524],
 level70costadvanced => 100,
 }
);

sub EVENT_SAY {
 #:: Create a scalar variable to store the cost of group buffs
 my $groupbuffmaxcost = 0;
 #:: Match text for "hail", case insensitive
 if ($text =~/Hail/i) { 
 quest::say("Greetings $name. I have been sent to aid you on your journey! Would you like some [".quest::saylink("lesser buffs",1)."] for ".$buffshash{$client->GetClass()}->{"level".round_up($ulevel)."costgeneric"}."pp, or some [".quest::saylink("greater blessings",1)."] for ".$buffshash{$client->GetClass()}->{"level".round_up($ulevel)."costadvanced"}."pp?");
 #:: Check to see if the player is grouped
 if ($client->IsGrouped()) {
 #:: Create a scalar variable to store the group
 $buffgroup = $entity_list->GetGroupByClient($client);
 #:: Create a loop to count how many members are in the group
 for ($count = 0; $count < $buffgroup->GroupCount(); $count++) {
 #:: Create a scalar variable to store the group member count
 my $groupmember = $buffgroup->GetMember($count);
 #:: Make sure that each group member is in zone before charging for them
 if ($groupmember->GetZoneID() == $zoneid) {
 #:: Create a scalar variable to store the cost of the buffs
 $groupbuffmaxcost += ($buffshash{$groupmember->GetClass()}->{"level".round_up($groupmember->GetLevel())."costadvanced"});
 }
 }
 quest::say("Since you are grouped, you can also get the best [".quest::saylink("group blessings",1)."] for ".$groupbuffmaxcost."pp");
 }
 quest::say("To [".quest::saylink ("cure", 1)."] you and/or your pet is free.");
 quest::say("Or I can [".quest::saylink ("bind", 1)."] you to this location at no cost.");
 }
 #:: Match text for "lesser buffs", case insensitive
 elsif ($text=~/lesser buffs/i) {
 #:: Make sure the player has enough plat for the buffs
 if ($client->GetCarriedMoney() >= (($buffshash{$client->GetClass()}->{"level".round_up($ulevel)."costgeneric"}) * 1000)) {
 #:: Create an array of the buffs to be cast on the player
 my @buffstocast = @{$buffshash{$client->GetClass()}->{"level".round_up($ulevel)."generic"}};
 #:: Create a loop to cast each buff in the hash for the pet (if it exists) and then the player
 foreach my $buff (@buffstocast) {
 #:: Check to see if the player has a pet
 if ($client->GetPetID()) {
 #:: Create a scalar variable to store the pet by ID
 my $pcpet = $entity_list->GetMobByID($client->GetPetID());
 #:: Buff the pet
 $client->SpellFinished ($buff, $pcpet);
 }
 #:: Buff the player
 quest::selfcast ($buff);
 }
 #:: Take payment for the buffs
 $client->TakeMoneyFromPP((($buffshash{$client->GetClass()}->{"level".round_up($ulevel)."costgeneric"}) * 1000), 1) unless ($buffshash{$client->GetClass()}->{"level".round_up($ulevel)."costgeneric"}) == 0;
 }
 else {
 #:: Match if the player does not have enough plat
 quest::say("I charge ".($buffshash{$client->GetClass()}->{"level".round_up($ulevel)."costgeneric"})."pp for lesser buffs, you don't appear to have enough on you.");
 }
 }
 #:: Match text for "greater blessings", case insensitive
 elsif ($text =~/greater blessings/i) {
 #:: Make sure the player has enough plat for the buffs
 if ($client->GetCarriedMoney() >= (($buffshash{$client->GetClass()}->{"level".round_up($ulevel)."costadvanced"}) * 1000)) {
 #:: Create an array of the buffs to be cast on the player
 my @buffstocast = @{$buffshash{$client->GetClass()}->{"level".round_up($ulevel)."advanced"}};
 #:: Create a loop to cast each buff in the hash for the pet (if it exists) and then the player
 foreach my $buff (@buffstocast) {
 #:: Check to see if the player has a pet
 if ($client->GetPetID()) {
 #:: Create a scalar variable to store the pet by ID
 my $pcpet = $entity_list->GetMobByID($client->GetPetID());
 #:: Buff the pet
 $client->SpellFinished ($buff, $pcpet);
 }
 #:: Buff the player
 quest::selfcast ($buff);
 }
 #:: Take payment for the buffs
 $client->TakeMoneyFromPP((($buffshash{$client->GetClass()}->{"level".round_up($ulevel)."costadvanced"}) * 1000), 1) unless ($buffshash{$client->GetClass()}->{"level".round_up($ulevel)."costadvanced"}) == 0;
 }
 else {
 #:: Match if the player does not have enough plat
 quest::say("I charge ".($buffshash{$client->GetClass()}->{"level".round_up($ulevel)."costadvanced"})."pp for greater blessings, you don't appear to have enough on you.");
 }
 }
 #:: Match text for "group blessings", case insensitive, and if the player is grouped
 elsif ($text =~ /group blessings/i && $client->IsGrouped()) {
 #:: Make sure the player has enough plat for the buffs
 if ($client->GetCarriedMoney() >= (($buffshash{$client->GetClass()}->{"level".$maxlevelbuffs."costadvanced"}) * 1000 * $buffgroup->GroupCount())) {
 #:: Create a loop to count the group members
 for ($count = 0; $count < $buffgroup->GroupCount(); $count++) {
 #:: Create a scalar variable to store the group member count
 my $groupmember = $buffgroup->GetMember($count);
 #:: Make sure that each group member is in zone before charging for them
 if ($groupmember->GetZoneID() == $zoneid) {
 #:: Take payment for the buffs
 $client->TakeMoneyFromPP((($buffshash{$groupmember->GetClass()}->{"level".round_up($groupmember->GetLevel())."costadvanced"}) * 1000), 1) unless ($buffshash{$groupmember->GetClass()}->{"level".round_up($groupmember->GetLevel())."costadvanced"}) == 0;
 #:: Create an array of the buffs to be cast on each player
 my @buffstocast = @{$buffshash{$groupmember->GetClass()}->{"level".round_up($groupmember->GetLevel())."advanced"}};
 #:: Create a loop to cast each buff in the hash for each group member pet (if any exist) and then each group member
 foreach my $buff (@buffstocast) {
 #:: Check to see if the player has a pet
 if ($groupmember->GetPetID()) {
 #:: Create a scalar variable to store the pet by ID
 my $groupmemberpet = $entity_list->GetMobByID($groupmember->GetPetID());
 #:: Buff the pet
 $groupmember->SpellFinished ($buff, $groupmemberpet);
 }
 #:: Buff the group members
 $groupmember->SpellFinished ($buff, $groupmember);
 }
 #:: Create an on-screen message for each group member so they know who to thank for the buffs
 $groupmember->SendMarqueeMessage(15, 510, 1, 1, 3000, "You've been buffed compliments of ".$client->GetCleanName()."!");
 } 
 }
 }
 else {
 #:: Match if the player does not have enough plat
 quest::say("I charge a maximum of ".(($buffshash{$client->GetClass()}->{"level".$maxlevelbuffs."costadvanced"}) * $buffgroup->GroupCount())."pp to cast buffs on your entire group. You don't appear to have enough!");
 } 
 }
 #:: Match text for "cure", case insensitive
 elsif ($text=~/cure/i) { 
 #:: Check to see if the player has a pet
 if ($client->GetPetID()) {
 #:: Create a scalar variable to store the pet by ID
 my $pppet = $entity_list->GetMobByID($client->GetPetID());
 #:: Cure the pet
 $client->SpellFinished (6594, $pppet);
 }
 #:: Cure the player
 $client->SpellFinished(6594); 
 }
 #:: Match text for "bind", case insensitive
 elsif ($text=~/bind/i) {
 #:: Bind the player
 quest::selfcast(35);
 }
}

#:: This is a subroutine to round up to the nearest 10 levels
sub round_up {
 my $n = shift;
 my $scale = 10**int(log($n)/log(10));
 $n = 9 if $scale == 1;
 if ($n > $scale) {
 $n = int($n/$scale+1)*$scale;
 }
 $n;
}
`
```

---

## Player Teleporter Scripts

*Source: server/scripting/player-teleporter-scripts/index.html*

# Player Teleporter Scripts¶

Below is an example of a quest script for an NPC that can teleport your players. Ths scripts would go in your quest scripts directory, and would be named appropriately based on the NPC that you will create to transport your players.

## Old World Porter¶

This script will name translocate targets and teleport your player based on the target of their choosing.

Roald_Teavee.pl

```
`sub EVENT_SAY {
 if ($text =~ /Hail/i) {
 quest::say("Hello. $name! I am practicing the arcane art of [" . quest::saylink("teleportation") . "]. Would you like to try teleporting?");
 }
 elsif ($text =~ /teleportation/i) {
 quest::say("I have mastered teleporting adventurers to [" . quest::saylink("Antonica") . "], [" . quest::saylink("Faydwer") . "], and [" . quest::saylink("Odus") . "]. Where would you like to travel?");
 }
 elsif ($text =~ /Antonica/i) {
 quest::say("I have mastered transport to [" . quest::saylink("Nektulos Forest") . "], [" . quest::saylink("The Northern Desert of Ro") . "], [" . quest::saylink("The Northern Plains of Karana") . "], [" . quest::saylink("The Temple of Cazic Thule") . "], [" . quest::saylink("The Western Commonlands") . "]and [" . quest::saylink("The Western Plains of Karana") . "]. Where would you like to go?");
 }
 elsif ($text =~ /Faydwer/i) {
 quest::say("I have mastered transport to [" . quest::saylink("The Greater Faydark") . "]. Where would you like to go?");
 }
 elsif ($text =~ /Odus/i) {
 quest::say("I have mastered transport to [" . quest::saylink("Toxxulia Forest") . "]. Where would you like to go?");
 }
 elsif ($text =~ /Nektulos Forest/i) {
 quest::say("Begone!");
 $npc->CastSpell(1371, $userid);
 }
 elsif ($text =~ /The Northern Desert of Ro/i) {
 quest::say("Begone!");
 $npc->CastSpell(1373, $userid);
 }
 elsif ($text =~ /The Northern Plains of Karana/i) {
 quest::say("Begone!");
 $npc->CastSpell(1338, $userid);
 }
 elsif ($text =~ /The Temple of Cazic Thule/i) {
 quest::say("Begone!");
 $npc->CastSpell(1375, $userid);
 }
 elsif ($text =~ /The Western Commonlands/i) {
 quest::say("Begone!");
 $npc->CastSpell(1372, $userid);
 }
 elsif ($text =~ /The Western Plains of Karana/i) {
 quest::say("Begone!");
 $npc->CastSpell(1374, $userid);
 }
 elsif ($text =~ /The Greater Faydark/i) {
 quest::say("Begone!");
 $npc->CastSpell(1336, $userid);
 }
 elsif ($text =~ /Toxxulia Forest/i) {
 quest::say("Begone!");
 $npc->CastSpell(1337, $userid);
 }

}

sub EVENT_ITEM {
 #:: Return unused items
 plugin::returnUnusedItems();
}
`
```

## Instance Teleporter¶

This quest script is an example of a teleporter script that allows you to port to a specific instance of a zone.

Info

Be sure to read up on Using Data Buckets 

```
`#:: Create a scalar variable to store the cost of instance deletion - 1,000,000 copper pieces (1,000pp)
my $cost = 1000000;
#:: Create a scalar variable to store an Instance ID
my $InstanceID = 0;
#:: Create an array to store zone data information
my @Data = undef;
#:: Create an array of zones enabled for instancing and transport
my @ZoneArray =
 (
 "Permafrost",
 "Nagafen's Lair"
 );

sub EVENT_SAY {
 my $NPCName = $npc->GetCleanName();
 if ($text=~/hail/i) {
 #:: Key a data bucket to protect functions
 $key = $NPCName . "-current-name";
 #:: Match if the key exists
 if (quest::get_data($key)) {
 #:: Match if the person talking is the focus of our attention
 if (quest::get_data($key) eq "$name") {
 $client->Message(315, "$NPCName says, 'Hello, $name. Are you interested in a [" . quest::saylink("teleport") . "]?'");
 }
 #:: Match if the person talking rudely interrupted
 else {
 $Name = quest::get_data($key);
 quest::say("I am sorry, $name, but I was right in the middle of speaking with " . $Name . ". Is " . $Name . " [" . quest::saylink("gone") . "]?");
 }
 }
 else {
 #:: Set the data bucket
 quest::set_data($key, $name);
 $client->Message(315, "$NPCName says, 'Hello, $name. Are you interested in a [" . quest::saylink("teleport") . "]?'");
 }
 }
 elsif ($text=~/gone/i) {
 #:: Key a data bucket to protect functions
 $key = $NPCName . "-cool-down";
 #:: Match if the key exists
 if (quest::get_data($key)) {
 quest::say("Give me a minute, $name. I seem to keep losing people.");
 }
 else {
 #:: Protect gone from switching for 60 seconds
 quest::set_data($key, 1, 60);
 #:: Key a data bucket to protect functions
 $key = $NPCName . "-current-name";
 #:: Set the data bucket
 quest::set_data($key, $name);
 $client->Message(315, "$NPCName says, 'Well then, $name...are you interested in a [" . quest::saylink("teleport") . "]?'");
 }
 }
 elsif ($text=~/teleport/i) {
 #:: Key a data bucket to protect functions
 $key = $NPCName . "-current-name";
 #:: Match if the person talking is the focus of our attention
 if (quest::get_data($key) eq "$name") {
 #:: Speak the elements of the zone array
 my $count = 1;
 my $n = 0;
 while ($ZoneArray[$n]) {
 if ($ZoneArray[$n]) {
 my $ZoneName = quest::saylink($ZoneArray[$n]);
 $client->Message(315, "$NPCName says, 'Would you like to go to $ZoneName?'");
 }
 $n++;
 $count++;
 }
 }
 #:: Match if the person talking rudely interrupted
 else {
 $Name = quest::get_data($key);
 quest::say("I am sorry, $name, but I was right in the middle of speaking with " . $Name . ". Is " . $Name . " [" . quest::saylink("gone") . "]?");
 }
 }
 elsif ($text=~/\bPermafrost\b/i) {
 #:: Key a data bucket to protect functions
 $key = $NPCName . "-current-name";
 #:: Match if the person talking is the focus of our attention
 if (quest::get_data($key) eq "$name") {
 @Data = undef; 
 @Data = ("permafrost", 73, 61.00, -121.00, 3.75);
 #:: Key a data bucket to check the player's existing zone instance setting
 $key = $client->CharacterID() . "-active-instance-zone";
 #:: Match if the data bucket does not exist
 if (!quest::get_data($key)) {
 #:: Set a data bucket to track player zone instance
 quest::set_data($key, "$Data[0]", 86400);
 #:: Create the Instance of that zone and store the ID in a scalar variable
 $InstanceID = quest::CreateInstance("$Data[0]", 0, 86400);
 #:: Key a data bucket to track the player's instance ID
 $key = $client->CharacterID() . "-active-instance-id";
 #:: Set a data bucket to track player's instance ID
 quest::set_data($key, $InstanceID, 86400);
 $client->Message(315, "$NPCName says, 'Alright, $name. Please tell me when you are ready to [" . quest::saylink("go") . "].'");
 }
 #:: Match if the data bucket exists for this zone shortname
 elsif (quest::get_data($key) eq "$Data[0]") {
 #:: Key a data bucket to pull the instance ID
 $key = $client->CharacterID() . "-active-instance-id";
 #:: Update the scalar variable
 $InstanceID = quest::get_data($key);
 $client->Message(315, "$NPCName says, 'Alright, $name. Please tell me when you are ready to [" . quest::saylink("go") . "].'");
 }
 #:: Match if the data bucket exists but is set to a different zone
 else {
 $CharInstance = quest::get_data($key);
 $client->Message(315, "$NPCName says, 'Sorry $name, but it looks like you already have an instance for" . $CharInstance . ". Would you like to [" . quest::saylink("delete") . "] it for" . $cost / 1000 . " platinum pieces?'");
 }
 }
 #:: Match if the person talking rudely interrupted
 else {
 $Name = quest::get_data($key);
 quest::say("I am sorry, $name, but I was right in the middle of speaking with " . $Name . ". Is " . $Name . " [" . quest::saylink("gone") . "]?");
 }
 }
 elsif ($text=~/\bNagafen's Lair\b/i) {
 #:: Key a data bucket to protect functions
 $key = $NPCName . "-current-name";
 #:: Match if the person talking is the focus of our attention
 if (quest::get_data($key) eq "$name") {
 @Data = undef; 
 @Data = ("soldungb", 32, -263, 424, -108);
 #:: Key a data bucket to check the player's existing zone instance setting
 $key = $client->CharacterID() . "-active-instance-zone";
 #:: Match if the data bucket does not exist
 if (!quest::get_data($key)) {
 #:: Set a data bucket to track player zone instance
 quest::set_data($key, "$Data[0]", 86400);
 #:: Create the Instance of that zone and store the ID in a scalar variable
 $InstanceID = quest::CreateInstance("$Data[0]", 0, 86400);
 #:: Key a data bucket to track the player's instance ID
 $key = $client->CharacterID() . "-active-instance-id";
 #:: Set a data bucket to track player's instance ID
 quest::set_data($key, $InstanceID, 86400);
 $client->Message(315, "$NPCName says, 'Alright, $name. Please tell me when you are ready to [" . quest::saylink("go") . "].'");
 }
 #:: Match if the data bucket exists for this zone shortname
 elsif (quest::get_data($key) eq "$Data[0]") {
 #:: Key a data bucket to pull the instance ID
 $key = $client->CharacterID() . "-active-instance-id";
 #:: Update the scalar variable
 $InstanceID = quest::get_data($key);
 $client->Message(315, "$NPCName says, 'Alright, $name. Please tell me when you are ready to [" . quest::saylink("go") . "].'");
 }
 #:: Match if the data bucket exists but is set to a different zone
 else {
 $CharInstance = quest::get_data($key);
 $client->Message(315, "$NPCName says, 'Sorry $name, but it looks like you already have an instance for" . $CharInstance . ". Would you like to [" . quest::saylink("delete") . "] it for" . $cost / 1000 . " platinum pieces?'");
 }
 }
 #:: Match if the person talking rudely interrupted
 else {
 $Name = quest::get_data($key);
 quest::say("I am sorry, $name, but I was right in the middle of speaking with " . $Name . ". Is " . $Name . " [" . quest::saylink("gone") . "]?");
 }
 }
 elsif ($text=~/go/i) {
 #:: Key a data bucket to protect functions
 $key = $NPCName . "-current-name";
 #:: Match if the person talking is the focus of our attention
 if (quest::get_data($key) eq "$name") {
 #:: Key a data bucket to check for existing instances
 $key = $client->CharacterID() . "-active-instance-zone";
 #:: Match if the data bucket exists and matches zone data
 if (quest::get_data($key) eq "$Data[0]") {
 DoTeleport();
 }
 else {
 $client->Message(315, "$NPCName says, 'I am sorry, $name...I seem to have lost my train of thought. Where did you want to go again?");
 #:: Speak the elements of the zone array
 my $count = 1;
 my $n = 0;
 while ($ZoneArray[$n]) {
 if ($ZoneArray[$n]) {
 my $ZoneName = quest::saylink($ZoneArray[$n]);
 $client->Message(315, "$NPCName says, 'Would you like to go to $ZoneName?'");
 }
 $n++;
 $count++;
 }
 }
 }
 #:: Match if the person talking rudely interrupted
 else {
 $Name = quest::get_data($key);
 quest::say("I am sorry, $name, but I was right in the middle of speaking with " . $Name . ". Is " . $Name . " [" . quest::saylink("gone") . "]?");
 }

 }
 elsif ($text=~/delete/i) {
 #:: Key a data bucket to protect functions
 $key = $NPCName . "-current-name";
 #:: Match if the person talking is the focus of our attention
 if (quest::get_data($key) eq "$name") {
 #:: Create a scalar variable to store total money on the player who triggered the event
 my $total = $client->GetCarriedMoney();
 #:: Match if the player who triggered the event has the same or more coin than the reset costs
 if ($total >= $cost) {
 #:: Key a data bucket to check for existing instances by zone
 $key = $client->CharacterID() . "-active-instance-zone";
 #:: Match if the data bucket exists
 if (quest::get_data($key)) {
 #:: Destroy the data bucket
 quest::delete_data($key);
 #:: Key a data bucket to check for existing instances by ID
 $key = $client->CharacterID() . "-active-instance-id";
 #:: Match if the data bucket exists
 if (quest::get_data($key)) {
 #:: Destroy the data bucket just to be tidy
 quest::delete_data($key);
 }
 #:: Take the coins and update the client
 $client->TakeMoneyFromPP($cost, 1);
 $client->Message(315, "$NPCName says, 'Easy come, easy go, right $name? You are now free to [" . quest::saylink("teleport") . "] wherever you would like to go.'");
 }
 else {
 $client->Message(315, "$NPCName says, 'You have no instances, $name. You are free to [" . quest::saylink("teleport") . "] wherever you would like to go.'");
 }
 }
 else {
 $client->Message(315, "$NPCName says, 'Sorry, $name, but you do not have the coins required to reset an instance.'");
 }
 }
 #:: Match if the person talking rudely interrupted
 else {
 $Name = quest::get_data($key);
 quest::say("I am sorry, $name, but I was right in the middle of speaking with " . $Name . ". Is " . $Name . " [" . quest::saylink("gone") . "]?");
 }
 }
}

sub EVENT_ITEM {
 #:: Return unused items
 plugin::returnUnusedItems();
}

sub DoTeleport {
 quest::say("Zone: " . $Data[0] . ", Instance ID: $InstanceID, Zone ID: " . $Data[1] . ", X: " . $Data[2] . ", Y: " . $Data[3] . ", Z: " . $Data[4] . ".");
 #:: Assign to an instance
 quest::AssignToInstance($InstanceID);
 #:: Create a scalar variable to store client Raid information
 $raid = $entity_list->GetRaidByClient($client);
 #:: Create a scalar variable to store client Group information
 $group = $entity_list->GetGroupByClient($client);
 #:: Move the client who triggered the event to the specified location
 $client->MovePCInstance($Data[1], $InstanceID, $Data[2], $Data[3], $Data[4], 0);
 #:: Match if the player is in a Raid
 if ($raid) {
 #:: Loop through each member of the Raid
 for ($count = 0; $count < $raid->RaidCount(); $count++) {
 #:: Create a scalar variable to store the Raid's member count
 $pc = $raid->GetMember($count);
 #:: Match if the Raid member is near the client who triggered the event
 if ($pc->CalculateDistance($x,$y,$z) <= 150) {
 #:: Assign to the instance
 $pc->AssignToInstance($InstanceID);
 #:: Move the Raid member to the specified location
 $pc->MovePCInstance($Data[1], $InstanceID, $Data[2], $Data[3], $Data[4], 0);
 }
 }
 }
 #:: Match if the player is in a Group
 elsif ($group) {
 #:: Loop through each member of the Group
 for ($count = 0; $count < $group->GroupCount(); $count++) {
 #:: Create a scalar variable to store the Group's member count
 $pc = $group->GetMember($count);
 #:: Match if the Group member is near the client who triggered the event
 if ($pc->CalculateDistance($x,$y,$z) <= 150) {
 #:: Assign to the instance
 $pc->AssignToInstance($InstanceID);
 #:: Move the Group member to the specified location
 $pc->MovePCInstance($Data[1], $InstanceID, $Data[2], $Data[3], $Data[4], 0);
 }
 }
 }
 #:: Key a data bucket to protect functions
 $key = $NPCName . "-current-name";
 #:: Destroy the data bucket
 quest::delete_data($key);
}
`
```

---

## Using Data Buckets

*Source: server/scripting/using-data-buckets/index.html*

# Using Data Buckets¶

## What are Data Buckets?¶

- Data buckets are a replacement to the well-known `qglobals`, but they are far more performant, reliable and simpler to use

- You can use data buckets to store values unique to anything you would like, for example

- Bot based flags

- Character based flags 

- NPC based flags

- Zone based flags

- etc.

## Functions¶

Data buckets exist in these 6 main functions in both Perl and Lua.

### Perl¶

```
`quest::delete_data(bucket_key);
quest::get_data(bucket_key);
quest::set_data(bucket_key, bucket_value, expires_in);

$mob->DeleteBucket(bucket_key);
$mob->GetBucket(bucket_key);
$mob->SetBucket(bucket_key);
`
```

### Lua¶

```
`eq.delete_data(bucket_key);
eq.get_data(bucket_key);
eq.set_data(bucket_key, bucket_value, expires_in);

mob:DeleteBucket(bucket_key);
mob:GetBucket(bucket_key);
mob:SetBucket(bucket_key, bucket_value, expires_in);
`
```

There are also 4 secondary functions in both Perl and Lua.

### Perl¶

```
`quest::get_data_expires(bucket_key);
quest::get_data_remaining(bucket_key);

$mob->GetBucketExpires(bucket_key);
$mob->GetBucketRemaining(bucket_key);
`
```

### Lua¶

```
`eq.get_data_expires(bucket_key);
eq.get_data_remaining(bucket_key);

mob:GetBucketExpires(bucket_key);
mob:GetBucketRemaining(bucket_key);
`
```

## Storage¶

- Data buckets are stored in the [[data_buckets]] table and has a very simple structure

| 

Column 
| Description 

| id 
| Unique Data Bucket Identifier 

| key 
| Unique Data Bucket Key 

| value 
| Data Bucket Value 

| expires 
| Data Bucket Expiration (UNIX Timestamp) 

| character_id 
| Character Identifier 

| npc_id 
| NPC Identifier 

| bot_id 
| Bot Identifier 

- Expired data bucket rows will not be queryable via the quest API, they may exist in a table until 5-10 minutes have past and the server will garbage collect and wipe the table clean of expired buckets

## Usage Examples¶

### Perl¶

- In this example you can see that we are doing the following:

- Keying by character ID to set the flag to make this unique per player

- Setting it with the value of 70

- Leaving out the duration parameter means the bucket never expires

```
`if ($text =~/character-flag-test/i) {
 my $bucket_key = $client->CharacterID() . "-epic-points";
 quest::set_data($bucket_key, 70);

 my $bucket_value = quest::get_data($bucket_key);
 quest::say("You have traveled far! You have a mighty ($bucket_value) epic points!");
}
`
```

### Lua¶

- In this example you can see that we are doing the following:

- Setting a global flag

- Immediately accessing it

- Deleting it

- Trying to unsuccessfully access it again because the bucket data had already been deleted

```
`if (e.message:findi("test")) then
 e.self:Say("This is a test!")

 eq.set_data("lua_test_key", "lua_value");

 e.self:Say("We just set some bucket data with '".. eq.get_data("lua_test_key") .. "'");

 eq.delete_data("lua_test_key");

 e.self:Say("I'm going to try and access the value again... '".. eq.get_data("lua_test_key") .. "'");
end
`
```

## Ways to Key Buckets¶

Keying is simply a way to uniquely identify a flag, if you want to make some data unique to a player, then you would need something to key uniquely to that player, such as their **character_id**.
If you wanted to set a flag uniquely for a NPC for example, you could use the **npc_type_id**, for a zone you could use the **zone_id**.
All of these circumstances are completely up to you and you have the entire Quest API to grab something that can make something unique!

Some of the examples below should give you some ideas!

**By Character**

Manual Keying

```
`my $bucket_key = $client->CharacterID() . "-some-flag";
my $bucket_value = 70;
quest::set_data($bucket_key, $bucket_value);
`
```

Automatic Keying

```
`my $bucket_key = "some-flag";
my $bucket_value = 70;
$client->SetBucket($bucket_key, $bucket_value);
`
```

**By Door (And Zone)**

```
`sub EVENT_CLICKDOOR {
 quest::say($doorid);
 if ($doorid == 4) {
 my $bucket_key = "$zoneid-$doorid-last-person-to-click-door";
 my $bucket_value = $client->GetCleanName();

 if (quest::get_data($bucket_key)) {
 $client->Message(15, "You know... the last person to click this door was '" . quest::get_data($bucket_key) . "'");
 }

 quest::set_data($bucket_key, $bucket_value);
 }
}
`
```

**Result**

**Database Result**

**By NPC**

Manual Keying

```
`sub EVENT_DEATH_COMPLETE {
 my $bucket_key = $npc->GetNPCTypeID() . "-death-count";
 quest::set_data($bucket_key, quest::get_data($bucket_key) + 1);

 my $death_count = quest::get_data($bucket_key);
 quest::shout("Man! I've died ($death_count) times in my lifetime!");
}
`
```

Automatic Keying

```
`sub EVENT_DEATH_COMPLETE {
 my $bucket_key = "death-count";
 $npc->SetBucket($bucket_key, $npc->GetBucket($bucket_key) + 1);

 my $death_count = $npc->GetBucket($bucket_key);
 quest::shout("Man! I've died ($death_count) times in my lifetime!");
}
`
```

**Result**

**Database**

### Automatically Keying Buckets¶

- Automatic keying is a `Mob` only thing, you will still have to manually key anything else.

- These methods automatically grab set columns based on Mob type.

- Bots use `bot_id`

- Clients use `character_id`

- 

NPCs use `npc_id`

- 

DeleteBucket(bucket_key)

- GetBucket(bucket_key)

- GetBucketExpires(bucket_key)

- GetBucketRemaining(bucket_key)

- SetBucket(bucket_name, bucket_value, expires_in)

## Expiration Examples¶

- Below in this Lua example we will count the number of times a player has talked to an NPC, first by checking if we've got a bucket set at all, if not we will set an expiration time on it. Each time we call set_data, it will not over-ride the original expiration time unless we pass a new time parameter

```
`function event_say(e)
 if (e.message:findi("hail")) then
 -- Set unique key for the bucket
 local key = e.other:GetCleanName() .. "_times_talked";

 -- If the bucket is empty, we need to set it
 -- The first time we will set an expiration on this (86400 seconds)
 if (eq.get_data(key) == "") then
 eq.set_data(key, '1', 86400);
 end

 local times_talked = tonumber(eq.get_data(key));

 e.self:Say("You know... You've talked to me " .. times_talked .. " time(s) today, get a life will ya!");

 -- Increment times talked
 eq.set_data(key, tostring(times_talked + 1));
 end

end
`
```

**Result**

**Database**

### Acceptable Time Formats¶

We have the ability to use time shorthands if need-be, the following are acceptable time inputs

| 

Input 
| Time Result 

| 15s 
| 15 seconds 

| s15 
| 15 seconds 

| 60m 
| 60 minutes 

| 7d 
| 7 days 

| 1y 
| 1 year 

| 600 
| 600 seconds 

### Perl Expiration¶

- To set an expiration time in Perl, very similarly to the Lua example above, you would simply call your `set_data()` or `SetBucket()` function with an expiration flag as your 3rd parameter like so

Manual Keying

```
`my $bucket_key = $client->CharacterID() . "-example-flag";
quest::set_data($bucket_key, "some_value", 3600); # 3600 seconds = 1 hour (Expire in 1 hour)
`
```

Automatic Keying

```
`my $bucket_key = "example-flag";
$client->SetBucket($bucket_key, "some_value", 3600); # 3600 seconds = 1 hour (Expire in 1 hour)
`
```

## Benchmarks¶

- Below are some simple benchmarks used to calculate performance. While even these numbers could be greatly optimized yet, these are plenty good for most use cases that server operators need. If you need even faster temporary data storage within the context of a zone, I would suggest using [[Entity Variables]] as they operate purely in memory

```
`sub EVENT_SAY {
 use Time::HiRes;
 my $start = [ Time::HiRes::gettimeofday() ];

 if ($text=~/random-write/i) {
 my $iterations = 1000;
 my $key_range = 100;
 quest::debug("Testing random-write... Iterations: (" . plugin::commify($iterations) . ") Key Range: " . $key_range);
 for ($i = 0; $i < $iterations; $i++) {
 quest::set_data("key_" . int(rand($key_range)), &generate_random_string(100));
 }
 } elsif ($text=~/sequential-write/i) {
 my $iterations = 1000;
 quest::debug("Testing sequential-write... Iterations: (" . plugin::commify($iterations) . ")");
 for ($i = 0; $i < $iterations; $i++) {
 quest::set_data("key_" . $i, &generate_random_string(100), 15);
 }
 } elsif ($text=~/sequential-read/i) {
 my $iterations = 1000;
 quest::debug("Testing sequential-read... Iterations: (" . plugin::commify($iterations) . ")");
 for ($i = 0; $i < $iterations; $i++) {
 $data = quest::get_data("key_" . $i);
 # if ($data ne "") {
 # quest::say("Data for $i : $data");
 # }
 }
 } elsif ($text=~/random-read/i) {
 my $iterations = 1000;
 quest::debug("Testing random-read... Iterations: (" . plugin::commify($iterations) . ")");
 for ($i = 0; $i < $iterations; $i++) {
 $data = quest::get_data("key_" . int(rand($iterations)));
 }
 }

 my $elapsed = Time::HiRes::tv_interval($start);
 quest::debug("Operation took: " . $elapsed);
}
`
```

## Practical Example¶

In South Qeynos, you will find an NPC named Vicus Nonad. Vicus is a tax collector, but because of his terrible cold, he needs a player to help make the rounds to collect taxes. The early implementation of this quest script utilized quest globals, and below is an example of replacing the quest global functionality with Data Buckets.

Vicus_Nonad.pl

```
`sub EVENT_SPAWN {
 #:: Set a timer "cough" to repeat every 350 seconds (5 min 50 sec)
 quest::settimer("cough", 350);
}

sub EVENT_TIMER {
 #:: Match the "cough" timer
 if ($timer eq "cough") {
 quest::emote("coughs and wheezes.");
 }
}

sub EVENT_SAY {
 if ($text=~/hail/i) {
 my $cough_link = quest::saylink("cough");
 quest::say("Greetings, $name.My name is Vicus Nonad. <cough>I am the official tax collector for the fine city of Qeynos. <cough>I serve the will of Antonius Bayle, our glorious leader. <cough><cough>Please excuse my [$cough_link]. <cough>");
 } elsif ($text=~/cough/i) {
 my $help_link = quest::saylink("help with today's collections");
 quest::say("Oh, <cough> I am sorry, but it seems I have fallen a bit ill. I was caught out in the rain the other day and my chills have gotten the best of me. <cough> If only someone would [$help_link].. <cough>");
 } elsif ($text=~/help with today's collections/i) {
 #:: Data bucket to verify quest has been started appropriately
 my $bucket_key = $client->CharacterID() . "-tax-collection";

 #:: Set a data bucket, quest started
 quest::set_data($bucket_key, 1);

 my $list_link = quest::saylink("link");
 quest::say("Oh thank <cough> you so <cough> <cough> much <cough>.. Here is the official collection box. Please collect from each merchant on the <cough> [$list_link]. Then bring me back the combined total of all your collections.");
 #:: Give a 17012 - Tax Collection Box
 quest::summonitem(17012);
 } elsif ($text=~/list/i) {
 quest::say("Oh. <cough>I am sorry.. I forgot to give it to you. Here you go. Be sure to give that back when your job is finished. <cough>");
 #:: Give a 18009 - List of Debtors
 quest::summonitem(18009);
 }
}

sub EVENT_ITEM {
 #:: Match a 18009 - List of Debtors and 13181 - Full Tax Collection Box
 if (plugin::takeItems(13181 => 1, 18009 => 1)) {
 quest::say("<cough> Great! Thank you so much. Here is a small gratuity for a job well done. Thank you again. <cough> Antonius Bayle and the People of Qeynos appreciate all yo have done.");
 #:: Delete the data bucket
 $bucket_key = $client->CharacterID() . "-tax-collection";
 quest::delete_data($bucket_key);
 #:: Give a random reward: 13053 - Brass Ring, 10010 - Copper Amulet, 10018 - Hematite, 10017 - Turquoise
 quest::summonitem(quest::ChooseRandom(13053, 10010, 10018, 10017));
 #:: Ding!
 quest::ding();
 #:: Set factions
 quest::faction(219,10); #:: + Antonius Bayle
 quest::faction(262,4); #:: + Guards of Qeynos
 quest::faction(304,-5); #:: - Ring of Scale
 quest::faction(273,-10); #:: - Kane Bayle
 quest::faction(291,10); #:: + Merchants of Qeynos
 #:: Grant a small amount of experience
 quest::exp(500);
 #:: Create a hash for storing cash - 200 to 300cp
 my %cash = plugin::RandomCash(200,300);
 #:: Grant a random cash reward
 quest::givecash($cash{copper},$cash{silver},$cash{gold},$cash{platinum});
 }
 #:: Match a 13181 - Full Tax Collection Box
 elsif (plugin::takeItems(13181 => 1)) {
 quest::say("Very good <cough> work. But I need both the full tax collection box and the list of debtors. You did get the [" . quest::saylink("list") . "] from me before you left, right? <cough>");
 #:: Return a 13181 - Full Tax Collection Box
 quest::summonitem(13181);
 }
 #:: Match a 18009 - List of Debtors
 elsif (plugin::takeItems(18009 => 1)) {
 quest::say("Very good <cough> work. But I need both the full tax collection box and the list of debtors. You did get the [" . quest::saylink("list") . "] from me before you left, right? <cough>");
 }
 #:: Return unused items
 plugin::returnUnusedItems();
}
`
```

Above, we see the implementation of the Data Bucket Key. This replaces the use of `quest::setglobal`. In the Database, we see the corresponding key:

Note that we clean up the key upon handing in the requisite tax money and list with the following (line 41 above):

Manual Keying

```
`my $bucket_key = $client->CharacterID() . "-tax-collection";
quest::delete_data($bucket_key);
`
```

Automatic Keying

```
`my $bucket_key = "tax-collection";
$client->DeleteBucket($bucket_key);
`
```

The original portion of the script for the Quest Global would have been as follows:

```
`#:: Match for "help", case insensitive
elsif ($text=~/help/i) {
 quest::say("Oh thank <cough> you so <cough> <cough> much <cough>.. Here is the official collection box. Please collect from each merchant on the <cough> [list]. Then bring me back the combined total of all your collections.");
 #:: Give a 17012 - Tax Collection Box
 quest::summonitem(17012);
 #:: Set the qglobal "tax_collection", to a value of "0", for all NPCs and Zones, and last forever
 quest::setglobal("tax_collection", 0, 5, "F");
}
`
```

While this implementation may seem to be easier, it should be noted that on a server with many players, running a query through a hash of globals for each event that triggers a look up can cause serious performance issues. Imagine a hash being created for every global qglobal entry (the "5" in the script above), for EVERY event trigger!

Our intrepid adventurer is required to do this quest in order, by speaking with Vicus prior to the merchants in Qeynos who have to pay taxes. To enforce this, we verify that the user has the appropriate data bucket key set (line 9) before offering the dialogue that results in the tax payment:

Mar_Sedder.pl

```
`sub EVENT_SAY {
 if ($text=~/hail/i) {
 quest::say("Hail, $name. What brings you to the Tin Soldier? We have the finest in previously owned weapons and armor. Feel free to browse.");
 } elsif ($text=~/tax collection/i) {
 #:: Match if the key exists
 if ($client->GetBucket("tax-collection") {
 quest::say("Here are the taxes, $name. Boy, you call the guards and they take their time to show up but be a few days late on your taxes and they send the goons after you. Sheesh!");
 #:: Give a 13171 - Sedder's Tax Payment
 quest::summonitem(13171);
 #:: Set faction
 quest::faction(291,-1); #:: - Merchants of Qeynos
 }
 }
}

sub EVENT_ITEM {
 #:: Return unused items
 plugin::returnUnusedItems();
}
`
```

## Scaling Heroic Stat Bonuses via Data Buckets¶

The rule `Character, HeroicStatsUseDataBucketsToScale` Allows scaling the benefits a Player or Bot receives from Heroic Stats using Data Buckets. This works with other multipliers, as long as a valid data bucket is applied to the character.

Below are valid keys that can be used, and the benefit given if keyed with a value of "1.00" or "1".

| 

Bucket Key "character-id-KEY" 
| Description assuming Bucket Value of "1.00" 

| **HSTR-MeleeDamage** 
| 1 melee damage per 10 Heroic Strength. 

| **HSTR-ShieldAC** 
| 1 Shield AC per 10 Heroic Strength. 

| **HSTR-MaxEndurance** 
| 2.5 Base Endurance per every 1 Heroic Strength. 

| **HSTR-EnduranceRegen"** 
| 0.05 Endurance Regen per 10 Heroic Strength. 

| 
| 

| **HSTA-MaxHP** 
| 10 HP per 1 Heroic Stamina. 

| **HSTA-HPRegen** 
| 0.5 HP Regen per 10 Heroic Stamina. 

| **HSTR-MaxEndurance** 
| 2.5 Base Endurance per every 1 Heroic Stamina. 

| **HSTA-EnduranceRegen** 
| 0.05 Endurance Regen per 10 Heroic Stamina. 

| 
| 

| **HAGI-Avoidance** 
| 1 Avoidance per 10 Heroic Agility. 

| **HAGI-MaxEndurance** 
| 2.5 Base Endurance per every 1 Heroic Agility. 

| **HAGI-EnduranceRegen** 
| 0.05 Endurance Regen per 10 Heroic Agility. 

| 
| 

| **HDEX-RangedDamage** 
| 1 Ranged Damage per 10 Heroic Dexterity. 

| **HDEX-MaxEndurance** 
| 2.5 Base Endurance per every 1 Heroic Dexterity. 

| **HDEX-EnduranceRegen** 
| 0.05 Endurance Regen per 10 Heroic Dexterity. 

| 
| 

| **HINT-SpellDmg** 
| 1 Spell Damage per 1 Heroic Intelligence. 

| **HINT-MaxMana** 
| 250 Base Mana per every 25 Heroic Intelligence. 

| **HINT-ManaRegen** 
| 1 Mana Regen/Regen Cap per 25 Heroic Intelligence. 

| 
| 

| **HWIS-HealAmt** 
| 1 Heal Amount per 1 Heroic Wisdom. 

| **HWIS-MaxMana** 
| 250 Base Mana per every 25 Heroic Wisdom. 

| **HWIS-ManaRegen** 
| 1 Mana Regen/Regen Cap per 25 Heroic Wisdom. 

## Practical Example¶

Say we want a player to receive 10 melee damage per 10 Heroic Strength, we would set a bucket as follows:

```
`my $bucket_key = "HSTR-MeleeDamage";
$client->SetBucket($bucket_key, 10.00);
`
```

---

## Aura Movement Types

*Source: server/spells/aura-movement-types/index.html*

# Aura Movement Types¶

| 

Aura Movement Type ID 
| Aura Movement Type Name 

| 0 
| Follow 

| 1 
| Stationary 

| 2 
| Pathing 

| 3 
| Max

---

## Aura Spawn Types

*Source: server/spells/aura-spawn-types/index.html*

# Aura Spawn Types¶

| 

Aura Spawn Type ID 
| Aura Spawn Type Name 

| 0 
| Group Members 

| 1 
| Everyone 

| 2 
| No One 

| 3 
| Max

---

## Aura Types

*Source: server/spells/aura-types/index.html*

# Aura Types¶

| 

Aura Type ID 
| Aura Type Name 

| 0 
| On All Friendlies 

| 1 
| On All Group Members 

| 2 
| On Group Members' Pets 

| 3 
| Totem 

| 4 
| Enter Trap 

| 5 
| Exit Trap 

| 6 
| Fully Scripted 

| 7 
| Max

---

## Base Value Formulas

*Source: server/spells/base-value-formulas/index.html*

# Base Value Formulas¶

| 

Base Formula 
| Formula 

| 1 
| Effect Base + Level * Multiplier 

| 60 
| Effect Base / 100 

| 100 
| Effect Base Value 

| 101 
| Effect Base + Level / 2 

| 102 
| Effect Base + Level, 

| 103 
| Effect Base + Level * 2 

| 104 
| Effect Base + Level * 3 

| 105 
| Effect Base + Level * 4 

| 107 
| Effect Base + Level / 2 

| 108 
| Effect Base + Level / 3 

| 109 
| Effect Base + Level / 4 

| 110 
| Effect Base + Level / 5 

| 111 
| Effect Base + 6 * (Level - Spell Level) 

| 112 
| Effect Base + 8 * (Level - Spell Level) 

| 113 
| Effect Base + 10 * (Level - Spell Level) 

| 114 
| Effect Base + 15 * (Level - Spell Level) 

| 115 
| Effect Base + 6 * (Level - Spell Level) 

| 116 
| Effect Base + 8 * (Level - Spell Level) 

| 117 
| Effect Base + 12 * (Level - Spell Level) 

| 118 
| Effect Base + 20 * (Level - Spell Level) 

| 119 
| Effect Base + Level / 8 

| 121 
| Effect Base + Level / 3 

| 122 
| Splurt 

| 123 
| Random (Effect Base, Effect Max) 

| 203 
| Effect Ma

---

## Blocked Spell Types

*Source: server/spells/blocked-spell-types/index.html*

# Blocked Spell Types¶

| 

Blocked Spell Type ID 
| Blocked Spell Type Name 

| 1 
| Zone-wide 

| 2 
| Region

---

## Bot Spell List IDs

*Source: server/spells/bot-spell-list-ids/index.html*

# Bot Spell List IDs¶

| 

Bot Spell List ID 
| Bot Spell List Name 

| 3001 
| Warrior 

| 3002 
| Cleric 

| 3003 
| Paladin 

| 3004 
| Ranger 

| 3005 
| Shadow Knight 

| 3006 
| Druid 

| 3007 
| Monk 

| 3008 
| Bard 

| 3009 
| Rogue 

| 3010 
| Shaman 

| 3011 
| Necromancer 

| 3012 
| Wizard 

| 3013 
| Magician 

| 3014 
| Enchanter 

| 3015 
| Beastlord 

| 3016 
| Berserker

---

## Buff Duration Formulas

*Source: server/spells/buff-duration-formulas/index.html*

# Buff Duration Formulas¶

| 

Buff Duration Formula ID 
| Buff Duration Calculation Method. Resulting values represent duration time in "ticks". 

| 0 
| Not a Buff 

| 
| **For the following, if the specified buffduration is less than the calculated value, buffduration will be used instead, meaning buffduration serves a cap rather than a raising the duration to a minimum amount of time. 
"Level" refers to the level of the caster. 
Be sure to account for parentheses (or lack of parentheses). What you see below is exactly as coded.** 

| 1 
| level / 2 

| 2 
| If level > 3, then level / 2 + 5, otherwise 6 

| 3 
| 30 * level 

| 4 
| 50 

| 5 
| 2 

| 6 
| level / 2 + 2 

| 7 
| level 

| 8 
| level + 10 

| 9 
| 2 * level + 10 

| 10 
| 3 * level + 10 

| 11 
| 30 * (level + 3) 

| 12 
| If level > 7, then level / 4, otherwise 1 

| 13 
| 4 * level + 10 

| 14 
| 5 * (level + 2) 

| 15 
| 10 * (level + 10) 

| Any other formula under 200 
| Ignored 

| Any formula 200 or above 
| If duration > formula, then formula, otherwise duration. 

| 3600 
| Duration if not 0, else 3600 

| 
| **The following are fixed and do not use any calculations.** 

| 50 
| 5 Days 

| 51 
| Permanent 

# Making Fixed-Length Buffs¶

If your desired buffduration is 200 ticks or longer, set buffduration to 0 and put the tick value in the buffdurationformula column instead.
If your desired buffduration is under 200, set the buffdurationformula to 200 and the buffduration to your desired tick value.

For your convenience, here are some standard tick values.

| 

Duration 
| Ticks 

| 5 minutes 
| 50 

| 10 minutes 
| 100 

| 15 minutes 
| 150 

| 30 minutes 
| 300 

| 45 minutes 
| 450 

| 60 minutes 
| 600 

| 90 minutes 
| 900 

| 2 hours 
| 1200 

| 3 hours 
| 1800 

| 4 hours 
| 2400 

| 5 hours 
| 3000 

| 6 hours 
| 3600

---

## Client Spell ID Limitations

*Source: server/spells/client-spell-id-limitations/index.html*

# Client Spell ID Limitations¶

If you make ANY changes to the spells on your server, you will have to generate a new `spells_us.txt` file. It is important to note that your database probably has MANY spells inside, as EQEmu attempts to support all of the spells that are available. 

Info

If you're creating your own `spells_us.txt` file, please make sure that the maximum id of the spells in your `spells_new` database table is below the value listed below.

| 

**Client** 
| **Max Spell ID** 

| Titanium 
| 9,999 

| Secrets of Faydwer 
| 15,999 

| Seeds of Destruction 
| 23,000 

| Underfoot 
| 28,000 

| Rain of Fear 
| 45,000 

| Rain of Fear 2 
| 45,000 

| The Darkend Sea (not yet supported) 
| 50,000 

To generate your new `spells_us.txt` file:

1.) Go to your server directory (Linux example below):

```
`cd /home/eqemu/server
`
```

2.) Create an `export` directory (you only need to do this the first time):

```
`mkdir export
`
```

3.) Run the `export_client_files` binary:

```
`./export_client_files
`
```

You should then find a copy of the exported client files in your `export` directory:

---

## Damage Shield Types

*Source: server/spells/damage-shield-types/index.html*

# Damage Shield Types¶

| 

**Field** 
| **Type** 
| **Null** 
| **Key** 
| **Default** 
| **Notes** 

| spellid 
| int(10) unsigned 
| NO 
| PRI 
| 0 
| 

| type 
| tinyint(3) unsigned 
| NO 
| 
| 0 
| 

**spellid**

- Corresponding spell in [[spells_new]]

**type**

- DS_DECAY = 244,

- DS_CHILLED = 245,

- DS_FREEZING = 246,

- DS_TORMENT = 247,

- DS_BURN = 248,

- DS_THORNS = 249

---

## Damage Shield Types

*Source: server/spells/damage-shield-types-1/index.html*

# Damage Shield Types¶

| 

Damage Shield Type ID 
| Damage Shield Type Name 

| 244 
| Decay 

| 245 
| Chilled 

| 246 
| Freezing 

| 247 
| Torment 

| 248 
| Burn 

| 249 
| Thorns

---

## Element Types

*Source: server/spells/element-types/index.html*

# Element Types¶

| 

**Element Type ID** 
| **Element Type** 

| 1 
| Magic 

| 2 
| Fire 

| 3 
| Cold 

| 4 
| Poison 

| 5 
| Disease

---

## Environment Types

*Source: server/spells/environment-types/index.html*

# Environment Types¶

| 

Environment Type ID 
| Environment Type Name 

| 0 
| Everywhere 

| 12 
| Cities 

| 24 
| Planes

---

## GetSpellStat Identifiers

*Source: server/spells/getspellstat-identifiers/index.html*

# GetSpellStat Identifiers¶

Slots are based on type, some have only one slot and it does not need to be specified to the method.

| 

Identifier 
| Slots 

| classes 
| 16 

| deities 
| 16 

| base 
| 12 

| base2 
| 12 

| max 
| 12 

| formula 
| 12 

| effectid 
| 12 

| components 
| 4 

| component_counts 
| 4 

| NoexpendReagent 
| 4 

| range 
| 1 

| aoerange 
| 1 

| pushback 
| 1 

| pushup 
| 1 

| cast_time 
| 1 

| recovery_time 
| 1 

| recast_time 
| 1 

| buffdurationformula 
| 1 

| buffduration 
| 1 

| AEDuration 
| 1 

| mana 
| 1 

| goodEffect 
| 1 

| Activated 
| 1 

| resisttype 
| 1 

| targettype 
| 1 

| basediff 
| 1 

| skill 
| 1 

| zonetype 
| 1 

| EnvironmentType 
| 1 

| TimeOfDay 
| 1 

| CastingAnim 
| 1 

| SpellAffectIndex 
| 1 

| disallow_sit 
| 1 

| uninterruptable 
| 1 

| ResistDiff 
| 1 

| `dot_stacking_exempt` 
| 1 

| RecourseLink 
| 1 

| `no_partial_resist` 
| 1 

| `short_buff_box` 
| 1 

| descnum 
| 1 

| effectdescnum 
| 1 

| `npc_no_los` 
| 1 

| reflectable 
| 1 

| bonushate 
| 1 

| EndurCost 
| 1 

| EndurTimerIndex 
| 1 

| IsDisciplineBuff 
| 1 

| HateAdded 
| 1 

| EndurUpkeep 
| 1 

| numhitstype 
| 1 

| numhits 
| 1 

| pvpresistbase 
| 1 

| pvpresistcalc 
| 1 

| pvpresistcap 
| 1 

| spell_category 
| 1 

| can_mgb 
| 1 

| dispel_flag 
| 1 

| MinResist 
| 1 

| MaxResist 
| 1 

| viral_targets 
| 1 

| viral_timer 
| 1 

| NimbusEffect 
| 1 

| directional_start 
| 1 

| directional_end 
| 1 

| not_focusable 
| 1 

| suspendable 
| 1 

| viral_range 
| 1 

| spellgroup 
| 1 

| rank 
| 1 

| no_resist 
| 1 

| CastRestriction 
| 1 

| AllowRest 
| 1 

| InCombat 
| 1 

| OutofCombat 
| 1 

| aemaxtargets 
| 1 

| `no_heal_damage_item_mod` 
| 1 

| persistdeath 
| 1 

| min_dist 
| 1 

| `min_dist_mod` 
| 1 

| max_dist 
| 1 

| min_range 
| 1 

| DamageShieldType 
| 1

---

## Illusion Spell Guidelines

*Source: server/spells/illusion-spell-guidelines/index.html*

# Illusion Spell Guidelines¶

Illusion Spells follow a couple different rules.

These are influenced by spell base, limit, and max values.

### Gender-Inspecific Illusions¶

If an Illusion Spell has a max value of 0 on the Illusion effect ID we use the base value as the Race ID, assume the gender using a source method, use the limit value as texture, and the max value as helmtexture.

Example Spell is Illusion: Human (582).

### Gender-Specific Illusions¶

If an Illusion Spell has a max value greater than 0 on the Illusion effect ID we check if the limit value is 0, if it is we use the base value as the Race ID and the max value minus 1 as the gender, texture and helmtexture are assumed.

- 1 is Male

- 2 is Female

- 3 is Neuter

Example Spell is Illusion: Male (1732).

### Gender and Texture Specific Spells¶

If an Illusion Spell has a max value greater than 0 on the Illusion effect ID and the limit value is not 0, we then check if the max value is not equal to 3, if it's not equal to 3 we use the base value as the Race ID, the max value minus 1 as the gender, the limit value as texture, and the max value as helmtexture.

Example Spell is Illusion: Runic Tattoo Nihil Male (33575).

### Gender, Texture, and Helmtexture Specific Spells¶

If an Illusion Spell has a max value greater than 0 and equal to 3, we use the base value as the Race ID, assume the gender using a source method, use the limit value as texture and helmtexture.

Example Spell is Illusion: Rallosian Goblin (32787).

---

## Spells

*Source: server/spells/index.html*

# Spells¶

## Getting Started¶

So you would like to understand spells? It's a bit of a journey, so let's get started.

There are tens of thousands of records in your spells_new table, and making sense of them all can be a little daunting (at least at first).

Each spell has MANY fields related to it--and you're probably wondering what all of these fields do. You may even be up against some Client Limitations, or perhaps you've just discovered that AAs are actually spells! Don't get too worked up!! (╯°□°）╯彡 ┻━┻

We'll explore these topics below.

### Slots¶

The first concept is that many fields are related to each other. We have commonly referred to these related fields as "Slots", and most understand the concept that slots are somehow related. There are 12 of these slots available, and the values in your database determine what happens when the spell is cast.

It might be easiest to view in simplified table, rather than as a series of fields. It will also be useful to disregard many of the fields so that we can focus on understanding the mechanics of the spell, before we try to understand all of the fields in the spells_new database table. Below is a simplified table of the spell "Greater Healing", that has a default Spell ID of 15:

| 

**Slot** 
| **Effect ID** 
| **Effect Base Value** 
| **Max** 
| **Formula** 

| 1 
| 0 
| 140 
| 300 
| 7 

| 2 
| 254 
| 0 
| 0 
| 100 

| 3 
| 254 
| 0 
| 0 
| 100 

| 4 
| 254 
| 0 
| 0 
| 100 

| 5 
| 254 
| 0 
| 0 
| 100 

| 6 
| 254 
| 0 
| 0 
| 100 

| 7 
| 254 
| 0 
| 0 
| 100 

| 8 
| 254 
| 0 
| 0 
| 100 

| 9 
| 254 
| 0 
| 0 
| 100 

| 10 
| 254 
| 0 
| 0 
| 100 

| 11 
| 254 
| 0 
| 0 
| 100 

| 12 
| 254 
| 0 
| 0 
| 100 

This simplified table shows that Slot 1 is where all the action is in the Greater Healing spell. Slots 2-12 in this case just have default values, as they are unused. If you're looking in your database at your spells_new table, you will see that each header row from table above appears as a database field for each slot (IE effectid1, effectid2...effectid12; max1, max2...max12).

### Spell Effects¶

There is an entire page on the Wiki describing each Spell Effect. A spell effect, in simplest terms, determines what is modified, or what is caused to happen, by the spell. It is important to understand that each slot, as shown above, can have a Spell Effect enumerated in the Effect ID field--that is to say that each Spell can have one or more spell effects that occur when the spell is cast.

Dissecting the information presented in the Greater Healing spell table above, we see that Spell Effect 0 is listed in the first slot (effectid1 field in your database). Cross-referencing with the Spell Effect list, we find that Spell Effect 0 is "SE_CurrentHP", or Spell Effect Current Hit Points. We can therefore surmise the the Greater Healing spell must have something to do with hit points.

### Base Values¶

Base Values are integers that are used in coordination with the Spell Effect to determine an outcome. Each Spell Effect does something slightly different with its base value, as demonstrated in the Spell Effects table.

In the case of our Greater Healing spell, we see a Base Value of 140 in Slot 1 (effect_base_value1 field in your database). Since we know the Spell Effect will impact Current Hit Points, and since 140 is a positive value (as opposed to -140, for instance), we can say that the Healing spell will increase current hitpoints by 140--it will heal (add), rather than damage (subtract) from our current hit points.

Something isn't quite adding up yet, however: we know that as you level up, your healing power seems to increase. This mechanic can be explained by examining some additional fields.

### Max Values¶

Max Values are integers that are also used in coordination with the Spell Effect to determine an outcome. Each Spell Effect's Max Value can do something slightly different, as demonstrated in the Spell Effect table.

In the case of our Greater Healing spell, we see a Max Value of 300 in Slot 1 (max1 field in your database). This means that the most this spell will adjust Current Hit Points by, is 300. This is indicated by "Max Amt" in the Max Value column of the Spell Effect table for SE_CurrentHP. Instead, if "Max Level" were indicated for Max Value of this spell effect, we would surmise that the spell would continue to scale as the player character gained levels, with each new level adding to the amount of hit points that could be restored.

So we have established that the Greater Healing spell is capable of changing current hit points in the amount of 140 to a maximum amount of 300--but how does it scale as you increase in levels from the first level you get the spell, until you max out the effectiveness of the spell and are able to heal 300 hit points?

### Formula¶

Formula values are integers that are used in coordination with the Spell Effect to determine its outcome as well. Each Spell Effect can use a different formula, and those are found in the spell_effects.cpp source file. A wiki page also details those Base Value Formulas if you're not comfortable looking at the code.

In the case of our Greater Healing spell, we see that the value for Formula in Slot 1 is 7 (formula1 field in your database). Referencing the source, we find that the spell calc is Base Value + User Level _ _* Formula. If we assume that we are a level 20 Cleric, casting the Greater Healing spell: 140 + 20 * 7 = 280. This of course assumes that there are no focus effects being taken into consideration. If we are instead a level 29 Druid, we would hit the spell's max value: 140 + 29 * 7 = 343--which is greater than the 300 hit point Max Value. As a result, the Druid would only heal 300 hit points using this spell.

### Summary¶

It's important to understand the concept that at least one Spell Effect is in use for each spell. Each spell effect has a number of parameters that may behave differently from one spell effect to the next, even though they occupy the same field in the database--pay close attention to the Base Value, Limit Value, and Max Value for the Spell Effect, as they can drastically change the behavior of a spell.

## Dissecting more Complex Spells¶

Every spell that exists can be deciphered simply by following the guidelines as laid out above. Let's look at a couple more spells to hone our skills.

### Koadic's Endless Intellect¶

Many players will remember the endless requests for KEI--players always needed more mana. Let's examine the spell:

| 

**Slot** 
| **Effect ID** 
| **Effect Base Value** 
| **Max** 
| **Formula** 

| 1 
| 97 
| 250 
| 250 
| 100 

| 2 
| 15 
| 14 
| 14 
| 100 

| 3 
| 8 
| 25 
| 25 
| 100 

| 4 
| 9 
| 25 
| 25 
| 100 

| 5 
| 254 
| 0 
| 0 
| 100 

| 6 
| 254 
| 0 
| 0 
| 100 

| 7 
| 254 
| 0 
| 0 
| 100 

| 8 
| 254 
| 0 
| 0 
| 100 

| 9 
| 254 
| 0 
| 0 
| 100 

| 10 
| 254 
| 0 
| 0 
| 100 

| 11 
| 254 
| 0 
| 0 
| 100 

| 12 
| 254 
| 0 
| 0 
| 100 

We see that slots 1 through 4 have something going on, and slots 5 through 12 are not being utilized. Let's take a look at the parameters.

#### Spell Effects¶

Cross reference the Spell Effects table.

`Slot 1: 97 - SE_ManaPool: Increase/Decrease max mana pool`.
`Slot 2: 15 - SE_CurrentMana: Direct +/- mana, duration allows for mana over time`.
`Slot 3: 8 - SE_INT: +/- INT`.
`Slot 4: 9 - SE_WIS: +/- WIS`.

#### Effect Base Value¶

`Slot 1: SE_ManaPool - +250`.
`Slot 2: SE_CurrentMana - +14`.
`Slot 3: SE_INT - +25`.
`Slot 4: SE_WIS - +25`.

#### Max¶

`Slot 1: SE_ManaPool - 250`.
`Slot 2: SE_CurrentMana - 14`.
`Slot 3: SE_INT - 25`.
`Slot 4: SE_WIS - 25`.

#### Formula¶

All slots use Formula 100. When we analyze the spell_effects.cpp source file, we see the corresponding formula establishes that the base value is used (result = ubase).

Since the Spell Effect Current Mana (SE_CurrentMana) allows for duration, we see that you will receive 14 mana per tick while the spell is active.

#### Summary¶

Koadic's Endless Intellect:

| 

**Slot** 
| **Description** 

| 1 
| Increase Mana Pool by 250 

| 2 
| Increase Mana by 14 per tick 

| 3 
| Increase INT by 25 

| 4 
| Increase WIS by 25 

### Protection of the Glades¶

Most players will recall being a caster class and requesting POTG along with their KEI. Let's take a look at the spell and find out why:

| 

**Slot** 
| **Effect ID** 
| **Effect Base Value** 
| **Max** 
| **Formula** 

| 1 
| 1 
| 25 
| 80 
| 100 

| 2 
| 69 
| 290 
| 485 
| 100 

| 3 
| 79 
| 290 
| 485 
| 100 

| 4 
| 15 
| 6 
| 0 
| 100 

| 5 
| 148 
| 1 
| 1081 
| 201 

| 6 
| 148 
| 69 
| 2486 
| 202 

| 7 
| 254 
| 0 
| 0 
| 100 

| 8 
| 254 
| 0 
| 0 
| 100 

| 9 
| 254 
| 0 
| 0 
| 100 

| 10 
| 254 
| 0 
| 0 
| 100 

| 11 
| 254 
| 0 
| 0 
| 100 

| 12 
| 254 
| 0 
| 0 
| 100 

We see that slots 1 through 6 have something going on, and slots 7 through 12 are not being utilized. Let's take a look at the parameters.

#### Spell Effects¶

Cross reference the Spell Effects table.

`Slot 1: 1 - SE_ArmorClass: +/- AC`.
`Slot 2: 69 - SE_TotalHP: Increases Max HP (standard 'HP Buffs')`.
`Slot 3: 79 - SE_CurrentHPOnce: Direct Damage/Healing`.
`Slot 4: 15 - SE_CurrentMana: Direct +/- mana, duration allows for mana over time`.
`Slot 5: 148 - SE_StackingCommand_Block: Prevents buff from taking hold if criteria met. (SLOT = 'formula - 201') Buff Stacking`.
`Slot 6: 148 - SE_StackingCommand_Block: Prevents buff from taking hold if criteria met. (SLOT = 'formula - 201') Buff Stacking`

#### Effect Base Value¶

`Slot 1: SE_ArmorClass - +25`
`Slot 2: SE_TotalHP - +290`
`Slot 3: SE_CurrentHPOnce - +290 (heal up the new-found reservoir of hit points)`
`Slot 4: SE_CurrentMana - +6 (remember duration allows for mana over time)`
`Slot 5: SE_StackingCommand_Block - 1 (block spells using SE_ArmorClass)`
`Slot 6: SE_StackingCommand_Block - 69 (block spells using SE_TotalHP)`

#### Max¶

`Slot 1: SE_ArmorClass - 80`
`Slot 2: SE_TotalHP - 485`
`Slot 3: SE_CurrentHPOnce - 485`
`Slot 4: SE_CurrentMana - 0 (not used)`
`Slot 5: SE_StackingCommand_Block - Less than 1081 (block spells with less than 1081 AC addition)`
`Slot 6: SE_StackingCommand_Block - Less than 2486 (block spells with less than 2486 HP addition)`

#### Formula¶

All slots 1 through 4 use Formula 100. When we analyze the spell_effects.cpp source file, we see the corresponding formula establishes that the base value is used (result = ubase).

Since the Spell Effect Current Mana (SE_CurrentMana) allows for duration, we see that you will receive 6 mana per tick while the spell is active.

Slots 5 and 6, utilizing SE_StackingCommand_Block, will apply to the slot indicated by calculating 'formula - 201'. So slot 5 applies to slot 1 (201 - 201 = 0, remember that computers count 0, 1, 2...), and slot 6 applies to slot 2 (202 - 201 = 1, remembering that computers count 0, 1, 2...).

#### Summary¶

Protection of the Glades:

| 

**Slot** 
| **Description** 

| 1 
| Increase Armor Class by 25 - 80 

| 2 
| Increase Hit Points by 290 - 485 

| 3 
| Increase Hit Points when cast by 290 - 485 

| 4 
| Increase Mana by 6 per tick 

| 5 
| Block new spell if slot 1 has AC effect less than 1081 

| 6 
| Block new spell if slot 2 has increase HP effect less than 2486 

## Understanding the Remaining Fields¶

A dizzying array of fields exists that have not been covered above. Many of these fields are quite self-explanatory, such as the level at which each class can use the spell, the deities allowed to use the spell, cast-on messages, etc. This section is meant to cover the remaining fields as questions arise about their functionality. Remember to reference the information on spells_new found on this wiki, and the information contained in the spdat.h source file, as well as the other helpful wiki pages for Base Value Formulas, Spell Target Restrictions, Spell Resist Types, and Damage Shield Types.

## Reagents¶

Spells that require reagents have items (by Item ID) listed in the components fields (component1, component2...component4). Examples of such spells would be Elemental: Earth (default Spell ID 401), which requires Item ID 10015 - Malachite, or Diamondskin (default Spell ID 394), which requires Item ID 10028 - Peridot. Some spells require a focus item, but do not consume the item when cast, such as Flame Lick (default Spell ID 239), which requires a 10307 - Fire Beetle Eye to cast, but does not consume it. Note the relationship between the component fields, the component count fields, and the NoexpendReagent fields, which utilize slots--just like Spell Effects discussed above:

| 

**Slot** 
| **Component** 
| **Component Count** 
| **No Expend Reagent** 

| 1 
| ItemID 
| Count of the ItemID 
| Used as Focus item, or "Needed But Not Used" 

| 2 
| ItemID 
| Count of the ItemID 
| Used as Focus item, or "Needed But Not Used" 

| 3 
| ItemID 
| Count of the ItemID 
| Used as Focus item, or "Needed But Not Used" 

| 4 
| ItemID 
| Count of the ItemID 
| Used as Focus item, or "Needed But Not Used" 

#### Elemental: Earth¶

| 

**Slot** 
| **Component** 
| **Component Count** 
| **No Expend Reagent** 
| **Notes** 

| 1 
| 10015 
| 1 
| 6361 
| Use 10015 - Malachite x1, focus with 6361 - Shovel of Ponz 

| 2 
| -1 
| 1 
| -1 
| Nothing 

| 3 
| -1 
| 1 
| -1 
| Nothing 

| 4 
| -1 
| 1 
| -1 
| Nothing 

#### Diamondskin¶

| 

**Slot** 
| **Component** 
| **Component Count** 
| **No Expend Reagent** 
| **Notes** 

| 1 
| 10028 
| 1 
| -1 
| Use 10028 - Peridot x1 

| 2 
| -1 
| 1 
| -1 
| Nothing 

| 3 
| -1 
| 1 
| -1 
| Nothing 

| 4 
| -1 
| 1 
| -1 
| Nothing 

#### Flame Lick¶

| 

**Slot** 
| **Component** 
| **Component Count** 
| **No Expend Reagent** 
| **Notes** 

| 1 
| -1 
| 1 
| 10307 
| Require a 10307 - Fire Beetle Eye to cast 

| 2 
| -1 
| 1 
| -1 
| Nothing 

| 3 
| -1 
| 1 
| -1 
| Nothing 

| 4 
| -1 
| 1 
| -1 
| Nothing 

## Buff Duration¶

Two fields impact the duration of buffs: buffduration (in ticks) and buffduration formula. Understanding the formula allows you to calculate the duration of the buff. The formula can be found in the spells.cpp source file.

### Buff Duration Formula 0¶

Not a buff! This formula is used for instant spells. Ex. Greater Healing

### Buff Duration Formula 1¶

**If your level is greater than 3:**

Choose the lesser integer of the two values: Level ÷ 2, or the buffduration field.

Example: Heat Blood, Spell ID 360, buffduration field = 6.

*As a level 10 NEC:*

```
`Level ÷ 2 = X 
10 ÷ 2 = X 
Is X < 6? 
Yes, 5 is less than 6
Smallest Answer: 5 ticks
`
```

*As a level 28 SHD:*

```
`Level ÷ 2 = X
28 ÷ 2 = X
Is X < 6? 
No, 14 is greater than 6
Smallest Answer: 6 ticks
`
```

**If your level is less than 3:**

1 tick.

### Buff Duration Formula 2¶

**If your level is greater than 3:**

Choose the lesser integer of the two values: Level ÷ 2 + 5, or the buffduration field.

Example: Root, Spell ID 230, buffduration field = 8.

*As a level 4 WIZ:*

```
`Level ÷ 2 + 5 = X 
4 ÷ 2 + 5 = X 
Is X < 8? 
Yes, 7 is less than 8.
Smallest Answer: 7 ticks
`
```

*As a level 34 NEC:*

```
`Level ÷ 2 + 5= X 
34 ÷ 2 + 5 = X 
Is X < 8? 
No, 19 is greater than 8
Smallest Answer: 8 ticks
`
```

**If your level is less than 3:**

6 ticks.

### Buff Duration Formula 3¶

Choose the lesser integer of the two values: Level x 30, or the buffduration field.

Example: Invisibility, Spell ID 42, buffduration field = 200.

*As a level 4 ENC:*

```
`Level x 30 = X 
4 x 30 = X 
Is X < 200? 
Yes, 120 is less than 200.
Smallest Answer: 120 ticks
`
```

*As a level 16 WIZ:*

```
`Level x 30 = X 
16 x 30 = X 
Is X < 200? 
No, 480 is greater than 200.
Smallest Answer: 200 ticks
`
```

### Buff Duration Formula 4¶

50, unless buffduration is lower.

Example: Resurrection Sickness, Spell ID 757, buffduration field = 50.

```
`buffduration = X
Is X < 50? 
No, they are the same.
Smallest Answer: 50 ticks
`
```

Example: Song of the Deep Seas, Spell ID 1973, buffduration field = 25.

```
`buffduration = X
Is X < 50? 
Yes, 25 is less than 50.
Smallest Answer: 25 ticks
`
```

### Buff Duration Formula 5¶

2, unless buffduration is lower.

Example: Flash of Light, Spell ID 201, buffduration field = 2.

```
`buffduration = X
Is X < 2? 
No, they are the same.
Smallest Answer: 2 ticks
`
```

Example: The Unspoken Word, Spell ID 1545, buffduration field = 1.

```
`buffduration = X
Is X < 2? 
Yes, 1 is less than 2.
Smallest Answer: 1 ticks
`
```

### Buff Duration Formula 6¶

Choose the lesser integer of the two values: Level ÷ 2 + 2, or the buffduration field.

Example: Drowsy, Spell ID 270, buffduration field = 35.

*As a level 6 SHM:*

```
`Level ÷ 2 + 2 = X 
6 ÷ 2 + 2 = X 
Is X < 35? 
Yes, 5 is less than 35.
Smallest Answer: 5 ticks
`
```

*As a level 70 SHM:*

```
`Level ÷ 2 + 2 = X 
70 ÷ 2 + 2 = X 
Is X < 35? 
No, 37 is greater than 35
Smallest Answer: 35 ticks
`
```

### Buff Duration Formula 7¶

Choose the lesser integer of the two values: Level, or the buffduration field.

Example: Fear, Spell ID 229, buffduration field = 3.

*As a level 2 NEC:*

```
`Level = X 
Is X < 3? 
Yes, 2 is less than 3.
Smallest Answer: 2 ticks
`
```

*As a level 12 SHD:*

```
`Level = X 
Is X < 3? 
No, 12 is greater than 3.
Smallest Answer: 3 ticks
`
```

### Buff Duration Formula 8¶

Choose the lesser integer of the two values: Level + 10, or the buffduration field.

Example: Vampiric Embrace, Spell ID 359, buffduration field = 75.

*As a level 7 NEC:*

```
`Level + 10 = X 
7 + 10 = X
Is X < 75? 
Yes, 17 is less than 75.
Smallest Answer: 17 ticks
`
```

*As a level 70 SHD:*

```
`Level + 10 = X 
70 + 10 = X 
Is X < 75? 
No, 80 is greater than 75.
Smallest Answer: 75 ticks
`
```

### Buff Duration Formula 9¶

Choose the lesser integer of the two values: 2 x Level + 10, or the buffduration field.

Example: Ensnare, Spell ID 512, buffduration field = 140.

*As a level 26 DRU:*

```
`2 x Level + 10 = X 
2 x 26 + 10 = X
Is X < 140? 
Yes, 62 is less than 140.
Smallest Answer: 62 ticks
`
```

*As a level 70 RNG:*

```
`2 x Level + 10 = X 
2 x 70 + 10 = X
Is X < 140? 
No, 150 is greater than 140.
Smallest Answer: 140 ticks
`
```

### Buff Duration Formula 10¶

Choose the lesser integer of the two values: 3 x Level + 10, or the buffduration field.

Example: Regeneration, Spell ID 144, buffduration field = 205.

*As a level 34 DRU:*

```
`3 x Level + 10 = X 
3 x 34 + 10 = X
Is X < 205? 
Yes, 112 is less than 205.
Smallest Answer: 112 ticks
`
```

*As a level 70 DRU:*

```
`3 x Level + 10 = X 
3 x 70 + 10 = X
Is X < 205? 
No, 220 is greater than 205.
Smallest Answer: 205 ticks
`
```

### Buff Duration Formula 11¶

Choose the lesser integer of the two values: 30 x (Level + 3), or the buffduration field.

Example: See Invisible, Spell ID 80, buffduration field = 270.

*As a level 4 WIZ:*

```
`30 x (Level + 3) = X 
30 x (4 + 3) = X
Is X < 270? 
Yes, 210 is less than 270.
Smallest Answer: 210 ticks
`
```

*As a level 32 RNG:*

```
`30 x (Level + 3) = X 
30 x (32 + 3) = X
Is X < 270? 
No, 1050 is greater than 270.
Smallest Answer: 270 ticks
`
```

### Buff Duration Formula 12¶

**If your level is greater than 7:**

Choose the lesser integer of the two values: Level ÷ 4, or the buffduration field.

Used by some focuses and disciplines.

**If your level is less than 7:**

1 tick.

### Buff Duration Formula 13¶

Choose the lesser integer of the two values: 4 x Level + 10, or the buffduration field.

Used by some poisons and wards.

### Buff Duration Formula 14¶

Choose the lesser integer of the two values: 5 x (Level + 2), or the buffduration field.

Used by a ridiculous secretion.

### Buff Duration Formula 15¶

Choose the lesser integer of the two values: 10 x (Level + 10), or the buffduration field.

Used by some potions and powerful spells.

### Buff Duration Formula 50¶

Permanent. Used for permanent buffs that might get stripped due to other forces (IE casting when using Perfected Invisibility).

### Buff Duration Formula 51¶

Permanent. Used for auras and the like.

---

## NPC Spell Categories

*Source: server/spells/npc-spell-categories/index.html*

# NPC Spell Categories¶

| 

NPC Spell Category ID 
| NPC Spell Category Name 

| 0 
| Not Applicable (Non NPC Spell) 

| 1 
| Area of Effect Detrimental 

| 2 
| Single Target Detrimental 

| 3 
| Buffs 

| 4 
| Pet Spells 

| 5 
| Healing Spells 

| 6 
| Gate or Last Cast 

| 7 
| Debuffs 

| 8 
| Dispells

---

## Numhit Types

*Source: server/spells/numhit-types/index.html*

# Numhit Types¶

Num Hits Type field (175) determines what behavior will tick down the numhits counter on specified buffs.

| 

**ID** 
| **Description** 

| 1 
| Attempted incoming melee attacks (hit or miss) on YOU. 

| 2 
| Attempted outgoing melee attacks (hit or miss) on YOUR TARGET. 

| 3 
| Incoming detrimental spells 

| 4 
| Outgoing deterimental spells 

| 5 
| Successful outgoing melee attack HIT on YOUR TARGET. 

| 6 
| Successful incoming melee attack HIT on YOU. 

| 7 
| Any casted spell matching/triggering a focus effect. 

| 8 
| Successful incoming spell or melee dmg attack on YOU. 

| 9 
| Incoming Reflected spells. 

| 10 
| Defensive spell buff procs 

| 11 
| Offensive spell buff procs

---

## Resist Types

*Source: server/spells/resist-types/index.html*

# Resist Types¶

| 

**Resist Type** 
| **Value** 
| **NOTES** 

| None 
| 0 
| Unresistable 

| Magic 
| 1 
| 

| Fire 
| 2 
| 

| Cold 
| 3 
| 

| Poison 
| 4 
| 

| Disease 
| 5 
| 

| Chromatic 
| 6 
| Resist amount is the averages of MR, FR, CR, PR and DR 

| Prismatic 
| 7 
| Resist amount is your lowest resist value from MR, FR, CR, PR or DR 

| Physical 
| 8 
| This resist type exists on NPC's and uses a different formula than standard resists. Resist All spell effects do NOT raise this. 

| Corruption 
| 9 
|

---

## Spell Attack Speed

*Source: server/spells/spell-attack-speed/index.html*

# Spell Attack Speed¶

- **SE_AttackSpeed**

- **Standard Haste and Slows**

Baseline attack speed is set at a value of 100.

- This spell effect modifies that value.

- **Haste**

Haste spells will have a value greater than 100.

- Haste amount is calculated at (Value - 100). 

- Example: Swift like the Wind (Value = 160) 

- 160 - 100 = 60% Haste

- Haste Caps

- Lv 60+ = **(100)**

- Lv 51 - 59 = **(85)**

- Lv < 50 = **(level + 25)**

- **Slow**

Slow spells will have a value less than 100

- Slow amount is calculated at (100 - Value)

- Example: Sha's Legacy (Value = 35)

- 100 - 35 = 65% Slow

- Stacking: Slow will always overwrite haste in the same spell slot.

- **Slow Mitigation**

Set in npc_types table 'slow_mitigation'

- Decreases the potency of a slow effect by a percent as defined in the table

| 

**Range** 
| **Client Message when cast on an NPC with slow mitigation** 

| 0 - 25 % 
| "Your spell was mostly successful" 

| 26 - 74 % 
| "Your spell was partially successful" 

| 74 - 100% 
| "Your spell was slightly successful" 

- **SE_AttackSpeed2 (98)**

- **Stackable Haste (w/ SE_AttackSpeed) that does not go over the haste cap**

Calculated same as SE_AttackSpeed

- Value stacks directly with with SE_AttackSpeed.

- Example: Swift like the Wind (60%) + Composition of Ervaj **(10%)** = 70% Haste

- Can also be used a stackable slow effect as seen in Al'Kabors Spiral of Deadly Force

- **SE_AttackSpeed3 (119)**

- **Stackable Haste (w/ SE_AttackSpeed + SE_AttackSpeed2) that can go over the haste cap**

The direct spell effect value is added to the haste derived from SE_AttackSpeed and SE_AttackSpeed2 and will exceed the haste cap.

- Example (**IF CAP AT 100**): Swift like the Wind (60%) + Composition of Ervaj (10%) + Item Haste (30%) = 100% + Ancient Power **(10%) =** 110% Haste

- Can also be used as a stackable slow effect as seen in Taking Root

- Overhaste Caps

- Lv 51+ = **(25) **

- Lv 1 - 50 = **(10)**

- **SE_AttackSpeed4**

- **Stackable slow effect (w/ SE_AttackSpeed)**

**When slowed by SE_AttackSpeed:** This effect decreases the remaining portion of your attack speed value NOT lowered by standard slow

- Example: (SE_AttackSpeed) Sha's Legacy 65% slow + (SE_AttackSpeed4) Lassitude 25% slow

- Sha's Legacy is calculated as 100 - 35 = 65% slow, therefore the remaining attack speed is (35)

- Lassitude will now decrease the remaining value (35) by 25% = 16.5%

- The total slowed value on the target would be 65% + 16.5% = 81.25% slow

- **When NOT slowed by SE_AttackSpeed:** This effect acts as a regular slow, decreasing attack speed by the full amount.

- Note: The base value should always be set as a positive. There are a few examples of spells with negative values, however all of their descriptions indicate it as a slow effect (It is likely developer error)

---

## Spell Buff Stacking

*Source: server/spells/spell-buff-stacking/index.html*

# Spell Buff Stacking¶

- **SE_StackingCommand_Block (148)**

- Effect is found on buff and is used to prevent another buff from taking hold if specific criteria is met.

Base = Spell Effect

- Formula - 201 = Slot

- Max = Block if LESS THAN this value.

- **Exampe:** AC buff with a value of 500. You want to block any other AC spell from going into Slot 1 that is less than 1000 AC.

Slot 1 : Effect SE_AC(1) with Base=500 

- Slot 2: Effect SE_StackingCommand_Block (148) with Base= SE_AC(1) Max = 1000 and Formula = 201 (apply to the first spell slot--remember that we use base 0)

- **SE_StackingCommand_Overwrite (149)**

- Effect is found on buff and is used to overwrite another buff if specific criteria is met.

Base = Spell Effect

- Formula - 201 = Slot

- Max = Overwrite if LESS THAN this value.

- **Exampe: **AC buff with a value of 1200. You want to overwrite any other AC spell in Slot 1 that is less than 1000 AC.

Slot 1 : Effect SE_AC(1) with Base=1200 

- Slot 2: Effect SE_StackingCommand_Overwrite (149) with Base= SE_AC(1) Max = 1000 and Formula = 201 (apply to the first spell slot--remember that we use base 0)

- **SE_Screech (123)**

- Any effect with SE_Screech that has a value of +1 will block any other effect with SE_Screech in it that has a value of -1.

Example:

- Spell Screech has SE_Screech with value of -1. 

- Spell Screech Immunity has SE_Screech with value of +1

If you have the buff Screech Immunity, the spell Screech will not be able to effect you or any other spell with Screech at (-1)

- **SE_AStacker (446), SE_BStacker (447), SE_CStaker (448), SE_DStaker (447) **

- Buffs containing these effects can block each other from taking hold via the following. *(Does not matter what slot the effect is in)*

- (B) Blocks any buffs from taking hold with (A) in it.

- (C) Blocks any buff from taking hold with (B) in it.

- (D) Blocks any buff from taking hold with (C) in it.

- When checking same type (ie A vs A), the higher base effect value will determine which takes hold.

---

## Spell Conditions

*Source: server/spells/spell-conditions/index.html*

# Spell Conditions¶

Used with spell effects SE_TriggerOnReqTarget (442) and SE_TriggerOnReqCaster (443) that trigger a spell when a condition on target is met.

| 

**ID** 
| **Description of condition to met** *(Defined by **limit** in spell data)* 

| 220-250 
| Number of pets on hatelist to trigger (base2 - 220) (Set at 30 pets max for now) 

| 500-520 
| Below (limit - 500)*5 % HP 

| 521 
| Below (?) Mana UKNOWN - Will assume its 20% unless proven otherwise 

| 522 
| Below (40%) Endurance 

| 523 
| Below (40%) Mana 

| 1004 
| Bellow (80%) HP 

| 38311 
| Bellow (10%) Mana

---

## Spell Damage Modifiers

*Source: server/spells/spell-damage-modifiers/index.html*

# Spell Damage Modifiers¶

**Overview of spell effects that modify Spell Damage**

**Key: Focus Effect, **_**Item Effect**_**, ****Non-Focus Spell Effect**

**Spell damage criticals are not a flat (2x) they are determined soely by your 'critical damage modifer' value.*

_*If multiple of same Focus Effect, highest avialable value is used. [Stacks] Indicates that if multiple of same effect, the final amount is the total of all effects. _

**Direct Damage**

- **Focus Effects** **that increase/decrease damage by percent.**

- **SE_FcBaseEffects (413)** Modifies by % the base damage value of the spell cast.

- **SE_ImprovedDamage** **(124) **Modifies by % the damage value after (413) is applied. (This value CAN NOT critical)

- **SE_FcDamagePctCrit (302) **Modifies by % the damage value after (413) is applied. (This value CAN critical)

- **Effects on CASTER that increase/decrease damage by a specific amount.**

- **SE_FcDamageAmt (286)** ± a set damage amount (This value CAN NOT criticals).

- **SE_FcDamageAmtCrit (303)** ± a set damageamount (This value CAN critical)

- ***Item 'Spell Damage Amount"*** - Amount specified on the item modified by formula bellow (This value CAN critical)

Value is modified by the 'total cast time' of the spell it is being applied to

- *Total Cast Time* is derived from adding which ever is greater(Recast OR Recovery time) to cast time.

- *Total Cast Time* (0 - 2.5 seconds). 

- Damage Amount = Damagel Amount / 4

- *Total Cast Time* (2.6 - 7.0 seconds)

- Damage Amount = Damage Amount*(0.167*(*Total Cast Time*)/1000))

- *Total Cast Time* ( > 7.0 seconds)

- Damage Amount = Damage Amount / 7

- **Effects on TARGET that increase/decrease damage by a specific amount.**

- **SE_FcDamageAmtIncoming (297)** ± a set amount of damage (This value CAN NOT critical)

- **Effects on TARGET that increase/decrease damage by percent.**

- **SE_FcSpellVulnerability (296) ** Modifies by % the casters base damage value (This value CAN critical).

- **Effects on CASTER that increase/decrease critical spell chance. **

- **SE_CriticalSpellChance (294)**** **Modfies by % the chance to critical spell chance AND critical damage modifer. [c_ritcal portion_ Stacks]

- **SE_SpellCritChance (170)** Modifies by % the chance to critical spell. [Stacks]

- **SE_FrenziedDevastation (212)**** **Modifies by % the chance to critical spells AND increases DD spells mana cost by 2x [Stacks]

- **Effects on CASTER that increase/decrease critical spell damage. (*****Critcal Spell Damage Modifier*****)**

- **SE_CriticalSpellChance (294)**** **Modfies by % the chance to critical spell chance AND critical damage modifer. [*damage portion does not Stack*]

- **SE_SpellCritDmgIncrease (155)**** **Modifies by % the critical damage modifier. [Stacks]

**Calculation **

**Critical Chance = **SE_CriticalSpellChance** + **SE_SpellCritChance** + ****SE_FrenziedDevastation**

**X =** Damage Amount

**CritMod** = **SE_CriticalSpellChance**** + ****SE_SpellCritDmgIncrease**

**Final Damage Amount = ( (X * SE_FcBaseEffects) * SE_ImprovedDamage ) +** ** ((X * SE_FcBaseEffects) * FcDamagePctCrit )*CritMod) + SE_FcDamageAmt + (SE_FcDamageAmtCrital * CritMod) + (**_**Item 'Spell Damage Amount"**_** * CritMod) + SE_FcDamageAmtIncoming + (((X * SE_FcBaseEffects) * SE_FcSpellVulnerability )* CritMod))) **

**DAMAGE OVER TIME**

**Critcal damage modifer for DOTs is always (2x) at baseline if you have a chance to critical.*

- **Focus Effects** **that increase/decrease damage by percent.**

- **SE_FcBaseEffects (413)** Modifies by % the base damage value of the spell cast.

- **SE_ImprovedDamage** **(124) **Modifies by % the damage value after (413) is applied. (This value CAN critical) **Unlike DD spells this does critical for DOTS*

- **SE_FcDamagePctCrit (302) **Modifies by % the damage value after (413) is applied. (This value CAN critical)

- **Effects on CASTER that increase/decrease damage by a specific amount. **_ *Damage is divided by duration and that value is applied to each tick_

- **SE_FcDamageAmt (286)** ± a set damage amount (This value CAN NOT criticals).

- **SE_FcDamageAmtCrit (303)** ± a set damageamount (This value CAN critical)

- ***Item 'Spell Damage Amount"*** * Not applied to DOTS

- **Effects on TARGET that increase/decrease damage by a specific amount. ****Damage is divided by duration and that value is applied to each tick*

- **SE_FcDamageAmtIncoming (297)** ± a set amount of damage (This value CAN NOT critical)

- **Effects on TARGET that increase/decrease damage by percent.**

- **SE_FcSpellVulnerability (296) ** Modifies by % the casters base damage value (This value CAN critical).

- **Effects on CASTER that increase/decrease critical dot chance. **

- **SE_CriticalDotChance (273)**** **Modfies by % the chance to critical dot hance [Stacks]

- **SE_CriticalDotlDecay (433)**** **Modifies by % the chance to critical dots. [Stacks]

Effect value decreases if spell cast is over the maximum level specified.

- **Effects on CASTER that increase/decrease critical dot damage. (*****Critical Spell Damage Modifier*****)**

- **SE_DotCritDmgIncrease (375)** Modifies by % the critical damage modifier. [Stacks]

**Calculation **

**Critical Chance = **SE_CriticalDotChance** + **SE_CriticalDotDecay** **

**X = **Damage Amount

**CritMod** = **Baseline(100%)**** + ****SE_DotCritDmgIncrease**

**Final DOT Damage Amount = ( (X * SE_FcBaseEffects) * SE_ImprovedDamage ) + ((X * SE_FcBaseEffects) * FcDamagePctCrit )*CritMod) + ((SE_FcDamageAmt + (SE_FcDamageAmtCrital * CritMod)**

**+ SE_FcDamageAmtIncoming)/DURATION) + (((X * SE_FcBaseEffects) * SE_FcSpellVulnerability )* CritMod))) **

---

## Spell Effect Fields

*Source: server/spells/spell-effect-fields/index.html*

# Spell Effect Fields¶

| 

**EQEMU** 
| **LIVE** 
| **Comment** 

| id 
| SPELLINDEX 
| 

| name 
| SPELLNAME 
| 

| player_1 
| ACTORTAG 
| 

| teleport_zone 
| NPC_FILENAME 
| 

| you_cast 
| CASTERMETXT 
| 

| other_casts 
| CASTEROTHERTXT 
| 

| cast_on_you 
| CASTEDMETXT 
| 

| cast_on_other 
| CASTEDOTHERTXT 
| 

| spell_fades 
| SPELLGONE 
| 

| range 
| RANGE 
| 

| aoerange 
| IMPACTRADIUS 
| 

| pushback 
| OUTFORCE 
| 

| pushup 
| UPFORCE 
| 

| cast_time 
| CASTINGTIME 
| 

| recovery_time 
| RECOVERYDELAY 
| 

| recast_time 
| SPELLDELAY 
| 

| buffdurationformula 
| DURATIONBASE 
| 

| buffduration 
| DURATIONCAP 
| 

| AEDuration 
| IMPACTDURATION 
| 

| mana 
| MANACOST 
| 

| effect_base_value1 
| BASEAFFECT1 
| 

| effect_base_value2 
| BASEAFFECT2 
| 

| effect_base_value3 
| BASEAFFECT3 
| 

| effect_base_value4 
| BASEAFFECT4 
| 

| effect_base_value5 
| BASEAFFECT5 
| 

| effect_base_value6 
| BASEAFFECT6 
| 

| effect_base_value7 
| BASEAFFECT7 
| 

| effect_base_value8 
| BASEAFFECT8 
| 

| effect_base_value9 
| BASEAFFECT9 
| 

| effect_base_value10 
| BASEAFFECT10 
| 

| effect_base_value11 
| BASEAFFECT11 
| 

| effect_base_value12 
| BASEAFFECT12 
| 

| effect_limit_value1 
| BASE_EFFECT2_1 
| 

| effect_limit_value2 
| BASE_EFFECT2_2 
| 

| effect_limit_value3 
| BASE_EFFECT2_3 
| 

| effect_limit_value4 
| BASE_EFFECT2_4 
| 

| effect_limit_value5 
| BASE_EFFECT2_5 
| 

| effect_limit_value6 
| BASE_EFFECT2_6 
| 

| effect_limit_value7 
| BASE_EFFECT2_7 
| 

| effect_limit_value8 
| BASE_EFFECT2_8 
| 

| effect_limit_value9 
| BASE_EFFECT2_9 
| 

| effect_limit_value10 
| BASE_EFFECT2_10 
| 

| effect_limit_value11 
| BASE_EFFECT2_11 
| 

| effect_limit_value12 
| BASE_EFFECT2_12 
| 

| max1 
| AFFECT1CAP 
| 

| max2 
| AFFECT2CAP 
| 

| max3 
| AFFECT3CAP 
| 

| max4 
| AFFECT4CAP 
| 

| max5 
| AFFECT5CAP 
| 

| max6 
| AFFECT6CAP 
| 

| max7 
| AFFECT7CAP 
| 

| max8 
| AFFECT8CAP 
| 

| max9 
| AFFECT9CAP 
| 

| max10 
| AFFECT10CAP 
| 

| max11 
| AFFECT11CAP 
| 

| max12 
| AFFECT12CAP 
| 

| icon 
| IMAGENUMBER 
| 

| memicon 
| MEMIMAGENUMBER 
| 

| components1 
| EXPENDREAGENT1 
| 

| components2 
| EXPENDREAGENT2 
| 

| components3 
| EXPENDREAGENT3 
| 

| components4 
| EXPENDREAGENT4 
| 

| component_counts1 
| EXPENDQTY1 
| 

| component_counts2 
| EXPENDQTY2 
| 

| component_counts3 
| EXPENDQTY3 
| 

| component_counts4 
| EXPENDQTY4 
| 

| NoexpendReagent1 
| NOEXPENDREAGENT1 
| 

| NoexpendReagent2 
| NOEXPENDREAGENT2 
| 

| NoexpendReagent3 
| NOEXPENDREAGENT3 
| 

| NoexpendReagent4 
| NOEXPENDREAGENT4 
| 

| formula1 
| LEVELAFFECT1MOD 
| 

| formula2 
| LEVELAFFECT2MOD 
| 

| formula3 
| LEVELAFFECT3MOD 
| 

| formula4 
| LEVELAFFECT4MOD 
| 

| formula5 
| LEVELAFFECT5MOD 
| 

| formula6 
| LEVELAFFECT6MOD 
| 

| formula7 
| LEVELAFFECT7MOD 
| 

| formula8 
| LEVELAFFECT8MOD 
| 

| formula9 
| LEVELAFFECT9MOD 
| 

| formula10 
| LEVELAFFECT10MOD 
| 

| formula11 
| LEVELAFFECT11MOD 
| 

| formula12 
| LEVELAFFECT12MOD 
| 

| LightType 
| LIGHTTYPE 
| 

| goodEffect 
| BENEFICIAL 
| 

| Activated 
| ACTIVATED 
| 

| resisttype 
| RESISTTYPE 
| 

| effectid1 
| SPELLAFFECT1 
| 

| effectid2 
| SPELLAFFECT2 
| 

| effectid3 
| SPELLAFFECT3 
| 

| effectid4 
| SPELLAFFECT4 
| 

| effectid5 
| SPELLAFFECT5 
| 

| effectid6 
| SPELLAFFECT6 
| 

| effectid7 
| SPELLAFFECT7 
| 

| effectid8 
| SPELLAFFECT8 
| 

| effectid9 
| SPELLAFFECT9 
| 

| effectid10 
| SPELLAFFECT10 
| 

| effectid11 
| SPELLAFFECT11 
| 

| effectid12 
| SPELLAFFECT12 
| 

| targettype 
| TYPENUMBER 
| 

| basediff 
| BASEDIFFICULTY 
| 

| skill 
| CASTINGSKILL 
| 

| zonetype 
| ZONETYPE 
| 

| EnvironmentType 
| ENVIRONMENTTYPE 
| 

| TimeOfDay 
| TIMEOFDAY 
| 

| classes1 
| WARRIORMIN 
| 

| classes2 
| CLERICMIN 
| 

| classes3 
| PALADINMIN 
| 

| classes4 
| RANGERMIN 
| 

| classes5 
| SHADOWKNIGHTMIN 
| 

| classes6 
| DRUIDMIN 
| 

| classes7 
| MONKMIN 
| 

| classes8 
| BARDMIN 
| 

| classes9 
| ROGUEMIN 
| 

| classes10 
| SHAMANMIN 
| 

| classes11 
| NECROMANCERMIN 
| 

| classes12 
| WIZARDMIN 
| 

| classes13 
| MAGICIANMIN 
| 

| classes14 
| ENCHANTERMIN 
| 

| classes15 
| BEASTLORDMIN 
| 

| classes16 
| BERSERKERMIN 
| 

| CastingAnim 
| CASTINGANIM 
| 

| TargetAnim 
| TARGETANIM 
| 

| TravelType 
| TRAVELTYPE 
| 

| SpellAffectIndex 
| SPELLAFFECTINDEX 
| 

| disallow_sit 
| CANCELONSIT 
| 

| deities0 
| DIETY_AGNOSTIC 
| 

| deities1 
| DIETY_BERTOXXULOUS 
| 

| deities2 
| DIETY_BRELLSERILIS 
| 

| deities3 
| DIETY_CAZICTHULE 
| 

| deities4 
| DIETY_EROLLISIMARR 
| 

| deities5 
| DIETY_FIZZLETHORP 
| 

| deities6 
| DIETY_INNORUUK 
| 

| deities7 
| DIETY_KARANA 
| 

| deities8 
| DIETY_MITHMARR 
| 

| deities9 
| DIETY_PREXUS 
| 

| deities10 
| DIETY_QUELLIOUS 
| 

| deities11 
| DIETY_RALLOSZEK 
| 

| deities12 
| DIETY_RODCETNIFE 
| 

| deities13 
| DIETY_SOLUSEKRO 
| 

| deities14 
| DIETY_TRIBUNAL 
| 

| deities15 
| DIETY_TUNARE 
| 

| deities16 
| DIETY_VEESHAN 
| 

| field142 
| NPC_NO_CAST 
| Seen 100-15 ???? 

| field143 
| AI_PT_BONUS 
| 

| new_icon 
| NEW_ICON 
| 

| spellanim 
| SPELL_EFFECT_INDEX 
| 

| uninterruptable 
| NO_INTERRUPT 
| 

| ResistDiff 
| RESIST_MOD 
| 

| dot_stacking_exempt 
| NOT_STACKABLE_DOT 
| 

| deleteable 
| DELETE_OK 
| 

| RecourseLink 
| REFLECT_SPELLINDEX 
| 

| no_partial_resist 
| NO_PARTIAL_SAVE 
| 

| field152 
| SMALL_TARGETS_ONLY 
| 

| field153 
| USES_PERSISTENT_PARTICLES 
| 

| short_buff_box 
| BARD_BUFF_BOX 
| 

| descnum 
| DESCRIPTION_INDEX 
| 

| typedescnum 
| PRIMARY_CATEGORY 
| 

| effectdescnum 
| SECONDARY_CATEGORY_1 
| 

| effectdescnum2 
| SECONDARY_CATEGORY_2 
| 

| npc_no_los 
| NO_NPC_LOS 
| 

| field160 
| FEEDBACKABLE 
| ????? - probably was never implemented. 

| reflectable 
| REFLECTABLE 
| 

| bonushate 
| HATE_MOD 
| 

| field163 
| RESIST_PER_LEVEL 
| 

| field164 
| RESIST_CAP 
| 

| ldon_trap 
| AFFECT_INANIMATE 
| 

| EndurCost 
| STAMINA_COST 
| 

| EndurTimerIndex 
| TIMER_INDEX 
| 

| IsDiscipline 
| IS_SKILL 
| 

| field169 
| ATTACK_OPENING 
| unused 

| field170 
| DEFENSE_OPENING 
| unused 

| field171 
| SKILL_OPENING 
| unused 

| field172 
| NPC_ERROR_OPENING 
| unused 

| HateAdded 
| SPELL_HATE_GIVEN 
| 

| EndurUpkeep 
| ENDUR_UPKEEP 
| 

| field175 
| LIMITED_USE_TYPE 
| 

| numhits 
| LIMITED_USE_COUNT 
| 

| pvpresistbase 
| PVP_RESIST_MOD 
| 

| pvpresistcalc 
| PVP_RESIST_PER_LEVEL 
| 

| pvpresistcap 
| PVP_RESIST_CAP 
| 

| spell_category 
| GLOBAL_GROUP 
| 

| field181 
| PVP_DURATION 
| PVP Override 

| field182 
| PVP_DURATION_CAP 
| PVP Override 

| field183 
| PCNPC_ONLY_FLAG 
| 

| field184 
| CAST_NOT_STANDING 
| Blocks SE_InterruptCasting from affecting the casting spell, allows to cast while not standing, while invis, and breaks invul 

| can_mgb 
| CAN_MGB 
| 

| nodispell 
| NO_DISPELL 
| 

| npc_category 
| NPC_MEM_CATEGORY 
| 

| npc_usefulness 
| NPC_USEFULNESS 
| 

| MinResist 
| MIN_RESIST 
| 

| MaxResist 
| MAX_RESIST 
| 

| viral_targets 
| MIN_SPREAD_TIME 
| 

| viral_timer 
| MAX_SPREAD_TIME 
| 

| nimbuseffect 
| DURATION_PARTICLE_EFFECT 
| 

| ConeStartAngle 
| CONE_START_ANGLE 
| 

| ConeStopAngle 
| CONE_END_ANGLE 
| 

| sneaking 
| SNEAK_ATTACK 
| 

| not_extendable 
| NOT_FOCUSABLE 
| Updated to not_focusable 

| field198 
| NO_DETRIMENTAL_SPELL_AGGRO 
| Updated to no_detrimental_spell_aggro 

| field199 
| SHOW_WEAR_OFF_MESSAGE 
| 

| suspendable 
| IS_COUNTDOWN_HELD 
| 

| viral_range 
| SPREAD_RADIUS 
| 

| songcap 
| BASE_EFFECTS_FOCUS_CAP 
| 

| field203 
| STACKS_WITH_SELF 
| 

| field204 
| NOT_SHOWN_TO_PLAYER 
| 

| no_block 
| NO_BUFF_BLOCK 
| 

| field206 
| ANIM_VARIATION 
| 

| spellgroup 
| SPELL_GROUP 
| 

| rank 
| SPELL_GROUP_RANK 
| 

| field209 
| NO_RESIST 
| updated to no_resist 

| field210 
| ALLOW_SPELLSCRIBE 
| 

| CastRestriction 
| SPELL_REQ_ASSOCIATION_ID 
| 

| allowrest 
| BYPASS_REGEN_CHECK 
| 

| InCombat 
| CAN_CAST_IN_COMBAT 
| 

| OutofCombat 
| CAN_CAST_OUT_OF_COMBAT 
| 

| field215 
| SHOW_DOT_MESSAGE 
| 

| field216 
| INVALID 
| 

| field217 
| OVERRIDE_CRIT_CHANCE 
| Updated to override_crit_chance 

| aemaxtargets 
| MAX_TARGETS 
| 

| maxtargets 
| NO_HEAL_DAMAGE_ITEM_MOD 
| Updated to no_heal_damage_item_mod 

| field220 
| CASTER_REQUIREMENT_ID 
| Need to figure out what these do 

| field221 
| SPELL_CLASS 
| 

| field222 
| SPELL_SUBCLASS 
| 

| field223 
| AI_VALID_TARGETS 
| 

| persistdeath 
| NO_STRIP_ON_DEATH 
| 

| field225 
| BASE_EFFECTS_FOCUS_SLOPE 
| 

| field226 
| BASE_EFFECTS_FOCUS_OFFSET 
| 

| min_dist 
| DISTANCE_MOD_CLOSE_DIST 
| 

| min_dist_mod 
| DISTANCE_MOD_CLOSE_MULT 
| 

| max_dist 
| DISTANCE_MOD_FAR_DIST 
| 

| max_dist_mod 
| DISTANCE_MOD_FAR_MULT 
| 

| min_range 
| MIN_RANGE 
| 

| field232 
| NO_REMOVE 
| Updated to no_remove 

| field233 
| SPELL_RECOURSE_TYPE 
| 

| field234 
| ONLY_DURING_FAST_REGEN 
| 

| field235 
| IS_BETA_ONLY 
| 

| field236 
| SPELL_SUBGROUP 
|

---

## Spell Effect IDs

*Source: server/spells/spell-effect-ids/index.html*

# Spell Effect IDs¶

| 

ID 
| SPA 
| Spire SPA Effect Name 
| Description 
| Base 
| Limit 
| Max 
| Notes 

| 0 
| SE_CurrentHP 
| Current HP 
| Modify targets hit points by amount, repeates every tic if in a buff. Heals and damage. 
| amount 
| target restriction id 
| max amount (use positive value) 
| Negative base value for damage 

| 1 
| SE_ArmorClass 
| AC 
| Modify AC by amount 
| amount 
| none 
| amount 
| 

| 2 
| SE_ATK 
| ATK 
| Modify ATK by amount 
| amount 
| none 
| amount 
| 

| 3 
| SE_MovementSpeed 
| Movement Rate 
| Modify movement speed by amount 
| amount 
| none 
| amount 
| 

| 4 
| SE_STR 
| STR 
| Modify STR by amount 
| amount 
| none 
| amount 
| 

| 5 
| SE_DEX 
| DEX 
| Modify DEX by amount 
| amount 
| none 
| amount 
| 

| 6 
| SE_AGI 
| AGI 
| Modify AGI by amount 
| amount 
| none 
| amount 
| 

| 7 
| SE_STA 
| STA 
| Modify STA by amount 
| amount 
| none 
| amount 
| 

| 8 
| SE_INT 
| INT 
| Modify INT by amount 
| amount 
| none 
| amount 
| 

| 9 
| SE_WIS 
| WIS 
| Modify WIS by amount 
| amount 
| none 
| amount 
| 

| 10 
| SE_CHA 
| CHA 
| Modify CHA by amount 
| amount 
| none 
| amount 
| 

| 11 
| SE_AttackSpeed 
| Attack Speed 
| Modify attack speed by percent 
| percent haste or slow 
| none 
| none 
| Base greater than 100 for haste (120 = 20 pct haste) 

| 12 
| SE_Invisibility 
| Invisibility: Unstable 
| Apply invsibility that can drop before duration ends 
| invisibility level 
| none 
| none 
| Invisibility level determines what level of see invisible can detect it. 

| 13 
| SE_SeeInvis 
| See Invisible 
| Apply see invisbile which will allow you to see invisible entities 
| see invisible level 
| none 
| none 
| See Invisible level determines what level of invisible it can see. 

| 14 
| SE_WaterBreathing 
| Water Breathing 
| Immune to drowning 
| 1 (increase for stacking overwrite) 
| none 
| none 
| 

| 15 
| SE_CurrentMana 
| Mana 
| Modify mana by amount, repeates every tic if in a buff. 
| amount 
| none 
| max amount (use positive value) 
| 

| 16 
| SE_NPCFrenzy 
| NPC Frenzy 
| 
| 
| 
| 
| 

| 17 
| SE_NPCAwareness 
| NPC Awareness 
| 
| 
| 
| 
| 

| 18 
| SE_Lull 
| Pacify 
| Seen in harmony and lull spells. No coded functionality. 
| 1 
| none 
| none 
| 

| 19 
| SE_AddFaction 
| NPC Faction 
| Modify your faction with an NPC by amount 
| amount 
| none 
| none 
| 

| 20 
| SE_Blind 
| Blindness 
| Remove vision from clients or cause NPC's to flee if not in melee range. 
| 1 (increase for stacking overwrite) 
| none 
| none 
| 

| 21 
| SE_Stun 
| Stun 
| Interrupts spell casting and prevents target from doing any actions for duration 
| duration ms 
| pvp duration ms 
| max target level 
| 

| 22 
| SE_Charm 
| Charm 
| Control another entity as your pet 
| Unknown set to 1 
| none 
| max target level 
| 

| 23 
| SE_Fear 
| Fear 
| Causes the entity to run away until duration ends 
| Unknown set to 1 
| none 
| max target level 
| 

| 24 
| SE_Stamina 
| Stamina Loss 
| Modify endurance upkeep by amount while using disciplines that drain endurance 
| amount 
| none 
| none 
| Positive value will reduce endurance upkeep 

| 25 
| SE_BindAffinity 
| Bind Affinity 
| Bind location for gate spell. 
| bind id (Set to 1, 2, or 3) 
| none 
| none 
| Bind id allows you set alternate bind points. Bind Point ID (1=Primary, 2=Secondary 3=Tertiary) 

| 26 
| SE_Gate 
| Gate 
| Chance to teleport to bind location. 
| success chance 
| bind id (2 or 3) 
| none 
| If limit is not set, you will gate to primary bind location. Bind Point ID (1=Primary, 2=Secondary 3=Tertiary) 

| 27 
| SE_CancelMagic 
| Dispel Magic 
| Chance to removes detrimental and beneficial buffs 
| chance level modifier 
| none 
| none 
| Success chance is based on level difference of caster and caster of the buff, base value raises the casters level by the base amount. 

| 28 
| SE_InvisVsUndead 
| Invisibility to Undead: Unstable 
| Apply invsibility verse undead that can drop before duration ends 
| invisibility level 
| none 
| none 
| Invisibility level determines what level of see invisible can detect it. 

| 29 
| SE_InvisVsAnimals 
| Invisibility to Animals: Unstable 
| Apply invsibility verse animals that can drop before duration ends 
| invisibility level 
| none 
| none 
| Invisibility level determines what level of see invisible can detect it. 

| 30 
| SE_ChangeFrenzyRad 
| NPC Aggro Radius 
| Set NPC aggro radius 
| amount 
| none 
| max target level 
| 

| 31 
| SE_Mez 
| Mesmerize 
| Stuns target until duration ends or target takes damage. 
| 1 (increase for stacking overwrite) 
| none 
| max target level 
| Higher value of stacking type will always override the lower value. Used if you want one type of mez to overrite another. 

| 32 
| SE_SummonItem 
| Summon Item 
| Summon an item. 
| item id 
| none 
| stack amount 
| 

| 33 
| SE_SummonPet 
| Summon Pet 
| Summon a pet. 
| 1 
| none 
| none 
| Set 'Teleport Zone' field to be the same as 'type' field in of the pet you want in the pets table. 

| 34 
| SE_Confuse 
| Confuse 
| 
| 
| 
| 
| 

| 35 
| SE_DiseaseCounter 
| Disease Counter 
| Determines potency of determental disease spells or potency of cures. 
| amount 
| none 
| none 
| Set to positive values for potency of detrimental spells 

| 36 
| SE_PoisonCounter 
| Poison Counter 
| Determines potency of determental poison spells or potency of cures. 
| amount 
| none 
| none 
| Set to positive values for potency of detrimental spells 

| 37 
| SE_DetectHostile 
| Detect Hostile 
| 
| 
| 
| 
| 

| 38 
| SE_DetectMagic 
| Detect Magic 
| 
| 
| 
| 
| 

| 39 
| SE_TwinCastBlocker 
| Twincast Blocker 
| Prevent this spell from being twincast. 
| 1 
| none 
| none 
| 

| 40 
| SE_DivineAura 
| Invulnerability 
| Invulnerable to spells and melee, you can not cast or melee while under this effect. 
| 1 
| none 
| none 
| 

| 41 
| SE_Destroy 
| Destroy 
| Instantly kill target. 
| 1 
| none 
| none 
| 

| 42 
| SE_ShadowStep 
| Shadow Step 
| Warps player a short distance in a random direction. 
| Unknown (Seen 1 to 50) 
| none 
| none 
| This effect is handled by the client. Changing the base value does not appear to have any affect. 

| 43 
| SE_Berserk 
| Berserk 
| Sets entity as 'Berserk' allowing for chance to crippling blow regardless of hit points and class. 
| 1 
| none 
| none 
| This is an unused live spell effect. Custom Spell Effect may be subject to change if live reuses the SPA. 

| 44 
| SE_Lycanthropy 
| Stacking: Delayed Heal Marker 
| Used as stacking checker in healing effects that use spell triggers. 
| stacking overwrite value 
| none 
| none 
| 

| 45 
| SE_Vampirism 
| Vampirism 
| Heal for a percentage for your melee damage on target. 
| Percentage 
| none 
| none 
| This is an unused live spell effect. Custom Spell Effect may be subject to change if live reuses the SPA. 

| 46 
| SE_ResistFire 
| Fire Resist 
| Modify fire resist by amount 
| amout 
| none 
| max amount 
| 

| 47 
| SE_ResistCold 
| Cold Resist 
| Modify cold resist by amount 
| amout 
| none 
| max amount 
| 

| 48 
| SE_ResistPoison 
| Poison Resist 
| Modify poison resist by amount 
| amout 
| none 
| max amount 
| 

| 49 
| SE_ResistDisease 
| Disease Resist 
| Modify disease resist by amount 
| amout 
| none 
| max amount 
| 

| 50 
| SE_ResistMagic 
| Magic Resist 
| Modify magic resist by amount 
| amout 
| none 
| max amount 
| 

| 51 
| SE_DetectTraps 
| Detect Traps 
| 
| 
| 
| 
| 

| 52 
| SE_SenseDead 
| Detect Undead 
| Point player in direction of nearest Undead NPC 
| 1 
| none 
| none 
| 

| 53 
| SE_SenseSummoned 
| Detect Summoned 
| Point player in direction of nearest Summoned NPC 
| 1 
| none 
| none 
| 

| 54 
| SE_SenseAnimals 
| Detect Animals 
| Point player in direction of nearest Animal NPC 
| 1 
| none 
| none 
| 

| 55 
| SE_Rune 
| Rune 
| Absorb all melee damage until a maxium amount of damage is taken then fades. 
| amount 
| none 
| max amount 
| 

| 56 
| SE_TrueNorth 
| True North 
| Points player in north direction. 
| 1 
| none 
| none 
| 

| 57 
| SE_Levitate 
| Levitation 
| Float above ground and take no fall damage. 
| 1 (increase for stacking overwrite) 
| levitate while moving (Set to 1) 
| none 
| Levitate while moving is seen on Live 'Flying Mounts' 

| 58 
| SE_Illusion 
| Illusion 
| Change appearance. 
| race id or gender id 
| texture id (see notes) 
| helmet id (see notes) 
| Illusions have complicated rules. See https://docs.eqemu.io/server/categories/spells/illusion-spell-guidelines 

| 59 
| SE_DamageShield 
| Damage Shield 
| Take damage for the damage shield amount when meleeing a target with his effect. 
| amount 
| none 
| max amount 
| 

| 60 
| SE_TransferItem 
| Transfer Item 
| 
| 
| 
| 
| 

| 61 
| SE_Identify 
| Identify 
| Provides information about the item that your target is holding. 
| 1 
| none 
| none 
| To use, hold item on cursor and cast spell on self or target. The 'lore' field from items table is displayed in chat window. 

| 62 
| SE_ItemID 
| Item ID 
| 
| 
| 
| 
| 

| 63 
| SE_WipeHateList 
| Memblur 
| Chance to wipe hate list of target, repeates every tic if in a buff. 
| percent chance 
| none 
| unknown 
| Actual chance to memory blur is much higher than the spells base value, caster level and CHA modifiers are added get the final calculated percent chance 

| 64 
| SE_SpinTarget 
| Spin Stun 
| Spins and stuns target 
| duration ms 
| pvp duration ms 
| max target level 
| 

| 65 
| SE_InfraVision 
| Infravision 
| Improved night vision 
| 1 
| none 
| none 
| 

| 66 
| SE_UltraVision 
| Ultravision 
| Vastly improved night vision 
| 1 
| none 
| none 
| 

| 67 
| SE_EyeOfZomm 
| Eye Of Zomm 
| Transfers your vision and control to a summoned temporary pet 
| 1 
| none 
| none 
| Set 'Teleport Zone' field to be the same as 'type' field in of the pet you want in the pets table. 

| 68 
| SE_ReclaimPet 
| Reclaim Energy 
| Kills your pet in exchange for mana. Returns 75 percent of pet spell actual mana cost. 
| 1 
| none 
| none 
| 

| 69 
| SE_TotalHP 
| Max HP 
| Modify maximum hit points by amount. 
| amount 
| none 
| max amount 
| 

| 70 
| SE_CorpseBomb 
| Corpse Bomb 
| 
| 
| 
| 
| 

| 71 
| SE_NecPet 
| Create Undead Pet 
| Summon a pet. 
| 1 
| none 
| none 
| Set 'Teleport Zone' field to be the same as 'type' field in of the pet you want in the pets table. 

| 72 
| SE_PreserveCorpse 
| Preserve Corpse 
| 
| 
| 
| 
| 

| 73 
| SE_BindSight 
| Bind Sight 
| Transfers your vision to your target. 
| 1 
| none 
| none 
| 

| 74 
| SE_FeignDeath 
| Feign Death 
| Fall to the ground and have a chance to loss aggro from engaged NPCs. 
| success chance 
| none 
| none 
| 

| 75 
| SE_VoiceGraft 
| Voice Graft 
| Speak through your pet 
| 1 
| none 
| none 
| 

| 76 
| SE_Sentinel 
| Sentinel 
| Creates a proximity zone where cast that alerts caster if NPC's or Players enter it. 
| 1 
| none 
| none 
| Not implemented on EQEMU 

| 77 
| SE_LocateCorpse 
| Locate Corpse 
| Points player in direction of their target's corpse. 
| 1 
| none 
| none 
| 

| 78 
| SE_AbsorbMagicAtt 
| Spell Rune 
| Absorb all spell damage until a maxium amount of damage is taken then fades. 
| amount 
| none 
| max amount 
| 

| 79 
| SE_CurrentHPOnce 
| Current HP Once 
| Modify hit points by amount. Instant heals and direct damage. 
| amount 
| target restriction id 
| max amount 
| Negative base value for damage 

| 80 
| SE_EnchantLight 
| Enchant Light 
| 
| 
| 
| 
| 

| 81 
| SE_Revive 
| Resurrect 
| Summon player to corpse and restore a percentage of experience. 
| percentage exp 
| none 
| none 
| 

| 82 
| SE_SummonPC 
| Summon Player 
| Summon a player to casters location. 
| 1 
| none 
| none 
| 

| 83 
| SE_Teleport 
| Teleport 
| Teleport to another zone or location. 
| coordinate(x,y,z,h) 
| none 
| none 
| Set 'Teleport Zone' field to zone short name OR set to 'same' to teleport within same zone. To set all xyzh cooridinates, you have use the following. Use this effectid only once in first effect slot . Cooridinates defined as effect_base_value1=x effect_base_value2=y effect_base_value3=z effect_base_value4=h 

| 84 
| SE_TossUp 
| Gravity Flux 
| Toss up into the air. 
| distance (negative) 
| none 
| none 
| 

| 85 
| SE_WeaponProc 
| Add Melee Proc 
| Add proc to melee 
| spellid 
| rate modifer 
| none 
| 

| 86 
| SE_Harmony 
| Reaction Radius 
| Set NPC assist radius 
| amount 
| none 
| none 
| 

| 87 
| SE_MagnifyVision 
| Magnification 
| Zoom players vision 
| amount 
| none 
| none 
| 

| 88 
| SE_Succor 
| Evacuate 
| Teleport Group/Self to a defined location or to safe point in zone with a 2 percent fail rate 
| coordinate(x,y,z,h) 
| none 
| none 
| Set 'Teleport Zone' field to zone short name OR set to 'same' to evac within same zone. To set all xyzh cooridinates, you have use the following. Use this effectid only once in first effect slot . Cooridinates defined as effect_base_value1=x effect_base_value2=y effect_base_value3=z effect_base_value4=h 

| 89 
| SE_ModelSize 
| Player Size 
| Modify targets size by percent or set to a specific model size. 
| percent shrink or grow 
| model size 
| unknown 
| Base greater than 100 for growth (120 = 20 pct growth) 

| 90 
| SE_Cloak 
| Ignore Pet 
| Ignore pet 
| 1 
| none 
| none 
| Not implemented on EQEMU 

| 91 
| SE_SummonCorpse 
| Summon Corpse 
| Summon targets corpse to caster. 
| max target level 
| 
| 
| 

| 92 
| SE_InstantHate 
| Hate 
| Add or remove a set amount of hate instantly from target. 
| amount 
| none 
| max amount 
| Positive value increases hate. 

| 93 
| SE_StopRain 
| Control Weather 
| Stops zone weather related rain. 
| 1 
| none 
| none 
| 

| 94 
| SE_NegateIfCombat 
| Make Fragile 
| Removes buff if player casts or does any combat skill. 
| 1 
| none 
| none 
| 

| 95 
| SE_Sacrifice 
| Sacrifice 
| Kills player and creates 'Essence Emerald', corpse can not be resurrected 
| 1 
| none 
| none 
| 

| 96 
| SE_Silence 
| Silence 
| Prevents spell casting. 
| 1 (increase for stacking overwrite) 
| none 
| unknown 
| 

| 97 
| SE_ManaPool 
| Max Mana 
| Modify max mana pool by amount. 
| amount 
| none 
| max amount 
| 

| 98 
| SE_AttackSpeed2 
| Attack Speed: Does not exceed cap 
| Modify attack speed by percent. Stacks with other Attack Speed effects. Does need exceed haste cap. 
| percent haste or slow 
| none 
| none 
| Base greater than 100 for haste (120 = 20 pct haste) 

| 99 
| SE_Root 
| Root 
| Immobilize target. 
| -10000 
| none 
| none 
| 

| 100 
| SE_HealOverTime 
| Heal Over Time 
| Heal over time. Stacks with other heal over time effects. 
| amount 
| target restriction id 
| max amount 
| 

| 101 
| SE_CompleteHeal 
| Complete Heal: With Recast Blocker Buff 
| Heal for baseline of 7500 HP and apply a buff icon that blocks the same effect from taking hold until it fades. 
| heal amount multiplier 
| none 
| max heal amount multipler 
| 

| 102 
| SE_Fearless 
| Fear Immunity 
| Immune to fear effect. 
| 1 
| none 
| none 
| 

| 103 
| SE_CallPet 
| Summon Pet 
| Summon Pet to owner. 
| 1 
| none 
| none 
| 

| 104 
| SE_Translocate 
| Translocate 
| Teleport your target to a specific location or bind. 
| coordinate(x,y,z,h) or Bind Point ID 
| none 
| none 
| Set 'Teleport Zone' field to zone short name OR set to 'same' to evac within same zone. To set all xyzh cooridinates, you have use the following. Use this effectid only once in first effect slot . If 'Teleport_Zone' field is not set, then will send to bind point id, set base value to Bind Point ID (1=Primary, 2=Secondary 3=Tertiary) 

| 105 
| SE_AntiGate 
| Inhibit Gate 
| Prevent target from casting gate 
| Seen 1 to 3 
| none 
| none 
| Unclear what base value determines. May be related to Bind Point IDs. 

| 106 
| SE_SummonBSTPet 
| Summon Warder 
| Summon a beastlord pet. 
| 1 
| none 
| none 
| Set 'Teleport Zone' field to be the same as 'type' field in of the pet you want in the pets table. 

| 107 
| SE_AlterNPCLevel 
| Alter NPC Level 
| Change NPC level by amount. Level returns to original level when buff fades. 
| amount 
| none 
| none 
| This is a no longer used on live. Custom Spell Effect may be subject to change if live reuses the SPA. 

| 108 
| SE_Familiar 
| Summon Familiar 
| Summon a familiar. 
| 0 or 1 
| none 
| none 
| Set 'Teleport Zone' field to be the same as 'type' field in of the pet you want in the pets table. 

| 109 
| SE_SummonItemIntoBag 
| Summon into Bag 
| Summons item into a summoned bag. 
| item id 
| none 
| none 
| To use this the first effectid must be SPA 32 SE_SummonItem and this must be a bag such as Phantom Satchel ID 17310. Then use this effectid to summon items that will go into that bag. 

| 110 
| SE_IncreaseArchery 
| Increase Archery 
| 
| 
| 
| 
| 

| 111 
| SE_ResistAll 
| All Resists 
| Modify all resists by amount. 
| amount 
| none 
| max amount 
| 

| 112 
| SE_CastingLevel 
| Casting Level 
| Modify casting level by amount, this will determine fizzel rate. 
| amount 
| none 
| none 
| 

| 113 
| SE_SummonHorse 
| Summon Mount 
| Summon a mount 
| 1 
| none 
| none 
| Set 'Teleport Zone' field to be the same as 'filename' field in of the mount you want in the horses table. 

| 114 
| SE_ChangeAggro 
| Hate Multiplier 
| Modify hate generated by percent 
| percent hate modifer 
| none 
| none 
| 

| 115 
| SE_Hunger 
| Food 
| Resets hunger counter preventing hunger and thirst checks. 
| 1 
| none 
| none 
| Set to positive values for potency of detrimental spells 

| 116 
| SE_CurseCounter 
| Curse Counter 
| Determines potency of determental curse spells or potency of cures. 
| amount 
| 
| 
| 

| 117 
| SE_MagicWeapon 
| Make Weapons Magical 
| Allows non-magic weapons to be considered magical 
| 1 
| none 
| none 
| 

| 118 
| SE_Amplification 
| Singing Amplification 
| Modifies bard 'singing modifier' by percent. 
| percent 
| none 
| none 
| Recasting this effect will cause it to focus itself, increasing its potency. 

| 119 
| SE_AttackSpeed3 
| Attack Speed: Overhaste 
| Modify attack speed by percent. Stacks with other Attack Speed effects. Can exceed haste cap. 
| percent haste or slow 
| none 
| none 
| Base greater than 100 for haste (120 = 20 pct haste) 

| 120 
| SE_HealRate 
| Incoming Healing Effectiveness 
| Modify incoming heals by percentage. 
| percent healing 
| none 
| none 
| 

| 121 
| SE_ReverseDS 
| Reverse Damage Shield 
| Heal for the reverse damage shields amount when meleeing a target with his effect. 
| amount 
| 
| 
| Negative value will cause the reverse damage shield to heal. 

| 122 
| SE_ReduceSkill 
| Reduce Skill 
| pending 
| pending 
| pending 
| pending 
| not implemented 

| 123 
| SE_Screech 
| Stacking: Screech 
| If a buff has a Screech base value of +1 that buff will block any other buff that contains Screech with a base value of -1 
| 1 or -1 
| none 
| none 
| 

| 124 
| SE_ImprovedDamage 
| Focus: Spell Damage 
| Modify outgoing spell damage by percentage. 
| min percent 
| none 
| max percent 
| Use random effectiveness if base and max value are defined, where base is always lower end and max the higher end of the random range. If random value not wanted, then only set a base value. 

| 125 
| SE_ImprovedHeal 
| Focus: Healing 
| Modify outgoing spell healing by percentage. 
| min percent 
| none 
| max percent 
| Use random effectiveness if base and max value are defined, where base is always lower end and max the higher end of the random range. If random value not wanted, then only set a base value. 

| 126 
| SE_SpellResistReduction 
| Focus: Spell Resist Rate 
| Modify outgoing spell resistance rate by percentage. 
| min percent 
| none 
| none 
| 

| 127 
| SE_IncreaseSpellHaste 
| Focus: Spell Cast Time 
| Modify outgoing spell casting time by percentage. 
| percent 
| none 
| none 
| 

| 128 
| SE_IncreaseSpellDuration 
| Focus: Spell Duration 
| Modify outgoing spell buff duration by percentage. 
| percent 
| none 
| none 
| 

| 129 
| SE_IncreaseRange 
| Focus: Spell Range 
| Modify outgoing spell casting range percentage. 
| percent 
| none 
| none 
| 

| 130 
| SE_SpellHateMod 
| Focus: Spell and Bash Hate 
| Modify outgoing spell and bash hate by percentage. 
| min percent 
| none 
| max percent 
| Use random effectiveness if base and max value are defined, where base is always lower end and max the higher end of the random range. If random value not wanted, then only set a base value. 

| 131 
| SE_ReduceReagentCost 
| Focus: Chance of Using Reagent 
| Modify outgoing spells chance to not consume reagent by percentage 
| min percent 
| none 
| max percent 
| Use random effectiveness if base and max value are defined, where base is always lower end and max the higher end of the random range. If random value not wanted, then only set a base value. 

| 132 
| SE_ReduceManaCost 
| Focus: Spell Mana Cost 
| Reduce outgoing spells mana cost by percentage 
| min percent 
| none 
| max percent 
| Use random effectiveness if base and max value are defined, where base is always lower end and max the higher end of the random range. If random value not wanted, then only set a base value. 

| 133 
| SE_FcStunTimeMod 
| Focus: Spell Stun Duration 
| Modify outgoing spell stun duration by percentage. 
| percent 
| none 
| none 
| 

| 134 
| SE_LimitMaxLevel 
| Limit: Max Level 
| Max level of spell that can be focused, if 'limit' is set then decrease effectiviness by the limit values percent per level over max level. 
| max level 
| effectiviness percent 
| none 
| 

| 135 
| SE_LimitResist 
| Limit: Resist 
| Resist Type(s) that a spell focus can require or exclude. 
| resist type 
| none 
| none 
| Include set value to positive 

| 136 
| SE_LimitTarget 
| Limit: Target 
| Target Type(s) that a spell focus can require or exclude. 
| target type 
| none 
| none 
| Include set value to positive 

| 137 
| SE_LimitEffect 
| Limit: Effect 
| Spell effect(s) that a spell focus can require or exclude. 
| spell effect ID 
| none 
| none 
| Include set value to positive 

| 138 
| SE_LimitSpellType 
| Limit: SpellType 
| Only allow focus spells that are Beneficial or Detrimental. 
| 0=Detrimental, 1=Beneficial 
| none 
| none 
| 

| 139 
| SE_LimitSpell 
| Limit: Spell 
| Specific spell id(s) that a spell focus can require or exclude. 
| spell ID 
| none 
| none 
| Include set value to positive 

| 140 
| SE_LimitMinDur 
| Limit: Min Duration 
| Mininum duration of spell that can be focused. 
| tics 
| none 
| none 
| Set duration in tics, 1 tick is 6 seconds of game time 

| 141 
| SE_LimitInstant 
| Limit: Instant spells only 
| Include or exclude if an instant cast spell can be focused. 
| 0=Exclude if Instant, 1=Allow only if Instant 
| none 
| none 
| 

| 142 
| SE_LimitMinLevel 
| Limit: Min Level 
| Mininum level of spell that can be focused. 
| level 
| none 
| none 
| 

| 143 
| SE_LimitCastTimeMin 
| Limit: Min Cast Time 
| Mininum cast time of spell that can be focused. 
| milliseconds 
| none 
| none 
| 

| 144 
| SE_LimitCastTimeMax 
| Limit: Max Cast Time 
| Max cast time of spell that can be focused 
| milliseconds 
| none 
| none 
| 

| 145 
| SE_Teleport2 
| Banish 
| Teleports targets to a defined location or to safe point in zone 
| coordinate(x,y,z,h) 
| none 
| none 
| Set 'Teleport Zone' field to zone short name OR set to 'same' to teleport within same zone. To set all xyzh cooridinates, you have use the following. Use this effectid only once in first effect slot . Cooridinates defined as effect_base_value1=x effect_base_value2=y effect_base_value3=z effect_base_value4=h 

| 146 
| SE_ElectricityResist 
| Portal Locations 
| pending 
| pending 
| pending 
| pending 
| 

| 147 
| SE_PercentalHeal 
| Percent HP Heal 
| Modify targets hit points for percent value of the targets max HP. Heal or damage. 
| percentage 
| none 
| max amount of hit points 
| Negative base value for damage 

| 148 
| SE_StackingCommand_Block 
| Stacking: Block 
| Effect is found on buff and is used to prevent another buff from taking hold if specific criteria is met. 
| spell effect id 
| none 
| Block if less than this value. 
| Formula - 201 = Slot to block 

| 149 
| SE_StackingCommand_Overwrite 
| Stacking: Overwrite 
| Effect is found on buff and is used to overwrite another buff if specific criteria is met. 
| spell effect id 
| none 
| Overwrite if less than this value. 
| Formula - 201 = Slot to block 

| 150 
| SE_DeathSave 
| Death Save 
| When this effect is applied to a target the owner of the buff is given a chance at receiving a heal when under 15 percent hit points. 
| 1 = 300 HP Healed, 2 = 8000 HP Healed 
| min target level to apply override heal amount 
| override heal amount 
| If max value is set as heal amount this value will be used instead as the heal amount if the owner of the buff is the mininum level specified in limit field. Chance to receive a heal is determined by the owner of the buffs Charisma. [Chance = ((Charisma * 3) +1) / 10) ] . SPA 277 gives a second chance to be healed if you fail. 

| 151 
| SE_SuspendPet 
| Suspend Pet 
| Places a pet in temporary storage. 
| save type 
| none 
| none 
| Save Types, 0 = save pet with no buffs or equipment, 1 = save pet with no buffs or equipment, 2 = unknown. SPA 308 allows for suspended pets to be resummoned after zoning. 

| 152 
| SE_TemporaryPets 
| Summon a Pet Swarm 
| Summon temporary pet(s) that will fade after duration, will stack with regular pets. 
| amount of pets 
| none 
| duration seconds 
| Set 'Teleport Zone' field to be the same as 'type' field in of the pet you want in the pets table. 

| 153 
| SE_BalanceHP 
| Balance Party HP 
| Balances groups HP with a percent modifier to the damage being distributed. 
| percent modifier 
| max HP taken from player 
| none 
| Positive base value increases damage being distrubuted 

| 154 
| SE_DispelDetrimental 
| Dispel Detrimental 
| Dispels detrimental buffs. 
| percent chance x 10 
| none 
| none 
| Actual percent chance is calculated as base / 10 

| 155 
| SE_SpellCritDmgIncrease 
| Spell Critical Damage 
| Modifies critical spell damage by percent 
| percent modifier 
| none 
| none 
| 

| 156 
| SE_IllusionCopy 
| Illusion: Target 
| Turns caster into mirror image of target. 
| Seen 0,1,30 
| none 
| none 
| Unknown what base values represent. 

| 157 
| SE_SpellDamageShield 
| Spell Damage Shield 
| Inflicts non-melee damage on caster of a spell. 
| amount damage shield (negative) 
| none 
| unknown 
| Spells must have 'feedbackable' field set to a value otherwise they will not be affected by spell damage shields. 

| 158 
| SE_Reflect 
| Reflect Spell 
| Reflect casted detrimental spell back at caster. 
| percent chance 
| resist modifier 
| percent of base damage modifier 
| Spells must have 'reflectable' field set to a value otherwise they will not be reflected. Resist modifer, positive value reduces the resist rate, negative value increases the resist rate. Percent of base damage modifer, max greater than 100 for damage mod (120 = 20 pct increase in damage) 

| 159 
| SE_AllStats 
| All Stats 
| Modify all base stats by percent. (STR, AGI, DEX, WIS, INT, CHA) 
| amount 
| none 
| max amount 
| Effect currently handled entirely client side. 

| 160 
| SE_MakeDrunk 
| Drunk 
| Intoxicate if tolerance under the base value. 
| amount 
| none 
| max amount 
| 

| 161 
| SE_MitigateSpellDamage 
| Mitigate Spell Damage Rune 
| Mitigate incoming spell damage by percentage until rune fades. 
| percent mitigation 
| max damage absorbed per hit 
| rune amount 
| Special: If this effect is placed on item as worn effect or as an AA, it will provide stackable percent spell mitigation for the base value. 

| 162 
| SE_MitigateMeleeDamage 
| Mitigate Melee Damage Rune 
| Mitigate incoming melee damage by percentage until rune fades. 
| percent mitigation 
| max damage absorbed per hit 
| rune amount 
| 

| 163 
| SE_NegateAttacks 
| Absorb Damage 
| Complete or partially block incoming spell and melee damage 
| amount of blocked hits 
| none 
| max amount of damage blocked per hit 
| 

| 164 
| SE_AppraiseLDonChest 
| Sense LDoN Chest 
| Attempt to sense the presence of a cursed trap on the targeted object. 
| 1 
| none 
| skill check value 
| 

| 165 
| SE_DisarmLDoNTrap 
| Disarm LDoN Trap 
| Attempt to disarm a cursed trap on the targeted object. 
| 1 
| none 
| skill check value 
| 

| 166 
| SE_UnlockLDoNChest 
| Unlock LDoN Chest 
| Attempt to destroy any cursed lock present on the targeted object. 
| 1 
| none 
| skill check value 
| 

| 167 
| SE_PetPowerIncrease 
| Focus: Pet Power 
| Increase statistics and level of the pet when summoned. 
| power value 
| none 
| none 
| Pet power can be scaled automatically if 'petpower' field in pets table is set to 0 or -1, if the power field is set to anything it will look to find the cooresponding pet in the table with same power for that 'type'. 

| 168 
| SE_MeleeMitigation 
| Defensive 
| Modify incoming melee damage by percent. 
| percent modifer 
| none 
| none 
| Negative base value decreases damage taken 

| 169 
| SE_CriticalHitChance 
| Critical Melee Chance 
| Modify melee critical hit chance by skill. 
| percent modifer 
| skill type (-1 = all skill types) 
| none 
| 

| 170 
| SE_SpellCritChance 
| Spell Critical Chance 
| Modifies spell critical chance by percent. 
| percent modifier 
| none 
| none 
| Must have a chance to perform critical hits in order to have a chance to crippling blow. 

| 171 
| SE_CrippBlowChance 
| Crippling Blow Chance 
| Modify melee crippling blow chance 
| percent modifer 
| none 
| none 
| 

| 172 
| SE_AvoidMeleeChance 
| Evasion 
| Modify chance to avoid melee. 
| percent modifer 
| none 
| none 
| 

| 173 
| SE_RiposteChance 
| Riposte 
| Modify chance to riposte. 
| percent modifer 
| none 
| none 
| 

| 174 
| SE_DodgeChance 
| Dodge 
| Modify chance to dodge. 
| percent modifer 
| none 
| none 
| 

| 175 
| SE_ParryChance 
| Parry 
| Modify chance to parry. 
| percent modifer 
| none 
| none 
| 

| 176 
| SE_DualWieldChance 
| Dual Wield 
| Modify dual weild chance. 
| percent modifer 
| none 
| none 
| 

| 177 
| SE_DoubleAttackChance 
| Double Attack 
| Modify double attack chance. 
| percent modifer 
| none 
| none 
| 

| 178 
| SE_MeleeLifetap 
| Melee Lifetap 
| Heal for a percentage for your melee damage on target. 
| percentage 
| none 
| none 
| Positive value will heal you. Negative value will damage you 

| 179 
| SE_AllInstrumentMod 
| All Instrument Modifier 
| Set modifier value for all instrument and singing modifers that will be used if higher then the respective item modifers. 
| modifier percentage 
| none 
| none 
| 

| 180 
| SE_ResistSpellChance 
| Resist Spell Chance 
| Modify chance to resist incoming spells by percent. 
| percent modifer 
| none 
| none 
| 

| 181 
| SE_ResistFearChance 
| Resist Fear Spell Chance 
| Modify chance to resist incoming fear spells by percent. 
| percent modifer 
| none 
| none 
| 

| 182 
| SE_HundredHands 
| Attack Delay Reducation 
| Modify attack delay by percent. 
| percent modifier 
| none 
| none 
| Negative value reduces delay, example -115 is calculated as a 15 percent reduction (-115/100). Positive value increases delay, 300 is calculated as a 30 percent increase in delay 

| 183 
| SE_MeleeSkillCheck 
| Melee Skill Chance 
| Unknown intended effect. 
| percent chance 
| skill type (-1 = all skill types) 
| none 
| No longer used on live. It provides no benefits on eqemu. 

| 184 
| SE_HitChance 
| Chance to Hit 
| Modify chance to hit by skill 
| percent modifer 
| skill type (-1 = all skill types) 
| none 
| 

| 185 
| SE_DamageModifier 
| Skills Damage Modifier 
| Modify melee damage by skill. 
| percent modifer 
| skill type (-1 = all skill types) 
| none 
| 

| 186 
| SE_MinDamageModifier 
| Skills Minimum Damage Modifier 
| Modify melee minimum damage by skill. 
| percent modifer 
| skill type (-1 = all skill types) 
| none 
| 

| 187 
| SE_BalanceMana 
| Balance Party Mana 
| Balances groups mana with a percent modifier to the damage being distributed. 
| percent modifer 
| max mana taken from player 
| none 
| Positive base value increases damage being distributed 

| 188 
| SE_IncreaseBlockChance 
| Chance to block 
| Modify chance to block melee. 
| percent modifer 
| none 
| none 
| 

| 189 
| SE_CurrentEndurance 
| Endurance 
| Modify targets endurance by amount, repeates every tic if in a buff. 
| amount 
| none 
| max amount 
| 

| 190 
| SE_EndurancePool 
| Max Endurance 
| Modify max endurance pool by amount. 
| amount 
| none 
| max amount 
| 

| 191 
| SE_Amnesia 
| Amnesia 
| Prevents disciplines use. 
| 1 (increase for stacking overwrite) 
| none 
| none 
| 

| 192 
| SE_Hate 
| Hate 
| Modify targets hate toward you by amount, repeates every tic if in a buff. 
| amount 
| none 
| max amount 
| 

| 193 
| SE_SkillAttack 
| Skill Attack 
| Perform a combat round using a specific skill at a set weapon damage and chance to hit modifier. 
| weapon damage 
| chance to hit modifier 
| unknown 
| Skill used to perform combat round is determined by the 'skill' field in spells table. 

| 194 
| SE_FadingMemories 
| Fade 
| Remove from hate lists and make invisible. Can set max level of NPCs that can be affected. 
| success chance 
| max level (ROF2 era) 
| max level (modern era) 
| Support for max level requires Rule (Spells, UseFadingMemoriesMaxLevel) to be true. If used from limit field, then it set as the level, ie. max level of 75 would use limit value of 75. If set from max field, max level 75 would use max value of 1075, if you want to set it so it checks a level range above the spell target then for it to only work on mobs 5 levels or below you set max value to 5. 

| 195 
| SE_StunResist 
| Stun Resist 
| Modifies chance to resist a stun from a bash or kick by percent 
| percent modifier 
| none 
| none 
| 

| 196 
| SE_StrikeThrough 
| Strikethrough 
| Modify chance to strikethrough by percent, bypassing an opponent's special defenses, such as dodge, block, parry, and riposte 
| percent modifier 
| none 
| none 
| 

| 197 
| SE_SkillDamageTaken 
| Skill Damage Taken 
| Modify damage taken by percent from specific skill. 
| percent modifier 
| skill type (-1 = all skill types) 
| none 
| 

| 198 
| SE_CurrentEnduranceOnce 
| Instant Endurance 
| Modify targets endurance by amount. 
| amount 
| none 
| max amount 
| Negative base value decreases damage taken 

| 199 
| SE_Taunt 
| Taunt 
| Chance to taunt target and apply instant hate. 
| taunt success chance 
| amount hate added 
| 
| 

| 200 
| SE_ProcChance 
| Worn Proc Chance 
| Modify worn weapon proc chance by percent. 
| percent modifier 
| none 
| none 
| 

| 201 
| SE_RangedProc 
| Ranged Proc 
| Add proc to ranged attacks 
| spellid 
| rate modifer 
| none 
| 

| 202 
| SE_IllusionOther 
| Project Illusion 
| Allows next casted self only illusion buff to be cast on a targeted player in group. 
| none 
| none 
| none 
| 

| 203 
| SE_MassGroupBuff 
| Mass Group Buff 
| Allows next casted Group Buff to hit all players and pets within a large radius from caster at double the mana cost. 
| 1 
| none 
| none 
| 

| 204 
| SE_GroupFearImmunity 
| Group Fear Immunity 
| Provides immunity to fear for group. 
| duration 
| none 
| none 
| Duration is calculated as base value * 10. Thus, value of 1 would be 10 seconds. This is not a buff and gives no icon. 

| 205 
| SE_Rampage 
| AE Rampage 
| Perform a primary slot combat rounds on all creatures within a 40 foot radius. 
| number of attack rounds 
| max entities hit per round 
| aoe range override 
| On live base is always set to 1, if more than one attack is a spell it uses this SPA in multiple slots. Limit value can be used to set a max amount of entities able to be attacked per round. 

| 206 
| SE_AETaunt 
| AE Taunt 
| Taunts all creatures within a 40 foot radius, placing you 'base values' points of hate higher than your opponents' previously most hated target. 
| added hate 
| none 
| aoe range override 
| 

| 207 
| SE_FleshToBone 
| Flesh to Bone 
| Turns meat or body parts items into bone chips. 
| 1 
| none 
| none 
| 

| 208 
| SE_PurgePoison 
| Purge Poison 
| 
| 
| 
| 
| 

| 209 
| SE_DispelBeneficial 
| Dispel Beneficial 
| Dispels beneficial buffs. 
| percent chance x 10 
| none 
| none 
| Actual percent chance is calculated as base / 10 

| 210 
| SE_PetShield 
| Pet Shield 
| Allows pet to use 'shield ability' on owner to reduce 50 percent of damage taken by owner for duration 
| Duration multiplier 1=12 seconds, 2=24 ect 
| mitigation on pet owner override 
| mitigation on pet overide 
| Special: limit and max values are not on live, they can be used to give mitigation penalties or bonuses to shielder or shielded. 

| 211 
| SE_AEMelee 
| AE Melee 
| Perform a primary slot combat rounds on all creatures within a 40 foot radius for a duration. 
| Duration multiplier 1=12 seconds, 2=24 ect 
| none 
| none 
| Only implemented for clients. 

| 212 
| SE_FrenziedDevastation 
| Frenzied Devastation 
| Increase spell critical chance and while present all direct damage spells cost double the amount of mana. 
| 1 
| chance modifier 
| none 
| Live no longer uses the effect in this way. It is now a focus effect. 

| 213 
| SE_PetMaxHP 
| Pet Max HP 
| Modifies your pets maximum HP by percent. 
| percent modifier 
| none 
| none 
| This effect goes on the pet owner and then the benefit is applied to the pet. 

| 214 
| SE_MaxHPChange 
| Change Max HP 
| Modify your maximum HP by percent. 
| percent modifier 
| none 
| none 
| Base value is divided by 100 to get actual percentage. Example, for 10 percent max HP increase, base value should be 1000. 

| 215 
| SE_PetAvoidance 
| Pet Avoidance 
| Modifies your pets chance to avoid melee by percent. 
| percent modifier 
| none 
| none 
| This effect goes on the pet owner and then the benefit is applied to the pet. 

| 216 
| SE_Accuracy 
| Accuracy 
| Modify your chance to hit by modifying accuracy by amount. 
| amount accuracy 
| skill type (-1 = all skill types) 
| none 
| AA version of this is not skill limited. Differs from SPA 184, which is a multiplier of your total accuracy. 

| 217 
| SE_HeadShot 
| Headshot 
| Grants your archery attacks a chance to deal extra damage to humanoid NPC targets. 
| percent chance 
| damage amount 
| none 
| Used with SPA 346 which limits headshot by level and adds a bonus chance. 

| 218 
| SE_PetCriticalHit 
| Pet Crit Melee 
| Modifies your pets chance to perform a critical melee hit by percent. 
| percent modifier 
| none 
| none 
| This effect goes on the pet owner and then the benefit is applied to the pet. 

| 219 
| SE_SlayUndead 
| Slay Undead 
| Chance to do increased damage verse undead. 
| damage percent modifier 
| chance 
| none 
| Actual chance will be your limit value / 10. Example a 14 percent chance would require limit value of 140. Damage modifier baseline is 100, Base greater than 100 for increased damage (120 = 20 pct damage increase) 

| 220 
| SE_SkillDamageAmount 
| Skill Damage Bonus 
| Add a flat amount of damage when a specific melee skill is used. 
| amount 
| skill type (-1 = all skill types) 
| none 
| 

| 221 
| SE_Packrat 
| Reduce Weight 
| Modify weight of your inventory by percent. 
| percent modifier 
| none 
| none 
| 

| 222 
| SE_BlockBehind 
| Block Behind 
| Modify chance to block from behind. 
| percent modifer 
| none 
| none 
| 

| 223 
| SE_DoubleRiposte 
| Double Riposte 
| Chance to do an additional riposte attack after a successful riposte. 
| percent chance 
| none 
| none 
| No longer used on live. 

| 224 
| SE_GiveDoubleRiposte 
| Additional Riposte 
| Chance to do an additional riposte attack, or skill based riposte like Flying Kick. 
| percent chance 
| skill type 
| none 
| If limit value is set you can riposte using a specific special attack skill, like 'flying kick'. You can not have multiple skills that can riposte, thus limited to use in only one effect. 

| 225 
| SE_GiveDoubleAttack 
| Double Attack 
| Allows any class to double attack at a set percent chance or modifty chance if class can innately double attack. 
| percent chance or modifer 
| none 
| none 
| 

| 226 
| SE_TwoHandBash 
| Two Hand bash 
| Bash with a two handed weapon. 
| 1 
| none 
| none 
| Handled client side. 

| 227 
| SE_ReduceSkillTimer 
| Base Refresh Timer 
| Reduce base refresh timer of skill 
| time seconds (positive) 
| skill type 
| none 
| 

| 228 
| SE_ReduceFallDamage 
| Reduce Fall Dmg 
| Reduce the damage that you take from falling by percent. 
| percent modifer 
| none 
| none 
| 

| 229 
| SE_PersistantCasting 
| Cast Through Stun 
| Chance to continue casting while stunned. 
| percent chance 
| none 
| none 
| 

| 230 
| SE_ExtendedShielding 
| Increase Shield Distance 
| Modify the range of your /shield ability by an amount of distance 
| distance 
| none 
| none 
| 

| 231 
| SE_StunBashChance 
| Stun Bash Chance 
| Modify chance to land a stun using bash skill by percent 
| percent modifer 
| none 
| none 
| 

| 232 
| SE_DivineSave 
| Divine Save 
| Chance to return to life with the blessing Touch of the Divine when you would otherwise die. 
| percent chance 
| spellid 
| none 
| This effect triggers upon death, where base value gives you percent chance to cast Touch of the Divine which is an Invulnerability, heal, HoT and purify effect. Limit value can be used to add an additional spell being applied on death, usually this is a heal. 

| 233 
| SE_Metabolism 
| Metabolism 
| Modifies food and drink consumption rates. 
| percent modifer 
| none 
| none 
| Positive value decreases consumption rate 

| 234 
| SE_ReduceApplyPoisonTime 
| Poison Mastery 
| Decrease poison application time. 
| time 
| none 
| none 
| Reducation time calculated as base /1000. Example, 2.5 second reduction would be a base value of 2500. 

| 235 
| SE_ChannelChanceSpells 
| Focus Channelling 
| Modify chance to channel a spell and avoid being interupted by percent. 
| percent modifer 
| none 
| none 
| No longer used on live. 

| 236 
| SE_FreePet 
| Free Pet 
| 
| 
| 
| 
| 

| 237 
| SE_GivePetGroupTarget 
| Pet Affinity 
| Allows summoned pets to receive group buffs. 
| 1 
| none 
| none 
| This effect goes on the pet owner and then the benefit is applied to the pet. 

| 238 
| SE_IllusionPersistence 
| Permanent Illusion 
| Illusions will persist through zoning and last up to 16 hours. If base value increased to two, will persist through death. 
| 1 or 2 
| none 
| none 
| 1=Persist through zoning, 2=Persist through death 

| 239 
| SE_FeignedCastOnChance 
| Feign Death Through Spell Hit 
| Chance to feign death through spell hit. 
| percent chance 
| none 
| none 
| If spell is resisted your chance is multipled by two. 

| 240 
| SE_StringUnbreakable 
| String Unbreakable 
| 
| 
| 
| 
| 

| 241 
| SE_ImprovedReclaimEnergy 
| Improve Reclaim Energy 
| Modify amount of mana returned from from reclaim energy by percent. 
| percent modifier 
| none 
| none 
| 

| 242 
| SE_IncreaseChanceMemwipe 
| Increase Chance Memwipe 
| Modify the chance to wipe hate with memory blurr by percent. 
| percent modifier 
| none 
| none 
| Actual chance to memory blur is much higher than the memory blurs spells base value, caster level and CHA modifiers are added get the final calculated percent chance. This effect modifiers that final percent chance. 

| 243 
| SE_CharmBreakChance 
| Charm Break Chance 
| Modify chance of charm breaking early by percentage. 
| percent modifier 
| none 
| none 
| 

| 244 
| SE_RootBreakChance 
| Root Break Chance 
| Modify chance of the casters root being broken by percentage. 
| percent modifier 
| none 
| none 
| Modifies the base line root break chance. The benefit is given to any player casting on that NPC with the root, opposed to only the caster of the root. 

| 245 
| SE_TrapCircumvention 
| Trap Circumvention 
| Decreases the chance that you will set off a trap when opening a chest or other similar container by percentage. 
| percent modifier 
| none 
| none 
| 

| 246 
| SE_SetBreathLevel 
| Lung Capacity 
| Modify the amount of air you can hold in your lungs by percent 
| percent modifier 
| none 
| none 
| Should work client side. No server side support. 

| 247 
| SE_RaiseSkillCap 
| Increase SkillCap 
| Increase skill cap. 
| amount 
| skill type 
| none 
| 

| 248 
| SE_SecondaryForte 
| Extra Specialization 
| Gives you a second specialize skill that can go past 50 to 100. 
| 100 
| none 
| none 
| Changing base value will not alter this effect. 

| 249 
| SE_SecondaryDmgInc 
| Offhand Min Damage Bonus 
| Modify offhand weapons minimum damage bonus by percentage. 
| percent modifier 
| none 
| none 
| 

| 250 
| SE_SpellProcChance 
| Spell Proc Chance 
| Modify proc chance of combat procs gained by spells or AAs by percent. 
| percent modifier 
| none 
| none 
| 

| 251 
| SE_ConsumeProjectile 
| Endless Quiver 
| Chance not to consume a projectile when usimg archery or throwing skill. 
| percent chance 
| none 
| none 
| 

| 252 
| SE_FrontalBackstabChance 
| Backstab from Front 
| Chance to perform a full backstab while in front of the target. 
| percent chance 
| none 
| none 
| 

| 253 
| SE_FrontalBackstabMinDmg 
| Chaotic Stab 
| Allow a frontal backstab for mininum damage. 
| 1 
| none 
| none 
| 

| 254 
| SE_Blank 
| No Spell 
| Default value for an unused effect slot. 
| none 
| none 
| none 
| Do not replace this effect. 

| 255 
| SE_ShieldDuration 
| Shielding Duration 
| Extends the duration of your /shield ability. 
| seconds 
| none 
| none 
| 

| 256 
| SE_ShroudofStealth 
| Shroud Of Stealth 
| Rogue improved invsible. 
| 1 
| none 
| none 
| 

| 257 
| SE_PetDiscipline 
| Give Pet Hold 
| Gives pet command, pet /hold 
| 1 
| none 
| none 
| SPA 267 with a limit value of 15 is required now to obtain pet /hold. 

| 258 
| SE_TripleBackstab 
| Triple Backstab 
| Chance to perform a triple backstab. 
| percent chance 
| none 
| none 
| 

| 259 
| SE_CombatStability 
| AC Softcap Limit 
| Modify AC soft cap by amount. 
| amount 
| none 
| none 
| 

| 260 
| SE_AddSingingMod 
| Instrument Modifier 
| Set modifier value a specific instrument/singing skills that will be used if higher then the respective item modifier for that skill. 
| percent modifier 
| Item Type ID 
| none 
| Item Type IDs, 23=Woodwind, 24=Strings, 25=Brass, 26=Percussions, 50=Singing, 51=All instruments 

| 261 
| SE_SongModCap 
| Song Cap 
| Modify max song modifier cap by amount. 
| amount 
| none 
| none 
| Song cap is set in spells table as field 'song_cap'. Not used on live. 

| 262 
| SE_RaiseStatCap 
| Raise Stat Cap 
| Modify stat cap type by amount. 
| amount 
| stat type id 
| none 
| Stat type id, STR=0, STA=1, AGI=2, DEX=3, WIS=4, INT=5, CHA=6, MR=7, CR=8, FR=9, PR=10, DR=11, COR=12 

| 263 
| SE_TradeSkillMastery 
| Tradeskill Masteries 
| Allows you to raise additional standard tradeskill (Baking, Blacksmithing, Brewing, Fletching, Jewelcraft, Pottery, or Tailoring) from its initial Specialization cap of 200 up to 250. 
| amount of skills that can be raised (max=6) 
| none 
| none 
| 

| 264 
| SE_HastenedAASkill 
| Reduce AA Timer 
| Reduces reuse time on AA skills. 
| reducation amount seconds 
| aa id 
| none 
| This can be only set as an AA ability. 

| 265 
| SE_MasteryofPast 
| No Fizzle 
| Makes it impossible for you to fizzle spells at our below the spell level specified by the base value. 
| level 
| none 
| none 
| 

| 266 
| SE_ExtraAttackChance 
| Add Extra Attack: 2H Primary 
| Gives your double attacks a percent chance to perform an extra attack with 2-handed primary weapon. 
| percent chance 
| number of attacks 
| none 
| 

| 267 
| SE_AddPetCommand 
| Add Pet Commands 
| Enables multilpe different pet commands based on limit value. 
| 1 
| pet command type 
| none 
| Full list of command types found in common.h 

| 268 
| SE_ReduceTradeskillFail 
| Tradeskill Failure Rate 
| Modify chance to fail with given tradeskill by a percent. 
| chance modifier 
| none 
| none 
| 

| 269 
| SE_MaxBindWound 
| Bandage Percent Limit 
| Modify max HP you can bind wound by percent. 
| percent modifier 
| none 
| none 
| 

| 270 
| SE_BardSongRange 
| Bard Song Range 
| Modify range of beneficial bard songs by percent. 
| percent modifier 
| none 
| none 
| 

| 271 
| SE_BaseMovementSpeed 
| Base Run Speed 
| Modify base rune speed by percentage. 
| percent modifier 
| none 
| none 
| Does not stack with run speed modifiers. 

| 272 
| SE_CastingLevel2 
| Casting Level 
| Modify effective casting level by amount. 
| level amount 
| none 
| none 
| Live decription: This affects, spells that get stronger or last longer based on your level, stacking priority on targets, likelihood that spells that dispel effects will succeed, likelihood that spells that cure blindness will succeed, likelihood that spells that sense, disarm, or pick locked traps will succeed. 

| 273 
| SE_CriticalDoTChance 
| Critical DoT 
| Modifies chance to critical damage over time spells. 
| percent chance 
| none 
| none 
| 

| 274 
| SE_CriticalHealChance 
| Critical Heal 
| Modify chance to critical heal spells. 
| percent chance 
| none 
| none 
| 

| 275 
| SE_CriticalMend 
| Critical Mend 
| Modify chance to critical the monks mend ability. 
| percent chance 
| none 
| none 
| 

| 276 
| SE_Ambidexterity 
| Dual Wield Skill Amount 
| Modify your chance to successfully dual wield by increasing dual weild skill by amount. 
| amount 
| none 
| none 
| 

| 277 
| SE_UnfailingDivinity 
| Extra DI Chance 
| Gives second chance for a death save to fire and if successful gives a modified heal amount. 
| heal modifier percent 
| none 
| none 
| This works with Death Save SPA 150. 

| 278 
| SE_FinishingBlow 
| Finishing Blow 
| Grants melee attacks a chance to deal massive damage to NPC targets with 10% or less health. 
| percent chance 
| damage amount 
| none 
| Actual chance is calculated as base value / 10. Example for 50 percent chance, set base to 500. Use with SPA 440 to set max level of NPC that can be affected by finishing blow. 

| 279 
| SE_Flurry 
| Flurry Chance 
| Chance to do a melee flurry, performing two extra attacks. 
| percent chance 
| none 
| none 
| 

| 280 
| SE_PetFlurry 
| Pet Flurry Chance 
| Chance for pet to perform a melee flurry. 
| percent chance 
| none 
| none 
| This effect goes on the pet owner and then the benefit is applied to the pet. 

| 281 
| SE_FeignedMinion 
| Give Pet Feign 
| 
| 
| 
| 
| 

| 282 
| SE_ImprovedBindWound 
| Bandage Amount 
| Modify bind wound healing amount by percent. 
| percent modifier 
| none 
| none 
| 

| 283 
| SE_DoubleSpecialAttack 
| Special Attack Chain 
| Chance to perform second special skill attack as monk. 
| percent chance 
| none 
| none 
| 

| 284 
| SE_LoHSetHeal 
| LoH Set Heal 
| 
| 
| 
| 
| 

| 285 
| SE_NimbleEvasion 
| NoMove Check Sneak 
| 
| 
| 
| 
| 

| 286 
| SE_FcDamageAmt 
| Focus: Spell Damage Amount 
| Modify spell damage by a flat amount. 
| amount 
| none 
| none 
| 

| 287 
| SE_SpellDurationIncByTic 
| Focus: Buff Duration by Tics 
| Modify spell buff duration by tics. 
| duration tics 
| none 
| none 
| 1 tic = 6 seconds, set base in tics 

| 288 
| SE_SkillAttackProc 
| Add Proc From Skill Attack 
| Chance to cast a spell when a skill attack is performed. 
| chance percent 
| skill type 
| none 
| Chance is calculated as base value / 10, example 20 percent chance would be a value of 200. For AA's the proc spell ID is the 'spell' field used in the aa_ranks table. 

| 289 
| SE_CastOnFadeEffect 
| Cast Spell On Fade 
| Cast a spell only if buff containing this effect fades after the full duration. 
| spellid 
| none 
| none 
| Typically seen on spells that can be cured. 

| 290 
| SE_IncreaseRunSpeedCap 
| Movement Cap 
| Increase movement speed cap. 
| amount 
| none 
| none 
| 

| 291 
| SE_Purify 
| Purify 
| Remove up specified amount of detiremental spells, excluding charm, fear, resurrection, and revival sickness. 
| amount spells removed 
| none 
| none 
| 

| 292 
| SE_StrikeThrough2 
| Strikethrough (v292) 
| Modify chance to strikethrough by percent, bypassing an opponent's special defenses, such as dodge, block, parry, and riposte 
| percent modifier 
| none 
| none 
| 

| 293 
| SE_FrontalStunResist 
| Frontal Stun Resist 
| Chance to resist a stun from a bash or kick if facing target. 
| percent chance 
| none 
| none 
| 

| 294 
| SE_CriticalSpellChance 
| Spell Crit Chance 
| Modify chance to critical direct damage spells and modify spell critical spell damage by percent 
| critical chance 
| critical damage percent modifier 
| none 
| 

| 295 
| SE_ReduceTimerSpecial 
| Reduce Timer Special 
| 
| 
| 
| 
| 

| 296 
| SE_FcSpellVulnerability 
| Focus: Incoming Spell Damage 
| Modify incoming spell damage taken by percent. 
| min percent modifier 
| none 
| max percent modifier 
| Use random effectiveness if base and max value are defined, where base is always lower end and max the higher end of the random range. If random value not wanted, then only set a base value. 

| 297 
| SE_FcDamageAmtIncoming 
| Focus: Incoming Spell Damage Amt 
| Modify incoming spell damage taken by a flat amount. 
| amount 
| none 
| none 
| 

| 298 
| SE_ChangeHeight 
| Pet Size 
| Modify size by percent. 
| percent modifier 
| none 
| none 
| 

| 299 
| SE_WakeTheDead 
| Wake the Dead 
| Create temporary pet from nearby corpses. 
| 1 
| none 
| duration seconds 
| Maximum range for corpse from caster is 250 units. 

| 300 
| SE_Doppelganger 
| Doppelganger 
| Create a temporary pets that mirrors you appearance. 
| amount of pets 
| none 
| duration seconds 
| 

| 301 
| SE_ArcheryDamageModifier 
| Archery Damage Modifer 
| Modify archery base damage by percent. 
| percent modifier 
| none 
| none 
| 

| 302 
| SE_FcDamagePctCrit 
| Focus: Spell Damage (v302 before crit) 
| Modify spell damage by percent. Damage is applied before critical calculation. 
| min percent modifier 
| none 
| max percent modifier 
| Use random effectiveness if base and max value are defined, where base is always lower end and max the higher end of the random range. If random value not wanted, then only set a base value. 

| 303 
| SE_FcDamageAmtCrit 
| Focus: Spell Damage Amt (v303 before crit) 
| Modify spell damage by a flat amount. Damage is applied before critical calculation.. 
| amount 
| none 
| none 
| 

| 304 
| SE_OffhandRiposteFail 
| Secondary Riposte 
| Modify chance to avoid an offhand riposte by percent. 
| percent modifier 
| none 
| none 
| 

| 305 
| SE_MitigateDamageShield 
| Damage Shield Mitigation 
| Modify incoming damage from damage shield using your off hand weapon by amount. 
| amount 
| none 
| none 
| For spells/items set to positive value will reduce the damage shield amount, for AA's set this value to negative for reducation, this is converted to positive in source code. This is how live has it. 

| 306 
| SE_ArmyOfTheDead 
| Army of the Dead 
| Create temporary pets from nearby corpses. Can only spawn one pet per corpse up a maximum amount of pets. 
| amount of pets 
| none 
| duration seconds 
| Maximum range for corpse from caster is 250 units. 

| 307 
| SE_Appraisal 
| Appraisal 
| Roughly estimates the selling price of the item you are holding. 
| 
| 
| 
| 

| 308 
| SE_ZoneSuspendMinion 
| Zone Suspend Minion 
| Allow suspended pets to be resummoned upon zoning. 
| 1 
| none 
| none 
| 

| 309 
| SE_GateCastersBindpoint 
| Gate Caster's Bindpoint 
| Teleports target or group members to casters bind point. 
| bind id (Set to 1, 2, or 3) 
| none 
| none 
| 

| 310 
| SE_ReduceReuseTimer 
| Decrease Reuse Timer 
| Reduce spell recast time and disciple reuse time by amount. 
| time ms 
| none 
| none 
| Positive value reduces reuse timer. Note: You can set to negative to increase reuse timer, but client will not display it properly. 

| 311 
| SE_LimitCombatSkills 
| Limit: Combat Skills Not Allowed 
| Include or exclude combat skills or procs from being focused. 
| 0=Exclude if proc 1=Allow only if proc 
| none 
| none 
| 

| 312 
| SE_Sanctuary 
| Sanctuary 
| Places caster at bottom hate list, effect fades if caster casts spell on targets other than self. 
| 1 
| none 
| none 
| 

| 313 
| SE_ForageAdditionalItems 
| Forage Master 
| Chance to forage additional items using forage ability. 
| percent chance 
| none 
| none 
| 

| 314 
| SE_Invisibility2 
| Improved Invisibility 
| Apply invsibility that will last until duration ends 
| invisibility level 
| none 
| none 
| Invisibility level determines what level of see invisible can detect it. 

| 315 
| SE_InvisVsUndead2 
| Improved Invisibility Vs Undead 
| Apply invsibility verse undead that will last until duration ends 
| invisibility level 
| none 
| none 
| Invisibility level determines what level of see invisible can detect it. 

| 316 
| SE_ImprovedInvisAnimals 
| Improved Invisibility Vs Animals 
| Apply invsibility verse animal that will last until duration ends 
| invisibility level 
| none 
| none 
| Invisibility level determines what level of see invisible can detect it. 

| 317 
| SE_ItemHPRegenCapIncrease 
| Worn Regen Cap 
| Increase HP regen from items over cap by amount. 
| amount 
| none 
| none 
| 

| 318 
| SE_ItemManaRegenCapIncrease 
| Worn Mana Cap 
| Increase Mana regen from items over cap by amount. 
| amount 
| none 
| none 
| 

| 319 
| SE_CriticalHealOverTime 
| Critical HP Regen 
| Modifies chance to perform a critical heal over time by percent. 
| percent modifier 
| none 
| none 
| 

| 320 
| SE_ShieldBlock 
| Shield Block Chance 
| Chance to block an attack while shield is equiped. 
| percent chance 
| none 
| none 
| 

| 321 
| SE_ReduceHate 
| Reduce Target Hate 
| Remove or add a set amount of hate instantly from target. 
| amount 
| none 
| max amount 
| Positive value decreases hate. 

| 322 
| SE_GateToHomeCity 
| Gate to Starting City 
| Gate to original starting city. 
| 1 
| none 
| none 
| 

| 323 
| SE_DefensiveProc 
| Add Defensive Proc 
| Add defensive proc that triggers from incoming melee hits. 
| spellid 
| rate modifer 
| none 
| 

| 324 
| SE_HPToMana 
| HP for Mana 
| Casted spells will use HP instead of Mana with a conversion penalty rate. 
| conversion rate percent 
| 
| 
| 

| 325 
| SE_NoBreakAESneak 
| No Break AE Sneak 
| Chance to remain hidden when hit by an area effect spell. 
| percent chance 
| none 
| none 
| 

| 326 
| SE_SpellSlotIncrease 
| Spell Slots 
| Increase spell gems by amount. 
| amount 
| none 
| none 
| Client has to support the value you use. 

| 327 
| SE_MysticalAttune 
| Buff Slots 
| Increase max spell buff slots amount. 
| amount 
| none 
| none 
| Client has to support the value you use. 

| 328 
| SE_DelayDeath 
| Negative HP Limit 
| Increases the amount of damage you can take before dying after falling unconscious at 0 health. 
| amount 
| none 
| none 
| Positive value to increase effective negative hit points. 

| 329 
| SE_ManaAbsorbPercentDamage 
| Mana Shield Absorb Damage 
| Reduces incoming damage by percent and converts that amount to mana loss. 
| mitigation percent 
| none 
| none 
| 

| 330 
| SE_CriticalDamageMob 
| Critical Melee Damage 
| Modifies damage done from a critical melee hit by percent. 
| percent modifier 
| skill type (-1 = all skill types) 
| none 
| 

| 331 
| SE_Salvage 
| Item Recovery 
| Modify chance to salvage from tradeskills by percent. 
| percent modifier 
| none 
| none 
| Positive values increase chance to salvage 

| 332 
| SE_SummonToCorpse 
| Summon to Corpse 
| Summons a player back to their corpse but does not restore any lost experience. Coprse can still be resurrected. 
| seen 0 or 1 
| none 
| none 
| 

| 333 
| SE_CastOnRuneFadeEffect 
| Trigger Spell On Rune Fade 
| Cast a spell when rune amount is used up and fades. 
| spellid 
| none 
| none 
| This effect needs to go on a spell containing a rune effect. 

| 334 
| SE_BardAEDot 
| Bard AE Dot 
| Use on area of effect damage over time songs. Damage is only done if target is not moving. 
| amount 
| none 
| amount max 
| 

| 335 
| SE_BlockNextSpellFocus 
| Focus: Block Next Spell 
| Chance to block next spell that meets the focus limits. 
| percent chance 
| none 
| none 
| 

| 336 
| SE_IllusionaryTarget 
| Illusionary Target 
| 
| 
| 
| 
| 

| 337 
| SE_PercentXPIncrease 
| Experience 
| Modify amount of experience gained. 
| percent modifier 
| none 
| none 
| 

| 338 
| SE_SummonAndResAllCorpses 
| Expedient Recovery 
| Summon and ressurect all corpses for 100% experience. 
| Seen at 70 
| 
| 
| Unknown what base value represents. 

| 339 
| SE_TriggerOnCast 
| Focus: Trigger on Cast 
| Chance to cast an additional spell on the target when the spell you are casting meets the focus limits. 
| percent chance 
| spellid 
| none 
| 

| 340 
| SE_SpellTrigger 
| Spell Trigger: Only One Spell Cast 
| Chance to cast a spell on the target. When multiple of this effects are present, only one is cast. 
| percent chance 
| spellid 
| none 
| When multiple of this effect exist on the same spell, only one spell will be selected from the list to be cast. For best results, the total percent chance should equal 100%. Example, Slot 1: Cast Ice Nuke 20%, Slot2: Cast Fire Nuke 50%, Slot3 Cast Magic Nuke 30%. When the spell is cast, only one of these spells be triggered on the target. 

| 341 
| SE_ItemAttackCapIncrease 
| Worn Attack Cap 
| Increase ATK from items over cap by amount. 
| amount 
| none 
| none 
| 

| 342 
| SE_ImmuneFleeing 
| Prevent Flee on Low Health 
| Prevent NPC from fleeing at low health. 
| 1 
| none 
| none 
| 

| 343 
| SE_InterruptCasting 
| Spell Interrupt 
| Chance to interrupt targets spell casting can be instant or per buff tick. 
| percent chance 
| none 
| none 
| 

| 344 
| SE_ChannelChanceItems 
| Item Channeling 
| Modify chance to channel a spell from items and avoid being interupted by percent. 
| percent modifer 
| none 
| none 
| 

| 345 
| SE_AssassinateLevel 
| Assassinate Max Level 
| Set max target level and bonus proc chance for assissinate. 
| max target level 
| proc chance bonus 
| none 
| 

| 346 
| SE_HeadShotLevel 
| Headshot Max Level 
| Set max target level and bonus proc chance for assissinate. 
| max target level 
| proc chance bonus 
| none 
| 

| 347 
| SE_DoubleRangedAttack 
| Double Ranged Attack 
| Chance to perform an additional ranged attack. 
| percent chance 
| none 
| none 
| Will consume an additional ammo item. 

| 348 
| SE_LimitManaMin 
| Limit: Min Mana 
| Mininum mana of spell that can be focused. 
| mana amount 
| none 
| none 
| 

| 349 
| SE_ShieldEquipDmgMod 
| Damage With Shield 
| Modify melee damage and hate when having a shield equiped by percentage. 
| percent modifier 
| none 
| none 
| 

| 350 
| SE_ManaBurn 
| Manaburn 
| Instantly drains mana for damage at a defined ratio up to a defined maximum amount of mana. 
| max amount of mana drained 
| percent of mana converted to damage 
| none 
| Limit value if set to negative will result in damage 

| 351 
| SE_PersistentEffect 
| Persistent Effect 
| Create an aura that will provide a persistent effect around your character. 
| unknown 
| none 
| unknown 
| Set 'Teleport Zone' field to be the same as 'name' field in of the pet you want in the auras table. 

| 352 
| SE_IncreaseTrapCount 
| Trap Count 
| Increase trap count by amount. 
| amount 
| none 
| none 
| 

| 353 
| SE_AdditionalAura 
| Aura Count 
| Increase aura count by amount. 
| amount 
| none 
| none 
| 

| 354 
| SE_DeactivateAllTraps 
| Deactivate All Traps 
| 
| 
| 
| 
| 

| 355 
| SE_LearnTrap 
| Learn Trap 
| 
| 
| 
| 
| 

| 356 
| SE_ChangeTriggerType 
| Change Trigger Type 
| 
| 
| 
| 
| 

| 357 
| SE_FcMute 
| Focus: Mute 
| Chance to prevents casting of spell if limits are met. 
| chance 
| none 
| none 
| 

| 358 
| SE_CurrentManaOnce 
| Mana Once 
| Modify mana by amount. Instant only. 
| amount 
| none 
| max amount (use positive value) 
| 

| 359 
| SE_PassiveSenseTrap 
| Passive Sense Trap 
| Grants you a chance to innately sense traps when you near them.T his passive chance is only half as effective as your active Sense Trap skill. 
| 
| 
| 
| 

| 360 
| SE_ProcOnKillShot 
| Trigger Spell On Kill Shot 
| Chance to cast a spell if you are the one responsible for the death of a challenging foe. 
| percent chance 
| spellid 
| minimum target level 
| Typical use case is a self only buff when triggered. 

| 361 
| SE_SpellOnDeath 
| Trigger Spell On Death 
| Chance to casts a spell when the entity with this effect is killed. 
| percent chance 
| spellid 
| none 
| Typical use case is casting an area of effect upon death. Placing self only beneficial spells such as heals will not work due to player already being dead. 

| 362 
| SE_PotionBeltSlots 
| Potion Belt Slots 
| 
| 
| 
| 
| 

| 363 
| SE_BandolierSlots 
| Bandolier Slots 
| 
| 
| 
| 
| 

| 364 
| SE_TripleAttackChance 
| Triple Attack Chance 
| Modify chance to triple attack by percentage. 
| percent modifier 
| none 
| none 
| 

| 365 
| SE_ProcOnSpellKillShot 
| Trigger Spell on Spell Kill Shot 
| Chance to cast a spell when your target is killed and the kill is caused by the specific spell with this effect in it. 
| percent chance 
| spellid 
| none 
| This effect is typical found on direct damage spells. 

| 366 
| SE_GroupShielding 
| Group Shielding 
| 
| 
| 
| 
| 

| 367 
| SE_SetBodyType 
| Modify Body Type 
| Set body type of target. 
| body type 
| none 
| none 
| 

| 368 
| SE_FactionMod 
| Modify Faction 
| 
| 
| 
| 
| 

| 369 
| SE_CorruptionCounter 
| Corruption Counter 
| Determines potency of determental corruption spells or potency of cures. 
| amount 
| none 
| none 
| Set to positive values for potency of detrimental spells 

| 370 
| SE_ResistCorruption 
| Corruption Resist 
| Modify fire corruption by amount 
| amout 
| none 
| max amount 
| 

| 371 
| SE_AttackSpeed4 
| Attack Speed: Inhibit Melee 
| Decrease the remaining portion of your targets attack speed value not lowered by standard slows, this stacks with other slow effects. 
| slow amount 
| none 
| none 
| This effect works differently than other slows. Base should always be positive. Example: (SPA 11) Sha's Legacy 65% slow + (SPA 371) Lassitude 25% slow, Sha's Legacy is calculated as 100 - 35 = 65% slow, therefore the remaining attack speed is (35). Lassitude will now decrease the remaining value (35) by 25% = 16.5%. The total slowed value on the target would be 65% + 16.5% = 81.25% slow. If SPA 371 is only slow effect on target, then it will be slowed for full base value. 

| 372 
| SE_ForageSkill 
| Grant Foraging 
| Grants forage skill. 
| 1 
| none 
| none 
| 

| 373 
| SE_CastOnFadeEffectAlways 
| Cast Spell On Fade (v373) 
| Cast a spell only if buff containing this effect fades after the full duration. 
| spellid 
| none 
| none 
| 

| 374 
| SE_ApplyEffect 
| Spell Trigger: Apply Each Spell 
| Chance to cast a spell on the target. When multiple of this effect are present, each is applied. 
| percent chance 
| spellid 
| none 
| 

| 375 
| SE_DotCritDmgIncrease 
| Critical DoT Damage 
| Modify damage from critical damage over time by percent. 
| percent modifier 
| none 
| none 
| 

| 376 
| SE_Fling 
| Fling 
| Knocbkack to target. Handled client side. 
| 
| 
| 
| 

| 377 
| SE_CastOnFadeEffectNPC 
| Cast Spell On Fade (v377) 
| Cast a spell only if buff containing this effect fades after the full duration. 
| spellid 
| none 
| none 
| 

| 378 
| SE_SpellEffectResistChance 
| Spell Effect Resist Chance 
| Chance to resist specific spell effect. 
| chance modifier 
| spell effect id 
| none 
| 

| 379 
| SE_ShadowStepDirectional 
| Directional Shadowstep 
| Teleport a specified distance and direction. 
| distance unit 
| direction degrees 
| 
| This effect is handled client side. Unclear how base value equates to actual in game distance movement. Limit directional values example, 0: Shadowstep Forward, 90: Shadowstep Right, 180:Shadowstep Back, 270: Shadowstep Left 

| 380 
| SE_Knockdown 
| Knockback 
| Knockback effect. 
| push up? 
| push back? 
| none 
| Handled by client. 

| 381 
| SE_KnockTowardCaster 
| Fling Target to Caster 
| Knockback to caster. Handled client side. 
| 
| 
| 
| 

| 382 
| SE_NegateSpellEffect 
| Negate Spell Effect 
| Negates specific spell effect benefits for the duration of the debuff and prevent non-duration spell effect from working. 
| negate spell effect type 
| spell effect id 
| none 
| 

| 383 
| SE_SympatheticProc 
| Focus: Proc on Spell Cast 
| Cast on spell use with proc rate determined by cast time. 
| proc rate modifier 
| spellid 
| none 
| Typically found on item focus effects. Longer cast time spells are adjusted to have higher proc rates. 

| 384 
| SE_Leap 
| Fling Caster to Target 
| Teleport to location that is a specificed distance away. 
| distance 
| none 
| none 
| 

| 385 
| SE_LimitSpellGroup 
| Limit: SpellGroup 
| Spell group(s) that a spell focus can require or exclude, base1: spellgroup id, Include: Positive Exclude: Negative 
| spellgroup id 
| none 
| none 
| Include set value to positive 

| 386 
| SE_CastOnCurer 
| Trigger Spell on Curer 
| Casts a spell on the curer of the afflicition. 
| spellid 
| none 
| none 
| This effect goes on the spell that needs curing. 

| 387 
| SE_CastOnCure 
| Trigger Spell on Cure 
| Casts a spell on the entity being cured of the afflicition. 
| spellid 
| none 
| none 
| This effect goes on the spell that needs curing. 

| 388 
| SE_SummonCorpseZone 
| Summon All Corpses 
| Summons all of the corpses of your targeted group member to that target's location. 
| 1 
| none 
| none 
| 

| 389 
| SE_FcTimerRefresh 
| Focus: Spell Gem Refresh 
| Reset all recast spell gem timers, can limit to reset only specific spell gem timers. 
| 1 
| none 
| none 
| Applied from casted spells only. 

| 390 
| SE_FcTimerLockout 
| Focus: Spell Gem Lockout 
| Set a spell gem to be on recast timer. 
| recast duration milliseconds 
| none 
| none 
| Applied from casted spells only. 

| 391 
| SE_LimitManaMax 
| Limit: Max Mana 
| Mininum mana of spell that can be focused 
| mana amount 
| none 
| none 
| 

| 392 
| SE_FcHealAmt 
| Focus: Healing Amount (v392) 
| Modify healing by a flat amount. 
| amount 
| none 
| none 
| 

| 393 
| SE_FcHealPctIncoming 
| Focus: Incoming Healing Effectiveness (v392) 
| Modify incoming heals by a percentage. 
| percent modifier 
| none 
| none 
| 

| 394 
| SE_FcHealAmtIncoming 
| Focus: Incoming Healing Amount 
| Modify incoming heals by a flat amount. 
| amount 
| none 
| none 
| 

| 395 
| SE_FcHealPctCritIncoming 
| Focus: Incoming Healing Effectiveness (v395) 
| Modify incoming heals by a percentage. 
| percent modifier 
| none 
| none 
| 

| 396 
| SE_FcHealAmtCrit 
| Focus: Healing Amount (v396 before crit) 
| Modify incoming heals by a flat amount. Healing is added before critical calculation. 
| amount 
| none 
| none 
| 

| 397 
| SE_PetMeleeMitigation 
| Pet Mitigation 
| Modify pets incoming damage mitigation by percentage. 
| percent modifier 
| none 
| none 
| 

| 398 
| SE_SwarmPetDuration 
| Focus: Swarm Pet Duration 
| Increase swarm pet duration by amount time. 
| duration ms 
| none 
| none 
| 

| 399 
| SE_FcTwincast 
| Focus: Twincast Chance 
| Chance to cast a spell a second time. 
| percent chance 
| none 
| none 
| 

| 400 
| SE_HealGroupFromMana 
| Heal Group From Mana 
| Drains your mana and heals your target for an amount determined by ratio modifier for each point of mana drained. 
| max amount mana drained 
| ratio of HP gain per 1 mana drained 
| none 
| Ratio is calculated as value / 10, example if you want to heal 13 HP for every 1 mana, set base to 130. 

| 401 
| SE_ManaDrainWithDmg 
| Damage for Amount Mana Drained 
| Drains your mana and damages a target for an amount determined by ratio modifier for each point of mana drained. 
| max amount mana drained 
| ratio of HP of damage per 1 mana drained 
| 
| Ratio is calculated as value / 10, example if you want to damage for l 13 HP for every 1 mana, set base to 130. 

| 402 
| SE_EndDrainWithDmg 
| Damage for Amount Endurance Drained 
| Drains your mana and damages a target for an amount determined by ratio modifier for each point of mana drained. 
| max amount endurance drained 
| ratio of HP of damage per 1 endurance drained 
| 
| Ratio is calculated as value / 10, example if you want to damage for l 13 HP for every 1 endurance, set base to 130. 

| 403 
| SE_LimitSpellClass 
| Limit: SpellClass 
| Spell Category' using table field 'spell_class' that a spell focus can require or exclude. 
| spell_class id 
| none 
| none 
| Include set value to positive 

| 404 
| SE_LimitSpellSubclass 
| Limit: SpellSubclass 
| Spell Category Subclass' using table field 'spell_subclass' that a spell focus can require or exclude. 
| spell_subclass id 
| none 
| none 
| Include set value to positive 

| 405 
| SE_TwoHandBluntBlock 
| Staff Block Chance 
| Chance to block an attack while two handed blunt weapon is equiped. 
| percent chance 
| none 
| none 
| 

| 406 
| SE_CastonNumHitFade 
| Trigger Spell on Hit Count Fade 
| Cast a spell when a spell buffs hit counter is depleted. 
| spellid 
| none 
| none 
| 

| 407 
| SE_CastonFocusEffect 
| Trigger Spell on Focus Effect Success 
| Casts a spell if the spells focus limits are met. 
| spellid 
| none 
| none 
| This effect goes on a spell with a focus effect. 

| 408 
| SE_LimitHPPercent 
| Heal Up To Percent Limit 
| Cap HP at lowest of percent or amount. Can not be healed beyond this limit. 
| percent HP 
| amount HP 
| none 
| 

| 409 
| SE_LimitManaPercent 
| Restore Mana Up To Percent Limit 
| Cap Mana at lowest of percent or amount. Can have mana restored beyond this limit. 
| percent HP 
| amount HP 
| none 
| 

| 410 
| SE_LimitEndPercent 
| Restore Endurance Up To Percent Limit 
| Cap HP at lowest of percent or amount. Can not be healed beyond this limit. 
| percent HP 
| amount HP 
| none 
| 

| 411 
| SE_LimitClass 
| Limit: PlayerClass 
| Class(es) that can use the spell focus. 
| class bitmask 
| none 
| none 
| The class value in dbase is +1 in relation to item class value, set as you would item for multiple classes. 

| 412 
| SE_LimitRace 
| Limit: Race 
| Race that can use the spell focus. 
| race id 
| none 
| none 
| Not used in any known live spells. Use only single race at a time. 

| 413 
| SE_FcBaseEffects 
| Focus: Base Spell Value 
| Modify spell effect value after formula calculations but before other focuses. 
| percent modifier 
| none 
| none 
| Used to set bard instrument modifiers. Can be used to focus many effects otherwise not able to be focused by other methods. If modifying spells that are buffs, value must be intervals of 10% and starting at greater than 10%. For example, if a 10% increase in rune amount is required, set base value to 11, that will be calculated as base value * 1.10, resulting in a 10% increase. For a 20% increase set to 12. 

| 414 
| SE_LimitCastingSkill 
| Limit: CastingSkill 
| Spell and singing skills(s) that a spell focus can require or exclude. 
| skill type 
| none 
| none 
| Include set value to positive 

| 415 
| SE_FFItemClass 
| Limit: ItemClass 
| Limits focuses to be applied only from item click. 
| item ItemType 
| item SubType 
| item Slots 
| Not used on live. Details, base: item ItemType (-1 to include for all ItemTypes, -1000 to exclude clicks from getting the focus, or exclude specific SubTypes or Slots if set), limit: item SubType (-1 for all SubTypes), max: item Slots (bitmask of valid slots, -1 ALL slots), See comments in Mob::CalcFocusEffect for more details. Special: Can be used with SPA 310 reduce item click recast and SPA 127, 500,5001 to reduce item click casting time. 

| 416 
| SE_ACv2 
| AC (v416) 
| Modify AC by amount 
| amount 
| none 
| amount 
| 

| 417 
| SE_ManaRegen_v2 
| Mana Regen (v417) 
| Modify mana by amount, repeates every tic if in a buff. 
| amount 
| none 
| max amount (use positive value) 
| 

| 418 
| SE_SkillDamageAmount2 
| Skill Damage Bonus (v418) 
| Add a flat amount of damage when a specific melee skill is used. 
| amount 
| skill type (-1 = all skill types) 
| none 
| 

| 419 
| SE_AddMeleeProc 
| Add Melee Proc (v419) 
| Add proc to melee. 
| spellid 
| rate modifer 
| none 
| 

| 420 
| SE_FcLimitUse 
| Focus: Hit Count 
| Modify buff hit count by percent. 
| percent modifier 
| none 
| none 
| Not used in any known live spells. Hit count is set using field 'numhits' in spells new. 

| 421 
| SE_FcIncreaseNumHits 
| Focus: Hit Count Amount 
| Modify buff hit count by flat amount. 
| hit count amount 
| none 
| none 
| Hit count is set using field 'numhits' in spells new. 

| 422 
| SE_LimitUseMin 
| Limit: Minimum Hit Count 
| Minium amount of hit count for a spell to be focused. 
| hit count amount 
| nonw 
| none 
| Hit count is set using field 'numhits' in spells new. 

| 423 
| SE_LimitUseType 
| Limit: Hit Count Type 
| Focus will only affect if has this hit count type. 
| hit count type 
| nonw 
| none 
| hit type is set using field 'numhitstype' in spells_new. 1:Incoming Hit Attempts, 2:Outgoing Hit Attempts, 3:Incoming Spells, 4:Outgoing Spells, 5: Outgoing Hit Successes, 6:Incoming Hit Successes, 7:Matching Spells, 8:Incoming Hits Or Spells, 9:Reflected Spells, 10:Defensive Proc Casts, 11: Offensive Proc Casts. 

| 424 
| SE_GravityEffect 
| Gravitate 
| Causes a target that is within specific distance of you to gravitate toward or away from you with set amount of force over a period of time. 
| Force 
| Distance 
| unknown 
| Negative base value will pull target 

| 425 
| SE_Display 
| Fly 
| Grants flying animation to certain illusions. 
| 
| 
| 
| 

| 426 
| SE_IncreaseExtTargetWindow 
| AddExtTargetSlots 
| Increases the capacity of your extended target window 
| 
| 
| 
| 

| 427 
| SE_SkillProc 
| Skill Proc On Attempt 
| Add proc to a specific combat or ability skill is used. 
| spellid 
| rate modifer 
| none 
| Example, can add a proc to taunt which will have a chance to fire each time you use skill. 

| 428 
| SE_LimitToSkill 
| Limit To Skill 
| Limits what combat skills will trigger a skill (SPA 426, 429), melee (SPA 419) or ranged (SPA 201) proc. 
| skill type 
| none 
| none 
| This needs to be placed after the proc SPA in a spell to be checked properly. 

| 429 
| SE_SkillProcSuccess 
| Skill Proc On Success 
| Add proc to a specific combat or ability skill when that skill is succesfully used. 
| spellid 
| rate modifer 
| none 
| Example, can add a proc to taunt which will have a chance to fire if you taunt successsfully. 

| 430 
| SE_PostEffect 
| PostEffect 
| 
| 
| 
| 
| 

| 431 
| SE_PostEffectData 
| PostEffectData 
| 
| 
| 
| 
| 

| 432 
| SE_ExpandMaxActiveTrophyBen 
| Expand Max Active Trophy Benefits 
| 
| 
| 
| 
| 

| 433 
| SE_CriticalDotDecay 
| Critical DoT Decay 
| Increase critical dot chance, effect decays based on level of spell it effects. 
| percent chance 
| decay modifier 
| none 
| Live no longer uses this effect, replaced after ROF2 with different effect. Effects were introduced during VoA. 

| 434 
| SE_CriticalHealDecay 
| Critical Heal Decay 
| Increase critical heal chance, effect decays based on level of spell it effects. 
| percent chance 
| decay modifier 
| none 
| Live no longer uses this effect, replaced after ROF2 with different effect. Effects were introduced during VoA. 

| 435 
| SE_CriticalRegenDecay 
| Critic Heal Over Time Decay 
| Increase critical heal over time chance, effect decays based on level of spell it effects. 
| percent chance 
| decay modifier 
| none 
| Live no longer uses this effect, replaced after ROF2 with different effect. Effects were introduced during VoA. 

| 436 
| SE_BeneficialCountDownHold 
| Toggle Freeze Buff Timers 
| 
| 
| 
| 
| 

| 437 
| SE_TeleporttoAnchor 
| Teleport to Anchor 
| 
| 
| 
| 
| 

| 438 
| SE_TranslocatetoAnchor 
| Translocate to Anchor 
| 
| 
| 
| 
| 

| 439 
| SE_Assassinate 
| Assassinate 
| Grants backstab and critical throwing attacks a chance to deal massive damage to targets when attacking from behind. 
| percent chance 
| damage amount 
| none 
| Use with SPA 345 to set max target level and bonus chance. 

| 440 
| SE_FinishingBlowLvl 
| Finishing Blow Max Level 
| Sets the max level and max hit point ratio an NPC must be to receive a Finishing Blow. 
| max target level 
| hit point percent to trigger 
| none 
| Limit value is calculated as limit / 10. To set FB to trigger below 10 pct HP, set limit to 100. If multiple version of this affect exist it will use highest HP percent. 

| 441 
| SE_DistanceRemoval 
| Distance Buff Removal 
| Buff is removed from target when target moves specified amount of distance away from where initially hit. 
| distance amount 
| none 
| none 
| 

| 442 
| SE_TriggerOnReqTarget 
| Trigger Spell on Target Requirement 
| Cast a spell when Target Requirement conditions are met. 
| spellid 
| Target Restriction ID 
| none 
| See enum SpellRestriction in spdat.h for IDs. This trigger spell is usually cast on a target. 

| 443 
| SE_TriggerOnReqCaster 
| Trigger Spell on Caster Requirement 
| Cast a spell when Caster Requirement conditions are met 
| spellid 
| Target Restriction ID 
| none 
| See enum SpellRestriction in spdat.h for IDs. This trigger spell is usually cast on self. 

| 444 
| SE_ImprovedTaunt 
| Improved Taunt 
| Causes target to locks aggro on the caster and decreases other players hate by percentage on NPC targets below the specified max level. 
| 999 
| other players percent of hate generation 
| max target level 
| Limit greater than 100 increased hate generation on other players (120 = 20 pct increased hate generation) 

| 445 
| SE_AddMercSlot 
| Add Merc Slot 
| 
| 
| 
| 
| 

| 446 
| SE_AStacker 
| A Stacker 
| Buff blocker A 
| stacking value 
| none 
| none 
| "Buffs containing these effects can block each other from taking hold via the following. Does not matter what slot the effect is in. (B) Blocks any buffs from taking hold with (A) in it. (C) Blocks any buff from taking hold with (B) in it. 

| (D) Blocks any buff from taking hold with (C) in it. When checking same type (ie A vs A), the higher base effect value will determine which takes hold." 
| 
| 
| 
| 
| 
| 
| 

| 447 
| SE_BStacker 
| B Stacker 
| Buff blocker B 
| stacking value 
| none 
| none 
| "Buffs containing these effects can block each other from taking hold via the following. Does not matter what slot the effect is in. (B) Blocks any buffs from taking hold with (A) in it. (C) Blocks any buff from taking hold with (B) in it. 

| (D) Blocks any buff from taking hold with (C) in it. When checking same type (ie A vs A), the higher base effect value will determine which takes hold." 
| 
| 
| 
| 
| 
| 
| 

| 448 
| SE_CStacker 
| C Stacker 
| Buff blocker C 
| stacking value 
| none 
| none 
| "Buffs containing these effects can block each other from taking hold via the following. Does not matter what slot the effect is in. (B) Blocks any buffs from taking hold with (A) in it. (C) Blocks any buff from taking hold with (B) in it. 

| (D) Blocks any buff from taking hold with (C) in it. When checking same type (ie A vs A), the higher base effect value will determine which takes hold." 
| 
| 
| 
| 
| 
| 
| 

| 449 
| SE_DStacker 
| D Stacker 
| Buff blocker D 
| stacking value 
| none 
| none 
| "Buffs containing these effects can block each other from taking hold via the following. Does not matter what slot the effect is in. (B) Blocks any buffs from taking hold with (A) in it. (C) Blocks any buff from taking hold with (B) in it. 

| (D) Blocks any buff from taking hold with (C) in it. When checking same type (ie A vs A), the higher base effect value will determine which takes hold." 
| 
| 
| 
| 
| 
| 
| 

| 450 
| SE_MitigateDotDamage 
| Mitigate Damage Over Time Rune 
| Mitigate incoming damage from damage over time spells by percentage until rune fades. 
| percent mitigation 
| max damage absorbed per hit 
| rune amount 
| Special: If this effect is placed on item as worn effect or as an AA, it will provide stackable percent damage over time mitigation for the base value. 

| 451 
| SE_MeleeThresholdGuard 
| Melee Threshold Guard 
| Partial Melee Rune that only is lowered if melee hits are over the specified amount of damage. 
| percent mitigation 
| minimum damage to be lowered 
| rune amount 
| 

| 452 
| SE_SpellThresholdGuard 
| Spell Threshold Guard 
| Partial Spell Rune that only is lowered if spell hits are over the specified amount of damage. 
| percent mitigation 
| minimum damage to be lowered 
| rune amount 
| 

| 453 
| SE_TriggerMeleeThreshold 
| Trigger Spell on Melee Threshold 
| Cast a spell when a specified amount of melee damage taken in a single hit. 
| spellid 
| amount of melee damage 
| none 
| 

| 454 
| SE_TriggerSpellThreshold 
| Trigger Spell on Spell Threshold 
| Cast a spell when a specified amount of spell damage is taken in a single hit. 
| spellid 
| amount of spell damage 
| none 
| 

| 455 
| SE_AddHatePct 
| Add Hate Percent 
| Modify targets total hate toward the caster by percentage. 
| percent modifier 
| none 
| none 
| Positive value increased hate. 

| 456 
| SE_AddHateOverTimePct 
| Add Hate Over Time Percent 
| Modify targets total hate toward the caster by percentage, repeates every tic if in a buff. 
| percent modifier 
| none 
| none 
| Positive value increases hate. 

| 457 
| SE_ResourceTap 
| Resource Tap 
| Return a percentage of Spell Damage as (HP/Mana/Endurance), up to a maximum amount per spell. 
| percent coverted 
| 0=HP, 1=Mana,2=Endurance 
| max amount resource returned 
| Conversion percent calculated as value / 10, example to convert 85 percent of damage to mana set base value to 850 and limit to 1. 

| 458 
| SE_FactionModPct 
| Faction Pct 
| Modify faction gains and losses by percent. 
| percent modifier 
| none 
| none 
| 

| 459 
| SE_DamageModifier2 
| Skill Damage Modifier (v459) 
| Modify melee damage by skill. 
| percent modifer 
| skill type (-1 = all skill types) 
| none 
| 

| 460 
| SE_Ff_Override_NotFocusable 
| Limit: Include Non-Focusable 
| Allow spell to be focused even if flagged with 'not_focusable' in spell table. 
| 1 
| none 
| none 
| 

| 461 
| SE_ImprovedDamage2 
| Focus: Spell Damage (v461) 
| Modify outgoing spell damage by percentage. 
| min percent 
| none 
| max percent 
| Use random effectiveness if base and max value are defined, where base is always lower end and max the higher end of the random range. If random value not wanted, then only set a base value. 

| 462 
| SE_FcDamageAmt2 
| Focus: Spell Damage Amount (v462) 
| Modify outgoing spell damage by a flat amount 
| amount 
| none 
| none 
| 

| 463 
| SE_Shield_Target 
| Shield Target 
| 
| 
| 
| 
| 

| 464 
| SE_PC_Pet_Rampage 
| PC Pet Rampage 
| Percent chance for a pet to do a rampage melee attack with damage modifier each melee round. 
| percent chance 
| damage modifier 
| none 
| Limit greater than 100 for increased damage (120 = 20 pct increased damage) 

| 465 
| SE_PC_Pet_AE_Rampage 
| PC Pet AE Rampage 
| Percent chance for a pet to do a AE rampage melee attack with damage modifier each melee round. 
| percent chance 
| damage modifier 
| none 
| Limit greater than 100 for increased damage (120 = 20 pct increased damage) 

| 466 
| SE_PC_Pet_Flurry_Chance 
| PC Pet Flurry Chance 
| Percent chance for a pet to do flurry from double attack hit. 
| percent chance 
| none 
| none 
| 

| 467 
| SE_DS_Mitigation_Amount 
| Damage Shield Mitigation Amount 
| Modify incoming damage shield damage by a flat amount. 
| amount 
| none 
| none 
| 

| 468 
| SE_DS_Mitigation_Percentage 
| Damage Shield Mitigation Percentage 
| Modify incoming damage shield damage by percentage. 
| percent modifier 
| none 
| none 
| 

| 469 
| SE_Chance_Best_in_Spell_Grp 
| Spell Trigger: Best in Spell Group: Only One Spell Cast 
| Chance to cast highest scribed spell within a spell group. When multiple of this effects are present, only one is cast. 
| percent chance 
| spellgroup id 
| 
| When multiple of this effect exist on the same spell, only one spell will be selected from the list to be cast. For best results, the total percent chance should equal 100%. Example, Slot 1: Cast Ice Nuke spellgroup 20%, Slot2: Cast Fire Nuke spellgroup 50%, Slot3 Cast Magic Nuke spellgroup 30%. When the spell is cast, only one of these spells be triggered on the target. 

| 470 
| SE_Trigger_Best_in_Spell_Grp 
| Spell Trigger: Best in Spell Group: Apply Each 
| Chance to cast highest scribed spell within a spell group. Each spell has own chance. 
| percent chance 
| spellgroup id 
| 
| 

| 471 
| SE_Double_Melee_Round 
| Double Melee Round (PC Only) 
| Percent chance to repeat primary weapon round with a percent damage modifier. 
| percent chance 
| percent damage modifier 
| none 
| 

| 472 
| SE_Buy_AA_Rank 
| Toggle Passive AA Rank 
| Used in AA abilities that have Enable/Disable toggle. Spell on Disabled Rank has this effect in it. 
| 1 
| none 
| none 
| Certain AA, like Weapon Stance line use a special toggle Hotkey to enable or disable the AA's passive abilities. This is occurs by doing the following. Each 'rank' of Weapon Stance is actually 2 actual ranks. First rank is always the Disabled version which cost X amount of AA, this is the rank that SPA 472 goes in. Second rank is the Enabled version which cost 0 AA. When you buy the first rank, you make a hotkey that on live say 'Weapon Stance Disabled', if you clik that it then BUYS the next rank of AA (cost 0) which switches the hotkey to 'Enabled Weapon Stance' and you are given the passive buff effects. If you click the Enabled hotkey, it causes you to lose an AA rank and once again be disabled. Thus, you are switching between two AA ranks. Thefore when creating an AA using this ability, you need generate both ranks. Follow the same pattern for additional ranks. See aa.cpp for further details. 

| 473 
| SE_Double_Backstab_Front 
| Double Backstab From Front 
| Chance to double backstab from front. 
| percent chance 
| none 
| none 
| 

| 474 
| SE_Pet_Crit_Melee_Damage_Pct_Owner 
| Pet Crit Melee Damage 
| Modifies your pets critical melee damage. 
| percent modifier 
| none 
| none 
| This effect goes on the pet owner and then the benefit is applied to the pet. 

| 475 
| SE_Trigger_Spell_Non_Item 
| Trigger Spell: Not Cast From Items: Apply Each 
| Chance to cast a spell on a target if not cast by item click. Each spell has own chance. 
| chance pecent 
| spellid 
| 
| 

| 476 
| SE_Weapon_Stance 
| Weapon Stance 
| Apply a specific spell buffs automatically if depending 2Hander, Shield or Duel Wield is equiped. 
| spellid 
| 0=2H, 1=Shield, 2=DW 
| none 
| On live this is an AA, on emu can use as item or spell buff effect. Live AA uses a toggle system to turn on and off weapons stance. which requires use of SPA 472 SE_Buy_AA_Rank within in the AA. Details can be found in aa.cpp 

| 477 
| SE_Hatelist_To_Top_Index 
| Move to Top of Rampage List 
| Chance to be set to top of rampage list 
| chacne percent 
| none 
| none 
| 

| 478 
| SE_Hatelist_To_Tail_Index 
| Move to Bottom of Rampage List 
| Chance to be set to bottom of rampage list 
| percent chance 
| none 
| none 
| 

| 479 
| SE_Ff_Value_Min 
| Limit: Base Value Min 
| Minimum base value of a spell effect within a spell attempting to be focused. 
| effect_base_value 
| spell effect id 
| none 
| Example, only allow focus if spell has Effect ID 0 which is a Heal and the heals effect value is less than 5000. 

| 480 
| SE_Ff_Value_Max 
| Limit: Base Value Max 
| Maximum base value of a spell effect within a spell attempting to be focused. 
| effect_base_value 
| spell effect id 
| none 
| Example, only allow focus if spell has Effect ID 0 which is a Heal and the heals effect value is greater than 5000. 

| 481 
| SE_Fc_Cast_Spell_On_Land 
| Focus: Trigger Spell on Spell Landing 
| Cast spell if hit by an incoming spell and that incoming spell meets limit requirements. 
| spellid 
| none 
| none 
| Example, everytime you are hit with a fire nuke, cast a heal on yourself. 

| 482 
| SE_Skill_Base_Damage_Mod 
| Base Hit Damage 
| Modify base melee damage by percent. 
| percent modifier 
| skill type (-1 = ALL skill types) 
| none 
| 

| 483 
| SE_Fc_Spell_Damage_Pct_IncomingPC 
| Focus: Incoming Spell Damage (v483) 
| Modify incoming spell damage taken by percent. 
| min percent modifier 
| none 
| max percent modifier 
| Use random effectiveness if base and max value are defined, where base is always lower end and max the higher end of the random range. If random value not wanted, then only set a base value. 

| 484 
| SE_Fc_Spell_Damage_Amt_IncomingPC 
| Focus: Incoming Spell Damage Amount (v484) 
| Modify incoming spell damage taken by a flat amount. 
| amount 
| none 
| none 
| 

| 485 
| SE_Ff_CasterClass 
| Limit: Caster Class 
| Caster of the spell on target with a focus effect that is checked by incoming spells must be specified class(es). 
| class bitmask 
| none 
| none 
| Set multiple classes same as would for items. This is only used with focus effects that check against incoming spells. 

| 486 
| SE_Ff_Same_Caster 
| Limit: Caster 
| Caster of spell on target with a focus effect that is checked by incoming spells. 
| 0=Must be different caster 1=Must be same caster 
| none 
| none 
| This is only used with focus effects that check against incoming spells. 

| 487 
| SE_Extend_Tradeskill_Cap 
| Extend Tradeskill Cap 
| 
| 
| 
| 
| 

| 488 
| SE_Defender_Melee_Force_Pct_PC 
| Push Taken 
| 
| 
| 
| 
| 

| 489 
| SE_Worn_Endurance_Regen_Cap 
| Worn Endurance Regen Cap 
| Modify endurance regen cap from items. 
| amount 
| none 
| none 
| 

| 490 
| SE_Ff_ReuseTimeMin 
| Limit: Reuse Time Min 
| Minimum recast time of a spell that can be focused. 
| recast time 
| none 
| none 
| 

| 491 
| SE_Ff_ReuseTimeMax 
| Limit: Reuse Time Max 
| Maximum recast time of a spell that can be focused. 
| recast time 
| none 
| none 
| 

| 492 
| SE_Ff_Endurance_Min 
| Limit: Endurance Min 
| Minimum endurance cost of a spell that can be focused 
| endurance cost 
| none 
| none 
| 

| 493 
| SE_Ff_Endurance_Max 
| Limit: Endurance Max 
| Maximum endurance cost of a spell that can be focused. 
| endurance cost 
| none 
| none 
| 

| 494 
| SE_Pet_Add_Atk 
| Pet Add ATK 
| Modifies your pets ATK by amount. 
| amount 
| none 
| none 
| This effect goes on the pet owner and then the benefit is applied to the pet. 

| 495 
| SE_Ff_DurationMax 
| Limit: Duration Max 
| Maximum duration of spell that can be focused. 
| tics 
| 
| 
| 

| 496 
| SE_Critical_Melee_Damage_Mod_Max 
| Critical Melee Damage: No Stack 
| Modifies damage done from a critical melee hit by percent. 
| percent modifier 
| skill type (-1 = all skill types) 
| none 
| 

| 497 
| SE_Ff_FocusCastProcNoBypass 
| Limit: Proc No Bypass 
| 
| 
| 
| 
| 

| 498 
| SE_AddExtraAttackPct_1h_Primary 
| Add Extra Attack: 1H Primary 
| Gives your double attacks a percent chance to perform an extra attack with 1-handed primary weapon. 
| percent chance 
| number of attacks 
| none 
| 

| 499 
| SE_AddExtraAttackPct_1h_Secondary 
| Add Extra Attack: 1H Secondary 
| Gives your double attacks a percent chance to perform an extra attack with 1-handed secondary weapon. 
| percent chance 
| number of attacks 
| none 
| 

| 500 
| SE_Fc_CastTimeMod2 
| Focus: Spell Haste (v500, no cap) 
| Modify cast time by percent. 
| percent modifier 
| none 
| none 
| Can reduce cast time to 0. 

| 501 
| SE_Fc_CastTimeAmt 
| Focus: Spell Cast Time 
| Modify cast time by flat amount. 
| time ms 
| none 
| none 
| Can reduce cast time to 0. 

| 502 
| SE_Fearstun 
| Fearstun 
| Stun with a max level limit. Fear restrictions apply. Normal stun restrictions do not apply. 
| duration ms 
| PC duration ms 
| target max level 
| Max value can be calculated in two ways, to set a max level that target can be affected the formula is value - 1000, example if max level is 80, then set as 1080. If you want to set max level to be relative to caster, example only affects entities that are 3 more less level higher than caster, then set max value to 3. 

| 503 
| SE_Melee_Damage_Position_Mod 
| Rear Arc Melee Damage Mod 
| Modify melee damage by percent if done from Front or Behind opponent. 
| percent modifier 
| 0=back, 1=front 
| 
| 

| 504 
| SE_Melee_Damage_Position_Amt 
| Rear Arc Melee Damage Amt 
| Modify melee damage by flat amount if done from Front or Behind opponen. 
| amount 
| 0=back, 1=front 
| 
| 

| 505 
| SE_Damage_Taken_Position_Mod 
| Rear Arc Damage Taken Mod 
| Modify incoming melee damage by percent if damageis taken from Front or Behind. 
| percent modifier 
| 0=back, 1=front 
| 
| 

| 506 
| SE_Damage_Taken_Position_Amt 
| Rear Arc Damage Taken Amt 
| Modify incoming melee damage by flat amount if damage is taken from your Front or Behind. 
| amount 
| 0=back, 1=front 
| 
| 

| 507 
| SE_Fc_Amplify_Mod 
| Focus: Spell Heal Damage and DoT 
| Modify spell damage, healing and damge over time by percent. 
| percent modifier 
| none 
| none 
| 

| 508 
| SE_Fc_Amplify_Amt 
| Focus: Spell Heal Damage and DoT Amount 
| Modify spell damage, healing and damge over time by a flat amount. 
| amount 
| none 
| none 
| 

| 509 
| SE_Health_Transfer 
| Health Transfer 
| Exchange health for damage or healing on a target. 
| casters percent HP change 
| percent of casters HP to damage 
| none 
| Used in newer versions of Lifeburn and Act of Valor. Base is calculated as value / 100, where a reducation of 75 percent of casters HP would be value 750. Limit is calculated as value / 10, if value is set to 1000 then damage will be 100 percent of casters HP. Negative base decreases casters HP, negative limit decreases targets HP, positive limit heals target. 

| 510 
| SE_Fc_ResistIncoming 
| Focus: Incoming Resist Modifier 
| Modify incoming spells resist modifier by amount. 
| amount 
| none 
| none 
| Positive value will lower resist modifier. Every 2 pts of value equals a resist rate decrease of 1 percent. Example, base -750 and limit -10000, will consumes 75% of your current health and deals 1000% of that health as direct damage. 

| 511 
| SE_Ff_FocusTimerMin 
| Limit: Focus Reuse Timer 
| Sets a recast time until focus can be used again. 
| 1 
| time ms 
| none 
| Example, set limit to 1500, then this focus can only trigger once every 1.5 seconds. 

| 512 
| SE_Proc_Timer_Modifier 
| Proc Reuse Timer 
| Sets a recast time until a proc can fire again. 
| 1 
| time ms 
| none 
| Example, set limit to 1500, then this proc can only trigger once every 1.5 seconds. 

| 513 
| SE_Mana_Max_Percent 
| Mana Max Percent 
| 
| 
| 
| 
| 

| 514 
| SE_Endurance_Max_Percent 
| Endurance Max Percent 
| 
| 
| 
| 
| 

| 515 
| SE_AC_Avoidance_Max_Percent 
| AC Avoidance Max Percent 
| Modify AC avoidance by percent. 
| percent modifier 
| none 
| none 
| Calculated as base value / 100 is actual percent. Example for 7.14 percent modifier, set to 714. 

| 516 
| SE_AC_Mitigation_Max_Percent 
| AC Mitigation Max Percent 
| Modify AC mitigation by percent. 
| percent modifier 
| none 
| none 
| Calculated as base value / 100 is actual percent. Example for 7.14 percent modifier, set to 714. 

| 517 
| SE_Attack_Offense_Max_Percent 
| Attack Offense Max Percent 
| Modify ATK offense by percent. 
| percent modifier 
| none 
| none 
| Calculated as base value / 100 is actual percent. Example for 7.14 percent modifier, set to 714. 

| 518 
| SE_Attack_Accuracy_Max_Percent 
| Attack Accuracy Max Percent 
| Modify ATK accuracy by percent. 
| percent modifier 
| none 
| none 
| Calculated as base value / 100 is actual percent. Example for 7.14 percent modifier, set to 714. 

| 519 
| SE_Luck_Amount 
| Luck Amount 
| 
| 
| 
| 
| 

| 520 
| SE_Luck_Percent 
| Luck Percent 
| 
| 
| 
| 
| 

| 521 
| SE_Endurance_Absorb_Pct_Damage 
| Absorb Damage with Endurance 
| Reduces a percent of incoming damage using endurance, drains endurance at a ratio. 
| mitigation percentage 
| ratio 
| none 
| Base calculated as value / 100, example if base 2000 then mitigation is 20 percent. Limit is calculated as value / 10000, example if limit 500 then ratio will be 0.05 Endurance reduced per 1 Hit Point of damage. 

| 522 
| SE_Instant_Mana_Pct 
| Instant Mana Percent 
| Modify mana by percent of maximum mana, or flat amount, whichever is lower. 
| percent of max mana 
| max amount 
| none 
| Negative base value increases mana 

| 523 
| SE_Instant_Endurance_Pct 
| Instant Endurance Percent 
| Modify endurance by percent of maximum endurance, or flat amount, whichever is lower. 
| percent of max endurance 
| max amount 
| none 
| Negative base value increases endurance 

| 524 
| SE_Duration_HP_Pct 
| Duration HP Percent 
| Modify hit points by percent of maximum hit points, or flat amount, whichever is lower, repeates every tic if in a buff. 
| percent of max hit points 
| max amount 
| none 
| Negative base value increases hit points 

| 525 
| SE_Duration_Mana_Pct 
| Duration Mana Percent 
| Modify mana by percent of maximum mana, or flat amount, whichever is lower, repeates every tic if in a buff. 
| percent of max mana 
| max amount 
| none 
| Negative base value increases mana 

| 526 
| SE_Duration_Endurance_Pct 
| Duration Endurance Percent 
| Modify endurance by percent of maximum endurance, or flat amount, whichever is lower, repeates every tic if in a buff. 
| percent of max endurance 
| max amount 
| none 
| Negative base value increases endurance

---

## Spell Groups

*Source: server/spells/spell-groups/index.html*

# Spell Groups¶

| 

ID 
| Category 

| -99 
| NPC 

| -1 
| AA Procs 

| 1 
| Direct Damage [Magic] 

| 2 
| Direct Damage [Undead] 

| 3 
| Direct Damage [Summoned] 

| 4 
| Direct Damage [Life Taps] 

| 5 
| Direct Damage [Plant] 

| 6 
| Direct Damage [Velious Races] 

| 7 
| Damage over Time [Magic] 

| 8 
| Damage over Time [Undead] 

| 9 
| Damage over Time [Life Taps] 

| 10 
| Targeted Area of Effect Damage 

| 11 
| Point Blank Area of Effect Damage 

| 12 
| Area of Effect Rain 

| 13 
| Direct Damage [Bolt] 

| 14 
| Stun [Targeted Area of Effect] 

| 15 
| Stun [Targeted] 

| 16 
| Stun [Point Blank Area of Effect] 

| 17 
| Drains [Health/Mana] 

| 18 
| Drains [Stats] 

| 19 
| Contact Innates 

| 20 
| Heal [Instant] 

| 21 
| Heal [Duration] 

| 22 
| Group Heal [Instant] 

| 23 
| Group Heal [Duration] 

| 24 
| Regeneration [Single] 

| 25 
| Regeneration [Group] 

| 26 
| Heal [Own Pet] 

| 27 
| Resurrect 

| 28 
| Necromancer Life Transfer 

| 29 
| Cure [Poison] 

| 30 
| Health Buffs [Single] 

| 32 
| AC Buff [Single] 

| 34 
| Hate Mod Buffs 

| 35 
| Haste [Single] 

| 36 
| Haste [Pet] 

| 37 
| Haste [Group] 

| 38 
| Slow [Single] 

| 39 
| Slow [Targeted Area] 

| 40 
| Cannabalize 

| 41 
| Move Speed [Single] 

| 42 
| Move Speed [Group] 

| 43 
| Wolf Form 

| 44 
| Move Speed [Pet] 

| 45 
| Illusion [Self] 

| 46 
| Lich 

| 47 
| Bear Form 

| 48 
| Tree Form 

| 49 
| Dead Man Floating 

| 50 
| Root 

| 51 
| Summon Pet 

| 52 
| Summon Corpse 

| 53 
| Sense Undead 

| 54 
| Invulnerability 

| 55 
| Gate [Combat Portal] 

| 56 
| Gate [Self Gates] 

| 58 
| Translocate 

| 59 
| Shadow Step 

| 60 
| Enchant Item 

| 61 
| Summon [Misc Item] 

| 62 
| Fear 

| 63 
| Fear [Animal] 

| 64 
| Fear [Undead] 

| 65 
| Damage Shield [Single] 

| 66 
| Damage Shield [Group] 

| 67 
| Mark Of Karn 

| 68 
| Damage Shield [Self] 

| 69 
| Resist Debuffs 

| 70 
| Resist Buffs 

| 71 
| BST Pet Buffs 

| 72 
| Summon Familiar 

| 73 
| STR Buff 

| 74 
| DEX Buff 

| 75 
| AGI Buff 

| 76 
| STA Buff 

| 77 
| INT Buff 

| 78 
| CHA Buff 

| 79 
| Stat Debuffs 

| 80 
| Invisible Undead 

| 81 
| Invisible Animals 

| 82 
| Invisibility 

| 83 
| Absorb Damage 

| 84 
| Casting Level Buffs 

| 85 
| Clarity Line 

| 86 
| Max Mana Buffs 

| 87 
| Drain Mana 

| 88 
| Mana Transfer 

| 89 
| Instant Gain Mana 

| 90 
| Lower Hate [Jolt] 

| 91 
| Increase Archery 

| 92 
| Attack Buff 

| 93 
| Vision 

| 94 
| Water Breathing 

| 95 
| Improve Faction 

| 96 
| Charm 

| 97 
| Dispell 

| 98 
| Lull 

| 99 
| Mesmerise 

| 100 
| Spell Focus Items 

| 101 
| Snare [single] 

| 102 
| Snare [Area of Effect] 

| 105 
| Feign Death 

| 106 
| Identify 

| 107 
| Reclaim Energy 

| 108 
| Find Corpse 

| 109 
| Summon Player 

| 110 
| Spell Shield 

| 112 
| Blindness 

| 113 
| Levitation 

| 114 
| Extinguish Fatigue 

| 115 
| Death Pact 

| 116 
| Memory Blur 

| 118 
| Height 

| 119 
| Add Hate 

| 120 
| Iron Maiden 

| 121 
| Focus Spells 

| 122 
| Melee Guard 

| 125 
| Direct Damage [Fire] 

| 126 
| Direct Damage [Ice] 

| 127 
| Direct Damage [Poison] 

| 128 
| Direct Damage [Disease] 

| 129 
| Damage over Time [Fire] 

| 130 
| Damage over Time [Ice] 

| 131 
| Damage over Time [Poison] 

| 132 
| Damage over Time [Disease] 

| 133 
| INT Caster Chest Opening 

| 134 
| INT Caster Chest Trap Appraisal 

| 135 
| INT Caster Chest Trap Disarm 

| 136 
| WIS Caster Chest Trap Disarm 

| 137 
| WIS Caster Chest Trap Appraisal 

| 138 
| WIS Caster Chest Opening 

| 140 
| Destroy [Undead] 

| 141 
| Destroy [Summoned] 

| 142 
| Targeted Area of Effect [Fire] 

| 143 
| Targeted Area of Effect [Ice] 

| 146 
| Point Blank Area of Effect [Fire] 

| 147 
| Point Blank Area of Effect [Ice] 

| 150 
| Rain [Fire] 

| 151 
| Rain [Ice] 

| 152 
| Rain [Poison] 

| 154 
| Fear Song 

| 155 
| Fast Heals 

| 156 
| Mana to Health 

| 157 
| Pet Siphons 

| 159 
| Cure [Disease] 

| 160 
| Cure [Curse] 

| 161 
| Cure [Multiple] 

| 162 
| Cure [Blind] 

| 163 
| Group Cure [Multiple] 

| 164 
| Misc Effects 

| 165 
| Shielding 

| 166 
| PAL/RNG/BST Health Buffs 

| 167 
| Symbols 

| 168 
| Aegolism Line 

| 169 
| Paladin AC Buffs 

| 170 
| Spell Damage Mitigate 

| 171 
| Spell/Melee Block 

| 172 
| Spell Reflect 

| 173 
| Hybrid AC Buffs 

| 174 
| Health/Mana Regeneration 

| 175 
| Aggro Decreasers 

| 200 
| Misc Spells 

| 201 
| Disciplines 

| 202 
| Melee Haste 

| 203 
| Area of Effect Slow 

| 204 
| Summon Air Pet 

| 205 
| Summon Water Pet 

| 206 
| Summon Fire Pet 

| 207 
| Summon Earth Pet 

| 208 
| Summon Monster Pet 

| 209 
| Transport [Antonica] 

| 210 
| Transport [Odus] 

| 211 
| Transport [Faydwer] 

| 212 
| Transport [Kunark] 

| 213 
| Transport [Velious] 

| 214 
| Transport [Luclin] 

| 215 
| Transport [Planes] 

| 216 
| Transport [Gates/Omens] 

| 217 
| Summon [Weapon] 

| 218 
| Summon [Focus] 

| 219 
| Summon [Food/Drink] 

| 220 
| Summon [Armor] 

| 999 
| AA / Abilities

---

## Spell Heal Modifiers

*Source: server/spells/spell-heal-modifiers/index.html*

# Spell Heal Modifiers¶

**Overview of spell effects that modify Healing**

**Key:** **Focus Effect,** ***Item Effect*****,** **Non-Focus Spell Effect**

**INSTANT HEALS**

**Heal critical modfier is always set at 100% (2x)*

_*If multiple of same Focus Effect, highest avialable value is used. [Stacks] Indicates that if multiple of same effect, the final amount is the total of all effects. _

- **Focus Effects** **that increase/decrease healing by percent.**

- **SE_FcBaseEffects (413)** Modifies by % the base heal value of the spell cast.

- **SE_ImprovedHeal** **(125) **Modifies by % the heal value after (413) is applied.

- **Effects on CASTER that increase/decrease healing by a specific amount.**

- **SE_FcHealAmt (392)** ± a set heal amount. (This value CAN NOT criticals).

- **SE_FcHealAmtCrital (396) **± a set heal amount. (This value CAN critical)

- ***Item 'Heal Amount"*** - Amount specified on the item modified by formula bellow. (This value CAN critical)

Value is modified by the 'total cast time' of the spell it is being applied to

- *Total Cast Time* is derived from adding which ever is greater(Recast OR Recovery time) to cast time.

- *Total Cast Time* (0 - 2.5 seconds). 

- Heal Amount = Heal Amount / 4

- *Total Cast Time* (2.6 - 7.0 seconds)

- Heal Amount = Heal Amount*(0.167*(*Total Cast Time*)/1000))

- *Total Cast Time* ( > 7.0 seconds)

- Heal Amount = Heal Amount / 7

- **Effects on TARGET that increase/decrease healing by a specific amount.**

- **SE_FcHealAmtIncoming (394) **± a set amount of healing. (This value CAN NOT critical)

- **Effects on TARGET that increase/decrease healing by percent.**

- **SE_HealRate (120)** Modfies by % the casters base heal value. (This value CAN NOT critical) [Stacks]

- **SE_FcHealPctIncoming (393)** Modifies by % the casters base heal value. (This value CAN NOT critical).

- **Effects on CASTER that increase critical spell chance.**

- **SE_CriticalHealChance (274)** Modfies by % the chance to critical heal.[Stacks]

- **SE_CriticalHealDecay (434)** Modifies by % the chance to critical heal. [Stacks]

Effect value decreases if spell cast is over the maximum level specified.

- **Effects on TARGET that increase critical spell chance.**

- **SE_FcHealPctCritIncoming (395)** Modifies by % the casters chance to critical heal.

**Calculation **

**Critical Chance = **SE_CriticalHealChance** + **SE_CriticalHealDecay** + SE_FcHealPctCritIncoming**

**X =** Heal Amount

**CritMod** = 2 (Assume we critical, no critical set to 1)

**Final Heal Amount = (((X * SE_FcBaseEffects) * SE_ImprovedHeal )*CritMod) + SE_FcHealAmt + (SE_FcHealAmtCrital * CritMod) + (Item 'Heal Amount" * CritMod) + SE_FcHealAmtIncoming **

**+ ((X * SE_FcBaseEffects) * **SE_HealRate** )) + ((X * SE_FcBaseEffects) * SE_FcHealPctIncoming )) **

**HEAL OVER TIME**

**Heal critical modfier is always set at 100% (2x)*

- **Heal Over Time spells are NOT modifed by the following**

- **Effects on TARGET that increase/decrease healing by a specific amount.**

- **Effects on CASTER or TARGET that increase/decrease healing by a specific amount.**

- **Effects on CASTER that increase critical spell chance. **

- **SE_CriticalHealOverTime (319)** Modfies by % the chance to critical heal. [Stacks]

- **SE_CriticalRegenlDecay (435)**** **Modifies by % the chance to critical heal. [Stacks]

Effect value decreases if spell cast is over the maximum level specified.

- **Effects on TARGET that increase critical spell chance.**

- **SE_FcHealPctCritIncoming (395) **Modifies by % the casters chance to critical heal.

---

## Spell Mechanics

*Source: server/spells/spell-mechanics/index.html*

# Spell Mechanics¶

**Collection of details on various spell effect mechanics.**

*Most of the mechanics described in this section were deduced from extensive personal parsing on live server .~ Kayen

*Term 'resist check' means essessentially the chance for the spell to be resisted. Resist checks can occur for various reasons after the spell has already landed. Failed 'resist check' means as if it was resisted.

**ROOT**

- **SE_Root (99)**

- Root has an innate chance to break every buff tick.

There is a 70% chance to trigger a resist check each tick.

- If resist check fails root will fade.

- There is a lower bounds 6% chance per tick of root breaking no matter what. (If you have 0% chance to resist the spell due to Tash/Green con) 

- Root has an innate chance to break every time a direct damage spell is applied

There is an approximately 70% chance of root breaking from a DD spell if target is greater than your level, equal to your level or (1) level less than you.

- There is an approximately 55% chance of root breaking from a DD spell if the target is (2) levels less then you.

- There is an approximately 42% chance of root breaking from a DD spell if target is between (3) and (20) levels less then you.

- There is an approximately 14% chance of root breaking from a DD spell if target is (20) levels less then you.

- **SE_RootBreakChance (244)** *'Visicid Roots AA'*** **Reduces the baseline root break chance (ie 70%) by the effect value.

- When a root is cast by a player with this effect the reduced root break chance is applied directly to the root.

- The benefit is therefore given to any player casting on that NPC with the root. (opposed to only the caster of the root).

- When multiple roots are applied to the same target the root in the first slot is always removed first from spell damage.

- Only roots from determinental spells can be broken by direct damage spells.

*The following spell effects (Charm, Mez, Pacify) resist chances are influenced in part by this specific **charisma modifier.**

- Charisma Modifer applies a bonus/penalty to your resist chance base on your charisma statistic.

- For Charisma >= 75 and <= 255, every 10 Charisma is equivelent to a -1 resist modifier. *(-1 = 0,5 % reduction in resist chance)*

- For Charisma < 75, every 10 Charisma less than 75 is equivelent to a +6 resist modifer. *(6 = 3% increase in resist chance)*

**CHARM**

- **SE_Charm (22)**

- Charm when is cast initially a resist check is made which is effected by a **charisma modifier**.

- Charm if successful has an innate chance to break every buff tick. (*Unless flagged in unbreakable in spell table 'powerful_flag*')

There is an approximately 25% chance to trigger a resist check each tick to determine if charm will fade.

- Resist check for charm to fade is NOT effected by Charisma or Base1 value (unknown what that does).

- There is a lower bounds of approximately 3% chance per tick of charm breaking no matter what. (If you have 0% chance to resist the spell due to Tash/Green con) 

- If resist check fails...

If player has a bonus from **SE_CharmBreakChance (243)** _'Total Domination AA' _you have another chance for charm not to break based on the value,

- Example: *Total Domination Rank 3* is 50% chance for charm not to break if resist check fails.

- Otherwise, charm will fade.

**PACIFY**

- **SE_Lull (18) SE_Harmony (89) SE_ChangeFrenzyRad (30)**

- Pacification abilities chance to be resisted is NOT influenced by the targets magic resistance (or any other resist stat).

There is a flat 7.5 % chance to resist that is modified only by the level difference between caster and target.

- If Pacification is RESISTED then a second resist check is performed.

This resist check does use the targets regular resistances and a **charisma modifier.**

- If the resist check fails (resisted) then target will aggro the caster.

- If the resist check passes (resisted) then target will NOT aggro the caster.

**MESMERIZATION**

- **SE_Mez (31)**

- Mez when is cast initially a resist check is made which is effected by a **charisma modifier**.

Mez base value of 1 or 2 determines stacking behavior.

- Mez with value of 2 will always overwrite a mez with a value of 1.

**FEAR**

- **SE_Fear (23)**

- Fear when is cast initially a resist check is made which is effected by a **charisma modifier** (*Note: This is not the same as Charm/Mez/Paci)*

Charisma Modifer applies a bonus/penalty to your resist chance base on your charisma statistic.

- For Charisma < 100, fear is given a -20 resist modifier. *(-20 = 10 % reduction in resist chance)*

- For Charisma > 100 to 255, the -20 resist modifier is progresively lowered to zero as you gain more charisma (0 at 255).

- This modifier DOES NOT apply to Undead Fears.

- Fear has an innate chance to break every buff tick.

- There is a 70% chance to trigger a resist check each tick.

Resist check for fear to fade is NOT effected by Charisma or Base1 value (unknown what that does).

- If resist check fails fear will fade.

- There is NO lower bounds chance per tick of fear breaking. (If you have 0% chance to resist the spell due to Tash/Green con) 

**DISPELL**

- **SE_CancelMagic (27), SE_Purify (291), SE_DispelDetrimental (124)**, **SE_DispelBeneficial (209)**

- When dispel is cast every buff starting with the first buff slot is checked to see if it can be removed. *(Buffs can be set immune to dispel in table)*

If it fails to dispel a buff it will move on to the next buff and try that until there are no buffs left to check.

- Dispels often have multiple chances to dispel as in Annul Magic

- Meaning for each 'slot' there is a dispel, is its own independent chance to run through your buff list and remove a buff.

- To determine if the buff will be removed dispels check the level of the caster agianst the buff level.

Buff Level is determined by the level of the caster who that buff.

- If there is no difference between the casters level and the 'buff level' then there is an approximately 36% chance to have that buff removed.

- If the level of the caster is less than the the 'buff level' then for each level difference the chance to remove the buff is decreased by 8%.

- Example.. If buff level is 2 level higher then casters level you have a (36 - 16) = 16% chance to remove the buff.

- There is always a lower limit of 10% chance to remove the buff regardless of level difference.

- If the level of the caster is greater than the 'buff level' then for each level difference the chance to remove the buff is increased by 2%.

- The base effect value of these effects is a level modifier.

- Annul Magic has a value of (9) . This means when calculating chance to remove the buff we ADD 9 levels to the caster.

- Example: Caster is Lv 15 and targets 'buff level' 24 and you cast annul magic (9).

This means that the level difference is (15+9) - 24 = 0

- Resutling in a 36% chance to remove the buff.

**6/6/14** - [**PATCH 5-20-14**] Note: *Updated all spells which use Remove Detrimental and Cancel Beneficial spell effects to use a new method. The chances for those spells to affect their targets have not changed unless otherwise noted*

- Base value now defines a percent chance for success? Where Base / 10 = Chance (Ie. 950 / 10 = 95%)

- *At present time this effect is supported using PRE or POST patch values.*

**DEATH SAVE**

- **SE_DeathSave (150)**

- When a DeathSave buff (*Divine Intervention / Death Pact)* is applied to a target the owner of the buff is given a chance at receiving a heal when under 15% hit points.

This effect always triggers when under 15% HP.

- The heal amount is determined by the base value [1=Partial 3000 HP] [2=Full 8000 HP].

If Max Value is set as heal amount this value will be used instead as the heal amount.

- Chance to receive a heal is determined by the owner of the buffs Charisma.

Chance = ((Charisma * 3) +1) / 10) 

- If chance is successful then the owner of the buff recieves the heal and the buff FADES.

- If chance is NOT succesful then the buff FADES.

- OR If you fail and have an effect from **SE_UnfailingDivinity (277)** ***'**AA Unfailing Divinity'* you are given a second chance.

The chance is the same as the initial check using Charisma.

- If succesful then the owner of the buff recievies a heal that is modified by the value of **SE_UnfailingDivinity (277)**

- If value of effect is 20 then your heal is only 20% of the initial value *(Ie. 8000 * 20 / 100)*

- If chance is NOT succesful then buff FADES

**DIVINE SAVE**

- **SE_DivineSave (232)**

- Divine Save provides an opportunity to avoid death. The effect is triggered on the owner of the buff/aa/item with this effect when actual character death occurs (after delay death effects).

The base value determines the chance for this effect to occur upon death, if successful...

- The owner of the effect has their HP restored to (1)

- A spell is cast on the owner (Spell ID determined by base2/limit). This is typically the heal spell Touch of the Divine I.

- The short duration buff Touch of the Divine is ALWAYS cast, providing HOT/Removal of Determineal Buffs/Invulnerability.

**SE_FcBaseEffects (413)**

- Focus effect that modifies the base values_ (value before any other modifications are applied)_ of many spell effects _(not typically subject to focus effects). _

- List of known spell effects that are FcBaseEffects modifies

- SE_SkillAttack - Modifies base weapon damage amount

- Direct/DoT base spell damage amounts. Spell Damage Modifiers

- Heal/HoT base spell healing amounts. Heal Modifiers

- SE_Rune - Modifies base rune amount

- Bard instrument modifiers - NOT IMPLEMENTED *(Was reports of crashes possibly due to this so remains disabled till can be resolved)*

- Bard song effects (regular foci do not work on bard songs) - NOT IMPLEMENTED *(Was reports of crashes possibly due to this so remains disabled till can be resolved)*

---

## Spell Resist Types

*Source: server/spells/spell-resist-types/index.html*

# Spell Resist Types¶

| 

Resist Type 
| Value 
| NOTES 

| NONE 
| 0 
| Unresistable 

| MAGIC 
| 1 
| 

| FIRE 
| 2 
| 

| COLD 
| 3 
| 

| POISON 
| 4 
| 

| DISEASE 
| 5 
| 

| CHROMATIC 
| 6 
| Resist amount is the averages of MR, FR, CR, PR and DR 

| PRISMATIC 
| 7 
| Resist amount is your lowest resist value from MR, FR, CR, PR or DR 

| PHYSICAL 
| 8 
| This resist type exists on NPC's and uses a different formula than standard resists. Resist All spell effects do NOT raise this. 

| CORRUPTION 
| 9 
|

---

## Spell Target Restrictions

*Source: server/spells/spell-target-restrictions/index.html*

# Spell Target Restrictions¶

| 

| 

| Value 
| Target/Cast Restriction 

| 1 
| UNKNOWN 

| 100 
| Animal OR Humanoid 

| 101 
| Dragon 

| 102 
| Animal OR Insect 

| 103 
| NOT USED 

| 104 
| Animal 

| 105 
| Plant 

| 106 
| Giant 

| 107 
| NOT USED 

| 108 
| NOT Animal or Humaniod 

| 109 
| Bixie 

| 111 
| Harpy 

| 112 
| Sporali 

| 113 
| Kobold 

| 114 
| Shade Giant 

| 115 
| Drakkin 

| 116 
| NOT USED 

| 117 
| Animal OR Plant 

| 118 
| Summoned 

| 119 
| Firepet 

| 120 
| Undead 

| 121 
| Living (NOT Undead) 

| 122 
| Fairy 

| 123 
| Humanoid 

| 124 
| Undead HP < 10% 

| 125 
| Clockwork HP < 10% 

| 126 
| Wisp HP < 10% 

| 127-130 
| UNKNOWN 

| 150 
| UNKNOWN 

| 190 
| No Raid boss flag *not implemented 

| 191 
| This spell will deal less damage to 'exceptionally strong targets' - Raid boss flag *not implemented 

| 201 
| Damage if HP > 75% 

| 203 
| Damage if HP < 20% 

| 216 
| TARGET NOT IN COMBAT 

| 221 - 249 
| Causing damage dependent on how many pets/swarmpets are attacking your target. 

| 250 
| Damage if HP < 35% 

| 300 - 303 
| UNKOWN *not implemented 

| 304 
| Chain + Plate class (buffs) 

| 399 - 409 
| Heal if HP within a specified (400 = 0-25% 401 = 25 - 35% 402 = 35-45% ect) 

| 410 - 411 
| UNKNOWN 

| 500 - 599 
| Heal if HP less than a specified value 

| 600 - 699 
| Limit to Body Type [base2 - 600 = Body] 

| 700 
| UNKNOWN 

| 701 
| NOT PET 

| 800 
| UKNOWN 

| 818 - 819 
| If Undead/If Not Undead 

| 820 - 822 
| UNKNOWN 

| 835 
| UNKNOWN 

| 836 - 837 
| Progression Server / Live Server *not implemented 

| 839 
| Unknown *not implemented 

| 842 - 844 
| Humaniod lv MAX ((842 - 800) * 2) 

| 845 - 847 
| UNKNOWN 

| 10000 - 11000 
| Limit to Race [base2 - 10000 = Race] (*NOT ON LIVE - Custom for EMU)

---

## Spell Types

*Source: server/spells/spell-types/index.html*

# Spell Types¶

| 

Spell Type ID 
| Spell Type Bitmask 
| Spell Type Name 

| 0 
| 1 
| Nuke 

| 1 
| 2 
| Heal 

| 2 
| 4 
| Root 

| 3 
| 8 
| Buff 

| 4 
| 16 
| Escape 

| 5 
| 32 
| Pet 

| 6 
| 64 
| Lifetap 

| 7 
| 128 
| Snare 

| 8 
| 256 
| Damage Over Time 

| 9 
| 512 
| Dispel 

| 10 
| 1024 
| In Combat Buff 

| 11 
| 2048 
| Mesmerize 

| 12 
| 4096 
| Charm 

| 13 
| 8192 
| Slow 

| 14 
| 16384 
| Debuff 

| 15 
| 32768 
| Cure 

| 16 
| 65536 
| Resurrect 

| 17 
| 131072 
| Hate Redux 

| 18 
| 262144 
| In Combat Buff Song 

| 19 
| 524288 
| Out Of Combat Buff Song 

| 20 
| 1048576 
| Pre Combat Buff 

| 21 
| 2097152 
| Pre Combat Buff Song

---

## Target Types

*Source: server/spells/target-types/index.html*

# Target Types¶

| 

**Type ID** 
| **Type** 

| 0 
| Rag'Zhezum Special 

| 1 
| Line of Sight 

| 3 
| Group V1 

| 4 
| Point Blank Area of Effect 

| 5 
| Single 

| 6 
| Self 

| 8 
| Targeted Area of Effect 

| 9 
| Animal 

| 10 
| Undead 

| 11 
| Summoned 

| 13 
| Life Tap 

| 14 
| Pet 

| 15 
| Corpse 

| 16 
| Plant 

| 17 
| Uber Giants 

| 18 
| Uber Dragons 

| 20 
| Targeted Area of Effect Life Tap 

| 24 
| Area of Effect Undead 

| 25 
| Area of Effect Summoned 

| 32 
| Area of Effect Caster 

| 33 
| NPC Hate List 

| 34 
| Dungeon Object 

| 35 
| Muramite 

| 36 
| Area - PC Only 

| 37 
| Area - NPC Only 

| 38 
| Summoned Pet 

| 39 
| Group No Pets 

| 40 
| Area of EffectPC V2 

| 41 
| Group v2 

| 42 
| Self (Directional) 

| 43 
| Group With Pets 

| 44 
| Beam

---

## Time of Day Types

*Source: server/spells/time-of-day-types/index.html*

# Time of Day Types¶

| 

Time of Day Type ID 
| Time of Day Type Name 

| 0 
| Any Time 

| 1 
| Day Time 

| 2 
| Night Time

---

## Type Effect Description Number

*Source: server/spells/type-effect-description-number/index.html*

# Type Effect Description Number¶

| 

Index 
| Description 
| Raw dbstr.txt string 

| 1 
| Aegolism 
| 15Aegolism 

| 2 
| Agility 
| 25Agility 

| 3 
| Alliance 
| 35Alliance 

| 4 
| Animal 
| 45Animal 

| 5 
| Antonica 
| 55Antonica 

| 6 
| Armor Class 
| 65Armor Class 

| 7 
| Attack 
| 75Attack 

| 8 
| Bane 
| 85Bane 

| 9 
| Blind 
| 95Blind 

| 10 
| Block 
| 105Block 

| 11 
| Calm 
| 115Calm 

| 12 
| Charisma 
| 125Charisma 

| 13 
| Charm 
| 135Charm 

| 14 
| Cold 
| 145Cold 

| 15 
| Combat Abilities 
| 155Combat Abilities 

| 16 
| Combat Innates 
| 165Combat Innates 

| 17 
| Conversions 
| 175Conversions 

| 18 
| Create Item 
| 185Create Item 

| 19 
| Cure 
| 195Cure 

| 20 
| Damage Over Time 
| 205Damage Over Time 

| 21 
| Damage Shield 
| 215Damage Shield 

| 22 
| Defensive 
| 225Defensive 

| 23 
| Destroy 
| 235Destroy 

| 24 
| Dexterity 
| 245Dexterity 

| 25 
| Direct Damage 
| 255Direct Damage 

| 26 
| Disarm Traps 
| 265Disarm Traps 

| 27 
| Disciplines 
| 275Disciplines 

| 28 
| Discord 
| 285Discord 

| 29 
| Disease 
| 295Disease 

| 30 
| Disempowering 
| 305Disempowering 

| 31 
| Dispel 
| 315Dispel 

| 32 
| Duration Heals 
| 325Duration Heals 

| 33 
| Duration Tap 
| 335Duration Tap 

| 34 
| Enchant Metal 
| 345Enchant Metal 

| 35 
| Enthrall 
| 355Enthrall 

| 36 
| Faydwer 
| 365Faydwer 

| 37 
| Fear 
| 375Fear 

| 38 
| Fire 
| 385Fire 

| 39 
| Fizzle Rate 
| 395Fizzle Rate 

| 40 
| Fumble 
| 405Fumble 

| 41 
| Haste 
| 415Haste 

| 42 
| Heals 
| 425Heals 

| 43 
| Health 
| 435Health 

| 44 
| Health/Mana 
| 445Health/Mana 

| 45 
| HP Buffs 
| 455HP Buffs 

| 46 
| HP type one 
| 465HP type one 

| 47 
| HP type two 
| 475HP type two 

| 48 
| Illusion: Other 
| 485Illusion: Other 

| 49 
| Illusion: Player 
| 495Illusion: Player 

| 50 
| Imbue Gem 
| 505Imbue Gem 

| 51 
| Invisibility 
| 515Invisibility 

| 52 
| Invulnerability 
| 525Invulnerability 

| 53 
| Jolt 
| 535Jolt 

| 54 
| Kunark 
| 545Kunark 

| 55 
| Levitate 
| 555Levitate 

| 56 
| Life Flow 
| 565Life Flow 

| 57 
| Luclin 
| 575Luclin 

| 58 
| Magic 
| 585Magic 

| 59 
| Mana 
| 595Mana 

| 60 
| Mana Drain 
| 605Mana Drain 

| 61 
| Mana Flow 
| 615Mana Flow 

| 62 
| Melee Guard 
| 625Melee Guard 

| 63 
| Memory Blur 
| 635Memory Blur 

| 64 
| Misc 
| 645Misc 

| 65 
| Movement 
| 655Movement 

| 66 
| Objects 
| 665Objects 

| 67 
| Odus 
| 675Odus 

| 68 
| Offensive 
| 685Offensive 

| 69 
| Pet 
| 695Pet 

| 70 
| Pet Haste 
| 705Pet Haste 

| 71 
| Pet Misc Buffs 
| 715Pet Misc Buffs 

| 72 
| Physical 
| 725Physical 

| 73 
| Picklock 
| 735Picklock 

| 74 
| Plant 
| 745Plant 

| 75 
| Poison 
| 755Poison 

| 76 
| Power Tap 
| 765Power Tap 

| 77 
| Quick Heal 
| 775Quick Heal 

| 78 
| Reflection 
| 785Reflection 

| 79 
| Regen 
| 795Regen 

| 80 
| Resist Buff 
| 805Resist Buff 

| 81 
| Resist Debuffs 
| 815Resist Debuffs 

| 82 
| Resurrection 
| 825Resurrection 

| 83 
| Root 
| 835Root 

| 84 
| Rune 
| 845Rune 

| 85 
| Sense Trap 
| 855Sense Trap 

| 86 
| Shadowstep 
| 865Shadowstep 

| 87 
| Shielding 
| 875Shielding 

| 88 
| Slow 
| 885Slow 

| 89 
| Snare 
| 895Snare 

| 90 
| Special 
| 905Special 

| 91 
| Spell Focus 
| 915Spell Focus 

| 92 
| Spell Guard 
| 925Spell Guard 

| 93 
| Spellshield 
| 935Spellshield 

| 94 
| Stamina 
| 945Stamina 

| 95 
| Channeling Focus 
| 955Channeling Focus 

| 96 
| Strength 
| 965Strength 

| 97 
| Stun 
| 975Stun 

| 98 
| Sum: Air 
| 985Sum: Air 

| 99 
| Sum: Animation 
| 995Sum: Animation 

| 100 
| Sum: Earth 
| 1005Sum: Earth 

| 101 
| Sum: Familiar 
| 1015Sum: Familiar 

| 102 
| Sum: Fire 
| 1025Sum: Fire 

| 103 
| Sum: Undead 
| 1035Sum: Undead 

| 104 
| Sum: Warder 
| 1045Sum: Warder 

| 105 
| Sum: Water 
| 1055Sum: Water 

| 106 
| Summon Armor 
| 1065Summon Armor 

| 107 
| Summon Focus 
| 1075Summon Focus 

| 108 
| Summon Food/Water 
| 1085Summon Food/Water 

| 109 
| Summon Utility 
| 1095Summon Utility 

| 110 
| Summon Weapon 
| 1105Summon Weapon 

| 111 
| Summoned 
| 1115Summoned 

| 112 
| Symbol 
| 1125Symbol 

| 113 
| Taelosia 
| 1135Taelosia 

| 114 
| Traps 
| 1145Traps 

| 115 
| Techniques 
| 1155Techniques 

| 116 
| The Planes 
| 1165The Planes 

| 117 
| Timer 1 
| 1175Timer 1 

| 118 
| Timer 2 
| 1185Timer 2 

| 119 
| Timer 3 
| 1195Timer 3 

| 120 
| Timer 4 
| 1205Timer 4 

| 121 
| Timer 5 
| 1215Timer 5 

| 122 
| Timer 6 
| 1225Timer 6 

| 123 
| Transport 
| 1235Transport 

| 124 
| Undead 
| 1245Undead 

| 125 
| Utility Beneficial 
| 1255Utility Beneficial 

| 126 
| Utility Detrimental 
| 1265Utility Detrimental 

| 127 
| Velious 
| 1275Velious 

| 128 
| Visages 
| 1285Visages 

| 129 
| Vision 
| 1295Vision 

| 130 
| Wisdom/Intelligence 
| 1305Wisdom/Intelligence 

| 131 
| Traps 
| 1315Traps 

| 132 
| Auras 
| 1325Auras 

| 133 
| Endurance 
| 1335Endurance 

| 134 
| Serpent's Spine 
| 1345Serpent's Spine 

| 135 
| Corruption 
| 1355Corruption 

| 136 
| Learning 
| 1365Learning 

| 137 
| Chromatic 
| 1375Chromatic 

| 138 
| Prismatic 
| 1385Prismatic 

| 139 
| Sum: Swarm 
| 1395Sum: Swarm 

| 140 
| Delayed 
| 1405Delayed 

| 141 
| Temporary 
| 1415Temporary 

| 142 
| Twincast 
| 1425Twincast 

| 143 
| Sum: Bodyguard 
| 1435Sum: Bodyguard 

| 144 
| Humanoid 
| 1445Humanoid 

| 145 
| Haste/Spell Focus 
| 1455Haste/Spell Focus

---

## Task System

*Source: server/task-system-guide/index.html*

# Task System¶

The EQEmu Task System allows implementation of quests that utilize the clients Task Window (alt+Q). Many aspects of this system can be found throughout this wiki; this guide attempts to organize that information on a single page to inform the reader who wishes to understand and utilize the Task System.

Much of the Task System functionality can be found in /zones/task.cpp and should be referenced by those comfortable with looking at the EQEmu source code.

Info

While every attempt will be made to keep this page updated, please reference the additional supporting documentation found in the Database Schema, Quest API, and Changelog.

| 

Section Description 
| Link 

| Database Schema: All of the DB tables for the task system 
| Database Schema 

| GM Commands: in-game GM commands for the task system 
| GM Commands 

| Task System Rules: server rules effecting the task system 
| Task System Rules 

| Logging Options: use with the Logging System 
| Logging Options 

| Quest API: quest methods and EVENT triggers relating to the task system 
| Quest API 

## Database Schema¶

The most up to date information regarding the database schema can be found in the Database Schema Space for Tasks. The information presented here is current as of this writing.

### Tasks Table¶

#### Field Descriptions¶

| 

Column 
| Data Type 
| Description 

| id 
| int 
| Unique Task Identifier; use 1 - 9999, a value of 0 should NOT be used 

| type 
| tinyint 
| Task Type; 0=Task, 1=Shared, 2=Quest, 3=Expedition 

| duration 
| int 
| Duration in seconds; if 0, the task has no time limit 

| duration_code 
| tinyint 
| Duration Code; 0=None, 1=Short, 2=Medium, 3=Long 

| title 
| varchar 
| Title 

| description 
| text 
| Description; only the active task description displays 

| reward 
| varchar 
| Reward Description 

| rewardid 
| int 
| Item ID number, or a reference to a list of item ID numbers (from goallists table) 

| cashreward 
| int 
| Cash Reward, listed in copper (system will convert to plat, gold, etc.) 

| xpreward 
| int 
| Experience Reward; for level-based, set a negative value using the following formula: max level * 100 + experience percent 

| rewardmethod 
| tinyint 
| Reward Method: 0 = Single Item ID, 1 = List of Items (in the goallist table), 2 = Quest Controlled (reward granted through NPC quest script) 

| minlevel 
| tinyint 
| Minimum Level to obtain tasks 

| maxlevel 
| tinyint 
| Maximum Level to obtain tasks 

| repeatable 
| tinyint 
| Repeatable: 0 = False, 1 = True 

| faction_reward 
| int 
| Faction Reward 

| completion_emote 
| varchar 
| Completion Emote 

### Task_Activities Table¶

#### Field Descriptions¶

| 

Column 
| Data Type 
| Description 

| taskid 
| int 
| Task Identifier (ID from Tasks table); each activity for a task will utilize the same ID. 

| activityid 
| int 
| Activity Identifier: Starts at 0, **must be sequential** 

| step 
| int 
| Step: 0 = Always Available, >0 = Must Complete Previous ("stepped" task) 

| activitytype 
| tinyint 
| Activity Type (or see below) 

| target_name 
| varchar 
| Target Name 

| item_list 
| varchar 
| Item Identifier List 

| skill_list 
| varchar 
| Skill Identifier List 

| spell_list 
| varchar 
| Spell Identifier List 

| description_override 
| varchar 
| Description Override 

| goalid 
| int 
| Goal Identifier or Goal List Identifier 

| goalmethod 
| int 
| 
Goal Method: 

0 = Single Value (npc_type ID or item ID)

1 = List (refers to the goallist table to use a list of npc_type IDs or Item IDs)

2 = Under control of quest system

| goalcount 
| int 
| Goal Count (how many of the things in the goal id must be done) 

| delivertonpc 
| int 
| Deliver To NPC: 0 = No Delivery NPC, >0 = npc_type ID 

| zones 
| varchar 
| Zones List--use the zoneidnumber field; "0" displays "ALL". Activities will only be counted if completed in the assigned zone. Can also be used as "Touch" for visiting an assigned zone. 

| optional 
| tinyint 
| Optional: 0 = False, 1 = True; if a task activity is optional, the task will be complete when all non-optional task activities are completed. 

#### Activity Types¶

Info

Please note that **quest::updatetaskactivity **could be used in many EVENT triggers if you did not want to use the task system as described in the table below.

| 

Type ID 
| 
Type 
Name
 
| Information and usage 

| 1 
| Deliver 
| 
To have this activity automatically handled by the task system without the need to write any Perl quest code, set:

- goalmethod 0
- goalid to the id of the item you want delivered
- delivertonpc to the npc_types id you want the item delivered to
- zoneid to the zoneidnumber the npc is in (or 0 for all)

If you wish to allow the player to deliver any out of a group of items, then you can use a list. To do this, create a list in the goallist table containing the allowable items. Then set the goalmethod to 1 and put the list number in the goalid field.

| 2 
| Kill 
| 
To have this activity automatically handled by the task system without the need to write any Perl quest code, set:

- goalmethod to 0
- goalid to the id of the npc that must be killed (from the npc_types table).
- zoneid should be set to 0 (any zone), or the zoneidnumber if the mobs must be killed in a particular zone to count.

If you wish to allow the player to kill any out of a group of NPC types, then you can use a list as described for the Deliver activity. For common mobs, you will probably always be using lists, since there are a lot of entries for mobs with the same name in the npc_types table which differ by level, etc.

| 3 
| Loot 
| 
To have this activity automatically handled by the task system without the need to write any Perl quest code, set:

- goalmethod to 0
- goalid to the id of the item that must be looted (from the items table).
- zoneid should be set to 0 (any zone), or the zoneidnumber if the item must be looted in a particular zone to count.

If you wish to allow the player to loot any one of a group of items, then you can use a list as described for the Deliver activity.

| 4 
| Speak With 
| 
To have this activity automatically handled by the task system without the need to write any Perl quest code, set:

- goalmethod to 0
- goalid to the id of the NPC that must be spoken to (from the npc_types table). 
- zoneid should be set to 0 (any zone), or the zoneidnumber that the NPC is in.

If you wish to allow the player to speak to any one of a group of NPCs, then you can use a list as described for the Deliver activity.

| 5 
| Explore 
| 
To have this activity automatically handled by the task system without the need to write any Perl quest code, you will need to add a row to the proximity table. Once you have added the row and given it a unique exploreid number, in the activity table, set:

- goalmethod to 0
- goalid to the exploreid of your newly created row in the proximity table.
- zoneid should be set to the zoneidnumber that the proximity is in.

It should be possible to set up multiple proximities in the same zone, using lists, such that any of the proximities will trigger the activity complete.

| 6 
| Tradeskill 
| 
To have this activity automatically handled by the task system, set:

- goalmethod to 0
- goalid to the id of the item that must be created (from the items table).
- zoneid should be set to 0 (any zone), or the zoneidnumber that the items must be created in.

If you wish to allow the player to create any one of a group of items, then you can use a list as described for the Deliver activity. Sometimes there are several items with the same name that can be created from a tradeskill, CLASS 1 Wood Point arrows being one of them.

| 7 
| Fish 
| 
To have this activity automatically handled by the task system, set:

- goalmethod to 0
- goalid to the id of the item that must be fished (from the items table).
- zoneid should be set to 0 (any zone), or the zoneidnumber that the items must be fished in.

If you wish to allow the player to fish any one of a group of items, then you can use a list as described for the Deliver activity.

| 8 
| Forage 
| 
To have this activity automatically handled by the task system, set:

- goalmethod to 0
- goalid to the id of the item that must be foraged (from the items table).
- zoneid should be set to 0 (any zone), or the zoneidnumber that the items must be fished in.

If you wish to allow the player to forage any one of a group of items, then you can use a list as described for the Deliver activity.

| 9 
| Use 
| 

| 10 
| Use 
| 

| 11 
| Touch 
| 
To have this activity automatically handled by the task system, set:

- goalmethod to 0

Since the zoneid field is used to specify the zoneidnumber, the goalid field is not used. It is also not possible to specify a list of zones.

| 100 
| Give Cash 
| 
To have this activity automatically handled by the task system, set:

- goalmethod to 0
- npctypeid to the id of the NPC that the cash should be given to
- zoneid should be set to 0 (any zone), or the zoneidnumber that the NPC is found in.

### Character_Tasks Table¶

#### Field Descriptions¶

| 

Column 
| Data Type 
| Description 

| charid 
| int 
| Character Identifier; ID from character_data 

| taskid 
| int 
| Task Identifier; ID from tasks table 

| slot 
| int 
| 
Slot; the slot number (up to 19) that causes the activity to 

display in order to the client

| type 
| tinyint 
| Task Type; 0=Task, 1=Shared, 2=Quest, 3=Expedition 

| acceptedtime 
| int 
| Accepted Time UNIX Timestamp 

### Character_Activities Table¶

#### Field Descriptions¶

| 

Column 
| Data Type 
| Description 

| charid 
| int 
| Character Identifier; ID from character_data 

| taskid 
| int 
| Task Identifier; ID from tasks table 

| activityid 
| int 
| Activity Identifier, ID from tasks table 

| donecount 
| int 
| Done Count (IE 'items looted', 'npcs killed', etc.) 

| completed 
| tinyint 
| Completed: 0 = False, 1 = True 

### Completed Tasks¶

Warning

If the rule **TaskSystem:RecordCompletedTasks** is set to **false**, then this table is not used.

#### Field Descriptions¶

| 

Column 
| Data Type 
| Description 

| charid 
| int 
| Character Identifier; ID from character_data table 

| completedtime 
| int 
| Completed Time UNIX Timestamp 

| taskid 
| int 
| Task Identifier; ID from tasks table 

| activityid 
| int 
| Activity Identifier; ID from tasks table 

Info

This table may have duplicate entries for repeatable tasks. To display Optional Tasks, be sure to set the rule **TaskSystem:RecordCompletedOptionalTasks** to **true**.

### Goallists Table¶

#### Field Descriptions¶

| 

Column 
| Data Type 
| Description 

| listid 
| int 
| Goal List Identifier; repeat ID for multiple entries 

| entry 
| int 
| Entry Identifier; either npc_type id or item id 

Info

Example: list id 10 for a "kill" mission could have three rows, all with list id 10, and entries of 2001, 2102, and 2103 (for Fippy Darkpaw, Kraxz Darkpaw, and Grarrax Darkpaw).

### Proximities Table¶

Warning

The rule **TaskSystem:EnableTaskProximity** must be set to **true **to allow the use of proximities independent of proximities defined by quest scripts for npcs (IE for "explore" tasks).

#### Field Descriptions¶

| 

Column 
| Data Type 
| Description 

| zoneid 
| int 
| Zone Identifier; use the zoneidnumber field 

| exploreid 
| int 
| Explore Identifier; match the goalid in the activity table for type 5 (explore) activities 

| minx 
| float 
| Minimum X Coordinate 

| maxx 
| float 
| Maximum X Coordinate 

| miny 
| float 
| Minimum Y Coordinate 

| maxy 
| float 
| Maximum Y Coordinate 

| minz 
| float 
| Minimum Z Coordinate 

| maxz 
| float 
| Maximum Z Coordinate 

Danger

Overlapping proximities will only trigger proximity detection for the proximity with the lowest-numbered **exploreid**.

### Tasksets Table¶

Info

Task Sets are intended to make it easier to write quest NPCs that can offer a lot of tasks. While this functionality can also be achieved with quest::assigntask, it is important to note that players can remove tasks when writing your scripts. A Task Set could require a series of tasks in a progression.

#### Field Descriptions¶

| 

Column 
| Data Type 
| Description 

| id 
| int 
| Unique Task Set Entry Identifier 

| taskid 
| int 
| Task Identifier; ID from the tasks table 

### Character_enabledtasks Table¶

#### Field Descriptions¶

| 

Column 
| Data Type 
| Description 

| charid 
| int 
| Character Identifier; ID from character_data 

| taskid 
| int 
| Task Identifier; ID from tasks table 

## GM Commands¶

| 

Command 
| Description 

| #task show 
| Shows the active tasks for the targeted client 

| #task update [count] 
| Updates the specified activity by 1, or by [count] 

| #task reloadall 
| Reload all information relating to tasks from DB (all zones) 

| #task reload task 
| Reload all information for the specified task from the DB (all zones) 

| #task reload lists 
| Reload all information from the goallists table (all zones) 

| #task reload prox 
| Reload all information from the proximities table (all zones) 

| #task reload sets 
| Reload task sets (all zones) 

## Task System Rules¶

| 

Rule Name 
| Default Value 
| Description 

| TaskSystem:KeepOneRecordPerCompletedTask 
| True 
| Keeps one record for each completed task (the client displays the most recent 50; use quest::istaskcompleted for lookups). 

| TaskSystem:EnableTaskProximity 
| True 
| Makes use of the 'proximities' table, independent of quest::set_proximitiy 

| TaskSystem:RecordCompletedOptionalActivities 
| True 
| Makes use of the 'character_activities' table for optional tasks 

| TaskSystem:PeriodicCheckTimer 
| 5 
| Seconds between checks for failed tasks. Also used by the 'Touch' activity 

| TaskSystem:RecordCompletedTasks 
| True 
| Makes use of the 'character_activities' table for non-optional tasks 

| TaskSystem:EnableTaskSystem 
| True 
| Globally enable or disable the Task system 

| QueryServ:PlayerLogTaskUpdates 
| False 
| Logs Player Task Updates 

## Logging Options¶

Info

These options are present in the Logging System through logsys_categories or in-game via command #logs set [output] [type] [level]

```
`1 LOG_CATEGORY( TASKS )
2 LOG_TYPE( TASKS, GLOBALLOAD, DISABLED )
3 LOG_TYPE( TASKS, CLIENTLOAD, DISABLED )
4 LOG_TYPE( TASKS, UPDATE, DISABLED )
5 LOG_TYPE( TASKS, CLIENTSAVE, DISABLED )
6 LOG_TYPE( TASKS, PACKETS, DISABLED )
7 LOG_TYPE( TASKS, PROXIMITY, DISABLED )
`
```

TASKS UPDATE is used to print out debug information when checking if activities are completed.

## Quest API (for the task system)¶

These are the **quest::[methods]** and **EVENT** triggers that are related to the Task System.

Info

Be sure to reference the Quest API in the event that functionality is expanded.

### taskselector¶

```
` **Parameter(s):**

 task_id _(int)_

 **Usage:**

 Used to bring up the Task Selector Window with the specified tasks available for selection (from 1 to 40 task_id(s)). Note that when the task selector is brought up via this method, no check is made as to whether the character has the tasks enabled.

 **Example:**
`
```

```
`sub EVENT_SAY {
 if ($text=~/hail/i) {
 quest::say("Heyo! Looking for an exciting [task] to fill the time?");
 }
 if ($text=~/task/i) {
 #:: Select task 103
 quest::taskselector(103);
 }
}
`
```

### task_setselector¶

```
` **Parameter(s):**

 task_set_id _(int)_

 **Usage:**

 Sets the Task Set, by provided Task Set ID.

 **Example:**
`
```

```
`#:: Set task set 202
quest::task_setselector(202);
`
```

### istaskactive¶

```
` **Parameter(s):**

 task_id _(int)_

 **Usage:**

 Used to determine if a task is active, by Task ID.

 **Example:**
`
```

```
`#:: Check if task 212 is active
quest::istaskactive(212); #:: Returns bool
`
```

### istaskactivityactive¶

```
` **Parameter(s):**

 task_id _(int)_, activity_id _(int)_

 **Usage:**

 Used to determine if a task activity is active, by Task ID and Activity ID.

 **Example:**
`
```

```
`#:: Check if Activity 9 of Task 212 is active 
quest::istaskactivityactive(212, 9); #:: Returns bool
`
```

### updatetaskactivity¶

```
` **Parameter(s):**

 task_id _(int)_, activity_id _(int)_, count _(int)_, ignore_quest_update _(bool)_

 **Usage:**

 Used to increment the done count of the specified task is active. The parameter for ignore_quest_update is optional, and defaults to false; the parameter for count default to 1 (increase count by 1).

 **Example:**
`
```

```
`#:: Update Task ID 219 activity 9, by 1 count
quest::updatetaskactivity(216,9);
`
```

### resettaskactivity¶

```
` **Parameter(s):**

 task_id _(int)_, activity_id _(int)_

 **Usage:**

 Sets the done count to 0 for the specified Task ID

 **Example:**
`
```

```
`#:: Reset the activity done count for task 202
quest::resettaskactivity(202);
`
```

### taskexplorearea¶

```
` **Parameter(s):**

 explore_id _(int)_

 **Usage:**

 Used to mark any explore activities (type 5), which have the numeric value Explore ID in their Goal ID field, and for which the Zone ID of the activity is either 0 or this zone, as completed.

 **Example:**
`
```

```
`#:: Mark Task 21 complete
quest::taskexplorearea(21);
`
```

### assigntask¶

```
` **Parameter(s):**

 task_id _(int)_, npcid _(int)_, enforce_level_requirement = false _(bool)_

 **Usage:**

 Used to assign a task to a client, optionally this can include the NPC ID and whether or not to enforce the level requirement specified in the DB.

 **Example:**
`
```

```
`#:: Assign Task 102
quest::assigntask(102);
#:: Assign Task 103 with level requirement enforced
quest::assigntask(103, 1);
#:: Assign Task 104 and include the NPC ID
$client->AssignTask(104, $npc->GetID());
#:: Assign Task 105, include the NPC ID with level requirement enforced
$client->AssignTask(105, $npc->GetID(), 1);
`
```

### failtask¶

```
` **Parameter(s):**

 task_id _(int)_

 **Usage:**

 Fails the task, by Task ID, for the client character that triggered the event.

 **Example:**
`
```

```
`#:: Fail Task 216
quest::failtask(216);
`
```

### tasktimeleft¶

```
` **Parameter(s):**

 task_id _(int)_

 **Usage:**

 Returns the amount of time left, in seconds, before the specified task runs out. -1 is returned if there is no time limit, or if the player does not have the task.

 **Example:**
`
```

```
`#:: Create a scalar variable to store the amount of time left for Task ID 22
$timeremaining = quest::tasktimeleft(22); #:: Returns int
if ($timeremaining => 1) {
 quest::say("You have $timeremaining seconds left--better hurry!");
}
else {
 quest::say("Sorry $name, but you're out of time!");
}
`
```

### istaskcompleted¶

```
` **Parameter(s):**

 task_id (int)

 **Usage:**

 Used to determine if a task is completed, by Task ID.

 **Example:**
`
```

```
`#:: Check if task 212 is completed
quest::istaskcompleted(212); #:: Returns bool
`
```

### enabletask¶

```
` **Parameter(s):**

 task_id _(int)_

 **Usage:**

 Enables a task.

 **Example:**
`
```

```
`#:: Match if the player has an active task
if ($task != 0) {
 #:: Create a scalar variable to store the active speak-to activity
 $activity = quest::activespeakactivity($task);
 #:: Mark the activity as complete
 quest::updatetaskactivity($task, $activity);
 quest::say("Well done!");
 #:: Offer the next task, if there is one
 if (!quest::istaskactive($task)) {
 #:: Disable the task so that it cannot be repeated
 quest::disabletask($task);
 #:: Match if there are tasks remaining in the Task Set
 if ($task != quest::lasttaskinset(200)) {
 quest::say("Well done, I have another task if you are willing.");
 #:: Enable the next Task in the Task Set
 quest::enabletask(quest::nexttaskinset(200, $task));
 }
 #:: Match if there are no tasks remaining in the task set
 else {
 quest::say("Thank you for cleansing Qeynos Hills!");
 }
 }
}
`
```

### disabletask¶

```
` **Parameter(s):**

 task_id _(int)_

 **Usage:**

 Disables a task so that it is not available to a client character. Useful if you do not want someone to repeat a task.

 **Example:**
`
```

```
`#:: Match if the player has an active task
if ($task != 0) {
 #:: Create a scalar variable to store the active speak-to activity
 $activity = quest::activespeakactivity($task);
 #:: Mark the activity as complete
 quest::updatetaskactivity($task, $activity);
 quest::say("Well done!");
 #:: Offer the next task, if there is one
 if (!quest::istaskactive($task)) {
 #:: Disable the task so that it cannot be repeated
 quest::disabletask($task);
 #:: Match if there are tasks remaining in the Task Set
 if ($task != quest::lasttaskinset(200)) {
 quest::say("Well done, I have another task if you are willing.");
 #:: Enable the next Task in the Task Set
 quest::enabletask(quest::nexttaskinset(200, $task));
 }
 #:: Match if there are no tasks remaining in the task set
 else {
 quest::say("Thank you for cleansing Qeynos Hills!");
 }
 }
}
`
```

### istaskenabled¶

```
` **Parameter(s):**

 task_id (int)

 **Usage:**

 Used to determine if a task is enabled, by Task ID.

 **Example:**
`
```

```
`#:: Check if task 212 is enabled
quest::istaskenabled(212); #:: Returns bool
`
```

### enabledtaskcount¶

```
` **Parameter(s):**

 task_set _(int)_

 **Usage:**

 Counts the enabled tasks in the specified Task Set.

 **Example:**
`
```

```
`#:: Match if there are no enabled tasks in Task Set 10
if (quest::enabledtaskcount(10) == 0) {
 quest::enabletask(50, 51, 52);
}
`
```

### firsttaskinset¶

```
` **Parameter(s):**

 task_set _(int)_

 **Usage:**

 Returns the first task in the specified Task Set.

 **Example:**
`
```

```
`sub EVENT_SAY {
 #:: If the player hasn't completed the last task in the Task Set
 if (!quest::istaskcompleted(quest::lasttaskinset(200))) {
 #:: If the player has no tasks enabled for this task set, enable the first one
 if (quest::enabledtaskcount(200) == 0) {
 quest::say("You have not done any of my tasks before!");
 #:: Enable the first task in Task Set 200
 quest::enabletask(quest::firsttaskinset(200));
 }
 }
}
`
```

### lasttaskinset¶

```
` **Parameter(s):**

 task_set _(int)_

 **Usage:**

 Returns the last task in the specified Task Set.

 **Example:**
`
```

```
`#:: Find the Task ID of the last task in Task Set 200
quest::lasttaskinset(200); #:: Returns int
`
```

### nexttaskinset¶

```
` **Parameter(s):**

 task_set _(int)_, task_id _(int)_

 **Usage:**

 Returns the next task in the specified Task Set that comes after the specified Task ID.

 **Example:**
`
```

```
`sub EVENT_SAY {
 #:: Create a scalar variable to store a task integer
 $task = quest::activespeaktask();
 #:: Match if there is an active task to speak to the NPC
 if ($task != 0) {
 #:: Match if there are no active tasks for the current speaking task
 if (!quest::istaskactive($task)) {
 #:: Disable the current speaking task
 quest::disabletask($task);
 #:: Match if the current speaking task is NOT the last task in the Task Set
 if ($task != quest::lasttaskinset(200)) {
 quest::say("Well done, I have another task if you are willing.");
 #:: Enable the next task in Task Set 200
 quest::enabletask(quest::nexttaskinset(200, $task));
 }
 else {
 quest::say("Thank you for cleansing Qeynos Hills!");
 }
 }
 }
}
`
```

### activespeaktask¶

```
` **Parameter(s):**

 None.

 **Usage:**

 Returns the Task ID of the lowest numbered task slot if the player who triggered the event has an active task with an active activity to speak to the NPC (returns 0 if not).

 **Example:**

 If you have task id 150: activity 0--kill three rats, activity 1--talk with NPC, activity 2--kill four fire beetles, activity 3--talk with NPC.
`
```

```
`sub EVENT_SAY {
 #:: Match text for hail, case insensitive
 if ($text=~/hail/i) {
 #:: Create a scalar variable to store the current task that has a speak activity
 $speaktask = quest::activespeaktask(); #:: Returns int
 #:: Match if there's an active task with a speak activity
 if ($speaktask => 1) {
 quest::say("You have a task to speak with me and its ID is $speaktask.");
 }
 #:: Match if there's NO active task with a speak activity
 else {
 quest::say("You do not have any tasks with a speaking activity at this time.");
 }
 }
}
`
```

### activespeakactivity¶

```
` **Parameter(s):**

 task_id _(int)_

 **Usage:**

 Returns the Activity ID of the lowest numbered active activity to speak with an NPC in the specified task.

 **Example:**

 If you have task id 150: activity 0--kill three rats, activity 1--talk with NPC, activity 2--kill four fire beetles, activity 3--talk with NPC.
`
```

```
`sub EVENT_SAY {
 #:: Match text for hail, case insensitive
 if ($text=~/hail/i) {
 #:: Create a scalar variable to store the current speak activity for task 150
 $speakactivity = quest::activespeakactivity(150); #:: Returns int
 #:: Match if the player is on the first speak activity
 if ($speakactivity == 1) {
 quest::say("I really hate rats.");
 }
 #:: Match if the player is on the second speak activity
 elsif ($speakactivity == 3) {
 quest::say("I really hate fire beetles.");
 }
 }
}
`
```

### activetasksinset¶

```
` **Parameter(s):**

 task_set _(int)_

 **Usage:**

 Returns the number of tasks in the given TaskSet that the player has active.

 **Example:**

 You have a TaskSet "20", which consists of three tasks--200, 201, 202.
`
```

```
`sub EVENT_SAY {
 #:: Create a scalar variable to store the number of active tasks in TaskSet 20
 $activetaskcount = quest::activetasksinset(20); #:: returns int
 #:: Match text for hail, case insensitive
 if ($text=~/hail/i) {
 quest::say("You have $activetaskcount tasks remaining.");
 }
}
`
```

### completedtasksinset¶

```
` **Parameter(s):**

 task_set _(int)_

 **Usage:**

 Returns the number of tasks in the given Task Set that the player has completed.

 **Example:**
`
```

```
`sub EVENT_SAY {
 #:: Match text for "tasks", case insensitive
 if ($text=~/tasks/i) {
 #:: Create a scalar variable to store the count of completed tasks in task set "200"
 my $TasksComplete = quest::completedtasksinset(200); #:: Returns int
 quest::say("You have completed $TasksComplete tasks.");
 }
}
`
```

### EVENT_TASKACCEPTED¶

#### Trigger¶

- when a player accepts a task from the task selector window.

Info

If the assigntask(taskid) function is used to forcibly assign a task to a player, then this sub will also be called with task_id set to taskid if assigntask is successful.

### EVENT_TASK_COMPLETE¶

#### Trigger¶

- when a player completes a task.

#### Exports¶

| 

Name 
| Type 
| Usage 

| donecount 
| int 
| `quest::say($donecount); # returns int` 

| activity_id 
| int 
| `quest::say($activity_id); # returns int` 

| task_id 
| int 
| `quest::say($task_id); # returns int` 

### EVENT_TASK_FAIL¶

#### Trigger¶

- When a player fails a task.

#### Exports¶

| 

Name 
| Type 
| Usage 

| task_id 
| int 
| `quest::say($task_id); # returns int` 

### EVENT_TASK_STAGE_COMPLETE¶

#### Trigger¶

- When a task stage is completed.

#### Exports¶

| 

Name 
| Type 
| Usage 

| activity_id 
| int 
| `quest::say($activity_id); # returns int` 

| task_id 
| int 
| `quest::say($task_id); # returns int` 

#### Example¶

- In this example, when a player completes a task, it triggers the event and tries to match with task ID 212; if it matches, a yellow message is displayed to the client.

PerlLua

```
`sub EVENT_TASK_STAGE_COMPLETE {
 #:: Match task id 212
 if ($task_id == 212) {
 $client->Message(15,"The zombie presence seems somewhat lessened, and perhaps they have been quelled...for the time being.");
 }
}
`
```

```
`function event_task_stage_complete(e)
 --:: Match task id 212
 if (e.task_id == 212) then
 e.self:Message(15, "The zombie presence seems somewhat lessened, and perhaps they have been quelled...for the time being.");
 end
end
`
```

### EVENT_TASK_UPDATE¶

#### Trigger¶

- when a player's task is updated.

#### Exports¶

| 

Name 
| Type 
| Usage 

| donecount 
| int 
| `quest::say($donecount); # returns int` 

| activity_id 
| int 
| `quest::say($activity_id); # returns int` 

| task_id 
| int 
| `quest::say($task_id); # returns int`

---

## Example

*Source: server/task-system-guide/shared-tasks/example/index.html*

# Example¶

This example demonstrates a full shared task selector offer with dynamic zone creation on accept. Note that dz creation can occur at any time and does not have to occur on the accept event but will likely be the most common point.

```
`local shared_task_id = 4795 -- some database task id with type set to shared task
local non_shared_task_id = 10 -- some database task id with type set to quest

function event_say(e)
 if e.message:findi("hail") then
 -- The non-shared task here will be ignored, mixing shared tasks
 -- with other types is not allowed due to shared task validation
 eq.task_selector({ non_shared_task_id, shared_task_id })
 end
end

function event_task_accepted(e)
 if e.task_id == shared_task_id then
 -- create dz for the shared task on the client that accepted it
 -- dz duration will be overridden by time remaining on the shared task
 local dz = {
 instance = { zone="thundercrest", version = 11 },
 compass = { zone="broodlands", x=1241.88, y=511.147, z=23.4192 },
 safereturn = { zone="broodlands", x=1242.0, y=526.0, z=27.0, h=0.0 }
 }
 e.other:CreateTaskDynamicZone(e.task_id, dz)
 end
end
`
```

---

## Shared Tasks

*Source: server/task-system-guide/shared-tasks/index.html*

# Shared Tasks¶

Shared tasks use the existing task system quest API with the added availability of dynamic zone instance creation. The only major difference where care needs to be taken in scripts is with player task update events which will trigger for all members of a shared task. Any script that depends on a single task update or stage completed event to perform an action will need to guard against multiple updates from members.

Note that mixing shared task types with other types is not supported via the taskselector APIs since shared tasks need to run through separate validation for player count and member level requirements. If any shared task type is included in a task selector offer, all other task types will be dropped.

The EVENT_TASK ACCEPTED event will only occur if shared task creation was successful after passing all validation requirements defined in the `tasks` database entry.

## Dynamic Zones¶

Dynamic zones are the same underlying instancing system that expedition's use. These may be created for shared tasks through the client API method:

```
`Client::CreateTaskDynamicZone(int taskid, LUA_TTABLE dynamic_zone_info)
`
```

Warning

This method is currently only available to the Lua API

This method creates a dynamic zone for a client assigned to the specified task id. If the client does not have a task for the task id or the specified task id is not a shared task, then the dynamic zone is not created. If dynamic zone creation is successful then all members of the client's shared task are added to it. Multiple dynamic zones may be created for a shared task to support custom servers.

Dynamic zone creation data is passed through the `dynamic_zone_info` parameter similar to the Client::CreateExpedition API. Passing a duration for the instance data will have no effect. The shared task system will automatically override the duration to the shared task's remaining time.

Warning

A shared task set to `0` duration in the database for unlimited time is not supported and the dynamic zone will be set to a max duration of 24 hours (suspected max of live shared tasks)

| 

key name 
| supported keys 
| description 

| `instance` 
| zone, version 
| dz instance details 

| `compass` 
| zone, x, y, z 
| `(optional)` compass coordinates 

| `safereturn` 
| zone, x, y, z, h 
| `(optional)` safe return coordinates 

| `zonein` 
| x, y, z, h 
| `(optional)` dz zone-in coordinates 

#### instance keys ¶

| 

key 
| type 
| description 

| `zone` 
| int or string 
| zone id or zone short_name of the expedition's dz instance 

| `version` 
| int 
| dz instance version 

| `duration` 
| int 
| (optional) no effect 

#### compass, safereturn, and zonein keys ¶

| 

key 
| type 
| description 

| `zone` 
| int or string 
| zone id or zone short name 

| `x` 
| float 
| `(optional)` x coordinate (default: `0`) 

| `y` 
| float 
| `(optional)` y coordinate (default: `0`) 

| `z` 
| float 
| `(optional)` z coordinate (default: `0`) 

| `h` 
| float 
| `(optional)` heading (default: `0`) 

```
`local shared_task_id = 4795 -- some database task id with type set to shared task

function event_task_accepted(e)
 -- create dz for the accepted task on the client that accepted it
 if e.task_id == shared_task_id then
 -- dz duration will be overridden by time remaining on the shared task
 local dz = {
 instance = { zone="thundercrest", version = 11 },
 compass = { zone="broodlands", x=1241.88, y=511.147, z=23.4192 },
 safereturn = { zone="broodlands", x=1242.0, y=526.0, z=27.0, h=0.0 }
 }
 e.other:CreateTaskDynamicZone(e.task_id, dz)
 end
end
`
```

---

## Task Activity Types

*Source: server/task-system-guide/task-activity-types/index.html*

# Task Activity Types¶

| 

Task Activity Type ID 
| Task Activity Type Name 

| 1 
| Deliver 

| 2 
| Kill 

| 3 
| Loot 

| 4 
| Speak With 

| 5 
| Explore 

| 6 
| Tradeskill 

| 7 
| Fish 

| 8 
| Forage 

| 9 
| Use 

| 10 
| Use 

| 11 
| Touch 

| 100 
| Give Cash

---

## Task Duration Codes

*Source: server/task-system-guide/task-duration-codes/index.html*

# Task Duration Codes¶

| 

Task Duration Code ID 
| Task Duration Code Name 

| 0 
| None 

| 1 
| Short 

| 2 
| Medium 

| 3 
| Long

---

## Task Types

*Source: server/task-system-guide/task-types/index.html*

# Task Types¶

| 

Task Type ID 
| Task Type Name 

| 0 
| Task 

| 1 
| Shared 

| 2 
| Quest 

| 3 
| Expedition

---

## Tools

*Source: server/tools/index.html*

# Tools¶

### EQEmu Server Database Editors¶

#### PEQ Database Editor¶

Link: https://github.com/ProjectEQ/peqphpeditor

Description: An intuitive editor that allows you to make changes to your world server.

Installation: Install PEQ Database Editor

#### EQEmu Operations Center (EOC)¶

Link: http://eoc.akkadius.com/

Description: A powerful editor that includes mass editing, file utilities, and more.

Connection Page: Input your server information

### EQEmu Server Scripting¶

#### Wiki Quest API¶

Link: http://docs.eqemu.io/quest-api/introduction/

Description: details the set of functions and procedures allowing the access of the features or data of the EQEmu Server.

#### Spire Quest API Explorer¶

Link: http://spire.akkadius.com/quest-api-explorer

Description: a performant quest api explorer that is always current with EQEmu Server and provides examples of method types, event triggers, and exported constants with instant searching and filters.

### Server Web Site Builders¶

#### AllaClone¶

Link: https://github.com/Akkadius/EQEmuAllakhazamClone

Description: Allows you to create an Allakhazam-like site for your server.

#### Character Browser¶

Link: https://github.com/maudigan/charbrowser

Description: Allows you to create a Magelo-like site for your server.

### Client Editing¶

#### EQEmu Particle Editor¶

Link: https://github.com/Zaela/EQEmuParticleEditor

Description: Particle Editor for EQEmu

#### EQG Weapon Model Importer¶

Link: https://github.com/Zaela/EQGWeaponModelImporter

Description: EQG Weapon Model Importer for EQEmu

#### EQG Zone Importer¶

Link: https://github.com/Zaela/EQGZoneImporter

Description: EQEmu Zone Importer

#### S3D Model Extractor¶

Link: https://github.com/Zaela/S3DModelExtracter

Description: S3D Model Extracter for EQEmu

#### S3D Model Scaler¶

Link: https://github.com/Zaela/S3DModelScaler

Description: S3D Model Scaler for EQEmu

#### EQG Model Importer¶

Link: https://github.com/Zaela/EQGModelImporter

Description: EQG Model Importer for EQEmu

#### EQ Race Inventory¶

Link: http://www.shendare.com/EQ/Emu/EQRI/

Description: An inventory of all EQ client races and the zone files that load the corresponding model

#### EQ Icon Extractor¶

Link: https://github.com/Shendare/EQIconExtractor

Description: Extracts individual spell and item icons from .dds and .tga sprite sheets in .png format

#### EQ Eff2Emt Zone Sounds Converter¶

Link (command line): https://github.com/Shendare/Eff2Emt

Link (GUI): https://github.com/Shendare/Eff2EmtGUI

Description: Converts .eff sound effect files to .emt format

#### EQZip¶

Link: https://github.com/Shendare/EQZip

Description: Handles various EQ client file formats: .S3D, .EQG, .PFS, and .PAK

### Miscellaneous¶

#### EQEmu Zone Utilities¶

Link: https://github.com/EQEmu/zone-utilities

Description: Various utilities and libraries for parsing, rendering and manipulating EQ Zone files.

#### GeorgeS Tools¶

Link: http://www.georgestools.chrsschb.com

Description: A series of pre-compiled closed-source tools for editing various server and client data.

---

## Install PEQ Database Editor

*Source: server/tools/install-peq-database-editor/index.html*

# Install PEQ Database Editor¶

Info

If you do not need to run your own editor, you can simply use the publicly available version of the PEQ Database Editor found at eoc.akkadius.com. Input the settings for your server on the Login page and be sure to follow the on-screen instructions.

## Documented Setups by OS:¶

- CentOS

- MacOS

- Ubuntu

- Windows

## Unix-like System Installation Instructions¶

These instructions are intended to be used on a freshly installed server. Some services may have been enabled on your server when the provider installed the image. You should still be able to reference these steps to configure your server.

### CentOS¶

Enable the appropriate MySQL Repo.

```
`yum localinstall https://dev.mysql.com/get/mysql57-community-release-el7-11.noarch.rpm
`
```

Install MySQL.

```
`yum install mysql-community-server
`
```

Open the MySQL configuration file for edits.

```
`nano /etc/my.cnf
`
```

Configure MySQL to list on all IPv4 addresses by adding the following lines to your configuration file. Save your edits.

```
`# Bind Address
bind-address=0.0.0.0
`
```

Enable the MySQL server executable to run on startup.

```
`systemctl enable mysqld
`
```

Start the MySQL server.

```
`systemctl start mysqld
`
```

Verify that all went well by checking your MySQL version.

```
`mysql --version
`
```

Enable the web server executable to run on startup.

```
`systemctl enable httpd.service
`
```

Start the web server.

```
`systemctl start httpd.service
`
```

Install the Yum Utilities package.

```
`yum install yum-utils –y
`
```

Install Extra Packages for Enterprise Linux.

```
`yum install epel-release –y
`
```

Set your configuration parameters to use PHP7+.

```
`yum-config-manager --enable remi-php71
`
```

Install PHP packages.

```
`yum install php php-common php-opcache php-mcrypt php-cli php-gd php-curl php-mysql
`
```

Locate your loaded PHP configuration file.

```
`php -i | grep "Loaded Configuration File"
`
```

Open your PHP configuration file for editing (using the path indicated in the previous step).

```
`nano [path]php.ini
`
```

Use the find command (ctrl+w) to locate the configuration parameter for short open tags.

```
`# Set short_open_tag to ON
short_open_tag = On
`
```

Also look for **error_reporting** to turn turn off some warnings.

```
`error_reporting = E_ALL & ~E_NOTICE & ~E_STRICT & ~E_DEPRECATED
`
```

Navigate to the directory where you want to install the PEQ Database Editor and clone the GitHub Repository (i.e. /var/www/html).

```
`git clone https://github.com/ProjectEQ/peqphpeditor.git
`
```

Navigate to the main PEQ directory and create a copy of the PEQ Database Editor configuration file.

```
`mv config.php.dist config.php
`
```

Edit the configuration file and input your settings.

```
`nano config.php
`
```

Navigate to the sql directory. The files that you find in this directory contain queries that you will need to run on your database prior to using the PEQ Database Editor. You can open these files and then copy / paste the queries into your database editing client.

```
`nano schema.sql
`
```

Repeat this process for any remaining files in the sql directory.

Point your web browser to `http://localhost/<editor-directory>/index.php` and login. The default username / password are "admin", and "password".

### MacOS¶

Install Xcode.

- Click the Apple Icon in the upper-left corner of your screen⋅⋅

- Choose App Store...

- Search for Xcode

- Install Xcode

Install Command line tools for Xcode.

```
`xcode-select --install
`
```

Install Homebrew.

```
`/usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
`
```

Install MySQL (v5.7)

```
`brew install [email protected]
`
```

Install PHP (v7.1)

```
`brew install [email protected]
`
```

Verify that the appropriate version is running.

```
`php --version
`
```

Locate your loaded PHP configuration file.

```
`php -i | grep "Loaded Configuration File"
`
```

Open your PHP configuration file at the path indicated in the prior step.

```
`nano /etc/php.ini
`
```

Use the find command (ctrl+w) to locate the configuration parameter for short open tags.

```
`# Set short_open_tag to ON
short_open_tag = On
`
```

Also look for **error_reporting** to turn turn off some warnings.

```
`error_reporting = E_ALL & ~E_NOTICE & ~E_STRICT & ~E_DEPRECATED
`
```

Navigate to the directory where you want to install the PEQ Database Editor and clone the GitHub Repository (i.e. /Library/WebServer/Documents/).

```
`git clone https://github.com/ProjectEQ/peqphpeditor.git
`
```

Navigate to the main PEQ directory and create a copy of the PEQ Database Editor configuration file.

```
`mv config.php.dist config.php
`
```

Edit the configuration file and input your settings.

```
`nano config.php
`
```

Navigate to the sql directory. The files that you find in this directory contain queries that you will need to run on your database prior to using the PEQ Database Editor. You can open these files and then copy / paste the queries into your database editing client.

```
`cd sql
nano schema.sql
`
```

Repeat this process for any remaining files in the sql directory.

Point your web browser to `http://localhost/<editor-directory>/index.php` and login. The default username / password are "`admin`", and "`password`".

### Ubuntu¶

*Big thanks to Gloat for running through this, and RedVapor for some example sed scripts and greps!*

Info

If you can skip having to sudo each line with (sudo -i or sudo su) it can save a lot of sudo's

Install MySQL

```
`sudo apt install mysql-server
`
```

Configure MySQL. Start by going to the default install directory

```
`sudo nano /etc/mysql/mysql.cnf
`
```

Look for the Bind-Address section and set MySQL to listen on all interfaces

```
`# Bind-Address
bind-address=0.0.0.0
`
```

Enable MySQL to run at startup

```
`sudo systemctl enable mysql
`
```

Start MySQL

```
`sudo systemctl start mysql
`
```

Check that everything installed correctly

```
`mysql --version
`
```

Install Apache

```
`sudo apt install apache2 -y
`
```

Enable Apache to run at startup

```
`sudo systemctl enable apache2.service
`
```

Start Apache

```
`sudo systemctl start apache2.service
`
```

Info

You can point your browser to the ip address to make sure webserver is working at this point.

Install PHP

```
`sudo apt install php php-common php-opcache php-cli php-gd php-curl php-mysql
`
```

Look for your loaded PHP configuration file

```
`php -i | grep "Loaded Configuration File"
`
```

Info

There are a number of other different methods to find your php.ini file(s), such as using grep to search for the setting of interest:

```
`grep -r short_open_tag /etc/php/
`
```

Edit your PHP configuration file (example file location used shown below)

```
`sudo nano /etc/php/7.2/apache2/php.ini
`
```

Info

If you'd rather not use an editor to make the adjustments, a simple sed script can make them for you (an example for php v7.3 is below):

```
`sudo sed -i 's/short_open_tag\ =\ Off/short_open_tag\ =\ on/g' /etc/php/7.3/apache2/php.ini
sudo sed -i 's/short_open_tag\ =\ Off/short_open_tag\ =\ on/g' /etc/php/7.3/cli/php.ini
`
```

Search (ctrl + W) for "short_open_tag"

```
`short_open_tag = On
`
```

Also look for **error_reporting** to turn turn off some warnings.

```
`error_reporting = E_ALL & ~E_NOTICE & ~E_STRICT & ~E_DEPRECATED
`
```

Install Git

```
`sudo apt install git -y
`
```

Go to your root web directory

```
`cd /var/www
`
```

Clone in a copy of the PEQ Database Editor repo

```
`git clone https://github.com/ProjectEQ/peqphpeditor.git
`
```

Copy the PEQ Database Editor to your html directory

```
`sudo cp -ir peqphpeditor/. html/
`
```

Go to your html directory

```
`cd html
`
```

Create a copy of your PEQ Database Editor Config file

```
`sudo mv config.php.dist config.php
`
```

Open your config file for editing and input your settings

```
`nano config.php
`
```

Info

Depending on your environment, you may need to change ownership of the web directory. An example is below (your user:group IDs might be different):

```
`sudo chown -R www-data:www-data /var/www/html/
`
```

Info

After all of these changes, it might be a good idea to restart Apache:

```
`systemctl restart apache2
`
```

Execute the queries found in the sql directory on your database

```
`cd sql
mysql -u<username> -p <database>
source schema.sql;
quit
`
```

Point your web browser to `http://localhost/<editor-directory>/index.php` and login. The default username / password are "admin", and "password".

## Windows¶

*Thanks to Korinthian for walking through these steps and providing screenshots!*

### Download XAMPP¶

XAMPP is a completely free, easy to install Apache distribution containing MariaDB, PHP, and Perl. The XAMPP open source package has been set up to be incredibly easy to install and to use.

You can download XAMPP at: https://www.apachefriends.org/index.html

### Install XAMPP¶

Run the installer for XAMPP. Choose `continue` when you receive the Windows Firewall warning, and `continue` to install XAMPP. 

Choose `OK` to approve the User Account Control (UAC) permission.

Warning

Be sure to **deselect **MySQL!! (assuming you used the Akkadius EQEmu Server Installer, you already have MariaDB)

Choose `next` to continue installation.

Choose `next` to use the default installation directory (C:\xampp).

Choose your language settings and click `next`.

**Uncheck** the `learn more` box for Bitnami (unless you want to learn more about Bitnami, in which case a browser window will open).

Choose `next` to complete the installation.

Check the `Start Control Panel` option and `Finish`.

Click `Start` to start Apache.

Info

If you want to configure Apache auto-start, click on `config` (you will need to exit the control panel and restart as Admin to save the configuration).

### Install PEQ Database Editor¶

Download a copy of the PEQ Database Editor from GitHub: https://github.com/ProjectEQ/peqphpeditor

Extract the contents of the zip file to `C:\xampp\htdocs.

Info

If you would like to change the name of the PEQ Database Editor directory, now is the time. Note that you can move the contents to the root htdocs directory. Changing this name will effect the URL used to access the Editor.

Navigate to the `C:\xampp\htdocs\peqphpeditor-master folder.

Copy the file `config.php.dist` and rename it `config.php`.

#### Configure PEQ Database Editor¶

Open the `config.php` file with a text editor and fill in your information (default values used below).

Info

If you don't know your login information, remember that you can reference it in your `eqemu_config.json` file found in your server folder.

```
`/**
 * Database info
 */
$dbhost = env('DB_HOST', 'localhost');
$dbuser = env('DB_USER', 'root');
$dbpass = env('DB_PASSWORD', 'eqemu');
$db = env('DB_NAME', 'peq');
$dbport = env('DB_PORT', 3306);
`
```

Save your changes to the configuration file.

#### Update Database Schema¶

Navigate to the `sql` folder (ex. `C:\xampp\htdocs\peqphpeditor-master\sql\

Open the file `schema.sql` with a text editor and copy and paste the contents into the HeidiSQL Client's query window and execute (HeidiSQL installed when you used Akkadius' EQEmu Windows Installer Script).

#### Configure PHP¶

Navigate to the PHP folder (i.e. C:\xampp\php)

Open the `php.ini` file with a text editor.

Locate the `short_open_tag` line and set it to `On`.

Also look for **error_reporting** to turn turn off some warnings.

```
`error_reporting = E_ALL & ~E_NOTICE & ~E_STRICT & ~E_DEPRECATED
`
```

Info

Restart (stop/start) your Apache service or process after any changes to .conf or .ini files

### Navigate to your PEQ Database Editor¶

Open a browser and navigate to your new local copy of the PEQ Database Editor (default directory example below):

```
`http://localhost/peqphpeditor-master/index.php
`
```

Enter the default username and password: "admin" and "password".

Info

When shutting down XAMPP and/or the computer, it is recommended to stop MySQL/MariaDB through the console rather than using the control panel. The reason is that the control panel just kills the process rather than letting the database shut down cleanly. Losing power or shutting down the database server using the control panel has been known to corrupt databases. The HTTP (Apache) server can be stopped from the control panel without issues.

Danger

If you aren't running MySQL/MariaDB as a service (i.e. you started the database manually), it is a good idea to shut down the database cleanly. To do this, open a command prompt (from the XAMPP control panel if you haven't added MySQL/MariaDB to your PATH variables) and run the following command (only use the -p if your root user has a password):

```
`mysqladmin shutdown -uroot -p
`
```

---

## Cheat Sheet

*Source: server/tools/tools-cheat-sheet/index.html*

# Tools Cheat Sheet¶

Whether you're a seasoned server admin or a player wanting something extra (or both!), no tinkerer would be caught without their tools.

Here's a collection of tools submitted by EQEmu devs and contributors.

| 

Table of Contents 
| 
| 
| 

| Gameplay Aids/Resources 
| Pre-Assembled Server Packs 
| Client Customization Tools 
| Server/Database Editors 

| Component Editors 
| Server Customization Tools 
| Server Administration Tools 
| 

| 

Gameplay Aids/Resources 
| Last Updated 
| Creator 
| Created 
| Confirmed Working 
| Website / Demo 
| Open Source 
| Download 
| Forum Thread 
| Notes 

| EQEmu Launcher 2.0 
| Jul 2015 
| Akkadius 
| May 2013 
| July 2015 
| -- 
| -- 
| MoesTaverne 
| Link 
| Currently offline. Restoration expected. 

| AllaClone 2.0 
| Aug 2012 
| Muuss 
| Feb 2012 
| Feb 2013 
| StormHaven 
| -- 
| Google Code 
| Link 
| Provides functionality similar to the famous Allakhazam. Need confirmation on whether it's compatible with current servers. 

| Magelo-Like Character Browser 
| Sep 2014 
| Maudigan 
| May 2009 
| -- 
| -- 
| Included 
| MQEmulator.net 
| -- 
| -- 

| 

Pre-Assembled Server Packs 
| Last Updated 
| Creator 
| Created 
| Confirmed Working 
| Website / Demo 
| Open Source 
| Download 
| Forum Thread 
| Notes 

| Akka's PEQ Server Repack 
| Feb 2015 
| Akkadius 
| -- 
| -- 
| -- 
| -- 
| Wiki Page 
| -- 
| The granddaddy of server packs! 

| PEQ DB 
| Aug 2015 
| Cavedude 
| -- 
| -- 
| -- 
| -- 
| Google Drive 
| -- 
| -- 

| PEQ Server Pack 0.7 
| Apr 2008 
| Cavedude 
| Mar 2008 
| -- 
| -- 
| -- 
| peqtgc 
| 
| PoP fully playable, LoY started. Contains 2008 version of EQEmu. 

| 

Client Customization Tools 
| Last Updated 
| Creator 
| Created 
| Confirmed Working 
| Website / Demo 
| Open Source 
| Download 
| Forum Thread 
| Notes 

| EDD Particle Data Editor 
| Jun 2014 
| Zaela_S 
| May 2014 
| -- 
| -- 
| Github 
| Shards of Dalaya 
| Link 
| Edit spell/particle effects 

| EQG Zone Importer 
| Jul 2014 
| Zaela_S 
| Jun 2014 
| Apr 2015 
| -- 
| Github 
| Shards of Dalaya 
| Link 
| Editing and adding to EQG-based zones 

| EQG Weapon Model Importer 
| Jul 2014 
| Zaela_S 
| May 2014 
| -- 
| -- 
| Github 
| Shards of Dalaya 
| Link 
| Includes particle effects 

| EQG Model Importer 
| Aug 2014 
| Zaela_S 
| -- 
| -- 
| -- 
| Github 
| -- 
| 
| -- 

| S3D Model Extracter 
| Aug 2014 
| Zaela_S 
| -- 
| -- 
| -- 
| Github 
| -- 
| 
| -- 

| S3D Model Scaler 
| Aug 2014 
| Zaela_S 
| -- 
| -- 
| -- 
| Github 
| -- 
| 
| -- 

| S3D Placeable Object Editor 
| Jan 2015 
| Zaela_S 
| Jan 2015 
| -- 
| -- 
| -- 
| Dropbox 
| Link 
| Works on simpler S3D-based zones. Some zones are more complicated, and actions will be greyed out. 

| S3D/WLD Editor Suite 
| May 2014 
| Zaela_S 
| Apr 2014 
| -- 
| Wiki Page 
| -- 
| Shards of Dalaya 
| Link 
| Includes a Texture Adder, Transparentifier, Weapon Copier, Info Browser, and Particle Editor 

| S3D/EQG Import/Export Tool 
| May 2014 
| Zaela_S 
| May 2014 
| -- 
| -- 
| In Download 
| Shards of Dalaya 
| Link 
| S3DSpy kept crashing... Made a quick replacement just for importing and exporting files from .s3d/.eqg 

| Kayaido's Model Viewer and Zone Converter 
| Dec 2002 
| Kayaido 
| Jul 2000 
| -- 
| -- 
| -- 
| GeorgeS's Tools 
| -- 
| View 3D models stored in .S3D files 

| Web-based 3D Zone Editor 
| Oct 2014 
| Tabasco 
| Oct 2014 
| -- 
| emudev.us.to 
| Github 
| -- 
| Link 
| Maps download in forum thread. 

| Super simple dragitem to .gifs 
| Jul 2015 
| Shin Noir 
| Jul 2015 
| -- 
| -- 
| In Forum Thread 
| -- 
| Link 
| Nice tiny PHP script. Utilizes the Convert tool from ImageMagick. See forum thread. 

| EQEmu Zone Utilities 
| Aug 2015 
| Many! 
| -- 
| -- 
| -- 
| Github 
| -- 
| -- 
| Various utilities and libraries for parsing, rendering and manipulating EQ Zone files. 

| EQ-Zip S3D/EQG Manager 
| Jul 2015 
| Shendare 
| Jul 2015 
| Jul 2015 
| -- 
| Github 
| Github 
| Link 
| Create and modify S3D/EQG files. Supports automatic image conversion. 

| EQ Spell/Item Icon Extractor 
| Jul 2015 
| Shendare 
| Jul 2015 
| -- 
| -- 
| Github 
| Github 
| Link 
| -- 

| Old .eff to Editable .emt Zone Sound Converter 
| Jul 2015 
| Shendare 
| Jun 2015 
| -- 
| -- 
| Github 
| Github 
| Link 
| -- 

| 

Server/Database Editors 
| Last Updated 
| Creator 
| Created 
| Confirmed Working 
| Website / Demo 
| Open Source 
| Download 
| Forum Thread 
| Notes 

| EQEmu Operations Center 2.0 
| Jul 2015 
| Akkadius 
| Oct 2014 
| Aug 2015 
| akkadius.com 
| Github 
| -- 
| Link 
| If you want to edit or customize something on your server, EOC has got you covered. 

| PEQ Database Editor 
| Mar 2015 
| Cavedude 
| Nov 2008 
| Aug 2015 
| peqtgc 
| Github 
| Google Drive 
| Link 
| Edit Spells, Items, NPCs, Loot Tables, Spawns, Merchants, NPC Spellsets, Factions, Tradeskill Recipes, Zone data, Adventures, Tasks, Server Config, Doors, Ground Spawns, etc. 

| Database Editing Tool Suite 
| Oct 2014 
| GeorgeS 
| -- 
| -- 
| GeorgeS's Tools 
| On Website(*) 
| GeorgeS's Tools 
| -- 
| Edit NPCs, Loot, Grids, Spawns, Tradeskill Recipes, and Adventure Zones. Also gets current loot info from Allakhazam. 

| Server Admin 
| Jun 2012 
| Nosfentora 
| Feb 2012 
| -- 
| -- 
| -- 
| Mediafire 
| Link 
| Need confirmation on whether it's compatible with current servers. 

| 

Component Editors 
| Last Updated 
| Creator 
| Created 
| Confirmed Working 
| Website / Demo 
| Open Source 
| Download 
| Forum Thread 
| Notes 

| Null Spell Editor 
| May 2012 
| Null 
| Jun 2006 
| -- 
| -- 
| -- 
| Dropbox 
| Link 
| Be sure to read the forum thread for instructions. The download links on the first page are out of date. 

| Secrets/Ailia's Spell Editor 
| Apr 2011 
| Ailia / Secrets 
| Apr 2011 
| -- 
| -- 
| -- 
| GeorgeS's Tools 
| Link 
| Need confirmation on whether it's compatible with current servers. 

| EQEmu Item Editor 
| Aug 2015 
| Shendare 
| Aug 2015 
| Aug 2015 
| -- 
| Github 
| Github 
| Link 
| Item icons through SoF also available at the bottom of the releases download page. 

| EQArchitect Spell Editor 
| Jul 2015 
| Shendare 
| Jun 2015 
| Jul 2015 
| shendare.net 
| Github 
| -- 
| Link 
| Mostly functional, but a few fields aren't implemented yet. Demo website can connect to your database if it's accessible to the internet. 

| Web-based Quest Editor 
| Sep 2014 
| Tabasco 
| Sep 2014 
| -- 
| -- 
| Github 
| -- 
| Link 
| -- 

| Item/Inventory Editor 
| Oct 2014 
| GeorgeS 
| -- 
| -- 
| GeorgeS's Tools 
| On Website(*) 
| GeorgeS's Tools 
| -- 
| As the title states, it allows editing of existing items, and also allows replicating (copying) as well. Spell effects can be added to any item. 

| spells_us.txt import/export 
| -- 
| GeorgeS 
| -- 
| -- 
| GeorgeS's Tools 
| On Website(*) 
| GeorgeS's Tools 
| -- 
| The program exports into a SOF or Ti compatible format. You can import a Ti spell file, then export it to a SOF compatible file. 

| Diablo Items Stats Randomizer 
| -- 
| GeorgeS 
| -- 
| -- 
| GeorgeS's Tools 
| On Website(*) 
| GeorgeS's Tools 
| -- 
| This tool allows one to modify item stats on a large scale,with the amount of modification controlled and incorporates a full undo. 

| Diablo Random Loot Tool 
| -- 
| GeorgeS 
| -- 
| -- 
| GeorgeS's Tools 
| On Website(*) 
| GeorgeS's Tools 
| -- 
| This is a 100% rewrite and this tool allows careful editing of loot-drops and mass assigment of loot to selected NPC's. It's intelligently designed so you have total control over all aspects. 

| EverQuest Perl Quest Editor 
| -- 
| GeorgeS 
| -- 
| -- 
| GeorgeS's Tools 
| On Website(*) 
| GeorgeS's Tools 
| -- 
| Ever wanted to create NPC quests easiiy? This tool has many built in quests from people at eqemulator.net. More are being added and these have been tested individually, so they should also work for you. There's also a great learning reference built in as well. 

| 

Server Customization Tools 
| Last Updated 
| Creator 
| Created 
| Confirmed Working 
| Website / Demo 
| Open Source 
| Download 
| Forum Thread 
| Notes 

| EQ Zone/Race Model Inventory 
| May 2015 
| Shendare 
| Jun 2009 
| Aug 2015 
| shendare.com 
| shendare.com 
| shendare.com 
| Link 
| Works with Titanium, SoF, and RoF2 clients only. 

| Spell Encyclopedia and Media 
| Apr 2011 
| GeorgeS 
| -- 
| -- 
| GeorgeS's Tools 
| On Website(*) 
| GeorgeS's Tools 
| -- 
| This tool enables one to view spell particle effect graphics using the included Ailia's Spell Editor. It's a BIG 114MB download. 

| Weapon Encyclopedia and Media 
| Sep 2011 
| GeorgeS 
| -- 
| -- 
| GeorgeS's Tools 
| On Website(*) 
| GeorgeS's Tools 
| -- 
| This tool enables one to view weapon graphics, shields, human face,arm,body textures. It's a Medium size 105MB download. Now with SoF,Underfoot, and House of Thule Eq Expansion Items! 

| Color Picker Tool 
| -- 
| GeorgeS 
| -- 
| -- 
| GeorgeS's Tools 
| On Website(*) 
| GeorgeS's Tools 
| -- 
| This tool allows one to create a color for tinting in Everquest. This tool has no write finctions, and only allows one to copy the results into another program. 

| 

Server Administration Tools 
| Last Updated 
| Creator 
| Created 
| Confirmed Working 
| Website / Demo 
| Open Source 
| Download 
| Forum Thread 
| Notes 

| EQNet - Client Networking API 
| Jun 2015 
| Zaela_S 
| Jun 2015 
| -- 
| -- 
| Github 
| -- 
| Link 
| Chat on EQ servers without the client 

| EQEmu Web Interface 
| Feb 2015 
| KimLS 
| Jul 2014 
| -- 
| -- 
| Github 
| -- 
| -- 
| Part of the EQEmu Server Install, but the code for the Web Interface is available separately. 

| Database SQL Query Tool 
| Nov 2006 
| GeorgeS 
| -- 
| -- 
| GeorgeS's Tools 
| On Website(*) 
| GeorgeS's Tools 
| -- 
| This tool allows one to type in SQL and view immediate output. You can export the results to .csv .txt and even sql. 

| Character Manager Tool 
| -- 
| GeorgeS 
| -- 
| -- 
| GeorgeS's Tools 
| On Website(*) 
| GeorgeS's Tools 
| -- 
| This tool allows one to monitor and maintain characters. You can delete old characters, and sort fields. This is a work in progress that will be expanded as needed. 

(*) GeorgeS offers a .rar archive download of the source code for ALL of his tools together in one tidy 350MB package. You can find it on his website, or click here.

---

## Adjusting Zone Shutdown Delay

*Source: server/zones/adjusting-zone-shutdown-delay/index.html*

# Adjusting Zone Shutdown Delay¶

### Dynamic Zones¶

In a typical server installation; the server launcher boots what are called **dynamic zones**. These are zones that are sitting idle, not assigned to a zone but are fully ready to be assigned an actual zone from the **world server**. Once a client requests a zone request to the world server, it will check its local list of connected zones to see if the zone is already booted before making the decision to make a zone assignment

### Shutdown Delay¶

Typically most zones in a default PEQ database installation have a shutdown delay of 60 minutes, if you look in the **zone **table this value is configured in **milliseconds. **Below this is illustrated in minutes to make it easier to read

Shutdown delays are configured two ways, through the rule **Zone:AutoShutdownDelay** or the value in the zone table. Whichever one is higher is the one that the zone uses to enforce shutting back down

The shutdown delay timer only starts when the last client has left the zone resulting in 0 clients remaining in a zone and the timer resets when any client zones back in. When this timer expires the process is killed and your launcher will re-spawn another process to take its place

```
`select
 short_name,
 ROUND(shutdowndelay / 1000 / 60) as shutdown_minutes
from
 zone
ORDER BY
 shutdowndelay desc
limit
 10;

+------------+------------------+
| short_name | shutdown_minutes |
+------------+------------------+
| kithicor | 1440 |
| airplane | 720 |
| tacvi | 300 |
| arena2 | 60 |
| arena | 60 |
| arcstone | 60 |
| apprentice | 60 |
| anguish | 60 |
| akheva | 60 |
| arttest | 60 |
+------------+------------------+
`
```

---

## Door Open Types

*Source: server/zones/door-open-types/index.html*

# Door Open Types¶

- 115-152: All need invert_state to 1 to work correctly. If invert_state is 0, they don't move but you take damage still if you touch them (Thanks Qadar, for this information):

| 

**Open Type ID** 
| **Description** 
| **Notes** 

| 0 
| normal 90 degree door swing backward 
| 

| 1 
| normal 90 degree door swing backward 
| 

| 2 
| normal 90 degree door swing backward 
| 

| 3 
| normal 90 degree door swing backward 
| 

| 4 
| normal 90 degree door swing backward 
| 

| 5 
| normal 90 degree door swing forward 
| 

| 6 
| normal 90 degree door swing forward 
| 

| 7 
| normal 90 degree door swing forward 
| 

| 8 
| normal 90 degree door swing backward 
| 

| 9 
| no movement, click events will only fire once 
| 

| 10 
| slides forward 
| 

| 11 
| slides forward 
| 

| 12 
| slides forward 
| 

| 13 
| nothing 
| 

| 14 
| nothing 
| 

| 15 
| slides further forward 
| 

| 16 
| slides further forward 
| 

| 17 
| slides further forward 
| 

| 18 
| nothing 
| 

| 19 
| nothing 
| 

| 20 
| slides even further forward 
| 

| 21 
| slides even further forward 
| 

| 22 
| slides even further forward 
| 

| 23 
| nothing 
| 

| 24 
| nothing 
| 

| 25 
| slides furthest forward 
| 

| 26 
| slides furthest forward 
| 

| 27 
| slides furthest forward 
| 

| 28 
| nothing 
| 

| 29 
| nothing 
| 

| 30 
| rotates 90 degrees clockwise and returns 
| 

| 31 
| nothing 
| 

| 32 
| nothing 
| 

| 33 
| nothing 
| 

| 34 
| nothing 
| 

| 35 
| rotates 90 degrees clockwise and returns faster 
| 

| 36 
| rotates 90 degrees and jumps back 
| 

| 37 
| nothing 
| 

| 38 
| nothing 
| 

| 39 
| nothing 
| 

| 40 
| rotates 90 degrees clockwise and returns slower 
| 

| 41 
| nothing 
| 

| 42 
| nothing 
| 

| 43 
| nothing 
| 

| 44 
| nothing 
| 

| 45 
| slide sideways open and closes slowly 
| 

| 46 
| nothing 
| 

| 47 
| nothing 
| 

| 48 
| nothing 
| 

| 49 
| nothing 
| 

| 50 
| no door showing (invisible) 
| 

| 51 
| nothing 
| 

| 52 
| nothing 
| 

| 53 
| no door showing (invisible) 
| 

| 54 
| no door showing (invisible) 
| 

| 55 
| nothing - will not trigger "can't reach that" message 
| 

| 56 
| nothing 
| 

| 57 
| In-zone teleporter. door_param will be linked to `number` and dest_zone will be linked to `zone` from `zone_points` 
| 

| 58 
| nothing 
| 

| 59 
| moves up and down Z axis on click 
| used for lifts such as the ones in gfaydark 
 If using this opentype you can use door_param to change how high it will go 
 If you make another door and set the 'triggerdoor' to the door id of your lift you can remotely activate it 

| 60 
| moves up and down Z axis on click 
| same as 59 with the addition of playing drawbridge sound effect 

| 100 
| spins around the 'heading' value in a full circle 
| can set invert_state=1 to have rotating doors without clicking 
 clicking will stop rotation but you can lock it to prevent stopping 

| 101 
| spins around the 'heading' value in a full circle (faster) 
| 

| 102 
| spins around the 'heading' value in a full circle (fastest) 
| 

| 105 
| spins around the 'incline' value in a full circle 
| can set invert_state=1 to have rotating doors without clicking 
 clicking will stop rotation but you can lock it to prevent stopping 

| 106 
| spins around the 'incline' value in a full circle (faster) 
| 

| 107 
| spins around the 'incline' value in a full circle (fastest) 
| 

| 115 
| spins nonstop, 4 points saw damage 
| 

| 116 
| spins with pause, 4 points saw damage 
| 

| 120 
| moves down then up, 30 points spear damage 
| 

| 125 
| moves left then right, 30 points spear damage 
| 

| 130 
| swings back and forth, 4 points pendulum damage 
| 

| 135 
| no movement, 4 points blade damage if touched 
| 

| 140 
| moves up then down, 4 points crush damage 
| 

| 142 
| moves up then down nonstop automatically (moves up and down 1 time only if invert_state is set to 0) 
| 

| 143 
| moves up then down nonstop automatically (moves up and down 1 time only if invert_state is set to 0) 
| 

| 144 
| moves up then down nonstop automatically (moves up and down 1 time only if invert_state is set to 0) 
| 

| 145 
| down then up, slow movement, 10 points crushed damage 
| 

| 146 
| down then up, fast movement, 50 points crushed damage 
| 

| 150 
| slide fast left, back slowly, 10 points crushed damage 
| 

| 151 
| slide slow left, back slowly, 10 points crushed damage 
| 

| 152 
| slide fast left, back quickly, 50 points crushed damage 
|

---

## Environment Emitters

*Source: server/zones/environment-emitters/index.html*

# Environment Emitters¶

| 

ID 
| Name 
| Model Name 
| File 

| 0 
| None 
| None 
| nul 

| 
| 
| 
| 

| 1 
| star flame 
| star_flame 
| star_spin01.dds 

| 
| 
| 
| 

| 2 
| star glow 
| star_glow 
| star_spin01.dds 

| 
| 
| 
| 

| 3 
| geode rain01 
| geode_rain01 
| wisp_blue01.dds 

| 
| 
| 
| 

| 4 
| geode rain02 
| geode_rain02 
| wisp_blue01.dds 

| 
| 
| 
| 

| 5 
| star flame orange 
| star_flame_orange 
| star_spin01.dds 

| 
| 
| 
| 

| 6 
| star flame spark 
| star_flame_spark 
| star_spin01.dds 

| 
| 
| 
| 

| 7 
| caveinstance torch 
| caveinstance_torch 
| flamed.dds 

| 
| 
| 
| 

| 8 
| MML instance flame jet 
| MML_instance_flame_jet 
| flamed.dds 

| 
| 
| 
| 

| 9 
| blood smoke 
| blood_smoke 
| smoked.dds 

| 
| 
| 
| 

| 10 
| black red smoke 
| black_red_smoke 
| darknesssp502.dds 

| 
| 
| 
| 

| 11 
| MML instance flame blue 
| MML_instance_flame_blue 
| flameblue.dds 

| 
| 
| 
| 

| 12 
| MML instance flame red 
| MML_instance_flame_red 
| flamered.dds 

| 
| 
| 
| 

| 13 
| MML instance flame green 
| MML_instance_flame_green 
| flamegreen.dds 

| 
| 
| 
| 

| 14 
| MML instance flame purple 
| MML_instance_flame_purple 
| flamepurple.dds 

| 
| 
| 
| 

| 15 
| MML instance flame copper 
| MML_instance_flame_copper 
| flamecopper.dds 

| 
| 
| 
| 

| 16 
| blood mist 
| blood_mist 
| genreda.dds 

| 
| 
| 
| 

| 17 
| falling dust 
| falling_dust 
| finedustsp501.dds 

| 
| 
| 
| 

| 18 
| pollen 
| pollen 
| acid1.dds 

| 
| 
| 
| 

| 19 
| steam 
| steam 
| steam.dds 

| 
| 
| 
| 

| 20 
| labyrinth torch 
| labyrinth_torch 
| flamed.dds 

| 
| 
| 
| 

| 21 
| caveinstance torch 
| caveinstance_torch 
| flamed.dds 

| 
| 
| 
| 

| 22 
| portal brazier 
| portal_brazier 
| flamed.dds 

| 
| 
| 
| 

| 23 
| blood mist 
| blood_mist 
| genreda.dds 

| 
| 
| 
| 

| 24 
| blood mist 
| blood_mist 
| genreda.dds 

| 
| 
| 
| 

| 25 
| core lightning 
| core_lightning 
| electricf.dds 

| 
| 
| 
| 

| 26 
| core spark 
| core_spark 
| electricb.dds 

| 
| 
| 
| 

| 27 
| blood smoke 
| blood_smoke 
| smoked.dds 

| 
| 
| 
| 

| 28 
| blood smoke 
| blood_smoke 
| smoked.dds 

| 
| 
| 
| 

| 29 
| star glow 
| star_glow 
| star_spin01.dds 

| 
| 
| 
| 

| 30 
| star glow 
| star_glow 
| star_spin01.dds 

| 
| 
| 
| 

| 31 
| core lightning 
| core_lightning 
| electricf.dds 

| 
| 
| 
| 

| 32 
| blood smoke 
| blood_smoke 
| smoked.dds 

| 
| 
| 
| 

| 33 
| core spark slower 
| core_spark_slower 
| electricb.dds 

| 
| 
| 
| 

| 34 
| harbingers rings 
| harbingers_rings 
| wisp_blue01.dds 

| 
| 
| 
| 

| 35 
| harbingers beam 
| harbingers_beam 
| zapmuzc.dds 

| 
| 
| 
| 

| 36 
| swirling leaves 
| swirling_leaves 
| wisp_pink01.dds 

| 
| 
| 
| 

| 37 
| lavaglobe spark 
| lavaglobe_spark 
| explosionf.dds 

| 
| 
| 
| 

| 38 
| star flame 
| star_flame 
| firec.dds 

| 
| 
| 
| 

| 39 
| steamvent 
| steamvent 
| explosiona.dds 

| 
| 
| 
| 

| 40 
| lavasteam 
| lavasteam 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 41 
| lavasteam large 
| lavasteam_large 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 42 
| star flame orange 
| star_flame_orange 
| star_spin01.dds 

| 
| 
| 
| 

| 43 
| smoke 
| smoke 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 44 
| mist 
| mist 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 45 
| steam bath01 
| steam_bath01 
| smoked.dds 

| 
| 
| 
| 

| 46 
| steam bath02 
| steam_bath02 
| smoked.dds 

| 
| 
| 
| 

| 47 
| steam bath02 
| steam_bath02 
| smoked.dds 

| 
| 
| 
| 

| 48 
| dragonflame 
| dragonflame 
| firec.dds 

| 
| 
| 
| 

| 49 
| steamVentTall 
| steamVentTall 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 50 
| lavasteam 
| lavasteam 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 51 
| mist 
| mist 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 52 
| dsrtlair lightning 
| dsrtlair_lightning 
| electricf.dds 

| 
| 
| 
| 

| 53 
| dsrtlairStatue lightning 
| dsrtlairStatue_lightning 
| electricf.dds 

| 
| 
| 
| 

| 54 
| geode 
| geode 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 55 
| geode rain02 
| geode_rain02 
| wisp_blue01.dds 

| 
| 
| 
| 

| 56 
| geode rain01 
| geode_rain01 
| wisp_blue01.dds 

| 
| 
| 
| 

| 57 
| new torch flame 
| new_torch_flame 
| new_flame.dds 

| 
| 
| 
| 

| 58 
| FirePlace 
| FirePlace 
| new_fire.dds 

| 
| 
| 
| 

| 59 
| SummonCorpse 
| SummonCorpse 
| deathmask.dds 

| 
| 
| 
| 

| 60 
| wkbtorch 
| wkbtorch 
| star_spin01.dds 

| 
| 
| 
| 

| 61 
| wkwaterfallbottom 
| wkwaterfallbottom 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 62 
| wkwaterfalltop 
| wkwaterfalltop 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 63 
| wellbubbler 
| wellbubbler 
| bubblesp501.dds 

| 
| 
| 
| 

| 64 
| wkwaterfallbottom 
| wkwaterfallbottom 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 65 
| smoke 
| smoke 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 66 
| creep sm waterfall 
| creep_sm_waterfall 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 67 
| CreepMist 
| CreepMist 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 68 
| creep hotsprings 
| creep_hotsprings 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 69 
| star flame orange 
| star_flame_orange 
| star_spin01.dds 

| 
| 
| 
| 

| 70 
| ekwaterfalltop 
| ekwaterfalltop 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 71 
| ekwaterfallbottom 
| ekwaterfallbottom 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 72 
| pollendrop 
| pollendrop 
| acid1.dds 

| 
| 
| 
| 

| 73 
| corath smoke 
| corath_smoke 
| smoked.dds 

| 
| 
| 
| 

| 74 
| arena torch 
| arena_torch 
| flamed.dds 

| 
| 
| 
| 

| 75 
| star glow 
| star_glow 
| star_spin01.dds 

| 
| 
| 
| 

| 76 
| tak brazier 
| tak_brazier 
| flamed.dds 

| 
| 
| 
| 

| 77 
| FirePlace 
| FirePlace 
| new_fire.dds 

| 
| 
| 
| 

| 78 
| moths 
| moths 
| moth_env.dds 

| 
| 
| 
| 

| 79 
| sandteleport 
| sandteleport 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 80 
| sullon entrance 
| sullon_entrance 
| wisp_blue01.dds 

| 
| 
| 
| 

| 81 
| BTbats 
| BTbats 
| bats01.dds 

| 
| 
| 
| 

| 82 
| dustmotes 
| dustmotes 
| flare_whsp501.tga 

| 
| 
| 
| 

| 83 
| BTcandle 
| BTcandle 
| new_flame.dds 

| 
| 
| 
| 

| 84 
| sullon magic01 
| sullon_magic01 
| wisp_blue01.dds 

| 
| 
| 
| 

| 85 
| sullon magic02 
| sullon_magic02 
| wisp_blue01.dds 

| 
| 
| 
| 

| 86 
| PTBats 
| PTBats 
| bats01.dds 

| 
| 
| 
| 

| 87 
| arcstonemist 
| arcstonemist 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 88 
| lavasteam 
| lavasteam 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 89 
| arcstonewaterfall 
| arcstonewaterfall 
| bluestarsp501.dds 

| 
| 
| 
| 

| 90 
| arcbutterfly 
| arcbutterfly 
| butterfly_env.dds 

| 
| 
| 
| 

| 91 
| arcdust 
| arcdust 
| hail_hit01.dds 

| 
| 
| 
| 

| 92 
| geode rain01 
| geode_rain01 
| glowflare01_env.dds 

| 
| 
| 
| 

| 93 
| arc brazier 
| arc_brazier 
| new_fire.dds 

| 
| 
| 
| 

| 94 
| relic lightning 
| relic_lightning 
| electricb.dds 

| 
| 
| 
| 

| 95 
| relic vert lightning 
| relic_vert_lightning 
| lightning_l.dds 

| 
| 
| 
| 

| 96 
| relic ice fog 
| relic_ice_fog 
| frostsp502.dds 

| 
| 
| 
| 

| 97 
| relic sparks 
| relic_sparks 
| explosionf.dds 

| 
| 
| 
| 

| 98 
| relic lavaflame 
| relic_lavaflame 
| torchsp601.dds 

| 
| 
| 
| 

| 99 
| geyserbottom 
| geyserbottom 
| mist_white.dds 

| 
| 
| 
| 

| 100 
| geysertop 
| geysertop 
| mist_white.dds 

| 
| 
| 
| 

| 101 
| waterfall top 
| waterfall_top 
| mist_white.dds 

| 
| 
| 
| 

| 102 
| mist hotsprings 
| mist_hotsprings 
| mist_white.dds 

| 
| 
| 
| 

| 103 
| FlyE 
| FlyE 
| FlyE.dds 

| 
| 
| 
| 

| 104 
| areamist 
| areamist 
| mist_white.dds 

| 
| 
| 
| 

| 105 
| FlyE2 
| FlyE2 
| FlyE2.dds 

| 
| 
| 
| 

| 106 
| TorchFlame 
| TorchFlame 
| flamed.dds 

| 
| 
| 
| 

| 107 
| geysermiddle 
| geysermiddle 
| mist_white.dds 

| 
| 
| 
| 

| 108 
| twinkles blue 
| twinkles_blue 
| bluestarsp501.dds 

| 
| 
| 
| 

| 109 
| direwind clouds 
| direwind_clouds 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 110 
| AGstatueflame 
| AGstatueflame 
| fire01.dds 

| 
| 
| 
| 

| 111 
| AGcavemist 
| AGcavemist 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 112 
| AGlavas mist area 
| AGlavas_mist_area 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 113 
| AGnests smoke 
| AGnests_smoke 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 114 
| AGlava flame 
| AGlava_flame 
| torchsp601.dds 

| 
| 
| 
| 

| 115 
| AGdias green 
| AGdias_green 
| glowflare01_env.dds 

| 
| 
| 
| 

| 116 
| direwind mist 
| direwind_mist 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 117 
| direwind clouds 
| direwind_clouds 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 118 
| moths 
| moths 
| Wing3.dds 

| 
| 
| 
| 

| 119 
| roostteleport 
| roostteleport 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 120 
| torch highpass 
| torch_highpass 
| flamed.dds 

| 
| 
| 
| 

| 121 
| sh mistdown 
| sh_mistdown 
| smoked.dds 

| 
| 
| 
| 

| 122 
| sh mistdownlong 
| sh_mistdownlong 
| smoked.dds 

| 
| 
| 
| 

| 123 
| sh mist 
| sh_mist 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 124 
| sh magic 
| sh_magic 
| bluestarsp501.dds 

| 
| 
| 
| 

| 125 
| sh magic02 
| sh_magic02 
| bluestarsp501.dds 

| 
| 
| 
| 

| 126 
| sh magic03 
| sh_magic03 
| bluestarsp501.dds 

| 
| 
| 
| 

| 127 
| AGveeshan 
| AGveeshan 
| flaresp601.dds 

| 
| 
| 
| 

| 128 
| CRbrazier 
| CRbrazier 
| new_fire.dds 

| 
| 
| 
| 

| 129 
| CRbrazier blue 
| CRbrazier_blue 
| new_fire.dds 

| 
| 
| 
| 

| 130 
| CRtorch 
| CRtorch 
| new_fire.dds 

| 
| 
| 
| 

| 131 
| CRstatueflame 
| CRstatueflame 
| fire01.dds 

| 
| 
| 
| 

| 132 
| crbutterfly 
| crbutterfly 
| butterfly_env.dds 

| 
| 
| 
| 

| 133 
| crwaterfallbottom 
| crwaterfallbottom 
| mist_white_full.dds 

| 
| 
| 
| 

| 134 
| burntbreadsmoke 
| burntbreadsmoke 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 135 
| forgesmoke 
| forgesmoke 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 136 
| CRveeshan 
| CRveeshan 
| flaresp601.dds 

| 
| 
| 
| 

| 137 
| beakerbubbles 
| beakerbubbles 
| cancer1.dds 

| 
| 
| 
| 

| 138 
| beakersmoke 
| beakersmoke 
| laskullsp501.dds 

| 
| 
| 
| 

| 139 
| CRbrazier blue 
| CRbrazier_blue 
| new_fire.dds 

| 
| 
| 
| 

| 140 
| scryingeye 
| scryingeye 
| eyessp503.dds 

| 
| 
| 
| 

| 141 
| waterwheelsplash 
| waterwheelsplash 
| splashsp502.dds 

| 
| 
| 
| 

| 142 
| waterwheelsplashbig 
| waterwheelsplashbig 
| rain_hit.dds 

| 
| 
| 
| 

| 143 
| CRtorch 
| CRtorch 
| new_fire.dds 

| 
| 
| 
| 

| 144 
| frost torch flame 
| frost_torch_flame 
| new_flame.dds 

| 
| 
| 
| 

| 145 
| valdeholm brazier 
| valdeholm_brazier 
| new_fire.dds 

| 
| 
| 
| 

| 146 
| vald purpletorch 
| vald_purpletorch 
| flamed.dds 

| 
| 
| 
| 

| 147 
| vald bluetorch 
| vald_bluetorch 
| flamed.dds 

| 
| 
| 
| 

| 148 
| vald hotsprings 
| vald_hotsprings 
| mist_white.dds 

| 
| 
| 
| 

| 149 
| vald steam 
| vald_steam 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 150 
| bugs 
| bugs 
| FlyE2.dds 

| 
| 
| 
| 

| 151 
| firefly 
| firefly 
| firefly.dds 

| 
| 
| 
| 

| 152 
| sol sunfall ray 
| sol_sunfall_ray 
| glowflare02_env.dds 

| 
| 
| 
| 

| 153 
| sol sunfall gather 
| sol_sunfall_gather 
| zapmuze.dds 

| 
| 
| 
| 

| 154 
| sol sunfall ring 
| sol_sunfall_ring 
| wisp_grey01.dds 

| 
| 
| 
| 

| 155 
| atiikiwaterfallbottom 
| atiikiwaterfallbottom 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 156 
| silyssarextfire 
| silyssarextfire 
| new_fire.dds 

| 
| 
| 
| 

| 157 
| silyssarextsmoke 
| silyssarextsmoke 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 158 
| SilyIntBrazier 
| SilyIntBrazier 
| flamed.dds 

| 
| 
| 
| 

| 159 
| silyssarteleport 
| silyssarteleport 
| glowflare02_env.dds 

| 
| 
| 
| 

| 160 
| katta brazier 
| katta_brazier 
| new_fire.dds 

| 
| 
| 
| 

| 161 
| katta teleport 
| katta_teleport 
| glowflare02_env.dds 

| 
| 
| 
| 

| 162 
| thal teleport 
| thal_teleport 
| glowflare02_env.dds 

| 
| 
| 
| 

| 163 
| tox brazier 
| tox_brazier 
| new_fire.dds 

| 
| 
| 
| 

| 164 
| tox brazierSM 
| tox_brazierSM 
| new_fire.dds 

| 
| 
| 
| 

| 165 
| oot torch 
| oot_torch 
| new_fire.dds 

| 
| 
| 
| 

| 166 
| oot torch big 
| oot_torch_big 
| new_fire.dds 

| 
| 
| 
| 

| 167 
| sol smoke XL 
| sol_smoke_XL 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 168 
| sol sunfountain01 
| sol_sunfountain01 
| zapmuze.dds 

| 
| 
| 
| 

| 169 
| sol sunfountain02 
| sol_sunfountain02 
| zapmuze.dds 

| 
| 
| 
| 

| 170 
| sol sunfountain02 
| sol_sunfountain02 
| zapmuze.dds 

| 
| 
| 
| 

| 171 
| sol sunriver horz 
| sol_sunriver_horz 
| zapmuze.dds 

| 
| 
| 
| 

| 172 
| sol sunriver rise 
| sol_sunriver_rise 
| zapmuze.dds 

| 
| 
| 
| 

| 173 
| sol sun ring 
| sol_sun_ring 
| zapmuze.dds 

| 
| 
| 
| 

| 174 
| sol sunball01 
| sol_sunball01 
| zapmuze.dds 

| 
| 
| 
| 

| 175 
| buriedsea wind 
| buriedsea_wind 
| glowflare02_env.dds 

| 
| 
| 
| 

| 176 
| blue flame 
| blue_flame 
| new_fire.dds 

| 
| 
| 
| 

| 177 
| Crystallos sandTwister 
| Crystallos_sandTwister 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 178 
| crystallos lightning 
| crystallos_lightning 
| electricf.dds 

| 
| 
| 
| 

| 179 
| crystallos hourglass 
| crystallos_hourglass 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 180 
| oil fountain01 
| oil_fountain01 
| blobgray01.dds 

| 
| 
| 
| 

| 181 
| oil fountain02 
| oil_fountain02 
| blobgray01.dds 

| 
| 
| 
| 

| 182 
| water fountain01 
| water_fountain01 
| blobgray01.dds 

| 
| 
| 
| 

| 183 
| water fountain02 
| water_fountain02 
| blobgray01.dds 

| 
| 
| 
| 

| 184 
| face steam 
| face_steam 
| mist_white_full.dds 

| 
| 
| 
| 

| 185 
| steam down 
| steam_down 
| mist_white_full.dds 

| 
| 
| 
| 

| 186 
| steam up 
| steam_up 
| mist_white_full.dds 

| 
| 
| 
| 

| 187 
| green sparks 
| green_sparks 
| electricb.dds 

| 
| 
| 
| 

| 188 
| green lightning 
| green_lightning 
| lightning_l.dds 

| 
| 
| 
| 

| 189 
| wellbubbler 
| wellbubbler 
| bubblesp501.dds 

| 
| 
| 
| 

| 190 
| beam ring 
| beam_ring 
| ringe.dds 

| 
| 
| 
| 

| 191 
| gyro steam down 
| gyro_steam_down 
| mist_white_full.dds 

| 
| 
| 
| 

| 192 
| gyro steam 
| gyro_steam 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 193 
| gyro steam small 
| gyro_steam_small 
| mist_white_full.dds 

| 
| 
| 
| 

| 194 
| gyro steam up 
| gyro_steam_up 
| mist_white_full.dds 

| 
| 
| 
| 

| 195 
| steam vents 
| steam_vents 
| mist_white_full.dds 

| 
| 
| 
| 

| 196 
| pipe steam 
| pipe_steam 
| mist_white_full.dds 

| 
| 
| 
| 

| 197 
| firepit loping 
| firepit_loping 
| new_fire.dds 

| 
| 
| 
| 

| 198 
| torch goblin 
| torch_goblin 
| new_fire.dds 

| 
| 
| 
| 

| 199 
| firepit loping lg 
| firepit_loping_lg 
| new_fire.dds 

| 
| 
| 
| 

| 200 
| smoke big 
| smoke_big 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 201 
| firepit loping exlarge 
| firepit_loping_exlarge 
| new_fire.dds 

| 
| 
| 
| 

| 202 
| steamfont vents 
| steamfont_vents 
| mist_white_full.dds 

| 
| 
| 
| 

| 203 
| steamdown 
| steamdown 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 204 
| steam right 
| steam_right 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 205 
| small steam down 
| small_steam_down 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 206 
| small steam up 
| small_steam_up 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 207 
| core lightning 
| core_lightning 
| electricf.dds 

| 
| 
| 
| 

| 208 
| steam right 
| steam_right 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 209 
| firepit loping 
| firepit_loping 
| glowflare02_env.dds 

| 
| 
| 
| 

| 210 
| steamdown 
| steamdown 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 211 
| OOT torch 
| OOT_torch 
| new_fire.dds 

| 
| 
| 
| 

| 212 
| OOT torch big 
| OOT_torch_big 
| new_fire.dds 

| 
| 
| 
| 

| 213 
| befallen mist 
| befallen_mist 
| mist_white_full.dds 

| 
| 
| 
| 

| 214 
| campfire big 
| campfire_big 
| fire01.dds 

| 
| 
| 
| 

| 215 
| campfire small 
| campfire_small 
| fire01.dds 

| 
| 
| 
| 

| 216 
| waterfalldrops 
| waterfalldrops 
| rain_hit.dds 

| 
| 
| 
| 

| 217 
| ogh waterfallbottom 
| ogh_waterfallbottom 
| mist_white_full.dds 

| 
| 
| 
| 

| 218 
| ogh waterfallrockmist 
| ogh_waterfallrockmist 
| mist_white_full.dds 

| 
| 
| 
| 

| 219 
| BB Torch Standing 
| BB_Torch_Standing 
| new_fire.dds 

| 
| 
| 
| 

| 220 
| FirePlace 
| FirePlace 
| new_fire.dds 

| 
| 
| 
| 

| 221 
| Rathe braziersmoke 
| Rathe_braziersmoke 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 222 
| rathe power 
| rathe_power 
| wisp_blue01.dds 

| 
| 
| 
| 

| 223 
| BB WaterfallTop 
| BB_WaterfallTop 
| mist_white_full.dds 

| 
| 
| 
| 

| 224 
| BB WaterfallTop 
| BB_WaterfallTop 
| mist_white_full.dds 

| 
| 
| 
| 

| 225 
| BB UpperWaterfallTop 
| BB_UpperWaterfallTop 
| mist_white_full.dds 

| 
| 
| 
| 

| 226 
| BB Waterfall Splash Sm 
| BB_Waterfall_Splash_Sm 
| mist_white_full.dds 

| 
| 
| 
| 

| 227 
| Drips Upper 
| Drips_Upper 
| flare_whsp501.tga 

| 
| 
| 
| 

| 228 
| Drips Splash 
| Drips_Splash 
| rain_hit.dds 

| 
| 
| 
| 

| 229 
| chimneysmoke 
| chimneysmoke 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 230 
| fireplace small 
| fireplace_small 
| fire01.dds 

| 
| 
| 
| 

| 231 
| discord brazier large 
| discord_brazier_large 
| fire01.dds 

| 
| 
| 
| 

| 232 
| discord brazier small 
| discord_brazier_small 
| fire01.dds 

| 
| 
| 
| 

| 233 
| discord teleport 
| discord_teleport 
| wisp_blue01.dds 

| 
| 
| 
| 

| 234 
| bertox entrance 
| bertox entrance 
| mist_white_full.dds 

| 
| 
| 
| 

| 235 
| bertox pollen 
| bertox pollen 
| acid1.dds 

| 
| 
| 
| 

| 236 
| bertox exit 
| bertox exit 
| mist_white_full.dds 

| 
| 
| 
| 

| 237 
| bertox mold mist 
| bertox mold mist 
| finedust_grey.dds 

| 
| 
| 
| 

| 238 
| bertox mold purple 
| bertox mold purple 
| finedust_grey.dds 

| 
| 
| 
| 

| 239 
| bertox fly soup 
| bertox fly soup 
| mist_white_full.dds 

| 
| 
| 
| 

| 240 
| bertox fly maggots1 
| bertox fly maggots1 
| maggot1.dds 

| 
| 
| 
| 

| 241 
| bertox ichor 
| bertox ichor 
| darknesssp501.dds 

| 
| 
| 
| 

| 242 
| Discord acidsteam 
| Discord_acidsteam 
| smoked.dds 

| 
| 
| 
| 

| 243 
| discord grnmist 
| discord_grnmist 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 244 
| bertox forcefield 
| bertox forcefield 
| glowflare01_env.dds 

| 
| 
| 
| 

| 245 
| bertox ichor altar 
| bertox ichor altar 
| darknesssp501.dds 

| 
| 
| 
| 

| 246 
| bertox ichor oval 
| bertox ichor oval 
| darknesssp501.dds 

| 
| 
| 
| 

| 247 
| bertox ichor mist 
| bertox ichor mist 
| finedust_grey.dds 

| 
| 
| 
| 

| 248 
| discord stasis 
| discord_stasis 
| glowflare02_env.dds 

| 
| 
| 
| 

| 249 
| void timerift 01 
| void_timerift_01 
| rift_01.dds 

| 
| 
| 
| 

| 250 
| void timerift 02 
| void_timerift_02 
| rift_01.dds 

| 
| 
| 
| 

| 251 
| void timerift 03 
| void_timerift_03 
| rift_01.dds 

| 
| 
| 
| 

| 252 
| void timerift 04 
| void_timerift_04 
| rift_01.dds 

| 
| 
| 
| 

| 253 
| void timerift 05 
| void_timerift_05 
| glowflare02_env.dds 

| 
| 
| 
| 

| 254 
| void timerift 06 
| void_timerift_06 
| glowflare02_env.dds 

| 
| 
| 
| 

| 255 
| void timerift 07 
| void_timerift_07 
| glowflare02_env.dds 

| 
| 
| 
| 

| 256 
| void timerift 08 
| void_timerift_08 
| glowflare02_env.dds 

| 
| 
| 
| 

| 257 
| pow timerift 04 
| pow_timerift_04 
| rift_01.dds 

| 
| 
| 
| 

| 258 
| void timerift 08 
| void_timerift_08 
| glowflare02_env.dds 

| 
| 
| 
| 

| 259 
| void portal01 
| void_portal01 
| glowflare02_env.dds 

| 
| 
| 
| 

| 260 
| void portal rift 
| void_portal_rift 
| rift_06.dds 

| 
| 
| 
| 

| 261 
| void portal02 
| void_portal02 
| wisp_blue01.dds 

| 
| 
| 
| 

| 262 
| void portal03 
| void_portal03 
| glowflare02_env.dds 

| 
| 
| 
| 

| 263 
| torch brellsrest 
| torch_brellsrest 
| flamed.dds 

| 
| 
| 
| 

| 264 
| campfire brellsrest 
| campfire_brellsrest 
| fire01.dds 

| 
| 
| 
| 

| 265 
| brells waterfallbottom 
| brells_waterfallbottom 
| finedust_white01.dds 

| 
| 
| 
| 

| 266 
| brells waterfallbottomSM 
| brells_waterfallbottomSM 
| finedust_white01.dds 

| 
| 
| 
| 

| 267 
| brellslakesteam 
| brellslakesteam 
| mist_white_full.dds 

| 
| 
| 
| 

| 268 
| brellsboiling 
| brellsboiling 
| bubblesp501.dds 

| 
| 
| 
| 

| 269 
| brellsfallsteam 
| brellsfallsteam 
| mist_white_full.dds 

| 
| 
| 
| 

| 270 
| brellfirefly 
| brellfirefly 
| wisp_blue01.dds 

| 
| 
| 
| 

| 271 
| brellteleport ray 
| brellteleport ray 
| glowflare04_env.dds 

| 
| 
| 
| 

| 272 
| brellteleport sparkle 
| brellteleport sparkle 
| spin01.dds 

| 
| 
| 
| 

| 273 
| brellslavas mist 
| brellslavas_mist 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 274 
| Drips Splash 
| Drips_Splash 
| rain_hit.dds 

| 
| 
| 
| 

| 275 
| brellsteam mist 
| brellsteam_mist 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 276 
| brellrocksplash 
| brellrocksplash 
| finedust_grey.dds 

| 
| 
| 
| 

| 277 
| brells waterfallbottomSM 
| brells_waterfallbottomSM 
| finedust_white01.dds 

| 
| 
| 
| 

| 278 
| holezonevortex 
| holezonevortex 
| mist_white_full.dds 

| 
| 
| 
| 

| 279 
| holezonesparkle 
| holezonesparkle 
| spin01.dds 

| 
| 
| 
| 

| 280 
| holezonevortexhole 
| holezonevortexhole 
| mist_white_full.dds 

| 
| 
| 
| 

| 281 
| holezonesparklehole 
| holezonesparklehole 
| spin01.dds 

| 
| 
| 
| 

| 282 
| holezonesparklehole 
| holezonesparklehole 
| spin01.dds 

| 
| 
| 
| 

| 283 
| holezonesparklehole 
| holezonesparklehole 
| spin01.dds 

| 
| 
| 
| 

| 284 
| holezonesparklehole 
| holezonesparklehole 
| spin01.dds 

| 
| 
| 
| 

| 285 
| explode 
| explode 
| explosiona.dds 

| 
| 
| 
| 

| 286 
| debris 
| debris 
| shard03.dds 

| 
| 
| 
| 

| 287 
| smoke 
| smoke 
| mist_white_full.dds 

| 
| 
| 
| 

| 288 
| SC frostMistDown 
| SC_frostMistDown 
| smoked.dds 

| 
| 
| 
| 

| 289 
| SC frostMistGround 
| SC_frostMistGround 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 290 
| brell oil 
| brell_oil 
| blobgray01.dds 

| 
| 
| 
| 

| 291 
| brell oilfire 
| brell_oilfire 
| explosiona.dds 

| 
| 
| 
| 

| 292 
| trail intel ray 
| trail_intel_ray 
| glowflare04_env.dds 

| 
| 
| 
| 

| 293 
| trial intel sparkle 
| trial_intel_sparkle 
| sparkle03.dds 

| 
| 
| 
| 

| 294 
| trail element ray 
| trail_element_ray 
| glowflare04_env.dds 

| 
| 
| 
| 

| 295 
| trial element sparkle 
| trial_element_sparkle 
| sparkle03.dds 

| 
| 
| 
| 

| 296 
| trail labor ray 
| trail_labor_ray 
| glowflare04_env.dds 

| 
| 
| 
| 

| 297 
| trial labor sparkle 
| trial_labor_sparkle 
| sparkle03.dds 

| 
| 
| 
| 

| 298 
| trail combat ray 
| trail_combat_ray 
| glowflare04_env.dds 

| 
| 
| 
| 

| 299 
| trial combat sparkle 
| trial_combat_sparkle 
| sparkle03.dds 

| 
| 
| 
| 

| 300 
| brelltemple ray up 
| brelltemple ray up 
| glowflare04_env.dds 

| 
| 
| 
| 

| 301 
| brelltemple sparkle up 
| brelltemple sparkle up 
| spin01.dds 

| 
| 
| 
| 

| 302 
| brell white vitality 
| brell_white_vitality 
| corona5.dds 

| 
| 
| 
| 

| 303 
| brell blue reason 
| brell_blue_reason 
| corona5.dds 

| 
| 
| 
| 

| 304 
| brell purpl attraction 
| brell_purpl_attraction 
| corona5.dds 

| 
| 
| 
| 

| 305 
| brell orange repulsion 
| brell_orange_repulsion 
| corona5.dds 

| 
| 
| 
| 

| 306 
| brell yellow instability 
| brell_yellow_instability 
| corona5.dds 

| 
| 
| 
| 

| 307 
| brell green will 
| brell_green_will 
| corona5.dds 

| 
| 
| 
| 

| 308 
| brell black darkness 
| brell_black_darkness 
| corona5.dds 

| 
| 
| 
| 

| 309 
| vitality sparkle 
| vitality_sparkle 
| sparkle02.dds 

| 
| 
| 
| 

| 310 
| reason sparkle 
| reason_sparkle 
| sparkle02.dds 

| 
| 
| 
| 

| 311 
| attraction sparkle 
| attraction_sparkle 
| sparkle02.dds 

| 
| 
| 
| 

| 312 
| repulsion sparkle 
| repulsion_sparkle 
| sparkle02.dds 

| 
| 
| 
| 

| 313 
| instability sparkle 
| instability_sparkle 
| sparkle02.dds 

| 
| 
| 
| 

| 314 
| will sparkle 
| will_sparkle 
| sparkle02.dds 

| 
| 
| 
| 

| 315 
| darkness sparkle 
| darkness_sparkle 
| sparkle02.dds 

| 
| 
| 
| 

| 316 
| water magic 
| water_magic 
| wisp_blue01.dds 

| 
| 
| 
| 

| 317 
| clay magic 
| clay_magic 
| wisp_blue01.dds 

| 
| 
| 
| 

| 318 
| clay forcefield vert 
| clay_forcefield_vert 
| glowflare04_env.dds 

| 
| 
| 
| 

| 319 
| clay forcefield 45 
| clay_forcefield_45 
| glowflare04_env.dds 

| 
| 
| 
| 

| 320 
| clay forcefield 45 
| clay_forcefield_-45 
| glowflare04_env.dds 

| 
| 
| 
| 

| 321 
| clay forcefield ramp16 
| clay_forcefield_ramp16 
| glowflare04_env.dds 

| 
| 
| 
| 

| 322 
| clay forcefield ramp48 
| clay_forcefield_ramp48 
| glowflare04_env.dds 

| 
| 
| 
| 

| 323 
| water sparkle 
| water_sparkle 
| sparkle03.dds 

| 
| 
| 
| 

| 324 
| water sparkle horz 
| water_sparkle_horz 
| sparkle03.dds 

| 
| 
| 
| 

| 325 
| water sparkle shine v 
| water_sparkle_shine_v 
| wisp_blue01.dds 

| 
| 
| 
| 

| 326 
| water sparkle shine h 
| water_sparkle_shine_h 
| wisp_blue01.dds 

| 
| 
| 
| 

| 327 
| UQ rockblast 
| UQ_rockblast 
| rockchunksm.dds 

| 
| 
| 
| 

| 328 
| UQ rockblastdust 
| UQ_rockblastdust 
| mist_white_full.dds 

| 
| 
| 
| 

| 329 
| UQ rockfall 
| UQ_rockfall 
| rock1.dds 

| 
| 
| 
| 

| 330 
| UQ rockfalldust 
| UQ_rockfalldust 
| finedust_white01.dds 

| 
| 
| 
| 

| 331 
| torch brelltemple 
| torch_brelltemple 
| flamed.dds 

| 
| 
| 
| 

| 332 
| BT brazier LG 
| BT_brazier_LG 
| fire01.dds 

| 
| 
| 
| 

| 333 
| beaker red sparkle 
| beaker_red_sparkle 
| sparkle02.dds 

| 
| 
| 
| 

| 334 
| beaker green sparkle 
| beaker_green_sparkle 
| sparkle02.dds 

| 
| 
| 
| 

| 335 
| beaker blue sparkle 
| beaker_blue_sparkle 
| sparkle02.dds 

| 
| 
| 
| 

| 336 
| beaker yellow sparkle 
| beaker_yellow_sparkle 
| sparkle02.dds 

| 
| 
| 
| 

| 337 
| BT brazier SM 
| BT_brazier_SM 
| fire01.dds 

| 
| 
| 
| 

| 338 
| brazier fire element 
| brazier_fire_element 
| flamed.dds 

| 
| 
| 
| 

| 339 
| brazier earth element 
| brazier_earth_element 
| finedust_white01.dds 

| 
| 
| 
| 

| 340 
| brazier water element 
| brazier_water_element 
| reflect03.dds 

| 
| 
| 
| 

| 341 
| brazier air element 
| brazier_air_element 
| glowflare02_env.dds 

| 
| 
| 
| 

| 342 
| BT brazier XSM 
| BT_brazier_XSM 
| fire01.dds 

| 
| 
| 
| 

| 343 
| water ring vert 
| water_ring_vert 
| rain_hit.dds 

| 
| 
| 
| 

| 344 
| water ring horz 
| water_ring_horz 
| rain_hit.dds 

| 
| 
| 
| 

| 345 
| brelltemple candle 
| brelltemple_candle 
| new_flame.dds 

| 
| 
| 
| 

| 346 
| brelltemple ray down 
| brelltemple ray down 
| glowflare04_env.dds 

| 
| 
| 
| 

| 347 
| brelltemple sparkle down 
| brelltemple sparkle down 
| spin01.dds 

| 
| 
| 
| 

| 348 
| sh mist 
| sh_mist 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 349 
| pellucid swirling 
| pellucid_swirling 
| mist_white_full.dds 

| 
| 
| 
| 

| 350 
| pellucid blue smoke 
| pellucid_blue_smoke 
| frostsp502.dds 

| 
| 
| 
| 

| 351 
| blood smoke 
| blood_smoke 
| smoked.dds 

| 
| 
| 
| 

| 352 
| campfire big 
| campfire_big 
| fire01.dds 

| 
| 
| 
| 

| 353 
| pellucid smoke 
| pellucid_smoke 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 354 
| pipe steam 
| pipe_steam 
| mist_white_full.dds 

| 
| 
| 
| 

| 355 
| pellucid sm dark smoke 
| pellucid_sm_dark_smoke 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 356 
| lavasteam large 
| lavasteam_large 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 357 
| pellucid lava steam 
| pellucid_lava_steam 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 358 
| beaker sparkle 
| beaker_sparkle 
| sparkle03.dds 

| 
| 
| 
| 

| 359 
| beaker bubbles 
| beaker_bubbles 
| bubbles02.dds 

| 
| 
| 
| 

| 360 
| SC kiln magic 
| SC_kiln_magic 
| wisp_blue01.dds 

| 
| 
| 
| 

| 361 
| cooling steam small 
| cooling_steam_small 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 362 
| cooling steam large 
| cooling_steam_large 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 363 
| cooling magic 
| cooling_magic 
| bluestarsp501.dds 

| 
| 
| 
| 

| 364 
| cooling brazier 
| cooling_brazier 
| fire01.dds 

| 
| 
| 
| 

| 365 
| cooling waterfall 
| cooling_waterfall 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 366 
| SC contraptionsmoke 
| SC_contraptionsmoke 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 367 
| LavaFall 
| LavaFall 
| firec.dds 

| 
| 
| 
| 

| 368 
| conv water 
| conv_water 
| mist_white.dds 

| 
| 
| 
| 

| 369 
| conv lava steam 
| conv_lava_steam 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 370 
| candle chapel 
| candle_chapel 
| flamed.dds 

| 
| 
| 
| 

| 371 
| snakelavas mist 
| snakelavas_mist 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 372 
| SSheartmd 
| SSheartmd 
| flare.dds 

| 
| 
| 
| 

| 373 
| SSheartmd 
| SSheartmd 
| flare.dds 

| 
| 
| 
| 

| 374 
| lavadustmotesSM 
| lavadustmotesSM 
| flare.dds 

| 
| 
| 
| 

| 375 
| lavadustmotesLG 
| lavadustmotesLG 
| flare.dds 

| 
| 
| 
| 

| 376 
| snakelavas mistSM 
| snakelavas_mistSM 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 377 
| torch refugee 
| torch_refugee 
| flamed.dds 

| 
| 
| 
| 

| 378 
| mephit candle 
| mephit_candle 
| new_flame.dds 

| 
| 
| 
| 

| 379 
| mephit candleSM 
| mephit_candleSM 
| new_flame.dds 

| 
| 
| 
| 

| 380 
| mephit mist 
| mephit_mist 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 381 
| grekken food dust 
| grekken_food_dust 
| finedust_white01.dds 

| 
| 
| 
| 

| 382 
| grekken food drops 
| grekken_food_drops 
| rock1.dds 

| 
| 
| 
| 

| 383 
| refugee forgesmoke 
| refugee_forgesmoke 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 384 
| statue candle 
| statue_candle 
| new_flame.dds 

| 
| 
| 
| 

| 385 
| gem smoke 
| gem_smoke 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 386 
| foul water 
| foul_water 
| poison03.dds 

| 
| 
| 
| 

| 387 
| hg waterspout 
| hg_waterspout 
| reflect03.dds 

| 
| 
| 
| 

| 388 
| hg coffinspirit 
| hg_coffinspirit 
| glowflare02_env.dds 

| 
| 
| 
| 

| 389 
| hg compostdervish 
| hg_compostdervish 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 390 
| ship fire 
| ship_fire 
| fire01.dds 

| 
| 
| 
| 

| 391 
| street lamp 
| street_lamp 
| new_flame.dds 

| 
| 
| 
| 

| 392 
| building fire m 
| building_fire_m 
| fire01.dds 

| 
| 
| 
| 

| 393 
| building fire s 
| building_fire_s 
| fire01.dds 

| 
| 
| 
| 

| 394 
| bookfire 
| bookfire 
| fire01.dds 

| 
| 
| 
| 

| 395 
| smoke L 
| smoke_L 
| mist_white_full.dds 

| 
| 
| 
| 

| 396 
| smoke S 
| smoke_S 
| mist_white_full.dds 

| 
| 
| 
| 

| 397 
| ship smoke L 
| ship_smoke_L 
| mist_white_full.dds 

| 
| 
| 
| 

| 398 
| foul water fountain 
| foul_water_fountain 
| poison03.dds 

| 
| 
| 
| 

| 399 
| house brazier 
| house_brazier 
| fire01.dds 

| 
| 
| 
| 

| 400 
| purple brazier 
| purple_brazier 
| fire01_gray.dds 

| 
| 
| 
| 

| 401 
| cyan brazier 
| cyan_brazier 
| fire01_gray.dds 

| 
| 
| 
| 

| 402 
| green brazier 
| green_brazier 
| fire01_gray.dds 

| 
| 
| 
| 

| 403 
| bridgefire blue 
| bridgefire_blue 
| fire_missle.dds 

| 
| 
| 
| 

| 404 
| bridgefire green 
| bridgefire_green 
| fire_missle.dds 

| 
| 
| 
| 

| 405 
| skull fall 
| skull_fall 
| skull_rotate.dds 

| 
| 
| 
| 

| 406 
| fear portal 
| fear_portal 
| portal03.dds 

| 
| 
| 
| 

| 407 
| fear portal sparks 
| fear_portal_sparks 
| wisp_blue01.dds 

| 
| 
| 
| 

| 408 
| fear portal small 
| fear_portal_small 
| portal03.dds 

| 
| 
| 
| 

| 409 
| fear portal sparks small 
| fear_portal_sparks_small 
| wisp_blue01.dds 

| 
| 
| 
| 

| 410 
| ghost window smoke 
| ghost_window_smoke 
| mist_white_full.dds 

| 
| 
| 
| 

| 411 
| ghost male 
| ghost_male 
| ghost_male.dds 

| 
| 
| 
| 

| 412 
| ghost female 
| ghost_female 
| ghost_female.dds 

| 
| 
| 
| 

| 413 
| garbage fume 
| garbage_fume 
| mist_white_full.dds 

| 
| 
| 
| 

| 414 
| green fog 
| green_fog 
| mist_white_full.dds 

| 
| 
| 
| 

| 415 
| skull torch 
| skull_torch 
| flamed.dds 

| 
| 
| 
| 

| 416 
| graveyard fog 
| graveyard_fog 
| mist_white_full.dds 

| 
| 
| 
| 

| 417 
| ice fog ns 
| ice_fog_ns 
| mist_white_full.dds 

| 
| 
| 
| 

| 418 
| Alkabor treefireA 
| Alkabor_treefireA 
| fire01.dds 

| 
| 
| 
| 

| 419 
| Alkabor treefireB 
| Alkabor_treefireB 
| fire01.dds 

| 
| 
| 
| 

| 420 
| alkabor treesmokedrk 
| alkabor_treesmokedrk 
| mist_white_full.dds 

| 
| 
| 
| 

| 421 
| alkabor treesmokelite 
| alkabor_treesmokelite 
| mist_white_full.dds 

| 
| 
| 
| 

| 422 
| snowflurry 
| snowflurry 
| flare.dds 

| 
| 
| 
| 

| 423 
| ice fog ring 45 
| ice_fog_ring_45 
| mist_white_full.dds 

| 
| 
| 
| 

| 424 
| ice fog ring 38 
| ice_fog_ring_38 
| mist_white_full.dds 

| 
| 
| 
| 

| 425 
| alk electric 
| alk_electric 
| corona5.dds 

| 
| 
| 
| 

| 426 
| alk electricup 
| alk_electricup 
| reflect03.dds 

| 
| 
| 
| 

| 427 
| somnium banshee01 
| somnium_banshee01 
| banshee01.dds 

| 
| 
| 
| 

| 428 
| somnium banshee02 
| somnium_banshee02 
| banshee01.dds 

| 
| 
| 
| 

| 429 
| somnium eyes01 
| somnium_eyes01 
| paranoia_eyes01.dds 

| 
| 
| 
| 

| 430 
| somnium eyes02 
| somnium_eyes02 
| paranoia_eyes01.dds 

| 
| 
| 
| 

| 431 
| somnium eyes03 
| somnium_eyes03 
| paranoia_eyes01.dds 

| 
| 
| 
| 

| 432 
| somnium eyes04 
| somnium_eyes04 
| paranoia_eyes01.dds 

| 
| 
| 
| 

| 433 
| somnium waterfall large 
| somnium_waterfall_large 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 434 
| somnium dirt 
| somnium_dirt 
| mist_white_full.dds 

| 
| 
| 
| 

| 435 
| somnium fountain01 
| somnium_fountain01 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 436 
| somnium fountain02 
| somnium_fountain02 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 437 
| somnium candle flame a 
| somnium_candle_flame_a 
| new_flame.dds 

| 
| 
| 
| 

| 438 
| somnium mirror01 
| somnium_mirror01 
| magic_mask01.dds 

| 
| 
| 
| 

| 439 
| somnium mirror02 
| somnium_mirror02 
| magic_mask04.dds 

| 
| 
| 
| 

| 440 
| somnium mirror03 
| somnium_mirror03 
| magic_mask03.dds 

| 
| 
| 
| 

| 441 
| somnium candle flame b 
| somnium_candle_flame_b 
| new_flame.dds 

| 
| 
| 
| 

| 442 
| somnium candle flame c 
| somnium_candle_flame_c 
| new_flame.dds 

| 
| 
| 
| 

| 443 
| graveyard fog 
| graveyard_fog 
| mist_white_full.dds 

| 
| 
| 
| 

| 444 
| arelis burning column 
| arelis_burning_column 
| zapmuzc.dds 

| 
| 
| 
| 

| 445 
| blue pearlA 
| blue_pearlA 
| flare.dds 

| 
| 
| 
| 

| 446 
| blue pearlB 
| blue_pearlB 
| flare.dds 

| 
| 
| 
| 

| 447 
| blue pearlC 
| blue_pearlC 
| flare.dds 

| 
| 
| 
| 

| 448 
| blue pearlD 
| blue_pearlD 
| flare.dds 

| 
| 
| 
| 

| 449 
| blue pearlE 
| blue_pearlE 
| flare.dds 

| 
| 
| 
| 

| 450 
| rubak pearl 
| rubak_pearl 
| flare.dds 

| 
| 
| 
| 

| 451 
| orange pearlA 
| orange_pearlA 
| flare.dds 

| 
| 
| 
| 

| 452 
| orange pearlB 
| orange_pearlB 
| flare.dds 

| 
| 
| 
| 

| 453 
| orange pearlC 
| orange_pearlC 
| flare.dds 

| 
| 
| 
| 

| 454 
| orange pearlD 
| orange_pearlD 
| flare.dds 

| 
| 
| 
| 

| 455 
| orange pearlE 
| orange_pearlE 
| flare.dds 

| 
| 
| 
| 

| 456 
| rubak bubbles 
| rubak_bubbles 
| bubblesp501.dds 

| 
| 
| 
| 

| 457 
| argath lavabubble 
| argath_lavabubble 
| firec.dds 

| 
| 
| 
| 

| 458 
| sarith brazier large 
| sarith_brazier_large 
| flamed.dds 

| 
| 
| 
| 

| 459 
| sarith fountain 01 
| sarith_fountain_01 
| mist_white_full.dds 

| 
| 
| 
| 

| 460 
| sarith fountain 02 
| sarith_fountain_02 
| mist_white_full.dds 

| 
| 
| 
| 

| 461 
| sarith seagull a 
| sarith_seagull_a 
| sseagull_02_c.dds 

| 
| 
| 
| 

| 462 
| sarith seagull b 
| sarith_seagull_b 
| sseagull_03_c.dds 

| 
| 
| 
| 

| 463 
| arc pillar 
| arc_pillar 
| hex_glow.dds 

| 
| 
| 
| 

| 464 
| mana arc pit 
| mana_arc_pit 
| hex_glow.dds 

| 
| 
| 
| 

| 465 
| arc master feed left 
| arc_master_feed_left 
| hex_glow.dds 

| 
| 
| 
| 

| 466 
| arc master feed right 
| arc_master_feed_right 
| hex_glow.dds 

| 
| 
| 
| 

| 467 
| mana arc master ball 
| mana_arc_master_ball 
| hex_glow.dds 

| 
| 
| 
| 

| 468 
| light pillar 
| light_pillar 
| flare.dds 

| 
| 
| 
| 

| 469 
| light mana pit 
| light_mana_pit 
| flare01.dds 

| 
| 
| 
| 

| 470 
| lit master feed left 
| lit_master_feed_left 
| flare01.dds 

| 
| 
| 
| 

| 471 
| lit master feed right 
| lit_master_feed_right 
| flare01.dds 

| 
| 
| 
| 

| 472 
| lit master ball 
| lit_master_ball 
| flare01.dds 

| 
| 
| 
| 

| 473 
| shad mana pit 
| shad_mana_pit 
| shadow03.dds 

| 
| 
| 
| 

| 474 
| shadow pillar 
| shadow_pillar 
| shadow03.dds 

| 
| 
| 
| 

| 475 
| shad master feed right 
| shad_master_feed_right 
| shadow03.dds 

| 
| 
| 
| 

| 476 
| shad master feed left 
| shad_master_feed_left 
| shadow03.dds 

| 
| 
| 
| 

| 477 
| shad master ball 
| shad_master_ball 
| shadow03.dds 

| 
| 
| 
| 

| 478 
| WFP flame jet 
| WFP_flame_jet 
| flamed.dds 

| 
| 
| 
| 

| 479 
| WFP flame blue 
| WFP_flame_blue 
| flameblue.dds 

| 
| 
| 
| 

| 480 
| WFP Smoke 
| WFP_Smoke 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 481 
| WFP fire2 
| WFP_fire2 
| fire01.dds 

| 
| 
| 
| 

| 482 
| nat mana pit 
| nat_mana_pit 
| portal03.dds 

| 
| 
| 
| 

| 483 
| nat mana pit flower 
| nat_mana_pit_flower 
| pillars_flower.dds 

| 
| 
| 
| 

| 484 
| nature pillar 
| nature_pillar 
| portal03.dds 

| 
| 
| 
| 

| 485 
| nat master feed left 
| nat_master_feed_left 
| portal03.dds 

| 
| 
| 
| 

| 486 
| nat master feed right 
| nat_master_feed_right 
| portal03.dds 

| 
| 
| 
| 

| 487 
| nat master ball 
| nat_master_ball 
| portal03.dds 

| 
| 
| 
| 

| 488 
| nat master flower 
| nat_master_flower 
| pillars_flower.dds 

| 
| 
| 
| 

| 489 
| arc guide 
| arc_guide 
| hex_glow.dds 

| 
| 
| 
| 

| 490 
| shad guide 
| shad_guide 
| shadow03.dds 

| 
| 
| 
| 

| 491 
| nat guide 
| nat_guide 
| portal03.dds 

| 
| 
| 
| 

| 492 
| lit guide 
| lit_guide 
| flare01.dds 

| 
| 
| 
| 

| 493 
| arc shrine 
| arc_shrine 
| hex_glow.dds 

| 
| 
| 
| 

| 494 
| lit shrine 
| lit_shrine 
| flare01.dds 

| 
| 
| 
| 

| 495 
| shad shrine 
| shad_shrine 
| shadow04.dds 

| 
| 
| 
| 

| 496 
| lit tomb 
| lit_tomb 
| flare01.dds 

| 
| 
| 
| 

| 497 
| arc tomb 
| arc_tomb 
| hex_glow.dds 

| 
| 
| 
| 

| 498 
| shad tomb 
| shad_tomb 
| shadow03.dds 

| 
| 
| 
| 

| 499 
| nat tomb 
| nat_tomb 
| portal03.dds 

| 
| 
| 
| 

| 500 
| nat tomb ramp 
| nat_tomb_ramp 
| portal03.dds 

| 
| 
| 
| 

| 501 
| lit tomb ramp 
| lit_tomb_ramp 
| flare01.dds 

| 
| 
| 
| 

| 502 
| arc tomb ramp 
| arc_tomb_ramp 
| hex_glow.dds 

| 
| 
| 
| 

| 503 
| shad tomb ramp 
| shad_tomb_ramp 
| shadow03.dds 

| 
| 
| 
| 

| 504 
| shad ramp2side 
| shad_ramp2side 
| shadow03.dds 

| 
| 
| 
| 

| 505 
| shad ramp1side 
| shad_ramp1side 
| shadow03.dds 

| 
| 
| 
| 

| 506 
| arc ramp2side 
| arc_ramp2side 
| hex_glow.dds 

| 
| 
| 
| 

| 507 
| arc ramp1side 
| arc_ramp1side 
| hex_glow.dds 

| 
| 
| 
| 

| 508 
| lit ramp2side 
| lit_ramp2side 
| flare01.dds 

| 
| 
| 
| 

| 509 
| lit ramp1side 
| lit_ramp1side 
| flare01.dds 

| 
| 
| 
| 

| 510 
| nat ramp2side 
| nat_ramp2side 
| portal03.dds 

| 
| 
| 
| 

| 511 
| nat ramp2side01 
| nat_ramp2side01 
| portal03.dds 

| 
| 
| 
| 

| 512 
| nat ramp1side 
| nat_ramp1side 
| portal03.dds 

| 
| 
| 
| 

| 513 
| arc scan vert 
| arc_scan_vert 
| hex_glow.dds 

| 
| 
| 
| 

| 514 
| arc scan ringA 
| arc_scan_ringA 
| hex_glow.dds 

| 
| 
| 
| 

| 515 
| arc scan ringB 
| arc_scan_ringB 
| hex_glow.dds 

| 
| 
| 
| 

| 516 
| lit scan ringA 
| lit_scan_ringA 
| flare01.dds 

| 
| 
| 
| 

| 517 
| lit scan ringB 
| lit_scan_ringB 
| flare01.dds 

| 
| 
| 
| 

| 518 
| lit scan vert 
| lit_scan_vert 
| flare01.dds 

| 
| 
| 
| 

| 519 
| nat scan vert 
| nat_scan_vert 
| portal03.dds 

| 
| 
| 
| 

| 520 
| nat scan ringA 
| nat_scan_ringA 
| portal03.dds 

| 
| 
| 
| 

| 521 
| nat scan vert 
| nat_scan_vert 
| portal03.dds 

| 
| 
| 
| 

| 522 
| shad scan vert 
| shad_scan_vert 
| shadow03.dds 

| 
| 
| 
| 

| 523 
| shad scan ringA 
| shad_scan_ringA 
| shadow03.dds 

| 
| 
| 
| 

| 524 
| shad scan ringB 
| shad_scan_ringB 
| shadow03.dds 

| 
| 
| 
| 

| 525 
| sep brazier 
| sep_brazier 
| flare.dds 

| 
| 
| 
| 

| 526 
| sep bloodpool foyer 
| sep_bloodpool_foyer 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 527 
| sep torch 
| sep_torch 
| flare.dds 

| 
| 
| 
| 

| 528 
| sep standinglantern 
| sep_standinglantern 
| flare.dds 

| 
| 
| 
| 

| 529 
| ws cllayer white 
| ws_cllayer_white 
| mist_white_full.dds 

| 
| 
| 
| 

| 530 
| sep fountain 
| sep_fountain 
| sparkle02.dds 

| 
| 
| 
| 

| 531 
| sep pooltomb 
| sep_pooltomb 
| sparkle02.dds 

| 
| 
| 
| 

| 532 
| sep poolfoyer 
| sep_poolfoyer 
| sparkle02.dds 

| 
| 
| 
| 

| 533 
| sep bloodfoyer 
| sep_bloodfoyer 
| sparkle02.dds 

| 
| 
| 
| 

| 534 
| sep bloodfoyer 
| sep_bloodfoyer 
| sparkle02.dds 

| 
| 
| 
| 

| 535 
| sep decay fog 
| sep_decay_fog 
| mist_white_full.dds 

| 
| 
| 
| 

| 536 
| sep battle fog 
| sep_battle_fog 
| mist_white_full.dds 

| 
| 
| 
| 

| 537 
| sep splendor fog 
| sep_splendor_fog 
| mist_white_full.dds 

| 
| 
| 
| 

| 538 
| sep fertility fog 
| sep_fertility_fog 
| mist_white_full.dds 

| 
| 
| 
| 

| 539 
| sep beasts fog 
| sep_beasts_fog 
| mist_white_full.dds 

| 
| 
| 
| 

| 540 
| sep magic purp 
| sep_magic_purp 
| glowflare01_env.dds 

| 
| 
| 
| 

| 541 
| sep magic orange 
| sep_magic_orange 
| glowflare01_env.dds 

| 
| 
| 
| 

| 542 
| sep magic blue 
| sep_magic_blue 
| glowflare01_env.dds 

| 
| 
| 
| 

| 543 
| sep magic white 
| sep_magic_white 
| glowflare01_env.dds 

| 
| 
| 
| 

| 544 
| sep magic black 
| sep_magic_black 
| glowflare01_env.dds 

| 
| 
| 
| 

| 545 
| Argath waterfall top 
| Argath_waterfall_top 
| mist_white_full.dds 

| 
| 
| 
| 

| 546 
| shad candle 
| shad_candle 
| new_flame.dds 

| 
| 
| 
| 

| 547 
| sep tombbloodspout 
| sep_tombbloodspout 
| reflect03.dds 

| 
| 
| 
| 

| 548 
| cob brazier 
| cob_brazier 
| flamed.dds 

| 
| 
| 
| 

| 549 
| cob brazier blue 
| cob_brazier_blue 
| flamegray.dds 

| 
| 
| 
| 

| 550 
| cob brazier purple 
| cob_brazier_purple 
| flamegray.dds 

| 
| 
| 
| 

| 551 
| cob brazier green 
| cob_brazier_green 
| flamegray.dds 

| 
| 
| 
| 

| 552 
| cob brazier red 
| cob_brazier_red 
| flamegray.dds 

| 
| 
| 
| 

| 553 
| Blank Emitter Definition 
| Blank Emitter Definition 
| TextureFileName.dds 

| 
| 
| 
| 

| 554 
| mettalic sparkle 
| mettalic sparkle 
| sparkle01.dds 

| 
| 
| 
| 

| 555 
| cob brazier int 
| cob_brazier_int 
| flamed.dds 

| 
| 
| 
| 

| 556 
| tomb dust 
| tomb_dust 
| rock1.dds 

| 
| 
| 
| 

| 557 
| oratory wind pipes 
| oratory_wind_pipes 
| star_spin01.dds 

| 
| 
| 
| 

| 558 
| sep goddeath 
| sep_goddeath 
| glowflare02_env.dds 

| 
| 
| 
| 

| 559 
| sarith fountain large 
| sarith_fountain_large 
| mist_white_full.dds 

| 
| 
| 
| 

| 560 
| brells waterfallbottom 
| brells_waterfallbottom 
| mist_white_full.dds 

| 
| 
| 
| 

| 561 
| Argath waterfall top 
| Argath_waterfall_top 
| mist_white_full.dds 

| 
| 
| 
| 

| 562 
| xorbb shard01 
| xorbb_shard01 
| greek_key.dds 

| 
| 
| 
| 

| 563 
| xorbb shard02 
| xorbb_shard02 
| greek_key.dds 

| 
| 
| 
| 

| 564 
| xorbb shard03 
| xorbb_shard03 
| greek_key.dds 

| 
| 
| 
| 

| 565 
| SDL Portal 01 
| SDL_Portal_01 
| corona5.dds 

| 
| 
| 
| 

| 566 
| SDL Portal 02 
| SDL_Portal_02 
| corona5.dds 

| 
| 
| 
| 

| 567 
| SDL Portal 03 
| SDL_Portal_03 
| corona5.dds 

| 
| 
| 
| 

| 568 
| SDL Portal 04 
| SDL_Portal_04 
| corona5.dds 

| 
| 
| 
| 

| 569 
| SDL Portal 05 
| SDL_Portal_05 
| corona5.dds 

| 
| 
| 
| 

| 570 
| SDL Portal 06 
| SDL_Portal_06 
| corona5.dds 

| 
| 
| 
| 

| 571 
| SDL Portal 07 
| SDL_Portal_07 
| corona5.dds 

| 
| 
| 
| 

| 572 
| SDL Portal 08 
| SDL_Portal_08 
| corona5.dds 

| 
| 
| 
| 

| 573 
| SDL Portal 09 
| SDL_Portal_09 
| corona5.dds 

| 
| 
| 
| 

| 574 
| shard brazier 
| shard_brazier 
| flare01.dds 

| 
| 
| 
| 

| 575 
| shard chandelier 
| shard_chandelier 
| flare01.dds 

| 
| 
| 
| 

| 576 
| ch av torchflame 
| ch_av_torchflame 
| flamed.dds 

| 
| 
| 
| 

| 577 
| smoke 
| smoke 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 578 
| sharddust 
| sharddust 
| sparkle03.dds 

| 
| 
| 
| 

| 579 
| chelsith ring a 
| chelsith_ring_a 
| glowflare02_env.dds 

| 
| 
| 
| 

| 580 
| chelsith ring b 
| chelsith_ring_b 
| glowflare02_env.dds 

| 
| 
| 
| 

| 581 
| chelsith ring c 
| chelsith_ring_c 
| glowflare02_env.dds 

| 
| 
| 
| 

| 582 
| chelsith ring d 
| chelsith_ring_d 
| glowflare02_env.dds 

| 
| 
| 
| 

| 583 
| chelsith ring e 
| chelsith_ring_e 
| glowflare02_env.dds 

| 
| 
| 
| 

| 584 
| chelsith ring full 
| chelsith_ring_full 
| glowflare02_env.dds 

| 
| 
| 
| 

| 585 
| chelsith brazier a 
| chelsith_brazier_a 
| flamed.dds 

| 
| 
| 
| 

| 586 
| chelsith brazier b 
| chelsith_brazier_b 
| flamed.dds 

| 
| 
| 
| 

| 587 
| chelsith smoke 
| chelsith_smoke 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 588 
| chelsith ring aa 
| chelsith_ring_aa 
| glowflare02_env.dds 

| 
| 
| 
| 

| 589 
| chelsith ring bb 
| chelsith_ring_bb 
| glowflare02_env.dds 

| 
| 
| 
| 

| 590 
| chelsith ring cc 
| chelsith_ring_cc 
| glowflare02_env.dds 

| 
| 
| 
| 

| 591 
| chelsith ring dd 
| chelsith_ring_dd 
| glowflare02_env.dds 

| 
| 
| 
| 

| 592 
| chelsith ring ee 
| chelsith_ring_ee 
| glowflare02_env.dds 

| 
| 
| 
| 

| 593 
| chelsith ring full2 
| chelsith_ring_full2 
| glowflare02_env.dds 

| 
| 
| 
| 

| 594 
| chelsith ring red a 
| chelsith_ring_red_a 
| glowflare02_env.dds 

| 
| 
| 
| 

| 595 
| chelsith ring red b 
| chelsith_ring_red_b 
| glowflare02_env.dds 

| 
| 
| 
| 

| 596 
| chelsith ring red c 
| chelsith_ring_red_c 
| glowflare02_env.dds 

| 
| 
| 
| 

| 597 
| chelsith ring red d 
| chelsith_ring_red_d 
| glowflare02_env.dds 

| 
| 
| 
| 

| 598 
| chelsith ring red e 
| chelsith_ring_red_e 
| glowflare02_env.dds 

| 
| 
| 
| 

| 599 
| chelsith ring full red 
| chelsith_ring_full_red 
| glowflare02_env.dds 

| 
| 
| 
| 

| 600 
| chelsith energy01 
| chelsith_energy01 
| electrice.dds 

| 
| 
| 
| 

| 601 
| chelsith energy02 
| chelsith_energy02 
| electrice.dds 

| 
| 
| 
| 

| 602 
| chelsith energy03 
| chelsith_energy03 
| electrice.dds 

| 
| 
| 
| 

| 603 
| chelsith energy04 
| chelsith_energy04 
| electrice.dds 

| 
| 
| 
| 

| 604 
| chelsith energy05 
| chelsith_energy05 
| electrice.dds 

| 
| 
| 
| 

| 605 
| chelsith energy06 
| chelsith_energy06 
| electrice.dds 

| 
| 
| 
| 

| 606 
| chelsith energy07 
| chelsith_energy07 
| electrice.dds 

| 
| 
| 
| 

| 607 
| chelsith energy08 
| chelsith_energy08 
| electrice.dds 

| 
| 
| 
| 

| 608 
| poshadow torchBlue 
| poshadow_torchBlue 
| wisp_blue01.dds 

| 
| 
| 
| 

| 609 
| poshadow torchGreen 
| poshadow_torchGreen 
| wisp_blue01.dds 

| 
| 
| 
| 

| 610 
| poshadow torchOrange 
| poshadow_torchOrange 
| wisp_blue01.dds 

| 
| 
| 
| 

| 611 
| poshadow torchRed 
| poshadow_torchRed 
| wisp_blue01.dds 

| 
| 
| 
| 

| 612 
| chelsith brazier arena 
| chelsith_brazier_arena 
| flamed.dds 

| 
| 
| 
| 

| 613 
| poshadow BlueFoyer 
| poshadow_BlueFoyer 
| wisp_blue01.dds 

| 
| 
| 
| 

| 614 
| poshadow chandBlue 
| poshadow_chandBlue 
| wisp_blue01.dds 

| 
| 
| 
| 

| 615 
| poshad brazBlackSmoke 
| poshad_brazBlackSmoke 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 616 
| poshad BlackSmoke 
| poshad_BlackSmoke 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 617 
| poshad bonesBlackSmoke 
| poshad_bonesBlackSmoke 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 618 
| poshadow ShardExt 
| poshadow_ShardExt 
| wisp_blue01.dds 

| 
| 
| 
| 

| 619 
| poshadow ShardExt2 
| poshadow_ShardExt2 
| wisp_blue01.dds 

| 
| 
| 
| 

| 620 
| poshad lightfalls 
| poshad_lightfalls 
| glowflare02_env.dds 

| 
| 
| 
| 

| 621 
| poshad lightpool 
| poshad_lightpool 
| glowflare02_env.dds 

| 
| 
| 
| 

| 622 
| poshadow ShardInt 
| poshadow_ShardInt 
| wisp_blue01.dds 

| 
| 
| 
| 

| 623 
| poshadow ShardInt2 
| poshadow_ShardInt2 
| wisp_blue01.dds 

| 
| 
| 
| 

| 624 
| poshad shadowDense 
| poshad_shadowDense 
| pt_add_smoke.dds 

| 
| 
| 
| 

| 625 
| poshad shadow single 
| poshad_shadow_single 
| shadow.dds

---

## LDON Themes

*Source: server/zones/ldon-themes/index.html*

# LDON Themes¶

| 

LDoN Theme ID 
| LDoN Theme 

| 1 
| Deepest Guk 

| 2 
| Miragul's Menagerie 

| 3 
| Mistmoore Catacombs 

| 4 
| Rujarkian Hills 

| 5 
| Takish-Hiz

---

## Object Types

*Source: server/zones/object-types/index.html*

# Object Types¶

| 

Object Type **ID** 
| **Object Type** 

| 10 
| Tool Box 

| 11 
| Research 

| 12 
| "Mortar" (Opens experiment combine window) 

| 13 
| "Self Dusting" (Opens experiment combine window) 

| 14 
| Baking 

| 15 
| Baking 

| 16 
| Tailoring 

| 17 
| Forge 

| 18 
| Fletching 

| 19 
| Brew Barrel 

| 20 
| Jewelcraft 

| 21 
| Pottery Wheel 

| 22 
| Pottery Kiln 

| 24 
| Wiz only combine container (Research container?) 

| 25 
| Mage only 

| 26 
| Necro only 

| 27 
| Ench Only 

| 28 
| Invalid or Class/Race limited (Client crash w/DEF NEC) 

| 29 
| Invalid or Class/Race limited (Client crash w/DEF NEC) 

| 30 
| "Always Works" (Opens experiment combine window) 

| 31 
| High Elves Forge 

| 32 
| Dark Elves Forge 

| 33 
| Ogre Forge 

| 34 
| Dwarve Forge 

| 35 
| Gnome Forge 

| 36 
| Barbarian Forge 

| 38 
| Iksar Forge 

| 39 
| Human Forge 

| 40 
| Human Forge 

| 41 
| Halfling Tailoring kit 

| 42 
| Erudite Tailor 

| 43 
| Wood Elf Tailor 

| 44 
| Wood Elf Fletching kit 

| 45 
| Iksar Pottery Wheel 

| 47 
| Troll Forge 

| 48 
| Wood Elf Forge 

| 49 
| Halfling Forge 

| 50 
| Erudite Forge 

| 53 
| Augment

---

## Trap Types

*Source: server/zones/trap-types/index.html*

# Trap Types¶

| 

**Type** 
| **Effect** 
| **Effect Value** 
| **Effect Value 2** 
| **Notes** 

| Casting Trap 
| 0 
| Spell ID 
| Unused 
| Casts a spell on the player that triggered the trap. 

| Alarm Trap 
| 1 
| Range of effect 
| 0 (all NPCs aggro) or 1 (only KOS NPCs aggro) 
| Causes NPCs to aggro the player who triggered the trap. 

| Mystic Spawn (NPC Trap) 
| 2 
| npc_type ID of the mob spawned 
| number of mobs spawned 
| Spawns NPCs at a close spot in a small area 

| Bandit Spawn (NPC Trap2) 
| 3 
| npc_type ID of the mob spawned 
| number of mobs spawned 
| Spawns NPCs at a close spot in a large area 

| Damage Trap 
| 4 
| minimum amount of damage 
| maximum amount of damage 
| Causes damage to the player that triggered the trap. 

### Trap Message Defaults¶

| 

**Type** 
| **Effect** 
| **Default Message** 

| Casting Trap 
| 0 
| "_____ triggers a trap!" 

| Alarm Trap 
| 1 
| "A loud alarm rings out through the air..." 

| Mystic Spawn 
| 2 
| "The air shimmers..." 

| Bandit Spawn 
| 3 
| "A bandit leaps out from behind a tree!" 

| Damage Trap 
| 4 
| "_____ triggers a trap!"

---

## Zone Header Identifiers

*Source: server/zones/zone-header-identifiers/index.html*

# Zone Header Identifiers¶

The zone header contains the zone type, fog data, safe coordinates, max Z, gravity, time type, weather data, sky, underworld, minclip and maxclip, and suspend buffs flag.

To modify these values you can use the following method.

PerlLua

```
`quest::UpdateZoneHeader(identifier, value);
`
```

```
`eq.update_zone_header(identifier, value);
`
```

The values are as follows.

| 

Identifier 
| Notes 

| ztype 
| Zone Type 

| fog_red 
| Fog's Red Value (0 to 255) 

| fog_green 
| Fog's Green Value (0 to 255) 

| fog_blue 
| Fog's Blue Value (0 to 255) 

| fog_minclip 
| Fog's Minimum Clipping Distance 

| fog_maxclip 
| Fog's Maximum Clipping Distance 

| fog_density 
| Fog's Density (0.0 to 1.0) 

| gravity 
| Zone Gravity (0.4 Usually) 

| time_type 
| Zone Time Type 

| rain_chance 
| Rain Chance (0 to 100) 

| rain_duration 
| Rain Duration (0 to 100) 

| snow_chance 
| Snow Chance (0 to 100) 

| snow_duration 
| Snow Duration (0 to 100) 

| sky 
| Zone Sky 

| safe_x 
| Zone Safe X Coordinate 

| safe_y 
| Zone Safe Y Coordinate 

| safe_z 
| Zone Safe Z Coordinate 

| max_z 
| Zone Max Z Coordinate 

| underworld 
| Zone Underworld Z Coordinate 

| minclip 
| Zone Minimum Clipping Distance 

| maxclip 
| Zone Maximum Clipping Distance 

| suspendbuffs 
| Zone Suspend Buffs Flag (0 = Off, 1 = On)

---

## Zone List

*Source: server/zones/zone-list/index.html*

# Zone List¶

Info

Note that the zoneidnumber in your database is separate from the zone table id

| 

Zone ID 
| Zone Long Name 
| Zone Short Name 

| 1 
| South Qeynos 
| qeynos 

| 2 
| North Qeynos 
| qeynos2 

| 3 
| The Surefall Glade 
| qrg 

| 4 
| The Qeynos Hills 
| qeytoqrg 

| 5 
| Highpass Hold 
| highpass 

| 6 
| High Keep 
| highkeep 

| 8 
| North Freeport 
| freportn 

| 9 
| West Freeport 
| freportw 

| 10 
| East Freeport 
| freporte 

| 11 
| The Liberated Citadel of Runnyeye 
| runnyeye 

| 12 
| The Western Plains of Karana 
| qey2hh1 

| 13 
| The Northern Plains of Karana 
| northkarana 

| 14 
| The Southern Plains of Karana 
| southkarana 

| 15 
| Eastern Plains of Karana 
| eastkarana 

| 16 
| Gorge of King Xorbb 
| beholder 

| 17 
| Blackburrow 
| blackburrow 

| 18 
| The Lair of the Splitpaw 
| paw 

| 19 
| Rivervale 
| rivervale 

| 20 
| Kithicor Forest 
| kithicor 

| 21 
| West Commonlands 
| commons 

| 22 
| East Commonlands 
| ecommons 

| 23 
| The Erudin Palace 
| erudnint 

| 24 
| Erudin 
| erudnext 

| 25 
| The Nektulos Forest 
| nektulos 

| 25 
| The Nektulos Forest 
| nektulos 

| 26 
| Sunset Home 
| cshome 

| 27 
| The Lavastorm Mountains 
| lavastorm 

| 28 
| Nektropos 
| nektropos 

| 29 
| Halas 
| halas 

| 30 
| Everfrost Peaks 
| everfrost 

| 31 
| Solusek's Eye 
| soldunga 

| 32 
| Nagafen's Lair 
| soldungb 

| 33 
| Misty Thicket 
| misty 

| 34 
| Northern Desert of Ro 
| nro 

| 35 
| Southern Desert of Ro 
| sro 

| 36 
| Befallen 
| befallen 

| 37 
| Oasis of Marr 
| oasis 

| 38 
| Toxxulia Forest 
| tox 

| 39 
| The Hole 
| hole 

| 40 
| Neriak - Foreign Quarter 
| neriaka 

| 41 
| Neriak - Commons 
| neriakb 

| 42 
| Neriak - 3rd Gate 
| neriakc 

| 43 
| Neriak Palace 
| neriakd 

| 44 
| Najena 
| najena 

| 45 
| The Qeynos Aqueduct System 
| qcat 

| 46 
| Innothule Swamp 
| innothule 

| 47 
| The Feerrott 
| feerrott 

| 48 
| Accursed Temple of CazicThule 
| cazicthule 

| 49 
| Oggok 
| oggok 

| 50 
| The Rathe Mountains 
| rathemtn 

| 51 
| Lake Rathetear 
| lakerathe 

| 52 
| Grobb 
| grobb 

| 53 
| Aviak Village 
| aviak 

| 54 
| The Greater Faydark 
| gfaydark 

| 55 
| Ak'Anon 
| akanon 

| 56 
| Steamfont Mountains 
| steamfont 

| 57 
| The Lesser Faydark 
| lfaydark 

| 58 
| Crushbone 
| crushbone 

| 59 
| The Castle of Mistmoore 
| mistmoore 

| 60 
| South Kaladim 
| kaladima 

| 61 
| Northern Felwithe 
| felwithea 

| 62 
| Southern Felwithe 
| felwitheb 

| 63 
| The Estate of Unrest 
| unrest 

| 64 
| Kedge Keep 
| kedge 

| 65 
| The City of Guk 
| guktop 

| 66 
| The Ruins of Old Guk 
| gukbottom 

| 67 
| North Kaladim 
| kaladimb 

| 68 
| Butcherblock Mountains 
| butcher 

| 69 
| Ocean of Tears 
| oot 

| 70 
| Dagnor's Cauldron 
| cauldron 

| 71 
| The Plane of Sky 
| airplane 

| 72 
| The Plane of Fear 
| fearplane 

| 73 
| The Permafrost Caverns 
| permafrost 

| 74 
| Kerra Isle 
| kerraridge 

| 75 
| Paineel 
| paineel 

| 76 
| Plane of Hate 
| hateplane 

| 77 
| The Arena 
| arena 

| 78 
| The Field of Bone 
| fieldofbone 

| 79 
| The Warsliks Woods 
| warslikswood 

| 80 
| The Temple of Solusek Ro 
| soltemple 

| 81 
| The Temple of Droga 
| droga 

| 82 
| Cabilis West 
| cabwest 

| 83 
| The Swamp of No Hope 
| swampofnohope 

| 84 
| Firiona Vie 
| firiona 

| 85 
| Lake of Ill Omen 
| lakeofillomen 

| 86 
| The Dreadlands 
| dreadlands 

| 87 
| The Burning Wood 
| burningwood 

| 88 
| Kaesora 
| kaesora 

| 89 
| The Ruins of Sebilis 
| sebilis 

| 90 
| The City of Mist 
| citymist 

| 91 
| The Skyfire Mountains 
| skyfire 

| 92 
| Frontier Mountains 
| frontiermtns 

| 93 
| The Overthere 
| overthere 

| 94 
| The Emerald Jungle 
| emeraldjungle 

| 95 
| Trakanon's Teeth 
| trakanon 

| 96 
| Timorous Deep 
| timorous 

| 97 
| Kurn's Tower 
| kurn 

| 98 
| Erud's Crossing 
| erudsxing 

| 100 
| The Stonebrunt Mountains 
| stonebrunt 

| 101 
| The Warrens 
| warrens 

| 102 
| Karnor's Castle 
| karnor 

| 103 
| Chardok 
| chardok 

| 104 
| The Crypt of Dalnir 
| dalnir 

| 105 
| The Howling Stones 
| charasis 

| 106 
| Cabilis East 
| cabeast 

| 107 
| The Mines of Nurga 
| nurga 

| 108 
| Veeshan's Peak 
| veeshan 

| 109 
| Veksar 
| veksar 

| 110 
| The Iceclad Ocean 
| iceclad 

| 111 
| The Tower of Frozen Shadow 
| frozenshadow 

| 112 
| Velketor's Labyrinth 
| velketor 

| 113 
| Kael Drakkel 
| kael 

| 114 
| Skyshrine 
| skyshrine 

| 115 
| The City of Thurgadin 
| thurgadina 

| 116 
| Eastern Wastes 
| eastwastes 

| 117 
| Cobaltscar 
| cobaltscar 

| 118 
| The Great Divide 
| greatdivide 

| 119 
| The Wakening Land 
| wakening 

| 120 
| The Western Wastes 
| westwastes 

| 121 
| The Crystal Caverns 
| crystal 

| 123 
| Dragon Necropolis 
| necropolis 

| 124 
| The Temple of Veeshan 
| templeveeshan 

| 125 
| Siren's Grotto 
| sirens 

| 126 
| The Plane of Mischief 
| mischiefplane 

| 127 
| The Plane of Growth 
| growthplane 

| 128 
| The Sleeper's Tomb 
| sleeper 

| 129 
| Icewell Keep 
| thurgadinb 

| 130 
| Marauders Mire 
| erudsxing2 

| 150 
| Shadow Haven 
| shadowhaven 

| 151 
| The Bazaar 
| bazaar 

| 151 
| The Bazaar 
| bazaar 

| 152 
| Nexus 
| nexus 

| 153 
| The Echo Caverns 
| echo 

| 154 
| The Acrylia Caverns 
| acrylia 

| 155 
| The City of Shar Vahl 
| sharvahl 

| 156 
| The Paludal Caverns 
| paludal 

| 157 
| The Fungus Grove 
| fungusgrove 

| 158 
| Vex Thal 
| vexthal 

| 159 
| Sanctus Seru 
| sseru 

| 160 
| Katta Castellum 
| katta 

| 161 
| Netherbian Lair 
| netherbian 

| 162 
| Ssraeshza Temple 
| ssratemple 

| 163 
| Grieg's End 
| griegsend 

| 164 
| The Deep 
| thedeep 

| 165 
| Shadeweaver's Thicket 
| shadeweaver 

| 166 
| Hollowshade Moor 
| hollowshade 

| 167 
| Grimling Forest 
| grimling 

| 168 
| Marus Seru 
| mseru 

| 169 
| Mons Letalis 
| letalis 

| 170 
| The Twilight Sea 
| twilight 

| 171 
| The Grey 
| thegrey 

| 172 
| The Tenebrous Mountains 
| tenebrous 

| 173 
| The Maiden's Eye 
| maiden 

| 174 
| The Dawnshroud Peaks 
| dawnshroud 

| 175 
| The Scarlet Desert 
| scarlet 

| 176 
| The Umbral Plains 
| umbral 

| 179 
| The Akheva Ruins 
| akheva 

| 180 
| The Arena Two 
| arena2 

| 181 
| The Jaggedpine Forest 
| jaggedpine 

| 182 
| Nedaria's Landing 
| nedaria 

| 183 
| EverQuest Tutorial 
| tutorial 

| 184 
| Loading Zone 
| load 

| 185 
| New Loading Zone 
| load2 

| 186 
| The Plane of Hate 
| hateplaneb 

| 187 
| Shadowrest 
| shadowrest 

| 188 
| The Mines of Gloomingdeep 
| tutoriala 

| 189 
| The Mines of Gloomingdeep 
| tutorialb 

| 190 
| Loading 
| clz 

| 200 
| The Crypt of Decay 
| codecay 

| 201 
| The Plane of Justice 
| pojustice 

| 202 
| The Plane of Knowledge 
| poknowledge 

| 203 
| The Plane of Tranquility 
| potranquility 

| 204 
| The Plane of Nightmares 
| ponightmare 

| 205 
| The Plane of Disease 
| podisease 

| 206 
| The Plane of Innovation 
| poinnovation 

| 207 
| Torment, the Plane of Pain 
| potorment 

| 208 
| The Plane of Valor 
| povalor 

| 209 
| Bastion of Thunder 
| bothunder 

| 210 
| The Plane of Storms 
| postorms 

| 211 
| The Halls of Honor 
| hohonora 

| 212 
| The Tower of Solusek Ro 
| solrotower 

| 213 
| Plane of War 
| powar 

| 214 
| Drunder, the Fortress of Zek 
| potactics 

| 215 
| The Plane of Air 
| poair 

| 216 
| The Plane of Water 
| powater 

| 217 
| The Plane of Fire 
| pofire 

| 218 
| The Plane of Earth 
| poeartha 

| 219 
| The Plane of Time A 
| potimea 

| 220 
| The Temple of Marr 
| hohonorb 

| 221 
| The Lair of Terris Thule 
| nightmareb 

| 222 
| The Plane of Earth 
| poearthb 

| 223 
| The Plane of Time B 
| potimeb 

| 224 
| The Gulf of Gunthak 
| gunthak 

| 225 
| Dulak's Harbor 
| dulak 

| 226 
| The Torgiran Mines 
| torgiran 

| 227 
| The Crypt of Nadox 
| nadox 

| 228 
| Hate's Fury 
| hatesfury 

| 229 
| Deepest Guk: Cauldron of Lost Souls 
| guka 

| 230 
| The Rujarkian Hills: Bloodied Quarries 
| ruja 

| 231 
| Takish-Hiz: Sunken Library 
| taka 

| 232 
| Miragul's Menagerie: Silent Gallery 
| mira 

| 233 
| Mistmoore's Catacombs: Forlorn Caverns 
| mmca 

| 234 
| The Drowning Crypt 
| gukb 

| 235 
| The Rujarkian Hills: Halls of War 
| rujb 

| 236 
| Takish-Hiz: Shifting Tower 
| takb 

| 237 
| Miragul's Menagerie: Frozen Nightmare 
| mirb 

| 238 
| Mistmoore's Catacombs: Dreary Grotto 
| mmcb 

| 239 
| Deepest Guk: Ancient Aqueducts 
| gukc 

| 240 
| The Rujarkian Hills: Wind Bridges 
| rujc 

| 241 
| Takish-Hiz: Fading Temple 
| takc 

| 242 
| The Spider Den 
| mirc 

| 243 
| Mistmoore's Catacombs: Struggles within the Progeny 
| mmcc 

| 244 
| The Mushroom Grove 
| gukd 

| 245 
| The Rujarkian Hills: Prison Break 
| rujd 

| 246 
| Takish-Hiz: Royal Observatory 
| takd 

| 247 
| Miragul's Menagerie: Hushed Banquet 
| mird 

| 248 
| Mistmoore's Catacombs: Chambers of Eternal Affliction 
| mmcd 

| 249 
| Deepest Guk: The Curse Reborn 
| guke 

| 250 
| The Rujarkian Hills: Drudge Hollows 
| ruje 

| 251 
| Takish-Hiz: River of Recollection 
| take 

| 252 
| The Frosted Halls 
| mire 

| 253 
| Mistmoore's Catacombs: Sepulcher of the Damned 
| mmce 

| 254 
| Deepest Guk: Chapel of the Witnesses 
| gukf 

| 255 
| The Rujarkian Hills: Fortified Lair of the Taskmasters 
| rujf 

| 256 
| Takish-Hiz: Sandfall Corridors 
| takf 

| 257 
| The Forgotten Wastes 
| mirf 

| 258 
| Mistmoore's Catacombs: Scion Lair of Fury 
| mmcf 

| 259 
| The Root Garden 
| gukg 

| 260 
| The Rujarkian Hills: Hidden Vale of Deceit 
| rujg 

| 261 
| Takish-Hiz: Balancing Chamber 
| takg 

| 262 
| Miragul's Menagerie: Heart of the Menagerie 
| mirg 

| 263 
| Mistmoore's Catacombs: Cesspits of Putrescence 
| mmcg 

| 264 
| Deepest Guk: Accursed Sanctuary 
| gukh 

| 265 
| The Rujarkian Hills: Blazing Forge 
| rujh 

| 266 
| Takish-Hiz: Sweeping Tides 
| takh 

| 267 
| The Morbid Laboratory 
| mirh 

| 268 
| Mistmoore's Catacombs: Aisles of Blood 
| mmch 

| 269 
| The Rujarkian Hills: Arena of Chance 
| ruji 

| 270 
| Takish-Hiz: Antiquated Palace 
| taki 

| 271 
| The Theater of Imprisoned Horror 
| miri 

| 272 
| Mistmoore's Catacombs: Halls of Sanguinary Rites 
| mmci 

| 273 
| The Rujarkian Hills: Barracks of War 
| rujj 

| 274 
| Takish-Hiz: Prismatic Corridors 
| takj 

| 275 
| Miragul's Menagerie: Grand Library 
| mirj 

| 276 
| Mistmoore's Catacombs: Infernal Sanctuary 
| mmcj 

| 277 
| Chardok: The Halls of Betrayal 
| chardokb 

| 278 
| The Caverns of Exile 
| soldungc 

| 279 
| The Abysmal Sea 
| abysmal 

| 280 
| Natimbi, the Broken Shores 
| natimbi 

| 281 
| Qinimi, Court of Nihilia 
| qinimi 

| 282 
| Riwwi, Coliseum of Games 
| riwwi 

| 283 
| Barindu, Hanging Gardens 
| barindu 

| 284 
| Ferubi, Forgotten Temple of Taelosia 
| ferubi 

| 285 
| Sewers of Nihilia, Pool of Sludg 
| snpool 

| 286 
| Sewers of Nihilia, Lair of Trapp 
| snlair 

| 287 
| Sewers of Nihilia, Purifying Pla 
| snplant 

| 288 
| Sewers of Nihilia, Emanating Cre 
| sncrematory 

| 289 
| Tipt, Treacherous Crags 
| tipt 

| 290 
| Vxed, the Crumbling Caverns 
| vxed 

| 291 
| Yxtta, Pulpit of Exiles 
| yxtta 

| 292 
| Uqua, the Ocean God Chantry 
| uqua 

| 293 
| Kod'Taz, Broken Trial Grounds 
| kodtaz 

| 294 
| Ikkinz, Chambers of Transcendence 
| ikkinz 

| 295 
| Qvic, Prayer Grounds of Calling 
| qvic 

| 296 
| Inktu'Ta, the Unmasked Chapel 
| inktuta 

| 297 
| Txevu, Lair of the Elite 
| txevu 

| 298 
| Tacvi, The Broken Temple 
| tacvi 

| 299 
| Qvic, the Hidden Vault 
| qvicb 

| 300 
| Wall of Slaughter 
| wallofslaughter 

| 301 
| The Bloodfields 
| bloodfields 

| 302 
| Dranik's Scar 
| draniksscar 

| 303 
| Nobles' Causeway 
| causeway 

| 304 
| Muramite Proving Grounds A 
| chambersa 

| 305 
| Muramite Proving Grounds B 
| chambersb 

| 306 
| Muramite Proving Grounds C 
| chambersc 

| 307 
| Muramite Proving Grounds D 
| chambersd 

| 308 
| Muramite Proving Grounds E 
| chamberse 

| 309 
| Muramite Proving Grounds F 
| chambersf 

| 316 
| Muramite Proving Grounds G 
| provinggrounds 

| 317 
| Anguish, the Fallen Palace 
| anguish 

| 318 
| Dranik's Hollows A 
| dranikhollowsa 

| 319 
| Dranik's Hollows B 
| dranikhollowsb 

| 320 
| Dranik's Hollows C 
| dranikhollowsc 

| 328 
| Catacombs of Dranik A 
| dranikcatacombsa 

| 329 
| Catacombs of Dranik B 
| dranikcatacombsb 

| 330 
| Catacombs of Dranik C 
| dranikcatacombsc 

| 331 
| Sewers of Dranik A 
| draniksewersa 

| 332 
| Sewers of Dranik B 
| draniksewersb 

| 333 
| Sewers of Dranik C 
| draniksewersc 

| 334 
| Riftseekers' Sanctum 
| riftseekers 

| 335 
| Harbinger's Spire 
| harbingers 

| 336 
| The Ruined City of Dranik 
| dranik 

| 337 
| The Broodlands 
| broodlands 

| 338 
| Stillmoon Temple 
| stillmoona 

| 339 
| The Ascent 
| stillmoonb 

| 340 
| Thundercrest Isles 
| thundercrest 

| 341 
| Lavaspinner's Lair 
| delvea 

| 342 
| Tirranun's Delve 
| delveb 

| 343 
| The Nest 
| thenest 

| 344 
| Guild Lobby 
| guildlobby 

| 345 
| Guild Hall 
| guildhall 

| 346 
| The Barter Hall 
| barter 

| 347 
| Ruins of Illsalin 
| illsalin 

| 348 
| Illsalin Marketplace 
| illsalina 

| 349 
| Temple of Korlach 
| illsalinb 

| 350 
| The Nargil Pits 
| illsalinc 

| 351 
| Dreadspire Keep 
| dreadspire 

| 354 
| The Hive 
| drachnidhive 

| 355 
| The Hatchery 
| drachnidhivea 

| 356 
| The Cocoons 
| drachnidhiveb 

| 357 
| Queen Sendaiis Lair 
| drachnidhivec 

| 358 
| Stoneroot Falls 
| westkorlach 

| 359 
| Prince's Manor 
| westkorlacha 

| 360 
| Caverns of the Lost 
| westkorlachb 

| 361 
| Lair of the Korlach 
| westkorlachc 

| 362 
| The Undershore 
| eastkorlach 

| 363 
| Snarlstone Dens 
| eastkorlacha 

| 364 
| Shadow Spine 
| shadowspine 

| 365 
| Corathus Creep 
| corathus 

| 366 
| Sporali Caverns 
| corathusa 

| 367 
| The Corathus Mines 
| corathusb 

| 368 
| Shadowed Grove 
| nektulosa 

| 369 
| Arcstone, Isle of Spirits 
| arcstone 

| 370 
| Relic, the Artifact City 
| relic 

| 371 
| Skylance 
| skylance 

| 372 
| The Devastation 
| devastation 

| 373 
| The Seething Wall 
| devastationa 

| 374 
| Sverag, Stronghold of Rage 
| rage 

| 375 
| Razorthorn, Tower of Sullon Zek 
| ragea 

| 376 
| Ruins of Takish-Hiz 
| takishruins 

| 377 
| The Root of Ro 
| takishruinsa 

| 378 
| The Elddar Forest 
| elddar 

| 379 
| Tunare's Shrine 
| elddara 

| 380 
| Theater of Blood 
| theater 

| 381 
| Deathknell, Tower of Dissonance 
| theatera 

| 382 
| East Freeport 
| freeporteast 

| 383 
| West Freeport 
| freeportwest 

| 384 
| Freeport Sewers 
| freeportsewers 

| 385 
| Academy of Arcane Sciences 
| freeportacademy 

| 386 
| Temple of Marr 
| freeporttemple 

| 387 
| Freeport Militia House: My Precious 
| freeportmilitia 

| 388 
| Arena 
| freeportarena 

| 389 
| City Hall 
| freeportcityhall 

| 390 
| Theater of the Tranquil 
| freeporttheater 

| 391 
| Hall of Truth: Bounty 
| freeporthall 

| 392 
| North Desert of Ro 
| northro 

| 393 
| South Desert of Ro 
| southro 

| 394 
| Crescent Reach 
| crescent 

| 395 
| Blightfire Moors 
| moors 

| 396 
| Stone Hive 
| stonehive 

| 397 
| Gorukar Mesa 
| mesa 

| 398 
| Blackfeather Roost 
| roost 

| 399 
| The Steppes 
| steppes 

| 400 
| Icefall Glacier 
| icefall 

| 401 
| Valdeholm 
| valdeholm 

| 402 
| Frostcrypt, Throne of the Shade King 
| frostcrypt 

| 403 
| Sunderock Springs 
| sunderock 

| 404 
| Vergalid Mines 
| vergalid 

| 405 
| Direwind Cliffs 
| direwind 

| 406 
| Ashengate, Reliquary of the Scale 
| ashengate 

| 407 
| Highpass Hold 
| highpasshold 

| 408 
| The Commonlands 
| commonlands 

| 409 
| The Ocean of Tears 
| oceanoftears 

| 410 
| Kithicor Forest 
| kithforest 

| 411 
| Befallen 
| befallenb 

| 412 
| HighKeep 
| highpasskeep 

| 413 
| The Innothule Swamp 
| innothuleb 

| 414 
| Toxxulia Forest 
| toxxulia 

| 415 
| The Misty Thicket 
| mistythicket 

| 416 
| Katta Castrum 
| kattacastrum 

| 417 
| Thalassius, the Coral Keep 
| thalassius 

| 418 
| Jewel of Atiiki 
| atiiki 

| 419 
| Zhisza, the Shissar Sanctuary 
| zhisza 

| 420 
| Silyssar, New Chelsith 
| silyssar 

| 421 
| Solteris, the Throne of Ro 
| solteris 

| 422 
| Barren Coast 
| barren 

| 423 
| The Buried Sea 
| buriedsea 

| 424 
| Jardel's Hook 
| jardelshook 

| 425 
| Monkey Rock 
| monkeyrock 

| 426 
| Suncrest Isle 
| suncrest 

| 427 
| Deadbone Reef 
| deadbone 

| 428 
| Blacksail Folly 
| blacksail 

| 429 
| Maiden's Grave 
| maidensgrave 

| 430 
| Redfeather Isle 
| redfeather 

| 431 
| The Open Sea 
| shipmvp 

| 432 
| The Open Sea 
| shipmvu 

| 433 
| The Open Sea 
| shippvu 

| 434 
| The Open Sea 
| shipuvu 

| 435 
| The Open Sea 
| shipmvm 

| 436 
| Fortress Mechanotus 
| mechanotus 

| 437 
| Meldrath's Majestic Mansion 
| mansion 

| 438 
| The Steam Factory 
| steamfactory 

| 439 
| S.H.I.P. Workshop 
| shipworkshop 

| 440 
| Gyrospire Beza 
| gyrospireb 

| 441 
| Gyrospire Zeka 
| gyrospirez 

| 442 
| Dragonscale Hills 
| dragonscale 

| 443 
| Loping Plains 
| lopingplains 

| 444 
| Hills of Shade 
| hillsofshade 

| 445 
| Bloodmoon Keep 
| bloodmoon 

| 446 
| Crystallos, Lair of the Awakened 
| crystallos 

| 447 
| The Mechamatic Guardian 
| guardian 

| 448 
| The Steamfont Mountains 
| steamfontmts 

| 449 
| Crypt of Shade 
| cryptofshade 

| 451 
| Deepscar's Den 
| dragonscaleb 

| 452 
| Field of Scale 
| oldfieldofbone 

| 453 
| Kaesora Library 
| oldkaesoraa 

| 454 
| Kaesora Hatchery 
| oldkaesorab 

| 455 
| Kurn's Tower 
| oldkurn 

| 456 
| Bloody Kithicor 
| oldkithicor 

| 457 
| Old Commonlands 
| oldcommons 

| 458 
| Highpass Hold 
| oldhighpass 

| 459 
| The Void A 
| thevoida 

| 460 
| The Void B 
| thevoidb 

| 461 
| The Void C 
| thevoidc 

| 462 
| The Void D 
| thevoidd 

| 463 
| The Void E 
| thevoide 

| 464 
| The Void F 
| thevoidf 

| 465 
| The Void G 
| thevoidg 

| 466 
| Oceangreen Hills 
| oceangreenhills 

| 467 
| Oceangreen Village 
| oceangreenvillage 

| 468 
| BlackBurrow 
| oldblackburrow 

| 469 
| Temple of Bertoxxulous 
| bertoxtemple 

| 470 
| Korafax, Home of the Riders 
| discord 

| 471 
| Citadel of the Worldslayer 
| discordtower 

| 472 
| Old Bloodfields 
| oldbloodfield 

| 473 
| The Precipice of War 
| precipiceofwar 

| 474 
| City of Dranik 
| olddranik 

| 475 
| Toskirakk 
| toskirakk 

| 476 
| Korascian Warrens 
| korascian 

| 477 
| Rathe Council Chamber 
| rathechamber 

| 480 
| Brell's Rest 
| brellsrest 

| 481 
| Fungal Forest 
| fungalforest 

| 482 
| The Underquarry 
| underquarry 

| 483 
| The Cooling Chamber 
| coolingchamber 

| 484 
| Kernagir, the Shining City 
| shiningcity 

| 485 
| Arthicrex 
| arthicrex 

| 486 
| The Foundation 
| foundation 

| 487 
| Lichen Creep 
| lichencreep 

| 488 
| Pellucid Grotto 
| pellucid 

| 489 
| Volska's Husk 
| stonesnake 

| 490 
| Brell's Temple 
| brellstemple 

| 491 
| The Convorteum 
| convorteum 

| 492 
| Brell's Arena 
| brellsarena 

| 493 
| Wedding Chapel 
| weddingchapel 

| 494 
| Wedding Chapel 
| weddingchapeldark 

| 495 
| Lair of the Risen 
| dragoncrypt 

| 700 
| The Feerrott 
| feerrott2 

| 701 
| House of Thule 
| thulehouse1 

| 702 
| House of Thule, Upper Floors 
| thulehouse2 

| 703 
| The Grounds 
| housegarden 

| 704 
| The Library 
| thulelibrary 

| 705 
| The Well 
| well 

| 706 
| Erudin Burning 
| fallen 

| 707 
| Morell's Castle 
| morellcastle 

| 708 
| Sanctum Somnium 
| somnium 

| 709 
| Al'Kabor's Nightmare 
| alkabormare 

| 710 
| Miragul's Nightmare 
| miragulmare 

| 711 
| Fear Itself 
| thuledream 

| 712 
| Sunrise Hills 
| neighborhood 

| 724 
| Argath, Bastion of Illdaera 
| argath 

| 725 
| Valley of Lunanyn 
| arelis 

| 726 
| Sarith, City of Tides 
| sarithcity 

| 727 
| Rubak Oseka, Temple of the Sea 
| rubak 

| 728 
| Beasts' Domain 
| beastdomain 

| 729 
| The Resplendent Temple 
| resplendent 

| 730 
| Pillars of Alra 
| pillarsalra 

| 731 
| Windsong Sanctuary 
| windsong 

| 732 
| Erillion, City of Bronze 
| cityofbronze 

| 733 
| Sepulcher of Order 
| sepulcher 

| 734 
| Sepulcher East 
| eastsepulcher 

| 735 
| Sepulcher West 
| westsepulcher 

| 752 
| Shard's Landing 
| shardslanding 

| 753 
| Valley of King Xorbb 
| xorbb 

| 754 
| Kael Drakkel: The King's Madness 
| kaelshard 

| 755 
| East Wastes: Zeixshi-Kar's Awakening 
| eastwastesshard 

| 756 
| The Crystal Caverns: Fragment of Fear 
| crystalshard 

| 757 
| The Breeding Grounds 
| breedinggrounds 

| 758 
| Evantil, the Vile Oak 
| eviltree 

| 759 
| Grelleth's Palace, the Chateau of Filth 
| grelleth 

| 760 
| Chapterhouse of the Fallen 
| chapterhouse 

| 996 
| Art Testing Domain 
| arttest 

| 998 
| The Forgotten Halls 
| fhalls 

| 999 
| Designer Apprentice 
| apprentice

---

## Zone Types

*Source: server/zones/zone-types/index.html*

# Zone Types¶

| 

Zone Type ID 
| Zone Type Name 

| -1 
| None 

| 0 
| Indoors 

| 1 
| Outdoors 

| 2 
| Dungeon 

| 255 
| Any

---

